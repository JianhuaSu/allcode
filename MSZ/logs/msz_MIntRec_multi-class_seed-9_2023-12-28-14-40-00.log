2023-12-28 14:40:00,097 - ============================== Params ==============================
2023-12-28 14:40:00,097 - logger_name: msz_MIntRec_multi-class_seed-9_2023-12-28-14-40-00
2023-12-28 14:40:00,097 - dataset: MIntRec
2023-12-28 14:40:00,098 - data_mode: multi-class
2023-12-28 14:40:00,098 - method: msz
2023-12-28 14:40:00,098 - text_backbone: bert-base-uncased
2023-12-28 14:40:00,098 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-28 14:40:00,098 - seed: 9
2023-12-28 14:40:00,098 - num_workers: 8
2023-12-28 14:40:00,098 - gpu_id: 3
2023-12-28 14:40:00,098 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-28 14:40:00,098 - train: True
2023-12-28 14:40:00,098 - tune: False
2023-12-28 14:40:00,098 - save_model: False
2023-12-28 14:40:00,098 - save_results: True
2023-12-28 14:40:00,098 - log_path: logs
2023-12-28 14:40:00,098 - cache_path: 
2023-12-28 14:40:00,098 - video_data_path: video_data
2023-12-28 14:40:00,098 - audio_data_path: audio_data
2023-12-28 14:40:00,098 - video_feats_path: video_feats.pkl
2023-12-28 14:40:00,098 - audio_feats_path: audio_feats.pkl
2023-12-28 14:40:00,098 - results_path: results
2023-12-28 14:40:00,098 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-28 14:40:00,098 - model_path: models
2023-12-28 14:40:00,098 - config_file_name: msz
2023-12-28 14:40:00,098 - results_file_name: msz.csv
2023-12-28 14:40:00,098 - padding_mode: zero
2023-12-28 14:40:00,098 - padding_loc: end
2023-12-28 14:40:00,098 - need_aligned: False
2023-12-28 14:40:00,098 - eval_monitor: f1
2023-12-28 14:40:00,098 - train_batch_size: 16
2023-12-28 14:40:00,098 - eval_batch_size: 8
2023-12-28 14:40:00,098 - test_batch_size: 8
2023-12-28 14:40:00,098 - wait_patience: 8
2023-12-28 14:40:00,098 - nheads: 2
2023-12-28 14:40:00,098 - encoder_layers: 2
2023-12-28 14:40:00,098 - attn_dropout: 0.1
2023-12-28 14:40:00,098 - relu_dropout: 0.1
2023-12-28 14:40:00,098 - embed_dropout: 0.1
2023-12-28 14:40:00,098 - res_dropout: 0.1
2023-12-28 14:40:00,099 - attn_mask: False
2023-12-28 14:40:00,099 - hidden_size: 768
2023-12-28 14:40:00,099 - num_attention_heads: 12
2023-12-28 14:40:00,099 - attention_probs_dropout_prob: 0.2
2023-12-28 14:40:00,099 - hidden_dropout_prob: 0.2
2023-12-28 14:40:00,099 - intermediate_size: 768
2023-12-28 14:40:00,099 - num_hidden_layers: 3
2023-12-28 14:40:00,099 - max_position_embeddings: 512
2023-12-28 14:40:00,099 - position_embedding_type: absolute
2023-12-28 14:40:00,099 - batch_first: True
2023-12-28 14:40:00,099 - hidden_dims: 768
2023-12-28 14:40:00,099 - att_dropouts: [0.2, 0.2, 0.2]
2023-12-28 14:40:00,099 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-28 14:40:00,099 - ta_loss: 0.01
2023-12-28 14:40:00,099 - tv_loss: 0.01
2023-12-28 14:40:00,099 - av_loss: 0.01
2023-12-28 14:40:00,099 - aligned_method: conv1d
2023-12-28 14:40:00,099 - grad_clip: 2
2023-12-28 14:40:00,099 - num_train_epochs: 100
2023-12-28 14:40:00,099 - warmup_proportion: 0.1
2023-12-28 14:40:00,099 - lr: 1e-06
2023-12-28 14:40:00,099 - weight_decay: 0.02
2023-12-28 14:40:00,099 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-9_2023-12-28-14-40-00
2023-12-28 14:40:00,099 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-9_2023-12-28-14-40-00/models
2023-12-28 14:40:00,099 - ============================== End Params ==============================
2023-12-28 14:40:00,225 - Generate Text Features Begin...
2023-12-28 14:40:00,830 - Generate Text Features Finished...
2023-12-28 14:40:00,831 - Load Video Features Begin...
2023-12-28 14:40:11,394 - Load Video Features Finished...
2023-12-28 14:40:12,090 - Load Audio Features Begin...
2023-12-28 14:40:30,243 - Load Audio Features Finished...
2023-12-28 14:40:34,437 - method  begins...
2023-12-28 14:40:44,019 - Multimodal intent recognition begins...
2023-12-28 14:40:44,019 - Training begins...
2023-12-28 14:41:19,243 - ***** Epoch: 1: Eval results *****
2023-12-28 14:41:19,245 -   train_loss = 3.3348
2023-12-28 14:41:19,245 -   best_eval_score = 0.0
2023-12-28 14:41:19,251 -   eval_score = 0.0148
2023-12-28 14:42:04,881 - ***** Epoch: 2: Eval results *****
2023-12-28 14:42:04,882 -   train_loss = 3.1519
2023-12-28 14:42:04,882 -   best_eval_score = 0.0148
2023-12-28 14:42:04,882 -   eval_score = 0.0214
2023-12-28 14:42:33,200 - ***** Epoch: 3: Eval results *****
2023-12-28 14:42:33,201 -   train_loss = 3.0595
2023-12-28 14:42:33,201 -   best_eval_score = 0.0214
2023-12-28 14:42:33,201 -   eval_score = 0.0268
2023-12-28 14:42:58,169 - ***** Epoch: 4: Eval results *****
2023-12-28 14:42:58,169 -   train_loss = 2.9894
2023-12-28 14:42:58,169 -   best_eval_score = 0.0268
2023-12-28 14:42:58,169 -   eval_score = 0.0263
2023-12-28 14:42:58,169 - EarlyStopping counter: 1 out of 8
2023-12-28 14:43:26,346 - ***** Epoch: 5: Eval results *****
2023-12-28 14:43:26,346 -   train_loss = 2.9476
2023-12-28 14:43:26,346 -   best_eval_score = 0.0268
2023-12-28 14:43:26,346 -   eval_score = 0.0159
2023-12-28 14:43:26,346 - EarlyStopping counter: 2 out of 8
2023-12-28 14:43:54,792 - ***** Epoch: 6: Eval results *****
2023-12-28 14:43:54,793 -   train_loss = 2.9235
2023-12-28 14:43:54,793 -   best_eval_score = 0.0268
2023-12-28 14:43:54,793 -   eval_score = 0.0355
2023-12-28 14:44:22,304 - ***** Epoch: 7: Eval results *****
2023-12-28 14:44:22,305 -   train_loss = 2.8876
2023-12-28 14:44:22,305 -   best_eval_score = 0.0355
2023-12-28 14:44:22,305 -   eval_score = 0.0281
2023-12-28 14:44:22,305 - EarlyStopping counter: 1 out of 8
2023-12-28 14:44:47,276 - ***** Epoch: 8: Eval results *****
2023-12-28 14:44:47,276 -   train_loss = 2.8664
2023-12-28 14:44:47,276 -   best_eval_score = 0.0355
2023-12-28 14:44:47,276 -   eval_score = 0.0252
2023-12-28 14:44:47,276 - EarlyStopping counter: 2 out of 8
2023-12-28 14:45:13,591 - ***** Epoch: 9: Eval results *****
2023-12-28 14:45:13,591 -   train_loss = 2.8502
2023-12-28 14:45:13,592 -   best_eval_score = 0.0355
2023-12-28 14:45:13,592 -   eval_score = 0.0347
2023-12-28 14:45:13,592 - EarlyStopping counter: 3 out of 8
2023-12-28 14:45:37,172 - ***** Epoch: 10: Eval results *****
2023-12-28 14:45:37,173 -   train_loss = 2.8231
2023-12-28 14:45:37,173 -   best_eval_score = 0.0355
2023-12-28 14:45:37,173 -   eval_score = 0.0368
2023-12-28 14:46:00,770 - ***** Epoch: 11: Eval results *****
2023-12-28 14:46:00,770 -   train_loss = 2.7747
2023-12-28 14:46:00,770 -   best_eval_score = 0.0368
2023-12-28 14:46:00,770 -   eval_score = 0.0499
2023-12-28 14:46:27,636 - ***** Epoch: 12: Eval results *****
2023-12-28 14:46:27,637 -   train_loss = 2.7326
2023-12-28 14:46:27,637 -   best_eval_score = 0.0499
2023-12-28 14:46:27,637 -   eval_score = 0.0751
2023-12-28 14:46:53,451 - ***** Epoch: 13: Eval results *****
2023-12-28 14:46:53,451 -   train_loss = 2.6515
2023-12-28 14:46:53,451 -   best_eval_score = 0.0751
2023-12-28 14:46:53,451 -   eval_score = 0.091
2023-12-28 14:47:17,260 - ***** Epoch: 14: Eval results *****
2023-12-28 14:47:17,261 -   train_loss = 2.5231
2023-12-28 14:47:17,261 -   best_eval_score = 0.091
2023-12-28 14:47:17,261 -   eval_score = 0.1901
2023-12-28 14:47:48,808 - ***** Epoch: 15: Eval results *****
2023-12-28 14:47:48,808 -   train_loss = 2.3734
2023-12-28 14:47:48,808 -   best_eval_score = 0.1901
2023-12-28 14:47:48,808 -   eval_score = 0.1654
2023-12-28 14:47:48,808 - EarlyStopping counter: 1 out of 8
2023-12-28 14:48:15,838 - ***** Epoch: 16: Eval results *****
2023-12-28 14:48:15,839 -   train_loss = 2.166
2023-12-28 14:48:15,839 -   best_eval_score = 0.1901
2023-12-28 14:48:15,839 -   eval_score = 0.1926
2023-12-28 14:49:06,154 - ***** Epoch: 17: Eval results *****
2023-12-28 14:49:06,155 -   train_loss = 1.9648
2023-12-28 14:49:06,155 -   best_eval_score = 0.1926
2023-12-28 14:49:06,155 -   eval_score = 0.3184
2023-12-28 14:50:11,415 - ***** Epoch: 18: Eval results *****
2023-12-28 14:50:11,416 -   train_loss = 1.7798
2023-12-28 14:50:11,416 -   best_eval_score = 0.3184
2023-12-28 14:50:11,416 -   eval_score = 0.3101
2023-12-28 14:50:11,416 - EarlyStopping counter: 1 out of 8
2023-12-28 14:50:36,252 - ***** Epoch: 19: Eval results *****
2023-12-28 14:50:36,253 -   train_loss = 1.5475
2023-12-28 14:50:36,253 -   best_eval_score = 0.3184
2023-12-28 14:50:36,253 -   eval_score = 0.4653
2023-12-28 14:51:04,895 - ***** Epoch: 20: Eval results *****
2023-12-28 14:51:04,895 -   train_loss = 1.3791
2023-12-28 14:51:04,895 -   best_eval_score = 0.4653
2023-12-28 14:51:04,895 -   eval_score = 0.4496
2023-12-28 14:51:04,895 - EarlyStopping counter: 1 out of 8
2023-12-28 14:51:33,248 - ***** Epoch: 21: Eval results *****
2023-12-28 14:51:33,248 -   train_loss = 1.192
2023-12-28 14:51:33,248 -   best_eval_score = 0.4653
2023-12-28 14:51:33,248 -   eval_score = 0.3977
2023-12-28 14:51:33,248 - EarlyStopping counter: 2 out of 8
2023-12-28 14:52:01,019 - ***** Epoch: 22: Eval results *****
2023-12-28 14:52:01,019 -   train_loss = 1.0492
2023-12-28 14:52:01,019 -   best_eval_score = 0.4653
2023-12-28 14:52:01,020 -   eval_score = 0.4923
2023-12-28 14:52:42,942 - ***** Epoch: 23: Eval results *****
2023-12-28 14:52:42,943 -   train_loss = 0.9229
2023-12-28 14:52:42,943 -   best_eval_score = 0.4923
2023-12-28 14:52:42,943 -   eval_score = 0.4947
2023-12-28 14:53:08,005 - ***** Epoch: 24: Eval results *****
2023-12-28 14:53:08,005 -   train_loss = 0.7821
2023-12-28 14:53:08,005 -   best_eval_score = 0.4947
2023-12-28 14:53:08,005 -   eval_score = 0.5189
2023-12-28 14:53:36,491 - ***** Epoch: 25: Eval results *****
2023-12-28 14:53:36,491 -   train_loss = 0.6748
2023-12-28 14:53:36,491 -   best_eval_score = 0.5189
2023-12-28 14:53:36,491 -   eval_score = 0.5367
2023-12-28 14:54:03,730 - ***** Epoch: 26: Eval results *****
2023-12-28 14:54:03,730 -   train_loss = 0.5726
2023-12-28 14:54:03,730 -   best_eval_score = 0.5367
2023-12-28 14:54:03,730 -   eval_score = 0.5276
2023-12-28 14:54:03,730 - EarlyStopping counter: 1 out of 8
2023-12-28 14:54:30,460 - ***** Epoch: 27: Eval results *****
2023-12-28 14:54:30,460 -   train_loss = 0.4867
2023-12-28 14:54:30,460 -   best_eval_score = 0.5367
2023-12-28 14:54:30,460 -   eval_score = 0.5646
2023-12-28 14:54:57,009 - ***** Epoch: 28: Eval results *****
2023-12-28 14:54:57,009 -   train_loss = 0.4164
2023-12-28 14:54:57,009 -   best_eval_score = 0.5646
2023-12-28 14:54:57,009 -   eval_score = 0.5775
2023-12-28 14:55:24,570 - ***** Epoch: 29: Eval results *****
2023-12-28 14:55:24,571 -   train_loss = 0.3433
2023-12-28 14:55:24,571 -   best_eval_score = 0.5775
2023-12-28 14:55:24,571 -   eval_score = 0.588
2023-12-28 14:55:50,798 - ***** Epoch: 30: Eval results *****
2023-12-28 14:55:50,799 -   train_loss = 0.2968
2023-12-28 14:55:50,799 -   best_eval_score = 0.588
2023-12-28 14:55:50,799 -   eval_score = 0.5964
2023-12-28 14:56:20,024 - ***** Epoch: 31: Eval results *****
2023-12-28 14:56:20,024 -   train_loss = 0.2619
2023-12-28 14:56:20,024 -   best_eval_score = 0.5964
2023-12-28 14:56:20,024 -   eval_score = 0.5955
2023-12-28 14:56:20,024 - EarlyStopping counter: 1 out of 8
2023-12-28 14:56:47,122 - ***** Epoch: 32: Eval results *****
2023-12-28 14:56:47,122 -   train_loss = 0.2244
2023-12-28 14:56:47,122 -   best_eval_score = 0.5964
2023-12-28 14:56:47,122 -   eval_score = 0.6136
2023-12-28 14:57:16,418 - ***** Epoch: 33: Eval results *****
2023-12-28 14:57:16,419 -   train_loss = 0.1864
2023-12-28 14:57:16,419 -   best_eval_score = 0.6136
2023-12-28 14:57:16,419 -   eval_score = 0.6311
2023-12-28 14:57:42,109 - ***** Epoch: 34: Eval results *****
2023-12-28 14:57:42,109 -   train_loss = 0.1624
2023-12-28 14:57:42,109 -   best_eval_score = 0.6311
2023-12-28 14:57:42,109 -   eval_score = 0.6115
2023-12-28 14:57:42,109 - EarlyStopping counter: 1 out of 8
2023-12-28 14:58:11,819 - ***** Epoch: 35: Eval results *****
2023-12-28 14:58:11,820 -   train_loss = 0.1527
2023-12-28 14:58:11,820 -   best_eval_score = 0.6311
2023-12-28 14:58:11,820 -   eval_score = 0.597
2023-12-28 14:58:11,820 - EarlyStopping counter: 2 out of 8
2023-12-28 14:58:38,625 - ***** Epoch: 36: Eval results *****
2023-12-28 14:58:38,625 -   train_loss = 0.1192
2023-12-28 14:58:38,625 -   best_eval_score = 0.6311
2023-12-28 14:58:38,625 -   eval_score = 0.6191
2023-12-28 14:58:38,625 - EarlyStopping counter: 3 out of 8
2023-12-28 14:59:06,458 - ***** Epoch: 37: Eval results *****
2023-12-28 14:59:06,459 -   train_loss = 0.1038
2023-12-28 14:59:06,459 -   best_eval_score = 0.6311
2023-12-28 14:59:06,459 -   eval_score = 0.6257
2023-12-28 14:59:06,459 - EarlyStopping counter: 4 out of 8
2023-12-28 14:59:31,808 - ***** Epoch: 38: Eval results *****
2023-12-28 14:59:31,809 -   train_loss = 0.0955
2023-12-28 14:59:31,809 -   best_eval_score = 0.6311
2023-12-28 14:59:31,809 -   eval_score = 0.6253
2023-12-28 14:59:31,809 - EarlyStopping counter: 5 out of 8
2023-12-28 14:59:58,555 - ***** Epoch: 39: Eval results *****
2023-12-28 14:59:58,555 -   train_loss = 0.0808
2023-12-28 14:59:58,555 -   best_eval_score = 0.6311
2023-12-28 14:59:58,555 -   eval_score = 0.6281
2023-12-28 14:59:58,555 - EarlyStopping counter: 6 out of 8
2023-12-28 15:00:32,934 - ***** Epoch: 40: Eval results *****
2023-12-28 15:00:32,934 -   train_loss = 0.0787
2023-12-28 15:00:32,934 -   best_eval_score = 0.6311
2023-12-28 15:00:32,934 -   eval_score = 0.6402
2023-12-28 15:01:00,508 - ***** Epoch: 41: Eval results *****
2023-12-28 15:01:00,508 -   train_loss = 0.0642
2023-12-28 15:01:00,508 -   best_eval_score = 0.6402
2023-12-28 15:01:00,508 -   eval_score = 0.6289
2023-12-28 15:01:00,508 - EarlyStopping counter: 1 out of 8
2023-12-28 15:01:26,384 - ***** Epoch: 42: Eval results *****
2023-12-28 15:01:26,384 -   train_loss = 0.054
2023-12-28 15:01:26,384 -   best_eval_score = 0.6402
2023-12-28 15:01:26,384 -   eval_score = 0.6193
2023-12-28 15:01:26,384 - EarlyStopping counter: 2 out of 8
2023-12-28 15:01:51,618 - ***** Epoch: 43: Eval results *****
2023-12-28 15:01:51,618 -   train_loss = 0.0489
2023-12-28 15:01:51,618 -   best_eval_score = 0.6402
2023-12-28 15:01:51,618 -   eval_score = 0.6185
2023-12-28 15:01:51,618 - EarlyStopping counter: 3 out of 8
2023-12-28 15:02:17,606 - ***** Epoch: 44: Eval results *****
2023-12-28 15:02:17,606 -   train_loss = 0.0455
2023-12-28 15:02:17,606 -   best_eval_score = 0.6402
2023-12-28 15:02:17,606 -   eval_score = 0.6203
2023-12-28 15:02:17,606 - EarlyStopping counter: 4 out of 8
2023-12-28 15:02:44,420 - ***** Epoch: 45: Eval results *****
2023-12-28 15:02:44,421 -   train_loss = 0.037
2023-12-28 15:02:44,421 -   best_eval_score = 0.6402
2023-12-28 15:02:44,421 -   eval_score = 0.622
2023-12-28 15:02:44,421 - EarlyStopping counter: 5 out of 8
2023-12-28 15:03:12,005 - ***** Epoch: 46: Eval results *****
2023-12-28 15:03:12,005 -   train_loss = 0.0357
2023-12-28 15:03:12,005 -   best_eval_score = 0.6402
2023-12-28 15:03:12,005 -   eval_score = 0.6196
2023-12-28 15:03:12,005 - EarlyStopping counter: 6 out of 8
2023-12-28 15:03:38,867 - ***** Epoch: 47: Eval results *****
2023-12-28 15:03:38,867 -   train_loss = 0.0443
2023-12-28 15:03:38,867 -   best_eval_score = 0.6402
2023-12-28 15:03:38,867 -   eval_score = 0.6117
2023-12-28 15:03:38,867 - EarlyStopping counter: 7 out of 8
2023-12-28 15:04:07,691 - ***** Epoch: 48: Eval results *****
2023-12-28 15:04:07,691 -   train_loss = 0.0374
2023-12-28 15:04:07,691 -   best_eval_score = 0.6402
2023-12-28 15:04:07,691 -   eval_score = 0.6189
2023-12-28 15:04:07,691 - EarlyStopping counter: 8 out of 8
2023-12-28 15:04:07,691 - EarlyStopping at epoch 48
2023-12-28 15:04:07,693 - Training is finished...
2023-12-28 15:04:07,693 - Testing begins...
2023-12-28 15:04:12,977 - ***** Test: Confusion Matrix *****
2023-12-28 15:04:12,978 - [[20  0  0  0 10  1  5  3  0  2  0  0 12  2  0  0  0  2  0  0]
 [ 0 32  0  1  0  1  2  1  1  0  0  0  2  3  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0 13  0  4  0  0  0  0  0  0  2  1  0  0  1  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  6  0  2  0  0  0  2  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  0  7  1  1  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  3  3  3  0  0  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  4  0  0  2  0  0  1  0  2  0  0]
 [ 1  0  0  0  0  0  0  1  0  3 12  0  0  1  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  3  0  0  0  1 14  0  0  0  0  0  0  0  0]
 [ 1  0  0  1  0  0  5  0  0  2  0  0 38  3  4  0  1  1  1  0]
 [ 0  0  0  0  0  0  1  0  0  0  2  1  1 18  1  0  0  0  0  1]
 [ 0  0  0  0  1  0  1  0  0  0  0  0  2  2 13  0  2  0  0  1]
 [ 0  0  0  1  1  0  0  1  0  0  0  0  8  0  1  9  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  1  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  1  0  0  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  1  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  0  0  0  0  7]]
2023-12-28 15:04:12,978 - ***** Evaluation results *****
2023-12-28 15:04:12,978 -   acc = 0.6562
2023-12-28 15:04:12,978 -   f1 = 0.6525
2023-12-28 15:04:12,979 -   prec = 0.6768
2023-12-28 15:04:12,979 -   rec = 0.6632
2023-12-28 15:04:12,979 - Testing is finished...
2023-12-28 15:04:12,979 - Multimodal intent recognition is finished...
2023-12-28 15:04:12,979 - Results are saved in results/msz.csv
