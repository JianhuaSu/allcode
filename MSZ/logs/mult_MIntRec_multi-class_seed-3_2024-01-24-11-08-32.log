2024-01-24 11:08:32,761 - ============================== Params ==============================
2024-01-24 11:08:32,761 - logger_name: mult_MIntRec_multi-class_seed-3_2024-01-24-11-08-32
2024-01-24 11:08:32,761 - dataset: MIntRec
2024-01-24 11:08:32,761 - data_mode: multi-class
2024-01-24 11:08:32,761 - method: mult
2024-01-24 11:08:32,761 - text_backbone: bert-base-uncased
2024-01-24 11:08:32,761 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-24 11:08:32,761 - seed: 3
2024-01-24 11:08:32,761 - num_workers: 8
2024-01-24 11:08:32,761 - gpu_id: 1
2024-01-24 11:08:32,761 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-24 11:08:32,761 - train: True
2024-01-24 11:08:32,761 - tune: False
2024-01-24 11:08:32,761 - save_model: False
2024-01-24 11:08:32,762 - save_results: True
2024-01-24 11:08:32,762 - log_path: logs
2024-01-24 11:08:32,762 - cache_path: 
2024-01-24 11:08:32,762 - video_data_path: video_data
2024-01-24 11:08:32,762 - audio_data_path: audio_data
2024-01-24 11:08:32,762 - video_feats_path: video_feats.pkl
2024-01-24 11:08:32,762 - audio_feats_path: audio_feats.pkl
2024-01-24 11:08:32,762 - results_path: results
2024-01-24 11:08:32,762 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-24 11:08:32,762 - model_path: models
2024-01-24 11:08:32,762 - config_file_name: mult_bert
2024-01-24 11:08:32,762 - results_file_name: mult_bert.csv
2024-01-24 11:08:32,762 - padding_mode: zero
2024-01-24 11:08:32,762 - padding_loc: end
2024-01-24 11:08:32,762 - need_aligned: False
2024-01-24 11:08:32,762 - eval_monitor: f1
2024-01-24 11:08:32,762 - train_batch_size: 16
2024-01-24 11:08:32,762 - eval_batch_size: 8
2024-01-24 11:08:32,762 - test_batch_size: 8
2024-01-24 11:08:32,762 - wait_patience: 8
2024-01-24 11:08:32,762 - num_train_epochs: 100
2024-01-24 11:08:32,762 - dst_feature_dims: 120
2024-01-24 11:08:32,762 - nheads: 8
2024-01-24 11:08:32,762 - n_levels: 4
2024-01-24 11:08:32,762 - attn_dropout: 0.0
2024-01-24 11:08:32,762 - attn_dropout_v: 0.2
2024-01-24 11:08:32,762 - attn_dropout_a: 0.2
2024-01-24 11:08:32,762 - relu_dropout: 0.0
2024-01-24 11:08:32,762 - embed_dropout: 0.1
2024-01-24 11:08:32,762 - res_dropout: 0.0
2024-01-24 11:08:32,762 - output_dropout: 0.2
2024-01-24 11:08:32,762 - text_dropout: 0.4
2024-01-24 11:08:32,762 - grad_clip: 0.5
2024-01-24 11:08:32,762 - attn_mask: True
2024-01-24 11:08:32,762 - conv1d_kernel_size_l: 5
2024-01-24 11:08:32,762 - conv1d_kernel_size_v: 1
2024-01-24 11:08:32,762 - conv1d_kernel_size_a: 1
2024-01-24 11:08:32,762 - lr: 3e-05
2024-01-24 11:08:32,763 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/mult_MIntRec_multi-class_seed-3_2024-01-24-11-08-32
2024-01-24 11:08:32,763 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/mult_MIntRec_multi-class_seed-3_2024-01-24-11-08-32/models
2024-01-24 11:08:32,763 - ============================== End Params ==============================
2024-01-24 11:08:32,765 - Generate Text Features Begin...
2024-01-24 11:08:33,178 - Generate Text Features Finished...
2024-01-24 11:08:33,179 - Load Video Features Begin...
2024-01-24 11:08:33,439 - Load Video Features Finished...
2024-01-24 11:08:33,962 - Load Audio Features Begin...
2024-01-24 11:08:34,807 - Load Audio Features Finished...
2024-01-24 11:08:37,960 - method  begins...
2024-01-24 11:08:40,618 - Multimodal intent recognition begins...
2024-01-24 11:08:40,618 - Training begins...
2024-01-24 11:09:06,455 - ***** Epoch: 1: Eval results *****
2024-01-24 11:09:06,455 -   best_eval_score = 0.0
2024-01-24 11:09:06,455 -   eval_score = 0.5667
2024-01-24 11:09:06,455 -   train_loss = 2.0226
2024-01-24 11:09:30,037 - ***** Epoch: 2: Eval results *****
2024-01-24 11:09:30,037 -   best_eval_score = 0.5667
2024-01-24 11:09:30,037 -   eval_score = 0.6204
2024-01-24 11:09:30,037 -   train_loss = 0.8531
2024-01-24 11:09:53,798 - ***** Epoch: 3: Eval results *****
2024-01-24 11:09:53,799 -   best_eval_score = 0.6204
2024-01-24 11:09:53,799 -   eval_score = 0.6917
2024-01-24 11:09:53,799 -   train_loss = 0.3539
2024-01-24 11:10:17,865 - ***** Epoch: 4: Eval results *****
2024-01-24 11:10:17,865 -   best_eval_score = 0.6917
2024-01-24 11:10:17,865 -   eval_score = 0.7035
2024-01-24 11:10:17,865 -   train_loss = 0.1562
2024-01-24 11:10:42,019 - ***** Epoch: 5: Eval results *****
2024-01-24 11:10:42,019 -   best_eval_score = 0.7035
2024-01-24 11:10:42,020 -   eval_score = 0.7028
2024-01-24 11:10:42,020 -   train_loss = 0.0693
2024-01-24 11:10:42,020 - EarlyStopping counter: 1 out of 8
2024-01-24 11:11:05,791 - ***** Epoch: 6: Eval results *****
2024-01-24 11:11:05,791 -   best_eval_score = 0.7035
2024-01-24 11:11:05,791 -   eval_score = 0.6863
2024-01-24 11:11:05,791 -   train_loss = 0.033
2024-01-24 11:11:05,791 - EarlyStopping counter: 2 out of 8
2024-01-24 11:11:29,131 - ***** Epoch: 7: Eval results *****
2024-01-24 11:11:29,131 -   best_eval_score = 0.7035
2024-01-24 11:11:29,131 -   eval_score = 0.6953
2024-01-24 11:11:29,131 -   train_loss = 0.0204
2024-01-24 11:11:29,131 - EarlyStopping counter: 3 out of 8
2024-01-24 11:11:52,252 - ***** Epoch: 8: Eval results *****
2024-01-24 11:11:52,253 -   best_eval_score = 0.7035
2024-01-24 11:11:52,253 -   eval_score = 0.6869
2024-01-24 11:11:52,253 -   train_loss = 0.0145
2024-01-24 11:11:52,253 - EarlyStopping counter: 4 out of 8
2024-01-24 11:12:16,052 - ***** Epoch: 9: Eval results *****
2024-01-24 11:12:16,053 -   best_eval_score = 0.7035
2024-01-24 11:12:16,053 -   eval_score = 0.7075
2024-01-24 11:12:16,053 -   train_loss = 0.0098
2024-01-24 11:12:39,702 - ***** Epoch: 10: Eval results *****
2024-01-24 11:12:39,702 -   best_eval_score = 0.7075
2024-01-24 11:12:39,702 -   eval_score = 0.7032
2024-01-24 11:12:39,702 -   train_loss = 0.0072
2024-01-24 11:12:39,703 - EarlyStopping counter: 1 out of 8
2024-01-24 11:13:03,584 - ***** Epoch: 11: Eval results *****
2024-01-24 11:13:03,584 -   best_eval_score = 0.7075
2024-01-24 11:13:03,584 -   eval_score = 0.7037
2024-01-24 11:13:03,584 -   train_loss = 0.0058
2024-01-24 11:13:03,584 - EarlyStopping counter: 2 out of 8
2024-01-24 11:13:26,940 - ***** Epoch: 12: Eval results *****
2024-01-24 11:13:26,940 -   best_eval_score = 0.7075
2024-01-24 11:13:26,940 -   eval_score = 0.6782
2024-01-24 11:13:26,940 -   train_loss = 0.0055
2024-01-24 11:13:26,940 - EarlyStopping counter: 3 out of 8
2024-01-24 11:13:50,776 - ***** Epoch: 13: Eval results *****
2024-01-24 11:13:50,776 -   best_eval_score = 0.7075
2024-01-24 11:13:50,776 -   eval_score = 0.6837
2024-01-24 11:13:50,776 -   train_loss = 0.005
2024-01-24 11:13:50,776 - EarlyStopping counter: 4 out of 8
2024-01-24 11:14:14,743 - ***** Epoch: 14: Eval results *****
2024-01-24 11:14:14,744 -   best_eval_score = 0.7075
2024-01-24 11:14:14,744 -   eval_score = 0.6851
2024-01-24 11:14:14,744 -   train_loss = 0.0045
2024-01-24 11:14:14,744 - EarlyStopping counter: 5 out of 8
2024-01-24 11:14:37,977 - ***** Epoch: 15: Eval results *****
2024-01-24 11:14:37,977 -   best_eval_score = 0.7075
2024-01-24 11:14:37,977 -   eval_score = 0.6873
2024-01-24 11:14:37,977 -   train_loss = 0.0044
2024-01-24 11:14:37,977 - EarlyStopping counter: 6 out of 8
2024-01-24 11:15:02,243 - ***** Epoch: 16: Eval results *****
2024-01-24 11:15:02,243 -   best_eval_score = 0.7075
2024-01-24 11:15:02,243 -   eval_score = 0.6802
2024-01-24 11:15:02,243 -   train_loss = 0.0041
2024-01-24 11:15:02,243 - EarlyStopping counter: 7 out of 8
2024-01-24 11:15:25,088 - ***** Epoch: 17: Eval results *****
2024-01-24 11:15:25,088 -   best_eval_score = 0.7075
2024-01-24 11:15:25,088 -   eval_score = 0.6815
2024-01-24 11:15:25,088 -   train_loss = 0.0041
2024-01-24 11:15:25,088 - EarlyStopping counter: 8 out of 8
2024-01-24 11:15:25,088 - EarlyStopping at epoch 17
2024-01-24 11:15:25,091 - Training is finished...
2024-01-24 11:15:25,091 - Testing begins...
2024-01-24 11:15:29,118 - ***** Test: Confusion Matrix *****
2024-01-24 11:15:29,119 - [[33  2  0  0  7  0  1  1  2  4  0  0  5  2  0  0  0  0  0  0]
 [ 0 34  0  1  0  2  1  0  1  0  1  0  2  1  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 3  0  0  0 13  0  2  0  1  0  0  1  1  1  1  0  0  0  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  3  0  2  0  4  0  0  0  1  0  0  0  1  0  0  0]
 [ 3  0  0  0  0  0  0  4  1  1  1  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  3  4  0  0  0  1  0  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  1  0  0  3  1  0  1  0  0  2  0  1  0  0]
 [ 2  0  0  0  0  0  1  0  0  1 12  0  0  0  1  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0  1]
 [ 3  1  0  0  1  0  1  0  0  0  0  1 41  2  3  1  3  0  0  0]
 [ 0  1  0  0  0  0  2  0  0  0  1  1  0 19  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  1 16  0  1  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  2  0  0 17  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  3  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  2  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  0  0  0  0  7]]
2024-01-24 11:15:29,119 - ***** Evaluation results *****
2024-01-24 11:15:29,119 -   acc = 0.7146
2024-01-24 11:15:29,119 -   f1 = 0.6829
2024-01-24 11:15:29,119 -   prec = 0.6878
2024-01-24 11:15:29,119 -   rec = 0.6842
2024-01-24 11:15:29,119 - Testing is finished...
2024-01-24 11:15:29,119 - Multimodal intent recognition is finished...
2024-01-24 11:15:29,119 - Results are saved in results/mult_bert.csv
