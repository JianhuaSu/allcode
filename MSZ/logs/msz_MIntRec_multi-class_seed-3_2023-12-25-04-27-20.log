2023-12-25 04:27:20,443 - ============================== Params ==============================
2023-12-25 04:27:20,444 - logger_name: msz_MIntRec_multi-class_seed-3_2023-12-25-04-27-20
2023-12-25 04:27:20,444 - dataset: MIntRec
2023-12-25 04:27:20,445 - data_mode: multi-class
2023-12-25 04:27:20,445 - method: msz
2023-12-25 04:27:20,445 - text_backbone: bert-base-uncased
2023-12-25 04:27:20,445 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-25 04:27:20,446 - seed: 3
2023-12-25 04:27:20,446 - num_workers: 8
2023-12-25 04:27:20,446 - gpu_id: 0
2023-12-25 04:27:20,447 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-25 04:27:20,447 - train: True
2023-12-25 04:27:20,447 - tune: False
2023-12-25 04:27:20,448 - save_model: False
2023-12-25 04:27:20,448 - save_results: True
2023-12-25 04:27:20,448 - log_path: logs
2023-12-25 04:27:20,448 - cache_path: 
2023-12-25 04:27:20,449 - video_data_path: video_data
2023-12-25 04:27:20,449 - audio_data_path: audio_data
2023-12-25 04:27:20,450 - video_feats_path: video_feats.pkl
2023-12-25 04:27:20,450 - audio_feats_path: audio_feats.pkl
2023-12-25 04:27:20,451 - results_path: results
2023-12-25 04:27:20,451 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-25 04:27:20,452 - model_path: models
2023-12-25 04:27:20,452 - config_file_name: msz
2023-12-25 04:27:20,453 - results_file_name: msz.csv
2023-12-25 04:27:20,453 - padding_mode: zero
2023-12-25 04:27:20,453 - padding_loc: end
2023-12-25 04:27:20,454 - need_aligned: False
2023-12-25 04:27:20,454 - eval_monitor: f1
2023-12-25 04:27:20,455 - train_batch_size: 16
2023-12-25 04:27:20,455 - eval_batch_size: 8
2023-12-25 04:27:20,456 - test_batch_size: 8
2023-12-25 04:27:20,456 - wait_patience: 8
2023-12-25 04:27:20,457 - nheads: 2
2023-12-25 04:27:20,457 - encoder_layers: 1
2023-12-25 04:27:20,458 - attn_dropout: 0.1
2023-12-25 04:27:20,458 - relu_dropout: 0.1
2023-12-25 04:27:20,459 - embed_dropout: 0.1
2023-12-25 04:27:20,459 - res_dropout: 0.1
2023-12-25 04:27:20,460 - attn_mask: False
2023-12-25 04:27:20,461 - hidden_size: 768
2023-12-25 04:27:20,461 - num_attention_heads: 12
2023-12-25 04:27:20,462 - attention_probs_dropout_prob: 0.2
2023-12-25 04:27:20,462 - hidden_dropout_prob: 0.2
2023-12-25 04:27:20,463 - intermediate_size: 768
2023-12-25 04:27:20,463 - num_hidden_layers: 3
2023-12-25 04:27:20,464 - max_position_embeddings: 512
2023-12-25 04:27:20,464 - position_embedding_type: absolute
2023-12-25 04:27:20,465 - add_cross_attention: True
2023-12-25 04:27:20,465 - batch_first: True
2023-12-25 04:27:20,466 - hidden_dims: 768
2023-12-25 04:27:20,466 - att_dropouts: [0.1, 0.1, 0.1]
2023-12-25 04:27:20,467 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-25 04:27:20,467 - sl: 0.1
2023-12-25 04:27:20,468 - cl: 0.1
2023-12-25 04:27:20,468 - num_train_epochs: 100
2023-12-25 04:27:20,469 - warmup_proportion: 0.1
2023-12-25 04:27:20,469 - lr: 5e-06
2023-12-25 04:27:20,470 - weight_decay: 0.01
2023-12-25 04:27:20,470 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2023-12-25-04-27-20
2023-12-25 04:27:20,471 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2023-12-25-04-27-20/models
2023-12-25 04:27:20,471 - ============================== End Params ==============================
2023-12-25 04:27:20,776 - Generate Text Features Begin...
2023-12-25 04:27:21,406 - Generate Text Features Finished...
2023-12-25 04:27:21,407 - Load Video Features Begin...
2023-12-25 04:27:22,258 - Load Video Features Finished...
2023-12-25 04:27:23,037 - Load Audio Features Begin...
2023-12-25 04:27:28,179 - Load Audio Features Finished...
2023-12-25 04:27:33,699 - method  begins...
2023-12-25 04:27:39,521 - Multimodal intent recognition begins...
2023-12-25 04:27:39,521 - Training begins...
2023-12-25 04:27:58,840 - ***** Epoch: 1: Eval results *****
2023-12-25 04:27:58,841 -   train_loss = 2.9644
2023-12-25 04:27:58,842 -   best_eval_score = 0.0
2023-12-25 04:27:58,842 -   eval_score = 0.08
2023-12-25 04:28:16,623 - ***** Epoch: 2: Eval results *****
2023-12-25 04:28:16,623 -   train_loss = 2.7315
2023-12-25 04:28:16,623 -   best_eval_score = 0.08
2023-12-25 04:28:16,623 -   eval_score = 0.2015
2023-12-25 04:28:33,255 - ***** Epoch: 3: Eval results *****
2023-12-25 04:28:33,262 -   train_loss = 2.2162
2023-12-25 04:28:33,263 -   best_eval_score = 0.2015
2023-12-25 04:28:33,263 -   eval_score = 0.3588
2023-12-25 04:28:51,617 - ***** Epoch: 4: Eval results *****
2023-12-25 04:28:51,617 -   train_loss = 1.6601
2023-12-25 04:28:51,617 -   best_eval_score = 0.3588
2023-12-25 04:28:51,617 -   eval_score = 0.3963
2023-12-25 04:29:11,006 - ***** Epoch: 5: Eval results *****
2023-12-25 04:29:11,007 -   train_loss = 1.3336
2023-12-25 04:29:11,007 -   best_eval_score = 0.3963
2023-12-25 04:29:11,007 -   eval_score = 0.4508
2023-12-25 04:29:29,013 - ***** Epoch: 6: Eval results *****
2023-12-25 04:29:29,013 -   train_loss = 1.0813
2023-12-25 04:29:29,013 -   best_eval_score = 0.4508
2023-12-25 04:29:29,013 -   eval_score = 0.4965
2023-12-25 04:29:45,981 - ***** Epoch: 7: Eval results *****
2023-12-25 04:29:45,981 -   train_loss = 0.9415
2023-12-25 04:29:45,981 -   best_eval_score = 0.4965
2023-12-25 04:29:45,981 -   eval_score = 0.5662
2023-12-25 04:30:03,131 - ***** Epoch: 8: Eval results *****
2023-12-25 04:30:03,141 -   train_loss = 0.7543
2023-12-25 04:30:03,142 -   best_eval_score = 0.5662
2023-12-25 04:30:03,143 -   eval_score = 0.5481
2023-12-25 04:30:03,143 - EarlyStopping counter: 1 out of 8
2023-12-25 04:30:20,293 - ***** Epoch: 9: Eval results *****
2023-12-25 04:30:20,294 -   train_loss = 0.5922
2023-12-25 04:30:20,294 -   best_eval_score = 0.5662
2023-12-25 04:30:20,294 -   eval_score = 0.5643
2023-12-25 04:30:20,294 - EarlyStopping counter: 2 out of 8
2023-12-25 04:30:37,399 - ***** Epoch: 10: Eval results *****
2023-12-25 04:30:37,400 -   train_loss = 0.631
2023-12-25 04:30:37,401 -   best_eval_score = 0.5662
2023-12-25 04:30:37,401 -   eval_score = 0.5271
2023-12-25 04:30:37,401 - EarlyStopping counter: 3 out of 8
2023-12-25 04:30:55,955 - ***** Epoch: 11: Eval results *****
2023-12-25 04:30:55,956 -   train_loss = 0.587
2023-12-25 04:30:55,956 -   best_eval_score = 0.5662
2023-12-25 04:30:55,957 -   eval_score = 0.5435
2023-12-25 04:30:55,957 - EarlyStopping counter: 4 out of 8
2023-12-25 04:31:12,653 - ***** Epoch: 12: Eval results *****
2023-12-25 04:31:12,663 -   train_loss = 0.7995
2023-12-25 04:31:12,664 -   best_eval_score = 0.5662
2023-12-25 04:31:12,665 -   eval_score = 0.5029
2023-12-25 04:31:12,665 - EarlyStopping counter: 5 out of 8
2023-12-25 04:31:29,544 - ***** Epoch: 13: Eval results *****
2023-12-25 04:31:29,544 -   train_loss = 0.7522
2023-12-25 04:31:29,545 -   best_eval_score = 0.5662
2023-12-25 04:31:29,545 -   eval_score = 0.5048
2023-12-25 04:31:29,545 - EarlyStopping counter: 6 out of 8
2023-12-25 04:31:45,885 - ***** Epoch: 14: Eval results *****
2023-12-25 04:31:45,885 -   train_loss = 0.6167
2023-12-25 04:31:45,886 -   best_eval_score = 0.5662
2023-12-25 04:31:45,886 -   eval_score = 0.5255
2023-12-25 04:31:45,886 - EarlyStopping counter: 7 out of 8
2023-12-25 04:32:01,655 - ***** Epoch: 15: Eval results *****
2023-12-25 04:32:01,655 -   train_loss = 0.5444
2023-12-25 04:32:01,655 -   best_eval_score = 0.5662
2023-12-25 04:32:01,655 -   eval_score = 0.5365
2023-12-25 04:32:01,655 - EarlyStopping counter: 8 out of 8
2023-12-25 04:32:01,656 - EarlyStopping at epoch 15
2023-12-25 04:32:01,657 - Training is finished...
2023-12-25 04:32:01,658 - Testing begins...
2023-12-25 04:32:08,990 - ***** Test: Confusion Matrix *****
2023-12-25 04:32:08,994 - [[43  1  0  0  1  0  2  0  0  5  1  0  2  2  0  0  0  0  0  0]
 [ 0 41  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 8  1  0  0  2  0  5  0  0  2  0  2  1  2  0  0  0  0  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 7  0  0  0  0  0  0  0  1  2  0  1  1  0  0  0  0  0  0  0]
 [ 5  3  0  0  0  0  0  0  0  1  1  0  0  0  0  0  0  0  0  0]
 [ 2  1  0  0  0  0  1  3  0  0  0  0  0  2  0  1  0  0  0  0]
 [ 1  1  0  0  0  0  0  0  0  6  0  0  0  0  0  2  0  0  0  0]
 [ 2  0  0  0  0  1  0  0  0  3 12  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0  0]
 [13  3  0  0  0  0  0  0  0  0  0  4 21  0  8  1  3  1  2  1]
 [ 3  1  0  0  0  0  0  0  0  0  1  1  0 14  2  1  0  0  1  1]
 [ 1  0  0  0  0  0  1  0  0  0  0  0  0  4 12  0  3  0  0  1]
 [ 4  2  0  0  0  0  0  0  0  0  0  0  1  0  1 12  0  0  1  0]
 [ 2  0  0  0  0  1  0  0  0  0  0  0  1  0  1  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  2  0  1  0  0  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0 10  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  4  0  0  0  0  1  0  0  5]]
2023-12-25 04:32:08,995 - ***** Evaluation results *****
2023-12-25 04:32:08,995 -   acc = 0.6315
2023-12-25 04:32:08,996 -   f1 = 0.5594
2023-12-25 04:32:08,996 -   prec = 0.5798
2023-12-25 04:32:08,997 -   rec = 0.5862
2023-12-25 04:32:08,997 - Testing is finished...
2023-12-25 04:32:08,998 - Multimodal intent recognition is finished...
2023-12-25 04:32:08,999 - Results are saved in results/msz.csv
