2024-03-30 20:59:16,658 - ============================== Params ==============================
2024-03-30 20:59:16,658 - logger_name: msz_MIntRec_multi-class_seed-2_2024-03-30-20-59-16
2024-03-30 20:59:16,658 - dataset: MIntRec
2024-03-30 20:59:16,658 - data_mode: multi-class
2024-03-30 20:59:16,658 - method: msz
2024-03-30 20:59:16,658 - text_backbone: bert-base-uncased
2024-03-30 20:59:16,658 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-30 20:59:16,658 - seed: 2
2024-03-30 20:59:16,658 - num_workers: 8
2024-03-30 20:59:16,658 - gpu_id: 3
2024-03-30 20:59:16,658 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-30 20:59:16,658 - train: True
2024-03-30 20:59:16,658 - tune: True
2024-03-30 20:59:16,658 - save_model: False
2024-03-30 20:59:16,658 - save_results: True
2024-03-30 20:59:16,658 - log_path: logs
2024-03-30 20:59:16,658 - cache_path: 
2024-03-30 20:59:16,658 - video_data_path: video_data
2024-03-30 20:59:16,658 - audio_data_path: audio_data
2024-03-30 20:59:16,658 - video_feats_path: video_feats.pkl
2024-03-30 20:59:16,659 - audio_feats_path: audio_feats.pkl
2024-03-30 20:59:16,659 - results_path: results
2024-03-30 20:59:16,659 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-03-30 20:59:16,659 - model_path: models
2024-03-30 20:59:16,659 - config_file_name: msz_MIntRec
2024-03-30 20:59:16,659 - results_file_name: msz.csv
2024-03-30 20:59:16,659 - padding_mode: zero
2024-03-30 20:59:16,659 - padding_loc: end
2024-03-30 20:59:16,659 - need_aligned: False
2024-03-30 20:59:16,659 - eval_monitor: f1
2024-03-30 20:59:16,659 - train_batch_size: 16
2024-03-30 20:59:16,659 - eval_batch_size: 8
2024-03-30 20:59:16,659 - test_batch_size: 8
2024-03-30 20:59:16,659 - wait_patience: 8
2024-03-30 20:59:16,659 - hidden_dims: 768
2024-03-30 20:59:16,659 - num_attention_heads: 8
2024-03-30 20:59:16,659 - attention_probs_dropout_prob: 0.2
2024-03-30 20:59:16,659 - hidden_dropout_prob: 0.2
2024-03-30 20:59:16,659 - intermediate_size: 768
2024-03-30 20:59:16,659 - num_hidden_layers: 8
2024-03-30 20:59:16,659 - max_position_embeddings: 768
2024-03-30 20:59:16,659 - position_embedding_type: absolute
2024-03-30 20:59:16,659 - batch_first: True
2024-03-30 20:59:16,659 - dropout: 0.1
2024-03-30 20:59:16,659 - aligned_method: conv1d
2024-03-30 20:59:16,659 - num_train_epochs: 100
2024-03-30 20:59:16,659 - lr: 5e-06
2024-03-30 20:59:16,659 - lr_mode: max
2024-03-30 20:59:16,659 - patience: 6
2024-03-30 20:59:16,659 - factor: 0.3
2024-03-30 20:59:16,659 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-03-30-20-59-16
2024-03-30 20:59:16,659 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-03-30-20-59-16/models
2024-03-30 20:59:16,659 - num_labels: 20
2024-03-30 20:59:16,659 - text_feat_dim: 768
2024-03-30 20:59:16,659 - video_feat_dim: 256
2024-03-30 20:59:16,659 - audio_feat_dim: 768
2024-03-30 20:59:16,659 - text_seq_len: 30
2024-03-30 20:59:16,659 - video_seq_len: 230
2024-03-30 20:59:16,659 - audio_seq_len: 480
2024-03-30 20:59:16,659 - device: cuda:3
2024-03-30 20:59:16,659 - ============================== End Params ==============================
2024-03-30 20:59:16,687 - Generate Text Features Begin...
2024-03-30 20:59:17,117 - Generate Text Features Finished...
2024-03-30 20:59:17,142 - Load Video Features Begin...
2024-03-30 20:59:18,003 - Load Video Features Finished...
2024-03-30 20:59:18,438 - Load Audio Features Begin...
2024-03-30 20:59:22,050 - Load Audio Features Finished...
2024-03-30 20:59:24,244 - method  begins...
2024-03-30 20:59:26,913 - Multimodal intent recognition begins...
2024-03-30 20:59:26,913 - Training begins...
2024-03-30 20:59:47,833 - ***** Epoch: 1: Eval results *****
2024-03-30 20:59:47,833 -   train_loss = 2.6852
2024-03-30 20:59:47,834 -   best_eval_score = 0.0
2024-03-30 20:59:47,834 -   eval_score = 0.1549
2024-03-30 21:00:08,696 - ***** Epoch: 2: Eval results *****
2024-03-30 21:00:08,697 -   train_loss = 1.9053
2024-03-30 21:00:08,697 -   best_eval_score = 0.1549
2024-03-30 21:00:08,697 -   eval_score = 0.4556
2024-03-30 21:00:29,508 - ***** Epoch: 3: Eval results *****
2024-03-30 21:00:29,508 -   train_loss = 1.2286
2024-03-30 21:00:29,508 -   best_eval_score = 0.4556
2024-03-30 21:00:29,508 -   eval_score = 0.5635
2024-03-30 21:00:50,118 - ***** Epoch: 4: Eval results *****
2024-03-30 21:00:50,119 -   train_loss = 0.7729
2024-03-30 21:00:50,119 -   best_eval_score = 0.5635
2024-03-30 21:00:50,119 -   eval_score = 0.6123
2024-03-30 21:01:12,253 - ***** Epoch: 5: Eval results *****
2024-03-30 21:01:12,253 -   train_loss = 0.4904
2024-03-30 21:01:12,253 -   best_eval_score = 0.6123
2024-03-30 21:01:12,254 -   eval_score = 0.675
2024-03-30 21:01:33,543 - ***** Epoch: 6: Eval results *****
2024-03-30 21:01:33,543 -   train_loss = 0.2928
2024-03-30 21:01:33,544 -   best_eval_score = 0.675
2024-03-30 21:01:33,544 -   eval_score = 0.6916
2024-03-30 21:01:54,802 - ***** Epoch: 7: Eval results *****
2024-03-30 21:01:54,802 -   train_loss = 0.1885
2024-03-30 21:01:54,802 -   best_eval_score = 0.6916
2024-03-30 21:01:54,802 -   eval_score = 0.6928
2024-03-30 21:02:15,221 - ***** Epoch: 8: Eval results *****
2024-03-30 21:02:15,222 -   train_loss = 0.1152
2024-03-30 21:02:15,222 -   best_eval_score = 0.6928
2024-03-30 21:02:15,222 -   eval_score = 0.6949
2024-03-30 21:02:36,889 - ***** Epoch: 9: Eval results *****
2024-03-30 21:02:36,890 -   train_loss = 0.075
2024-03-30 21:02:36,890 -   best_eval_score = 0.6949
2024-03-30 21:02:36,890 -   eval_score = 0.6964
2024-03-30 21:02:57,914 - ***** Epoch: 10: Eval results *****
2024-03-30 21:02:57,915 -   train_loss = 0.062
2024-03-30 21:02:57,915 -   best_eval_score = 0.6964
2024-03-30 21:02:57,915 -   eval_score = 0.6969
2024-03-30 21:03:18,995 - ***** Epoch: 11: Eval results *****
2024-03-30 21:03:18,996 -   train_loss = 0.0548
2024-03-30 21:03:18,996 -   best_eval_score = 0.6969
2024-03-30 21:03:18,996 -   eval_score = 0.6904
2024-03-30 21:03:18,996 - EarlyStopping counter: 1 out of 8
2024-03-30 21:03:40,055 - ***** Epoch: 12: Eval results *****
2024-03-30 21:03:40,055 -   train_loss = 0.0472
2024-03-30 21:03:40,055 -   best_eval_score = 0.6969
2024-03-30 21:03:40,055 -   eval_score = 0.6904
2024-03-30 21:03:40,055 - EarlyStopping counter: 2 out of 8
2024-03-30 21:04:00,887 - ***** Epoch: 13: Eval results *****
2024-03-30 21:04:00,896 -   train_loss = 0.0417
2024-03-30 21:04:00,896 -   best_eval_score = 0.6969
2024-03-30 21:04:00,896 -   eval_score = 0.6892
2024-03-30 21:04:00,896 - EarlyStopping counter: 3 out of 8
2024-03-30 21:04:21,302 - ***** Epoch: 14: Eval results *****
2024-03-30 21:04:21,303 -   train_loss = 0.0371
2024-03-30 21:04:21,303 -   best_eval_score = 0.6969
2024-03-30 21:04:21,303 -   eval_score = 0.7002
2024-03-30 21:04:42,454 - ***** Epoch: 15: Eval results *****
2024-03-30 21:04:42,454 -   train_loss = 0.0336
2024-03-30 21:04:42,454 -   best_eval_score = 0.7002
2024-03-30 21:04:42,454 -   eval_score = 0.6986
2024-03-30 21:04:42,454 - EarlyStopping counter: 1 out of 8
2024-03-30 21:05:03,120 - ***** Epoch: 16: Eval results *****
2024-03-30 21:05:03,121 -   train_loss = 0.0298
2024-03-30 21:05:03,121 -   best_eval_score = 0.7002
2024-03-30 21:05:03,121 -   eval_score = 0.6994
2024-03-30 21:05:03,121 - EarlyStopping counter: 2 out of 8
2024-03-30 21:05:23,952 - ***** Epoch: 17: Eval results *****
2024-03-30 21:05:23,952 -   train_loss = 0.0281
2024-03-30 21:05:23,952 -   best_eval_score = 0.7002
2024-03-30 21:05:23,952 -   eval_score = 0.6995
2024-03-30 21:05:23,952 - EarlyStopping counter: 3 out of 8
2024-03-30 21:05:44,928 - ***** Epoch: 18: Eval results *****
2024-03-30 21:05:44,929 -   train_loss = 0.0278
2024-03-30 21:05:44,929 -   best_eval_score = 0.7002
2024-03-30 21:05:44,929 -   eval_score = 0.6996
2024-03-30 21:05:44,929 - EarlyStopping counter: 4 out of 8
2024-03-30 21:06:05,695 - ***** Epoch: 19: Eval results *****
2024-03-30 21:06:05,695 -   train_loss = 0.0279
2024-03-30 21:06:05,695 -   best_eval_score = 0.7002
2024-03-30 21:06:05,695 -   eval_score = 0.6987
2024-03-30 21:06:05,696 - EarlyStopping counter: 5 out of 8
2024-03-30 21:06:26,937 - ***** Epoch: 20: Eval results *****
2024-03-30 21:06:26,937 -   train_loss = 0.0259
2024-03-30 21:06:26,937 -   best_eval_score = 0.7002
2024-03-30 21:06:26,938 -   eval_score = 0.7016
2024-03-30 21:06:47,628 - ***** Epoch: 21: Eval results *****
2024-03-30 21:06:47,628 -   train_loss = 0.0251
2024-03-30 21:06:47,628 -   best_eval_score = 0.7016
2024-03-30 21:06:47,628 -   eval_score = 0.6998
2024-03-30 21:06:47,628 - EarlyStopping counter: 1 out of 8
2024-03-30 21:07:08,207 - ***** Epoch: 22: Eval results *****
2024-03-30 21:07:08,207 -   train_loss = 0.0245
2024-03-30 21:07:08,207 -   best_eval_score = 0.7016
2024-03-30 21:07:08,207 -   eval_score = 0.7008
2024-03-30 21:07:08,207 - EarlyStopping counter: 2 out of 8
2024-03-30 21:07:29,364 - ***** Epoch: 23: Eval results *****
2024-03-30 21:07:29,364 -   train_loss = 0.0244
2024-03-30 21:07:29,365 -   best_eval_score = 0.7016
2024-03-30 21:07:29,365 -   eval_score = 0.6993
2024-03-30 21:07:29,365 - EarlyStopping counter: 3 out of 8
2024-03-30 21:07:49,683 - ***** Epoch: 24: Eval results *****
2024-03-30 21:07:49,683 -   train_loss = 0.0228
2024-03-30 21:07:49,683 -   best_eval_score = 0.7016
2024-03-30 21:07:49,683 -   eval_score = 0.7014
2024-03-30 21:07:49,683 - EarlyStopping counter: 4 out of 8
2024-03-30 21:08:10,498 - ***** Epoch: 25: Eval results *****
2024-03-30 21:08:10,499 -   train_loss = 0.0232
2024-03-30 21:08:10,499 -   best_eval_score = 0.7016
2024-03-30 21:08:10,499 -   eval_score = 0.7014
2024-03-30 21:08:10,499 - EarlyStopping counter: 5 out of 8
2024-03-30 21:08:31,311 - ***** Epoch: 26: Eval results *****
2024-03-30 21:08:31,312 -   train_loss = 0.0225
2024-03-30 21:08:31,312 -   best_eval_score = 0.7016
2024-03-30 21:08:31,312 -   eval_score = 0.7014
2024-03-30 21:08:31,312 - EarlyStopping counter: 6 out of 8
2024-03-30 21:08:52,458 - ***** Epoch: 27: Eval results *****
2024-03-30 21:08:52,458 -   train_loss = 0.023
2024-03-30 21:08:52,458 -   best_eval_score = 0.7016
2024-03-30 21:08:52,458 -   eval_score = 0.7014
2024-03-30 21:08:52,458 - EarlyStopping counter: 7 out of 8
2024-03-30 21:09:13,008 - ***** Epoch: 28: Eval results *****
2024-03-30 21:09:13,008 -   train_loss = 0.0241
2024-03-30 21:09:13,008 -   best_eval_score = 0.7016
2024-03-30 21:09:13,008 -   eval_score = 0.7014
2024-03-30 21:09:13,009 - EarlyStopping counter: 8 out of 8
2024-03-30 21:09:13,009 - EarlyStopping at epoch 28
2024-03-30 21:09:13,012 - Training is finished...
2024-03-30 21:09:13,012 - Testing begins...
2024-03-30 21:09:16,744 - ***** Test: Confusion Matrix *****
2024-03-30 21:09:16,745 - [[38  3  0  0  8  0  1  0  0  1  1  0  4  1  0  0  0  0  0  0]
 [ 1 34  0  1  0  3  0  0  0  0  1  0  2  1  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 5  0  0  0 11  0  2  0  0  0  0  1  2  1  0  0  0  1  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  3  0  2  0  3  0  0  0  1  0  0  0  1  0  0  0]
 [ 3  1  0  0  0  0  0  5  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  1  2  5  0  0  0  0  1  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  4  0  0  0  0  0  2  0  1  0  1]
 [ 1  0  0  0  0  0  1  0  0  2 13  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  1  0  1  0  0  0  0 15  0  0  0  0  0  0  1  1]
 [ 3  2  0  0  1  0  0  0  1  0  0  1 41  2  2  2  2  0  0  0]
 [ 0  0  0  0  0  0  2  1  0  0  1  1  0 19  1  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  1  0  0  0  0  2 16  0  1  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  4  0  0 15  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  1  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  2  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  0  1  0  0  6]]
2024-03-30 21:09:16,745 - ***** Evaluation results *****
2024-03-30 21:09:16,745 -   acc = 0.7169
2024-03-30 21:09:16,745 -   f1 = 0.6876
2024-03-30 21:09:16,745 -   prec = 0.6934
2024-03-30 21:09:16,745 -   rec = 0.6853
2024-03-30 21:09:16,746 - Testing is finished...
2024-03-30 21:09:16,746 - Multimodal intent recognition is finished...
2024-03-30 21:09:16,746 - Results are saved in results/msz.csv
