2023-12-25 13:16:32,145 - ============================== Params ==============================
2023-12-25 13:16:32,145 - logger_name: msz_MIntRec_multi-class_seed-4_2023-12-25-13-16-32
2023-12-25 13:16:32,145 - dataset: MIntRec
2023-12-25 13:16:32,145 - data_mode: multi-class
2023-12-25 13:16:32,145 - method: msz
2023-12-25 13:16:32,145 - text_backbone: bert-base-uncased
2023-12-25 13:16:32,145 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-25 13:16:32,145 - seed: 4
2023-12-25 13:16:32,145 - num_workers: 8
2023-12-25 13:16:32,145 - gpu_id: 0
2023-12-25 13:16:32,145 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-25 13:16:32,145 - train: True
2023-12-25 13:16:32,145 - tune: False
2023-12-25 13:16:32,145 - save_model: False
2023-12-25 13:16:32,145 - save_results: True
2023-12-25 13:16:32,145 - log_path: logs
2023-12-25 13:16:32,145 - cache_path: 
2023-12-25 13:16:32,145 - video_data_path: video_data
2023-12-25 13:16:32,146 - audio_data_path: audio_data
2023-12-25 13:16:32,146 - video_feats_path: video_feats.pkl
2023-12-25 13:16:32,146 - audio_feats_path: audio_feats.pkl
2023-12-25 13:16:32,146 - results_path: results
2023-12-25 13:16:32,146 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-25 13:16:32,146 - model_path: models
2023-12-25 13:16:32,146 - config_file_name: msz
2023-12-25 13:16:32,146 - results_file_name: msz.csv
2023-12-25 13:16:32,146 - padding_mode: zero
2023-12-25 13:16:32,146 - padding_loc: end
2023-12-25 13:16:32,146 - need_aligned: False
2023-12-25 13:16:32,146 - eval_monitor: f1
2023-12-25 13:16:32,146 - train_batch_size: 16
2023-12-25 13:16:32,146 - eval_batch_size: 8
2023-12-25 13:16:32,146 - test_batch_size: 8
2023-12-25 13:16:32,146 - wait_patience: 8
2023-12-25 13:16:32,146 - nheads: 2
2023-12-25 13:16:32,146 - encoder_layers: 2
2023-12-25 13:16:32,146 - attn_dropout: 0.1
2023-12-25 13:16:32,146 - relu_dropout: 0.1
2023-12-25 13:16:32,146 - embed_dropout: 0.1
2023-12-25 13:16:32,146 - res_dropout: 0.1
2023-12-25 13:16:32,146 - attn_mask: False
2023-12-25 13:16:32,146 - hidden_size: 768
2023-12-25 13:16:32,146 - num_attention_heads: 12
2023-12-25 13:16:32,146 - attention_probs_dropout_prob: 0.2
2023-12-25 13:16:32,146 - hidden_dropout_prob: 0.2
2023-12-25 13:16:32,146 - intermediate_size: 768
2023-12-25 13:16:32,146 - num_hidden_layers: 3
2023-12-25 13:16:32,146 - max_position_embeddings: 512
2023-12-25 13:16:32,146 - position_embedding_type: absolute
2023-12-25 13:16:32,146 - add_cross_attention: False
2023-12-25 13:16:32,146 - batch_first: True
2023-12-25 13:16:32,146 - hidden_dims: 768
2023-12-25 13:16:32,146 - att_dropouts: [0.1, 0.1, 0.1]
2023-12-25 13:16:32,146 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-25 13:16:32,146 - sl: 0.1
2023-12-25 13:16:32,146 - cl: 0.1
2023-12-25 13:16:32,146 - num_train_epochs: 100
2023-12-25 13:16:32,146 - warmup_proportion: 0.1
2023-12-25 13:16:32,146 - lr: 5e-06
2023-12-25 13:16:32,146 - weight_decay: 0.01
2023-12-25 13:16:32,147 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2023-12-25-13-16-32
2023-12-25 13:16:32,147 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2023-12-25-13-16-32/models
2023-12-25 13:16:32,147 - ============================== End Params ==============================
2023-12-25 13:16:32,220 - Generate Text Features Begin...
2023-12-25 13:16:32,973 - Generate Text Features Finished...
2023-12-25 13:16:32,977 - Load Video Features Begin...
2023-12-25 13:16:35,235 - Load Video Features Finished...
2023-12-25 13:16:35,862 - Load Audio Features Begin...
2023-12-25 13:16:43,935 - Load Audio Features Finished...
2023-12-25 13:16:50,343 - method  begins...
2023-12-25 13:16:56,648 - Multimodal intent recognition begins...
2023-12-25 13:16:56,648 - Training begins...
2023-12-25 13:17:20,180 - ***** Epoch: 1: Eval results *****
2023-12-25 13:17:20,191 -   train_loss = 2.896
2023-12-25 13:17:20,191 -   best_eval_score = 0.0
2023-12-25 13:17:20,191 -   eval_score = 0.0484
2023-12-25 13:17:39,645 - ***** Epoch: 2: Eval results *****
2023-12-25 13:17:39,645 -   train_loss = 2.5209
2023-12-25 13:17:39,645 -   best_eval_score = 0.0484
2023-12-25 13:17:39,645 -   eval_score = 0.1881
2023-12-25 13:18:06,102 - ***** Epoch: 3: Eval results *****
2023-12-25 13:18:06,103 -   train_loss = 1.882
2023-12-25 13:18:06,103 -   best_eval_score = 0.1881
2023-12-25 13:18:06,104 -   eval_score = 0.3918
2023-12-25 13:18:28,077 - ***** Epoch: 4: Eval results *****
2023-12-25 13:18:28,077 -   train_loss = 1.5764
2023-12-25 13:18:28,077 -   best_eval_score = 0.3918
2023-12-25 13:18:28,077 -   eval_score = 0.4506
2023-12-25 13:18:49,267 - ***** Epoch: 5: Eval results *****
2023-12-25 13:18:49,267 -   train_loss = 1.4672
2023-12-25 13:18:49,268 -   best_eval_score = 0.4506
2023-12-25 13:18:49,268 -   eval_score = 0.4257
2023-12-25 13:18:49,268 - EarlyStopping counter: 1 out of 8
2023-12-25 13:19:11,178 - ***** Epoch: 6: Eval results *****
2023-12-25 13:19:11,178 -   train_loss = 1.2236
2023-12-25 13:19:11,178 -   best_eval_score = 0.4506
2023-12-25 13:19:11,179 -   eval_score = 0.4936
2023-12-25 13:19:31,693 - ***** Epoch: 7: Eval results *****
2023-12-25 13:19:31,694 -   train_loss = 1.0435
2023-12-25 13:19:31,694 -   best_eval_score = 0.4936
2023-12-25 13:19:31,694 -   eval_score = 0.4787
2023-12-25 13:19:31,694 - EarlyStopping counter: 1 out of 8
2023-12-25 13:19:51,378 - ***** Epoch: 8: Eval results *****
2023-12-25 13:19:51,378 -   train_loss = 1.0258
2023-12-25 13:19:51,378 -   best_eval_score = 0.4936
2023-12-25 13:19:51,379 -   eval_score = 0.4982
2023-12-25 13:20:14,040 - ***** Epoch: 9: Eval results *****
2023-12-25 13:20:14,040 -   train_loss = 1.0557
2023-12-25 13:20:14,040 -   best_eval_score = 0.4982
2023-12-25 13:20:14,040 -   eval_score = 0.4659
2023-12-25 13:20:14,040 - EarlyStopping counter: 1 out of 8
2023-12-25 13:20:34,583 - ***** Epoch: 10: Eval results *****
2023-12-25 13:20:34,584 -   train_loss = 1.3242
2023-12-25 13:20:34,584 -   best_eval_score = 0.4982
2023-12-25 13:20:34,584 -   eval_score = 0.4484
2023-12-25 13:20:34,584 - EarlyStopping counter: 2 out of 8
2023-12-25 13:20:56,095 - ***** Epoch: 11: Eval results *****
2023-12-25 13:20:56,095 -   train_loss = 1.3084
2023-12-25 13:20:56,095 -   best_eval_score = 0.4982
2023-12-25 13:20:56,096 -   eval_score = 0.4612
2023-12-25 13:20:56,096 - EarlyStopping counter: 3 out of 8
2023-12-25 13:21:16,733 - ***** Epoch: 12: Eval results *****
2023-12-25 13:21:16,734 -   train_loss = 1.1788
2023-12-25 13:21:16,734 -   best_eval_score = 0.4982
2023-12-25 13:21:16,734 -   eval_score = 0.4349
2023-12-25 13:21:16,734 - EarlyStopping counter: 4 out of 8
2023-12-25 13:21:37,764 - ***** Epoch: 13: Eval results *****
2023-12-25 13:21:37,764 -   train_loss = 1.2571
2023-12-25 13:21:37,764 -   best_eval_score = 0.4982
2023-12-25 13:21:37,764 -   eval_score = 0.4082
2023-12-25 13:21:37,764 - EarlyStopping counter: 5 out of 8
2023-12-25 13:21:58,230 - ***** Epoch: 14: Eval results *****
2023-12-25 13:21:58,231 -   train_loss = 1.2609
2023-12-25 13:21:58,231 -   best_eval_score = 0.4982
2023-12-25 13:21:58,231 -   eval_score = 0.4063
2023-12-25 13:21:58,231 - EarlyStopping counter: 6 out of 8
2023-12-25 13:22:18,751 - ***** Epoch: 15: Eval results *****
2023-12-25 13:22:18,752 -   train_loss = 1.4174
2023-12-25 13:22:18,752 -   best_eval_score = 0.4982
2023-12-25 13:22:18,752 -   eval_score = 0.3669
2023-12-25 13:22:18,752 - EarlyStopping counter: 7 out of 8
2023-12-25 13:22:38,203 - ***** Epoch: 16: Eval results *****
2023-12-25 13:22:38,204 -   train_loss = 1.7975
2023-12-25 13:22:38,204 -   best_eval_score = 0.4982
2023-12-25 13:22:38,204 -   eval_score = 0.3633
2023-12-25 13:22:38,204 - EarlyStopping counter: 8 out of 8
2023-12-25 13:22:38,204 - EarlyStopping at epoch 16
2023-12-25 13:22:38,207 - Training is finished...
2023-12-25 13:22:38,207 - Testing begins...
2023-12-25 13:22:46,856 - ***** Test: Confusion Matrix *****
2023-12-25 13:22:46,862 - [[24  2  0  0 13  0  0  0  0  0  1  0 14  2  0  1  0  0  0  0]
 [ 0 37  0  1  1  0  0  0  0  0  0  0  2  0  1  1  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0 19  0  0  0  0  0  0  0  1  1  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  0  0  1 10  0  0  0  0]
 [ 0  0  0  0  9  0  0  0  0  0  0  0  2  0  1  0  0  0  0  0]
 [ 6  1  0  0  0  0  0  1  0  0  0  0  2  0  0  0  0  0  0  0]
 [ 4  0  0  0  1  0  0  1  0  0  0  0  0  1  0  3  0  0  0  0]
 [ 3  1  0  0  2  0  0  0  0  1  0  0  2  0  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  1 12  0  1  1  1  0  0  0  0  0]
 [ 1  0  0  0  3  0  0  0  0  0  0 14  0  1  0  0  0  0  0  0]
 [ 5  2  0  1  1  0  0  0  0  0  0  1 41  1  3  0  1  1  0  0]
 [ 0  0  0  0  2  0  0  0  0  0  0  1  7 12  3  0  0  0  0  0]
 [ 0  0  1  0  1  0  0  0  0  0  0  0  5  2 12  0  1  0  0  0]
 [ 0  0  0  1  2  0  0  0  0  0  0  0  6  0  2 10  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  3  0  2  0 11  0  0  0]
 [ 0  0  0  0  5  0  0  0  0  1  0  0  0  0  2  0  0  7  0  0]
 [ 0  0  0  0  1  0  0  0  0  0  0  0  5  1  0  2  0  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  4  5  0  0  1  0  0]]
2023-12-25 13:22:46,863 - ***** Evaluation results *****
2023-12-25 13:22:46,863 -   acc = 0.573
2023-12-25 13:22:46,863 -   f1 = 0.4574
2023-12-25 13:22:46,863 -   prec = 0.5202
2023-12-25 13:22:46,863 -   rec = 0.4629
2023-12-25 13:22:46,863 - Testing is finished...
2023-12-25 13:22:46,863 - Multimodal intent recognition is finished...
2023-12-25 13:22:46,864 - Results are saved in results/msz.csv
