2024-01-02 15:26:08,645 - ============================== Params ==============================
2024-01-02 15:26:08,645 - logger_name: msz_MIntRec_multi-class_seed-7_2024-01-02-15-26-08
2024-01-02 15:26:08,645 - dataset: MIntRec
2024-01-02 15:26:08,645 - data_mode: multi-class
2024-01-02 15:26:08,645 - method: msz
2024-01-02 15:26:08,646 - text_backbone: bert-base-uncased
2024-01-02 15:26:08,646 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-02 15:26:08,646 - seed: 7
2024-01-02 15:26:08,646 - num_workers: 8
2024-01-02 15:26:08,646 - gpu_id: 1
2024-01-02 15:26:08,646 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-02 15:26:08,646 - train: True
2024-01-02 15:26:08,646 - tune: False
2024-01-02 15:26:08,646 - save_model: False
2024-01-02 15:26:08,646 - save_results: True
2024-01-02 15:26:08,646 - log_path: logs
2024-01-02 15:26:08,646 - cache_path: 
2024-01-02 15:26:08,646 - video_data_path: video_data
2024-01-02 15:26:08,646 - audio_data_path: audio_data
2024-01-02 15:26:08,646 - video_feats_path: video_feats.pkl
2024-01-02 15:26:08,646 - audio_feats_path: audio_feats.pkl
2024-01-02 15:26:08,646 - results_path: results
2024-01-02 15:26:08,646 - output_path: /home/sujianhua/Outputs/MIntRec
2024-01-02 15:26:08,646 - model_path: models
2024-01-02 15:26:08,646 - config_file_name: msz
2024-01-02 15:26:08,646 - results_file_name: msz.csv
2024-01-02 15:26:08,646 - padding_mode: zero
2024-01-02 15:26:08,646 - padding_loc: end
2024-01-02 15:26:08,646 - need_aligned: False
2024-01-02 15:26:08,646 - eval_monitor: f1
2024-01-02 15:26:08,646 - train_batch_size: 16
2024-01-02 15:26:08,646 - eval_batch_size: 8
2024-01-02 15:26:08,646 - test_batch_size: 8
2024-01-02 15:26:08,646 - wait_patience: 8
2024-01-02 15:26:08,646 - nheads: 2
2024-01-02 15:26:08,646 - encoder_layers: 2
2024-01-02 15:26:08,646 - attn_dropout: 0.1
2024-01-02 15:26:08,646 - relu_dropout: 0.1
2024-01-02 15:26:08,646 - embed_dropout: 0.1
2024-01-02 15:26:08,646 - res_dropout: 0.1
2024-01-02 15:26:08,646 - attn_mask: False
2024-01-02 15:26:08,646 - hidden_size: 768
2024-01-02 15:26:08,647 - num_attention_heads: 12
2024-01-02 15:26:08,647 - attention_probs_dropout_prob: 0.2
2024-01-02 15:26:08,647 - hidden_dropout_prob: 0.2
2024-01-02 15:26:08,647 - intermediate_size: 768
2024-01-02 15:26:08,647 - num_hidden_layers: 3
2024-01-02 15:26:08,647 - max_position_embeddings: 512
2024-01-02 15:26:08,647 - position_embedding_type: absolute
2024-01-02 15:26:08,647 - batch_first: True
2024-01-02 15:26:08,647 - hidden_dims: 768
2024-01-02 15:26:08,647 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-02 15:26:08,647 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-02 15:26:08,647 - ta_loss: 0.07
2024-01-02 15:26:08,647 - tv_loss: 0.01
2024-01-02 15:26:08,647 - av_loss: 0.01
2024-01-02 15:26:08,647 - aligned_method: conv1d
2024-01-02 15:26:08,647 - grad_clip: -1
2024-01-02 15:26:08,647 - num_train_epochs: 100
2024-01-02 15:26:08,647 - warmup_proportion: 0.1
2024-01-02 15:26:08,647 - lr: 1e-06
2024-01-02 15:26:08,647 - weight_decay: 0.02
2024-01-02 15:26:08,647 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-7_2024-01-02-15-26-08
2024-01-02 15:26:08,647 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-7_2024-01-02-15-26-08/models
2024-01-02 15:26:08,647 - ============================== End Params ==============================
2024-01-02 15:26:08,650 - Generate Text Features Begin...
2024-01-02 15:26:09,143 - Generate Text Features Finished...
2024-01-02 15:26:09,143 - Load Video Features Begin...
2024-01-02 15:26:09,406 - Load Video Features Finished...
2024-01-02 15:26:09,945 - Load Audio Features Begin...
2024-01-02 15:26:10,764 - Load Audio Features Finished...
2024-01-02 15:26:14,544 - method  begins...
2024-01-02 15:26:17,412 - Multimodal intent recognition begins...
2024-01-02 15:26:17,412 - Training begins...
2024-01-02 15:26:42,441 - ***** Epoch: 1: Eval results *****
2024-01-02 15:26:42,442 -   train_loss = 3.2602
2024-01-02 15:26:42,442 -   best_eval_score = 0.0
2024-01-02 15:26:42,442 -   eval_score = 0.032
2024-01-02 15:27:06,091 - ***** Epoch: 2: Eval results *****
2024-01-02 15:27:06,091 -   train_loss = 3.0795
2024-01-02 15:27:06,091 -   best_eval_score = 0.032
2024-01-02 15:27:06,091 -   eval_score = 0.0425
2024-01-02 15:27:29,651 - ***** Epoch: 3: Eval results *****
2024-01-02 15:27:29,652 -   train_loss = 2.9091
2024-01-02 15:27:29,652 -   best_eval_score = 0.0425
2024-01-02 15:27:29,652 -   eval_score = 0.1179
2024-01-02 15:27:52,699 - ***** Epoch: 4: Eval results *****
2024-01-02 15:27:52,699 -   train_loss = 2.6918
2024-01-02 15:27:52,699 -   best_eval_score = 0.1179
2024-01-02 15:27:52,699 -   eval_score = 0.1992
2024-01-02 15:28:15,969 - ***** Epoch: 5: Eval results *****
2024-01-02 15:28:15,969 -   train_loss = 2.3763
2024-01-02 15:28:15,969 -   best_eval_score = 0.1992
2024-01-02 15:28:15,969 -   eval_score = 0.2911
2024-01-02 15:28:39,170 - ***** Epoch: 6: Eval results *****
2024-01-02 15:28:39,171 -   train_loss = 2.0351
2024-01-02 15:28:39,171 -   best_eval_score = 0.2911
2024-01-02 15:28:39,171 -   eval_score = 0.3981
2024-01-02 15:29:02,336 - ***** Epoch: 7: Eval results *****
2024-01-02 15:29:02,337 -   train_loss = 1.7104
2024-01-02 15:29:02,337 -   best_eval_score = 0.3981
2024-01-02 15:29:02,337 -   eval_score = 0.4709
2024-01-02 15:29:25,619 - ***** Epoch: 8: Eval results *****
2024-01-02 15:29:25,619 -   train_loss = 1.4188
2024-01-02 15:29:25,619 -   best_eval_score = 0.4709
2024-01-02 15:29:25,620 -   eval_score = 0.5181
2024-01-02 15:29:48,855 - ***** Epoch: 9: Eval results *****
2024-01-02 15:29:48,855 -   train_loss = 1.1789
2024-01-02 15:29:48,855 -   best_eval_score = 0.5181
2024-01-02 15:29:48,855 -   eval_score = 0.5688
2024-01-02 15:30:11,718 - ***** Epoch: 10: Eval results *****
2024-01-02 15:30:11,718 -   train_loss = 0.9748
2024-01-02 15:30:11,718 -   best_eval_score = 0.5688
2024-01-02 15:30:11,718 -   eval_score = 0.5568
2024-01-02 15:30:11,718 - EarlyStopping counter: 1 out of 8
2024-01-02 15:30:34,606 - ***** Epoch: 11: Eval results *****
2024-01-02 15:30:34,606 -   train_loss = 0.7791
2024-01-02 15:30:34,606 -   best_eval_score = 0.5688
2024-01-02 15:30:34,606 -   eval_score = 0.576
2024-01-02 15:30:57,405 - ***** Epoch: 12: Eval results *****
2024-01-02 15:30:57,405 -   train_loss = 0.6544
2024-01-02 15:30:57,405 -   best_eval_score = 0.576
2024-01-02 15:30:57,405 -   eval_score = 0.6026
2024-01-02 15:31:20,435 - ***** Epoch: 13: Eval results *****
2024-01-02 15:31:20,435 -   train_loss = 0.5426
2024-01-02 15:31:20,435 -   best_eval_score = 0.6026
2024-01-02 15:31:20,435 -   eval_score = 0.6063
2024-01-02 15:31:43,350 - ***** Epoch: 14: Eval results *****
2024-01-02 15:31:43,351 -   train_loss = 0.4358
2024-01-02 15:31:43,351 -   best_eval_score = 0.6063
2024-01-02 15:31:43,351 -   eval_score = 0.6291
2024-01-02 15:32:06,727 - ***** Epoch: 15: Eval results *****
2024-01-02 15:32:06,727 -   train_loss = 0.3509
2024-01-02 15:32:06,727 -   best_eval_score = 0.6291
2024-01-02 15:32:06,727 -   eval_score = 0.6626
2024-01-02 15:32:30,011 - ***** Epoch: 16: Eval results *****
2024-01-02 15:32:30,011 -   train_loss = 0.2865
2024-01-02 15:32:30,011 -   best_eval_score = 0.6626
2024-01-02 15:32:30,011 -   eval_score = 0.6235
2024-01-02 15:32:30,011 - EarlyStopping counter: 1 out of 8
2024-01-02 15:32:53,015 - ***** Epoch: 17: Eval results *****
2024-01-02 15:32:53,015 -   train_loss = 0.2516
2024-01-02 15:32:53,015 -   best_eval_score = 0.6626
2024-01-02 15:32:53,015 -   eval_score = 0.6337
2024-01-02 15:32:53,015 - EarlyStopping counter: 2 out of 8
2024-01-02 15:33:15,824 - ***** Epoch: 18: Eval results *****
2024-01-02 15:33:15,824 -   train_loss = 0.1842
2024-01-02 15:33:15,824 -   best_eval_score = 0.6626
2024-01-02 15:33:15,824 -   eval_score = 0.6507
2024-01-02 15:33:15,824 - EarlyStopping counter: 3 out of 8
2024-01-02 15:33:38,654 - ***** Epoch: 19: Eval results *****
2024-01-02 15:33:38,655 -   train_loss = 0.1484
2024-01-02 15:33:38,655 -   best_eval_score = 0.6626
2024-01-02 15:33:38,655 -   eval_score = 0.6428
2024-01-02 15:33:38,655 - EarlyStopping counter: 4 out of 8
2024-01-02 15:34:01,470 - ***** Epoch: 20: Eval results *****
2024-01-02 15:34:01,470 -   train_loss = 0.1457
2024-01-02 15:34:01,471 -   best_eval_score = 0.6626
2024-01-02 15:34:01,471 -   eval_score = 0.6296
2024-01-02 15:34:01,471 - EarlyStopping counter: 5 out of 8
2024-01-02 15:34:24,663 - ***** Epoch: 21: Eval results *****
2024-01-02 15:34:24,663 -   train_loss = 0.1159
2024-01-02 15:34:24,664 -   best_eval_score = 0.6626
2024-01-02 15:34:24,664 -   eval_score = 0.6512
2024-01-02 15:34:24,664 - EarlyStopping counter: 6 out of 8
2024-01-02 15:34:47,641 - ***** Epoch: 22: Eval results *****
2024-01-02 15:34:47,641 -   train_loss = 0.0945
2024-01-02 15:34:47,642 -   best_eval_score = 0.6626
2024-01-02 15:34:47,642 -   eval_score = 0.6565
2024-01-02 15:34:47,642 - EarlyStopping counter: 7 out of 8
2024-01-02 15:35:10,700 - ***** Epoch: 23: Eval results *****
2024-01-02 15:35:10,700 -   train_loss = 0.0777
2024-01-02 15:35:10,700 -   best_eval_score = 0.6626
2024-01-02 15:35:10,700 -   eval_score = 0.6492
2024-01-02 15:35:10,701 - EarlyStopping counter: 8 out of 8
2024-01-02 15:35:10,701 - EarlyStopping at epoch 23
2024-01-02 15:35:10,703 - Training is finished...
2024-01-02 15:35:10,704 - Testing begins...
2024-01-02 15:35:15,035 - ***** Test: Confusion Matrix *****
2024-01-02 15:35:15,036 - [[30  4  0  0  9  0  2  2  1  4  0  0  2  2  0  1  0  0  0  0]
 [ 0 40  0  0  0  1  0  0  0  0  0  0  1  1  0  0  0  0  0  0]
 [ 1  0 25  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 13  0  4  0  1  1  0  1  0  2  0  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  1  0  0  0  0  0]
 [ 0  3  0  0  1  0  2  0  3  0  0  0  1  0  1  1  0  0  0  0]
 [ 1  2  0  0  0  0  0  5  0  1  1  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  1  0  0  1  4  0  0  0  0  1  0  1  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  0  4  1  0  0  0  0  3  0  1  0  0]
 [ 1  0  0  0  0  0  0  1  0  3 12  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  2  0  0  0  0 17  0  0  0  0  0  0  0  0]
 [ 1  3  0  0  1  0  1  3  1  0  0  0 31  9  1  4  0  0  1  1]
 [ 0  0  0  0  0  0  1  0  1  0  1  1  0 21  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  6 14  0  1  0  0  1]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  2  0  1 17  0  0  0  0]
 [ 1  0  0  0  0  0  0  1  0  0  0  0  2  0  2  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  2  0  1  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  2  0  0  0  0  6]]
2024-01-02 15:35:15,036 - ***** Evaluation results *****
2024-01-02 15:35:15,036 -   acc = 0.6899
2024-01-02 15:35:15,036 -   f1 = 0.6649
2024-01-02 15:35:15,036 -   prec = 0.6795
2024-01-02 15:35:15,036 -   rec = 0.6693
2024-01-02 15:35:15,037 - Testing is finished...
2024-01-02 15:35:15,037 - Multimodal intent recognition is finished...
2024-01-02 15:35:15,037 - Results are saved in results/msz.csv
