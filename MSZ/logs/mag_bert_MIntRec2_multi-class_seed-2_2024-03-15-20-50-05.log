2024-03-15 20:50:05,333 - ============================== Params ==============================
2024-03-15 20:50:05,333 - logger_name: mag_bert_MIntRec2_multi-class_seed-2_2024-03-15-20-50-05
2024-03-15 20:50:05,333 - dataset: MIntRec2
2024-03-15 20:50:05,333 - data_mode: multi-class
2024-03-15 20:50:05,333 - method: mag_bert
2024-03-15 20:50:05,333 - text_backbone: bert-base-uncased
2024-03-15 20:50:05,333 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-15 20:50:05,333 - seed: 2
2024-03-15 20:50:05,333 - num_workers: 8
2024-03-15 20:50:05,333 - gpu_id: 2
2024-03-15 20:50:05,333 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-15 20:50:05,333 - train: True
2024-03-15 20:50:05,333 - tune: True
2024-03-15 20:50:05,334 - save_model: False
2024-03-15 20:50:05,334 - save_results: True
2024-03-15 20:50:05,334 - log_path: logs
2024-03-15 20:50:05,334 - cache_path: 
2024-03-15 20:50:05,334 - video_data_path: video_data
2024-03-15 20:50:05,334 - audio_data_path: audio_data
2024-03-15 20:50:05,334 - video_feats_path: video_feats.pkl
2024-03-15 20:50:05,334 - audio_feats_path: audio_feats.pkl
2024-03-15 20:50:05,334 - results_path: results
2024-03-15 20:50:05,334 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-15 20:50:05,334 - model_path: models
2024-03-15 20:50:05,334 - config_file_name: mag_bert_MIntRec2
2024-03-15 20:50:05,334 - results_file_name: mag_bert.csv
2024-03-15 20:50:05,334 - padding_mode: zero
2024-03-15 20:50:05,334 - padding_loc: end
2024-03-15 20:50:05,334 - need_aligned: True
2024-03-15 20:50:05,334 - eval_monitor: f1
2024-03-15 20:50:05,334 - train_batch_size: 32
2024-03-15 20:50:05,334 - eval_batch_size: 16
2024-03-15 20:50:05,334 - test_batch_size: 16
2024-03-15 20:50:05,334 - wait_patience: 8
2024-03-15 20:50:05,334 - num_train_epochs: 100
2024-03-15 20:50:05,334 - beta_shift: 0.01
2024-03-15 20:50:05,334 - dropout_prob: 0.1
2024-03-15 20:50:05,334 - warmup_proportion: 0.3
2024-03-15 20:50:05,334 - lr: 2e-05
2024-03-15 20:50:05,334 - aligned_method: conv1d
2024-03-15 20:50:05,334 - weight_decay: 0.03
2024-03-15 20:50:05,334 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-2_2024-03-15-20-50-05
2024-03-15 20:50:05,334 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-2_2024-03-15-20-50-05/models
2024-03-15 20:50:05,334 - num_labels: 30
2024-03-15 20:50:05,334 - text_feat_dim: 768
2024-03-15 20:50:05,334 - video_feat_dim: 256
2024-03-15 20:50:05,334 - audio_feat_dim: 768
2024-03-15 20:50:05,334 - text_seq_len: 50
2024-03-15 20:50:05,334 - video_seq_len: 180
2024-03-15 20:50:05,334 - audio_seq_len: 400
2024-03-15 20:50:05,334 - device: cuda:2
2024-03-15 20:50:05,334 - ============================== End Params ==============================
2024-03-15 20:50:05,347 - Generate Text Features Begin...
2024-03-15 20:50:06,944 - Generate Text Features Finished...
2024-03-15 20:50:06,945 - Load Video Features Begin...
2024-03-15 20:50:07,986 - Load Video Features Finished...
2024-03-15 20:50:09,671 - Load Audio Features Begin...
2024-03-15 20:50:13,654 - Load Audio Features Finished...
2024-03-15 20:50:23,737 - method  begins...
2024-03-15 20:50:24,738 - Multimodal intent recognition begins...
2024-03-15 20:50:24,739 - Training begins...
2024-03-15 20:50:57,482 - ***** Epoch: 1: Eval results *****
2024-03-15 20:50:57,482 -   train_loss = 3.4049
2024-03-15 20:50:57,482 -   best_eval_score = 0.0
2024-03-15 20:50:57,482 -   eval_score = 0.0186
2024-03-15 20:51:30,593 - ***** Epoch: 2: Eval results *****
2024-03-15 20:51:30,594 -   train_loss = 3.2401
2024-03-15 20:51:30,594 -   best_eval_score = 0.0186
2024-03-15 20:51:30,594 -   eval_score = 0.0736
2024-03-15 20:52:02,744 - ***** Epoch: 3: Eval results *****
2024-03-15 20:52:02,744 -   train_loss = 2.9466
2024-03-15 20:52:02,744 -   best_eval_score = 0.0736
2024-03-15 20:52:02,744 -   eval_score = 0.1538
2024-03-15 20:52:34,941 - ***** Epoch: 4: Eval results *****
2024-03-15 20:52:34,941 -   train_loss = 2.632
2024-03-15 20:52:34,942 -   best_eval_score = 0.1538
2024-03-15 20:52:34,942 -   eval_score = 0.2315
2024-03-15 20:53:07,515 - ***** Epoch: 5: Eval results *****
2024-03-15 20:53:07,515 -   train_loss = 2.3387
2024-03-15 20:53:07,515 -   best_eval_score = 0.2315
2024-03-15 20:53:07,515 -   eval_score = 0.2786
2024-03-15 20:53:39,675 - ***** Epoch: 6: Eval results *****
2024-03-15 20:53:39,675 -   train_loss = 2.0716
2024-03-15 20:53:39,675 -   best_eval_score = 0.2786
2024-03-15 20:53:39,675 -   eval_score = 0.3115
2024-03-15 20:54:12,959 - ***** Epoch: 7: Eval results *****
2024-03-15 20:54:12,959 -   train_loss = 1.8539
2024-03-15 20:54:12,959 -   best_eval_score = 0.3115
2024-03-15 20:54:12,959 -   eval_score = 0.3578
2024-03-15 20:54:44,103 - ***** Epoch: 8: Eval results *****
2024-03-15 20:54:44,104 -   train_loss = 1.6682
2024-03-15 20:54:44,104 -   best_eval_score = 0.3578
2024-03-15 20:54:44,104 -   eval_score = 0.3741
2024-03-15 20:55:16,352 - ***** Epoch: 9: Eval results *****
2024-03-15 20:55:16,353 -   train_loss = 1.5047
2024-03-15 20:55:16,353 -   best_eval_score = 0.3741
2024-03-15 20:55:16,353 -   eval_score = 0.3963
2024-03-15 20:55:48,604 - ***** Epoch: 10: Eval results *****
2024-03-15 20:55:48,604 -   train_loss = 1.3579
2024-03-15 20:55:48,604 -   best_eval_score = 0.3963
2024-03-15 20:55:48,604 -   eval_score = 0.4062
2024-03-15 20:56:20,328 - ***** Epoch: 11: Eval results *****
2024-03-15 20:56:20,329 -   train_loss = 1.2187
2024-03-15 20:56:20,329 -   best_eval_score = 0.4062
2024-03-15 20:56:20,329 -   eval_score = 0.4198
2024-03-15 20:56:52,769 - ***** Epoch: 12: Eval results *****
2024-03-15 20:56:52,769 -   train_loss = 1.0848
2024-03-15 20:56:52,769 -   best_eval_score = 0.4198
2024-03-15 20:56:52,769 -   eval_score = 0.4429
2024-03-15 20:57:25,026 - ***** Epoch: 13: Eval results *****
2024-03-15 20:57:25,027 -   train_loss = 0.9508
2024-03-15 20:57:25,027 -   best_eval_score = 0.4429
2024-03-15 20:57:25,027 -   eval_score = 0.4571
2024-03-15 20:57:57,049 - ***** Epoch: 14: Eval results *****
2024-03-15 20:57:57,050 -   train_loss = 0.8242
2024-03-15 20:57:57,050 -   best_eval_score = 0.4571
2024-03-15 20:57:57,050 -   eval_score = 0.4577
2024-03-15 20:58:29,106 - ***** Epoch: 15: Eval results *****
2024-03-15 20:58:29,106 -   train_loss = 0.7163
2024-03-15 20:58:29,107 -   best_eval_score = 0.4577
2024-03-15 20:58:29,107 -   eval_score = 0.4648
2024-03-15 20:59:00,716 - ***** Epoch: 16: Eval results *****
2024-03-15 20:59:00,716 -   train_loss = 0.6116
2024-03-15 20:59:00,716 -   best_eval_score = 0.4648
2024-03-15 20:59:00,716 -   eval_score = 0.4859
2024-03-15 20:59:33,096 - ***** Epoch: 17: Eval results *****
2024-03-15 20:59:33,097 -   train_loss = 0.5173
2024-03-15 20:59:33,097 -   best_eval_score = 0.4859
2024-03-15 20:59:33,097 -   eval_score = 0.4791
2024-03-15 20:59:33,097 - EarlyStopping counter: 1 out of 8
2024-03-15 21:00:05,444 - ***** Epoch: 18: Eval results *****
2024-03-15 21:00:05,444 -   train_loss = 0.4303
2024-03-15 21:00:05,444 -   best_eval_score = 0.4859
2024-03-15 21:00:05,444 -   eval_score = 0.4951
2024-03-15 21:00:37,709 - ***** Epoch: 19: Eval results *****
2024-03-15 21:00:37,709 -   train_loss = 0.3564
2024-03-15 21:00:37,709 -   best_eval_score = 0.4951
2024-03-15 21:00:37,709 -   eval_score = 0.476
2024-03-15 21:00:37,709 - EarlyStopping counter: 1 out of 8
2024-03-15 21:01:10,002 - ***** Epoch: 20: Eval results *****
2024-03-15 21:01:10,002 -   train_loss = 0.3002
2024-03-15 21:01:10,002 -   best_eval_score = 0.4951
2024-03-15 21:01:10,002 -   eval_score = 0.4986
2024-03-15 21:01:42,266 - ***** Epoch: 21: Eval results *****
2024-03-15 21:01:42,266 -   train_loss = 0.2423
2024-03-15 21:01:42,266 -   best_eval_score = 0.4986
2024-03-15 21:01:42,266 -   eval_score = 0.4818
2024-03-15 21:01:42,266 - EarlyStopping counter: 1 out of 8
2024-03-15 21:02:14,575 - ***** Epoch: 22: Eval results *****
2024-03-15 21:02:14,576 -   train_loss = 0.2014
2024-03-15 21:02:14,576 -   best_eval_score = 0.4986
2024-03-15 21:02:14,576 -   eval_score = 0.4883
2024-03-15 21:02:14,576 - EarlyStopping counter: 2 out of 8
2024-03-15 21:02:47,268 - ***** Epoch: 23: Eval results *****
2024-03-15 21:02:47,271 -   train_loss = 0.1755
2024-03-15 21:02:47,271 -   best_eval_score = 0.4986
2024-03-15 21:02:47,271 -   eval_score = 0.4957
2024-03-15 21:02:47,271 - EarlyStopping counter: 3 out of 8
2024-03-15 21:03:18,316 - ***** Epoch: 24: Eval results *****
2024-03-15 21:03:18,316 -   train_loss = 0.1539
2024-03-15 21:03:18,316 -   best_eval_score = 0.4986
2024-03-15 21:03:18,316 -   eval_score = 0.4932
2024-03-15 21:03:18,316 - EarlyStopping counter: 4 out of 8
2024-03-15 21:03:50,436 - ***** Epoch: 25: Eval results *****
2024-03-15 21:03:50,436 -   train_loss = 0.1293
2024-03-15 21:03:50,436 -   best_eval_score = 0.4986
2024-03-15 21:03:50,437 -   eval_score = 0.5064
2024-03-15 21:04:22,793 - ***** Epoch: 26: Eval results *****
2024-03-15 21:04:22,793 -   train_loss = 0.1191
2024-03-15 21:04:22,793 -   best_eval_score = 0.5064
2024-03-15 21:04:22,793 -   eval_score = 0.4928
2024-03-15 21:04:22,793 - EarlyStopping counter: 1 out of 8
2024-03-15 21:04:55,521 - ***** Epoch: 27: Eval results *****
2024-03-15 21:04:55,521 -   train_loss = 0.1178
2024-03-15 21:04:55,521 -   best_eval_score = 0.5064
2024-03-15 21:04:55,521 -   eval_score = 0.4971
2024-03-15 21:04:55,521 - EarlyStopping counter: 2 out of 8
2024-03-15 21:05:27,834 - ***** Epoch: 28: Eval results *****
2024-03-15 21:05:27,834 -   train_loss = 0.1244
2024-03-15 21:05:27,834 -   best_eval_score = 0.5064
2024-03-15 21:05:27,835 -   eval_score = 0.4959
2024-03-15 21:05:27,835 - EarlyStopping counter: 3 out of 8
2024-03-15 21:06:01,377 - ***** Epoch: 29: Eval results *****
2024-03-15 21:06:01,377 -   train_loss = 0.093
2024-03-15 21:06:01,377 -   best_eval_score = 0.5064
2024-03-15 21:06:01,377 -   eval_score = 0.4848
2024-03-15 21:06:01,378 - EarlyStopping counter: 4 out of 8
2024-03-15 21:06:33,446 - ***** Epoch: 30: Eval results *****
2024-03-15 21:06:33,446 -   train_loss = 0.0975
2024-03-15 21:06:33,446 -   best_eval_score = 0.5064
2024-03-15 21:06:33,446 -   eval_score = 0.5096
2024-03-15 21:07:06,216 - ***** Epoch: 31: Eval results *****
2024-03-15 21:07:06,217 -   train_loss = 0.0846
2024-03-15 21:07:06,217 -   best_eval_score = 0.5096
2024-03-15 21:07:06,217 -   eval_score = 0.5018
2024-03-15 21:07:06,217 - EarlyStopping counter: 1 out of 8
2024-03-15 21:07:38,603 - ***** Epoch: 32: Eval results *****
2024-03-15 21:07:38,603 -   train_loss = 0.0793
2024-03-15 21:07:38,603 -   best_eval_score = 0.5096
2024-03-15 21:07:38,603 -   eval_score = 0.5094
2024-03-15 21:07:38,603 - EarlyStopping counter: 2 out of 8
2024-03-15 21:08:11,253 - ***** Epoch: 33: Eval results *****
2024-03-15 21:08:11,253 -   train_loss = 0.0662
2024-03-15 21:08:11,253 -   best_eval_score = 0.5096
2024-03-15 21:08:11,253 -   eval_score = 0.5023
2024-03-15 21:08:11,254 - EarlyStopping counter: 3 out of 8
2024-03-15 21:08:44,439 - ***** Epoch: 34: Eval results *****
2024-03-15 21:08:44,439 -   train_loss = 0.0757
2024-03-15 21:08:44,439 -   best_eval_score = 0.5096
2024-03-15 21:08:44,439 -   eval_score = 0.4739
2024-03-15 21:08:44,439 - EarlyStopping counter: 4 out of 8
2024-03-15 21:09:16,395 - ***** Epoch: 35: Eval results *****
2024-03-15 21:09:16,396 -   train_loss = 0.0763
2024-03-15 21:09:16,396 -   best_eval_score = 0.5096
2024-03-15 21:09:16,396 -   eval_score = 0.4928
2024-03-15 21:09:16,396 - EarlyStopping counter: 5 out of 8
2024-03-15 21:09:49,212 - ***** Epoch: 36: Eval results *****
2024-03-15 21:09:49,212 -   train_loss = 0.0728
2024-03-15 21:09:49,212 -   best_eval_score = 0.5096
2024-03-15 21:09:49,212 -   eval_score = 0.4922
2024-03-15 21:09:49,212 - EarlyStopping counter: 6 out of 8
2024-03-15 21:10:21,047 - ***** Epoch: 37: Eval results *****
2024-03-15 21:10:21,047 -   train_loss = 0.0691
2024-03-15 21:10:21,047 -   best_eval_score = 0.5096
2024-03-15 21:10:21,048 -   eval_score = 0.5023
2024-03-15 21:10:21,048 - EarlyStopping counter: 7 out of 8
2024-03-15 21:10:53,068 - ***** Epoch: 38: Eval results *****
2024-03-15 21:10:53,068 -   train_loss = 0.0602
2024-03-15 21:10:53,068 -   best_eval_score = 0.5096
2024-03-15 21:10:53,068 -   eval_score = 0.5006
2024-03-15 21:10:53,068 - EarlyStopping counter: 8 out of 8
2024-03-15 21:10:53,068 - EarlyStopping at epoch 38
2024-03-15 21:10:53,071 - Training is finished...
2024-03-15 21:10:53,071 - Testing begins...
2024-03-15 21:10:59,299 - ***** Test: Confusion Matrix *****
2024-03-15 21:10:59,304 - [[ 42   0  17   0   0   0   0   0   0   0   2   0   0   0   1   0   0   0
    0   0   0   1   1   1   3   0   0   0   0   0]
 [  0  60   0   0   9   1   2   0   2   0   1   0   4   0   9   0   1   3
    0   1   0   0   1   0   1   0   0   2   0   0]
 [  8   1  43   0   1   0   0   0   0   0   1   0   0   2   2   0   0   2
    0   0   0   1   0   1   2   0   0   0   0   0]
 [  0   0   0  61   0   0   0   1   0   1   0   0   0   0   2   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   3   0   0  34   0   0   0   1   0   0   0   0   0   1   0   0   4
    0   1   0   1   0   2   1   0   0   0   1   2]
 [  0   3   0   0   0  22   0   0   1   2   2   0   0   0   0   0   0   4
    0   1   0   0   0   1   0   0   1   0   0   0]
 [  0   1   0   0   0   3  24   8   0   2   4   1   2   0   0   0   0   0
    0   2   0   0   0   0   0   1   0   0   0   0]
 [  0   0   0   0   0   1   5  24   0   1   9   0   4   0   0   0   3   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  1   2   2   1   1   0   0   0  24   0   0   2   1   0   7   0   0   2
    0   0   0   1   2   0   2   0   0   1   0   0]
 [  0   0   1   1   1   0   0   0   2  49   0   8  10   1  14   0   0   4
    1   0   0   4   3   1   1   1   1   4   0   0]
 [  2   0   0   0   0   5   3   1   0   0  52   0  22   0   3   0   0   2
    0   2   0   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   0   2   1   8   1  18   6   0   4   0   0   2
    0   0   0   0   2   0   0   0   0   3   0   0]
 [  0   0   0   0   0   0   9   5   0   6  32   2  74   0   1   0   4   0
    0   0   0   0   1   0   0   0   0   1   0   0]
 [  0   0   2   0   1   0   0   0   1   1   0   0   0   1   5   1   0   2
    2   0   1   0   0   0   0   0   0   0   0   0]
 [  0   3   1   0   1   0   0   0   5  10   2   2   2   1 132   2   0  14
    2   1   0   0   7   0   5   1   0   1   0   1]
 [  0   0   2   0   1   0   0   0   0   5   0   0   0   1   3   6   0   0
    1   0   0   1   1   0   0   0   0   0   1   0]
 [  0   1   0   0   1   0   0   2   1   0   2   0   1   0   0   0  53   0
    4   0   0   0   0   0   1   0   0   0   0   0]
 [  0   7   2   0   8   3   1   0   6  18   1   1   0   3  31   6   2  90
    7   0   2   3   7  10   1   1   1   2   1   3]
 [  0   0   0   0   1   0   1   0   0   3   2   0   0   2  15   2   2   4
   23   0   2   0   0   0   3   0   0   0   0   0]
 [  0   8   0   0   1   0   2   0   0   0   1   0   0   0   0   0   0   0
    0   4   0   1   0   0   0   0   0   0   0   0]
 [  0   2   2   0   1   0   0   0   0   2   0   1   1   0   5   1   0   3
    4   0   3   0   0   2   1   0   0   1   0   0]
 [  6   2   0   0   0   0   0   0   0   3   0   0   0   0   1   0   4   0
    0   0   0  18   2  10   1   0   2   2   0   2]
 [  0   1   0   0   0   0   0   0   1   4   1   2   0   1  11   1   0   3
    0   0   0   2  76   0   1   2   9   2   0   0]
 [  0   4   2   0   1   0   0   0   0   3   0   0   0   0   0   0   0   5
    0   0   0   0   0  23   0   0   0   0   0   0]
 [  2   0   2   0   0   0   0   0   0   1   0   2   0   0   6   2   0   1
    0   0   0   0   1   0  87   0   0   8   1   0]
 [  1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   2
    0   0   0   0   3   0   1  19   2   0   0   2]
 [  0   0   0   0   0   0   0   0   0   2   0   0   0   0   1   0   0   3
    0   0   0   1   3   0   0   0   5   0   2   0]
 [  0   2   1   0   0   0   1   0   2   8   2   5   3   0   7   0   0   2
    0   0   0   0   2   0   9   1   1  11   0   1]
 [  0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   1   0
    0   0   0   0   0   0   0   0   0   1  55   0]
 [  0   1   0   0   0   0   0   0   2   2   1   1   0   0   0   0   0   3
    1   0   0   0   0   0   1   1   0   0   0   6]]
2024-03-15 21:10:59,304 - ***** Evaluation results *****
2024-03-15 21:10:59,304 -   acc = 0.5603
2024-03-15 21:10:59,304 -   f1 = 0.5069
2024-03-15 21:10:59,305 -   prec = 0.5193
2024-03-15 21:10:59,305 -   rec = 0.5079
2024-03-15 21:10:59,305 - Testing is finished...
2024-03-15 21:10:59,305 - Multimodal intent recognition is finished...
2024-03-15 21:10:59,305 - Results are saved in results/mag_bert.csv
