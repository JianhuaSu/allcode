2024-03-15 07:27:17,486 - ============================== Params ==============================
2024-03-15 07:27:17,486 - logger_name: mag_bert_MIntRec2_multi-class_seed-1_2024-03-15-07-27-17
2024-03-15 07:27:17,486 - dataset: MIntRec2
2024-03-15 07:27:17,486 - data_mode: multi-class
2024-03-15 07:27:17,486 - method: mag_bert
2024-03-15 07:27:17,486 - text_backbone: bert-base-uncased
2024-03-15 07:27:17,486 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-15 07:27:17,487 - seed: 1
2024-03-15 07:27:17,487 - num_workers: 8
2024-03-15 07:27:17,487 - gpu_id: 2
2024-03-15 07:27:17,487 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-15 07:27:17,487 - train: True
2024-03-15 07:27:17,487 - tune: True
2024-03-15 07:27:17,487 - save_model: False
2024-03-15 07:27:17,487 - save_results: True
2024-03-15 07:27:17,487 - log_path: logs
2024-03-15 07:27:17,487 - cache_path: 
2024-03-15 07:27:17,487 - video_data_path: video_data
2024-03-15 07:27:17,487 - audio_data_path: audio_data
2024-03-15 07:27:17,487 - video_feats_path: video_feats.pkl
2024-03-15 07:27:17,487 - audio_feats_path: audio_feats.pkl
2024-03-15 07:27:17,487 - results_path: results
2024-03-15 07:27:17,487 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-15 07:27:17,487 - model_path: models
2024-03-15 07:27:17,487 - config_file_name: mag_bert_MIntRec2
2024-03-15 07:27:17,487 - results_file_name: mag_bert.csv
2024-03-15 07:27:17,487 - padding_mode: zero
2024-03-15 07:27:17,487 - padding_loc: end
2024-03-15 07:27:17,487 - need_aligned: True
2024-03-15 07:27:17,487 - eval_monitor: f1
2024-03-15 07:27:17,487 - train_batch_size: 32
2024-03-15 07:27:17,487 - eval_batch_size: 16
2024-03-15 07:27:17,487 - test_batch_size: 16
2024-03-15 07:27:17,487 - wait_patience: 8
2024-03-15 07:27:17,487 - num_train_epochs: 100
2024-03-15 07:27:17,487 - beta_shift: 0.01
2024-03-15 07:27:17,487 - dropout_prob: 0.1
2024-03-15 07:27:17,487 - warmup_proportion: 0.1
2024-03-15 07:27:17,487 - lr: 2e-05
2024-03-15 07:27:17,487 - aligned_method: ctc
2024-03-15 07:27:17,487 - weight_decay: 0.03
2024-03-15 07:27:17,487 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-1_2024-03-15-07-27-17
2024-03-15 07:27:17,487 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-1_2024-03-15-07-27-17/models
2024-03-15 07:27:17,487 - ============================== End Params ==============================
2024-03-15 07:27:17,672 - Generate Text Features Begin...
2024-03-15 07:27:19,363 - Generate Text Features Finished...
2024-03-15 07:27:19,364 - Load Video Features Begin...
2024-03-15 07:28:26,853 - Load Video Features Finished...
2024-03-15 07:28:28,472 - Load Audio Features Begin...
2024-03-15 07:29:02,221 - Load Audio Features Finished...
2024-03-15 07:29:15,603 - method  begins...
2024-03-15 07:29:24,412 - Multimodal intent recognition begins...
2024-03-15 07:29:24,412 - Training begins...
2024-03-15 07:29:58,350 - ***** Epoch: 1: Eval results *****
2024-03-15 07:29:58,351 -   train_loss = 3.3337
2024-03-15 07:29:58,351 -   best_eval_score = 0.0
2024-03-15 07:29:58,351 -   eval_score = 0.0696
2024-03-15 07:30:30,850 - ***** Epoch: 2: Eval results *****
2024-03-15 07:30:30,850 -   train_loss = 2.8562
2024-03-15 07:30:30,850 -   best_eval_score = 0.0696
2024-03-15 07:30:30,850 -   eval_score = 0.1693
2024-03-15 07:31:03,416 - ***** Epoch: 3: Eval results *****
2024-03-15 07:31:03,416 -   train_loss = 2.3295
2024-03-15 07:31:03,417 -   best_eval_score = 0.1693
2024-03-15 07:31:03,417 -   eval_score = 0.278
2024-03-15 07:31:36,915 - ***** Epoch: 4: Eval results *****
2024-03-15 07:31:36,915 -   train_loss = 1.8993
2024-03-15 07:31:36,915 -   best_eval_score = 0.278
2024-03-15 07:31:36,915 -   eval_score = 0.3607
2024-03-15 07:32:09,624 - ***** Epoch: 5: Eval results *****
2024-03-15 07:32:09,624 -   train_loss = 1.5866
2024-03-15 07:32:09,624 -   best_eval_score = 0.3607
2024-03-15 07:32:09,624 -   eval_score = 0.3941
2024-03-15 07:32:41,311 - ***** Epoch: 6: Eval results *****
2024-03-15 07:32:41,312 -   train_loss = 1.3282
2024-03-15 07:32:41,312 -   best_eval_score = 0.3941
2024-03-15 07:32:41,312 -   eval_score = 0.4446
2024-03-15 07:33:13,657 - ***** Epoch: 7: Eval results *****
2024-03-15 07:33:13,657 -   train_loss = 1.1002
2024-03-15 07:33:13,657 -   best_eval_score = 0.4446
2024-03-15 07:33:13,657 -   eval_score = 0.4465
2024-03-15 07:33:46,573 - ***** Epoch: 8: Eval results *****
2024-03-15 07:33:46,573 -   train_loss = 0.8856
2024-03-15 07:33:46,573 -   best_eval_score = 0.4465
2024-03-15 07:33:46,573 -   eval_score = 0.4535
2024-03-15 07:34:19,696 - ***** Epoch: 9: Eval results *****
2024-03-15 07:34:19,696 -   train_loss = 0.7016
2024-03-15 07:34:19,697 -   best_eval_score = 0.4535
2024-03-15 07:34:19,697 -   eval_score = 0.4934
2024-03-15 07:34:52,633 - ***** Epoch: 10: Eval results *****
2024-03-15 07:34:52,633 -   train_loss = 0.5387
2024-03-15 07:34:52,633 -   best_eval_score = 0.4934
2024-03-15 07:34:52,633 -   eval_score = 0.4935
2024-03-15 07:35:25,786 - ***** Epoch: 11: Eval results *****
2024-03-15 07:35:25,786 -   train_loss = 0.4028
2024-03-15 07:35:25,787 -   best_eval_score = 0.4935
2024-03-15 07:35:25,787 -   eval_score = 0.496
2024-03-15 07:36:00,353 - ***** Epoch: 12: Eval results *****
2024-03-15 07:36:00,353 -   train_loss = 0.3013
2024-03-15 07:36:00,353 -   best_eval_score = 0.496
2024-03-15 07:36:00,353 -   eval_score = 0.5112
2024-03-15 07:36:32,900 - ***** Epoch: 13: Eval results *****
2024-03-15 07:36:32,900 -   train_loss = 0.2232
2024-03-15 07:36:32,900 -   best_eval_score = 0.5112
2024-03-15 07:36:32,900 -   eval_score = 0.5056
2024-03-15 07:36:32,900 - EarlyStopping counter: 1 out of 8
2024-03-15 07:37:05,430 - ***** Epoch: 14: Eval results *****
2024-03-15 07:37:05,431 -   train_loss = 0.182
2024-03-15 07:37:05,431 -   best_eval_score = 0.5112
2024-03-15 07:37:05,431 -   eval_score = 0.5065
2024-03-15 07:37:05,431 - EarlyStopping counter: 2 out of 8
2024-03-15 07:37:38,750 - ***** Epoch: 15: Eval results *****
2024-03-15 07:37:38,750 -   train_loss = 0.1536
2024-03-15 07:37:38,750 -   best_eval_score = 0.5112
2024-03-15 07:37:38,750 -   eval_score = 0.5003
2024-03-15 07:37:38,750 - EarlyStopping counter: 3 out of 8
2024-03-15 07:38:11,629 - ***** Epoch: 16: Eval results *****
2024-03-15 07:38:11,629 -   train_loss = 0.1249
2024-03-15 07:38:11,629 -   best_eval_score = 0.5112
2024-03-15 07:38:11,629 -   eval_score = 0.5065
2024-03-15 07:38:11,629 - EarlyStopping counter: 4 out of 8
2024-03-15 07:38:44,644 - ***** Epoch: 17: Eval results *****
2024-03-15 07:38:44,644 -   train_loss = 0.114
2024-03-15 07:38:44,644 -   best_eval_score = 0.5112
2024-03-15 07:38:44,644 -   eval_score = 0.513
2024-03-15 07:39:16,855 - ***** Epoch: 18: Eval results *****
2024-03-15 07:39:16,856 -   train_loss = 0.0949
2024-03-15 07:39:16,856 -   best_eval_score = 0.513
2024-03-15 07:39:16,856 -   eval_score = 0.5118
2024-03-15 07:39:16,856 - EarlyStopping counter: 1 out of 8
2024-03-15 07:39:49,672 - ***** Epoch: 19: Eval results *****
2024-03-15 07:39:49,672 -   train_loss = 0.0819
2024-03-15 07:39:49,672 -   best_eval_score = 0.513
2024-03-15 07:39:49,672 -   eval_score = 0.485
2024-03-15 07:39:49,673 - EarlyStopping counter: 2 out of 8
2024-03-15 07:40:22,830 - ***** Epoch: 20: Eval results *****
2024-03-15 07:40:22,831 -   train_loss = 0.0779
2024-03-15 07:40:22,831 -   best_eval_score = 0.513
2024-03-15 07:40:22,831 -   eval_score = 0.4953
2024-03-15 07:40:22,831 - EarlyStopping counter: 3 out of 8
2024-03-15 07:40:55,903 - ***** Epoch: 21: Eval results *****
2024-03-15 07:40:55,903 -   train_loss = 0.0686
2024-03-15 07:40:55,903 -   best_eval_score = 0.513
2024-03-15 07:40:55,903 -   eval_score = 0.4958
2024-03-15 07:40:55,903 - EarlyStopping counter: 4 out of 8
2024-03-15 07:41:29,501 - ***** Epoch: 22: Eval results *****
2024-03-15 07:41:29,501 -   train_loss = 0.0617
2024-03-15 07:41:29,501 -   best_eval_score = 0.513
2024-03-15 07:41:29,501 -   eval_score = 0.5084
2024-03-15 07:41:29,501 - EarlyStopping counter: 5 out of 8
2024-03-15 07:42:02,666 - ***** Epoch: 23: Eval results *****
2024-03-15 07:42:02,667 -   train_loss = 0.0594
2024-03-15 07:42:02,667 -   best_eval_score = 0.513
2024-03-15 07:42:02,667 -   eval_score = 0.5085
2024-03-15 07:42:02,667 - EarlyStopping counter: 6 out of 8
2024-03-15 07:42:34,675 - ***** Epoch: 24: Eval results *****
2024-03-15 07:42:34,675 -   train_loss = 0.0637
2024-03-15 07:42:34,675 -   best_eval_score = 0.513
2024-03-15 07:42:34,675 -   eval_score = 0.5167
2024-03-15 07:43:07,938 - ***** Epoch: 25: Eval results *****
2024-03-15 07:43:07,938 -   train_loss = 0.0566
2024-03-15 07:43:07,938 -   best_eval_score = 0.5167
2024-03-15 07:43:07,938 -   eval_score = 0.5023
2024-03-15 07:43:07,939 - EarlyStopping counter: 1 out of 8
2024-03-15 07:43:41,109 - ***** Epoch: 26: Eval results *****
2024-03-15 07:43:41,109 -   train_loss = 0.0606
2024-03-15 07:43:41,109 -   best_eval_score = 0.5167
2024-03-15 07:43:41,109 -   eval_score = 0.5174
2024-03-15 07:44:14,311 - ***** Epoch: 27: Eval results *****
2024-03-15 07:44:14,311 -   train_loss = 0.0517
2024-03-15 07:44:14,311 -   best_eval_score = 0.5174
2024-03-15 07:44:14,311 -   eval_score = 0.5168
2024-03-15 07:44:14,311 - EarlyStopping counter: 1 out of 8
2024-03-15 07:44:47,538 - ***** Epoch: 28: Eval results *****
2024-03-15 07:44:47,538 -   train_loss = 0.0595
2024-03-15 07:44:47,538 -   best_eval_score = 0.5174
2024-03-15 07:44:47,539 -   eval_score = 0.5012
2024-03-15 07:44:47,539 - EarlyStopping counter: 2 out of 8
2024-03-15 07:45:20,122 - ***** Epoch: 29: Eval results *****
2024-03-15 07:45:20,122 -   train_loss = 0.052
2024-03-15 07:45:20,122 -   best_eval_score = 0.5174
2024-03-15 07:45:20,122 -   eval_score = 0.5062
2024-03-15 07:45:20,123 - EarlyStopping counter: 3 out of 8
2024-03-15 07:45:53,078 - ***** Epoch: 30: Eval results *****
2024-03-15 07:45:53,079 -   train_loss = 0.0453
2024-03-15 07:45:53,079 -   best_eval_score = 0.5174
2024-03-15 07:45:53,079 -   eval_score = 0.495
2024-03-15 07:45:53,079 - EarlyStopping counter: 4 out of 8
2024-03-15 07:46:25,798 - ***** Epoch: 31: Eval results *****
2024-03-15 07:46:25,798 -   train_loss = 0.0484
2024-03-15 07:46:25,798 -   best_eval_score = 0.5174
2024-03-15 07:46:25,798 -   eval_score = 0.5153
2024-03-15 07:46:25,798 - EarlyStopping counter: 5 out of 8
2024-03-15 07:46:59,643 - ***** Epoch: 32: Eval results *****
2024-03-15 07:46:59,644 -   train_loss = 0.049
2024-03-15 07:46:59,644 -   best_eval_score = 0.5174
2024-03-15 07:46:59,644 -   eval_score = 0.5076
2024-03-15 07:46:59,644 - EarlyStopping counter: 6 out of 8
2024-03-15 07:47:32,963 - ***** Epoch: 33: Eval results *****
2024-03-15 07:47:32,963 -   train_loss = 0.0445
2024-03-15 07:47:32,963 -   best_eval_score = 0.5174
2024-03-15 07:47:32,963 -   eval_score = 0.4943
2024-03-15 07:47:32,963 - EarlyStopping counter: 7 out of 8
2024-03-15 07:48:06,304 - ***** Epoch: 34: Eval results *****
2024-03-15 07:48:06,304 -   train_loss = 0.0454
2024-03-15 07:48:06,304 -   best_eval_score = 0.5174
2024-03-15 07:48:06,304 -   eval_score = 0.498
2024-03-15 07:48:06,305 - EarlyStopping counter: 8 out of 8
2024-03-15 07:48:06,305 - EarlyStopping at epoch 34
2024-03-15 07:48:06,306 - Training is finished...
2024-03-15 07:48:06,306 - Testing begins...
2024-03-15 07:48:12,704 - ***** Test: Confusion Matrix *****
2024-03-15 07:48:12,706 - [[ 47   0  14   0   0   0   0   0   0   0   2   0   0   1   0   0   0   1
    0   0   0   1   1   0   1   0   0   0   0   0]
 [  0  58   0   0  10   2   5   0   2   0   2   1   1   0   4   0   0   6
    0   0   0   1   2   0   1   0   0   2   0   0]
 [ 10   1  39   0   1   0   0   0   0   1   1   0   0   3   0   0   0   3
    0   0   0   1   0   1   2   0   0   1   0   0]
 [  0   0   0  60   0   0   0   1   0   0   0   0   0   0   1   0   0   2
    0   0   0   0   0   0   1   0   0   0   0   0]
 [  0   5   0   0  31   0   0   0   1   0   0   1   0   0   0   0   0   5
    0   2   0   0   0   2   1   0   0   0   1   2]
 [  0   1   0   0   1  22   1   0   0   2   2   0   0   0   1   0   0   4
    0   0   0   0   0   1   0   0   1   0   1   0]
 [  0   1   0   0   0   2  29   5   0   0   4   0   7   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   2   0   0   0   0   5  19   0   1   7   1   6   0   0   0   4   0
    0   0   0   0   0   0   1   1   0   0   0   0]
 [  1   0   1   3   1   0   0   0  23   1   0   2   1   1   1   0   0   6
    0   2   0   1   1   0   2   2   0   0   0   0]
 [  0   0   1   2   0   0   0   0   1  37   0   9  10   2  11   1   0  15
    1   0   1   4   4   0   4   1   0   2   0   1]
 [  2   0   0   0   0   4   7   0   0   0  46   0  28   0   1   0   0   4
    0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   0   3   0  22   8   0   1   0   0   3
    0   0   1   0   2   0   0   0   1   3   0   2]
 [  0   1   1   0   0   0   9   7   0   3  26   1  82   0   0   0   1   1
    0   1   1   0   0   0   0   0   0   1   0   0]
 [  0   0   1   0   1   0   0   0   1   1   0   0   0   2   2   1   0   5
    2   0   1   0   0   0   0   0   0   0   0   0]
 [  0   1   3   0   1   1   0   0   4   6   3   3   0   4  85   0   0  53
    2   0   2   0   9   1   6   1   0   7   0   1]
 [  0   0   1   0   0   0   0   0   0   5   0   0   0   0   1   4   0   1
    4   0   0   1   2   1   0   0   0   0   1   1]
 [  0   0   0   0   1   0   1   1   0   0   2   0   2   0   0   0  56   0
    3   0   0   0   0   0   0   0   0   0   0   0]
 [  0   5   1   0  10   3   0   0   5   8   0   3   1   2  10   1   1 132
    7   0   2   2   4   8   1   2   1   2   2   4]
 [  0   2   0   0   0   0   0   0   0   2   3   0   1   0   4   1   3  18
   19   1   2   0   1   0   3   0   0   0   0   0]
 [  0   7   0   0   0   0   2   0   1   0   1   0   0   0   0   0   0   0
    0   5   0   1   0   0   0   0   0   0   0   0]
 [  0   2   0   0   0   0   0   0   0   1   1   0   0   3   3   1   0   3
    3   0   4   0   0   1   2   0   0   1   0   4]
 [  6   1   1   0   1   0   0   0   0   3   0   1   0   0   0   0   5   2
    0   1   1  24   1   3   0   0   1   1   0   1]
 [  0   1   0   0   0   0   0   0   1   1   0   3   0   1   4   0   0   7
    0   0   0   0  85   0   1   2  11   0   0   0]
 [  0   3   2   0   2   0   0   0   0   0   0   0   0   0   0   0   0   7
    0   0   1   3   0  20   0   0   0   0   0   0]
 [  1   0   2   0   0   0   1   0   1   2   1   2   0   1   1   1   0   2
    2   0   0   0   1   0  86   0   0   6   2   1]
 [  1   1   0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   1
    0   0   0   0   2   0   1  23   0   0   0   1]
 [  0   1   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   5
    0   0   0   0   1   1   0   0   7   0   1   0]
 [  0   2   1   0   2   0   0   1   3   4   2   6   3   1   3   1   0   4
    1   0   0   0   3   0   8   1   0  11   0   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
    0   0   0   0   0   0   0   0   1   1  55   0]
 [  0   1   0   0   0   0   0   0   1   0   1   1   0   0   0   0   0   3
    1   0   0   1   0   0   1   1   0   0   0   8]]
2024-03-15 07:48:12,706 - ***** Evaluation results *****
2024-03-15 07:48:12,706 -   acc = 0.5612
2024-03-15 07:48:12,706 -   f1 = 0.5145
2024-03-15 07:48:12,706 -   prec = 0.5227
2024-03-15 07:48:12,706 -   rec = 0.5181
2024-03-15 07:48:12,707 - Testing is finished...
2024-03-15 07:48:12,707 - Multimodal intent recognition is finished...
2024-03-15 07:48:12,707 - Results are saved in results/mag_bert.csv
