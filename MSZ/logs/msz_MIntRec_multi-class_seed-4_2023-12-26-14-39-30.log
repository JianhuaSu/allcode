2023-12-26 14:39:30,781 - ============================== Params ==============================
2023-12-26 14:39:30,781 - logger_name: msz_MIntRec_multi-class_seed-4_2023-12-26-14-39-30
2023-12-26 14:39:30,781 - dataset: MIntRec
2023-12-26 14:39:30,781 - data_mode: multi-class
2023-12-26 14:39:30,781 - method: msz
2023-12-26 14:39:30,781 - text_backbone: bert-base-uncased
2023-12-26 14:39:30,781 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-26 14:39:30,781 - seed: 4
2023-12-26 14:39:30,781 - num_workers: 8
2023-12-26 14:39:30,781 - gpu_id: 3
2023-12-26 14:39:30,781 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-26 14:39:30,781 - train: True
2023-12-26 14:39:30,781 - tune: False
2023-12-26 14:39:30,781 - save_model: False
2023-12-26 14:39:30,781 - save_results: True
2023-12-26 14:39:30,781 - log_path: logs
2023-12-26 14:39:30,782 - cache_path: 
2023-12-26 14:39:30,782 - video_data_path: video_data
2023-12-26 14:39:30,782 - audio_data_path: audio_data
2023-12-26 14:39:30,782 - video_feats_path: video_feats.pkl
2023-12-26 14:39:30,782 - audio_feats_path: audio_feats.pkl
2023-12-26 14:39:30,782 - results_path: results
2023-12-26 14:39:30,782 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-26 14:39:30,782 - model_path: models
2023-12-26 14:39:30,782 - config_file_name: msz
2023-12-26 14:39:30,782 - results_file_name: msz.csv
2023-12-26 14:39:30,782 - padding_mode: zero
2023-12-26 14:39:30,782 - padding_loc: end
2023-12-26 14:39:30,782 - need_aligned: False
2023-12-26 14:39:30,782 - eval_monitor: f1
2023-12-26 14:39:30,782 - train_batch_size: 16
2023-12-26 14:39:30,782 - eval_batch_size: 8
2023-12-26 14:39:30,782 - test_batch_size: 8
2023-12-26 14:39:30,782 - wait_patience: 8
2023-12-26 14:39:30,782 - nheads: 2
2023-12-26 14:39:30,782 - encoder_layers: 2
2023-12-26 14:39:30,782 - attn_dropout: 0.1
2023-12-26 14:39:30,782 - relu_dropout: 0.1
2023-12-26 14:39:30,782 - embed_dropout: 0.1
2023-12-26 14:39:30,782 - res_dropout: 0.1
2023-12-26 14:39:30,783 - attn_mask: False
2023-12-26 14:39:30,783 - hidden_size: 768
2023-12-26 14:39:30,783 - num_attention_heads: 12
2023-12-26 14:39:30,783 - attention_probs_dropout_prob: 0.2
2023-12-26 14:39:30,783 - hidden_dropout_prob: 0.2
2023-12-26 14:39:30,783 - intermediate_size: 768
2023-12-26 14:39:30,783 - num_hidden_layers: 3
2023-12-26 14:39:30,783 - max_position_embeddings: 512
2023-12-26 14:39:30,783 - position_embedding_type: absolute
2023-12-26 14:39:30,783 - add_cross_attention: False
2023-12-26 14:39:30,783 - batch_first: True
2023-12-26 14:39:30,783 - hidden_dims: 768
2023-12-26 14:39:30,783 - att_dropouts: [0.2, 0.2, 0.2]
2023-12-26 14:39:30,783 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-26 14:39:30,783 - tv_c_loss: 0.1
2023-12-26 14:39:30,783 - vt_c_loss: 0.1
2023-12-26 14:39:30,783 - at_c_loss: 0.1
2023-12-26 14:39:30,783 - aligned_method: conv1d
2023-12-26 14:39:30,783 - grad_clip: 2
2023-12-26 14:39:30,783 - num_train_epochs: 100
2023-12-26 14:39:30,783 - warmup_proportion: 0.1
2023-12-26 14:39:30,783 - lr: 1e-06
2023-12-26 14:39:30,784 - weight_decay: 0.02
2023-12-26 14:39:30,784 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2023-12-26-14-39-30
2023-12-26 14:39:30,784 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2023-12-26-14-39-30/models
2023-12-26 14:39:30,784 - ============================== End Params ==============================
2023-12-26 14:39:30,788 - Generate Text Features Begin...
2023-12-26 14:39:31,648 - Generate Text Features Finished...
2023-12-26 14:39:31,649 - Load Video Features Begin...
2023-12-26 14:39:35,220 - Load Video Features Finished...
2023-12-26 14:39:35,879 - Load Audio Features Begin...
2023-12-26 14:39:50,643 - Load Audio Features Finished...
2023-12-26 14:39:54,749 - method  begins...
2023-12-26 14:40:02,471 - Multimodal intent recognition begins...
2023-12-26 14:40:02,471 - Training begins...
2023-12-26 14:40:47,499 - ***** Epoch: 1: Eval results *****
2023-12-26 14:40:47,499 -   train_loss = 6.1514
2023-12-26 14:40:47,499 -   best_eval_score = 0.0
2023-12-26 14:40:47,499 -   eval_score = 0.0143
2023-12-26 14:41:33,266 - ***** Epoch: 2: Eval results *****
2023-12-26 14:41:33,267 -   train_loss = 5.3439
2023-12-26 14:41:33,267 -   best_eval_score = 0.0143
2023-12-26 14:41:33,268 -   eval_score = 0.0209
2023-12-26 14:42:09,826 - ***** Epoch: 3: Eval results *****
2023-12-26 14:42:09,827 -   train_loss = 4.7006
2023-12-26 14:42:09,827 -   best_eval_score = 0.0209
2023-12-26 14:42:09,827 -   eval_score = 0.0222
2023-12-26 14:42:55,438 - ***** Epoch: 4: Eval results *****
2023-12-26 14:42:55,438 -   train_loss = 4.1613
2023-12-26 14:42:55,438 -   best_eval_score = 0.0222
2023-12-26 14:42:55,438 -   eval_score = 0.0228
2023-12-26 14:43:35,825 - ***** Epoch: 5: Eval results *****
2023-12-26 14:43:35,826 -   train_loss = 3.7823
2023-12-26 14:43:35,826 -   best_eval_score = 0.0228
2023-12-26 14:43:35,826 -   eval_score = 0.021
2023-12-26 14:43:35,826 - EarlyStopping counter: 1 out of 8
2023-12-26 14:44:17,928 - ***** Epoch: 6: Eval results *****
2023-12-26 14:44:17,929 -   train_loss = 3.5448
2023-12-26 14:44:17,929 -   best_eval_score = 0.0228
2023-12-26 14:44:17,929 -   eval_score = 0.0221
2023-12-26 14:44:17,929 - EarlyStopping counter: 2 out of 8
2023-12-26 14:45:03,239 - ***** Epoch: 7: Eval results *****
2023-12-26 14:45:03,239 -   train_loss = 3.3917
2023-12-26 14:45:03,239 -   best_eval_score = 0.0228
2023-12-26 14:45:03,240 -   eval_score = 0.0166
2023-12-26 14:45:03,240 - EarlyStopping counter: 3 out of 8
2023-12-26 14:45:40,741 - ***** Epoch: 8: Eval results *****
2023-12-26 14:45:40,742 -   train_loss = 3.287
2023-12-26 14:45:40,742 -   best_eval_score = 0.0228
2023-12-26 14:45:40,742 -   eval_score = 0.0253
2023-12-26 14:46:26,434 - ***** Epoch: 9: Eval results *****
2023-12-26 14:46:26,434 -   train_loss = 3.2204
2023-12-26 14:46:26,434 -   best_eval_score = 0.0253
2023-12-26 14:46:26,434 -   eval_score = 0.0148
2023-12-26 14:46:26,434 - EarlyStopping counter: 1 out of 8
2023-12-26 14:47:06,977 - ***** Epoch: 10: Eval results *****
2023-12-26 14:47:06,977 -   train_loss = 3.1556
2023-12-26 14:47:06,978 -   best_eval_score = 0.0253
2023-12-26 14:47:06,978 -   eval_score = 0.0272
2023-12-26 14:47:48,521 - ***** Epoch: 11: Eval results *****
2023-12-26 14:47:48,522 -   train_loss = 3.1068
2023-12-26 14:47:48,522 -   best_eval_score = 0.0272
2023-12-26 14:47:48,523 -   eval_score = 0.0114
2023-12-26 14:47:48,523 - EarlyStopping counter: 1 out of 8
2023-12-26 14:48:33,397 - ***** Epoch: 12: Eval results *****
2023-12-26 14:48:33,398 -   train_loss = 3.0719
2023-12-26 14:48:33,398 -   best_eval_score = 0.0272
2023-12-26 14:48:33,398 -   eval_score = 0.0131
2023-12-26 14:48:33,398 - EarlyStopping counter: 2 out of 8
2023-12-26 14:49:11,843 - ***** Epoch: 13: Eval results *****
2023-12-26 14:49:11,843 -   train_loss = 3.0264
2023-12-26 14:49:11,843 -   best_eval_score = 0.0272
2023-12-26 14:49:11,844 -   eval_score = 0.0131
2023-12-26 14:49:11,844 - EarlyStopping counter: 3 out of 8
2023-12-26 14:49:56,121 - ***** Epoch: 14: Eval results *****
2023-12-26 14:49:56,121 -   train_loss = 2.9858
2023-12-26 14:49:56,121 -   best_eval_score = 0.0272
2023-12-26 14:49:56,121 -   eval_score = 0.0135
2023-12-26 14:49:56,121 - EarlyStopping counter: 4 out of 8
2023-12-26 14:50:38,150 - ***** Epoch: 15: Eval results *****
2023-12-26 14:50:38,151 -   train_loss = 2.9562
2023-12-26 14:50:38,151 -   best_eval_score = 0.0272
2023-12-26 14:50:38,151 -   eval_score = 0.0214
2023-12-26 14:50:38,151 - EarlyStopping counter: 5 out of 8
2023-12-26 14:51:17,989 - ***** Epoch: 16: Eval results *****
2023-12-26 14:51:17,989 -   train_loss = 2.9056
2023-12-26 14:51:17,990 -   best_eval_score = 0.0272
2023-12-26 14:51:17,990 -   eval_score = 0.0152
2023-12-26 14:51:17,990 - EarlyStopping counter: 6 out of 8
2023-12-26 14:52:04,458 - ***** Epoch: 17: Eval results *****
2023-12-26 14:52:04,458 -   train_loss = 2.8219
2023-12-26 14:52:04,458 -   best_eval_score = 0.0272
2023-12-26 14:52:04,458 -   eval_score = 0.0732
2023-12-26 14:52:40,919 - ***** Epoch: 18: Eval results *****
2023-12-26 14:52:40,919 -   train_loss = 2.7161
2023-12-26 14:52:40,919 -   best_eval_score = 0.0732
2023-12-26 14:52:40,919 -   eval_score = 0.0816
2023-12-26 14:53:25,082 - ***** Epoch: 19: Eval results *****
2023-12-26 14:53:25,083 -   train_loss = 2.5723
2023-12-26 14:53:25,083 -   best_eval_score = 0.0816
2023-12-26 14:53:25,083 -   eval_score = 0.1308
2023-12-26 14:54:06,482 - ***** Epoch: 20: Eval results *****
2023-12-26 14:54:06,483 -   train_loss = 2.4515
2023-12-26 14:54:06,483 -   best_eval_score = 0.1308
2023-12-26 14:54:06,483 -   eval_score = 0.1475
2023-12-26 14:54:45,528 - ***** Epoch: 21: Eval results *****
2023-12-26 14:54:45,528 -   train_loss = 2.3081
2023-12-26 14:54:45,529 -   best_eval_score = 0.1475
2023-12-26 14:54:45,529 -   eval_score = 0.1642
2023-12-26 14:55:31,441 - ***** Epoch: 22: Eval results *****
2023-12-26 14:55:31,442 -   train_loss = 2.158
2023-12-26 14:55:31,442 -   best_eval_score = 0.1642
2023-12-26 14:55:31,442 -   eval_score = 0.1751
2023-12-26 14:56:09,303 - ***** Epoch: 23: Eval results *****
2023-12-26 14:56:09,303 -   train_loss = 1.9875
2023-12-26 14:56:09,303 -   best_eval_score = 0.1751
2023-12-26 14:56:09,304 -   eval_score = 0.2112
2023-12-26 14:56:52,804 - ***** Epoch: 24: Eval results *****
2023-12-26 14:56:52,805 -   train_loss = 1.9262
2023-12-26 14:56:52,805 -   best_eval_score = 0.2112
2023-12-26 14:56:52,805 -   eval_score = 0.2606
2023-12-26 14:57:23,451 - ***** Epoch: 25: Eval results *****
2023-12-26 14:57:23,452 -   train_loss = nan
2023-12-26 14:57:23,452 -   best_eval_score = 0.2606
2023-12-26 14:57:23,452 -   eval_score = 0.0114
2023-12-26 14:57:23,452 - EarlyStopping counter: 1 out of 8
2023-12-26 14:57:49,259 - ***** Epoch: 26: Eval results *****
2023-12-26 14:57:49,259 -   train_loss = nan
2023-12-26 14:57:49,259 -   best_eval_score = 0.2606
2023-12-26 14:57:49,259 -   eval_score = 0.0114
2023-12-26 14:57:49,259 - EarlyStopping counter: 2 out of 8
2023-12-26 14:58:14,025 - ***** Epoch: 27: Eval results *****
2023-12-26 14:58:14,025 -   train_loss = nan
2023-12-26 14:58:14,025 -   best_eval_score = 0.2606
2023-12-26 14:58:14,025 -   eval_score = 0.0114
2023-12-26 14:58:14,025 - EarlyStopping counter: 3 out of 8
2023-12-26 14:58:38,913 - ***** Epoch: 28: Eval results *****
2023-12-26 14:58:38,914 -   train_loss = nan
2023-12-26 14:58:38,914 -   best_eval_score = 0.2606
2023-12-26 14:58:38,914 -   eval_score = 0.0114
2023-12-26 14:58:38,914 - EarlyStopping counter: 4 out of 8
2023-12-26 14:59:17,411 - ***** Epoch: 29: Eval results *****
2023-12-26 14:59:17,412 -   train_loss = nan
2023-12-26 14:59:17,412 -   best_eval_score = 0.2606
2023-12-26 14:59:17,412 -   eval_score = 0.0114
2023-12-26 14:59:17,412 - EarlyStopping counter: 5 out of 8
2023-12-26 14:59:56,528 - ***** Epoch: 30: Eval results *****
2023-12-26 14:59:56,528 -   train_loss = nan
2023-12-26 14:59:56,528 -   best_eval_score = 0.2606
2023-12-26 14:59:56,528 -   eval_score = 0.0114
2023-12-26 14:59:56,528 - EarlyStopping counter: 6 out of 8
2023-12-26 15:00:34,401 - ***** Epoch: 31: Eval results *****
2023-12-26 15:00:34,402 -   train_loss = nan
2023-12-26 15:00:34,402 -   best_eval_score = 0.2606
2023-12-26 15:00:34,402 -   eval_score = 0.0114
2023-12-26 15:00:34,402 - EarlyStopping counter: 7 out of 8
2023-12-26 15:01:13,049 - ***** Epoch: 32: Eval results *****
2023-12-26 15:01:13,050 -   train_loss = nan
2023-12-26 15:01:13,050 -   best_eval_score = 0.2606
2023-12-26 15:01:13,050 -   eval_score = 0.0114
2023-12-26 15:01:13,050 - EarlyStopping counter: 8 out of 8
2023-12-26 15:01:13,051 - EarlyStopping at epoch 32
2023-12-26 15:01:13,054 - Training is finished...
2023-12-26 15:01:13,055 - Testing begins...
2023-12-26 15:01:19,012 - ***** Test: Confusion Matrix *****
2023-12-26 15:01:19,014 - [[46  0  0  0  0  0  0  0  0  0  0  0 10  1  0  0  0  0  0  0]
 [ 1 38  0  0  0  0  0  0  0  0  0  0  3  1  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [18  0  0  0  0  0  0  0  0  0  0  1  3  1  0  0  0  0  0  0]
 [ 1  0  0  6  0  0  0  0  0  0  0  2  0  2  1  0  0  0  0  0]
 [ 7  0  0  0  0  0  0  0  0  0  0  0  4  1  0  0  0  0  0  0]
 [ 5  2  0  0  0  0  0  0  0  0  0  0  1  2  0  0  0  0  0  0]
 [ 5  2  0  0  0  0  0  0  0  0  0  0  2  1  0  0  0  0  0  0]
 [ 5  1  0  0  0  0  0  0  0  0  0  0  2  2  0  0  0  0  0  0]
 [ 5  0  0  0  0  0  0  0  0  0  1  1  1  9  1  0  0  0  0  0]
 [ 1  1  0  0  0  0  0  0  0  0  0 16  0  1  0  0  0  0  0  0]
 [ 5  4  0  0  0  0  0  0  0  0  0  1 39  8  0  0  0  0  0  0]
 [ 3  1  0  0  0  0  0  0  0  0  0  1  3 17  0  0  0  0  0  0]
 [ 0  0  1  0  0  0  0  0  0  0  0  1  5 14  1  0  0  0  0  0]
 [ 1  0  0  1  0  0  0  0  0  0  0  0 15  1  0  3  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  5 10  1  0  0  0  0  0]
 [ 2  0  0  0  0  0  0  0  0  0  0  0  1 12  0  0  0  0  0  0]
 [ 0  1  0  2  0  0  0  0  0  0  0  0  4  0  1  0  0  0  4  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  2  7  0  0  0  0  0  0]]
2023-12-26 15:01:19,014 - ***** Evaluation results *****
2023-12-26 15:01:19,014 -   acc = 0.4854
2023-12-26 15:01:19,014 -   f1 = 0.2827
2023-12-26 15:01:19,015 -   prec = 0.3667
2023-12-26 15:01:19,015 -   rec = 0.3219
2023-12-26 15:01:19,015 - Testing is finished...
2023-12-26 15:01:19,015 - Multimodal intent recognition is finished...
2023-12-26 15:01:19,015 - Results are saved in results/msz.csv
