2024-01-03 11:00:08,335 - ============================== Params ==============================
2024-01-03 11:00:08,335 - logger_name: msz_MIntRec_multi-class_seed-4_2024-01-03-11-00-08
2024-01-03 11:00:08,335 - dataset: MIntRec
2024-01-03 11:00:08,335 - data_mode: multi-class
2024-01-03 11:00:08,335 - method: msz
2024-01-03 11:00:08,335 - text_backbone: bert-base-uncased
2024-01-03 11:00:08,335 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-03 11:00:08,335 - seed: 4
2024-01-03 11:00:08,335 - num_workers: 8
2024-01-03 11:00:08,335 - gpu_id: 1
2024-01-03 11:00:08,335 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-03 11:00:08,335 - train: True
2024-01-03 11:00:08,335 - tune: False
2024-01-03 11:00:08,335 - save_model: False
2024-01-03 11:00:08,335 - save_results: True
2024-01-03 11:00:08,335 - log_path: logs
2024-01-03 11:00:08,336 - cache_path: 
2024-01-03 11:00:08,336 - video_data_path: video_data
2024-01-03 11:00:08,336 - audio_data_path: audio_data
2024-01-03 11:00:08,336 - video_feats_path: video_feats.pkl
2024-01-03 11:00:08,336 - audio_feats_path: audio_feats.pkl
2024-01-03 11:00:08,336 - results_path: results
2024-01-03 11:00:08,336 - output_path: /home/sujianhua/Outputs/MIntRec
2024-01-03 11:00:08,336 - model_path: models
2024-01-03 11:00:08,336 - config_file_name: msz
2024-01-03 11:00:08,336 - results_file_name: msz.csv
2024-01-03 11:00:08,336 - padding_mode: zero
2024-01-03 11:00:08,336 - padding_loc: end
2024-01-03 11:00:08,336 - need_aligned: False
2024-01-03 11:00:08,336 - eval_monitor: f1
2024-01-03 11:00:08,336 - train_batch_size: 16
2024-01-03 11:00:08,336 - eval_batch_size: 8
2024-01-03 11:00:08,336 - test_batch_size: 8
2024-01-03 11:00:08,336 - wait_patience: 8
2024-01-03 11:00:08,336 - nheads: 2
2024-01-03 11:00:08,336 - encoder_layers: 2
2024-01-03 11:00:08,336 - attn_dropout: 0.1
2024-01-03 11:00:08,336 - relu_dropout: 0.1
2024-01-03 11:00:08,336 - embed_dropout: 0.1
2024-01-03 11:00:08,336 - res_dropout: 0.1
2024-01-03 11:00:08,336 - attn_mask: False
2024-01-03 11:00:08,336 - hidden_size: 768
2024-01-03 11:00:08,336 - num_attention_heads: 12
2024-01-03 11:00:08,336 - attention_probs_dropout_prob: 0.2
2024-01-03 11:00:08,336 - hidden_dropout_prob: 0.2
2024-01-03 11:00:08,336 - intermediate_size: 768
2024-01-03 11:00:08,336 - num_hidden_layers: 3
2024-01-03 11:00:08,336 - max_position_embeddings: 512
2024-01-03 11:00:08,336 - position_embedding_type: absolute
2024-01-03 11:00:08,336 - batch_first: True
2024-01-03 11:00:08,336 - hidden_dims: 768
2024-01-03 11:00:08,336 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-03 11:00:08,336 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-03 11:00:08,336 - ta_loss: 0.02
2024-01-03 11:00:08,336 - tv_loss: 0.03
2024-01-03 11:00:08,336 - av_loss: 0.03
2024-01-03 11:00:08,336 - aligned_method: conv1d
2024-01-03 11:00:08,336 - grad_clip: -1
2024-01-03 11:00:08,336 - num_train_epochs: 100
2024-01-03 11:00:08,336 - warmup_proportion: 0.1
2024-01-03 11:00:08,336 - lr: 1e-06
2024-01-03 11:00:08,337 - weight_decay: 0.02
2024-01-03 11:00:08,337 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-03-11-00-08
2024-01-03 11:00:08,337 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-03-11-00-08/models
2024-01-03 11:00:08,337 - ============================== End Params ==============================
2024-01-03 11:00:10,176 - Generate Text Features Begin...
2024-01-03 11:00:12,500 - Generate Text Features Finished...
2024-01-03 11:00:12,600 - Load Video Features Begin...
2024-01-03 11:00:20,603 - Load Video Features Finished...
2024-01-03 11:00:21,192 - Load Audio Features Begin...
2024-01-03 11:00:49,169 - Load Audio Features Finished...
2024-01-03 11:00:53,699 - method  begins...
2024-01-03 11:01:02,356 - Multimodal intent recognition begins...
2024-01-03 11:01:02,356 - Training begins...
2024-01-03 11:01:28,523 - ***** Epoch: 1: Eval results *****
2024-01-03 11:01:28,523 -   train_loss = 4.0017
2024-01-03 11:01:28,523 -   best_eval_score = 0.0
2024-01-03 11:01:28,523 -   eval_score = 0.0284
2024-01-03 11:01:54,400 - ***** Epoch: 2: Eval results *****
2024-01-03 11:01:54,400 -   train_loss = 3.6214
2024-01-03 11:01:54,400 -   best_eval_score = 0.0284
2024-01-03 11:01:54,400 -   eval_score = 0.0292
2024-01-03 11:02:22,981 - ***** Epoch: 3: Eval results *****
2024-01-03 11:02:22,991 -   train_loss = 3.306
2024-01-03 11:02:22,991 -   best_eval_score = 0.0292
2024-01-03 11:02:22,991 -   eval_score = 0.0808
2024-01-03 11:02:49,815 - ***** Epoch: 4: Eval results *****
2024-01-03 11:02:49,815 -   train_loss = 3.0676
2024-01-03 11:02:49,815 -   best_eval_score = 0.0808
2024-01-03 11:02:49,815 -   eval_score = 0.098
2024-01-03 11:03:14,644 - ***** Epoch: 5: Eval results *****
2024-01-03 11:03:14,645 -   train_loss = 2.8077
2024-01-03 11:03:14,645 -   best_eval_score = 0.098
2024-01-03 11:03:14,645 -   eval_score = 0.215
2024-01-03 11:03:40,913 - ***** Epoch: 6: Eval results *****
2024-01-03 11:03:40,914 -   train_loss = 2.449
2024-01-03 11:03:40,914 -   best_eval_score = 0.215
2024-01-03 11:03:40,914 -   eval_score = 0.2842
2024-01-03 11:04:06,349 - ***** Epoch: 7: Eval results *****
2024-01-03 11:04:06,349 -   train_loss = 2.0881
2024-01-03 11:04:06,349 -   best_eval_score = 0.2842
2024-01-03 11:04:06,349 -   eval_score = 0.4289
2024-01-03 11:04:31,686 - ***** Epoch: 8: Eval results *****
2024-01-03 11:04:31,686 -   train_loss = 1.7471
2024-01-03 11:04:31,686 -   best_eval_score = 0.4289
2024-01-03 11:04:31,686 -   eval_score = 0.5401
2024-01-03 11:04:56,724 - ***** Epoch: 9: Eval results *****
2024-01-03 11:04:56,726 -   train_loss = 1.5065
2024-01-03 11:04:56,726 -   best_eval_score = 0.5401
2024-01-03 11:04:56,726 -   eval_score = 0.519
2024-01-03 11:04:56,726 - EarlyStopping counter: 1 out of 8
2024-01-03 11:05:22,605 - ***** Epoch: 10: Eval results *****
2024-01-03 11:05:22,605 -   train_loss = 1.3174
2024-01-03 11:05:22,605 -   best_eval_score = 0.5401
2024-01-03 11:05:22,605 -   eval_score = 0.5159
2024-01-03 11:05:22,605 - EarlyStopping counter: 2 out of 8
2024-01-03 11:05:48,418 - ***** Epoch: 11: Eval results *****
2024-01-03 11:05:48,418 -   train_loss = 1.0859
2024-01-03 11:05:48,418 -   best_eval_score = 0.5401
2024-01-03 11:05:48,419 -   eval_score = 0.5585
2024-01-03 11:06:13,713 - ***** Epoch: 12: Eval results *****
2024-01-03 11:06:13,713 -   train_loss = 0.9758
2024-01-03 11:06:13,713 -   best_eval_score = 0.5585
2024-01-03 11:06:13,713 -   eval_score = 0.5599
2024-01-03 11:06:38,662 - ***** Epoch: 13: Eval results *****
2024-01-03 11:06:38,662 -   train_loss = 0.7716
2024-01-03 11:06:38,662 -   best_eval_score = 0.5599
2024-01-03 11:06:38,662 -   eval_score = 0.618
2024-01-03 11:07:03,643 - ***** Epoch: 14: Eval results *****
2024-01-03 11:07:03,643 -   train_loss = 0.6593
2024-01-03 11:07:03,643 -   best_eval_score = 0.618
2024-01-03 11:07:03,643 -   eval_score = 0.5773
2024-01-03 11:07:03,643 - EarlyStopping counter: 1 out of 8
2024-01-03 11:07:29,243 - ***** Epoch: 15: Eval results *****
2024-01-03 11:07:29,243 -   train_loss = 0.495
2024-01-03 11:07:29,243 -   best_eval_score = 0.618
2024-01-03 11:07:29,243 -   eval_score = 0.6471
2024-01-03 11:07:53,949 - ***** Epoch: 16: Eval results *****
2024-01-03 11:07:53,950 -   train_loss = 0.4035
2024-01-03 11:07:53,950 -   best_eval_score = 0.6471
2024-01-03 11:07:53,950 -   eval_score = 0.6346
2024-01-03 11:07:53,950 - EarlyStopping counter: 1 out of 8
2024-01-03 11:08:19,777 - ***** Epoch: 17: Eval results *****
2024-01-03 11:08:19,777 -   train_loss = 0.3162
2024-01-03 11:08:19,777 -   best_eval_score = 0.6471
2024-01-03 11:08:19,777 -   eval_score = 0.6227
2024-01-03 11:08:19,777 - EarlyStopping counter: 2 out of 8
2024-01-03 11:08:44,076 - ***** Epoch: 18: Eval results *****
2024-01-03 11:08:44,076 -   train_loss = 0.2923
2024-01-03 11:08:44,076 -   best_eval_score = 0.6471
2024-01-03 11:08:44,076 -   eval_score = 0.6406
2024-01-03 11:08:44,076 - EarlyStopping counter: 3 out of 8
2024-01-03 11:09:08,516 - ***** Epoch: 19: Eval results *****
2024-01-03 11:09:08,517 -   train_loss = 0.2026
2024-01-03 11:09:08,517 -   best_eval_score = 0.6471
2024-01-03 11:09:08,517 -   eval_score = 0.6498
2024-01-03 11:09:33,046 - ***** Epoch: 20: Eval results *****
2024-01-03 11:09:33,046 -   train_loss = 0.1725
2024-01-03 11:09:33,046 -   best_eval_score = 0.6498
2024-01-03 11:09:33,046 -   eval_score = 0.6308
2024-01-03 11:09:33,046 - EarlyStopping counter: 1 out of 8
2024-01-03 11:09:58,256 - ***** Epoch: 21: Eval results *****
2024-01-03 11:09:58,257 -   train_loss = 0.1471
2024-01-03 11:09:58,257 -   best_eval_score = 0.6498
2024-01-03 11:09:58,257 -   eval_score = 0.6136
2024-01-03 11:09:58,257 - EarlyStopping counter: 2 out of 8
2024-01-03 11:10:23,797 - ***** Epoch: 22: Eval results *****
2024-01-03 11:10:23,797 -   train_loss = 0.1426
2024-01-03 11:10:23,797 -   best_eval_score = 0.6498
2024-01-03 11:10:23,797 -   eval_score = 0.6277
2024-01-03 11:10:23,797 - EarlyStopping counter: 3 out of 8
2024-01-03 11:10:49,596 - ***** Epoch: 23: Eval results *****
2024-01-03 11:10:49,596 -   train_loss = 0.1077
2024-01-03 11:10:49,596 -   best_eval_score = 0.6498
2024-01-03 11:10:49,596 -   eval_score = 0.6409
2024-01-03 11:10:49,596 - EarlyStopping counter: 4 out of 8
2024-01-03 11:11:13,988 - ***** Epoch: 24: Eval results *****
2024-01-03 11:11:13,988 -   train_loss = 0.0877
2024-01-03 11:11:13,988 -   best_eval_score = 0.6498
2024-01-03 11:11:13,988 -   eval_score = 0.6526
2024-01-03 11:11:39,836 - ***** Epoch: 25: Eval results *****
2024-01-03 11:11:39,836 -   train_loss = 0.0805
2024-01-03 11:11:39,836 -   best_eval_score = 0.6526
2024-01-03 11:11:39,836 -   eval_score = 0.6514
2024-01-03 11:11:39,836 - EarlyStopping counter: 1 out of 8
2024-01-03 11:12:04,274 - ***** Epoch: 26: Eval results *****
2024-01-03 11:12:04,275 -   train_loss = 0.064
2024-01-03 11:12:04,275 -   best_eval_score = 0.6526
2024-01-03 11:12:04,275 -   eval_score = 0.638
2024-01-03 11:12:04,275 - EarlyStopping counter: 2 out of 8
2024-01-03 11:12:29,170 - ***** Epoch: 27: Eval results *****
2024-01-03 11:12:29,170 -   train_loss = 0.0601
2024-01-03 11:12:29,170 -   best_eval_score = 0.6526
2024-01-03 11:12:29,170 -   eval_score = 0.6392
2024-01-03 11:12:29,170 - EarlyStopping counter: 3 out of 8
2024-01-03 11:12:53,915 - ***** Epoch: 28: Eval results *****
2024-01-03 11:12:53,916 -   train_loss = 0.0584
2024-01-03 11:12:53,916 -   best_eval_score = 0.6526
2024-01-03 11:12:53,916 -   eval_score = 0.6484
2024-01-03 11:12:53,916 - EarlyStopping counter: 4 out of 8
2024-01-03 11:13:20,603 - ***** Epoch: 29: Eval results *****
2024-01-03 11:13:20,603 -   train_loss = 0.0501
2024-01-03 11:13:20,603 -   best_eval_score = 0.6526
2024-01-03 11:13:20,603 -   eval_score = 0.657
2024-01-03 11:13:46,186 - ***** Epoch: 30: Eval results *****
2024-01-03 11:13:46,186 -   train_loss = 0.0525
2024-01-03 11:13:46,186 -   best_eval_score = 0.657
2024-01-03 11:13:46,186 -   eval_score = 0.6513
2024-01-03 11:13:46,186 - EarlyStopping counter: 1 out of 8
2024-01-03 11:14:11,037 - ***** Epoch: 31: Eval results *****
2024-01-03 11:14:11,037 -   train_loss = 0.0465
2024-01-03 11:14:11,037 -   best_eval_score = 0.657
2024-01-03 11:14:11,037 -   eval_score = 0.647
2024-01-03 11:14:11,037 - EarlyStopping counter: 2 out of 8
2024-01-03 11:14:35,743 - ***** Epoch: 32: Eval results *****
2024-01-03 11:14:35,743 -   train_loss = 0.0416
2024-01-03 11:14:35,744 -   best_eval_score = 0.657
2024-01-03 11:14:35,744 -   eval_score = 0.6492
2024-01-03 11:14:35,744 - EarlyStopping counter: 3 out of 8
2024-01-03 11:15:00,478 - ***** Epoch: 33: Eval results *****
2024-01-03 11:15:00,478 -   train_loss = 0.0376
2024-01-03 11:15:00,478 -   best_eval_score = 0.657
2024-01-03 11:15:00,478 -   eval_score = 0.6411
2024-01-03 11:15:00,478 - EarlyStopping counter: 4 out of 8
2024-01-03 11:15:26,702 - ***** Epoch: 34: Eval results *****
2024-01-03 11:15:26,703 -   train_loss = 0.0358
2024-01-03 11:15:26,703 -   best_eval_score = 0.657
2024-01-03 11:15:26,703 -   eval_score = 0.6435
2024-01-03 11:15:26,703 - EarlyStopping counter: 5 out of 8
2024-01-03 11:15:52,854 - ***** Epoch: 35: Eval results *****
2024-01-03 11:15:52,855 -   train_loss = 0.0304
2024-01-03 11:15:52,855 -   best_eval_score = 0.657
2024-01-03 11:15:52,855 -   eval_score = 0.637
2024-01-03 11:15:52,855 - EarlyStopping counter: 6 out of 8
2024-01-03 11:16:21,112 - ***** Epoch: 36: Eval results *****
2024-01-03 11:16:21,112 -   train_loss = 0.028
2024-01-03 11:16:21,112 -   best_eval_score = 0.657
2024-01-03 11:16:21,112 -   eval_score = 0.6332
2024-01-03 11:16:21,112 - EarlyStopping counter: 7 out of 8
2024-01-03 11:16:48,948 - ***** Epoch: 37: Eval results *****
2024-01-03 11:16:48,948 -   train_loss = 0.0311
2024-01-03 11:16:48,948 -   best_eval_score = 0.657
2024-01-03 11:16:48,948 -   eval_score = 0.6338
2024-01-03 11:16:48,948 - EarlyStopping counter: 8 out of 8
2024-01-03 11:16:48,948 - EarlyStopping at epoch 37
2024-01-03 11:16:48,951 - Training is finished...
2024-01-03 11:16:48,951 - Testing begins...
2024-01-03 11:16:53,792 - ***** Test: Confusion Matrix *****
2024-01-03 11:16:53,795 - [[24  2  0  0 11  0  4  4  3  5  0  0  3  0  0  0  0  1  0  0]
 [ 0 39  0  1  0  0  0  0  1  0  0  0  1  1  0  0  0  0  0  0]
 [ 0  0 27  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0 14  0  4  0  1  0  0  1  0  1  1  0  0  0  0  0]
 [ 0  0  0  0  0 10  0  0  0  1  0  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  3  0  3  0  3  1  0  1  1  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  0  5  2  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  5  0  0  0  0  2  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  1  0  0  2  0  0  0  1  0  3  0  1  0  0]
 [ 1  1  0  0  0  0  0  1  0  0 15  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  1  0  0 15  1  0  0  0  0  0  0  1]
 [ 3  1  0  1  0  0  1  2  4  0  0  0 33  4  2  2  1  0  1  2]
 [ 0  0  0  0  1  0  0  0  0  0  1  1  2 20  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  1  0  0  0  1  3 13  0  1  0  0  2]
 [ 0  0  0  1  1  0  0  2  1  0  0  0  3  0  0 12  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  4  0  0  0 10  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  1  0  0  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  1  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0  0  8]]
2024-01-03 11:16:53,795 - ***** Evaluation results *****
2024-01-03 11:16:53,796 -   acc = 0.6742
2024-01-03 11:16:53,796 -   f1 = 0.6517
2024-01-03 11:16:53,796 -   prec = 0.6658
2024-01-03 11:16:53,797 -   rec = 0.662
2024-01-03 11:16:53,797 - Testing is finished...
2024-01-03 11:16:53,797 - Multimodal intent recognition is finished...
2024-01-03 11:16:53,798 - Results are saved in results/msz.csv
