2024-03-07 09:16:37,377 - ============================== Params ==============================
2024-03-07 09:16:37,377 - logger_name: msz_MIntRec2_multi-class_seed-3_2024-03-07-09-16-37
2024-03-07 09:16:37,377 - dataset: MIntRec2
2024-03-07 09:16:37,377 - data_mode: multi-class
2024-03-07 09:16:37,377 - method: msz
2024-03-07 09:16:37,377 - text_backbone: bert-base-uncased
2024-03-07 09:16:37,377 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-07 09:16:37,377 - seed: 3
2024-03-07 09:16:37,377 - num_workers: 8
2024-03-07 09:16:37,377 - gpu_id: 2
2024-03-07 09:16:37,377 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-07 09:16:37,377 - train: True
2024-03-07 09:16:37,377 - tune: True
2024-03-07 09:16:37,377 - save_model: False
2024-03-07 09:16:37,377 - save_results: True
2024-03-07 09:16:37,377 - log_path: logs
2024-03-07 09:16:37,377 - cache_path: 
2024-03-07 09:16:37,377 - video_data_path: video_data
2024-03-07 09:16:37,378 - audio_data_path: audio_data
2024-03-07 09:16:37,378 - video_feats_path: video_feats.pkl
2024-03-07 09:16:37,378 - audio_feats_path: audio_feats.pkl
2024-03-07 09:16:37,378 - results_path: results
2024-03-07 09:16:37,378 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-07 09:16:37,378 - model_path: models
2024-03-07 09:16:37,378 - config_file_name: msz_MIntRec2
2024-03-07 09:16:37,378 - results_file_name: msz.csv
2024-03-07 09:16:37,378 - padding_mode: zero
2024-03-07 09:16:37,378 - padding_loc: end
2024-03-07 09:16:37,378 - need_aligned: False
2024-03-07 09:16:37,378 - eval_monitor: f1
2024-03-07 09:16:37,378 - train_batch_size: 16
2024-03-07 09:16:37,378 - eval_batch_size: 8
2024-03-07 09:16:37,378 - test_batch_size: 8
2024-03-07 09:16:37,378 - wait_patience: 8
2024-03-07 09:16:37,378 - hidden_dims: 768
2024-03-07 09:16:37,378 - num_attention_heads: 12
2024-03-07 09:16:37,378 - attention_probs_dropout_prob: 0.1
2024-03-07 09:16:37,378 - hidden_dropout_prob: 0.2
2024-03-07 09:16:37,378 - intermediate_size: 768
2024-03-07 09:16:37,378 - num_hidden_layers: 10
2024-03-07 09:16:37,378 - max_position_embeddings: 768
2024-03-07 09:16:37,378 - position_embedding_type: absolute
2024-03-07 09:16:37,378 - batch_first: True
2024-03-07 09:16:37,378 - dropout: 0.1
2024-03-07 09:16:37,378 - aligned_method: conv1d
2024-03-07 09:16:37,378 - num_train_epochs: 100
2024-03-07 09:16:37,378 - lr: 4e-06
2024-03-07 09:16:37,378 - lr_mode: min
2024-03-07 09:16:37,378 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-3_2024-03-07-09-16-37
2024-03-07 09:16:37,378 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-3_2024-03-07-09-16-37/models
2024-03-07 09:16:37,378 - ============================== End Params ==============================
2024-03-07 09:16:37,551 - Generate Text Features Begin...
2024-03-07 09:16:39,506 - Generate Text Features Finished...
2024-03-07 09:16:39,519 - Load Video Features Begin...
2024-03-07 09:17:20,606 - Load Video Features Finished...
2024-03-07 09:17:22,628 - Load Audio Features Begin...
2024-03-07 09:19:00,035 - Load Audio Features Finished...
2024-03-07 09:19:15,740 - method  begins...
2024-03-07 09:19:20,505 - Multimodal intent recognition begins...
2024-03-07 09:19:20,506 - Training begins...
2024-03-07 09:21:21,189 - ***** Epoch: 1: Eval results *****
2024-03-07 09:21:21,189 -   train_loss = 2.4722
2024-03-07 09:21:21,189 -   best_eval_score = 0.0
2024-03-07 09:21:21,189 -   eval_score = 0.3179
2024-03-07 09:23:16,754 - ***** Epoch: 2: Eval results *****
2024-03-07 09:23:16,754 -   train_loss = 1.5456
2024-03-07 09:23:16,755 -   best_eval_score = 0.3179
2024-03-07 09:23:16,755 -   eval_score = 0.4465
2024-03-07 09:25:12,716 - ***** Epoch: 3: Eval results *****
2024-03-07 09:25:12,716 -   train_loss = 1.231
2024-03-07 09:25:12,716 -   best_eval_score = 0.4465
2024-03-07 09:25:12,716 -   eval_score = 0.4598
2024-03-07 09:27:08,398 - ***** Epoch: 4: Eval results *****
2024-03-07 09:27:08,399 -   train_loss = 1.0235
2024-03-07 09:27:08,399 -   best_eval_score = 0.4598
2024-03-07 09:27:08,399 -   eval_score = 0.4888
2024-03-07 09:29:03,076 - ***** Epoch: 5: Eval results *****
2024-03-07 09:29:03,076 -   train_loss = 0.8352
2024-03-07 09:29:03,076 -   best_eval_score = 0.4888
2024-03-07 09:29:03,076 -   eval_score = 0.5018
2024-03-07 09:30:58,479 - ***** Epoch: 6: Eval results *****
2024-03-07 09:30:58,479 -   train_loss = 0.6748
2024-03-07 09:30:58,479 -   best_eval_score = 0.5018
2024-03-07 09:30:58,479 -   eval_score = 0.5032
2024-03-07 09:32:52,669 - ***** Epoch: 7: Eval results *****
2024-03-07 09:32:52,669 -   train_loss = 0.5347
2024-03-07 09:32:52,670 -   best_eval_score = 0.5032
2024-03-07 09:32:52,670 -   eval_score = 0.5199
2024-03-07 09:34:47,365 - ***** Epoch: 8: Eval results *****
2024-03-07 09:34:47,365 -   train_loss = 0.4036
2024-03-07 09:34:47,365 -   best_eval_score = 0.5199
2024-03-07 09:34:47,365 -   eval_score = 0.5078
2024-03-07 09:34:47,366 - EarlyStopping counter: 1 out of 8
2024-03-07 09:36:42,033 - ***** Epoch: 9: Eval results *****
2024-03-07 09:36:42,033 -   train_loss = 0.3146
2024-03-07 09:36:42,033 -   best_eval_score = 0.5199
2024-03-07 09:36:42,033 -   eval_score = 0.5016
2024-03-07 09:36:42,033 - EarlyStopping counter: 2 out of 8
2024-03-07 09:38:36,521 - ***** Epoch: 10: Eval results *****
2024-03-07 09:38:36,521 -   train_loss = 0.2324
2024-03-07 09:38:36,521 -   best_eval_score = 0.5199
2024-03-07 09:38:36,521 -   eval_score = 0.5156
2024-03-07 09:38:36,521 - EarlyStopping counter: 3 out of 8
2024-03-07 09:40:31,921 - ***** Epoch: 11: Eval results *****
2024-03-07 09:40:31,921 -   train_loss = 0.1537
2024-03-07 09:40:31,921 -   best_eval_score = 0.5199
2024-03-07 09:40:31,921 -   eval_score = 0.5216
2024-03-07 09:42:28,844 - ***** Epoch: 12: Eval results *****
2024-03-07 09:42:28,844 -   train_loss = 0.14
2024-03-07 09:42:28,844 -   best_eval_score = 0.5216
2024-03-07 09:42:28,844 -   eval_score = 0.518
2024-03-07 09:42:28,844 - EarlyStopping counter: 1 out of 8
2024-03-07 09:44:24,863 - ***** Epoch: 13: Eval results *****
2024-03-07 09:44:24,863 -   train_loss = 0.1341
2024-03-07 09:44:24,864 -   best_eval_score = 0.5216
2024-03-07 09:44:24,864 -   eval_score = 0.5159
2024-03-07 09:44:24,864 - EarlyStopping counter: 2 out of 8
2024-03-07 09:46:19,776 - ***** Epoch: 14: Eval results *****
2024-03-07 09:46:19,776 -   train_loss = 0.1316
2024-03-07 09:46:19,776 -   best_eval_score = 0.5216
2024-03-07 09:46:19,776 -   eval_score = 0.5149
2024-03-07 09:46:19,776 - EarlyStopping counter: 3 out of 8
2024-03-07 09:48:15,433 - ***** Epoch: 15: Eval results *****
2024-03-07 09:48:15,434 -   train_loss = 0.1245
2024-03-07 09:48:15,434 -   best_eval_score = 0.5216
2024-03-07 09:48:15,434 -   eval_score = 0.5194
2024-03-07 09:48:15,434 - EarlyStopping counter: 4 out of 8
2024-03-07 09:50:10,565 - ***** Epoch: 16: Eval results *****
2024-03-07 09:50:10,565 -   train_loss = 0.1174
2024-03-07 09:50:10,565 -   best_eval_score = 0.5216
2024-03-07 09:50:10,565 -   eval_score = 0.5114
2024-03-07 09:50:10,566 - EarlyStopping counter: 5 out of 8
2024-03-07 09:52:05,935 - ***** Epoch: 17: Eval results *****
2024-03-07 09:52:05,936 -   train_loss = 0.1149
2024-03-07 09:52:05,936 -   best_eval_score = 0.5216
2024-03-07 09:52:05,936 -   eval_score = 0.5112
2024-03-07 09:52:05,936 - EarlyStopping counter: 6 out of 8
2024-03-07 09:54:01,173 - ***** Epoch: 18: Eval results *****
2024-03-07 09:54:01,173 -   train_loss = 0.1093
2024-03-07 09:54:01,173 -   best_eval_score = 0.5216
2024-03-07 09:54:01,173 -   eval_score = 0.5133
2024-03-07 09:54:01,173 - EarlyStopping counter: 7 out of 8
2024-03-07 09:55:55,516 - ***** Epoch: 19: Eval results *****
2024-03-07 09:55:55,516 -   train_loss = 0.1034
2024-03-07 09:55:55,516 -   best_eval_score = 0.5216
2024-03-07 09:55:55,516 -   eval_score = 0.5043
2024-03-07 09:55:55,516 - EarlyStopping counter: 8 out of 8
2024-03-07 09:55:55,516 - EarlyStopping at epoch 19
2024-03-07 09:55:55,519 - Training is finished...
2024-03-07 09:55:55,520 - Testing begins...
2024-03-07 09:56:10,781 - ***** Test: Confusion Matrix *****
2024-03-07 09:56:10,791 - [[ 46   0  17   0   0   0   0   0   0   0   2   0   0   0   0   1   0   1
    0   0   0   0   0   1   0   0   0   0   0   0]
 [  0  55   0   0   9   2   5   0   2   0   2   0   5   0   2   0   0   6
    1   1   0   2   1   0   1   0   1   2   0   0]
 [  8   0  45   0   1   0   0   0   0   0   1   0   0   1   1   1   0   2
    0   0   0   0   0   1   3   0   0   0   0   0]
 [  0   0   0  60   0   0   0   1   0   1   0   0   0   0   1   0   0   1
    0   0   0   0   0   0   0   0   0   0   0   1]
 [  0   3   0   0  29   0   0   0   1   0   0   0   0   0   0   0   0   7
    0   1   0   3   0   1   1   0   0   2   1   2]
 [  0   1   0   0   2  21   0   1   0   0   0   0   1   0   1   0   0   6
    0   1   0   0   0   1   0   2   0   0   0   0]
 [  0   1   0   0   0   4  25  10   0   2   2   1   3   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   6  28   0   0   4   0   5   0   0   0   2   0
    0   0   0   0   1   0   0   0   0   1   0   0]
 [  1   2   1   3   1   0   0   0  22   1   0   0   1   0   3   0   0   2
    0   0   0   2   6   1   2   1   0   0   0   0]
 [  0   0   1   1   0   0   0   0   1  53   0   4   8   1  11   0   0  10
    1   0   0   3   2   1   3   1   1   5   0   0]
 [  0   0   0   0   1   4   8   3   3   2  39   0  27   0   2   0   0   0
    0   2   0   0   0   0   1   0   0   1   0   0]
 [  0   0   0   0   0   0   1   0   0   9   1  19   4   1   1   0   0   1
    1   0   0   0   2   0   1   0   0   6   0   0]
 [  0   0   0   0   0   1   7  10   0   5  21   1  82   0   1   0   2   0
    0   2   0   0   1   0   0   0   0   2   0   0]
 [  0   0   1   0   0   0   0   0   0   1   0   0   0   4   4   1   0   2
    2   0   1   0   1   0   0   0   0   0   0   0]
 [  0   1   0   0   0   0   1   0   4   5   2   2   1   4 128   0   0  18
    2   0   3   2  11   1   2   0   1   4   0   1]
 [  0   0   1   0   1   0   0   0   0   2   0   1   0   1   2   5   0   4
    1   0   1   2   0   0   0   1   0   0   0   0]
 [  0   0   0   0   1   0   0   2   0   0   2   0   2   0   0   0  54   1
    4   0   0   0   0   0   0   0   0   0   0   0]
 [  0   6   1   1   8   5   0   0   2  10   1   1   1   1  22   2   1 114
   11   0   2   6   5   8   0   2   1   4   1   1]
 [  0   1   1   0   0   0   0   0   0   3   2   0   0   1   9   1   1  10
   26   0   3   0   0   0   1   0   0   1   0   0]
 [  0   5   0   0   1   0   1   0   0   0   2   0   0   0   0   0   0   0
    0   7   0   1   0   0   0   0   0   0   0   0]
 [  0   1   2   0   2   0   0   0   0   2   0   1   1   0   6   0   0   0
    4   0   4   0   0   1   1   0   0   3   0   1]
 [  6   0   0   0   1   0   0   0   0   2   0   0   0   0   0   0   5   1
    0   0   1  29   0   4   1   0   2   1   0   0]
 [  0   0   2   1   0   0   0   0   1   3   0   3   1   4   9   0   0   4
    0   0   0   0  75   0   0   1  11   2   0   0]
 [  0   3   0   0   1   0   0   0   0   2   0   0   0   0   3   0   0   7
    0   0   0   6   0  16   0   0   0   0   0   0]
 [  2   1   1   0   0   0   0   0   0   1   1   2   0   1   2   0   0   3
    0   0   0   1   1   1  87   0   0   7   2   0]
 [  2   1   0   0   0   0   0   0   0   0   0   2   0   0   0   0   0   0
    0   0   0   0   3   1   1  19   1   0   0   1]
 [  0   0   0   0   0   0   0   0   0   2   0   0   0   0   1   0   0   4
    0   0   0   1   2   0   0   0   6   0   1   0]
 [  0   2   1   0   1   0   0   1   3   7   2   3   3   0   4   0   0   5
    1   0   2   0   2   0   7   1   0  12   1   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   1   0
    0   0   0   0   0   0   0   0   0   0  56   0]
 [  0   2   0   0   1   0   0   0   1   2   1   1   0   0   0   0   0   2
    1   0   0   0   0   0   1   1   0   1   0   5]]
2024-03-07 09:56:10,791 - ***** Evaluation results *****
2024-03-07 09:56:10,791 -   acc = 0.576
2024-03-07 09:56:10,791 -   f1 = 0.5254
2024-03-07 09:56:10,791 -   prec = 0.5339
2024-03-07 09:56:10,791 -   rec = 0.5244
2024-03-07 09:56:10,792 - Testing is finished...
2024-03-07 09:56:10,792 - Multimodal intent recognition is finished...
2024-03-07 09:56:10,792 - Results are saved in results/msz.csv
