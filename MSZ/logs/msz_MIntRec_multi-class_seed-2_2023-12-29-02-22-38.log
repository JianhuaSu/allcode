2023-12-29 02:22:38,581 - ============================== Params ==============================
2023-12-29 02:22:38,581 - logger_name: msz_MIntRec_multi-class_seed-2_2023-12-29-02-22-38
2023-12-29 02:22:38,581 - dataset: MIntRec
2023-12-29 02:22:38,581 - data_mode: multi-class
2023-12-29 02:22:38,581 - method: msz
2023-12-29 02:22:38,581 - text_backbone: bert-base-uncased
2023-12-29 02:22:38,581 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-29 02:22:38,581 - seed: 2
2023-12-29 02:22:38,581 - num_workers: 8
2023-12-29 02:22:38,581 - gpu_id: 3
2023-12-29 02:22:38,581 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-29 02:22:38,581 - train: True
2023-12-29 02:22:38,581 - tune: False
2023-12-29 02:22:38,581 - save_model: False
2023-12-29 02:22:38,581 - save_results: True
2023-12-29 02:22:38,581 - log_path: logs
2023-12-29 02:22:38,581 - cache_path: 
2023-12-29 02:22:38,581 - video_data_path: video_data
2023-12-29 02:22:38,582 - audio_data_path: audio_data
2023-12-29 02:22:38,582 - video_feats_path: video_feats.pkl
2023-12-29 02:22:38,582 - audio_feats_path: audio_feats.pkl
2023-12-29 02:22:38,582 - results_path: results
2023-12-29 02:22:38,582 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-29 02:22:38,582 - model_path: models
2023-12-29 02:22:38,582 - config_file_name: msz
2023-12-29 02:22:38,582 - results_file_name: msz.csv
2023-12-29 02:22:38,582 - padding_mode: zero
2023-12-29 02:22:38,582 - padding_loc: end
2023-12-29 02:22:38,582 - need_aligned: False
2023-12-29 02:22:38,582 - eval_monitor: f1
2023-12-29 02:22:38,582 - train_batch_size: 16
2023-12-29 02:22:38,582 - eval_batch_size: 8
2023-12-29 02:22:38,582 - test_batch_size: 8
2023-12-29 02:22:38,582 - wait_patience: 8
2023-12-29 02:22:38,582 - nheads: 2
2023-12-29 02:22:38,582 - encoder_layers: 2
2023-12-29 02:22:38,582 - attn_dropout: 0.1
2023-12-29 02:22:38,582 - relu_dropout: 0.1
2023-12-29 02:22:38,582 - embed_dropout: 0.1
2023-12-29 02:22:38,582 - res_dropout: 0.1
2023-12-29 02:22:38,582 - attn_mask: False
2023-12-29 02:22:38,582 - hidden_size: 768
2023-12-29 02:22:38,582 - num_attention_heads: 12
2023-12-29 02:22:38,582 - attention_probs_dropout_prob: 0.2
2023-12-29 02:22:38,582 - hidden_dropout_prob: 0.2
2023-12-29 02:22:38,582 - intermediate_size: 768
2023-12-29 02:22:38,582 - num_hidden_layers: 3
2023-12-29 02:22:38,582 - max_position_embeddings: 512
2023-12-29 02:22:38,582 - position_embedding_type: absolute
2023-12-29 02:22:38,582 - batch_first: True
2023-12-29 02:22:38,582 - hidden_dims: 768
2023-12-29 02:22:38,582 - att_dropouts: [0.2, 0.2, 0.2]
2023-12-29 02:22:38,582 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-29 02:22:38,582 - ta_loss: 0.01
2023-12-29 02:22:38,582 - tv_loss: 0.01
2023-12-29 02:22:38,583 - av_loss: 0.01
2023-12-29 02:22:38,583 - aligned_method: conv1d
2023-12-29 02:22:38,583 - grad_clip: 2
2023-12-29 02:22:38,583 - num_train_epochs: 100
2023-12-29 02:22:38,583 - warmup_proportion: 0.1
2023-12-29 02:22:38,583 - lr: 1e-06
2023-12-29 02:22:38,583 - weight_decay: 0.02
2023-12-29 02:22:38,583 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2023-12-29-02-22-38
2023-12-29 02:22:38,583 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2023-12-29-02-22-38/models
2023-12-29 02:22:38,583 - ============================== End Params ==============================
2023-12-29 02:22:38,719 - Generate Text Features Begin...
2023-12-29 02:22:39,364 - Generate Text Features Finished...
2023-12-29 02:22:39,365 - Load Video Features Begin...
2023-12-29 02:22:52,171 - Load Video Features Finished...
2023-12-29 02:22:52,817 - Load Audio Features Begin...
2023-12-29 02:23:29,627 - Load Audio Features Finished...
2023-12-29 02:23:33,148 - method  begins...
2023-12-29 02:23:42,571 - Multimodal intent recognition begins...
2023-12-29 02:23:42,571 - Training begins...
2023-12-29 02:24:07,895 - ***** Epoch: 1: Eval results *****
2023-12-29 02:24:07,895 -   train_loss = 3.3127
2023-12-29 02:24:07,895 -   best_eval_score = 0.0
2023-12-29 02:24:07,895 -   eval_score = 0.0273
2023-12-29 02:24:31,607 - ***** Epoch: 2: Eval results *****
2023-12-29 02:24:31,607 -   train_loss = 3.1214
2023-12-29 02:24:31,607 -   best_eval_score = 0.0273
2023-12-29 02:24:31,607 -   eval_score = 0.0484
2023-12-29 02:24:55,271 - ***** Epoch: 3: Eval results *****
2023-12-29 02:24:55,271 -   train_loss = 3.0019
2023-12-29 02:24:55,271 -   best_eval_score = 0.0484
2023-12-29 02:24:55,271 -   eval_score = 0.0343
2023-12-29 02:24:55,271 - EarlyStopping counter: 1 out of 8
2023-12-29 02:25:18,957 - ***** Epoch: 4: Eval results *****
2023-12-29 02:25:18,957 -   train_loss = 2.8968
2023-12-29 02:25:18,957 -   best_eval_score = 0.0484
2023-12-29 02:25:18,957 -   eval_score = 0.0394
2023-12-29 02:25:18,958 - EarlyStopping counter: 2 out of 8
2023-12-29 02:25:42,748 - ***** Epoch: 5: Eval results *****
2023-12-29 02:25:42,748 -   train_loss = 2.7507
2023-12-29 02:25:42,748 -   best_eval_score = 0.0484
2023-12-29 02:25:42,748 -   eval_score = 0.1489
2023-12-29 02:26:06,581 - ***** Epoch: 6: Eval results *****
2023-12-29 02:26:06,582 -   train_loss = 2.492
2023-12-29 02:26:06,582 -   best_eval_score = 0.1489
2023-12-29 02:26:06,582 -   eval_score = 0.2129
2023-12-29 02:26:31,338 - ***** Epoch: 7: Eval results *****
2023-12-29 02:26:31,339 -   train_loss = 2.1516
2023-12-29 02:26:31,339 -   best_eval_score = 0.2129
2023-12-29 02:26:31,339 -   eval_score = 0.3038
2023-12-29 02:26:54,900 - ***** Epoch: 8: Eval results *****
2023-12-29 02:26:54,900 -   train_loss = 1.7906
2023-12-29 02:26:54,900 -   best_eval_score = 0.3038
2023-12-29 02:26:54,900 -   eval_score = 0.5015
2023-12-29 02:27:18,505 - ***** Epoch: 9: Eval results *****
2023-12-29 02:27:18,505 -   train_loss = 1.5451
2023-12-29 02:27:18,506 -   best_eval_score = 0.5015
2023-12-29 02:27:18,506 -   eval_score = 0.5095
2023-12-29 02:27:42,419 - ***** Epoch: 10: Eval results *****
2023-12-29 02:27:42,420 -   train_loss = 1.3609
2023-12-29 02:27:42,420 -   best_eval_score = 0.5095
2023-12-29 02:27:42,420 -   eval_score = 0.5046
2023-12-29 02:27:42,420 - EarlyStopping counter: 1 out of 8
2023-12-29 02:28:06,026 - ***** Epoch: 11: Eval results *****
2023-12-29 02:28:06,026 -   train_loss = 1.1841
2023-12-29 02:28:06,026 -   best_eval_score = 0.5095
2023-12-29 02:28:06,027 -   eval_score = 0.5122
2023-12-29 02:28:29,847 - ***** Epoch: 12: Eval results *****
2023-12-29 02:28:29,847 -   train_loss = 0.9494
2023-12-29 02:28:29,847 -   best_eval_score = 0.5122
2023-12-29 02:28:29,847 -   eval_score = 0.5316
2023-12-29 02:28:54,051 - ***** Epoch: 13: Eval results *****
2023-12-29 02:28:54,051 -   train_loss = 0.8568
2023-12-29 02:28:54,051 -   best_eval_score = 0.5316
2023-12-29 02:28:54,051 -   eval_score = 0.54
2023-12-29 02:29:17,938 - ***** Epoch: 14: Eval results *****
2023-12-29 02:29:17,938 -   train_loss = 0.6416
2023-12-29 02:29:17,938 -   best_eval_score = 0.54
2023-12-29 02:29:17,938 -   eval_score = 0.6157
2023-12-29 02:29:41,603 - ***** Epoch: 15: Eval results *****
2023-12-29 02:29:41,603 -   train_loss = 0.5176
2023-12-29 02:29:41,603 -   best_eval_score = 0.6157
2023-12-29 02:29:41,603 -   eval_score = 0.6172
2023-12-29 02:30:05,638 - ***** Epoch: 16: Eval results *****
2023-12-29 02:30:05,638 -   train_loss = 0.447
2023-12-29 02:30:05,638 -   best_eval_score = 0.6172
2023-12-29 02:30:05,638 -   eval_score = 0.5859
2023-12-29 02:30:05,638 - EarlyStopping counter: 1 out of 8
2023-12-29 02:30:29,175 - ***** Epoch: 17: Eval results *****
2023-12-29 02:30:29,175 -   train_loss = 0.3203
2023-12-29 02:30:29,175 -   best_eval_score = 0.6172
2023-12-29 02:30:29,175 -   eval_score = 0.6078
2023-12-29 02:30:29,176 - EarlyStopping counter: 2 out of 8
2023-12-29 02:30:53,195 - ***** Epoch: 18: Eval results *****
2023-12-29 02:30:53,196 -   train_loss = 0.2633
2023-12-29 02:30:53,196 -   best_eval_score = 0.6172
2023-12-29 02:30:53,196 -   eval_score = 0.5971
2023-12-29 02:30:53,196 - EarlyStopping counter: 3 out of 8
2023-12-29 02:31:17,165 - ***** Epoch: 19: Eval results *****
2023-12-29 02:31:17,173 -   train_loss = 0.2213
2023-12-29 02:31:17,173 -   best_eval_score = 0.6172
2023-12-29 02:31:17,173 -   eval_score = 0.6156
2023-12-29 02:31:17,173 - EarlyStopping counter: 4 out of 8
2023-12-29 02:31:40,609 - ***** Epoch: 20: Eval results *****
2023-12-29 02:31:40,610 -   train_loss = 0.1814
2023-12-29 02:31:40,610 -   best_eval_score = 0.6172
2023-12-29 02:31:40,610 -   eval_score = 0.6264
2023-12-29 02:32:04,592 - ***** Epoch: 21: Eval results *****
2023-12-29 02:32:04,592 -   train_loss = 0.1471
2023-12-29 02:32:04,592 -   best_eval_score = 0.6264
2023-12-29 02:32:04,592 -   eval_score = 0.6453
2023-12-29 02:32:28,749 - ***** Epoch: 22: Eval results *****
2023-12-29 02:32:28,749 -   train_loss = 0.1225
2023-12-29 02:32:28,749 -   best_eval_score = 0.6453
2023-12-29 02:32:28,750 -   eval_score = 0.6482
2023-12-29 02:32:52,892 - ***** Epoch: 23: Eval results *****
2023-12-29 02:32:52,893 -   train_loss = 0.1042
2023-12-29 02:32:52,893 -   best_eval_score = 0.6482
2023-12-29 02:32:52,893 -   eval_score = 0.6468
2023-12-29 02:32:52,893 - EarlyStopping counter: 1 out of 8
2023-12-29 02:33:17,025 - ***** Epoch: 24: Eval results *****
2023-12-29 02:33:17,025 -   train_loss = 0.0865
2023-12-29 02:33:17,025 -   best_eval_score = 0.6482
2023-12-29 02:33:17,025 -   eval_score = 0.649
2023-12-29 02:33:41,012 - ***** Epoch: 25: Eval results *****
2023-12-29 02:33:41,012 -   train_loss = 0.0681
2023-12-29 02:33:41,012 -   best_eval_score = 0.649
2023-12-29 02:33:41,012 -   eval_score = 0.6507
2023-12-29 02:34:04,855 - ***** Epoch: 26: Eval results *****
2023-12-29 02:34:04,855 -   train_loss = 0.0612
2023-12-29 02:34:04,855 -   best_eval_score = 0.6507
2023-12-29 02:34:04,855 -   eval_score = 0.6479
2023-12-29 02:34:04,856 - EarlyStopping counter: 1 out of 8
2023-12-29 02:34:29,173 - ***** Epoch: 27: Eval results *****
2023-12-29 02:34:29,173 -   train_loss = 0.0466
2023-12-29 02:34:29,173 -   best_eval_score = 0.6507
2023-12-29 02:34:29,173 -   eval_score = 0.6509
2023-12-29 02:34:52,945 - ***** Epoch: 28: Eval results *****
2023-12-29 02:34:52,945 -   train_loss = 0.0414
2023-12-29 02:34:52,946 -   best_eval_score = 0.6509
2023-12-29 02:34:52,946 -   eval_score = 0.663
2023-12-29 02:35:17,102 - ***** Epoch: 29: Eval results *****
2023-12-29 02:35:17,102 -   train_loss = 0.0397
2023-12-29 02:35:17,102 -   best_eval_score = 0.663
2023-12-29 02:35:17,102 -   eval_score = 0.6569
2023-12-29 02:35:17,102 - EarlyStopping counter: 1 out of 8
2023-12-29 02:35:41,054 - ***** Epoch: 30: Eval results *****
2023-12-29 02:35:41,054 -   train_loss = 0.0331
2023-12-29 02:35:41,055 -   best_eval_score = 0.663
2023-12-29 02:35:41,055 -   eval_score = 0.6426
2023-12-29 02:35:41,055 - EarlyStopping counter: 2 out of 8
2023-12-29 02:36:04,731 - ***** Epoch: 31: Eval results *****
2023-12-29 02:36:04,731 -   train_loss = 0.029
2023-12-29 02:36:04,731 -   best_eval_score = 0.663
2023-12-29 02:36:04,731 -   eval_score = 0.6467
2023-12-29 02:36:04,731 - EarlyStopping counter: 3 out of 8
2023-12-29 02:36:28,210 - ***** Epoch: 32: Eval results *****
2023-12-29 02:36:28,210 -   train_loss = 0.0239
2023-12-29 02:36:28,210 -   best_eval_score = 0.663
2023-12-29 02:36:28,210 -   eval_score = 0.6409
2023-12-29 02:36:28,210 - EarlyStopping counter: 4 out of 8
2023-12-29 02:36:51,678 - ***** Epoch: 33: Eval results *****
2023-12-29 02:36:51,678 -   train_loss = 0.0257
2023-12-29 02:36:51,678 -   best_eval_score = 0.663
2023-12-29 02:36:51,678 -   eval_score = 0.6203
2023-12-29 02:36:51,678 - EarlyStopping counter: 5 out of 8
2023-12-29 02:37:15,490 - ***** Epoch: 34: Eval results *****
2023-12-29 02:37:15,490 -   train_loss = 0.0224
2023-12-29 02:37:15,490 -   best_eval_score = 0.663
2023-12-29 02:37:15,490 -   eval_score = 0.62
2023-12-29 02:37:15,490 - EarlyStopping counter: 6 out of 8
2023-12-29 02:37:39,682 - ***** Epoch: 35: Eval results *****
2023-12-29 02:37:39,682 -   train_loss = 0.0176
2023-12-29 02:37:39,682 -   best_eval_score = 0.663
2023-12-29 02:37:39,682 -   eval_score = 0.621
2023-12-29 02:37:39,682 - EarlyStopping counter: 7 out of 8
2023-12-29 02:38:03,139 - ***** Epoch: 36: Eval results *****
2023-12-29 02:38:03,139 -   train_loss = nan
2023-12-29 02:38:03,139 -   best_eval_score = 0.663
2023-12-29 02:38:03,139 -   eval_score = 0.0114
2023-12-29 02:38:03,139 - EarlyStopping counter: 8 out of 8
2023-12-29 02:38:03,139 - EarlyStopping at epoch 36
2023-12-29 02:38:03,142 - Training is finished...
2023-12-29 02:38:03,142 - Testing begins...
2023-12-29 02:38:06,973 - ***** Test: Confusion Matrix *****
2023-12-29 02:38:06,974 - [[26  1  0  0  4  1  7  5  0  4  1  1  4  2  0  1  0  0  0  0]
 [ 0 36  0  1  0  0  2  2  1  0  0  0  0  0  0  1  0  0  0  0]
 [ 0  0 27  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1]
 [ 3  0  0  0  9  0  6  0  0  0  1  1  0  2  1  0  0  0  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  0  0  6  0  1  1  0  1  1  0  0  0  0  0  0  0]
 [ 3  0  0  0  0  0  0  5  1  1  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  1  4  2  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  0  1  0  2  0  0  0  0  0  3  0  3  0  0]
 [ 1  0  0  0  0  0  1  1  0  1 13  0  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 17  1  0  0  0  0  0  0  1]
 [ 5  1  0  1  0  1  4  4  3  0  0  0 26  0  6  2  1  1  0  2]
 [ 0  1  0  0  0  0  1  0  0  0  2  1  0 13  4  0  1  0  0  2]
 [ 0  0  0  0  1  0  1  0  0  0  0  0  0  2 14  0  1  0  0  3]
 [ 0  0  0  1  0  0  1  1  1  0  0  0  3  0  1 12  0  0  0  1]
 [ 0  0  0  0  0  0  0  2  0  0  0  0  0  0  4  1 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  2  0  1  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0  0  8]]
2023-12-29 02:38:06,974 - ***** Evaluation results *****
2023-12-29 02:38:06,974 -   acc = 0.6337
2023-12-29 02:38:06,974 -   f1 = 0.6136
2023-12-29 02:38:06,974 -   prec = 0.6216
2023-12-29 02:38:06,974 -   rec = 0.6359
2023-12-29 02:38:06,974 - Testing is finished...
2023-12-29 02:38:06,974 - Multimodal intent recognition is finished...
2023-12-29 02:38:06,974 - Results are saved in results/msz.csv
