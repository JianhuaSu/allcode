2023-12-26 11:29:06,916 - ============================== Params ==============================
2023-12-26 11:29:06,917 - logger_name: msz_MIntRec_multi-class_seed-7_2023-12-26-11-29-06
2023-12-26 11:29:06,917 - dataset: MIntRec
2023-12-26 11:29:06,917 - data_mode: multi-class
2023-12-26 11:29:06,918 - method: msz
2023-12-26 11:29:06,918 - text_backbone: bert-base-uncased
2023-12-26 11:29:06,918 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-26 11:29:06,919 - seed: 7
2023-12-26 11:29:06,919 - num_workers: 8
2023-12-26 11:29:06,919 - gpu_id: 3
2023-12-26 11:29:06,919 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-26 11:29:06,920 - train: True
2023-12-26 11:29:06,920 - tune: False
2023-12-26 11:29:06,920 - save_model: False
2023-12-26 11:29:06,921 - save_results: True
2023-12-26 11:29:06,921 - log_path: logs
2023-12-26 11:29:06,921 - cache_path: 
2023-12-26 11:29:06,922 - video_data_path: video_data
2023-12-26 11:29:06,922 - audio_data_path: audio_data
2023-12-26 11:29:06,923 - video_feats_path: video_feats.pkl
2023-12-26 11:29:06,923 - audio_feats_path: audio_feats.pkl
2023-12-26 11:29:06,923 - results_path: results
2023-12-26 11:29:06,923 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-26 11:29:06,924 - model_path: models
2023-12-26 11:29:06,924 - config_file_name: msz
2023-12-26 11:29:06,924 - results_file_name: msz.csv
2023-12-26 11:29:06,925 - padding_mode: zero
2023-12-26 11:29:06,925 - padding_loc: end
2023-12-26 11:29:06,925 - need_aligned: False
2023-12-26 11:29:06,926 - eval_monitor: f1
2023-12-26 11:29:06,926 - train_batch_size: 16
2023-12-26 11:29:06,926 - eval_batch_size: 8
2023-12-26 11:29:06,927 - test_batch_size: 8
2023-12-26 11:29:06,927 - wait_patience: 8
2023-12-26 11:29:06,928 - nheads: 2
2023-12-26 11:29:06,928 - encoder_layers: 2
2023-12-26 11:29:06,928 - attn_dropout: 0.1
2023-12-26 11:29:06,929 - relu_dropout: 0.1
2023-12-26 11:29:06,929 - embed_dropout: 0.1
2023-12-26 11:29:06,929 - res_dropout: 0.1
2023-12-26 11:29:06,929 - attn_mask: False
2023-12-26 11:29:06,930 - hidden_size: 768
2023-12-26 11:29:06,930 - num_attention_heads: 12
2023-12-26 11:29:06,930 - attention_probs_dropout_prob: 0.2
2023-12-26 11:29:06,930 - hidden_dropout_prob: 0.2
2023-12-26 11:29:06,931 - intermediate_size: 768
2023-12-26 11:29:06,931 - num_hidden_layers: 3
2023-12-26 11:29:06,931 - max_position_embeddings: 512
2023-12-26 11:29:06,931 - position_embedding_type: absolute
2023-12-26 11:29:06,932 - add_cross_attention: False
2023-12-26 11:29:06,932 - batch_first: True
2023-12-26 11:29:06,932 - hidden_dims: 768
2023-12-26 11:29:06,932 - att_dropouts: [0.1, 0.1, 0.1]
2023-12-26 11:29:06,933 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-26 11:29:06,933 - tv_c_loss: 0.01
2023-12-26 11:29:06,933 - vt_c_loss: 0.05
2023-12-26 11:29:06,933 - at_c_loss: 0.02
2023-12-26 11:29:06,934 - aligned_method: conv1d
2023-12-26 11:29:06,934 - num_train_epochs: 100
2023-12-26 11:29:06,934 - warmup_proportion: 0.1
2023-12-26 11:29:06,935 - lr: 3e-06
2023-12-26 11:29:06,935 - weight_decay: 0.01
2023-12-26 11:29:06,935 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-7_2023-12-26-11-29-06
2023-12-26 11:29:06,935 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-7_2023-12-26-11-29-06/models
2023-12-26 11:29:06,936 - ============================== End Params ==============================
2023-12-26 11:29:06,984 - Generate Text Features Begin...
2023-12-26 11:29:07,982 - Generate Text Features Finished...
2023-12-26 11:29:07,982 - Load Video Features Begin...
2023-12-26 11:29:10,300 - Load Video Features Finished...
2023-12-26 11:29:11,063 - Load Audio Features Begin...
2023-12-26 11:29:24,377 - Load Audio Features Finished...
2023-12-26 11:29:29,640 - method  begins...
2023-12-26 11:29:39,334 - Multimodal intent recognition begins...
2023-12-26 11:29:39,334 - Training begins...
2023-12-26 11:30:24,031 - ***** Epoch: 1: Eval results *****
2023-12-26 11:30:24,032 -   train_loss = 3.8059
2023-12-26 11:30:24,032 -   best_eval_score = 0.0
2023-12-26 11:30:24,032 -   eval_score = 0.0174
2023-12-26 11:31:07,862 - ***** Epoch: 2: Eval results *****
2023-12-26 11:31:07,862 -   train_loss = 3.333
2023-12-26 11:31:07,862 -   best_eval_score = 0.0174
2023-12-26 11:31:07,862 -   eval_score = 0.0233
2023-12-26 11:31:54,042 - ***** Epoch: 3: Eval results *****
2023-12-26 11:31:54,042 -   train_loss = 3.0254
2023-12-26 11:31:54,042 -   best_eval_score = 0.0233
2023-12-26 11:31:54,042 -   eval_score = 0.1146
2023-12-26 11:32:40,643 - ***** Epoch: 4: Eval results *****
2023-12-26 11:32:40,644 -   train_loss = 2.7041
2023-12-26 11:32:40,644 -   best_eval_score = 0.1146
2023-12-26 11:32:40,644 -   eval_score = 0.1866
2023-12-26 11:33:24,766 - ***** Epoch: 5: Eval results *****
2023-12-26 11:33:24,767 -   train_loss = 2.2853
2023-12-26 11:33:24,767 -   best_eval_score = 0.1866
2023-12-26 11:33:24,767 -   eval_score = 0.243
2023-12-26 11:34:07,612 - ***** Epoch: 6: Eval results *****
2023-12-26 11:34:07,613 -   train_loss = 1.9451
2023-12-26 11:34:07,613 -   best_eval_score = 0.243
2023-12-26 11:34:07,613 -   eval_score = 0.4232
2023-12-26 11:34:49,134 - ***** Epoch: 7: Eval results *****
2023-12-26 11:34:49,135 -   train_loss = 1.5313
2023-12-26 11:34:49,135 -   best_eval_score = 0.4232
2023-12-26 11:34:49,135 -   eval_score = 0.4714
2023-12-26 11:35:32,816 - ***** Epoch: 8: Eval results *****
2023-12-26 11:35:32,816 -   train_loss = 1.1856
2023-12-26 11:35:32,817 -   best_eval_score = 0.4714
2023-12-26 11:35:32,817 -   eval_score = 0.5372
2023-12-26 11:36:17,960 - ***** Epoch: 9: Eval results *****
2023-12-26 11:36:17,961 -   train_loss = 0.9577
2023-12-26 11:36:17,962 -   best_eval_score = 0.5372
2023-12-26 11:36:17,963 -   eval_score = 0.5177
2023-12-26 11:36:17,963 - EarlyStopping counter: 1 out of 8
2023-12-26 11:37:02,176 - ***** Epoch: 10: Eval results *****
2023-12-26 11:37:02,177 -   train_loss = 0.7231
2023-12-26 11:37:02,177 -   best_eval_score = 0.5372
2023-12-26 11:37:02,177 -   eval_score = 0.5178
2023-12-26 11:37:02,178 - EarlyStopping counter: 2 out of 8
2023-12-26 11:37:42,759 - ***** Epoch: 11: Eval results *****
2023-12-26 11:37:42,763 -   train_loss = 0.5451
2023-12-26 11:37:42,763 -   best_eval_score = 0.5372
2023-12-26 11:37:42,764 -   eval_score = 0.0114
2023-12-26 11:37:42,764 - EarlyStopping counter: 3 out of 8
2023-12-26 11:38:21,092 - ***** Epoch: 12: Eval results *****
2023-12-26 11:38:21,092 -   train_loss = nan
2023-12-26 11:38:21,092 -   best_eval_score = 0.5372
2023-12-26 11:38:21,092 -   eval_score = 0.0114
2023-12-26 11:38:21,092 - EarlyStopping counter: 4 out of 8
2023-12-26 11:39:04,530 - ***** Epoch: 13: Eval results *****
2023-12-26 11:39:04,531 -   train_loss = nan
2023-12-26 11:39:04,531 -   best_eval_score = 0.5372
2023-12-26 11:39:04,531 -   eval_score = 0.0114
2023-12-26 11:39:04,532 - EarlyStopping counter: 5 out of 8
2023-12-26 11:39:48,594 - ***** Epoch: 14: Eval results *****
2023-12-26 11:39:48,606 -   train_loss = nan
2023-12-26 11:39:48,607 -   best_eval_score = 0.5372
2023-12-26 11:39:48,607 -   eval_score = 0.0114
2023-12-26 11:39:48,607 - EarlyStopping counter: 6 out of 8
2023-12-26 11:40:22,176 - ***** Epoch: 15: Eval results *****
2023-12-26 11:40:22,177 -   train_loss = nan
2023-12-26 11:40:22,177 -   best_eval_score = 0.5372
2023-12-26 11:40:22,177 -   eval_score = 0.0114
2023-12-26 11:40:22,177 - EarlyStopping counter: 7 out of 8
2023-12-26 11:41:02,836 - ***** Epoch: 16: Eval results *****
2023-12-26 11:41:02,836 -   train_loss = nan
2023-12-26 11:41:02,836 -   best_eval_score = 0.5372
2023-12-26 11:41:02,836 -   eval_score = 0.0114
2023-12-26 11:41:02,836 - EarlyStopping counter: 8 out of 8
2023-12-26 11:41:02,836 - EarlyStopping at epoch 16
2023-12-26 11:41:02,839 - Training is finished...
2023-12-26 11:41:02,839 - Testing begins...
2023-12-26 11:41:11,462 - ***** Test: Confusion Matrix *****
2023-12-26 11:41:11,463 - [[45  0  0  0  4  0  0  0  0  1  1  0  2  2  0  2  0  0  0  0]
 [ 4 33  0  0  3  0  0  0  0  0  0  0  2  1  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 6  0  0  0 14  0  0  0  0  0  0  1  0  2  0  0  0  0  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 6  0  0  0  4  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0]
 [ 8  0  0  0  0  1  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 7  0  0  0  0  0  0  0  0  0  0  0  0  1  0  1  1  0  0  0]
 [ 3  0  0  0  1  1  0  0  0  0  1  0  0  0  0  3  1  0  0  0]
 [ 2  0  0  0  0  1  0  0  0  0 11  0  1  2  1  0  0  0  0  0]
 [ 0  0  0  0  2  0  0  0  0  0  0 17  0  0  0  0  0  0  0  0]
 [12  0  0  0  0  0  0  0  0  0  0  1 31  6  2  2  3  0  0  0]
 [ 2  0  0  0  1  1  0  0  0  0  1  1  1 18  0  0  0  0  0  0]
 [ 1  0  0  0  2  0  0  0  0  0  0  0  1 11  6  0  1  0  0  0]
 [ 5  0  0  0  0  0  0  0  0  0  0  0  3  0  2 11  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  2  0  0  0 14  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  5  0  1  1  2  0  0  5  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  2  1  3  0  0  1  0  0  2]]
2023-12-26 11:41:11,465 - ***** Evaluation results *****
2023-12-26 11:41:11,465 -   acc = 0.627
2023-12-26 11:41:11,466 -   f1 = 0.5287
2023-12-26 11:41:11,466 -   prec = 0.5818
2023-12-26 11:41:11,466 -   rec = 0.5401
2023-12-26 11:41:11,467 - Testing is finished...
2023-12-26 11:41:11,467 - Multimodal intent recognition is finished...
2023-12-26 11:41:11,467 - Results are saved in results/msz.csv
