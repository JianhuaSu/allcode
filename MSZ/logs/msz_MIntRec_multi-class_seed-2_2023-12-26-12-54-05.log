2023-12-26 12:54:05,260 - ============================== Params ==============================
2023-12-26 12:54:05,261 - logger_name: msz_MIntRec_multi-class_seed-2_2023-12-26-12-54-05
2023-12-26 12:54:05,261 - dataset: MIntRec
2023-12-26 12:54:05,261 - data_mode: multi-class
2023-12-26 12:54:05,261 - method: msz
2023-12-26 12:54:05,261 - text_backbone: bert-base-uncased
2023-12-26 12:54:05,261 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-26 12:54:05,262 - seed: 2
2023-12-26 12:54:05,262 - num_workers: 8
2023-12-26 12:54:05,262 - gpu_id: 3
2023-12-26 12:54:05,262 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-26 12:54:05,262 - train: True
2023-12-26 12:54:05,262 - tune: False
2023-12-26 12:54:05,262 - save_model: False
2023-12-26 12:54:05,263 - save_results: True
2023-12-26 12:54:05,263 - log_path: logs
2023-12-26 12:54:05,263 - cache_path: 
2023-12-26 12:54:05,263 - video_data_path: video_data
2023-12-26 12:54:05,263 - audio_data_path: audio_data
2023-12-26 12:54:05,263 - video_feats_path: video_feats.pkl
2023-12-26 12:54:05,263 - audio_feats_path: audio_feats.pkl
2023-12-26 12:54:05,264 - results_path: results
2023-12-26 12:54:05,264 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-26 12:54:05,264 - model_path: models
2023-12-26 12:54:05,264 - config_file_name: msz
2023-12-26 12:54:05,264 - results_file_name: msz.csv
2023-12-26 12:54:05,264 - padding_mode: zero
2023-12-26 12:54:05,264 - padding_loc: end
2023-12-26 12:54:05,265 - need_aligned: False
2023-12-26 12:54:05,265 - eval_monitor: f1
2023-12-26 12:54:05,265 - train_batch_size: 16
2023-12-26 12:54:05,265 - eval_batch_size: 8
2023-12-26 12:54:05,265 - test_batch_size: 8
2023-12-26 12:54:05,265 - wait_patience: 8
2023-12-26 12:54:05,265 - nheads: 2
2023-12-26 12:54:05,265 - encoder_layers: 2
2023-12-26 12:54:05,266 - attn_dropout: 0.1
2023-12-26 12:54:05,266 - relu_dropout: 0.1
2023-12-26 12:54:05,266 - embed_dropout: 0.1
2023-12-26 12:54:05,266 - res_dropout: 0.1
2023-12-26 12:54:05,266 - attn_mask: False
2023-12-26 12:54:05,266 - hidden_size: 768
2023-12-26 12:54:05,266 - num_attention_heads: 12
2023-12-26 12:54:05,267 - attention_probs_dropout_prob: 0.2
2023-12-26 12:54:05,267 - hidden_dropout_prob: 0.2
2023-12-26 12:54:05,267 - intermediate_size: 768
2023-12-26 12:54:05,267 - num_hidden_layers: 3
2023-12-26 12:54:05,267 - max_position_embeddings: 512
2023-12-26 12:54:05,267 - position_embedding_type: absolute
2023-12-26 12:54:05,267 - add_cross_attention: False
2023-12-26 12:54:05,268 - batch_first: True
2023-12-26 12:54:05,268 - hidden_dims: 768
2023-12-26 12:54:05,268 - att_dropouts: [0.2, 0.2, 0.2]
2023-12-26 12:54:05,268 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-26 12:54:05,268 - tv_c_loss: 0.01
2023-12-26 12:54:05,268 - vt_c_loss: 0.05
2023-12-26 12:54:05,268 - at_c_loss: 0.02
2023-12-26 12:54:05,269 - aligned_method: conv1d
2023-12-26 12:54:05,269 - grad_clip: 2
2023-12-26 12:54:05,269 - num_train_epochs: 100
2023-12-26 12:54:05,269 - warmup_proportion: 0.1
2023-12-26 12:54:05,269 - lr: 1e-06
2023-12-26 12:54:05,269 - weight_decay: 0.03
2023-12-26 12:54:05,269 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2023-12-26-12-54-05
2023-12-26 12:54:05,270 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2023-12-26-12-54-05/models
2023-12-26 12:54:05,270 - ============================== End Params ==============================
2023-12-26 12:54:05,316 - Generate Text Features Begin...
2023-12-26 12:54:06,115 - Generate Text Features Finished...
2023-12-26 12:54:06,116 - Load Video Features Begin...
2023-12-26 12:54:07,115 - Load Video Features Finished...
2023-12-26 12:54:08,441 - Load Audio Features Begin...
2023-12-26 12:54:14,093 - Load Audio Features Finished...
2023-12-26 12:54:20,085 - method  begins...
2023-12-26 12:54:28,245 - Multimodal intent recognition begins...
2023-12-26 12:54:28,246 - Training begins...
2023-12-26 12:55:18,093 - ***** Epoch: 1: Eval results *****
2023-12-26 12:55:18,093 -   train_loss = 3.8977
2023-12-26 12:55:18,093 -   best_eval_score = 0.0
2023-12-26 12:55:18,093 -   eval_score = 0.0499
2023-12-26 12:55:58,255 - ***** Epoch: 2: Eval results *****
2023-12-26 12:55:58,256 -   train_loss = 3.6172
2023-12-26 12:55:58,256 -   best_eval_score = 0.0499
2023-12-26 12:55:58,256 -   eval_score = 0.0462
2023-12-26 12:55:58,256 - EarlyStopping counter: 1 out of 8
2023-12-26 12:56:39,539 - ***** Epoch: 3: Eval results *****
2023-12-26 12:56:39,540 -   train_loss = 3.3757
2023-12-26 12:56:39,540 -   best_eval_score = 0.0499
2023-12-26 12:56:39,540 -   eval_score = 0.0328
2023-12-26 12:56:39,540 - EarlyStopping counter: 2 out of 8
2023-12-26 12:57:30,670 - ***** Epoch: 4: Eval results *****
2023-12-26 12:57:30,671 -   train_loss = 3.1871
2023-12-26 12:57:30,671 -   best_eval_score = 0.0499
2023-12-26 12:57:30,671 -   eval_score = 0.0341
2023-12-26 12:57:30,672 - EarlyStopping counter: 3 out of 8
2023-12-26 12:58:20,458 - ***** Epoch: 5: Eval results *****
2023-12-26 12:58:20,458 -   train_loss = 3.0271
2023-12-26 12:58:20,458 -   best_eval_score = 0.0499
2023-12-26 12:58:20,458 -   eval_score = 0.1214
2023-12-26 12:59:08,283 - ***** Epoch: 6: Eval results *****
2023-12-26 12:59:08,283 -   train_loss = 2.8326
2023-12-26 12:59:08,284 -   best_eval_score = 0.1214
2023-12-26 12:59:08,284 -   eval_score = 0.202
2023-12-26 12:59:52,107 - ***** Epoch: 7: Eval results *****
2023-12-26 12:59:52,107 -   train_loss = 2.5481
2023-12-26 12:59:52,108 -   best_eval_score = 0.202
2023-12-26 12:59:52,108 -   eval_score = 0.2809
2023-12-26 13:00:35,953 - ***** Epoch: 8: Eval results *****
2023-12-26 13:00:35,954 -   train_loss = 2.1961
2023-12-26 13:00:35,954 -   best_eval_score = 0.2809
2023-12-26 13:00:35,954 -   eval_score = 0.4004
2023-12-26 13:01:19,718 - ***** Epoch: 9: Eval results *****
2023-12-26 13:01:19,719 -   train_loss = 1.8503
2023-12-26 13:01:19,719 -   best_eval_score = 0.4004
2023-12-26 13:01:19,719 -   eval_score = 0.4398
2023-12-26 13:02:09,676 - ***** Epoch: 10: Eval results *****
2023-12-26 13:02:09,676 -   train_loss = 1.5919
2023-12-26 13:02:09,676 -   best_eval_score = 0.4398
2023-12-26 13:02:09,676 -   eval_score = 0.5052
2023-12-26 13:02:57,258 - ***** Epoch: 11: Eval results *****
2023-12-26 13:02:57,258 -   train_loss = 1.3545
2023-12-26 13:02:57,258 -   best_eval_score = 0.5052
2023-12-26 13:02:57,259 -   eval_score = 0.521
2023-12-26 13:03:38,324 - ***** Epoch: 12: Eval results *****
2023-12-26 13:03:38,324 -   train_loss = 1.0974
2023-12-26 13:03:38,325 -   best_eval_score = 0.521
2023-12-26 13:03:38,325 -   eval_score = 0.5147
2023-12-26 13:03:38,325 - EarlyStopping counter: 1 out of 8
2023-12-26 13:04:16,765 - ***** Epoch: 13: Eval results *****
2023-12-26 13:04:16,769 -   train_loss = 0.9022
2023-12-26 13:04:16,770 -   best_eval_score = 0.521
2023-12-26 13:04:16,770 -   eval_score = 0.5668
2023-12-26 13:04:55,861 - ***** Epoch: 14: Eval results *****
2023-12-26 13:04:55,863 -   train_loss = 0.7719
2023-12-26 13:04:55,863 -   best_eval_score = 0.5668
2023-12-26 13:04:55,863 -   eval_score = 0.5447
2023-12-26 13:04:55,864 - EarlyStopping counter: 1 out of 8
2023-12-26 13:05:35,727 - ***** Epoch: 15: Eval results *****
2023-12-26 13:05:35,728 -   train_loss = 0.5912
2023-12-26 13:05:35,728 -   best_eval_score = 0.5668
2023-12-26 13:05:35,728 -   eval_score = 0.5723
2023-12-26 13:06:16,884 - ***** Epoch: 16: Eval results *****
2023-12-26 13:06:16,885 -   train_loss = 0.4744
2023-12-26 13:06:16,885 -   best_eval_score = 0.5723
2023-12-26 13:06:16,886 -   eval_score = 0.5984
2023-12-26 13:06:58,456 - ***** Epoch: 17: Eval results *****
2023-12-26 13:06:58,457 -   train_loss = 0.3787
2023-12-26 13:06:58,457 -   best_eval_score = 0.5984
2023-12-26 13:06:58,457 -   eval_score = 0.6138
2023-12-26 13:07:42,843 - ***** Epoch: 18: Eval results *****
2023-12-26 13:07:42,843 -   train_loss = 0.3088
2023-12-26 13:07:42,843 -   best_eval_score = 0.6138
2023-12-26 13:07:42,843 -   eval_score = 0.6343
2023-12-26 13:08:25,309 - ***** Epoch: 19: Eval results *****
2023-12-26 13:08:25,309 -   train_loss = 0.2432
2023-12-26 13:08:25,310 -   best_eval_score = 0.6343
2023-12-26 13:08:25,310 -   eval_score = 0.6069
2023-12-26 13:08:25,310 - EarlyStopping counter: 1 out of 8
2023-12-26 13:09:02,633 - ***** Epoch: 20: Eval results *****
2023-12-26 13:09:02,633 -   train_loss = 0.2052
2023-12-26 13:09:02,633 -   best_eval_score = 0.6343
2023-12-26 13:09:02,633 -   eval_score = 0.6173
2023-12-26 13:09:02,633 - EarlyStopping counter: 2 out of 8
2023-12-26 13:09:37,049 - ***** Epoch: 21: Eval results *****
2023-12-26 13:09:37,058 -   train_loss = 0.1692
2023-12-26 13:09:37,058 -   best_eval_score = 0.6343
2023-12-26 13:09:37,058 -   eval_score = 0.6391
2023-12-26 13:10:15,129 - ***** Epoch: 22: Eval results *****
2023-12-26 13:10:15,138 -   train_loss = 0.1365
2023-12-26 13:10:15,138 -   best_eval_score = 0.6391
2023-12-26 13:10:15,138 -   eval_score = 0.6518
2023-12-26 13:10:57,324 - ***** Epoch: 23: Eval results *****
2023-12-26 13:10:57,324 -   train_loss = 0.1147
2023-12-26 13:10:57,324 -   best_eval_score = 0.6518
2023-12-26 13:10:57,324 -   eval_score = 0.6521
2023-12-26 13:11:36,085 - ***** Epoch: 24: Eval results *****
2023-12-26 13:11:36,085 -   train_loss = nan
2023-12-26 13:11:36,086 -   best_eval_score = 0.6521
2023-12-26 13:11:36,086 -   eval_score = 0.0114
2023-12-26 13:11:36,086 - EarlyStopping counter: 1 out of 8
2023-12-26 13:12:10,264 - ***** Epoch: 25: Eval results *****
2023-12-26 13:12:10,264 -   train_loss = nan
2023-12-26 13:12:10,264 -   best_eval_score = 0.6521
2023-12-26 13:12:10,264 -   eval_score = 0.0114
2023-12-26 13:12:10,264 - EarlyStopping counter: 2 out of 8
2023-12-26 13:12:46,304 - ***** Epoch: 26: Eval results *****
2023-12-26 13:12:46,304 -   train_loss = nan
2023-12-26 13:12:46,305 -   best_eval_score = 0.6521
2023-12-26 13:12:46,305 -   eval_score = 0.0114
2023-12-26 13:12:46,305 - EarlyStopping counter: 3 out of 8
2023-12-26 13:13:27,206 - ***** Epoch: 27: Eval results *****
2023-12-26 13:13:27,207 -   train_loss = nan
2023-12-26 13:13:27,207 -   best_eval_score = 0.6521
2023-12-26 13:13:27,207 -   eval_score = 0.0114
2023-12-26 13:13:27,207 - EarlyStopping counter: 4 out of 8
2023-12-26 13:14:06,873 - ***** Epoch: 28: Eval results *****
2023-12-26 13:14:06,874 -   train_loss = nan
2023-12-26 13:14:06,874 -   best_eval_score = 0.6521
2023-12-26 13:14:06,874 -   eval_score = 0.0114
2023-12-26 13:14:06,874 - EarlyStopping counter: 5 out of 8
2023-12-26 13:14:43,261 - ***** Epoch: 29: Eval results *****
2023-12-26 13:14:43,262 -   train_loss = nan
2023-12-26 13:14:43,262 -   best_eval_score = 0.6521
2023-12-26 13:14:43,262 -   eval_score = 0.0114
2023-12-26 13:14:43,262 - EarlyStopping counter: 6 out of 8
2023-12-26 13:15:17,229 - ***** Epoch: 30: Eval results *****
2023-12-26 13:15:17,229 -   train_loss = nan
2023-12-26 13:15:17,229 -   best_eval_score = 0.6521
2023-12-26 13:15:17,229 -   eval_score = 0.0114
2023-12-26 13:15:17,229 - EarlyStopping counter: 7 out of 8
2023-12-26 13:15:53,915 - ***** Epoch: 31: Eval results *****
2023-12-26 13:15:53,915 -   train_loss = nan
2023-12-26 13:15:53,915 -   best_eval_score = 0.6521
2023-12-26 13:15:53,915 -   eval_score = 0.0114
2023-12-26 13:15:53,915 - EarlyStopping counter: 8 out of 8
2023-12-26 13:15:53,915 - EarlyStopping at epoch 31
2023-12-26 13:15:53,917 - Training is finished...
2023-12-26 13:15:53,918 - Testing begins...
2023-12-26 13:16:00,308 - ***** Test: Confusion Matrix *****
2023-12-26 13:16:00,310 - [[29  0  0  0  8  1  3  3  0  4  0  0  7  0  0  2  0  0  0  0]
 [ 0 37  0  1  0  0  1  1  0  0  0  0  2  0  0  0  0  0  0  1]
 [ 0  0 27  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 4  0  0  0 15  0  3  0  0  0  0  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0 10  0  0  0  1  0  0  0  0  0  0  0  0  1  0]
 [ 0  0  0  0  2  0  4  0  3  0  0  1  1  0  0  0  0  1  0  0]
 [ 2  0  0  0  0  0  0  5  1  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  3  4  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  0  1  0  3  0  0  0  0  0  3  0  2  0  0]
 [ 1  0  0  0  0  1  2  0  1  1 10  0  1  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 16  1  0  0  0  0  0  0  1]
 [ 3  1  0  0  1  0  1  2  0  0  1  0 42  1  2  0  0  0  2  1]
 [ 0  0  0  0  0  0  1  0  1  0  1  1  1 17  1  1  0  0  0  1]
 [ 0  0  0  0  0  0  1  0  1  0  0  0  0  3 16  0  0  0  0  1]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  4  0  0 15  0  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  2  0  4  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0 13  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  1  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  1  1  0  1  0  0  6]]
2023-12-26 13:16:00,310 - ***** Evaluation results *****
2023-12-26 13:16:00,310 -   acc = 0.7011
2023-12-26 13:16:00,310 -   f1 = 0.6627
2023-12-26 13:16:00,310 -   prec = 0.6689
2023-12-26 13:16:00,310 -   rec = 0.6683
2023-12-26 13:16:00,310 - Testing is finished...
2023-12-26 13:16:00,310 - Multimodal intent recognition is finished...
2023-12-26 13:16:00,311 - Results are saved in results/msz.csv
