2024-01-16 02:57:47,290 - ============================== Params ==============================
2024-01-16 02:57:47,291 - logger_name: msz_MIntRec_multi-class_seed-1_2024-01-16-02-57-47
2024-01-16 02:57:47,291 - dataset: MIntRec
2024-01-16 02:57:47,291 - data_mode: multi-class
2024-01-16 02:57:47,291 - method: msz
2024-01-16 02:57:47,291 - text_backbone: bert-base-uncased
2024-01-16 02:57:47,291 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-16 02:57:47,291 - seed: 1
2024-01-16 02:57:47,291 - num_workers: 8
2024-01-16 02:57:47,291 - gpu_id: 1
2024-01-16 02:57:47,291 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-16 02:57:47,291 - train: True
2024-01-16 02:57:47,291 - tune: False
2024-01-16 02:57:47,291 - save_model: False
2024-01-16 02:57:47,291 - save_results: True
2024-01-16 02:57:47,291 - log_path: logs
2024-01-16 02:57:47,291 - cache_path: 
2024-01-16 02:57:47,291 - video_data_path: video_data
2024-01-16 02:57:47,291 - audio_data_path: audio_data
2024-01-16 02:57:47,291 - video_feats_path: video_feats.pkl
2024-01-16 02:57:47,291 - audio_feats_path: audio_feats.pkl
2024-01-16 02:57:47,291 - results_path: results
2024-01-16 02:57:47,291 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-16 02:57:47,291 - model_path: models
2024-01-16 02:57:47,291 - config_file_name: msz
2024-01-16 02:57:47,291 - results_file_name: msz.csv
2024-01-16 02:57:47,291 - padding_mode: zero
2024-01-16 02:57:47,291 - padding_loc: end
2024-01-16 02:57:47,291 - need_aligned: False
2024-01-16 02:57:47,291 - eval_monitor: f1
2024-01-16 02:57:47,291 - train_batch_size: 16
2024-01-16 02:57:47,291 - eval_batch_size: 8
2024-01-16 02:57:47,291 - test_batch_size: 8
2024-01-16 02:57:47,291 - wait_patience: 8
2024-01-16 02:57:47,291 - hidden_size: 768
2024-01-16 02:57:47,291 - num_attention_heads: 12
2024-01-16 02:57:47,291 - attention_probs_dropout_prob: 0.2
2024-01-16 02:57:47,291 - hidden_dropout_prob: 0.2
2024-01-16 02:57:47,291 - intermediate_size: 768
2024-01-16 02:57:47,291 - num_hidden_layers: 8
2024-01-16 02:57:47,291 - max_position_embeddings: 768
2024-01-16 02:57:47,292 - position_embedding_type: absolute
2024-01-16 02:57:47,292 - batch_first: True
2024-01-16 02:57:47,292 - hidden_dims: 768
2024-01-16 02:57:47,292 - dropout: 0.1
2024-01-16 02:57:47,292 - aligned_method: conv1d
2024-01-16 02:57:47,292 - num_train_epochs: 100
2024-01-16 02:57:47,292 - warmup_proportion: 0.1
2024-01-16 02:57:47,292 - lr: 5e-06
2024-01-16 02:57:47,292 - weight_decay: 0.01
2024-01-16 02:57:47,292 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-16-02-57-47
2024-01-16 02:57:47,292 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-16-02-57-47/models
2024-01-16 02:57:47,292 - ============================== End Params ==============================
2024-01-16 02:57:47,294 - Generate Text Features Begin...
2024-01-16 02:57:47,709 - Generate Text Features Finished...
2024-01-16 02:57:47,709 - Load Video Features Begin...
2024-01-16 02:57:47,996 - Load Video Features Finished...
2024-01-16 02:57:48,575 - Load Audio Features Begin...
2024-01-16 02:57:49,591 - Load Audio Features Finished...
2024-01-16 02:57:53,043 - method  begins...
2024-01-16 02:57:56,347 - Multimodal intent recognition begins...
2024-01-16 02:57:56,347 - Training begins...
2024-01-16 02:58:18,207 - ***** Epoch: 1: Eval results *****
2024-01-16 02:58:18,208 -   train_loss = 2.9095
2024-01-16 02:58:18,209 -   best_eval_score = 0.0
2024-01-16 02:58:18,209 -   eval_score = 0.0535
2024-01-16 02:58:38,384 - ***** Epoch: 2: Eval results *****
2024-01-16 02:58:38,384 -   train_loss = 2.5843
2024-01-16 02:58:38,384 -   best_eval_score = 0.0535
2024-01-16 02:58:38,384 -   eval_score = 0.2329
2024-01-16 02:58:57,843 - ***** Epoch: 3: Eval results *****
2024-01-16 02:58:57,843 -   train_loss = 2.0166
2024-01-16 02:58:57,843 -   best_eval_score = 0.2329
2024-01-16 02:58:57,843 -   eval_score = 0.4452
2024-01-16 02:59:17,641 - ***** Epoch: 4: Eval results *****
2024-01-16 02:59:17,641 -   train_loss = 1.4498
2024-01-16 02:59:17,642 -   best_eval_score = 0.4452
2024-01-16 02:59:17,642 -   eval_score = 0.5412
2024-01-16 02:59:37,691 - ***** Epoch: 5: Eval results *****
2024-01-16 02:59:37,691 -   train_loss = 1.0075
2024-01-16 02:59:37,691 -   best_eval_score = 0.5412
2024-01-16 02:59:37,691 -   eval_score = 0.5963
2024-01-16 02:59:57,597 - ***** Epoch: 6: Eval results *****
2024-01-16 02:59:57,597 -   train_loss = 0.6757
2024-01-16 02:59:57,597 -   best_eval_score = 0.5963
2024-01-16 02:59:57,597 -   eval_score = 0.6373
2024-01-16 03:00:17,083 - ***** Epoch: 7: Eval results *****
2024-01-16 03:00:17,083 -   train_loss = 0.4201
2024-01-16 03:00:17,083 -   best_eval_score = 0.6373
2024-01-16 03:00:17,083 -   eval_score = 0.6686
2024-01-16 03:00:36,650 - ***** Epoch: 8: Eval results *****
2024-01-16 03:00:36,650 -   train_loss = 0.2522
2024-01-16 03:00:36,650 -   best_eval_score = 0.6686
2024-01-16 03:00:36,650 -   eval_score = 0.6727
2024-01-16 03:00:56,552 - ***** Epoch: 9: Eval results *****
2024-01-16 03:00:56,553 -   train_loss = 0.1384
2024-01-16 03:00:56,553 -   best_eval_score = 0.6727
2024-01-16 03:00:56,553 -   eval_score = 0.6711
2024-01-16 03:00:56,553 - EarlyStopping counter: 1 out of 8
2024-01-16 03:01:16,550 - ***** Epoch: 10: Eval results *****
2024-01-16 03:01:16,550 -   train_loss = 0.0811
2024-01-16 03:01:16,550 -   best_eval_score = 0.6727
2024-01-16 03:01:16,550 -   eval_score = 0.6819
2024-01-16 03:01:36,384 - ***** Epoch: 11: Eval results *****
2024-01-16 03:01:36,384 -   train_loss = 0.0485
2024-01-16 03:01:36,384 -   best_eval_score = 0.6819
2024-01-16 03:01:36,384 -   eval_score = 0.6876
2024-01-16 03:01:56,317 - ***** Epoch: 12: Eval results *****
2024-01-16 03:01:56,318 -   train_loss = 0.029
2024-01-16 03:01:56,318 -   best_eval_score = 0.6876
2024-01-16 03:01:56,318 -   eval_score = 0.6792
2024-01-16 03:01:56,318 - EarlyStopping counter: 1 out of 8
2024-01-16 03:02:16,455 - ***** Epoch: 13: Eval results *****
2024-01-16 03:02:16,456 -   train_loss = 0.023
2024-01-16 03:02:16,456 -   best_eval_score = 0.6876
2024-01-16 03:02:16,456 -   eval_score = 0.675
2024-01-16 03:02:16,456 - EarlyStopping counter: 2 out of 8
2024-01-16 03:02:36,260 - ***** Epoch: 14: Eval results *****
2024-01-16 03:02:36,260 -   train_loss = 0.0167
2024-01-16 03:02:36,260 -   best_eval_score = 0.6876
2024-01-16 03:02:36,260 -   eval_score = 0.6792
2024-01-16 03:02:36,260 - EarlyStopping counter: 3 out of 8
2024-01-16 03:02:55,975 - ***** Epoch: 15: Eval results *****
2024-01-16 03:02:55,976 -   train_loss = 0.013
2024-01-16 03:02:55,976 -   best_eval_score = 0.6876
2024-01-16 03:02:55,976 -   eval_score = 0.6801
2024-01-16 03:02:55,976 - EarlyStopping counter: 4 out of 8
2024-01-16 03:03:16,148 - ***** Epoch: 16: Eval results *****
2024-01-16 03:03:16,149 -   train_loss = 0.0113
2024-01-16 03:03:16,149 -   best_eval_score = 0.6876
2024-01-16 03:03:16,149 -   eval_score = 0.6955
2024-01-16 03:03:36,007 - ***** Epoch: 17: Eval results *****
2024-01-16 03:03:36,007 -   train_loss = 0.0075
2024-01-16 03:03:36,007 -   best_eval_score = 0.6955
2024-01-16 03:03:36,007 -   eval_score = 0.697
2024-01-16 03:03:55,853 - ***** Epoch: 18: Eval results *****
2024-01-16 03:03:55,854 -   train_loss = 0.0068
2024-01-16 03:03:55,854 -   best_eval_score = 0.697
2024-01-16 03:03:55,854 -   eval_score = 0.6947
2024-01-16 03:03:55,854 - EarlyStopping counter: 1 out of 8
2024-01-16 03:04:15,865 - ***** Epoch: 19: Eval results *****
2024-01-16 03:04:15,865 -   train_loss = 0.0065
2024-01-16 03:04:15,866 -   best_eval_score = 0.697
2024-01-16 03:04:15,866 -   eval_score = 0.6928
2024-01-16 03:04:15,866 - EarlyStopping counter: 2 out of 8
2024-01-16 03:04:35,990 - ***** Epoch: 20: Eval results *****
2024-01-16 03:04:35,991 -   train_loss = 0.0058
2024-01-16 03:04:35,991 -   best_eval_score = 0.697
2024-01-16 03:04:35,991 -   eval_score = 0.6956
2024-01-16 03:04:35,991 - EarlyStopping counter: 3 out of 8
2024-01-16 03:04:55,632 - ***** Epoch: 21: Eval results *****
2024-01-16 03:04:55,632 -   train_loss = 0.0047
2024-01-16 03:04:55,632 -   best_eval_score = 0.697
2024-01-16 03:04:55,632 -   eval_score = 0.7022
2024-01-16 03:05:15,095 - ***** Epoch: 22: Eval results *****
2024-01-16 03:05:15,095 -   train_loss = 0.0048
2024-01-16 03:05:15,095 -   best_eval_score = 0.7022
2024-01-16 03:05:15,095 -   eval_score = 0.6967
2024-01-16 03:05:15,095 - EarlyStopping counter: 1 out of 8
2024-01-16 03:05:34,529 - ***** Epoch: 23: Eval results *****
2024-01-16 03:05:34,529 -   train_loss = 0.0042
2024-01-16 03:05:34,529 -   best_eval_score = 0.7022
2024-01-16 03:05:34,529 -   eval_score = 0.6938
2024-01-16 03:05:34,529 - EarlyStopping counter: 2 out of 8
2024-01-16 03:05:54,115 - ***** Epoch: 24: Eval results *****
2024-01-16 03:05:54,115 -   train_loss = 0.0038
2024-01-16 03:05:54,115 -   best_eval_score = 0.7022
2024-01-16 03:05:54,115 -   eval_score = 0.6933
2024-01-16 03:05:54,115 - EarlyStopping counter: 3 out of 8
2024-01-16 03:06:13,844 - ***** Epoch: 25: Eval results *****
2024-01-16 03:06:13,844 -   train_loss = 0.0034
2024-01-16 03:06:13,844 -   best_eval_score = 0.7022
2024-01-16 03:06:13,844 -   eval_score = 0.6887
2024-01-16 03:06:13,844 - EarlyStopping counter: 4 out of 8
2024-01-16 03:06:33,187 - ***** Epoch: 26: Eval results *****
2024-01-16 03:06:33,188 -   train_loss = 0.0028
2024-01-16 03:06:33,188 -   best_eval_score = 0.7022
2024-01-16 03:06:33,188 -   eval_score = 0.6989
2024-01-16 03:06:33,188 - EarlyStopping counter: 5 out of 8
2024-01-16 03:06:53,041 - ***** Epoch: 27: Eval results *****
2024-01-16 03:06:53,041 -   train_loss = 0.0032
2024-01-16 03:06:53,041 -   best_eval_score = 0.7022
2024-01-16 03:06:53,041 -   eval_score = 0.6878
2024-01-16 03:06:53,041 - EarlyStopping counter: 6 out of 8
2024-01-16 03:07:12,316 - ***** Epoch: 28: Eval results *****
2024-01-16 03:07:12,316 -   train_loss = 0.0026
2024-01-16 03:07:12,316 -   best_eval_score = 0.7022
2024-01-16 03:07:12,316 -   eval_score = 0.6885
2024-01-16 03:07:12,316 - EarlyStopping counter: 7 out of 8
2024-01-16 03:07:31,814 - ***** Epoch: 29: Eval results *****
2024-01-16 03:07:31,815 -   train_loss = 0.0027
2024-01-16 03:07:31,815 -   best_eval_score = 0.7022
2024-01-16 03:07:31,815 -   eval_score = 0.6855
2024-01-16 03:07:31,815 - EarlyStopping counter: 8 out of 8
2024-01-16 03:07:31,815 - EarlyStopping at epoch 29
2024-01-16 03:07:31,818 - Training is finished...
2024-01-16 03:07:31,819 - Testing begins...
2024-01-16 03:07:35,184 - ***** Test: Confusion Matrix *****
2024-01-16 03:07:35,185 - [[36  3  0  0  9  0  1  1  0  1  1  0  4  1  0  0  0  0  0  0]
 [ 0 35  0  1  0  3  0  0  0  0  1  0  3  0  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 7  0  0  0  9  0  2  0  0  0  0  1  2  0  1  0  0  1  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  3  0  2  1  1  0  0  0  2  0  1  0  0  0  0  0]
 [ 4  0  0  0  0  0  0  5  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  0  2  4  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  3  0  0  0  0  0  3  0  1  0  1]
 [ 1  0  0  0  0  0  0  0  0  1 14  0  0  0  1  0  1  0  0  0]
 [ 0  0  0  0  1  0  1  0  0  0  0 16  0  0  0  0  0  0  0  1]
 [ 3  2  0  0  1  0  0  0  1  0  0  1 37  4  3  2  2  0  0  1]
 [ 0  0  0  0  0  0  2  0  0  0  1  1  0 19  2  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  1  0  0  0  1  1 16  0  1  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  4  0  0 15  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  1  0 12  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  2  0  2  0  0  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  1  0  0  7]]
2024-01-16 03:07:35,185 - ***** Evaluation results *****
2024-01-16 03:07:35,185 -   acc = 0.6989
2024-01-16 03:07:35,185 -   f1 = 0.6711
2024-01-16 03:07:35,185 -   prec = 0.6809
2024-01-16 03:07:35,185 -   rec = 0.671
2024-01-16 03:07:35,185 - Testing is finished...
2024-01-16 03:07:35,185 - Multimodal intent recognition is finished...
2024-01-16 03:07:35,186 - Results are saved in results/msz.csv
