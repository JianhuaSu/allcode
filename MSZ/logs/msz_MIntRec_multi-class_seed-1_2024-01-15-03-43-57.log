2024-01-15 03:43:57,123 - ============================== Params ==============================
2024-01-15 03:43:57,124 - logger_name: msz_MIntRec_multi-class_seed-1_2024-01-15-03-43-57
2024-01-15 03:43:57,124 - dataset: MIntRec
2024-01-15 03:43:57,124 - data_mode: multi-class
2024-01-15 03:43:57,124 - method: msz
2024-01-15 03:43:57,124 - text_backbone: bert-base-uncased
2024-01-15 03:43:57,124 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-15 03:43:57,124 - seed: 1
2024-01-15 03:43:57,124 - num_workers: 8
2024-01-15 03:43:57,124 - gpu_id: 1
2024-01-15 03:43:57,124 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-15 03:43:57,124 - train: True
2024-01-15 03:43:57,124 - tune: False
2024-01-15 03:43:57,124 - save_model: False
2024-01-15 03:43:57,124 - save_results: True
2024-01-15 03:43:57,124 - log_path: logs
2024-01-15 03:43:57,124 - cache_path: 
2024-01-15 03:43:57,124 - video_data_path: video_data
2024-01-15 03:43:57,124 - audio_data_path: audio_data
2024-01-15 03:43:57,124 - video_feats_path: video_feats.pkl
2024-01-15 03:43:57,124 - audio_feats_path: audio_feats.pkl
2024-01-15 03:43:57,124 - results_path: results
2024-01-15 03:43:57,124 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-15 03:43:57,124 - model_path: models
2024-01-15 03:43:57,124 - config_file_name: msz
2024-01-15 03:43:57,124 - results_file_name: msz.csv
2024-01-15 03:43:57,124 - padding_mode: zero
2024-01-15 03:43:57,124 - padding_loc: end
2024-01-15 03:43:57,124 - need_aligned: False
2024-01-15 03:43:57,125 - eval_monitor: f1
2024-01-15 03:43:57,125 - train_batch_size: 16
2024-01-15 03:43:57,125 - eval_batch_size: 8
2024-01-15 03:43:57,125 - test_batch_size: 8
2024-01-15 03:43:57,125 - wait_patience: 8
2024-01-15 03:43:57,125 - nheads: 12
2024-01-15 03:43:57,125 - encoder_layers: 8
2024-01-15 03:43:57,125 - attn_dropout: 0.1
2024-01-15 03:43:57,125 - relu_dropout: 0.1
2024-01-15 03:43:57,125 - embed_dropout: 0.1
2024-01-15 03:43:57,125 - res_dropout: 0.1
2024-01-15 03:43:57,125 - attn_mask: False
2024-01-15 03:43:57,125 - hidden_size: 768
2024-01-15 03:43:57,125 - num_attention_heads: 12
2024-01-15 03:43:57,125 - attention_probs_dropout_prob: 0.1
2024-01-15 03:43:57,125 - hidden_dropout_prob: 0.1
2024-01-15 03:43:57,125 - intermediate_size: 768
2024-01-15 03:43:57,125 - num_hidden_layers: 8
2024-01-15 03:43:57,125 - max_position_embeddings: 768
2024-01-15 03:43:57,125 - position_embedding_type: absolute
2024-01-15 03:43:57,125 - batch_first: True
2024-01-15 03:43:57,125 - hidden_dims: 768
2024-01-15 03:43:57,125 - dropout: 0.2
2024-01-15 03:43:57,125 - aligned_method: conv1d
2024-01-15 03:43:57,125 - grad_clip: -1
2024-01-15 03:43:57,125 - num_train_epochs: 100
2024-01-15 03:43:57,125 - warmup_proportion: 0.1
2024-01-15 03:43:57,125 - lr: 3e-06
2024-01-15 03:43:57,125 - weight_decay: 0.01
2024-01-15 03:43:57,125 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-15-03-43-57
2024-01-15 03:43:57,125 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-15-03-43-57/models
2024-01-15 03:43:57,125 - ============================== End Params ==============================
2024-01-15 03:43:57,128 - Generate Text Features Begin...
2024-01-15 03:43:57,624 - Generate Text Features Finished...
2024-01-15 03:43:57,625 - Load Video Features Begin...
2024-01-15 03:43:57,925 - Load Video Features Finished...
2024-01-15 03:43:58,469 - Load Audio Features Begin...
2024-01-15 03:43:59,349 - Load Audio Features Finished...
2024-01-15 03:44:02,599 - method  begins...
2024-01-15 03:44:07,886 - Multimodal intent recognition begins...
2024-01-15 03:44:07,886 - Training begins...
2024-01-15 03:44:26,735 - ***** Epoch: 1: Eval results *****
2024-01-15 03:44:26,735 -   train_loss = 3.0035
2024-01-15 03:44:26,735 -   best_eval_score = 0.0
2024-01-15 03:44:26,735 -   eval_score = 0.0067
2024-01-15 03:44:43,587 - ***** Epoch: 2: Eval results *****
2024-01-15 03:44:43,587 -   train_loss = 2.9977
2024-01-15 03:44:43,588 -   best_eval_score = 0.0067
2024-01-15 03:44:43,588 -   eval_score = 0.0105
2024-01-15 03:45:01,283 - ***** Epoch: 3: Eval results *****
2024-01-15 03:45:01,283 -   train_loss = 2.9872
2024-01-15 03:45:01,283 -   best_eval_score = 0.0105
2024-01-15 03:45:01,283 -   eval_score = 0.0441
2024-01-15 03:45:17,751 - ***** Epoch: 4: Eval results *****
2024-01-15 03:45:17,751 -   train_loss = 2.9693
2024-01-15 03:45:17,751 -   best_eval_score = 0.0441
2024-01-15 03:45:17,751 -   eval_score = 0.0285
2024-01-15 03:45:17,751 - EarlyStopping counter: 1 out of 8
2024-01-15 03:45:35,272 - ***** Epoch: 5: Eval results *****
2024-01-15 03:45:35,272 -   train_loss = 2.9415
2024-01-15 03:45:35,272 -   best_eval_score = 0.0441
2024-01-15 03:45:35,272 -   eval_score = 0.0256
2024-01-15 03:45:35,272 - EarlyStopping counter: 2 out of 8
2024-01-15 03:45:52,003 - ***** Epoch: 6: Eval results *****
2024-01-15 03:45:52,004 -   train_loss = 2.8993
2024-01-15 03:45:52,004 -   best_eval_score = 0.0441
2024-01-15 03:45:52,004 -   eval_score = 0.0367
2024-01-15 03:45:52,004 - EarlyStopping counter: 3 out of 8
2024-01-15 03:46:09,442 - ***** Epoch: 7: Eval results *****
2024-01-15 03:46:09,443 -   train_loss = 2.8269
2024-01-15 03:46:09,443 -   best_eval_score = 0.0441
2024-01-15 03:46:09,443 -   eval_score = 0.0745
2024-01-15 03:46:26,031 - ***** Epoch: 8: Eval results *****
2024-01-15 03:46:26,031 -   train_loss = 2.6763
2024-01-15 03:46:26,031 -   best_eval_score = 0.0745
2024-01-15 03:46:26,031 -   eval_score = 0.1127
2024-01-15 03:46:43,320 - ***** Epoch: 9: Eval results *****
2024-01-15 03:46:43,321 -   train_loss = 2.4476
2024-01-15 03:46:43,321 -   best_eval_score = 0.1127
2024-01-15 03:46:43,321 -   eval_score = 0.2121
2024-01-15 03:46:59,996 - ***** Epoch: 10: Eval results *****
2024-01-15 03:46:59,997 -   train_loss = 2.1534
2024-01-15 03:46:59,997 -   best_eval_score = 0.2121
2024-01-15 03:46:59,997 -   eval_score = 0.2252
2024-01-15 03:47:17,343 - ***** Epoch: 11: Eval results *****
2024-01-15 03:47:17,343 -   train_loss = 1.8022
2024-01-15 03:47:17,343 -   best_eval_score = 0.2252
2024-01-15 03:47:17,343 -   eval_score = 0.2949
2024-01-15 03:47:34,119 - ***** Epoch: 12: Eval results *****
2024-01-15 03:47:34,119 -   train_loss = 1.5188
2024-01-15 03:47:34,119 -   best_eval_score = 0.2949
2024-01-15 03:47:34,119 -   eval_score = 0.3721
2024-01-15 03:47:51,426 - ***** Epoch: 13: Eval results *****
2024-01-15 03:47:51,426 -   train_loss = 1.3344
2024-01-15 03:47:51,426 -   best_eval_score = 0.3721
2024-01-15 03:47:51,426 -   eval_score = 0.3835
2024-01-15 03:48:08,650 - ***** Epoch: 14: Eval results *****
2024-01-15 03:48:08,651 -   train_loss = 1.1575
2024-01-15 03:48:08,651 -   best_eval_score = 0.3835
2024-01-15 03:48:08,651 -   eval_score = 0.4335
2024-01-15 03:48:26,437 - ***** Epoch: 15: Eval results *****
2024-01-15 03:48:26,437 -   train_loss = 0.999
2024-01-15 03:48:26,437 -   best_eval_score = 0.4335
2024-01-15 03:48:26,437 -   eval_score = 0.4541
2024-01-15 03:48:43,341 - ***** Epoch: 16: Eval results *****
2024-01-15 03:48:43,341 -   train_loss = 0.8577
2024-01-15 03:48:43,341 -   best_eval_score = 0.4541
2024-01-15 03:48:43,341 -   eval_score = 0.4624
2024-01-15 03:49:02,019 - ***** Epoch: 17: Eval results *****
2024-01-15 03:49:02,020 -   train_loss = 0.7482
2024-01-15 03:49:02,020 -   best_eval_score = 0.4624
2024-01-15 03:49:02,020 -   eval_score = 0.4729
2024-01-15 03:49:19,125 - ***** Epoch: 18: Eval results *****
2024-01-15 03:49:19,125 -   train_loss = 0.6322
2024-01-15 03:49:19,125 -   best_eval_score = 0.4729
2024-01-15 03:49:19,125 -   eval_score = 0.5296
2024-01-15 03:49:35,812 - ***** Epoch: 19: Eval results *****
2024-01-15 03:49:35,812 -   train_loss = 0.5384
2024-01-15 03:49:35,812 -   best_eval_score = 0.5296
2024-01-15 03:49:35,812 -   eval_score = 0.5574
2024-01-15 03:49:53,599 - ***** Epoch: 20: Eval results *****
2024-01-15 03:49:53,600 -   train_loss = 0.4601
2024-01-15 03:49:53,600 -   best_eval_score = 0.5574
2024-01-15 03:49:53,600 -   eval_score = 0.5694
2024-01-15 03:50:10,839 - ***** Epoch: 21: Eval results *****
2024-01-15 03:50:10,839 -   train_loss = 0.3807
2024-01-15 03:50:10,839 -   best_eval_score = 0.5694
2024-01-15 03:50:10,839 -   eval_score = 0.5774
2024-01-15 03:50:28,387 - ***** Epoch: 22: Eval results *****
2024-01-15 03:50:28,387 -   train_loss = 0.332
2024-01-15 03:50:28,387 -   best_eval_score = 0.5774
2024-01-15 03:50:28,387 -   eval_score = 0.5756
2024-01-15 03:50:28,387 - EarlyStopping counter: 1 out of 8
2024-01-15 03:50:46,420 - ***** Epoch: 23: Eval results *****
2024-01-15 03:50:46,422 -   train_loss = 0.2759
2024-01-15 03:50:46,423 -   best_eval_score = 0.5774
2024-01-15 03:50:46,423 -   eval_score = 0.5865
2024-01-15 03:51:04,359 - ***** Epoch: 24: Eval results *****
2024-01-15 03:51:04,360 -   train_loss = 0.2308
2024-01-15 03:51:04,360 -   best_eval_score = 0.5865
2024-01-15 03:51:04,360 -   eval_score = 0.5914
2024-01-15 03:51:20,817 - ***** Epoch: 25: Eval results *****
2024-01-15 03:51:20,817 -   train_loss = 0.2016
2024-01-15 03:51:20,817 -   best_eval_score = 0.5914
2024-01-15 03:51:20,817 -   eval_score = 0.5855
2024-01-15 03:51:20,817 - EarlyStopping counter: 1 out of 8
2024-01-15 03:51:38,298 - ***** Epoch: 26: Eval results *****
2024-01-15 03:51:38,298 -   train_loss = 0.182
2024-01-15 03:51:38,298 -   best_eval_score = 0.5914
2024-01-15 03:51:38,298 -   eval_score = 0.5741
2024-01-15 03:51:38,299 - EarlyStopping counter: 2 out of 8
2024-01-15 03:51:54,822 - ***** Epoch: 27: Eval results *****
2024-01-15 03:51:54,823 -   train_loss = 0.1536
2024-01-15 03:51:54,823 -   best_eval_score = 0.5914
2024-01-15 03:51:54,823 -   eval_score = 0.5851
2024-01-15 03:51:54,823 - EarlyStopping counter: 3 out of 8
2024-01-15 03:52:12,072 - ***** Epoch: 28: Eval results *****
2024-01-15 03:52:12,072 -   train_loss = 0.1335
2024-01-15 03:52:12,072 -   best_eval_score = 0.5914
2024-01-15 03:52:12,072 -   eval_score = 0.5989
2024-01-15 03:52:28,793 - ***** Epoch: 29: Eval results *****
2024-01-15 03:52:28,793 -   train_loss = 0.1166
2024-01-15 03:52:28,793 -   best_eval_score = 0.5989
2024-01-15 03:52:28,793 -   eval_score = 0.5974
2024-01-15 03:52:28,794 - EarlyStopping counter: 1 out of 8
2024-01-15 03:52:45,766 - ***** Epoch: 30: Eval results *****
2024-01-15 03:52:45,766 -   train_loss = 0.0984
2024-01-15 03:52:45,766 -   best_eval_score = 0.5989
2024-01-15 03:52:45,766 -   eval_score = 0.6058
2024-01-15 03:53:02,545 - ***** Epoch: 31: Eval results *****
2024-01-15 03:53:02,545 -   train_loss = 0.0831
2024-01-15 03:53:02,545 -   best_eval_score = 0.6058
2024-01-15 03:53:02,545 -   eval_score = 0.6121
2024-01-15 03:53:19,814 - ***** Epoch: 32: Eval results *****
2024-01-15 03:53:19,814 -   train_loss = 0.071
2024-01-15 03:53:19,815 -   best_eval_score = 0.6121
2024-01-15 03:53:19,815 -   eval_score = 0.596
2024-01-15 03:53:19,815 - EarlyStopping counter: 1 out of 8
2024-01-15 03:53:36,273 - ***** Epoch: 33: Eval results *****
2024-01-15 03:53:36,273 -   train_loss = 0.0699
2024-01-15 03:53:36,274 -   best_eval_score = 0.6121
2024-01-15 03:53:36,274 -   eval_score = 0.5962
2024-01-15 03:53:36,274 - EarlyStopping counter: 2 out of 8
2024-01-15 03:53:53,521 - ***** Epoch: 34: Eval results *****
2024-01-15 03:53:53,522 -   train_loss = 0.0636
2024-01-15 03:53:53,522 -   best_eval_score = 0.6121
2024-01-15 03:53:53,522 -   eval_score = 0.5972
2024-01-15 03:53:53,522 - EarlyStopping counter: 3 out of 8
2024-01-15 03:54:09,941 - ***** Epoch: 35: Eval results *****
2024-01-15 03:54:09,941 -   train_loss = 0.0569
2024-01-15 03:54:09,941 -   best_eval_score = 0.6121
2024-01-15 03:54:09,941 -   eval_score = 0.5991
2024-01-15 03:54:09,941 - EarlyStopping counter: 4 out of 8
2024-01-15 03:54:26,793 - ***** Epoch: 36: Eval results *****
2024-01-15 03:54:26,793 -   train_loss = 0.0488
2024-01-15 03:54:26,793 -   best_eval_score = 0.6121
2024-01-15 03:54:26,793 -   eval_score = 0.5983
2024-01-15 03:54:26,793 - EarlyStopping counter: 5 out of 8
2024-01-15 03:54:43,040 - ***** Epoch: 37: Eval results *****
2024-01-15 03:54:43,041 -   train_loss = 0.0429
2024-01-15 03:54:43,041 -   best_eval_score = 0.6121
2024-01-15 03:54:43,041 -   eval_score = 0.5892
2024-01-15 03:54:43,041 - EarlyStopping counter: 6 out of 8
2024-01-15 03:55:00,574 - ***** Epoch: 38: Eval results *****
2024-01-15 03:55:00,574 -   train_loss = 0.0464
2024-01-15 03:55:00,574 -   best_eval_score = 0.6121
2024-01-15 03:55:00,575 -   eval_score = 0.602
2024-01-15 03:55:00,575 - EarlyStopping counter: 7 out of 8
2024-01-15 03:55:17,166 - ***** Epoch: 39: Eval results *****
2024-01-15 03:55:17,166 -   train_loss = 0.0358
2024-01-15 03:55:17,166 -   best_eval_score = 0.6121
2024-01-15 03:55:17,166 -   eval_score = 0.6099
2024-01-15 03:55:17,166 - EarlyStopping counter: 8 out of 8
2024-01-15 03:55:17,166 - EarlyStopping at epoch 39
2024-01-15 03:55:17,168 - Training is finished...
2024-01-15 03:55:17,169 - Testing begins...
2024-01-15 03:55:19,697 - ***** Test: Confusion Matrix *****
2024-01-15 03:55:19,698 - [[34  2  0  0  9  0  1  0  0  2  1  0  6  1  1  0  0  0  0  0]
 [ 0 36  0  1  0  1  0  0  0  0  1  1  2  0  1  0  0  0  0  0]
 [ 0  0 26  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  1  0  9  0  4  0  0  0  0  1  3  3  0  0  0  0  0  0]
 [ 0  0  0  0  0 10  0  1  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  5  0  1  0  0  0  0  0  1  0  1  3  0  0  0  0]
 [ 1  1  0  0  0  1  0  2  0  0  1  0  1  0  0  3  0  0  0  0]
 [ 0  0  0  0  1  0  1  4  2  0  0  0  0  0  1  1  0  0  0  0]
 [ 2  0  1  0  0  0  1  0  0  2  0  0  1  0  0  1  1  1  0  0]
 [ 1  0  1  0  0  0  0  0  0  1 11  0  1  0  2  1  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 16  0  0  0  0  0  0  1  1]
 [ 3  4  0  0  0  0  0  0  0  0  1  0 39  2  7  1  0  0  0  0]
 [ 0  0  0  0  2  0  0  0  0  0  0  1  0 15  5  0  1  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  5 14  0  1  0  0  0]
 [ 0  4  0  0  0  0  0  0  0  0  0  0  2  0  2 12  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  4  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  3  0  0  0  2  0  0  9  0  0]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  2  0  0  0  0  0  7  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  1  1  0  1  0  0  5]]
2024-01-15 03:55:19,698 - ***** Evaluation results *****
2024-01-15 03:55:19,698 -   acc = 0.6404
2024-01-15 03:55:19,699 -   f1 = 0.5854
2024-01-15 03:55:19,699 -   prec = 0.6352
2024-01-15 03:55:19,699 -   rec = 0.577
2024-01-15 03:55:19,699 - Testing is finished...
2024-01-15 03:55:19,699 - Multimodal intent recognition is finished...
2024-01-15 03:55:19,699 - Results are saved in results/msz.csv
