2024-01-07 10:25:54,167 - ============================== Params ==============================
2024-01-07 10:25:54,168 - logger_name: msz_MIntRec_multi-class_seed-2_2024-01-07-10-25-54
2024-01-07 10:25:54,168 - dataset: MIntRec
2024-01-07 10:25:54,168 - data_mode: multi-class
2024-01-07 10:25:54,168 - method: msz
2024-01-07 10:25:54,168 - text_backbone: bert-base-uncased
2024-01-07 10:25:54,168 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-07 10:25:54,168 - seed: 2
2024-01-07 10:25:54,168 - num_workers: 8
2024-01-07 10:25:54,168 - gpu_id: 1
2024-01-07 10:25:54,168 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-07 10:25:54,168 - train: True
2024-01-07 10:25:54,168 - tune: False
2024-01-07 10:25:54,168 - save_model: False
2024-01-07 10:25:54,168 - save_results: True
2024-01-07 10:25:54,168 - log_path: logs
2024-01-07 10:25:54,168 - cache_path: 
2024-01-07 10:25:54,169 - video_data_path: video_data
2024-01-07 10:25:54,169 - audio_data_path: audio_data
2024-01-07 10:25:54,169 - video_feats_path: video_feats.pkl
2024-01-07 10:25:54,169 - audio_feats_path: audio_feats.pkl
2024-01-07 10:25:54,169 - results_path: results
2024-01-07 10:25:54,169 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-07 10:25:54,169 - model_path: models
2024-01-07 10:25:54,169 - config_file_name: msz
2024-01-07 10:25:54,169 - results_file_name: msz.csv
2024-01-07 10:25:54,169 - padding_mode: zero
2024-01-07 10:25:54,169 - padding_loc: end
2024-01-07 10:25:54,169 - need_aligned: False
2024-01-07 10:25:54,169 - eval_monitor: f1
2024-01-07 10:25:54,169 - train_batch_size: 16
2024-01-07 10:25:54,169 - eval_batch_size: 8
2024-01-07 10:25:54,169 - test_batch_size: 8
2024-01-07 10:25:54,169 - wait_patience: 8
2024-01-07 10:25:54,169 - nheads: 2
2024-01-07 10:25:54,169 - encoder_layers: 2
2024-01-07 10:25:54,169 - attn_dropout: 0.1
2024-01-07 10:25:54,169 - relu_dropout: 0.1
2024-01-07 10:25:54,169 - embed_dropout: 0.1
2024-01-07 10:25:54,169 - res_dropout: 0.1
2024-01-07 10:25:54,169 - attn_mask: False
2024-01-07 10:25:54,169 - hidden_size: 768
2024-01-07 10:25:54,169 - num_attention_heads: 12
2024-01-07 10:25:54,169 - attention_probs_dropout_prob: 0.2
2024-01-07 10:25:54,169 - hidden_dropout_prob: 0.2
2024-01-07 10:25:54,169 - intermediate_size: 768
2024-01-07 10:25:54,169 - num_hidden_layers: 3
2024-01-07 10:25:54,169 - max_position_embeddings: 512
2024-01-07 10:25:54,169 - position_embedding_type: absolute
2024-01-07 10:25:54,169 - batch_first: True
2024-01-07 10:25:54,169 - hidden_dims: 768
2024-01-07 10:25:54,169 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-07 10:25:54,169 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-07 10:25:54,169 - ta_loss: 0.1
2024-01-07 10:25:54,170 - tv_loss: 0.1
2024-01-07 10:25:54,170 - av_loss: 0.1
2024-01-07 10:25:54,170 - aligned_method: ctc
2024-01-07 10:25:54,170 - grad_clip: -1
2024-01-07 10:25:54,170 - num_train_epochs: 100
2024-01-07 10:25:54,170 - warmup_proportion: 0.1
2024-01-07 10:25:54,170 - lr: 1e-06
2024-01-07 10:25:54,170 - weight_decay: 0.01
2024-01-07 10:25:54,170 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-01-07-10-25-54
2024-01-07 10:25:54,170 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-01-07-10-25-54/models
2024-01-07 10:25:54,170 - ============================== End Params ==============================
2024-01-07 10:25:54,173 - Generate Text Features Begin...
2024-01-07 10:25:54,678 - Generate Text Features Finished...
2024-01-07 10:25:54,679 - Load Video Features Begin...
2024-01-07 10:25:55,016 - Load Video Features Finished...
2024-01-07 10:25:55,650 - Load Audio Features Begin...
2024-01-07 10:25:56,697 - Load Audio Features Finished...
2024-01-07 10:26:00,453 - method  begins...
2024-01-07 10:26:04,551 - Multimodal intent recognition begins...
2024-01-07 10:26:04,551 - Training begins...
2024-01-07 10:26:18,396 - ***** Epoch: 1: Eval results *****
2024-01-07 10:26:18,396 -   train_loss = 2.9867
2024-01-07 10:26:18,396 -   best_eval_score = 0.0
2024-01-07 10:26:18,396 -   eval_score = 0.0265
2024-01-07 10:26:31,556 - ***** Epoch: 2: Eval results *****
2024-01-07 10:26:31,557 -   train_loss = 2.94
2024-01-07 10:26:31,557 -   best_eval_score = 0.0265
2024-01-07 10:26:31,557 -   eval_score = 0.0287
2024-01-07 10:26:45,957 - ***** Epoch: 3: Eval results *****
2024-01-07 10:26:45,957 -   train_loss = 2.8652
2024-01-07 10:26:45,958 -   best_eval_score = 0.0287
2024-01-07 10:26:45,958 -   eval_score = 0.0311
2024-01-07 10:26:59,138 - ***** Epoch: 4: Eval results *****
2024-01-07 10:26:59,138 -   train_loss = 2.7687
2024-01-07 10:26:59,138 -   best_eval_score = 0.0311
2024-01-07 10:26:59,138 -   eval_score = 0.0374
2024-01-07 10:27:12,648 - ***** Epoch: 5: Eval results *****
2024-01-07 10:27:12,648 -   train_loss = 2.6325
2024-01-07 10:27:12,648 -   best_eval_score = 0.0374
2024-01-07 10:27:12,648 -   eval_score = 0.1037
2024-01-07 10:27:25,799 - ***** Epoch: 6: Eval results *****
2024-01-07 10:27:25,799 -   train_loss = 2.4342
2024-01-07 10:27:25,799 -   best_eval_score = 0.1037
2024-01-07 10:27:25,799 -   eval_score = 0.1826
2024-01-07 10:27:38,929 - ***** Epoch: 7: Eval results *****
2024-01-07 10:27:38,929 -   train_loss = 2.1458
2024-01-07 10:27:38,929 -   best_eval_score = 0.1826
2024-01-07 10:27:38,929 -   eval_score = 0.2631
2024-01-07 10:27:52,308 - ***** Epoch: 8: Eval results *****
2024-01-07 10:27:52,308 -   train_loss = 1.7855
2024-01-07 10:27:52,308 -   best_eval_score = 0.2631
2024-01-07 10:27:52,308 -   eval_score = 0.3506
2024-01-07 10:28:06,134 - ***** Epoch: 9: Eval results *****
2024-01-07 10:28:06,135 -   train_loss = 1.428
2024-01-07 10:28:06,135 -   best_eval_score = 0.3506
2024-01-07 10:28:06,135 -   eval_score = 0.4874
2024-01-07 10:28:19,605 - ***** Epoch: 10: Eval results *****
2024-01-07 10:28:19,606 -   train_loss = 1.1661
2024-01-07 10:28:19,606 -   best_eval_score = 0.4874
2024-01-07 10:28:19,606 -   eval_score = 0.484
2024-01-07 10:28:19,606 - EarlyStopping counter: 1 out of 8
2024-01-07 10:28:32,299 - ***** Epoch: 11: Eval results *****
2024-01-07 10:28:32,300 -   train_loss = 0.8685
2024-01-07 10:28:32,300 -   best_eval_score = 0.4874
2024-01-07 10:28:32,300 -   eval_score = 0.5369
2024-01-07 10:28:46,624 - ***** Epoch: 12: Eval results *****
2024-01-07 10:28:46,624 -   train_loss = 0.6295
2024-01-07 10:28:46,624 -   best_eval_score = 0.5369
2024-01-07 10:28:46,624 -   eval_score = 0.602
2024-01-07 10:28:59,970 - ***** Epoch: 13: Eval results *****
2024-01-07 10:28:59,970 -   train_loss = 0.4549
2024-01-07 10:28:59,970 -   best_eval_score = 0.602
2024-01-07 10:28:59,970 -   eval_score = 0.6358
2024-01-07 10:29:13,292 - ***** Epoch: 14: Eval results *****
2024-01-07 10:29:13,292 -   train_loss = 0.3052
2024-01-07 10:29:13,293 -   best_eval_score = 0.6358
2024-01-07 10:29:13,293 -   eval_score = 0.6283
2024-01-07 10:29:13,293 - EarlyStopping counter: 1 out of 8
2024-01-07 10:29:26,758 - ***** Epoch: 15: Eval results *****
2024-01-07 10:29:26,758 -   train_loss = 0.2094
2024-01-07 10:29:26,758 -   best_eval_score = 0.6358
2024-01-07 10:29:26,758 -   eval_score = 0.6238
2024-01-07 10:29:26,758 - EarlyStopping counter: 2 out of 8
2024-01-07 10:29:39,919 - ***** Epoch: 16: Eval results *****
2024-01-07 10:29:39,919 -   train_loss = 0.1702
2024-01-07 10:29:39,920 -   best_eval_score = 0.6358
2024-01-07 10:29:39,920 -   eval_score = 0.6249
2024-01-07 10:29:39,920 - EarlyStopping counter: 3 out of 8
2024-01-07 10:29:53,102 - ***** Epoch: 17: Eval results *****
2024-01-07 10:29:53,102 -   train_loss = 0.1112
2024-01-07 10:29:53,102 -   best_eval_score = 0.6358
2024-01-07 10:29:53,102 -   eval_score = 0.6281
2024-01-07 10:29:53,102 - EarlyStopping counter: 4 out of 8
2024-01-07 10:30:06,462 - ***** Epoch: 18: Eval results *****
2024-01-07 10:30:06,462 -   train_loss = 0.0679
2024-01-07 10:30:06,462 -   best_eval_score = 0.6358
2024-01-07 10:30:06,462 -   eval_score = 0.624
2024-01-07 10:30:06,462 - EarlyStopping counter: 5 out of 8
2024-01-07 10:30:20,268 - ***** Epoch: 19: Eval results *****
2024-01-07 10:30:20,268 -   train_loss = 0.0666
2024-01-07 10:30:20,268 -   best_eval_score = 0.6358
2024-01-07 10:30:20,268 -   eval_score = 0.6347
2024-01-07 10:30:20,268 - EarlyStopping counter: 6 out of 8
2024-01-07 10:30:34,385 - ***** Epoch: 20: Eval results *****
2024-01-07 10:30:34,385 -   train_loss = 0.0446
2024-01-07 10:30:34,385 -   best_eval_score = 0.6358
2024-01-07 10:30:34,385 -   eval_score = 0.6306
2024-01-07 10:30:34,385 - EarlyStopping counter: 7 out of 8
2024-01-07 10:30:47,594 - ***** Epoch: 21: Eval results *****
2024-01-07 10:30:47,594 -   train_loss = 0.0276
2024-01-07 10:30:47,594 -   best_eval_score = 0.6358
2024-01-07 10:30:47,594 -   eval_score = 0.632
2024-01-07 10:30:47,594 - EarlyStopping counter: 8 out of 8
2024-01-07 10:30:47,594 - EarlyStopping at epoch 21
2024-01-07 10:30:47,596 - Training is finished...
2024-01-07 10:30:47,596 - Testing begins...
2024-01-07 10:30:50,319 - ***** Test: Confusion Matrix *****
2024-01-07 10:30:50,320 - [[27  0  0  0  6  0  0  2  0  4  1  1 13  1  0  1  0  0  1  0]
 [ 0 34  0  1  0  2  0  1  0  0  1  0  2  1  0  0  0  0  1  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0 10  0  0  1  0  1  1  1  3  3  1  0  0  1  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  3  0  0  1  0  0  4  0  0  1  1  0  0  0]
 [ 1  0  0  0  0  1  0  6  0  0  1  0  0  0  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  1  0  0  0  0  2  0  1  1  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  3  2  0  1  0  0  2  0  1  0  0]
 [ 0  0  0  0  0  1  0  0  0  0 16  0  1  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0  1]
 [ 1  0  0  0  0  1  0  1  0  0  1  2 36  3  6  0  4  0  1  1]
 [ 0  0  0  0  0  0  1  0  0  0  1  1  0 20  1  0  1  0  0  0]
 [ 0  0  1  0  0  0  0  0  0  0  0  0  1  5 13  0  2  0  0  0]
 [ 0  0  0  1  0  0  0  0  0  0  0  0  9  1  0 10  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0 16  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  6  0  2  0  0  0  0  7  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  1  2  0  3  0  0  3]]
2024-01-07 10:30:50,321 - ***** Evaluation results *****
2024-01-07 10:30:50,321 -   acc = 0.6629
2024-01-07 10:30:50,321 -   f1 = 0.6156
2024-01-07 10:30:50,321 -   prec = 0.6808
2024-01-07 10:30:50,321 -   rec = 0.6352
2024-01-07 10:30:50,321 - Testing is finished...
2024-01-07 10:30:50,321 - Multimodal intent recognition is finished...
2024-01-07 10:30:50,321 - Results are saved in results/msz.csv
