2024-03-17 03:18:52,363 - ============================== Params ==============================
2024-03-17 03:18:52,364 - logger_name: mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-03-18-52
2024-03-17 03:18:52,364 - dataset: MIntRec2
2024-03-17 03:18:52,364 - data_mode: multi-class
2024-03-17 03:18:52,364 - method: mag_bert
2024-03-17 03:18:52,364 - text_backbone: bert-base-uncased
2024-03-17 03:18:52,364 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-17 03:18:52,364 - seed: 4
2024-03-17 03:18:52,364 - num_workers: 8
2024-03-17 03:18:52,364 - gpu_id: 2
2024-03-17 03:18:52,364 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-17 03:18:52,364 - train: True
2024-03-17 03:18:52,364 - tune: True
2024-03-17 03:18:52,364 - save_model: False
2024-03-17 03:18:52,364 - save_results: True
2024-03-17 03:18:52,365 - log_path: logs
2024-03-17 03:18:52,365 - cache_path: 
2024-03-17 03:18:52,365 - video_data_path: video_data
2024-03-17 03:18:52,365 - audio_data_path: audio_data
2024-03-17 03:18:52,365 - video_feats_path: video_feats.pkl
2024-03-17 03:18:52,365 - audio_feats_path: audio_feats.pkl
2024-03-17 03:18:52,365 - results_path: results
2024-03-17 03:18:52,365 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-17 03:18:52,365 - model_path: models
2024-03-17 03:18:52,365 - config_file_name: mag_bert_MIntRec2
2024-03-17 03:18:52,365 - results_file_name: mag_bert.csv
2024-03-17 03:18:52,365 - padding_mode: zero
2024-03-17 03:18:52,365 - padding_loc: end
2024-03-17 03:18:52,365 - need_aligned: True
2024-03-17 03:18:52,365 - eval_monitor: f1
2024-03-17 03:18:52,366 - train_batch_size: 32
2024-03-17 03:18:52,366 - eval_batch_size: 16
2024-03-17 03:18:52,366 - test_batch_size: 16
2024-03-17 03:18:52,366 - wait_patience: 8
2024-03-17 03:18:52,366 - num_train_epochs: 100
2024-03-17 03:18:52,366 - beta_shift: 0.01
2024-03-17 03:18:52,366 - dropout_prob: 0.3
2024-03-17 03:18:52,366 - warmup_proportion: 0.1
2024-03-17 03:18:52,366 - lr: 9e-06
2024-03-17 03:18:52,366 - aligned_method: conv1d
2024-03-17 03:18:52,366 - weight_decay: 0.01
2024-03-17 03:18:52,366 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-03-18-52
2024-03-17 03:18:52,366 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-03-18-52/models
2024-03-17 03:18:52,366 - num_labels: 30
2024-03-17 03:18:52,366 - text_feat_dim: 768
2024-03-17 03:18:52,367 - video_feat_dim: 256
2024-03-17 03:18:52,367 - audio_feat_dim: 768
2024-03-17 03:18:52,367 - text_seq_len: 50
2024-03-17 03:18:52,367 - video_seq_len: 180
2024-03-17 03:18:52,367 - audio_seq_len: 400
2024-03-17 03:18:52,367 - device: cuda:2
2024-03-17 03:18:52,367 - ============================== End Params ==============================
2024-03-17 03:18:52,407 - Generate Text Features Begin...
2024-03-17 03:18:55,679 - Generate Text Features Finished...
2024-03-17 03:18:55,680 - Load Video Features Begin...
2024-03-17 03:18:56,700 - Load Video Features Finished...
2024-03-17 03:18:58,314 - Load Audio Features Begin...
2024-03-17 03:19:02,243 - Load Audio Features Finished...
2024-03-17 03:19:12,085 - method  begins...
2024-03-17 03:19:12,949 - Multimodal intent recognition begins...
2024-03-17 03:19:12,949 - Training begins...
2024-03-17 03:19:48,826 - ***** Epoch: 1: Eval results *****
2024-03-17 03:19:48,826 -   train_loss = 3.4019
2024-03-17 03:19:48,826 -   best_eval_score = 0.0
2024-03-17 03:19:48,826 -   eval_score = 0.0345
2024-03-17 03:20:28,481 - ***** Epoch: 2: Eval results *****
2024-03-17 03:20:28,482 -   train_loss = 3.1751
2024-03-17 03:20:28,482 -   best_eval_score = 0.0345
2024-03-17 03:20:28,482 -   eval_score = 0.1106
2024-03-17 03:21:03,115 - ***** Epoch: 3: Eval results *****
2024-03-17 03:21:03,116 -   train_loss = 2.8076
2024-03-17 03:21:03,117 -   best_eval_score = 0.1106
2024-03-17 03:21:03,117 -   eval_score = 0.1711
2024-03-17 03:21:43,381 - ***** Epoch: 4: Eval results *****
2024-03-17 03:21:43,381 -   train_loss = 2.4303
2024-03-17 03:21:43,381 -   best_eval_score = 0.1711
2024-03-17 03:21:43,381 -   eval_score = 0.2663
2024-03-17 03:22:17,970 - ***** Epoch: 5: Eval results *****
2024-03-17 03:22:17,970 -   train_loss = 2.1118
2024-03-17 03:22:17,970 -   best_eval_score = 0.2663
2024-03-17 03:22:17,970 -   eval_score = 0.3155
2024-03-17 03:22:54,797 - ***** Epoch: 6: Eval results *****
2024-03-17 03:22:54,797 -   train_loss = 1.8662
2024-03-17 03:22:54,797 -   best_eval_score = 0.3155
2024-03-17 03:22:54,797 -   eval_score = 0.3542
2024-03-17 03:23:33,807 - ***** Epoch: 7: Eval results *****
2024-03-17 03:23:33,808 -   train_loss = 1.668
2024-03-17 03:23:33,808 -   best_eval_score = 0.3542
2024-03-17 03:23:33,808 -   eval_score = 0.3762
2024-03-17 03:24:08,015 - ***** Epoch: 8: Eval results *****
2024-03-17 03:24:08,016 -   train_loss = 1.4996
2024-03-17 03:24:08,016 -   best_eval_score = 0.3762
2024-03-17 03:24:08,016 -   eval_score = 0.411
2024-03-17 03:24:46,023 - ***** Epoch: 9: Eval results *****
2024-03-17 03:24:46,023 -   train_loss = 1.3491
2024-03-17 03:24:46,023 -   best_eval_score = 0.411
2024-03-17 03:24:46,023 -   eval_score = 0.4156
2024-03-17 03:25:20,650 - ***** Epoch: 10: Eval results *****
2024-03-17 03:25:20,651 -   train_loss = 1.2141
2024-03-17 03:25:20,651 -   best_eval_score = 0.4156
2024-03-17 03:25:20,651 -   eval_score = 0.4286
2024-03-17 03:25:57,806 - ***** Epoch: 11: Eval results *****
2024-03-17 03:25:57,806 -   train_loss = 1.0801
2024-03-17 03:25:57,806 -   best_eval_score = 0.4286
2024-03-17 03:25:57,806 -   eval_score = 0.4445
2024-03-17 03:26:29,381 - ***** Epoch: 12: Eval results *****
2024-03-17 03:26:29,381 -   train_loss = 0.9443
2024-03-17 03:26:29,381 -   best_eval_score = 0.4445
2024-03-17 03:26:29,381 -   eval_score = 0.4769
2024-03-17 03:27:09,104 - ***** Epoch: 13: Eval results *****
2024-03-17 03:27:09,108 -   train_loss = 0.828
2024-03-17 03:27:09,108 -   best_eval_score = 0.4769
2024-03-17 03:27:09,109 -   eval_score = 0.4826
2024-03-17 03:27:44,971 - ***** Epoch: 14: Eval results *****
2024-03-17 03:27:44,971 -   train_loss = 0.7226
2024-03-17 03:27:44,971 -   best_eval_score = 0.4826
2024-03-17 03:27:44,971 -   eval_score = 0.4829
2024-03-17 03:28:23,142 - ***** Epoch: 15: Eval results *****
2024-03-17 03:28:23,143 -   train_loss = 0.6222
2024-03-17 03:28:23,143 -   best_eval_score = 0.4829
2024-03-17 03:28:23,143 -   eval_score = 0.4904
2024-03-17 03:28:56,549 - ***** Epoch: 16: Eval results *****
2024-03-17 03:28:56,550 -   train_loss = 0.5478
2024-03-17 03:28:56,550 -   best_eval_score = 0.4904
2024-03-17 03:28:56,550 -   eval_score = 0.4923
2024-03-17 03:29:34,904 - ***** Epoch: 17: Eval results *****
2024-03-17 03:29:34,904 -   train_loss = 0.4868
2024-03-17 03:29:34,904 -   best_eval_score = 0.4923
2024-03-17 03:29:34,904 -   eval_score = 0.4907
2024-03-17 03:29:34,904 - EarlyStopping counter: 1 out of 8
2024-03-17 03:30:13,714 - ***** Epoch: 18: Eval results *****
2024-03-17 03:30:13,715 -   train_loss = 0.419
2024-03-17 03:30:13,715 -   best_eval_score = 0.4923
2024-03-17 03:30:13,715 -   eval_score = 0.4926
2024-03-17 03:30:50,858 - ***** Epoch: 19: Eval results *****
2024-03-17 03:30:50,858 -   train_loss = 0.3688
2024-03-17 03:30:50,858 -   best_eval_score = 0.4926
2024-03-17 03:30:50,858 -   eval_score = 0.483
2024-03-17 03:30:50,859 - EarlyStopping counter: 1 out of 8
2024-03-17 03:31:24,068 - ***** Epoch: 20: Eval results *****
2024-03-17 03:31:24,069 -   train_loss = 0.3295
2024-03-17 03:31:24,069 -   best_eval_score = 0.4926
2024-03-17 03:31:24,069 -   eval_score = 0.4837
2024-03-17 03:31:24,070 - EarlyStopping counter: 2 out of 8
2024-03-17 03:32:02,196 - ***** Epoch: 21: Eval results *****
2024-03-17 03:32:02,196 -   train_loss = 0.2838
2024-03-17 03:32:02,197 -   best_eval_score = 0.4926
2024-03-17 03:32:02,197 -   eval_score = 0.4863
2024-03-17 03:32:02,197 - EarlyStopping counter: 3 out of 8
2024-03-17 03:32:37,726 - ***** Epoch: 22: Eval results *****
2024-03-17 03:32:37,726 -   train_loss = 0.2569
2024-03-17 03:32:37,726 -   best_eval_score = 0.4926
2024-03-17 03:32:37,726 -   eval_score = 0.4864
2024-03-17 03:32:37,726 - EarlyStopping counter: 4 out of 8
2024-03-17 03:33:15,542 - ***** Epoch: 23: Eval results *****
2024-03-17 03:33:15,543 -   train_loss = 0.2301
2024-03-17 03:33:15,543 -   best_eval_score = 0.4926
2024-03-17 03:33:15,543 -   eval_score = 0.4918
2024-03-17 03:33:15,543 - EarlyStopping counter: 5 out of 8
2024-03-17 03:33:50,269 - ***** Epoch: 24: Eval results *****
2024-03-17 03:33:50,270 -   train_loss = 0.2063
2024-03-17 03:33:50,270 -   best_eval_score = 0.4926
2024-03-17 03:33:50,270 -   eval_score = 0.5052
2024-03-17 03:34:27,004 - ***** Epoch: 25: Eval results *****
2024-03-17 03:34:27,004 -   train_loss = 0.1825
2024-03-17 03:34:27,005 -   best_eval_score = 0.5052
2024-03-17 03:34:27,005 -   eval_score = 0.4987
2024-03-17 03:34:27,005 - EarlyStopping counter: 1 out of 8
2024-03-17 03:35:02,039 - ***** Epoch: 26: Eval results *****
2024-03-17 03:35:02,040 -   train_loss = 0.1645
2024-03-17 03:35:02,040 -   best_eval_score = 0.5052
2024-03-17 03:35:02,040 -   eval_score = 0.4959
2024-03-17 03:35:02,040 - EarlyStopping counter: 2 out of 8
2024-03-17 03:35:40,432 - ***** Epoch: 27: Eval results *****
2024-03-17 03:35:40,432 -   train_loss = 0.153
2024-03-17 03:35:40,432 -   best_eval_score = 0.5052
2024-03-17 03:35:40,432 -   eval_score = 0.4887
2024-03-17 03:35:40,432 - EarlyStopping counter: 3 out of 8
2024-03-17 03:36:18,026 - ***** Epoch: 28: Eval results *****
2024-03-17 03:36:18,027 -   train_loss = 0.1407
2024-03-17 03:36:18,027 -   best_eval_score = 0.5052
2024-03-17 03:36:18,027 -   eval_score = 0.5014
2024-03-17 03:36:18,027 - EarlyStopping counter: 4 out of 8
2024-03-17 03:36:53,533 - ***** Epoch: 29: Eval results *****
2024-03-17 03:36:53,533 -   train_loss = 0.1246
2024-03-17 03:36:53,533 -   best_eval_score = 0.5052
2024-03-17 03:36:53,533 -   eval_score = 0.503
2024-03-17 03:36:53,533 - EarlyStopping counter: 5 out of 8
2024-03-17 03:37:29,577 - ***** Epoch: 30: Eval results *****
2024-03-17 03:37:29,578 -   train_loss = 0.1165
2024-03-17 03:37:29,578 -   best_eval_score = 0.5052
2024-03-17 03:37:29,578 -   eval_score = 0.4811
2024-03-17 03:37:29,578 - EarlyStopping counter: 6 out of 8
2024-03-17 03:38:04,772 - ***** Epoch: 31: Eval results *****
2024-03-17 03:38:04,772 -   train_loss = 0.1106
2024-03-17 03:38:04,772 -   best_eval_score = 0.5052
2024-03-17 03:38:04,772 -   eval_score = 0.5011
2024-03-17 03:38:04,773 - EarlyStopping counter: 7 out of 8
2024-03-17 03:38:40,966 - ***** Epoch: 32: Eval results *****
2024-03-17 03:38:40,967 -   train_loss = 0.1002
2024-03-17 03:38:40,967 -   best_eval_score = 0.5052
2024-03-17 03:38:40,968 -   eval_score = 0.5109
2024-03-17 03:39:19,139 - ***** Epoch: 33: Eval results *****
2024-03-17 03:39:19,140 -   train_loss = 0.0985
2024-03-17 03:39:19,140 -   best_eval_score = 0.5109
2024-03-17 03:39:19,140 -   eval_score = 0.5037
2024-03-17 03:39:19,140 - EarlyStopping counter: 1 out of 8
2024-03-17 03:39:57,757 - ***** Epoch: 34: Eval results *****
2024-03-17 03:39:57,757 -   train_loss = 0.0902
2024-03-17 03:39:57,757 -   best_eval_score = 0.5109
2024-03-17 03:39:57,757 -   eval_score = 0.4897
2024-03-17 03:39:57,757 - EarlyStopping counter: 2 out of 8
2024-03-17 03:40:31,990 - ***** Epoch: 35: Eval results *****
2024-03-17 03:40:31,991 -   train_loss = 0.0952
2024-03-17 03:40:31,991 -   best_eval_score = 0.5109
2024-03-17 03:40:31,991 -   eval_score = 0.4905
2024-03-17 03:40:31,991 - EarlyStopping counter: 3 out of 8
2024-03-17 03:41:09,843 - ***** Epoch: 36: Eval results *****
2024-03-17 03:41:09,844 -   train_loss = 0.0775
2024-03-17 03:41:09,844 -   best_eval_score = 0.5109
2024-03-17 03:41:09,844 -   eval_score = 0.5047
2024-03-17 03:41:09,844 - EarlyStopping counter: 4 out of 8
2024-03-17 03:41:43,759 - ***** Epoch: 37: Eval results *****
2024-03-17 03:41:43,760 -   train_loss = 0.0726
2024-03-17 03:41:43,760 -   best_eval_score = 0.5109
2024-03-17 03:41:43,761 -   eval_score = 0.4928
2024-03-17 03:41:43,761 - EarlyStopping counter: 5 out of 8
2024-03-17 03:42:21,246 - ***** Epoch: 38: Eval results *****
2024-03-17 03:42:21,247 -   train_loss = 0.0714
2024-03-17 03:42:21,247 -   best_eval_score = 0.5109
2024-03-17 03:42:21,247 -   eval_score = 0.4966
2024-03-17 03:42:21,247 - EarlyStopping counter: 6 out of 8
2024-03-17 03:42:56,076 - ***** Epoch: 39: Eval results *****
2024-03-17 03:42:56,076 -   train_loss = 0.0712
2024-03-17 03:42:56,076 -   best_eval_score = 0.5109
2024-03-17 03:42:56,076 -   eval_score = 0.5013
2024-03-17 03:42:56,076 - EarlyStopping counter: 7 out of 8
2024-03-17 03:43:33,403 - ***** Epoch: 40: Eval results *****
2024-03-17 03:43:33,403 -   train_loss = 0.0666
2024-03-17 03:43:33,403 -   best_eval_score = 0.5109
2024-03-17 03:43:33,403 -   eval_score = 0.5002
2024-03-17 03:43:33,403 - EarlyStopping counter: 8 out of 8
2024-03-17 03:43:33,403 - EarlyStopping at epoch 40
2024-03-17 03:43:33,405 - Training is finished...
2024-03-17 03:43:33,405 - Testing begins...
2024-03-17 03:43:39,895 - ***** Test: Confusion Matrix *****
2024-03-17 03:43:39,897 - [[ 47   0  15   0   0   0   0   0   1   1   2   0   0   0   0   0   0   0
    0   0   0   0   0   1   1   0   0   0   0   0]
 [  0  53   0   0  10   2   5   0   1   0   2   0   3   0   5   0   0  10
    1   0   0   0   1   0   1   0   0   3   0   0]
 [  8   1  42   0   1   0   0   0   0   0   1   0   0   0   0   1   0   4
    1   0   0   0   0   1   4   0   0   0   0   0]
 [  0   0   0  61   0   0   0   1   0   0   0   0   0   0   3   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   5   0   0  30   0   0   0   1   0   0   0   0   0   0   1   0   4
    0   1   0   1   0   2   1   2   0   0   1   2]
 [  0   1   0   0   1  23   0   1   0   1   2   0   0   0   1   0   0   4
    0   0   0   0   0   1   0   1   1   0   0   0]
 [  0   1   0   0   0   3  28   3   0   1   5   0   7   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   2   0   0   0   0   4  22   0   0   6   0   9   0   0   0   2   0
    0   0   0   0   0   0   0   0   0   2   0   0]
 [  1   3   1   3   1   0   0   0  21   0   0   2   1   1   1   0   0   5
    0   0   0   0   4   1   2   1   0   1   0   0]
 [  0   1   1   0   1   0   0   0   1  45   0   5   9   3  18   0   0   6
    3   0   0   3   3   2   2   1   0   3   0   0]
 [  2   0   0   0   0   3   4   0   0   1  47   0  29   0   2   0   0   2
    0   2   0   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   5   0  17   8   2   3   0   0   2
    0   0   1   0   2   0   0   0   0   5   0   2]
 [  0   1   3   0   0   1   3   4   0   3  25   2  88   0   0   0   3   0
    0   0   0   0   1   0   0   0   0   1   0   0]
 [  0   0   2   0   1   0   0   0   1   1   0   0   0   0   5   1   0   4
    1   0   1   0   0   0   0   0   0   0   0   0]
 [  0   2   1   0   0   1   2   0   2   7   2   0   2   4 106   2   0  35
    6   0   2   0  11   0   3   0   2   3   0   0]
 [  0   0   0   0   0   0   0   0   0   3   0   0   0   2   2   6   0   2
    2   0   1   1   1   0   0   0   0   1   1   0]
 [  0   0   0   0   1   0   1   2   0   0   0   0   3   0   0   0  57   0
    2   0   0   0   0   0   0   0   0   0   0   0]
 [  1   3   2   0   6   3   0   0   4  11   2   0   0   3  19   3   1 115
    8   1   3   5   7  11   0   1   1   2   1   4]
 [  0   1   0   0   0   0   1   0   1   3   1   0   0   2   5   3   3  10
   26   0   2   0   1   0   0   0   0   1   0   0]
 [  0   6   0   0   1   0   2   0   0   0   1   0   0   0   0   0   0   0
    0   5   0   2   0   0   0   0   0   0   0   0]
 [  0   1   2   0   1   0   0   0   0   0   0   1   1   0   5   2   0   4
    4   0   4   0   0   1   1   0   0   2   0   0]
 [  6   1   1   0   1   0   0   0   0   2   0   1   0   0   2   0   4   0
    0   1   1  23   1   6   0   0   0   2   0   1]
 [  0   0   0   1   0   0   0   0   1   3   0   3   0   1   6   0   0   7
    0   0   1   1  84   0   1   3   5   0   0   0]
 [  0   2   2   0   1   0   0   0   0   2   0   0   0   0   0   0   0   8
    0   0   0   2   0  21   0   0   0   0   0   0]
 [  2   0   3   0   0   0   1   0   2   1   0   2   0   0   2   1   0   2
    0   0   0   0   1   1  84   0   0   9   2   0]
 [  2   0   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   1
    0   0   0   0   2   0   1  22   1   0   0   1]
 [  0   0   0   1   0   0   0   0   0   2   0   0   0   0   0   0   0   2
    0   0   0   2   3   1   0   0   4   0   2   0]
 [  1   3   1   0   0   0   0   1   3   4   2   5   3   0   5   0   0   2
    1   0   0   0   2   0   8   1   0  13   1   2]
 [  0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   1   0
    0   0   0   0   0   0   0   0   0   0  56   0]
 [  0   1   0   0   0   0   0   0   1   1   1   1   0   0   0   0   0   3
    1   0   1   0   0   0   1   2   0   1   0   5]]
2024-03-17 03:43:39,898 - ***** Evaluation results *****
2024-03-17 03:43:39,898 -   acc = 0.5681
2024-03-17 03:43:39,898 -   f1 = 0.5147
2024-03-17 03:43:39,898 -   prec = 0.5235
2024-03-17 03:43:39,898 -   rec = 0.5129
2024-03-17 03:43:39,898 - Testing is finished...
2024-03-17 03:43:39,898 - Multimodal intent recognition is finished...
2024-03-17 03:43:39,898 - Results are saved in results/mag_bert.csv
