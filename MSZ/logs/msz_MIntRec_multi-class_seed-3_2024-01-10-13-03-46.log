2024-01-10 13:03:46,424 - ============================== Params ==============================
2024-01-10 13:03:46,424 - logger_name: msz_MIntRec_multi-class_seed-3_2024-01-10-13-03-46
2024-01-10 13:03:46,424 - dataset: MIntRec
2024-01-10 13:03:46,424 - data_mode: multi-class
2024-01-10 13:03:46,424 - method: msz
2024-01-10 13:03:46,424 - text_backbone: bert-base-uncased
2024-01-10 13:03:46,424 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-10 13:03:46,424 - seed: 3
2024-01-10 13:03:46,424 - num_workers: 8
2024-01-10 13:03:46,424 - gpu_id: 1
2024-01-10 13:03:46,424 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-10 13:03:46,424 - train: True
2024-01-10 13:03:46,424 - tune: False
2024-01-10 13:03:46,424 - save_model: False
2024-01-10 13:03:46,424 - save_results: True
2024-01-10 13:03:46,424 - log_path: logs
2024-01-10 13:03:46,425 - cache_path: 
2024-01-10 13:03:46,425 - video_data_path: video_data
2024-01-10 13:03:46,425 - audio_data_path: audio_data
2024-01-10 13:03:46,425 - video_feats_path: video_feats.pkl
2024-01-10 13:03:46,425 - audio_feats_path: audio_feats.pkl
2024-01-10 13:03:46,425 - results_path: results
2024-01-10 13:03:46,425 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-10 13:03:46,425 - model_path: models
2024-01-10 13:03:46,425 - config_file_name: msz
2024-01-10 13:03:46,425 - results_file_name: msz.csv
2024-01-10 13:03:46,425 - padding_mode: zero
2024-01-10 13:03:46,425 - padding_loc: end
2024-01-10 13:03:46,425 - need_aligned: False
2024-01-10 13:03:46,425 - eval_monitor: f1
2024-01-10 13:03:46,425 - train_batch_size: 16
2024-01-10 13:03:46,425 - eval_batch_size: 8
2024-01-10 13:03:46,425 - test_batch_size: 8
2024-01-10 13:03:46,425 - wait_patience: 8
2024-01-10 13:03:46,425 - nheads: 12
2024-01-10 13:03:46,425 - encoder_layers: 6
2024-01-10 13:03:46,425 - attn_dropout: 0.1
2024-01-10 13:03:46,425 - relu_dropout: 0.1
2024-01-10 13:03:46,425 - embed_dropout: 0.1
2024-01-10 13:03:46,425 - res_dropout: 0.1
2024-01-10 13:03:46,425 - attn_mask: False
2024-01-10 13:03:46,425 - hidden_size: 768
2024-01-10 13:03:46,425 - num_attention_heads: 12
2024-01-10 13:03:46,425 - attention_probs_dropout_prob: 0.1
2024-01-10 13:03:46,425 - hidden_dropout_prob: 0.1
2024-01-10 13:03:46,426 - intermediate_size: 768
2024-01-10 13:03:46,426 - num_hidden_layers: 6
2024-01-10 13:03:46,426 - max_position_embeddings: 768
2024-01-10 13:03:46,426 - position_embedding_type: absolute
2024-01-10 13:03:46,426 - batch_first: True
2024-01-10 13:03:46,426 - hidden_dims: 768
2024-01-10 13:03:46,426 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-10 13:03:46,426 - spe_dropouts: [0.2, 0.1, 0.1]
2024-01-10 13:03:46,426 - aligned_method: conv1d
2024-01-10 13:03:46,426 - grad_clip: 2
2024-01-10 13:03:46,426 - num_train_epochs: 100
2024-01-10 13:03:46,426 - warmup_proportion: 0.1
2024-01-10 13:03:46,426 - lr: 3e-06
2024-01-10 13:03:46,426 - weight_decay: 0.01
2024-01-10 13:03:46,426 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2024-01-10-13-03-46
2024-01-10 13:03:46,426 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2024-01-10-13-03-46/models
2024-01-10 13:03:46,426 - ============================== End Params ==============================
2024-01-10 13:03:46,742 - Generate Text Features Begin...
2024-01-10 13:03:47,284 - Generate Text Features Finished...
2024-01-10 13:03:47,285 - Load Video Features Begin...
2024-01-10 13:05:16,911 - Load Video Features Finished...
2024-01-10 13:05:17,708 - Load Audio Features Begin...
2024-01-10 13:10:59,850 - Load Audio Features Finished...
2024-01-10 13:11:04,949 - method  begins...
2024-01-10 13:11:21,562 - Multimodal intent recognition begins...
2024-01-10 13:11:21,564 - Training begins...
2024-01-10 13:12:13,949 - ***** Epoch: 1: Eval results *****
2024-01-10 13:12:13,954 -   train_loss = 2.9388
2024-01-10 13:12:13,955 -   best_eval_score = 0.0
2024-01-10 13:12:13,955 -   eval_score = 0.0199
2024-01-10 13:13:03,187 - ***** Epoch: 2: Eval results *****
2024-01-10 13:13:03,187 -   train_loss = 2.8055
2024-01-10 13:13:03,188 -   best_eval_score = 0.0199
2024-01-10 13:13:03,188 -   eval_score = 0.0552
2024-01-10 13:13:52,097 - ***** Epoch: 3: Eval results *****
2024-01-10 13:13:52,097 -   train_loss = 2.555
2024-01-10 13:13:52,097 -   best_eval_score = 0.0552
2024-01-10 13:13:52,097 -   eval_score = 0.1526
2024-01-10 13:14:40,994 - ***** Epoch: 4: Eval results *****
2024-01-10 13:14:40,994 -   train_loss = 2.0807
2024-01-10 13:14:40,994 -   best_eval_score = 0.1526
2024-01-10 13:14:40,994 -   eval_score = 0.3328
2024-01-10 13:15:28,495 - ***** Epoch: 5: Eval results *****
2024-01-10 13:15:28,495 -   train_loss = 1.5521
2024-01-10 13:15:28,495 -   best_eval_score = 0.3328
2024-01-10 13:15:28,495 -   eval_score = 0.4932
2024-01-10 13:16:17,037 - ***** Epoch: 6: Eval results *****
2024-01-10 13:16:17,037 -   train_loss = 1.0921
2024-01-10 13:16:17,037 -   best_eval_score = 0.4932
2024-01-10 13:16:17,037 -   eval_score = 0.5472
2024-01-10 13:17:04,403 - ***** Epoch: 7: Eval results *****
2024-01-10 13:17:04,404 -   train_loss = 0.7602
2024-01-10 13:17:04,404 -   best_eval_score = 0.5472
2024-01-10 13:17:04,404 -   eval_score = 0.5852
2024-01-10 13:17:51,669 - ***** Epoch: 8: Eval results *****
2024-01-10 13:17:51,669 -   train_loss = 0.5333
2024-01-10 13:17:51,670 -   best_eval_score = 0.5852
2024-01-10 13:17:51,670 -   eval_score = 0.6003
2024-01-10 13:18:39,202 - ***** Epoch: 9: Eval results *****
2024-01-10 13:18:39,202 -   train_loss = 0.3427
2024-01-10 13:18:39,202 -   best_eval_score = 0.6003
2024-01-10 13:18:39,202 -   eval_score = 0.6608
2024-01-10 13:19:27,981 - ***** Epoch: 10: Eval results *****
2024-01-10 13:19:27,981 -   train_loss = 0.2423
2024-01-10 13:19:27,982 -   best_eval_score = 0.6608
2024-01-10 13:19:27,982 -   eval_score = 0.6507
2024-01-10 13:19:27,982 - EarlyStopping counter: 1 out of 8
2024-01-10 13:20:15,530 - ***** Epoch: 11: Eval results *****
2024-01-10 13:20:15,531 -   train_loss = 0.1436
2024-01-10 13:20:15,531 -   best_eval_score = 0.6608
2024-01-10 13:20:15,531 -   eval_score = 0.6817
2024-01-10 13:21:04,667 - ***** Epoch: 12: Eval results *****
2024-01-10 13:21:04,668 -   train_loss = 0.0983
2024-01-10 13:21:04,668 -   best_eval_score = 0.6817
2024-01-10 13:21:04,668 -   eval_score = 0.6671
2024-01-10 13:21:04,668 - EarlyStopping counter: 1 out of 8
2024-01-10 13:21:52,753 - ***** Epoch: 13: Eval results *****
2024-01-10 13:21:52,754 -   train_loss = 0.0657
2024-01-10 13:21:52,754 -   best_eval_score = 0.6817
2024-01-10 13:21:52,754 -   eval_score = 0.6644
2024-01-10 13:21:52,754 - EarlyStopping counter: 2 out of 8
2024-01-10 13:22:39,550 - ***** Epoch: 14: Eval results *****
2024-01-10 13:22:39,550 -   train_loss = 0.0496
2024-01-10 13:22:39,550 -   best_eval_score = 0.6817
2024-01-10 13:22:39,550 -   eval_score = 0.6684
2024-01-10 13:22:39,550 - EarlyStopping counter: 3 out of 8
2024-01-10 13:23:27,063 - ***** Epoch: 15: Eval results *****
2024-01-10 13:23:27,064 -   train_loss = 0.0378
2024-01-10 13:23:27,064 -   best_eval_score = 0.6817
2024-01-10 13:23:27,064 -   eval_score = 0.6813
2024-01-10 13:23:27,064 - EarlyStopping counter: 4 out of 8
2024-01-10 13:24:17,376 - ***** Epoch: 16: Eval results *****
2024-01-10 13:24:17,377 -   train_loss = 0.0258
2024-01-10 13:24:17,377 -   best_eval_score = 0.6817
2024-01-10 13:24:17,378 -   eval_score = 0.6678
2024-01-10 13:24:17,378 - EarlyStopping counter: 5 out of 8
2024-01-10 13:25:08,447 - ***** Epoch: 17: Eval results *****
2024-01-10 13:25:08,448 -   train_loss = 0.0205
2024-01-10 13:25:08,448 -   best_eval_score = 0.6817
2024-01-10 13:25:08,448 -   eval_score = 0.6694
2024-01-10 13:25:08,448 - EarlyStopping counter: 6 out of 8
2024-01-10 13:25:56,331 - ***** Epoch: 18: Eval results *****
2024-01-10 13:25:56,332 -   train_loss = 0.0189
2024-01-10 13:25:56,332 -   best_eval_score = 0.6817
2024-01-10 13:25:56,332 -   eval_score = 0.6724
2024-01-10 13:25:56,332 - EarlyStopping counter: 7 out of 8
2024-01-10 13:26:43,949 - ***** Epoch: 19: Eval results *****
2024-01-10 13:26:43,950 -   train_loss = 0.0186
2024-01-10 13:26:43,950 -   best_eval_score = 0.6817
2024-01-10 13:26:43,950 -   eval_score = 0.665
2024-01-10 13:26:43,950 - EarlyStopping counter: 8 out of 8
2024-01-10 13:26:43,950 - EarlyStopping at epoch 19
2024-01-10 13:26:43,955 - Training is finished...
2024-01-10 13:26:43,955 - Testing begins...
2024-01-10 13:26:50,396 - ***** Test: Confusion Matrix *****
2024-01-10 13:26:50,397 - [[39  2  0  0  7  0  0  1  0  1  1  0  5  1  0  0  0  0  0  0]
 [ 0 33  0  1  0  3  0  2  0  0  1  0  2  1  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 6  0  0  0 10  0  0  0  0  1  0  1  2  2  0  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 1  1  0  0  5  0  0  1  1  0  0  0  1  0  0  1  1  0  0  0]
 [ 3  0  0  0  0  0  0  6  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  0  3  2  0  0  0  0  2  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  4  1  0  0  0  0  2  0  1  0  0]
 [ 1  0  0  0  0  0  0  0  0  1 14  0  0  0  1  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  1 16  0  0  0  0  0  0  0  1]
 [ 4  2  0  0  1  0  0  1  0  0  0  1 38  3  5  1  1  0  0  0]
 [ 1  0  0  0  0  0  1  0  0  0  2  1  1 18  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  2 16  0  2  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  4  1  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  3  1 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  1  0  0  0  0 12  0  0]
 [ 0  0  1  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  2  0  2  0  0  4]]
2024-01-10 13:26:50,397 - ***** Evaluation results *****
2024-01-10 13:26:50,397 -   acc = 0.6921
2024-01-10 13:26:50,397 -   f1 = 0.6422
2024-01-10 13:26:50,397 -   prec = 0.6529
2024-01-10 13:26:50,397 -   rec = 0.6473
2024-01-10 13:26:50,397 - Testing is finished...
2024-01-10 13:26:50,397 - Multimodal intent recognition is finished...
2024-01-10 13:26:50,397 - Results are saved in results/msz.csv
