2024-01-16 07:50:14,891 - ============================== Params ==============================
2024-01-16 07:50:14,892 - logger_name: msz_MIntRec_multi-class_seed-1_2024-01-16-07-50-14
2024-01-16 07:50:14,892 - dataset: MIntRec
2024-01-16 07:50:14,892 - data_mode: multi-class
2024-01-16 07:50:14,892 - method: msz
2024-01-16 07:50:14,892 - text_backbone: bert-base-uncased
2024-01-16 07:50:14,892 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-16 07:50:14,892 - seed: 1
2024-01-16 07:50:14,892 - num_workers: 8
2024-01-16 07:50:14,892 - gpu_id: 1
2024-01-16 07:50:14,892 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-16 07:50:14,892 - train: True
2024-01-16 07:50:14,892 - tune: False
2024-01-16 07:50:14,892 - save_model: False
2024-01-16 07:50:14,892 - save_results: True
2024-01-16 07:50:14,892 - log_path: logs
2024-01-16 07:50:14,892 - cache_path: 
2024-01-16 07:50:14,892 - video_data_path: video_data
2024-01-16 07:50:14,892 - audio_data_path: audio_data
2024-01-16 07:50:14,892 - video_feats_path: video_feats.pkl
2024-01-16 07:50:14,892 - audio_feats_path: audio_feats.pkl
2024-01-16 07:50:14,892 - results_path: results
2024-01-16 07:50:14,892 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-16 07:50:14,892 - model_path: models
2024-01-16 07:50:14,892 - config_file_name: msz
2024-01-16 07:50:14,892 - results_file_name: msz.csv
2024-01-16 07:50:14,892 - padding_mode: zero
2024-01-16 07:50:14,892 - padding_loc: end
2024-01-16 07:50:14,892 - need_aligned: False
2024-01-16 07:50:14,893 - eval_monitor: f1
2024-01-16 07:50:14,893 - train_batch_size: 16
2024-01-16 07:50:14,893 - eval_batch_size: 8
2024-01-16 07:50:14,893 - test_batch_size: 8
2024-01-16 07:50:14,893 - wait_patience: 8
2024-01-16 07:50:14,893 - hidden_size: 768
2024-01-16 07:50:14,893 - num_attention_heads: 12
2024-01-16 07:50:14,893 - attention_probs_dropout_prob: 0.2
2024-01-16 07:50:14,893 - hidden_dropout_prob: 0.2
2024-01-16 07:50:14,893 - intermediate_size: 768
2024-01-16 07:50:14,893 - num_hidden_layers: 8
2024-01-16 07:50:14,893 - max_position_embeddings: 768
2024-01-16 07:50:14,893 - position_embedding_type: absolute
2024-01-16 07:50:14,893 - batch_first: True
2024-01-16 07:50:14,893 - hidden_dims: 768
2024-01-16 07:50:14,893 - dropout: 0.1
2024-01-16 07:50:14,893 - aligned_method: conv1d
2024-01-16 07:50:14,893 - num_train_epochs: 100
2024-01-16 07:50:14,893 - lr: 8e-06
2024-01-16 07:50:14,893 - scale: 32
2024-01-16 07:50:14,893 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-16-07-50-14
2024-01-16 07:50:14,893 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-16-07-50-14/models
2024-01-16 07:50:14,893 - ============================== End Params ==============================
2024-01-16 07:50:14,896 - Generate Text Features Begin...
2024-01-16 07:50:15,393 - Generate Text Features Finished...
2024-01-16 07:50:15,394 - Load Video Features Begin...
2024-01-16 07:50:15,705 - Load Video Features Finished...
2024-01-16 07:50:16,292 - Load Audio Features Begin...
2024-01-16 07:50:17,257 - Load Audio Features Finished...
2024-01-16 07:50:20,736 - method  begins...
2024-01-16 07:50:23,746 - Multimodal intent recognition begins...
2024-01-16 07:50:23,746 - Training begins...
2024-01-16 07:50:46,282 - ***** Epoch: 1: Eval results *****
2024-01-16 07:50:46,282 -   train_loss = 1.8107
2024-01-16 07:50:46,282 -   best_eval_score = 0.0
2024-01-16 07:50:46,282 -   eval_score = 0.5622
2024-01-16 07:51:06,302 - ***** Epoch: 2: Eval results *****
2024-01-16 07:51:06,302 -   train_loss = 0.7334
2024-01-16 07:51:06,303 -   best_eval_score = 0.5622
2024-01-16 07:51:06,303 -   eval_score = 0.6531
2024-01-16 07:51:25,838 - ***** Epoch: 3: Eval results *****
2024-01-16 07:51:25,838 -   train_loss = 0.3434
2024-01-16 07:51:25,838 -   best_eval_score = 0.6531
2024-01-16 07:51:25,838 -   eval_score = 0.6566
2024-01-16 07:51:45,540 - ***** Epoch: 4: Eval results *****
2024-01-16 07:51:45,540 -   train_loss = 0.1573
2024-01-16 07:51:45,540 -   best_eval_score = 0.6566
2024-01-16 07:51:45,540 -   eval_score = 0.6734
2024-01-16 07:52:05,375 - ***** Epoch: 5: Eval results *****
2024-01-16 07:52:05,375 -   train_loss = 0.0766
2024-01-16 07:52:05,375 -   best_eval_score = 0.6734
2024-01-16 07:52:05,375 -   eval_score = 0.6769
2024-01-16 07:52:24,997 - ***** Epoch: 6: Eval results *****
2024-01-16 07:52:24,997 -   train_loss = 0.0336
2024-01-16 07:52:24,997 -   best_eval_score = 0.6769
2024-01-16 07:52:24,997 -   eval_score = 0.6859
2024-01-16 07:52:44,697 - ***** Epoch: 7: Eval results *****
2024-01-16 07:52:44,699 -   train_loss = 0.0223
2024-01-16 07:52:44,699 -   best_eval_score = 0.6859
2024-01-16 07:52:44,699 -   eval_score = 0.6751
2024-01-16 07:52:44,699 - EarlyStopping counter: 1 out of 8
2024-01-16 07:53:04,549 - ***** Epoch: 8: Eval results *****
2024-01-16 07:53:04,550 -   train_loss = 0.015
2024-01-16 07:53:04,550 -   best_eval_score = 0.6859
2024-01-16 07:53:04,550 -   eval_score = 0.6888
2024-01-16 07:53:24,895 - ***** Epoch: 9: Eval results *****
2024-01-16 07:53:24,895 -   train_loss = 0.013
2024-01-16 07:53:24,895 -   best_eval_score = 0.6888
2024-01-16 07:53:24,895 -   eval_score = 0.6782
2024-01-16 07:53:24,895 - EarlyStopping counter: 1 out of 8
2024-01-16 07:53:45,164 - ***** Epoch: 10: Eval results *****
2024-01-16 07:53:45,165 -   train_loss = 0.009
2024-01-16 07:53:45,165 -   best_eval_score = 0.6888
2024-01-16 07:53:45,165 -   eval_score = 0.696
2024-01-16 07:54:05,208 - ***** Epoch: 11: Eval results *****
2024-01-16 07:54:05,208 -   train_loss = 0.0068
2024-01-16 07:54:05,208 -   best_eval_score = 0.696
2024-01-16 07:54:05,208 -   eval_score = 0.6908
2024-01-16 07:54:05,208 - EarlyStopping counter: 1 out of 8
2024-01-16 07:54:25,597 - ***** Epoch: 12: Eval results *****
2024-01-16 07:54:25,597 -   train_loss = 0.0061
2024-01-16 07:54:25,597 -   best_eval_score = 0.696
2024-01-16 07:54:25,597 -   eval_score = 0.698
2024-01-16 07:54:46,584 - ***** Epoch: 13: Eval results *****
2024-01-16 07:54:46,584 -   train_loss = 0.0058
2024-01-16 07:54:46,584 -   best_eval_score = 0.698
2024-01-16 07:54:46,585 -   eval_score = 0.6875
2024-01-16 07:54:46,585 - EarlyStopping counter: 1 out of 8
2024-01-16 07:55:06,613 - ***** Epoch: 14: Eval results *****
2024-01-16 07:55:06,614 -   train_loss = 0.0055
2024-01-16 07:55:06,614 -   best_eval_score = 0.698
2024-01-16 07:55:06,614 -   eval_score = 0.6915
2024-01-16 07:55:06,614 - EarlyStopping counter: 2 out of 8
2024-01-16 07:55:26,564 - ***** Epoch: 15: Eval results *****
2024-01-16 07:55:26,565 -   train_loss = 0.0048
2024-01-16 07:55:26,565 -   best_eval_score = 0.698
2024-01-16 07:55:26,565 -   eval_score = 0.6918
2024-01-16 07:55:26,565 - EarlyStopping counter: 3 out of 8
2024-01-16 07:55:46,846 - ***** Epoch: 16: Eval results *****
2024-01-16 07:55:46,846 -   train_loss = 0.0046
2024-01-16 07:55:46,846 -   best_eval_score = 0.698
2024-01-16 07:55:46,846 -   eval_score = 0.6926
2024-01-16 07:55:46,846 - EarlyStopping counter: 4 out of 8
2024-01-16 07:56:07,416 - ***** Epoch: 17: Eval results *****
2024-01-16 07:56:07,416 -   train_loss = 0.0041
2024-01-16 07:56:07,417 -   best_eval_score = 0.698
2024-01-16 07:56:07,417 -   eval_score = 0.6897
2024-01-16 07:56:07,417 - EarlyStopping counter: 5 out of 8
2024-01-16 07:56:27,162 - ***** Epoch: 18: Eval results *****
2024-01-16 07:56:27,162 -   train_loss = 0.0042
2024-01-16 07:56:27,162 -   best_eval_score = 0.698
2024-01-16 07:56:27,162 -   eval_score = 0.6948
2024-01-16 07:56:27,162 - EarlyStopping counter: 6 out of 8
2024-01-16 07:56:47,210 - ***** Epoch: 19: Eval results *****
2024-01-16 07:56:47,210 -   train_loss = 0.0036
2024-01-16 07:56:47,210 -   best_eval_score = 0.698
2024-01-16 07:56:47,211 -   eval_score = 0.6987
2024-01-16 07:57:07,581 - ***** Epoch: 20: Eval results *****
2024-01-16 07:57:07,581 -   train_loss = 0.0038
2024-01-16 07:57:07,581 -   best_eval_score = 0.6987
2024-01-16 07:57:07,581 -   eval_score = 0.7005
2024-01-16 07:57:28,055 - ***** Epoch: 21: Eval results *****
2024-01-16 07:57:28,055 -   train_loss = 0.0036
2024-01-16 07:57:28,055 -   best_eval_score = 0.7005
2024-01-16 07:57:28,055 -   eval_score = 0.6997
2024-01-16 07:57:28,056 - EarlyStopping counter: 1 out of 8
2024-01-16 07:57:48,077 - ***** Epoch: 22: Eval results *****
2024-01-16 07:57:48,077 -   train_loss = 0.0034
2024-01-16 07:57:48,077 -   best_eval_score = 0.7005
2024-01-16 07:57:48,077 -   eval_score = 0.6987
2024-01-16 07:57:48,077 - EarlyStopping counter: 2 out of 8
2024-01-16 07:58:08,411 - ***** Epoch: 23: Eval results *****
2024-01-16 07:58:08,411 -   train_loss = 0.0034
2024-01-16 07:58:08,411 -   best_eval_score = 0.7005
2024-01-16 07:58:08,411 -   eval_score = 0.698
2024-01-16 07:58:08,411 - EarlyStopping counter: 3 out of 8
2024-01-16 07:58:28,414 - ***** Epoch: 24: Eval results *****
2024-01-16 07:58:28,414 -   train_loss = 0.0033
2024-01-16 07:58:28,414 -   best_eval_score = 0.7005
2024-01-16 07:58:28,414 -   eval_score = 0.698
2024-01-16 07:58:28,414 - EarlyStopping counter: 4 out of 8
2024-01-16 07:58:49,159 - ***** Epoch: 25: Eval results *****
2024-01-16 07:58:49,159 -   train_loss = 0.0033
2024-01-16 07:58:49,159 -   best_eval_score = 0.7005
2024-01-16 07:58:49,159 -   eval_score = 0.698
2024-01-16 07:58:49,159 - EarlyStopping counter: 5 out of 8
2024-01-16 07:59:09,506 - ***** Epoch: 26: Eval results *****
2024-01-16 07:59:09,506 -   train_loss = 0.0042
2024-01-16 07:59:09,506 -   best_eval_score = 0.7005
2024-01-16 07:59:09,506 -   eval_score = 0.6908
2024-01-16 07:59:09,506 - EarlyStopping counter: 6 out of 8
2024-01-16 07:59:29,531 - ***** Epoch: 27: Eval results *****
2024-01-16 07:59:29,531 -   train_loss = 0.0034
2024-01-16 07:59:29,531 -   best_eval_score = 0.7005
2024-01-16 07:59:29,531 -   eval_score = 0.7011
2024-01-16 07:59:49,490 - ***** Epoch: 28: Eval results *****
2024-01-16 07:59:49,490 -   train_loss = 0.0031
2024-01-16 07:59:49,490 -   best_eval_score = 0.7011
2024-01-16 07:59:49,490 -   eval_score = 0.7022
2024-01-16 08:00:10,256 - ***** Epoch: 29: Eval results *****
2024-01-16 08:00:10,256 -   train_loss = 0.0036
2024-01-16 08:00:10,256 -   best_eval_score = 0.7022
2024-01-16 08:00:10,256 -   eval_score = 0.6987
2024-01-16 08:00:10,257 - EarlyStopping counter: 1 out of 8
2024-01-16 08:00:30,541 - ***** Epoch: 30: Eval results *****
2024-01-16 08:00:30,541 -   train_loss = 0.0029
2024-01-16 08:00:30,541 -   best_eval_score = 0.7022
2024-01-16 08:00:30,541 -   eval_score = 0.6987
2024-01-16 08:00:30,541 - EarlyStopping counter: 2 out of 8
2024-01-16 08:00:51,428 - ***** Epoch: 31: Eval results *****
2024-01-16 08:00:51,429 -   train_loss = 0.0029
2024-01-16 08:00:51,429 -   best_eval_score = 0.7022
2024-01-16 08:00:51,429 -   eval_score = 0.7005
2024-01-16 08:00:51,429 - EarlyStopping counter: 3 out of 8
2024-01-16 08:01:12,014 - ***** Epoch: 32: Eval results *****
2024-01-16 08:01:12,015 -   train_loss = 0.0032
2024-01-16 08:01:12,015 -   best_eval_score = 0.7022
2024-01-16 08:01:12,015 -   eval_score = 0.7006
2024-01-16 08:01:12,015 - EarlyStopping counter: 4 out of 8
2024-01-16 08:01:32,611 - ***** Epoch: 33: Eval results *****
2024-01-16 08:01:32,611 -   train_loss = 0.0029
2024-01-16 08:01:32,611 -   best_eval_score = 0.7022
2024-01-16 08:01:32,611 -   eval_score = 0.7005
2024-01-16 08:01:32,611 - EarlyStopping counter: 5 out of 8
2024-01-16 08:01:52,973 - ***** Epoch: 34: Eval results *****
2024-01-16 08:01:52,974 -   train_loss = 0.0027
2024-01-16 08:01:52,974 -   best_eval_score = 0.7022
2024-01-16 08:01:52,974 -   eval_score = 0.6998
2024-01-16 08:01:52,974 - EarlyStopping counter: 6 out of 8
2024-01-16 08:02:13,279 - ***** Epoch: 35: Eval results *****
2024-01-16 08:02:13,279 -   train_loss = 0.003
2024-01-16 08:02:13,279 -   best_eval_score = 0.7022
2024-01-16 08:02:13,280 -   eval_score = 0.7005
2024-01-16 08:02:13,280 - EarlyStopping counter: 7 out of 8
2024-01-16 08:02:33,672 - ***** Epoch: 36: Eval results *****
2024-01-16 08:02:33,672 -   train_loss = 0.0029
2024-01-16 08:02:33,672 -   best_eval_score = 0.7022
2024-01-16 08:02:33,672 -   eval_score = 0.7005
2024-01-16 08:02:33,672 - EarlyStopping counter: 8 out of 8
2024-01-16 08:02:33,672 - EarlyStopping at epoch 36
2024-01-16 08:02:33,675 - Training is finished...
2024-01-16 08:02:33,676 - Testing begins...
2024-01-16 08:02:37,127 - ***** Test: Confusion Matrix *****
2024-01-16 08:02:37,128 - [[35  3  0  0  9  0  0  0  0  3  1  0  5  1  0  0  0  0  0  0]
 [ 1 34  0  1  0  2  0  0  1  0  0  0  4  0  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 7  0  0  0 13  0  0  0  0  0  0  1  0  0  1  0  0  1  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 3  2  0  0  1  0  3  0  1  0  0  0  1  0  1  0  0  0  0  0]
 [ 4  0  0  0  0  0  0  5  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  2  5  0  0  0  1  0  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  1  0  0  3  0  0  0  0  0  3  0  2  0  0]
 [ 1  0  0  0  0  0  0  0  0  3 12  1  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  1  0  1  0  0  0  0 16  0  0  0  0  0  0  0  1]
 [ 4  2  0  0  1  0  0  0  0  0  0  1 39  1  2  2  3  1  0  1]
 [ 0  0  0  0  0  0  1  0  0  0  1  1  1 19  1  0  1  0  0  0]
 [ 0  0  0  0  1  0  0  0  1  0  0  0  1  1 17  0  1  0  0  0]
 [ 0  2  0  0  0  0  0  0  0  0  0  0  4  1  0 14  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  1  0 14  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  2  0  0  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  1  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0  0  7]]
2024-01-16 08:02:37,128 - ***** Evaluation results *****
2024-01-16 08:02:37,128 -   acc = 0.7169
2024-01-16 08:02:37,128 -   f1 = 0.7034
2024-01-16 08:02:37,128 -   prec = 0.7229
2024-01-16 08:02:37,128 -   rec = 0.6954
2024-01-16 08:02:37,129 - Testing is finished...
2024-01-16 08:02:37,129 - Multimodal intent recognition is finished...
2024-01-16 08:02:37,129 - Results are saved in results/msz.csv
