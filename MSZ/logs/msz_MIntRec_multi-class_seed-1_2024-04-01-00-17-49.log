2024-04-01 00:17:49,685 - ============================== Params ==============================
2024-04-01 00:17:49,685 - logger_name: msz_MIntRec_multi-class_seed-1_2024-04-01-00-17-49
2024-04-01 00:17:49,685 - dataset: MIntRec
2024-04-01 00:17:49,685 - data_mode: multi-class
2024-04-01 00:17:49,685 - method: msz
2024-04-01 00:17:49,686 - text_backbone: bert-base-uncased
2024-04-01 00:17:49,686 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-01 00:17:49,686 - seed: 1
2024-04-01 00:17:49,686 - num_workers: 8
2024-04-01 00:17:49,686 - gpu_id: 3
2024-04-01 00:17:49,686 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-01 00:17:49,686 - train: True
2024-04-01 00:17:49,686 - tune: True
2024-04-01 00:17:49,686 - save_model: False
2024-04-01 00:17:49,686 - save_results: True
2024-04-01 00:17:49,686 - log_path: logs
2024-04-01 00:17:49,686 - cache_path: 
2024-04-01 00:17:49,686 - video_data_path: video_data
2024-04-01 00:17:49,686 - audio_data_path: audio_data
2024-04-01 00:17:49,686 - video_feats_path: video_feats.pkl
2024-04-01 00:17:49,686 - audio_feats_path: audio_feats.pkl
2024-04-01 00:17:49,686 - results_path: results
2024-04-01 00:17:49,686 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-04-01 00:17:49,686 - model_path: models
2024-04-01 00:17:49,686 - config_file_name: msz_MIntRec
2024-04-01 00:17:49,686 - results_file_name: msz.csv
2024-04-01 00:17:49,686 - padding_mode: zero
2024-04-01 00:17:49,686 - padding_loc: end
2024-04-01 00:17:49,686 - need_aligned: False
2024-04-01 00:17:49,686 - eval_monitor: f1
2024-04-01 00:17:49,686 - train_batch_size: 16
2024-04-01 00:17:49,686 - eval_batch_size: 8
2024-04-01 00:17:49,686 - test_batch_size: 8
2024-04-01 00:17:49,686 - wait_patience: 8
2024-04-01 00:17:49,686 - hidden_dims: 768
2024-04-01 00:17:49,686 - num_attention_heads: 12
2024-04-01 00:17:49,686 - attention_probs_dropout_prob: 0.2
2024-04-01 00:17:49,686 - hidden_dropout_prob: 0.2
2024-04-01 00:17:49,686 - intermediate_size: 768
2024-04-01 00:17:49,686 - num_hidden_layers: 10
2024-04-01 00:17:49,686 - max_position_embeddings: 768
2024-04-01 00:17:49,687 - position_embedding_type: absolute
2024-04-01 00:17:49,687 - batch_first: True
2024-04-01 00:17:49,687 - dropout: 0.4
2024-04-01 00:17:49,687 - aligned_method: conv1d
2024-04-01 00:17:49,687 - num_train_epochs: 100
2024-04-01 00:17:49,687 - lr: 6e-05
2024-04-01 00:17:49,687 - lr_mode: max
2024-04-01 00:17:49,687 - patience: 8
2024-04-01 00:17:49,687 - factor: 0.1
2024-04-01 00:17:49,687 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-04-01-00-17-49
2024-04-01 00:17:49,687 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-04-01-00-17-49/models
2024-04-01 00:17:49,687 - num_labels: 20
2024-04-01 00:17:49,687 - text_feat_dim: 768
2024-04-01 00:17:49,687 - video_feat_dim: 256
2024-04-01 00:17:49,687 - audio_feat_dim: 768
2024-04-01 00:17:49,687 - text_seq_len: 30
2024-04-01 00:17:49,687 - video_seq_len: 230
2024-04-01 00:17:49,687 - audio_seq_len: 480
2024-04-01 00:17:49,687 - device: cuda:3
2024-04-01 00:17:49,687 - ============================== End Params ==============================
2024-04-01 00:17:49,828 - Generate Text Features Begin...
2024-04-01 00:17:50,424 - Generate Text Features Finished...
2024-04-01 00:17:50,432 - Load Video Features Begin...
2024-04-01 00:18:04,329 - Load Video Features Finished...
2024-04-01 00:18:05,155 - Load Audio Features Begin...
2024-04-01 00:18:43,727 - Load Audio Features Finished...
2024-04-01 00:18:48,246 - method  begins...
2024-04-01 00:18:52,930 - Multimodal intent recognition begins...
2024-04-01 00:18:52,931 - Training begins...
2024-04-01 00:19:18,308 - ***** Epoch: 1: Eval results *****
2024-04-01 00:19:18,308 -   train_loss = 2.5281
2024-04-01 00:19:18,308 -   best_eval_score = 0.0
2024-04-01 00:19:18,308 -   eval_score = 0.3641
2024-04-01 00:19:42,581 - ***** Epoch: 2: Eval results *****
2024-04-01 00:19:42,581 -   train_loss = 1.4275
2024-04-01 00:19:42,581 -   best_eval_score = 0.3641
2024-04-01 00:19:42,581 -   eval_score = 0.4643
2024-04-01 00:20:06,730 - ***** Epoch: 3: Eval results *****
2024-04-01 00:20:06,731 -   train_loss = 0.9447
2024-04-01 00:20:06,731 -   best_eval_score = 0.4643
2024-04-01 00:20:06,731 -   eval_score = 0.5884
2024-04-01 00:20:31,053 - ***** Epoch: 4: Eval results *****
2024-04-01 00:20:31,054 -   train_loss = 0.6014
2024-04-01 00:20:31,054 -   best_eval_score = 0.5884
2024-04-01 00:20:31,054 -   eval_score = 0.5917
2024-04-01 00:20:55,232 - ***** Epoch: 5: Eval results *****
2024-04-01 00:20:55,233 -   train_loss = 0.4962
2024-04-01 00:20:55,233 -   best_eval_score = 0.5917
2024-04-01 00:20:55,233 -   eval_score = 0.6351
2024-04-01 00:21:19,367 - ***** Epoch: 6: Eval results *****
2024-04-01 00:21:19,367 -   train_loss = 0.3676
2024-04-01 00:21:19,367 -   best_eval_score = 0.6351
2024-04-01 00:21:19,367 -   eval_score = 0.5889
2024-04-01 00:21:19,367 - EarlyStopping counter: 1 out of 8
2024-04-01 00:21:42,295 - ***** Epoch: 7: Eval results *****
2024-04-01 00:21:42,303 -   train_loss = 0.3355
2024-04-01 00:21:42,303 -   best_eval_score = 0.6351
2024-04-01 00:21:42,303 -   eval_score = 0.6561
2024-04-01 00:22:06,809 - ***** Epoch: 8: Eval results *****
2024-04-01 00:22:06,810 -   train_loss = 0.31
2024-04-01 00:22:06,810 -   best_eval_score = 0.6561
2024-04-01 00:22:06,810 -   eval_score = 0.5516
2024-04-01 00:22:06,810 - EarlyStopping counter: 1 out of 8
2024-04-01 00:22:31,038 - ***** Epoch: 9: Eval results *****
2024-04-01 00:22:31,038 -   train_loss = 0.2388
2024-04-01 00:22:31,038 -   best_eval_score = 0.6561
2024-04-01 00:22:31,039 -   eval_score = 0.6259
2024-04-01 00:22:31,039 - EarlyStopping counter: 2 out of 8
2024-04-01 00:22:54,103 - ***** Epoch: 10: Eval results *****
2024-04-01 00:22:54,104 -   train_loss = 0.224
2024-04-01 00:22:54,104 -   best_eval_score = 0.6561
2024-04-01 00:22:54,104 -   eval_score = 0.6281
2024-04-01 00:22:54,104 - EarlyStopping counter: 3 out of 8
2024-04-01 00:23:18,474 - ***** Epoch: 11: Eval results *****
2024-04-01 00:23:18,475 -   train_loss = 0.0719
2024-04-01 00:23:18,475 -   best_eval_score = 0.6561
2024-04-01 00:23:18,475 -   eval_score = 0.6556
2024-04-01 00:23:18,475 - EarlyStopping counter: 4 out of 8
2024-04-01 00:23:42,829 - ***** Epoch: 12: Eval results *****
2024-04-01 00:23:42,830 -   train_loss = 0.0411
2024-04-01 00:23:42,830 -   best_eval_score = 0.6561
2024-04-01 00:23:42,830 -   eval_score = 0.6635
2024-04-01 00:24:06,182 - ***** Epoch: 13: Eval results *****
2024-04-01 00:24:06,182 -   train_loss = 0.0277
2024-04-01 00:24:06,182 -   best_eval_score = 0.6635
2024-04-01 00:24:06,182 -   eval_score = 0.6634
2024-04-01 00:24:06,182 - EarlyStopping counter: 1 out of 8
2024-04-01 00:24:31,085 - ***** Epoch: 14: Eval results *****
2024-04-01 00:24:31,086 -   train_loss = 0.0241
2024-04-01 00:24:31,086 -   best_eval_score = 0.6635
2024-04-01 00:24:31,086 -   eval_score = 0.6518
2024-04-01 00:24:31,086 - EarlyStopping counter: 2 out of 8
2024-04-01 00:24:55,943 - ***** Epoch: 15: Eval results *****
2024-04-01 00:24:55,944 -   train_loss = 0.0119
2024-04-01 00:24:55,944 -   best_eval_score = 0.6635
2024-04-01 00:24:55,944 -   eval_score = 0.6566
2024-04-01 00:24:55,944 - EarlyStopping counter: 3 out of 8
2024-04-01 00:25:20,855 - ***** Epoch: 16: Eval results *****
2024-04-01 00:25:20,863 -   train_loss = 0.0101
2024-04-01 00:25:20,864 -   best_eval_score = 0.6635
2024-04-01 00:25:20,864 -   eval_score = 0.6605
2024-04-01 00:25:20,864 - EarlyStopping counter: 4 out of 8
2024-04-01 00:25:45,861 - ***** Epoch: 17: Eval results *****
2024-04-01 00:25:45,861 -   train_loss = 0.01
2024-04-01 00:25:45,861 -   best_eval_score = 0.6635
2024-04-01 00:25:45,861 -   eval_score = 0.6668
2024-04-01 00:26:10,472 - ***** Epoch: 18: Eval results *****
2024-04-01 00:26:10,472 -   train_loss = 0.0053
2024-04-01 00:26:10,472 -   best_eval_score = 0.6668
2024-04-01 00:26:10,473 -   eval_score = 0.6663
2024-04-01 00:26:10,473 - EarlyStopping counter: 1 out of 8
2024-04-01 00:26:34,836 - ***** Epoch: 19: Eval results *****
2024-04-01 00:26:34,836 -   train_loss = 0.0052
2024-04-01 00:26:34,836 -   best_eval_score = 0.6668
2024-04-01 00:26:34,836 -   eval_score = 0.6639
2024-04-01 00:26:34,836 - EarlyStopping counter: 2 out of 8
2024-04-01 00:26:58,854 - ***** Epoch: 20: Eval results *****
2024-04-01 00:26:58,854 -   train_loss = 0.0047
2024-04-01 00:26:58,854 -   best_eval_score = 0.6668
2024-04-01 00:26:58,854 -   eval_score = 0.6639
2024-04-01 00:26:58,854 - EarlyStopping counter: 3 out of 8
2024-04-01 00:27:23,487 - ***** Epoch: 21: Eval results *****
2024-04-01 00:27:23,487 -   train_loss = 0.0042
2024-04-01 00:27:23,488 -   best_eval_score = 0.6668
2024-04-01 00:27:23,488 -   eval_score = 0.6639
2024-04-01 00:27:23,488 - EarlyStopping counter: 4 out of 8
2024-04-01 00:27:47,558 - ***** Epoch: 22: Eval results *****
2024-04-01 00:27:47,558 -   train_loss = 0.0058
2024-04-01 00:27:47,558 -   best_eval_score = 0.6668
2024-04-01 00:27:47,558 -   eval_score = 0.6639
2024-04-01 00:27:47,558 - EarlyStopping counter: 5 out of 8
2024-04-01 00:28:12,189 - ***** Epoch: 23: Eval results *****
2024-04-01 00:28:12,189 -   train_loss = 0.0078
2024-04-01 00:28:12,189 -   best_eval_score = 0.6668
2024-04-01 00:28:12,189 -   eval_score = 0.6654
2024-04-01 00:28:12,189 - EarlyStopping counter: 6 out of 8
2024-04-01 00:28:36,619 - ***** Epoch: 24: Eval results *****
2024-04-01 00:28:36,620 -   train_loss = 0.0045
2024-04-01 00:28:36,620 -   best_eval_score = 0.6668
2024-04-01 00:28:36,620 -   eval_score = 0.6654
2024-04-01 00:28:36,620 - EarlyStopping counter: 7 out of 8
2024-04-01 00:28:59,838 - ***** Epoch: 25: Eval results *****
2024-04-01 00:28:59,847 -   train_loss = 0.0046
2024-04-01 00:28:59,847 -   best_eval_score = 0.6668
2024-04-01 00:28:59,847 -   eval_score = 0.6659
2024-04-01 00:28:59,847 - EarlyStopping counter: 8 out of 8
2024-04-01 00:28:59,847 - EarlyStopping at epoch 25
2024-04-01 00:28:59,850 - Training is finished...
2024-04-01 00:28:59,851 - Testing begins...
2024-04-01 00:29:03,786 - ***** Test: Confusion Matrix *****
2024-04-01 00:29:03,788 - [[32  0  0  0  9  1  2  1  1  3  0  0  6  2  0  0  0  0  0  0]
 [ 0 36  0  1  0  1  3  0  0  0  1  0  1  0  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0 10  0  3  0  1  1  0  1  2  1  1  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  0  1  0  0  0  0]
 [ 1  0  0  0  3  0  2  0  2  0  0  0  1  0  1  1  0  1  0  0]
 [ 4  0  0  0  0  0  0  3  1  1  0  0  1  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  3  4  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  1  0  0  0  0  1  0  0  4  0  0  0  0  0  2  0  1  0  0]
 [ 1  1  0  0  1  0  2  0  0  3 10  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 15  1  0  0  0  0  0  1  1]
 [ 5  3  0  0  0  1  0  2  1  1  0  0 37  2  3  2  0  0  0  0]
 [ 1  0  0  0  0  0  0  1  0  0  1  1  2 18  0  1  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  1  0  0  0  0  2 15  0  1  0  0  2]
 [ 0  1  0  1  0  0  0  1  1  0  0  0  3  1  0 13  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  4  0  1  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  2  0  0  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0 10  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  1  1  0  0  0  0  6]]
2024-04-01 00:29:03,788 - ***** Evaluation results *****
2024-04-01 00:29:03,788 -   acc = 0.6764
2024-04-01 00:29:03,788 -   f1 = 0.6493
2024-04-01 00:29:03,788 -   prec = 0.6597
2024-04-01 00:29:03,788 -   rec = 0.6467
2024-04-01 00:29:03,788 - Testing is finished...
2024-04-01 00:29:03,788 - Multimodal intent recognition is finished...
2024-04-01 00:29:03,788 - Results are saved in results/msz.csv
