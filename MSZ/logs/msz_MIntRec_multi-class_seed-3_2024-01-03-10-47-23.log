2024-01-03 10:47:23,394 - ============================== Params ==============================
2024-01-03 10:47:23,394 - logger_name: msz_MIntRec_multi-class_seed-3_2024-01-03-10-47-23
2024-01-03 10:47:23,394 - dataset: MIntRec
2024-01-03 10:47:23,394 - data_mode: multi-class
2024-01-03 10:47:23,394 - method: msz
2024-01-03 10:47:23,394 - text_backbone: bert-base-uncased
2024-01-03 10:47:23,394 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-03 10:47:23,394 - seed: 3
2024-01-03 10:47:23,394 - num_workers: 8
2024-01-03 10:47:23,394 - gpu_id: 1
2024-01-03 10:47:23,394 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-03 10:47:23,394 - train: True
2024-01-03 10:47:23,394 - tune: False
2024-01-03 10:47:23,394 - save_model: False
2024-01-03 10:47:23,394 - save_results: True
2024-01-03 10:47:23,394 - log_path: logs
2024-01-03 10:47:23,394 - cache_path: 
2024-01-03 10:47:23,394 - video_data_path: video_data
2024-01-03 10:47:23,394 - audio_data_path: audio_data
2024-01-03 10:47:23,394 - video_feats_path: video_feats.pkl
2024-01-03 10:47:23,394 - audio_feats_path: audio_feats.pkl
2024-01-03 10:47:23,394 - results_path: results
2024-01-03 10:47:23,394 - output_path: /home/sujianhua/Outputs/MIntRec
2024-01-03 10:47:23,394 - model_path: models
2024-01-03 10:47:23,394 - config_file_name: msz
2024-01-03 10:47:23,395 - results_file_name: msz.csv
2024-01-03 10:47:23,395 - padding_mode: zero
2024-01-03 10:47:23,395 - padding_loc: end
2024-01-03 10:47:23,395 - need_aligned: False
2024-01-03 10:47:23,395 - eval_monitor: f1
2024-01-03 10:47:23,395 - train_batch_size: 16
2024-01-03 10:47:23,395 - eval_batch_size: 8
2024-01-03 10:47:23,395 - test_batch_size: 8
2024-01-03 10:47:23,395 - wait_patience: 8
2024-01-03 10:47:23,395 - nheads: 2
2024-01-03 10:47:23,395 - encoder_layers: 2
2024-01-03 10:47:23,395 - attn_dropout: 0.1
2024-01-03 10:47:23,395 - relu_dropout: 0.1
2024-01-03 10:47:23,395 - embed_dropout: 0.1
2024-01-03 10:47:23,395 - res_dropout: 0.1
2024-01-03 10:47:23,395 - attn_mask: False
2024-01-03 10:47:23,395 - hidden_size: 768
2024-01-03 10:47:23,395 - num_attention_heads: 12
2024-01-03 10:47:23,395 - attention_probs_dropout_prob: 0.2
2024-01-03 10:47:23,395 - hidden_dropout_prob: 0.2
2024-01-03 10:47:23,395 - intermediate_size: 768
2024-01-03 10:47:23,395 - num_hidden_layers: 3
2024-01-03 10:47:23,395 - max_position_embeddings: 512
2024-01-03 10:47:23,395 - position_embedding_type: absolute
2024-01-03 10:47:23,395 - batch_first: True
2024-01-03 10:47:23,395 - hidden_dims: 768
2024-01-03 10:47:23,395 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-03 10:47:23,395 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-03 10:47:23,395 - ta_loss: 0.02
2024-01-03 10:47:23,395 - tv_loss: 0.03
2024-01-03 10:47:23,395 - av_loss: 0.03
2024-01-03 10:47:23,395 - aligned_method: conv1d
2024-01-03 10:47:23,395 - grad_clip: -1
2024-01-03 10:47:23,395 - num_train_epochs: 100
2024-01-03 10:47:23,395 - warmup_proportion: 0.1
2024-01-03 10:47:23,395 - lr: 1e-06
2024-01-03 10:47:23,395 - weight_decay: 0.02
2024-01-03 10:47:23,396 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2024-01-03-10-47-23
2024-01-03 10:47:23,396 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2024-01-03-10-47-23/models
2024-01-03 10:47:23,396 - ============================== End Params ==============================
2024-01-03 10:47:23,530 - Generate Text Features Begin...
2024-01-03 10:47:24,267 - Generate Text Features Finished...
2024-01-03 10:47:24,268 - Load Video Features Begin...
2024-01-03 10:47:31,404 - Load Video Features Finished...
2024-01-03 10:47:32,071 - Load Audio Features Begin...
2024-01-03 10:47:47,800 - Load Audio Features Finished...
2024-01-03 10:47:51,927 - method  begins...
2024-01-03 10:47:59,753 - Multimodal intent recognition begins...
2024-01-03 10:47:59,754 - Training begins...
2024-01-03 10:48:26,416 - ***** Epoch: 1: Eval results *****
2024-01-03 10:48:26,417 -   train_loss = 4.0614
2024-01-03 10:48:26,417 -   best_eval_score = 0.0
2024-01-03 10:48:26,417 -   eval_score = 0.0299
2024-01-03 10:48:50,446 - ***** Epoch: 2: Eval results *****
2024-01-03 10:48:50,446 -   train_loss = 3.6841
2024-01-03 10:48:50,446 -   best_eval_score = 0.0299
2024-01-03 10:48:50,446 -   eval_score = 0.0493
2024-01-03 10:49:14,636 - ***** Epoch: 3: Eval results *****
2024-01-03 10:49:14,637 -   train_loss = 3.3827
2024-01-03 10:49:14,637 -   best_eval_score = 0.0493
2024-01-03 10:49:14,637 -   eval_score = 0.0428
2024-01-03 10:49:14,637 - EarlyStopping counter: 1 out of 8
2024-01-03 10:49:39,532 - ***** Epoch: 4: Eval results *****
2024-01-03 10:49:39,543 -   train_loss = 3.1496
2024-01-03 10:49:39,543 -   best_eval_score = 0.0493
2024-01-03 10:49:39,543 -   eval_score = 0.1386
2024-01-03 10:50:04,309 - ***** Epoch: 5: Eval results *****
2024-01-03 10:50:04,310 -   train_loss = 2.9302
2024-01-03 10:50:04,310 -   best_eval_score = 0.1386
2024-01-03 10:50:04,310 -   eval_score = 0.1379
2024-01-03 10:50:04,310 - EarlyStopping counter: 1 out of 8
2024-01-03 10:50:28,774 - ***** Epoch: 6: Eval results *****
2024-01-03 10:50:28,774 -   train_loss = 2.613
2024-01-03 10:50:28,774 -   best_eval_score = 0.1386
2024-01-03 10:50:28,774 -   eval_score = 0.3202
2024-01-03 10:50:53,031 - ***** Epoch: 7: Eval results *****
2024-01-03 10:50:53,031 -   train_loss = 2.2319
2024-01-03 10:50:53,031 -   best_eval_score = 0.3202
2024-01-03 10:50:53,031 -   eval_score = 0.3772
2024-01-03 10:51:16,766 - ***** Epoch: 8: Eval results *****
2024-01-03 10:51:16,766 -   train_loss = 1.8988
2024-01-03 10:51:16,766 -   best_eval_score = 0.3772
2024-01-03 10:51:16,766 -   eval_score = 0.4227
2024-01-03 10:51:40,429 - ***** Epoch: 9: Eval results *****
2024-01-03 10:51:40,429 -   train_loss = 1.6934
2024-01-03 10:51:40,429 -   best_eval_score = 0.4227
2024-01-03 10:51:40,429 -   eval_score = 0.4446
2024-01-03 10:52:04,845 - ***** Epoch: 10: Eval results *****
2024-01-03 10:52:04,853 -   train_loss = 1.4545
2024-01-03 10:52:04,854 -   best_eval_score = 0.4446
2024-01-03 10:52:04,854 -   eval_score = 0.4287
2024-01-03 10:52:04,854 - EarlyStopping counter: 1 out of 8
2024-01-03 10:52:31,169 - ***** Epoch: 11: Eval results *****
2024-01-03 10:52:31,169 -   train_loss = 1.276
2024-01-03 10:52:31,169 -   best_eval_score = 0.4446
2024-01-03 10:52:31,169 -   eval_score = 0.5504
2024-01-03 10:52:54,680 - ***** Epoch: 12: Eval results *****
2024-01-03 10:52:54,680 -   train_loss = 1.1083
2024-01-03 10:52:54,680 -   best_eval_score = 0.5504
2024-01-03 10:52:54,680 -   eval_score = 0.5803
2024-01-03 10:53:18,479 - ***** Epoch: 13: Eval results *****
2024-01-03 10:53:18,479 -   train_loss = 0.8102
2024-01-03 10:53:18,479 -   best_eval_score = 0.5803
2024-01-03 10:53:18,479 -   eval_score = 0.5974
2024-01-03 10:53:42,080 - ***** Epoch: 14: Eval results *****
2024-01-03 10:53:42,080 -   train_loss = 0.6648
2024-01-03 10:53:42,080 -   best_eval_score = 0.5974
2024-01-03 10:53:42,080 -   eval_score = 0.6326
2024-01-03 10:54:05,078 - ***** Epoch: 15: Eval results *****
2024-01-03 10:54:05,079 -   train_loss = 0.5508
2024-01-03 10:54:05,079 -   best_eval_score = 0.6326
2024-01-03 10:54:05,079 -   eval_score = 0.6136
2024-01-03 10:54:05,079 - EarlyStopping counter: 1 out of 8
2024-01-03 10:54:30,634 - ***** Epoch: 16: Eval results *****
2024-01-03 10:54:30,635 -   train_loss = 0.4102
2024-01-03 10:54:30,635 -   best_eval_score = 0.6326
2024-01-03 10:54:30,635 -   eval_score = 0.6306
2024-01-03 10:54:30,635 - EarlyStopping counter: 2 out of 8
2024-01-03 10:54:55,573 - ***** Epoch: 17: Eval results *****
2024-01-03 10:54:55,573 -   train_loss = 0.3516
2024-01-03 10:54:55,573 -   best_eval_score = 0.6326
2024-01-03 10:54:55,573 -   eval_score = 0.6536
2024-01-03 10:55:20,159 - ***** Epoch: 18: Eval results *****
2024-01-03 10:55:20,159 -   train_loss = 0.2605
2024-01-03 10:55:20,159 -   best_eval_score = 0.6536
2024-01-03 10:55:20,159 -   eval_score = 0.6478
2024-01-03 10:55:20,159 - EarlyStopping counter: 1 out of 8
2024-01-03 10:55:45,140 - ***** Epoch: 19: Eval results *****
2024-01-03 10:55:45,140 -   train_loss = 0.2213
2024-01-03 10:55:45,140 -   best_eval_score = 0.6536
2024-01-03 10:55:45,141 -   eval_score = 0.6392
2024-01-03 10:55:45,141 - EarlyStopping counter: 2 out of 8
2024-01-03 10:56:08,646 - ***** Epoch: 20: Eval results *****
2024-01-03 10:56:08,646 -   train_loss = 0.1764
2024-01-03 10:56:08,646 -   best_eval_score = 0.6536
2024-01-03 10:56:08,646 -   eval_score = 0.6636
2024-01-03 10:56:32,410 - ***** Epoch: 21: Eval results *****
2024-01-03 10:56:32,410 -   train_loss = 0.1486
2024-01-03 10:56:32,410 -   best_eval_score = 0.6636
2024-01-03 10:56:32,410 -   eval_score = 0.6735
2024-01-03 10:56:56,279 - ***** Epoch: 22: Eval results *****
2024-01-03 10:56:56,280 -   train_loss = 0.1153
2024-01-03 10:56:56,280 -   best_eval_score = 0.6735
2024-01-03 10:56:56,280 -   eval_score = 0.6491
2024-01-03 10:56:56,280 - EarlyStopping counter: 1 out of 8
2024-01-03 10:57:22,320 - ***** Epoch: 23: Eval results *****
2024-01-03 10:57:22,320 -   train_loss = 0.1003
2024-01-03 10:57:22,320 -   best_eval_score = 0.6735
2024-01-03 10:57:22,320 -   eval_score = 0.6361
2024-01-03 10:57:22,320 - EarlyStopping counter: 2 out of 8
2024-01-03 10:57:49,680 - ***** Epoch: 24: Eval results *****
2024-01-03 10:57:49,680 -   train_loss = 0.0921
2024-01-03 10:57:49,681 -   best_eval_score = 0.6735
2024-01-03 10:57:49,681 -   eval_score = 0.6529
2024-01-03 10:57:49,681 - EarlyStopping counter: 3 out of 8
2024-01-03 10:58:15,868 - ***** Epoch: 25: Eval results *****
2024-01-03 10:58:15,868 -   train_loss = 0.08
2024-01-03 10:58:15,868 -   best_eval_score = 0.6735
2024-01-03 10:58:15,868 -   eval_score = 0.6613
2024-01-03 10:58:15,868 - EarlyStopping counter: 4 out of 8
2024-01-03 10:58:40,488 - ***** Epoch: 26: Eval results *****
2024-01-03 10:58:40,489 -   train_loss = 0.0688
2024-01-03 10:58:40,489 -   best_eval_score = 0.6735
2024-01-03 10:58:40,489 -   eval_score = 0.6602
2024-01-03 10:58:40,489 - EarlyStopping counter: 5 out of 8
2024-01-03 10:59:05,556 - ***** Epoch: 27: Eval results *****
2024-01-03 10:59:05,556 -   train_loss = 0.056
2024-01-03 10:59:05,556 -   best_eval_score = 0.6735
2024-01-03 10:59:05,556 -   eval_score = 0.6626
2024-01-03 10:59:05,556 - EarlyStopping counter: 6 out of 8
2024-01-03 10:59:30,338 - ***** Epoch: 28: Eval results *****
2024-01-03 10:59:30,338 -   train_loss = 0.0568
2024-01-03 10:59:30,338 -   best_eval_score = 0.6735
2024-01-03 10:59:30,338 -   eval_score = 0.6529
2024-01-03 10:59:30,338 - EarlyStopping counter: 7 out of 8
2024-01-03 10:59:56,938 - ***** Epoch: 29: Eval results *****
2024-01-03 10:59:56,938 -   train_loss = 0.0484
2024-01-03 10:59:56,938 -   best_eval_score = 0.6735
2024-01-03 10:59:56,938 -   eval_score = 0.6474
2024-01-03 10:59:56,938 - EarlyStopping counter: 8 out of 8
2024-01-03 10:59:56,938 - EarlyStopping at epoch 29
2024-01-03 10:59:56,940 - Training is finished...
2024-01-03 10:59:56,940 - Testing begins...
2024-01-03 11:00:01,727 - ***** Test: Confusion Matrix *****
2024-01-03 11:00:01,728 - [[26  1  0  0 11  0  2  2  3  4  1  1  4  2  0  0  0  0  0  0]
 [ 0 36  0  2  0  0  0  0  1  0  1  0  2  1  0  0  0  0  0  0]
 [ 0  0 25  1  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0 12  0  3  0  1  0  1  1  0  1  1  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  2  0  3  0  5  0  0  0  1  0  0  0  0  0  0  1]
 [ 3  0  0  0  0  0  1  4  1  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  1  2  2  0  0  0  0  2  0  1  1  0  0  0]
 [ 1  0  0  0  0  0  0  0  1  3  0  0  0  0  0  3  1  1  0  0]
 [ 0  1  0  0  0  0  0  0  0  0 16  0  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 19  0  0  0  0  0  0  0  0]
 [ 1  2  0  1  1  1  1  1  3  0  0  0 30  3  4  1  5  0  1  2]
 [ 0  0  0  1  0  0  1  0  0  0  1  1  0 18  1  0  0  0  0  2]
 [ 0  0  0  0  1  0  0  0  1  0  0  0  0  4 12  0  2  0  0  2]
 [ 0  1  0  1  1  0  0  1  1  0  0  0  2  0  1 12  0  0  0  1]
 [ 2  0  0  0  0  0  0  0  0  0  0  0  2  0  2  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  1  1  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  1  0  0  7]]
2024-01-03 11:00:01,728 - ***** Evaluation results *****
2024-01-03 11:00:01,728 -   acc = 0.6562
2024-01-03 11:00:01,728 -   f1 = 0.6287
2024-01-03 11:00:01,729 -   prec = 0.6284
2024-01-03 11:00:01,729 -   rec = 0.6445
2024-01-03 11:00:01,729 - Testing is finished...
2024-01-03 11:00:01,729 - Multimodal intent recognition is finished...
2024-01-03 11:00:01,729 - Results are saved in results/msz.csv
