2024-01-17 10:31:09,824 - ============================== Params ==============================
2024-01-17 10:31:09,825 - logger_name: msz_MIntRec_multi-class_seed-1_2024-01-17-10-31-09
2024-01-17 10:31:09,825 - dataset: MIntRec
2024-01-17 10:31:09,825 - data_mode: multi-class
2024-01-17 10:31:09,825 - method: msz
2024-01-17 10:31:09,825 - text_backbone: bert-base-uncased
2024-01-17 10:31:09,825 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-17 10:31:09,825 - seed: 1
2024-01-17 10:31:09,825 - num_workers: 8
2024-01-17 10:31:09,825 - gpu_id: 1
2024-01-17 10:31:09,825 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-17 10:31:09,825 - train: True
2024-01-17 10:31:09,825 - tune: False
2024-01-17 10:31:09,825 - save_model: False
2024-01-17 10:31:09,825 - save_results: True
2024-01-17 10:31:09,825 - log_path: logs
2024-01-17 10:31:09,825 - cache_path: 
2024-01-17 10:31:09,825 - video_data_path: video_data
2024-01-17 10:31:09,825 - audio_data_path: audio_data
2024-01-17 10:31:09,825 - video_feats_path: video_feats.pkl
2024-01-17 10:31:09,825 - audio_feats_path: audio_feats.pkl
2024-01-17 10:31:09,825 - results_path: results
2024-01-17 10:31:09,825 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-17 10:31:09,825 - model_path: models
2024-01-17 10:31:09,825 - config_file_name: msz
2024-01-17 10:31:09,825 - results_file_name: msz.csv
2024-01-17 10:31:09,825 - padding_mode: zero
2024-01-17 10:31:09,825 - padding_loc: end
2024-01-17 10:31:09,825 - need_aligned: False
2024-01-17 10:31:09,825 - eval_monitor: f1
2024-01-17 10:31:09,825 - train_batch_size: 16
2024-01-17 10:31:09,825 - eval_batch_size: 8
2024-01-17 10:31:09,825 - test_batch_size: 8
2024-01-17 10:31:09,825 - wait_patience: 8
2024-01-17 10:31:09,825 - hidden_size: 768
2024-01-17 10:31:09,825 - num_attention_heads: 12
2024-01-17 10:31:09,826 - attention_probs_dropout_prob: 0.2
2024-01-17 10:31:09,826 - hidden_dropout_prob: 0.2
2024-01-17 10:31:09,826 - intermediate_size: 768
2024-01-17 10:31:09,826 - num_hidden_layers: 8
2024-01-17 10:31:09,826 - max_position_embeddings: 768
2024-01-17 10:31:09,826 - position_embedding_type: absolute
2024-01-17 10:31:09,826 - batch_first: True
2024-01-17 10:31:09,826 - hidden_dims: 768
2024-01-17 10:31:09,826 - dropout: 0.1
2024-01-17 10:31:09,826 - aligned_method: conv1d
2024-01-17 10:31:09,826 - num_train_epochs: 100
2024-01-17 10:31:09,826 - lr: 4e-06
2024-01-17 10:31:09,826 - scale: 64
2024-01-17 10:31:09,826 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-17-10-31-09
2024-01-17 10:31:09,826 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-17-10-31-09/models
2024-01-17 10:31:09,826 - ============================== End Params ==============================
2024-01-17 10:31:09,828 - Generate Text Features Begin...
2024-01-17 10:31:10,427 - Generate Text Features Finished...
2024-01-17 10:31:10,428 - Load Video Features Begin...
2024-01-17 10:31:10,854 - Load Video Features Finished...
2024-01-17 10:31:11,768 - Load Audio Features Begin...
2024-01-17 10:31:14,575 - Load Audio Features Finished...
2024-01-17 10:31:20,104 - method  begins...
2024-01-17 10:31:27,792 - Multimodal intent recognition begins...
2024-01-17 10:31:27,792 - Training begins...
2024-01-17 10:32:09,114 - ***** Epoch: 1: Eval results *****
2024-01-17 10:32:09,116 -   train_loss = 2.3554
2024-01-17 10:32:09,116 -   best_eval_score = 0.0
2024-01-17 10:32:09,116 -   eval_score = 0.4772
2024-01-17 10:32:45,330 - ***** Epoch: 2: Eval results *****
2024-01-17 10:32:45,330 -   train_loss = 1.0905
2024-01-17 10:32:45,330 -   best_eval_score = 0.4772
2024-01-17 10:32:45,330 -   eval_score = 0.5789
2024-01-17 10:33:19,692 - ***** Epoch: 3: Eval results *****
2024-01-17 10:33:19,693 -   train_loss = 0.6818
2024-01-17 10:33:19,693 -   best_eval_score = 0.5789
2024-01-17 10:33:19,693 -   eval_score = 0.5816
2024-01-17 10:33:56,999 - ***** Epoch: 4: Eval results *****
2024-01-17 10:33:56,999 -   train_loss = 0.4295
2024-01-17 10:33:56,999 -   best_eval_score = 0.5816
2024-01-17 10:33:56,999 -   eval_score = 0.6122
2024-01-17 10:34:32,533 - ***** Epoch: 5: Eval results *****
2024-01-17 10:34:32,533 -   train_loss = 0.2487
2024-01-17 10:34:32,533 -   best_eval_score = 0.6122
2024-01-17 10:34:32,533 -   eval_score = 0.6461
2024-01-17 10:35:09,510 - ***** Epoch: 6: Eval results *****
2024-01-17 10:35:09,510 -   train_loss = 0.1431
2024-01-17 10:35:09,510 -   best_eval_score = 0.6461
2024-01-17 10:35:09,510 -   eval_score = 0.6566
2024-01-17 10:35:47,195 - ***** Epoch: 7: Eval results *****
2024-01-17 10:35:47,195 -   train_loss = 0.1009
2024-01-17 10:35:47,195 -   best_eval_score = 0.6566
2024-01-17 10:35:47,195 -   eval_score = 0.642
2024-01-17 10:35:47,195 - EarlyStopping counter: 1 out of 8
2024-01-17 10:36:22,868 - ***** Epoch: 8: Eval results *****
2024-01-17 10:36:22,868 -   train_loss = 0.0638
2024-01-17 10:36:22,868 -   best_eval_score = 0.6566
2024-01-17 10:36:22,868 -   eval_score = 0.6456
2024-01-17 10:36:22,869 - EarlyStopping counter: 2 out of 8
2024-01-17 10:36:59,244 - ***** Epoch: 9: Eval results *****
2024-01-17 10:36:59,244 -   train_loss = 0.0571
2024-01-17 10:36:59,244 -   best_eval_score = 0.6566
2024-01-17 10:36:59,244 -   eval_score = 0.6334
2024-01-17 10:36:59,244 - EarlyStopping counter: 3 out of 8
2024-01-17 10:37:34,592 - ***** Epoch: 10: Eval results *****
2024-01-17 10:37:34,592 -   train_loss = 0.0365
2024-01-17 10:37:34,592 -   best_eval_score = 0.6566
2024-01-17 10:37:34,592 -   eval_score = 0.6587
2024-01-17 10:38:10,573 - ***** Epoch: 11: Eval results *****
2024-01-17 10:38:10,573 -   train_loss = 0.0283
2024-01-17 10:38:10,573 -   best_eval_score = 0.6587
2024-01-17 10:38:10,574 -   eval_score = 0.6628
2024-01-17 10:38:47,964 - ***** Epoch: 12: Eval results *****
2024-01-17 10:38:47,965 -   train_loss = 0.0262
2024-01-17 10:38:47,965 -   best_eval_score = 0.6628
2024-01-17 10:38:47,965 -   eval_score = 0.6549
2024-01-17 10:38:47,965 - EarlyStopping counter: 1 out of 8
2024-01-17 10:39:24,158 - ***** Epoch: 13: Eval results *****
2024-01-17 10:39:24,158 -   train_loss = 0.0202
2024-01-17 10:39:24,158 -   best_eval_score = 0.6628
2024-01-17 10:39:24,158 -   eval_score = 0.6598
2024-01-17 10:39:24,158 - EarlyStopping counter: 2 out of 8
2024-01-17 10:40:01,572 - ***** Epoch: 14: Eval results *****
2024-01-17 10:40:01,572 -   train_loss = 0.0209
2024-01-17 10:40:01,572 -   best_eval_score = 0.6628
2024-01-17 10:40:01,572 -   eval_score = 0.6571
2024-01-17 10:40:01,573 - EarlyStopping counter: 3 out of 8
2024-01-17 10:40:38,884 - ***** Epoch: 15: Eval results *****
2024-01-17 10:40:38,885 -   train_loss = 0.0211
2024-01-17 10:40:38,885 -   best_eval_score = 0.6628
2024-01-17 10:40:38,885 -   eval_score = 0.663
2024-01-17 10:41:14,617 - ***** Epoch: 16: Eval results *****
2024-01-17 10:41:14,618 -   train_loss = 0.0202
2024-01-17 10:41:14,618 -   best_eval_score = 0.663
2024-01-17 10:41:14,618 -   eval_score = 0.6622
2024-01-17 10:41:14,618 - EarlyStopping counter: 1 out of 8
2024-01-17 10:41:51,512 - ***** Epoch: 17: Eval results *****
2024-01-17 10:41:51,512 -   train_loss = 0.0192
2024-01-17 10:41:51,512 -   best_eval_score = 0.663
2024-01-17 10:41:51,513 -   eval_score = 0.6645
2024-01-17 10:42:27,784 - ***** Epoch: 18: Eval results *****
2024-01-17 10:42:27,784 -   train_loss = 0.0191
2024-01-17 10:42:27,784 -   best_eval_score = 0.6645
2024-01-17 10:42:27,785 -   eval_score = 0.6667
2024-01-17 10:43:04,349 - ***** Epoch: 19: Eval results *****
2024-01-17 10:43:04,350 -   train_loss = 0.0199
2024-01-17 10:43:04,350 -   best_eval_score = 0.6667
2024-01-17 10:43:04,350 -   eval_score = 0.6646
2024-01-17 10:43:04,350 - EarlyStopping counter: 1 out of 8
2024-01-17 10:43:41,090 - ***** Epoch: 20: Eval results *****
2024-01-17 10:43:41,091 -   train_loss = 0.0177
2024-01-17 10:43:41,091 -   best_eval_score = 0.6667
2024-01-17 10:43:41,091 -   eval_score = 0.6646
2024-01-17 10:43:41,091 - EarlyStopping counter: 2 out of 8
2024-01-17 10:44:16,453 - ***** Epoch: 21: Eval results *****
2024-01-17 10:44:16,454 -   train_loss = 0.0164
2024-01-17 10:44:16,454 -   best_eval_score = 0.6667
2024-01-17 10:44:16,454 -   eval_score = 0.6646
2024-01-17 10:44:16,454 - EarlyStopping counter: 3 out of 8
2024-01-17 10:44:53,093 - ***** Epoch: 22: Eval results *****
2024-01-17 10:44:53,093 -   train_loss = 0.0152
2024-01-17 10:44:53,093 -   best_eval_score = 0.6667
2024-01-17 10:44:53,093 -   eval_score = 0.6679
2024-01-17 10:45:28,984 - ***** Epoch: 23: Eval results *****
2024-01-17 10:45:28,985 -   train_loss = 0.016
2024-01-17 10:45:28,985 -   best_eval_score = 0.6679
2024-01-17 10:45:28,985 -   eval_score = 0.6679
2024-01-17 10:45:28,985 - EarlyStopping counter: 1 out of 8
2024-01-17 10:46:05,260 - ***** Epoch: 24: Eval results *****
2024-01-17 10:46:05,260 -   train_loss = 0.0162
2024-01-17 10:46:05,260 -   best_eval_score = 0.6679
2024-01-17 10:46:05,260 -   eval_score = 0.6679
2024-01-17 10:46:05,260 - EarlyStopping counter: 2 out of 8
2024-01-17 10:46:41,750 - ***** Epoch: 25: Eval results *****
2024-01-17 10:46:41,751 -   train_loss = 0.0191
2024-01-17 10:46:41,751 -   best_eval_score = 0.6679
2024-01-17 10:46:41,751 -   eval_score = 0.6677
2024-01-17 10:46:41,751 - EarlyStopping counter: 3 out of 8
2024-01-17 10:47:18,327 - ***** Epoch: 26: Eval results *****
2024-01-17 10:47:18,328 -   train_loss = 0.0174
2024-01-17 10:47:18,328 -   best_eval_score = 0.6679
2024-01-17 10:47:18,328 -   eval_score = 0.6666
2024-01-17 10:47:18,328 - EarlyStopping counter: 4 out of 8
2024-01-17 10:47:55,142 - ***** Epoch: 27: Eval results *****
2024-01-17 10:47:55,142 -   train_loss = 0.0193
2024-01-17 10:47:55,142 -   best_eval_score = 0.6679
2024-01-17 10:47:55,142 -   eval_score = 0.6666
2024-01-17 10:47:55,142 - EarlyStopping counter: 5 out of 8
2024-01-17 10:48:31,037 - ***** Epoch: 28: Eval results *****
2024-01-17 10:48:31,038 -   train_loss = 0.0166
2024-01-17 10:48:31,038 -   best_eval_score = 0.6679
2024-01-17 10:48:31,038 -   eval_score = 0.6666
2024-01-17 10:48:31,038 - EarlyStopping counter: 6 out of 8
2024-01-17 10:49:07,376 - ***** Epoch: 29: Eval results *****
2024-01-17 10:49:07,376 -   train_loss = 0.0173
2024-01-17 10:49:07,377 -   best_eval_score = 0.6679
2024-01-17 10:49:07,377 -   eval_score = 0.6666
2024-01-17 10:49:07,377 - EarlyStopping counter: 7 out of 8
2024-01-17 10:49:44,688 - ***** Epoch: 30: Eval results *****
2024-01-17 10:49:44,689 -   train_loss = 0.0151
2024-01-17 10:49:44,689 -   best_eval_score = 0.6679
2024-01-17 10:49:44,689 -   eval_score = 0.6666
2024-01-17 10:49:44,689 - EarlyStopping counter: 8 out of 8
2024-01-17 10:49:44,689 - EarlyStopping at epoch 30
2024-01-17 10:49:44,694 - Training is finished...
2024-01-17 10:49:44,695 - Testing begins...
2024-01-17 10:49:50,299 - ***** Test: Confusion Matrix *****
2024-01-17 10:49:50,301 - [[36  3  0  0  9  0  1  0  1  1  1  0  4  1  0  0  0  0  0  0]
 [ 1 33  0  1  0  2  1  0  0  0  1  0  4  0  0  0  0  0  0  0]
 [ 1  0 24  0  0  0  1  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 0  1  1 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 7  0  1  0  9  0  1  0  0  0  0  1  1  2  0  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 2  1  0  0  3  0  2  0  1  0  0  0  1  0  0  1  1  0  0  0]
 [ 4  0  0  0  0  0  0  4  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  1  1  4  0  0  0  1  0  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  1  0  0  4  0  0  0  0  0  2  0  2  0  0]
 [ 1  0  0  0  0  0  0  0  0  1 14  0  1  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  2  0  0  0  0 16  0  0  0  0  0  0  0  1]
 [ 3  3  0  0  1  0  0  0  0  0  0  1 41  1  2  3  1  0  0  1]
 [ 0  0  0  0  1  0  1  0  0  0  1  1  0 19  1  0  1  0  0  0]
 [ 0  0  0  0  1  0  0  0  1  0  0  0  2  3 13  0  1  0  0  1]
 [ 0  2  0  0  0  0  0  0  0  0  0  0  8  0  0 11  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  1  0  0  2  0  1  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  2  0  3  0  0  1  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  2  0  0  8  0]
 [ 1  0  1  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  7]]
2024-01-17 10:49:50,301 - ***** Evaluation results *****
2024-01-17 10:49:50,301 -   acc = 0.6719
2024-01-17 10:49:50,301 -   f1 = 0.6508
2024-01-17 10:49:50,301 -   prec = 0.6822
2024-01-17 10:49:50,301 -   rec = 0.6351
2024-01-17 10:49:50,302 - Testing is finished...
2024-01-17 10:49:50,302 - Multimodal intent recognition is finished...
2024-01-17 10:49:50,302 - Results are saved in results/msz.csv
