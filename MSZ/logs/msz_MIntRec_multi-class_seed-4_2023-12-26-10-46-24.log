2023-12-26 10:46:24,314 - ============================== Params ==============================
2023-12-26 10:46:24,314 - logger_name: msz_MIntRec_multi-class_seed-4_2023-12-26-10-46-24
2023-12-26 10:46:24,314 - dataset: MIntRec
2023-12-26 10:46:24,314 - data_mode: multi-class
2023-12-26 10:46:24,314 - method: msz
2023-12-26 10:46:24,314 - text_backbone: bert-base-uncased
2023-12-26 10:46:24,315 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-26 10:46:24,315 - seed: 4
2023-12-26 10:46:24,315 - num_workers: 8
2023-12-26 10:46:24,315 - gpu_id: 3
2023-12-26 10:46:24,315 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-26 10:46:24,315 - train: True
2023-12-26 10:46:24,315 - tune: False
2023-12-26 10:46:24,315 - save_model: False
2023-12-26 10:46:24,316 - save_results: True
2023-12-26 10:46:24,316 - log_path: logs
2023-12-26 10:46:24,316 - cache_path: 
2023-12-26 10:46:24,316 - video_data_path: video_data
2023-12-26 10:46:24,316 - audio_data_path: audio_data
2023-12-26 10:46:24,316 - video_feats_path: video_feats.pkl
2023-12-26 10:46:24,316 - audio_feats_path: audio_feats.pkl
2023-12-26 10:46:24,317 - results_path: results
2023-12-26 10:46:24,317 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-26 10:46:24,317 - model_path: models
2023-12-26 10:46:24,317 - config_file_name: msz
2023-12-26 10:46:24,317 - results_file_name: msz.csv
2023-12-26 10:46:24,317 - padding_mode: zero
2023-12-26 10:46:24,317 - padding_loc: end
2023-12-26 10:46:24,317 - need_aligned: False
2023-12-26 10:46:24,318 - eval_monitor: f1
2023-12-26 10:46:24,318 - train_batch_size: 16
2023-12-26 10:46:24,318 - eval_batch_size: 8
2023-12-26 10:46:24,318 - test_batch_size: 8
2023-12-26 10:46:24,318 - wait_patience: 8
2023-12-26 10:46:24,318 - nheads: 2
2023-12-26 10:46:24,318 - encoder_layers: 2
2023-12-26 10:46:24,318 - attn_dropout: 0.1
2023-12-26 10:46:24,319 - relu_dropout: 0.1
2023-12-26 10:46:24,319 - embed_dropout: 0.1
2023-12-26 10:46:24,319 - res_dropout: 0.1
2023-12-26 10:46:24,319 - attn_mask: False
2023-12-26 10:46:24,319 - hidden_size: 768
2023-12-26 10:46:24,319 - num_attention_heads: 12
2023-12-26 10:46:24,319 - attention_probs_dropout_prob: 0.2
2023-12-26 10:46:24,319 - hidden_dropout_prob: 0.2
2023-12-26 10:46:24,320 - intermediate_size: 768
2023-12-26 10:46:24,320 - num_hidden_layers: 3
2023-12-26 10:46:24,320 - max_position_embeddings: 512
2023-12-26 10:46:24,320 - position_embedding_type: absolute
2023-12-26 10:46:24,320 - add_cross_attention: False
2023-12-26 10:46:24,320 - batch_first: True
2023-12-26 10:46:24,320 - hidden_dims: 768
2023-12-26 10:46:24,321 - att_dropouts: [0.1, 0.1, 0.1]
2023-12-26 10:46:24,321 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-26 10:46:24,321 - tv_c_loss: 0.01
2023-12-26 10:46:24,321 - vt_c_loss: 0.05
2023-12-26 10:46:24,321 - at_c_loss: 0.02
2023-12-26 10:46:24,321 - aligned_method: conv1d
2023-12-26 10:46:24,321 - num_train_epochs: 100
2023-12-26 10:46:24,321 - warmup_proportion: 0.1
2023-12-26 10:46:24,322 - lr: 3e-06
2023-12-26 10:46:24,322 - weight_decay: 0.01
2023-12-26 10:46:24,322 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2023-12-26-10-46-24
2023-12-26 10:46:24,322 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2023-12-26-10-46-24/models
2023-12-26 10:46:24,322 - ============================== End Params ==============================
2023-12-26 10:46:24,509 - Generate Text Features Begin...
2023-12-26 10:46:25,113 - Generate Text Features Finished...
2023-12-26 10:46:25,114 - Load Video Features Begin...
2023-12-26 10:46:37,416 - Load Video Features Finished...
2023-12-26 10:46:38,331 - Load Audio Features Begin...
2023-12-26 10:46:43,314 - Load Audio Features Finished...
2023-12-26 10:46:48,613 - method  begins...
2023-12-26 10:46:54,061 - Multimodal intent recognition begins...
2023-12-26 10:46:54,061 - Training begins...
2023-12-26 10:47:34,939 - ***** Epoch: 1: Eval results *****
2023-12-26 10:47:34,940 -   train_loss = 3.7269
2023-12-26 10:47:34,940 -   best_eval_score = 0.0
2023-12-26 10:47:34,940 -   eval_score = 0.0236
2023-12-26 10:48:10,500 - ***** Epoch: 2: Eval results *****
2023-12-26 10:48:10,500 -   train_loss = 3.3134
2023-12-26 10:48:10,501 -   best_eval_score = 0.0236
2023-12-26 10:48:10,501 -   eval_score = 0.0304
2023-12-26 10:48:48,654 - ***** Epoch: 3: Eval results *****
2023-12-26 10:48:48,655 -   train_loss = 2.9992
2023-12-26 10:48:48,655 -   best_eval_score = 0.0304
2023-12-26 10:48:48,656 -   eval_score = 0.1152
2023-12-26 10:49:27,420 - ***** Epoch: 4: Eval results *****
2023-12-26 10:49:27,420 -   train_loss = 2.5859
2023-12-26 10:49:27,420 -   best_eval_score = 0.1152
2023-12-26 10:49:27,421 -   eval_score = 0.2639
2023-12-26 10:49:56,647 - ***** Epoch: 5: Eval results *****
2023-12-26 10:49:56,647 -   train_loss = 2.0074
2023-12-26 10:49:56,648 -   best_eval_score = 0.2639
2023-12-26 10:49:56,648 -   eval_score = 0.4236
2023-12-26 10:50:36,086 - ***** Epoch: 6: Eval results *****
2023-12-26 10:50:36,087 -   train_loss = 1.5921
2023-12-26 10:50:36,087 -   best_eval_score = 0.4236
2023-12-26 10:50:36,088 -   eval_score = 0.5028
2023-12-26 10:51:19,776 - ***** Epoch: 7: Eval results *****
2023-12-26 10:51:19,777 -   train_loss = 1.3918
2023-12-26 10:51:19,777 -   best_eval_score = 0.5028
2023-12-26 10:51:19,778 -   eval_score = 0.4697
2023-12-26 10:51:19,778 - EarlyStopping counter: 1 out of 8
2023-12-26 10:52:01,591 - ***** Epoch: 8: Eval results *****
2023-12-26 10:52:01,591 -   train_loss = 1.1214
2023-12-26 10:52:01,591 -   best_eval_score = 0.5028
2023-12-26 10:52:01,591 -   eval_score = 0.5037
2023-12-26 10:52:38,411 - ***** Epoch: 9: Eval results *****
2023-12-26 10:52:38,411 -   train_loss = 0.8424
2023-12-26 10:52:38,411 -   best_eval_score = 0.5037
2023-12-26 10:52:38,412 -   eval_score = 0.5493
2023-12-26 10:53:17,574 - ***** Epoch: 10: Eval results *****
2023-12-26 10:53:17,574 -   train_loss = 0.6371
2023-12-26 10:53:17,574 -   best_eval_score = 0.5493
2023-12-26 10:53:17,574 -   eval_score = 0.5809
2023-12-26 10:54:02,442 - ***** Epoch: 11: Eval results *****
2023-12-26 10:54:02,444 -   train_loss = 0.5156
2023-12-26 10:54:02,444 -   best_eval_score = 0.5809
2023-12-26 10:54:02,445 -   eval_score = 0.5722
2023-12-26 10:54:02,446 - EarlyStopping counter: 1 out of 8
2023-12-26 10:54:46,752 - ***** Epoch: 12: Eval results *****
2023-12-26 10:54:46,754 -   train_loss = 0.3367
2023-12-26 10:54:46,755 -   best_eval_score = 0.5809
2023-12-26 10:54:46,755 -   eval_score = 0.559
2023-12-26 10:54:46,756 - EarlyStopping counter: 2 out of 8
2023-12-26 10:55:26,056 - ***** Epoch: 13: Eval results *****
2023-12-26 10:55:26,056 -   train_loss = 0.293
2023-12-26 10:55:26,056 -   best_eval_score = 0.5809
2023-12-26 10:55:26,057 -   eval_score = 0.5651
2023-12-26 10:55:26,057 - EarlyStopping counter: 3 out of 8
2023-12-26 10:56:03,330 - ***** Epoch: 14: Eval results *****
2023-12-26 10:56:03,331 -   train_loss = nan
2023-12-26 10:56:03,331 -   best_eval_score = 0.5809
2023-12-26 10:56:03,331 -   eval_score = 0.0114
2023-12-26 10:56:03,332 - EarlyStopping counter: 4 out of 8
2023-12-26 10:56:41,356 - ***** Epoch: 15: Eval results *****
2023-12-26 10:56:41,357 -   train_loss = nan
2023-12-26 10:56:41,358 -   best_eval_score = 0.5809
2023-12-26 10:56:41,358 -   eval_score = 0.0114
2023-12-26 10:56:41,358 - EarlyStopping counter: 5 out of 8
2023-12-26 10:57:23,422 - ***** Epoch: 16: Eval results *****
2023-12-26 10:57:23,423 -   train_loss = nan
2023-12-26 10:57:23,423 -   best_eval_score = 0.5809
2023-12-26 10:57:23,424 -   eval_score = 0.0114
2023-12-26 10:57:23,424 - EarlyStopping counter: 6 out of 8
2023-12-26 10:58:01,674 - ***** Epoch: 17: Eval results *****
2023-12-26 10:58:01,675 -   train_loss = nan
2023-12-26 10:58:01,676 -   best_eval_score = 0.5809
2023-12-26 10:58:01,676 -   eval_score = 0.0114
2023-12-26 10:58:01,676 - EarlyStopping counter: 7 out of 8
2023-12-26 10:58:37,215 - ***** Epoch: 18: Eval results *****
2023-12-26 10:58:37,217 -   train_loss = nan
2023-12-26 10:58:37,217 -   best_eval_score = 0.5809
2023-12-26 10:58:37,218 -   eval_score = 0.0114
2023-12-26 10:58:37,218 - EarlyStopping counter: 8 out of 8
2023-12-26 10:58:37,218 - EarlyStopping at epoch 18
2023-12-26 10:58:37,221 - Training is finished...
2023-12-26 10:58:37,223 - Testing begins...
2023-12-26 10:58:45,284 - ***** Test: Confusion Matrix *****
2023-12-26 10:58:45,285 - [[33  0  1  0  6  0  1  2  1  2  1  0  9  0  0  1  0  0  0  0]
 [ 1 32  0  0  1  0  1  5  0  0  0  0  1  2  0  0  0  0  0  0]
 [ 0  0 27  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 3  0  0  0 10  0  2  0  0  0  0  3  2  3  0  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  1  1  2  0  0  1  3  1  0  2  0  0  0  0]
 [ 3  0  1  0  0  0  0  5  0  0  0  0  0  0  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  0  6  1  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  0  1  0  0  0  0  0  0  2  0  0  1  0  0  3  1  1  0  0]
 [ 1  0  0  0  0  0  0  0  0  0 14  0  0  2  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 16  1  1  0  0  0  0  0  0]
 [ 3  0  0  0  0  0  0  2  2  0  0  0 40  5  0  2  1  0  1  1]
 [ 2  0  1  0  0  0  0  0  1  0  0  1  1 19  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  4  7  9  0  1  0  0  1]
 [ 0  0  0  0  0  0  0  1  1  0  0  0  3  0  1 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  3  0  0  0 13  0  0  0]
 [ 0  0  1  0  0  0  0  0  0  1  1  0  4  0  0  0  0  8  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  4  0  0  1  0  0  7  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  2  1  0  0  0  0  0  6]]
2023-12-26 10:58:45,286 - ***** Evaluation results *****
2023-12-26 10:58:45,286 -   acc = 0.6607
2023-12-26 10:58:45,287 -   f1 = 0.62
2023-12-26 10:58:45,287 -   prec = 0.6672
2023-12-26 10:58:45,287 -   rec = 0.6122
2023-12-26 10:58:45,288 - Testing is finished...
2023-12-26 10:58:45,288 - Multimodal intent recognition is finished...
2023-12-26 10:58:45,289 - Results are saved in results/msz.csv
