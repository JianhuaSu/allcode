2023-12-28 11:11:09,683 - ============================== Params ==============================
2023-12-28 11:11:09,683 - logger_name: msz_MIntRec_multi-class_seed-3_2023-12-28-11-11-09
2023-12-28 11:11:09,683 - dataset: MIntRec
2023-12-28 11:11:09,683 - data_mode: multi-class
2023-12-28 11:11:09,683 - method: msz
2023-12-28 11:11:09,683 - text_backbone: bert-base-uncased
2023-12-28 11:11:09,683 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-28 11:11:09,683 - seed: 3
2023-12-28 11:11:09,683 - num_workers: 8
2023-12-28 11:11:09,683 - gpu_id: 3
2023-12-28 11:11:09,683 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-28 11:11:09,683 - train: True
2023-12-28 11:11:09,683 - tune: False
2023-12-28 11:11:09,683 - save_model: False
2023-12-28 11:11:09,683 - save_results: True
2023-12-28 11:11:09,683 - log_path: logs
2023-12-28 11:11:09,683 - cache_path: 
2023-12-28 11:11:09,684 - video_data_path: video_data
2023-12-28 11:11:09,684 - audio_data_path: audio_data
2023-12-28 11:11:09,684 - video_feats_path: video_feats.pkl
2023-12-28 11:11:09,684 - audio_feats_path: audio_feats.pkl
2023-12-28 11:11:09,684 - results_path: results
2023-12-28 11:11:09,684 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-28 11:11:09,684 - model_path: models
2023-12-28 11:11:09,684 - config_file_name: msz
2023-12-28 11:11:09,684 - results_file_name: msz.csv
2023-12-28 11:11:09,684 - padding_mode: zero
2023-12-28 11:11:09,684 - padding_loc: end
2023-12-28 11:11:09,684 - need_aligned: False
2023-12-28 11:11:09,684 - eval_monitor: f1
2023-12-28 11:11:09,684 - train_batch_size: 16
2023-12-28 11:11:09,684 - eval_batch_size: 8
2023-12-28 11:11:09,684 - test_batch_size: 8
2023-12-28 11:11:09,684 - wait_patience: 8
2023-12-28 11:11:09,684 - nheads: 2
2023-12-28 11:11:09,684 - encoder_layers: 2
2023-12-28 11:11:09,684 - attn_dropout: 0.1
2023-12-28 11:11:09,684 - relu_dropout: 0.1
2023-12-28 11:11:09,684 - embed_dropout: 0.1
2023-12-28 11:11:09,684 - res_dropout: 0.1
2023-12-28 11:11:09,684 - attn_mask: False
2023-12-28 11:11:09,684 - hidden_size: 768
2023-12-28 11:11:09,684 - num_attention_heads: 12
2023-12-28 11:11:09,684 - attention_probs_dropout_prob: 0.2
2023-12-28 11:11:09,684 - hidden_dropout_prob: 0.2
2023-12-28 11:11:09,684 - intermediate_size: 768
2023-12-28 11:11:09,684 - num_hidden_layers: 3
2023-12-28 11:11:09,684 - max_position_embeddings: 512
2023-12-28 11:11:09,684 - position_embedding_type: absolute
2023-12-28 11:11:09,684 - batch_first: True
2023-12-28 11:11:09,684 - hidden_dims: 768
2023-12-28 11:11:09,684 - att_dropouts: [0.2, 0.2, 0.2]
2023-12-28 11:11:09,684 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-28 11:11:09,684 - ta_loss: 0.01
2023-12-28 11:11:09,684 - tv_loss: 0.01
2023-12-28 11:11:09,685 - av_loss: 0.01
2023-12-28 11:11:09,685 - aligned_method: conv1d
2023-12-28 11:11:09,685 - grad_clip: 2
2023-12-28 11:11:09,685 - num_train_epochs: 100
2023-12-28 11:11:09,685 - warmup_proportion: 0.1
2023-12-28 11:11:09,685 - lr: 1e-06
2023-12-28 11:11:09,685 - weight_decay: 0.02
2023-12-28 11:11:09,685 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2023-12-28-11-11-09
2023-12-28 11:11:09,685 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2023-12-28-11-11-09/models
2023-12-28 11:11:09,685 - ============================== End Params ==============================
2023-12-28 11:11:09,783 - Generate Text Features Begin...
2023-12-28 11:11:10,489 - Generate Text Features Finished...
2023-12-28 11:11:10,490 - Load Video Features Begin...
2023-12-28 11:11:24,613 - Load Video Features Finished...
2023-12-28 11:11:25,272 - Load Audio Features Begin...
2023-12-28 11:11:54,708 - Load Audio Features Finished...
2023-12-28 11:11:59,256 - method  begins...
2023-12-28 11:12:10,773 - Multimodal intent recognition begins...
2023-12-28 11:12:10,774 - Training begins...
2023-12-28 11:12:38,640 - ***** Epoch: 1: Eval results *****
2023-12-28 11:12:38,641 -   train_loss = 3.3867
2023-12-28 11:12:38,641 -   best_eval_score = 0.0
2023-12-28 11:12:38,642 -   eval_score = 0.0144
2023-12-28 11:13:05,932 - ***** Epoch: 2: Eval results *****
2023-12-28 11:13:05,932 -   train_loss = 3.1682
2023-12-28 11:13:05,932 -   best_eval_score = 0.0144
2023-12-28 11:13:05,932 -   eval_score = 0.0168
2023-12-28 11:13:31,097 - ***** Epoch: 3: Eval results *****
2023-12-28 11:13:31,097 -   train_loss = 3.0447
2023-12-28 11:13:31,097 -   best_eval_score = 0.0168
2023-12-28 11:13:31,097 -   eval_score = 0.0233
2023-12-28 11:13:57,700 - ***** Epoch: 4: Eval results *****
2023-12-28 11:13:57,700 -   train_loss = 2.983
2023-12-28 11:13:57,700 -   best_eval_score = 0.0233
2023-12-28 11:13:57,700 -   eval_score = 0.0267
2023-12-28 11:14:24,522 - ***** Epoch: 5: Eval results *****
2023-12-28 11:14:24,522 -   train_loss = 2.9352
2023-12-28 11:14:24,522 -   best_eval_score = 0.0267
2023-12-28 11:14:24,522 -   eval_score = 0.0279
2023-12-28 11:14:49,250 - ***** Epoch: 6: Eval results *****
2023-12-28 11:14:49,250 -   train_loss = 2.8854
2023-12-28 11:14:49,250 -   best_eval_score = 0.0279
2023-12-28 11:14:49,251 -   eval_score = 0.0207
2023-12-28 11:14:49,251 - EarlyStopping counter: 1 out of 8
2023-12-28 11:15:14,012 - ***** Epoch: 7: Eval results *****
2023-12-28 11:15:14,012 -   train_loss = 2.8366
2023-12-28 11:15:14,012 -   best_eval_score = 0.0279
2023-12-28 11:15:14,012 -   eval_score = 0.0417
2023-12-28 11:15:53,156 - ***** Epoch: 8: Eval results *****
2023-12-28 11:15:53,156 -   train_loss = 2.7661
2023-12-28 11:15:53,156 -   best_eval_score = 0.0417
2023-12-28 11:15:53,156 -   eval_score = 0.0791
2023-12-28 11:16:19,155 - ***** Epoch: 9: Eval results *****
2023-12-28 11:16:19,155 -   train_loss = 2.6557
2023-12-28 11:16:19,156 -   best_eval_score = 0.0791
2023-12-28 11:16:19,156 -   eval_score = 0.1327
2023-12-28 11:16:44,282 - ***** Epoch: 10: Eval results *****
2023-12-28 11:16:44,282 -   train_loss = 2.4705
2023-12-28 11:16:44,282 -   best_eval_score = 0.1327
2023-12-28 11:16:44,283 -   eval_score = 0.2556
2023-12-28 11:17:08,663 - ***** Epoch: 11: Eval results *****
2023-12-28 11:17:08,663 -   train_loss = 2.1785
2023-12-28 11:17:08,663 -   best_eval_score = 0.2556
2023-12-28 11:17:08,663 -   eval_score = 0.2606
2023-12-28 11:17:59,674 - ***** Epoch: 12: Eval results *****
2023-12-28 11:17:59,674 -   train_loss = 1.8846
2023-12-28 11:17:59,674 -   best_eval_score = 0.2606
2023-12-28 11:17:59,674 -   eval_score = 0.3324
2023-12-28 11:18:29,608 - ***** Epoch: 13: Eval results *****
2023-12-28 11:18:29,608 -   train_loss = 1.6956
2023-12-28 11:18:29,608 -   best_eval_score = 0.3324
2023-12-28 11:18:29,608 -   eval_score = 0.3651
2023-12-28 11:18:54,000 - ***** Epoch: 14: Eval results *****
2023-12-28 11:18:54,000 -   train_loss = 1.5659
2023-12-28 11:18:54,000 -   best_eval_score = 0.3651
2023-12-28 11:18:54,000 -   eval_score = 0.47
2023-12-28 11:19:19,060 - ***** Epoch: 15: Eval results *****
2023-12-28 11:19:19,060 -   train_loss = 1.348
2023-12-28 11:19:19,060 -   best_eval_score = 0.47
2023-12-28 11:19:19,060 -   eval_score = 0.4358
2023-12-28 11:19:19,060 - EarlyStopping counter: 1 out of 8
2023-12-28 11:20:08,634 - ***** Epoch: 16: Eval results *****
2023-12-28 11:20:08,635 -   train_loss = 1.2363
2023-12-28 11:20:08,635 -   best_eval_score = 0.47
2023-12-28 11:20:08,635 -   eval_score = 0.4955
2023-12-28 11:20:36,063 - ***** Epoch: 17: Eval results *****
2023-12-28 11:20:36,063 -   train_loss = 1.0043
2023-12-28 11:20:36,063 -   best_eval_score = 0.4955
2023-12-28 11:20:36,063 -   eval_score = 0.5265
2023-12-28 11:21:01,350 - ***** Epoch: 18: Eval results *****
2023-12-28 11:21:01,351 -   train_loss = 0.884
2023-12-28 11:21:01,351 -   best_eval_score = 0.5265
2023-12-28 11:21:01,351 -   eval_score = 0.5386
2023-12-28 11:21:27,873 - ***** Epoch: 19: Eval results *****
2023-12-28 11:21:27,874 -   train_loss = 0.7681
2023-12-28 11:21:27,874 -   best_eval_score = 0.5386
2023-12-28 11:21:27,874 -   eval_score = 0.5483
2023-12-28 11:21:53,783 - ***** Epoch: 20: Eval results *****
2023-12-28 11:21:53,783 -   train_loss = 0.5974
2023-12-28 11:21:53,783 -   best_eval_score = 0.5483
2023-12-28 11:21:53,783 -   eval_score = 0.5414
2023-12-28 11:21:53,784 - EarlyStopping counter: 1 out of 8
2023-12-28 11:22:19,250 - ***** Epoch: 21: Eval results *****
2023-12-28 11:22:19,251 -   train_loss = 0.5437
2023-12-28 11:22:19,252 -   best_eval_score = 0.5483
2023-12-28 11:22:19,252 -   eval_score = 0.5757
2023-12-28 11:22:44,108 - ***** Epoch: 22: Eval results *****
2023-12-28 11:22:44,108 -   train_loss = 0.4257
2023-12-28 11:22:44,108 -   best_eval_score = 0.5757
2023-12-28 11:22:44,108 -   eval_score = 0.5773
2023-12-28 11:23:08,903 - ***** Epoch: 23: Eval results *****
2023-12-28 11:23:08,904 -   train_loss = 0.3781
2023-12-28 11:23:08,904 -   best_eval_score = 0.5773
2023-12-28 11:23:08,904 -   eval_score = 0.5897
2023-12-28 11:23:40,411 - ***** Epoch: 24: Eval results *****
2023-12-28 11:23:40,414 -   train_loss = 0.3055
2023-12-28 11:23:40,415 -   best_eval_score = 0.5897
2023-12-28 11:23:40,415 -   eval_score = 0.5972
2023-12-28 11:24:06,550 - ***** Epoch: 25: Eval results *****
2023-12-28 11:24:06,551 -   train_loss = 0.2514
2023-12-28 11:24:06,551 -   best_eval_score = 0.5972
2023-12-28 11:24:06,551 -   eval_score = 0.5934
2023-12-28 11:24:06,551 - EarlyStopping counter: 1 out of 8
2023-12-28 11:24:31,458 - ***** Epoch: 26: Eval results *****
2023-12-28 11:24:31,458 -   train_loss = 0.2287
2023-12-28 11:24:31,458 -   best_eval_score = 0.5972
2023-12-28 11:24:31,458 -   eval_score = 0.5859
2023-12-28 11:24:31,458 - EarlyStopping counter: 2 out of 8
2023-12-28 11:24:55,182 - ***** Epoch: 27: Eval results *****
2023-12-28 11:24:55,182 -   train_loss = 0.2042
2023-12-28 11:24:55,182 -   best_eval_score = 0.5972
2023-12-28 11:24:55,182 -   eval_score = 0.591
2023-12-28 11:24:55,182 - EarlyStopping counter: 3 out of 8
2023-12-28 11:25:25,454 - ***** Epoch: 28: Eval results *****
2023-12-28 11:25:25,455 -   train_loss = 0.1627
2023-12-28 11:25:25,455 -   best_eval_score = 0.5972
2023-12-28 11:25:25,455 -   eval_score = 0.6081
2023-12-28 11:25:49,860 - ***** Epoch: 29: Eval results *****
2023-12-28 11:25:49,861 -   train_loss = 0.1444
2023-12-28 11:25:49,861 -   best_eval_score = 0.6081
2023-12-28 11:25:49,861 -   eval_score = 0.6087
2023-12-28 11:26:20,768 - ***** Epoch: 30: Eval results *****
2023-12-28 11:26:20,768 -   train_loss = 0.1291
2023-12-28 11:26:20,768 -   best_eval_score = 0.6087
2023-12-28 11:26:20,768 -   eval_score = 0.617
2023-12-28 11:26:45,975 - ***** Epoch: 31: Eval results *****
2023-12-28 11:26:45,976 -   train_loss = 0.0967
2023-12-28 11:26:45,976 -   best_eval_score = 0.617
2023-12-28 11:26:45,976 -   eval_score = 0.6083
2023-12-28 11:26:45,976 - EarlyStopping counter: 1 out of 8
2023-12-28 11:27:10,918 - ***** Epoch: 32: Eval results *****
2023-12-28 11:27:10,919 -   train_loss = 0.0791
2023-12-28 11:27:10,919 -   best_eval_score = 0.617
2023-12-28 11:27:10,919 -   eval_score = 0.613
2023-12-28 11:27:10,919 - EarlyStopping counter: 2 out of 8
2023-12-28 11:27:35,259 - ***** Epoch: 33: Eval results *****
2023-12-28 11:27:35,259 -   train_loss = 0.073
2023-12-28 11:27:35,259 -   best_eval_score = 0.617
2023-12-28 11:27:35,259 -   eval_score = 0.6157
2023-12-28 11:27:35,259 - EarlyStopping counter: 3 out of 8
2023-12-28 11:27:59,852 - ***** Epoch: 34: Eval results *****
2023-12-28 11:27:59,852 -   train_loss = 0.0639
2023-12-28 11:27:59,852 -   best_eval_score = 0.617
2023-12-28 11:27:59,852 -   eval_score = 0.6138
2023-12-28 11:27:59,853 - EarlyStopping counter: 4 out of 8
2023-12-28 11:28:25,601 - ***** Epoch: 35: Eval results *****
2023-12-28 11:28:25,601 -   train_loss = 0.051
2023-12-28 11:28:25,601 -   best_eval_score = 0.617
2023-12-28 11:28:25,601 -   eval_score = 0.6187
2023-12-28 11:28:49,599 - ***** Epoch: 36: Eval results *****
2023-12-28 11:28:49,599 -   train_loss = 0.0389
2023-12-28 11:28:49,599 -   best_eval_score = 0.6187
2023-12-28 11:28:49,599 -   eval_score = 0.6179
2023-12-28 11:28:49,599 - EarlyStopping counter: 1 out of 8
2023-12-28 11:29:13,043 - ***** Epoch: 37: Eval results *****
2023-12-28 11:29:13,043 -   train_loss = 0.0349
2023-12-28 11:29:13,043 -   best_eval_score = 0.6187
2023-12-28 11:29:13,043 -   eval_score = 0.6096
2023-12-28 11:29:13,043 - EarlyStopping counter: 2 out of 8
2023-12-28 11:29:36,730 - ***** Epoch: 38: Eval results *****
2023-12-28 11:29:36,730 -   train_loss = 0.0346
2023-12-28 11:29:36,730 -   best_eval_score = 0.6187
2023-12-28 11:29:36,730 -   eval_score = 0.6139
2023-12-28 11:29:36,730 - EarlyStopping counter: 3 out of 8
2023-12-28 11:30:00,713 - ***** Epoch: 39: Eval results *****
2023-12-28 11:30:00,713 -   train_loss = 0.0303
2023-12-28 11:30:00,714 -   best_eval_score = 0.6187
2023-12-28 11:30:00,714 -   eval_score = 0.6151
2023-12-28 11:30:00,714 - EarlyStopping counter: 4 out of 8
2023-12-28 11:30:28,397 - ***** Epoch: 40: Eval results *****
2023-12-28 11:30:28,397 -   train_loss = 0.0347
2023-12-28 11:30:28,397 -   best_eval_score = 0.6187
2023-12-28 11:30:28,397 -   eval_score = 0.6133
2023-12-28 11:30:28,397 - EarlyStopping counter: 5 out of 8
2023-12-28 11:30:56,279 - ***** Epoch: 41: Eval results *****
2023-12-28 11:30:56,279 -   train_loss = 0.0267
2023-12-28 11:30:56,279 -   best_eval_score = 0.6187
2023-12-28 11:30:56,279 -   eval_score = 0.6154
2023-12-28 11:30:56,279 - EarlyStopping counter: 6 out of 8
2023-12-28 11:31:20,212 - ***** Epoch: 42: Eval results *****
2023-12-28 11:31:20,213 -   train_loss = 0.0209
2023-12-28 11:31:20,213 -   best_eval_score = 0.6187
2023-12-28 11:31:20,213 -   eval_score = 0.6237
2023-12-28 11:31:44,058 - ***** Epoch: 43: Eval results *****
2023-12-28 11:31:44,059 -   train_loss = 0.017
2023-12-28 11:31:44,059 -   best_eval_score = 0.6237
2023-12-28 11:31:44,059 -   eval_score = 0.6282
2023-12-28 11:32:08,040 - ***** Epoch: 44: Eval results *****
2023-12-28 11:32:08,041 -   train_loss = 0.0198
2023-12-28 11:32:08,041 -   best_eval_score = 0.6282
2023-12-28 11:32:08,041 -   eval_score = 0.6281
2023-12-28 11:32:08,041 - EarlyStopping counter: 1 out of 8
2023-12-28 11:32:32,201 - ***** Epoch: 45: Eval results *****
2023-12-28 11:32:32,202 -   train_loss = 0.0158
2023-12-28 11:32:32,202 -   best_eval_score = 0.6282
2023-12-28 11:32:32,202 -   eval_score = 0.6302
2023-12-28 11:33:03,058 - ***** Epoch: 46: Eval results *****
2023-12-28 11:33:03,059 -   train_loss = nan
2023-12-28 11:33:03,059 -   best_eval_score = 0.6302
2023-12-28 11:33:03,059 -   eval_score = 0.0114
2023-12-28 11:33:03,059 - EarlyStopping counter: 1 out of 8
2023-12-28 11:33:27,142 - ***** Epoch: 47: Eval results *****
2023-12-28 11:33:27,142 -   train_loss = nan
2023-12-28 11:33:27,142 -   best_eval_score = 0.6302
2023-12-28 11:33:27,142 -   eval_score = 0.0114
2023-12-28 11:33:27,142 - EarlyStopping counter: 2 out of 8
2023-12-28 11:33:53,123 - ***** Epoch: 48: Eval results *****
2023-12-28 11:33:53,123 -   train_loss = nan
2023-12-28 11:33:53,123 -   best_eval_score = 0.6302
2023-12-28 11:33:53,123 -   eval_score = 0.0114
2023-12-28 11:33:53,123 - EarlyStopping counter: 3 out of 8
2023-12-28 11:34:17,152 - ***** Epoch: 49: Eval results *****
2023-12-28 11:34:17,152 -   train_loss = nan
2023-12-28 11:34:17,152 -   best_eval_score = 0.6302
2023-12-28 11:34:17,152 -   eval_score = 0.0114
2023-12-28 11:34:17,152 - EarlyStopping counter: 4 out of 8
