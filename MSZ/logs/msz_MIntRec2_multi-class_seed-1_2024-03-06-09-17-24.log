2024-03-06 09:17:24,053 - ============================== Params ==============================
2024-03-06 09:17:24,055 - logger_name: msz_MIntRec2_multi-class_seed-1_2024-03-06-09-17-24
2024-03-06 09:17:24,055 - dataset: MIntRec2
2024-03-06 09:17:24,055 - data_mode: multi-class
2024-03-06 09:17:24,055 - method: msz
2024-03-06 09:17:24,055 - text_backbone: bert-base-uncased
2024-03-06 09:17:24,055 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-06 09:17:24,055 - seed: 1
2024-03-06 09:17:24,055 - num_workers: 8
2024-03-06 09:17:24,055 - gpu_id: 2
2024-03-06 09:17:24,055 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-06 09:17:24,055 - train: True
2024-03-06 09:17:24,055 - tune: True
2024-03-06 09:17:24,055 - save_model: False
2024-03-06 09:17:24,055 - save_results: True
2024-03-06 09:17:24,055 - log_path: logs
2024-03-06 09:17:24,056 - cache_path: 
2024-03-06 09:17:24,056 - video_data_path: video_data
2024-03-06 09:17:24,056 - audio_data_path: audio_data
2024-03-06 09:17:24,056 - video_feats_path: video_feats.pkl
2024-03-06 09:17:24,056 - audio_feats_path: audio_feats.pkl
2024-03-06 09:17:24,056 - results_path: results
2024-03-06 09:17:24,056 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-06 09:17:24,056 - model_path: models
2024-03-06 09:17:24,056 - config_file_name: msz_MIntRec2
2024-03-06 09:17:24,056 - results_file_name: msz.csv
2024-03-06 09:17:24,056 - padding_mode: zero
2024-03-06 09:17:24,056 - padding_loc: end
2024-03-06 09:17:24,056 - need_aligned: False
2024-03-06 09:17:24,056 - eval_monitor: f1
2024-03-06 09:17:24,056 - train_batch_size: 32
2024-03-06 09:17:24,056 - eval_batch_size: 16
2024-03-06 09:17:24,056 - test_batch_size: 16
2024-03-06 09:17:24,056 - wait_patience: 8
2024-03-06 09:17:24,056 - hidden_dims: 768
2024-03-06 09:17:24,056 - num_attention_heads: 12
2024-03-06 09:17:24,056 - attention_probs_dropout_prob: 0.2
2024-03-06 09:17:24,056 - hidden_dropout_prob: 0.2
2024-03-06 09:17:24,056 - intermediate_size: 768
2024-03-06 09:17:24,056 - num_hidden_layers: 8
2024-03-06 09:17:24,056 - max_position_embeddings: 1024
2024-03-06 09:17:24,056 - position_embedding_type: absolute
2024-03-06 09:17:24,056 - batch_first: True
2024-03-06 09:17:24,056 - dropout: 0.1
2024-03-06 09:17:24,056 - aligned_method: conv1d
2024-03-06 09:17:24,056 - num_train_epochs: 100
2024-03-06 09:17:24,056 - lr: 5e-06
2024-03-06 09:17:24,056 - lr_mode: min
2024-03-06 09:17:24,056 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-1_2024-03-06-09-17-24
2024-03-06 09:17:24,056 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-1_2024-03-06-09-17-24/models
2024-03-06 09:17:24,056 - num_labels: 30
2024-03-06 09:17:24,056 - text_feat_dim: 768
2024-03-06 09:17:24,056 - video_feat_dim: 256
2024-03-06 09:17:24,056 - audio_feat_dim: 768
2024-03-06 09:17:24,056 - text_seq_len: 50
2024-03-06 09:17:24,056 - video_seq_len: 180
2024-03-06 09:17:24,056 - audio_seq_len: 400
2024-03-06 09:17:24,056 - device: cuda:2
2024-03-06 09:17:24,056 - ============================== End Params ==============================
2024-03-06 09:17:24,090 - Generate Text Features Begin...
2024-03-06 09:17:25,742 - Generate Text Features Finished...
2024-03-06 09:17:25,743 - Load Video Features Begin...
2024-03-06 09:17:30,154 - Load Video Features Finished...
2024-03-06 09:17:32,027 - Load Audio Features Begin...
2024-03-06 09:17:57,469 - Load Audio Features Finished...
2024-03-06 09:18:07,904 - method  begins...
2024-03-06 09:18:13,587 - Multimodal intent recognition begins...
2024-03-06 09:18:13,587 - Training begins...
2024-03-06 09:19:39,266 - ***** Epoch: 1: Eval results *****
2024-03-06 09:19:39,266 -   train_loss = 2.6747
2024-03-06 09:19:39,266 -   best_eval_score = 0.0
2024-03-06 09:19:39,266 -   eval_score = 0.2797
2024-03-06 09:21:01,229 - ***** Epoch: 2: Eval results *****
2024-03-06 09:21:01,229 -   train_loss = 1.6746
2024-03-06 09:21:01,229 -   best_eval_score = 0.2797
2024-03-06 09:21:01,229 -   eval_score = 0.4029
2024-03-06 09:22:28,641 - ***** Epoch: 3: Eval results *****
2024-03-06 09:22:28,641 -   train_loss = 1.3088
2024-03-06 09:22:28,641 -   best_eval_score = 0.4029
2024-03-06 09:22:28,641 -   eval_score = 0.4475
2024-03-06 09:23:53,548 - ***** Epoch: 4: Eval results *****
2024-03-06 09:23:53,549 -   train_loss = 1.099
2024-03-06 09:23:53,549 -   best_eval_score = 0.4475
2024-03-06 09:23:53,549 -   eval_score = 0.46
2024-03-06 09:25:20,863 - ***** Epoch: 5: Eval results *****
2024-03-06 09:25:20,863 -   train_loss = 0.9261
2024-03-06 09:25:20,863 -   best_eval_score = 0.46
2024-03-06 09:25:20,864 -   eval_score = 0.4908
2024-03-06 09:26:47,096 - ***** Epoch: 6: Eval results *****
2024-03-06 09:26:47,097 -   train_loss = 0.7719
2024-03-06 09:26:47,097 -   best_eval_score = 0.4908
2024-03-06 09:26:47,097 -   eval_score = 0.4976
2024-03-06 09:28:12,048 - ***** Epoch: 7: Eval results *****
2024-03-06 09:28:12,048 -   train_loss = 0.6247
2024-03-06 09:28:12,048 -   best_eval_score = 0.4976
2024-03-06 09:28:12,048 -   eval_score = 0.4989
2024-03-06 09:29:36,355 - ***** Epoch: 8: Eval results *****
2024-03-06 09:29:36,355 -   train_loss = 0.4979
2024-03-06 09:29:36,356 -   best_eval_score = 0.4989
2024-03-06 09:29:36,356 -   eval_score = 0.5193
2024-03-06 09:31:04,880 - ***** Epoch: 9: Eval results *****
2024-03-06 09:31:04,881 -   train_loss = 0.3983
2024-03-06 09:31:04,881 -   best_eval_score = 0.5193
2024-03-06 09:31:04,881 -   eval_score = 0.5138
2024-03-06 09:31:04,881 - EarlyStopping counter: 1 out of 8
2024-03-06 09:32:28,653 - ***** Epoch: 10: Eval results *****
2024-03-06 09:32:28,654 -   train_loss = 0.3136
2024-03-06 09:32:28,654 -   best_eval_score = 0.5193
2024-03-06 09:32:28,654 -   eval_score = 0.5175
2024-03-06 09:32:28,655 - EarlyStopping counter: 2 out of 8
2024-03-06 09:33:53,954 - ***** Epoch: 11: Eval results *****
2024-03-06 09:33:53,954 -   train_loss = 0.2215
2024-03-06 09:33:53,954 -   best_eval_score = 0.5193
2024-03-06 09:33:53,954 -   eval_score = 0.5173
2024-03-06 09:33:53,954 - EarlyStopping counter: 3 out of 8
2024-03-06 09:35:17,621 - ***** Epoch: 12: Eval results *****
2024-03-06 09:35:17,621 -   train_loss = 0.2073
2024-03-06 09:35:17,621 -   best_eval_score = 0.5193
2024-03-06 09:35:17,621 -   eval_score = 0.5203
2024-03-06 09:36:40,791 - ***** Epoch: 13: Eval results *****
2024-03-06 09:36:40,791 -   train_loss = 0.1987
2024-03-06 09:36:40,791 -   best_eval_score = 0.5203
2024-03-06 09:36:40,791 -   eval_score = 0.5264
2024-03-06 09:38:05,216 - ***** Epoch: 14: Eval results *****
2024-03-06 09:38:05,217 -   train_loss = 0.1924
2024-03-06 09:38:05,217 -   best_eval_score = 0.5264
2024-03-06 09:38:05,217 -   eval_score = 0.5187
2024-03-06 09:38:05,217 - EarlyStopping counter: 1 out of 8
2024-03-06 09:39:29,622 - ***** Epoch: 15: Eval results *****
2024-03-06 09:39:29,622 -   train_loss = 0.1821
2024-03-06 09:39:29,622 -   best_eval_score = 0.5264
2024-03-06 09:39:29,622 -   eval_score = 0.5216
2024-03-06 09:39:29,622 - EarlyStopping counter: 2 out of 8
2024-03-06 09:40:52,919 - ***** Epoch: 16: Eval results *****
2024-03-06 09:40:52,919 -   train_loss = 0.1791
2024-03-06 09:40:52,919 -   best_eval_score = 0.5264
2024-03-06 09:40:52,919 -   eval_score = 0.5234
2024-03-06 09:40:52,919 - EarlyStopping counter: 3 out of 8
2024-03-06 09:42:17,028 - ***** Epoch: 17: Eval results *****
2024-03-06 09:42:17,028 -   train_loss = 0.174
2024-03-06 09:42:17,028 -   best_eval_score = 0.5264
2024-03-06 09:42:17,028 -   eval_score = 0.5218
2024-03-06 09:42:17,028 - EarlyStopping counter: 4 out of 8
2024-03-06 09:43:40,905 - ***** Epoch: 18: Eval results *****
2024-03-06 09:43:40,905 -   train_loss = 0.165
2024-03-06 09:43:40,906 -   best_eval_score = 0.5264
2024-03-06 09:43:40,906 -   eval_score = 0.5181
2024-03-06 09:43:40,906 - EarlyStopping counter: 5 out of 8
2024-03-06 09:45:03,501 - ***** Epoch: 19: Eval results *****
2024-03-06 09:45:03,501 -   train_loss = 0.1643
2024-03-06 09:45:03,501 -   best_eval_score = 0.5264
2024-03-06 09:45:03,501 -   eval_score = 0.5269
2024-03-06 09:46:29,289 - ***** Epoch: 20: Eval results *****
2024-03-06 09:46:29,290 -   train_loss = 0.155
2024-03-06 09:46:29,290 -   best_eval_score = 0.5269
2024-03-06 09:46:29,290 -   eval_score = 0.5271
2024-03-06 09:47:55,651 - ***** Epoch: 21: Eval results *****
2024-03-06 09:47:55,651 -   train_loss = 0.1555
2024-03-06 09:47:55,651 -   best_eval_score = 0.5271
2024-03-06 09:47:55,651 -   eval_score = 0.531
2024-03-06 09:49:22,928 - ***** Epoch: 22: Eval results *****
2024-03-06 09:49:22,928 -   train_loss = 0.1497
2024-03-06 09:49:22,928 -   best_eval_score = 0.531
2024-03-06 09:49:22,928 -   eval_score = 0.53
2024-03-06 09:49:22,928 - EarlyStopping counter: 1 out of 8
2024-03-06 09:50:46,771 - ***** Epoch: 23: Eval results *****
2024-03-06 09:50:46,771 -   train_loss = 0.1535
2024-03-06 09:50:46,771 -   best_eval_score = 0.531
2024-03-06 09:50:46,771 -   eval_score = 0.5269
2024-03-06 09:50:46,771 - EarlyStopping counter: 2 out of 8
2024-03-06 09:52:11,564 - ***** Epoch: 24: Eval results *****
2024-03-06 09:52:11,564 -   train_loss = 0.1551
2024-03-06 09:52:11,564 -   best_eval_score = 0.531
2024-03-06 09:52:11,564 -   eval_score = 0.5261
2024-03-06 09:52:11,564 - EarlyStopping counter: 3 out of 8
2024-03-06 09:53:35,891 - ***** Epoch: 25: Eval results *****
2024-03-06 09:53:35,891 -   train_loss = 0.15
2024-03-06 09:53:35,891 -   best_eval_score = 0.531
2024-03-06 09:53:35,891 -   eval_score = 0.5263
2024-03-06 09:53:35,891 - EarlyStopping counter: 4 out of 8
2024-03-06 09:55:00,158 - ***** Epoch: 26: Eval results *****
2024-03-06 09:55:00,158 -   train_loss = 0.1528
2024-03-06 09:55:00,158 -   best_eval_score = 0.531
2024-03-06 09:55:00,158 -   eval_score = 0.5261
2024-03-06 09:55:00,158 - EarlyStopping counter: 5 out of 8
2024-03-06 09:56:23,497 - ***** Epoch: 27: Eval results *****
2024-03-06 09:56:23,497 -   train_loss = 0.148
2024-03-06 09:56:23,497 -   best_eval_score = 0.531
2024-03-06 09:56:23,497 -   eval_score = 0.5263
2024-03-06 09:56:23,497 - EarlyStopping counter: 6 out of 8
2024-03-06 09:57:47,466 - ***** Epoch: 28: Eval results *****
2024-03-06 09:57:47,467 -   train_loss = 0.1517
2024-03-06 09:57:47,467 -   best_eval_score = 0.531
2024-03-06 09:57:47,467 -   eval_score = 0.5265
2024-03-06 09:57:47,467 - EarlyStopping counter: 7 out of 8
2024-03-06 09:59:13,291 - ***** Epoch: 29: Eval results *****
2024-03-06 09:59:13,291 -   train_loss = 0.1489
2024-03-06 09:59:13,292 -   best_eval_score = 0.531
2024-03-06 09:59:13,292 -   eval_score = 0.5265
2024-03-06 09:59:13,292 - EarlyStopping counter: 8 out of 8
2024-03-06 09:59:13,292 - EarlyStopping at epoch 29
2024-03-06 09:59:13,300 - Training is finished...
2024-03-06 09:59:13,302 - Testing begins...
2024-03-06 09:59:26,285 - ***** Test: Confusion Matrix *****
2024-03-06 09:59:26,288 - [[ 52   0  11   0   0   0   0   0   1   0   2   0   0   0   0   1   0   0
    0   0   0   0   0   1   0   0   0   0   0   0]
 [  0  53   0   0  11   2   5   0   1   0   2   0   4   0   4   0   0   7
    0   1   0   1   1   0   1   0   1   3   0   0]
 [ 13   0  36   0   1   0   0   0   0   0   1   0   0   3   1   1   0   2
    0   0   0   2   0   1   3   0   0   0   0   0]
 [  0   0   0  61   0   0   0   0   0   0   0   0   0   0   1   0   1   0
    0   0   0   0   0   0   0   0   0   1   0   1]
 [  0   5   0   0  34   0   0   0   1   0   0   0   0   0   0   0   0   4
    0   0   0   4   0   1   1   0   0   0   1   0]
 [  0   0   0   0   2  26   1   1   0   0   1   0   0   0   1   0   0   4
    0   0   0   0   0   1   0   0   0   0   0   0]
 [  0   1   0   0   0   4  27   8   0   2   1   0   5   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   4  30   0   1   4   0   5   0   0   0   2   0
    0   0   0   0   1   0   0   0   0   0   0   0]
 [  1   2   1   3   2   0   0   0  20   1   0   2   1   0   5   0   0   3
    0   0   0   1   5   0   1   1   0   0   0   0]
 [  0   0   1   0   0   0   0   0   2  54   1   6   8   2   9   0   0  10
    2   0   0   3   1   1   3   0   0   4   0   0]
 [  2   0   0   0   1   4   7   2   1   0  44   0  28   0   1   0   0   0
    0   2   0   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   0   2   0   7   1  20   6   0   1   0   0   2
    1   0   2   0   2   0   1   0   0   2   0   0]
 [  0   0   0   0   0   2   7  10   0   4  19   2  87   0   0   0   1   1
    0   2   0   0   0   0   0   0   0   0   0   0]
 [  0   0   2   0   0   0   0   0   1   0   0   0   0   3   5   1   0   1
    2   0   1   0   1   0   0   0   0   0   0   0]
 [  0   1   0   0   0   0   1   0   3   9   2   1   0   2 121   2   0  22
    4   0   4   0  15   1   3   1   0   1   0   0]
 [  0   0   2   0   0   0   0   0   0   3   0   0   0   1   2   4   0   4
    2   0   1   0   0   0   0   0   0   2   1   0]
 [  0   0   0   0   1   0   0   1   1   0   2   0   1   0   0   0  55   0
    4   0   0   0   0   0   1   0   0   0   0   0]
 [  0   5   1   1   7   7   0   0   2  11   1   2   1   3  16   3   1 116
   13   0   0   5   5   9   1   1   1   1   1   3]
 [  0   2   0   0   0   0   0   1   0   4   1   0   0   1  10   2   1   6
   27   0   3   0   0   0   2   0   0   0   0   0]
 [  0   2   0   0   1   0   3   0   0   0   0   0   0   0   1   0   0   0
    0   9   0   1   0   0   0   0   0   0   0   0]
 [  0   2   1   0   2   0   0   0   1   1   0   1   1   1   3   1   0   2
    5   0   4   0   0   1   1   0   0   2   0   0]
 [  7   0   0   0   0   0   0   0   1   3   0   0   0   0   0   0   4   1
    0   0   0  28   1   5   0   0   0   1   0   2]
 [  0   0   1   1   0   0   0   0   3   5   0   3   0   2   9   1   0   6
    0   0   0   1  76   0   0   4   4   1   0   0]
 [  0   3   1   0   1   0   0   0   0   0   0   0   0   0   1   0   0   8
    0   0   0   5   0  19   0   0   0   0   0   0]
 [  1   1   2   0   0   0   0   0   0   1   1   1   0   0   1   0   0   3
    2   0   0   0   1   1  86   0   0  10   2   0]
 [  1   0   0   0   1   0   0   0   1   0   0   0   0   0   0   1   0   1
    0   0   0   1   2   0   1  21   0   0   0   1]
 [  0   0   0   1   0   0   0   0   0   0   0   0   0   0   2   0   0   4
    0   0   0   3   2   0   0   0   4   0   1   0]
 [  0   2   2   0   0   0   0   1   4   9   2   5   3   1   2   0   0   2
    1   0   1   0   2   0   7   1   0  11   1   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
    0   0   0   0   0   0   0   0   1   0  56   0]
 [  0   1   0   0   2   0   0   0   2   2   1   1   0   0   0   0   0   3
    1   0   0   0   0   0   1   1   0   0   0   4]]
2024-03-06 09:59:26,288 - ***** Evaluation results *****
2024-03-06 09:59:26,288 -   acc = 0.5844
2024-03-06 09:59:26,288 -   f1 = 0.5316
2024-03-06 09:59:26,288 -   prec = 0.5357
2024-03-06 09:59:26,288 -   rec = 0.5342
2024-03-06 09:59:26,288 - Testing is finished...
2024-03-06 09:59:26,288 - Multimodal intent recognition is finished...
2024-03-06 09:59:26,288 - Results are saved in results/msz.csv
