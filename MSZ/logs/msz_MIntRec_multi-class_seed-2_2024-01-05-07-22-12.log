2024-01-05 07:22:12,478 - ============================== Params ==============================
2024-01-05 07:22:12,478 - logger_name: msz_MIntRec_multi-class_seed-2_2024-01-05-07-22-12
2024-01-05 07:22:12,478 - dataset: MIntRec
2024-01-05 07:22:12,478 - data_mode: multi-class
2024-01-05 07:22:12,478 - method: msz
2024-01-05 07:22:12,478 - text_backbone: bert-base-uncased
2024-01-05 07:22:12,478 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-05 07:22:12,478 - seed: 2
2024-01-05 07:22:12,478 - num_workers: 8
2024-01-05 07:22:12,478 - gpu_id: 1
2024-01-05 07:22:12,478 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-05 07:22:12,478 - train: True
2024-01-05 07:22:12,478 - tune: False
2024-01-05 07:22:12,478 - save_model: False
2024-01-05 07:22:12,478 - save_results: True
2024-01-05 07:22:12,478 - log_path: logs
2024-01-05 07:22:12,478 - cache_path: 
2024-01-05 07:22:12,478 - video_data_path: video_data
2024-01-05 07:22:12,478 - audio_data_path: audio_data
2024-01-05 07:22:12,478 - video_feats_path: video_feats.pkl
2024-01-05 07:22:12,478 - audio_feats_path: audio_feats.pkl
2024-01-05 07:22:12,478 - results_path: results
2024-01-05 07:22:12,478 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-05 07:22:12,478 - model_path: models
2024-01-05 07:22:12,478 - config_file_name: msz
2024-01-05 07:22:12,478 - results_file_name: msz.csv
2024-01-05 07:22:12,479 - padding_mode: zero
2024-01-05 07:22:12,479 - padding_loc: end
2024-01-05 07:22:12,479 - need_aligned: False
2024-01-05 07:22:12,479 - eval_monitor: f1
2024-01-05 07:22:12,479 - train_batch_size: 16
2024-01-05 07:22:12,479 - eval_batch_size: 8
2024-01-05 07:22:12,479 - test_batch_size: 8
2024-01-05 07:22:12,479 - wait_patience: 8
2024-01-05 07:22:12,479 - nheads: 2
2024-01-05 07:22:12,479 - encoder_layers: 2
2024-01-05 07:22:12,479 - attn_dropout: 0.1
2024-01-05 07:22:12,479 - relu_dropout: 0.1
2024-01-05 07:22:12,479 - embed_dropout: 0.1
2024-01-05 07:22:12,479 - res_dropout: 0.1
2024-01-05 07:22:12,479 - attn_mask: False
2024-01-05 07:22:12,479 - hidden_size: 768
2024-01-05 07:22:12,479 - num_attention_heads: 12
2024-01-05 07:22:12,479 - attention_probs_dropout_prob: 0.2
2024-01-05 07:22:12,479 - hidden_dropout_prob: 0.2
2024-01-05 07:22:12,479 - intermediate_size: 768
2024-01-05 07:22:12,479 - num_hidden_layers: 3
2024-01-05 07:22:12,479 - max_position_embeddings: 512
2024-01-05 07:22:12,479 - position_embedding_type: absolute
2024-01-05 07:22:12,479 - batch_first: True
2024-01-05 07:22:12,479 - hidden_dims: 768
2024-01-05 07:22:12,479 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-05 07:22:12,479 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-05 07:22:12,479 - ta_loss: 0.1
2024-01-05 07:22:12,479 - tv_loss: 0.1
2024-01-05 07:22:12,479 - av_loss: 0.1
2024-01-05 07:22:12,479 - aligned_method: conv1d
2024-01-05 07:22:12,479 - grad_clip: -1
2024-01-05 07:22:12,479 - num_train_epochs: 100
2024-01-05 07:22:12,479 - warmup_proportion: 0.1
2024-01-05 07:22:12,479 - lr: 1e-06
2024-01-05 07:22:12,479 - weight_decay: 0.01
2024-01-05 07:22:12,479 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-01-05-07-22-12
2024-01-05 07:22:12,479 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-01-05-07-22-12/models
2024-01-05 07:22:12,480 - ============================== End Params ==============================
2024-01-05 07:22:12,482 - Generate Text Features Begin...
2024-01-05 07:22:12,986 - Generate Text Features Finished...
2024-01-05 07:22:12,987 - Load Video Features Begin...
2024-01-05 07:22:13,306 - Load Video Features Finished...
2024-01-05 07:22:13,905 - Load Audio Features Begin...
2024-01-05 07:22:15,005 - Load Audio Features Finished...
2024-01-05 07:22:18,563 - method  begins...
2024-01-05 07:22:22,555 - Multimodal intent recognition begins...
2024-01-05 07:22:22,556 - Training begins...
2024-01-05 07:22:47,654 - ***** Epoch: 1: Eval results *****
2024-01-05 07:22:47,654 -   train_loss = 2.9905
2024-01-05 07:22:47,654 -   best_eval_score = 0.0
2024-01-05 07:22:47,654 -   eval_score = 0.0418
2024-01-05 07:23:10,503 - ***** Epoch: 2: Eval results *****
2024-01-05 07:23:10,504 -   train_loss = 2.9608
2024-01-05 07:23:10,504 -   best_eval_score = 0.0418
2024-01-05 07:23:10,504 -   eval_score = 0.0272
2024-01-05 07:23:10,504 - EarlyStopping counter: 1 out of 8
2024-01-05 07:23:33,705 - ***** Epoch: 3: Eval results *****
2024-01-05 07:23:33,705 -   train_loss = 2.9065
2024-01-05 07:23:33,705 -   best_eval_score = 0.0418
2024-01-05 07:23:33,705 -   eval_score = 0.0287
2024-01-05 07:23:33,706 - EarlyStopping counter: 2 out of 8
2024-01-05 07:23:56,690 - ***** Epoch: 4: Eval results *****
2024-01-05 07:23:56,690 -   train_loss = 2.8169
2024-01-05 07:23:56,690 -   best_eval_score = 0.0418
2024-01-05 07:23:56,690 -   eval_score = 0.0758
2024-01-05 07:24:19,533 - ***** Epoch: 5: Eval results *****
2024-01-05 07:24:19,533 -   train_loss = 2.6831
2024-01-05 07:24:19,533 -   best_eval_score = 0.0758
2024-01-05 07:24:19,534 -   eval_score = 0.1374
2024-01-05 07:24:42,765 - ***** Epoch: 6: Eval results *****
2024-01-05 07:24:42,765 -   train_loss = 2.4787
2024-01-05 07:24:42,765 -   best_eval_score = 0.1374
2024-01-05 07:24:42,765 -   eval_score = 0.1697
2024-01-05 07:25:05,804 - ***** Epoch: 7: Eval results *****
2024-01-05 07:25:05,804 -   train_loss = 2.1769
2024-01-05 07:25:05,804 -   best_eval_score = 0.1697
2024-01-05 07:25:05,804 -   eval_score = 0.2196
2024-01-05 07:25:29,179 - ***** Epoch: 8: Eval results *****
2024-01-05 07:25:29,179 -   train_loss = 1.8084
2024-01-05 07:25:29,179 -   best_eval_score = 0.2196
2024-01-05 07:25:29,179 -   eval_score = 0.2633
2024-01-05 07:25:52,276 - ***** Epoch: 9: Eval results *****
2024-01-05 07:25:52,276 -   train_loss = 1.4942
2024-01-05 07:25:52,277 -   best_eval_score = 0.2633
2024-01-05 07:25:52,277 -   eval_score = 0.4189
2024-01-05 07:26:15,427 - ***** Epoch: 10: Eval results *****
2024-01-05 07:26:15,427 -   train_loss = 1.2123
2024-01-05 07:26:15,428 -   best_eval_score = 0.4189
2024-01-05 07:26:15,428 -   eval_score = 0.5097
2024-01-05 07:26:38,414 - ***** Epoch: 11: Eval results *****
2024-01-05 07:26:38,414 -   train_loss = 0.9216
2024-01-05 07:26:38,414 -   best_eval_score = 0.5097
2024-01-05 07:26:38,414 -   eval_score = 0.5522
2024-01-05 07:27:01,729 - ***** Epoch: 12: Eval results *****
2024-01-05 07:27:01,729 -   train_loss = 0.6781
2024-01-05 07:27:01,729 -   best_eval_score = 0.5522
2024-01-05 07:27:01,729 -   eval_score = 0.5919
2024-01-05 07:27:25,038 - ***** Epoch: 13: Eval results *****
2024-01-05 07:27:25,038 -   train_loss = 0.493
2024-01-05 07:27:25,038 -   best_eval_score = 0.5919
2024-01-05 07:27:25,038 -   eval_score = 0.5764
2024-01-05 07:27:25,038 - EarlyStopping counter: 1 out of 8
2024-01-05 07:27:47,943 - ***** Epoch: 14: Eval results *****
2024-01-05 07:27:47,944 -   train_loss = 0.3487
2024-01-05 07:27:47,944 -   best_eval_score = 0.5919
2024-01-05 07:27:47,944 -   eval_score = 0.6232
2024-01-05 07:28:10,971 - ***** Epoch: 15: Eval results *****
2024-01-05 07:28:10,971 -   train_loss = 0.2708
2024-01-05 07:28:10,971 -   best_eval_score = 0.6232
2024-01-05 07:28:10,971 -   eval_score = 0.6366
2024-01-05 07:28:34,913 - ***** Epoch: 16: Eval results *****
2024-01-05 07:28:34,913 -   train_loss = 0.1768
2024-01-05 07:28:34,913 -   best_eval_score = 0.6366
2024-01-05 07:28:34,913 -   eval_score = 0.6482
2024-01-05 07:28:58,440 - ***** Epoch: 17: Eval results *****
2024-01-05 07:28:58,440 -   train_loss = 0.1522
2024-01-05 07:28:58,440 -   best_eval_score = 0.6482
2024-01-05 07:28:58,440 -   eval_score = 0.6369
2024-01-05 07:28:58,440 - EarlyStopping counter: 1 out of 8
2024-01-05 07:29:21,538 - ***** Epoch: 18: Eval results *****
2024-01-05 07:29:21,538 -   train_loss = 0.0984
2024-01-05 07:29:21,538 -   best_eval_score = 0.6482
2024-01-05 07:29:21,538 -   eval_score = 0.6395
2024-01-05 07:29:21,538 - EarlyStopping counter: 2 out of 8
2024-01-05 07:29:44,799 - ***** Epoch: 19: Eval results *****
2024-01-05 07:29:44,799 -   train_loss = 0.07
2024-01-05 07:29:44,799 -   best_eval_score = 0.6482
2024-01-05 07:29:44,799 -   eval_score = 0.6761
2024-01-05 07:30:08,028 - ***** Epoch: 20: Eval results *****
2024-01-05 07:30:08,028 -   train_loss = 0.0569
2024-01-05 07:30:08,028 -   best_eval_score = 0.6761
2024-01-05 07:30:08,028 -   eval_score = 0.6665
2024-01-05 07:30:08,028 - EarlyStopping counter: 1 out of 8
2024-01-05 07:30:31,466 - ***** Epoch: 21: Eval results *****
2024-01-05 07:30:31,467 -   train_loss = 0.0416
2024-01-05 07:30:31,468 -   best_eval_score = 0.6761
2024-01-05 07:30:31,468 -   eval_score = 0.6676
2024-01-05 07:30:31,468 - EarlyStopping counter: 2 out of 8
2024-01-05 07:30:54,709 - ***** Epoch: 22: Eval results *****
2024-01-05 07:30:54,709 -   train_loss = 0.034
2024-01-05 07:30:54,709 -   best_eval_score = 0.6761
2024-01-05 07:30:54,709 -   eval_score = 0.6508
2024-01-05 07:30:54,709 - EarlyStopping counter: 3 out of 8
2024-01-05 07:31:18,667 - ***** Epoch: 23: Eval results *****
2024-01-05 07:31:18,667 -   train_loss = 0.0243
2024-01-05 07:31:18,668 -   best_eval_score = 0.6761
2024-01-05 07:31:18,668 -   eval_score = 0.6552
2024-01-05 07:31:18,668 - EarlyStopping counter: 4 out of 8
2024-01-05 07:31:41,941 - ***** Epoch: 24: Eval results *****
2024-01-05 07:31:41,941 -   train_loss = 0.0264
2024-01-05 07:31:41,942 -   best_eval_score = 0.6761
2024-01-05 07:31:41,942 -   eval_score = 0.6514
2024-01-05 07:31:41,942 - EarlyStopping counter: 5 out of 8
2024-01-05 07:32:04,974 - ***** Epoch: 25: Eval results *****
2024-01-05 07:32:04,974 -   train_loss = 0.0199
2024-01-05 07:32:04,974 -   best_eval_score = 0.6761
2024-01-05 07:32:04,974 -   eval_score = 0.6457
2024-01-05 07:32:04,974 - EarlyStopping counter: 6 out of 8
2024-01-05 07:32:28,599 - ***** Epoch: 26: Eval results *****
2024-01-05 07:32:28,599 -   train_loss = 0.0148
2024-01-05 07:32:28,599 -   best_eval_score = 0.6761
2024-01-05 07:32:28,599 -   eval_score = 0.6635
2024-01-05 07:32:28,599 - EarlyStopping counter: 7 out of 8
2024-01-05 07:32:51,794 - ***** Epoch: 27: Eval results *****
2024-01-05 07:32:51,794 -   train_loss = 0.0092
2024-01-05 07:32:51,794 -   best_eval_score = 0.6761
2024-01-05 07:32:51,794 -   eval_score = 0.6663
2024-01-05 07:32:51,794 - EarlyStopping counter: 8 out of 8
2024-01-05 07:32:51,794 - EarlyStopping at epoch 27
2024-01-05 07:32:51,796 - Training is finished...
2024-01-05 07:32:51,796 - Testing begins...
2024-01-05 07:32:55,584 - ***** Test: Confusion Matrix *****
2024-01-05 07:32:55,585 - [[25  1  0  0 11  0  2  3  2  1  2  2  6  2  0  0  0  0  0  0]
 [ 0 39  0  0  0  0  1  0  1  0  0  0  2  0  0  0  0  0  0  0]
 [ 0  0 27  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0]
 [ 1  0  0  0 16  0  1  0  0  0  0  1  1  3  0  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  0  0  0  0  1  0]
 [ 0  0  0  0  4  0  3  0  2  0  0  1  1  0  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  0  6  2  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  1  3  3  0  0  0  0  1  0  1  0  0  0  0]
 [ 2  1  0  0  0  0  0  0  0  1  0  0  0  0  0  3  0  3  0  0]
 [ 1  0  0  0  0  0  1  0  0  0 13  1  1  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 16  1  0  0  0  0  0  0  1]
 [ 1  1  1  0  1  0  1  0  2  0  1  0 37  5  0  3  3  0  0  1]
 [ 0  0  0  0  1  0  0  0  2  0  2  1  0 18  1  0  0  0  0  0]
 [ 0  0  0  0  1  0  1  0  1  0  0  0  0  3 15  0  0  0  0  1]
 [ 0  1  0  0  1  0  0  0  1  0  0  0  3  0  1 13  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  1  0 14  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  1  0  0  0  0 12  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  1  1  1  0  0  0  0  6]]
2024-01-05 07:32:55,585 - ***** Evaluation results *****
2024-01-05 07:32:55,585 -   acc = 0.6921
2024-01-05 07:32:55,585 -   f1 = 0.6571
2024-01-05 07:32:55,585 -   prec = 0.6726
2024-01-05 07:32:55,585 -   rec = 0.6688
2024-01-05 07:32:55,585 - Testing is finished...
2024-01-05 07:32:55,585 - Multimodal intent recognition is finished...
2024-01-05 07:32:55,585 - Results are saved in results/msz.csv
