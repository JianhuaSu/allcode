2024-03-18 02:18:37,376 - ============================== Params ==============================
2024-03-18 02:18:37,376 - logger_name: mag_bert_MIntRec2_multi-class_seed-4_2024-03-18-02-18-37
2024-03-18 02:18:37,376 - dataset: MIntRec2
2024-03-18 02:18:37,376 - data_mode: multi-class
2024-03-18 02:18:37,376 - method: mag_bert
2024-03-18 02:18:37,376 - text_backbone: bert-base-uncased
2024-03-18 02:18:37,376 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-18 02:18:37,376 - seed: 4
2024-03-18 02:18:37,376 - num_workers: 8
2024-03-18 02:18:37,376 - gpu_id: 2
2024-03-18 02:18:37,376 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-18 02:18:37,376 - train: True
2024-03-18 02:18:37,376 - tune: True
2024-03-18 02:18:37,376 - save_model: False
2024-03-18 02:18:37,376 - save_results: True
2024-03-18 02:18:37,376 - log_path: logs
2024-03-18 02:18:37,376 - cache_path: 
2024-03-18 02:18:37,376 - video_data_path: video_data
2024-03-18 02:18:37,376 - audio_data_path: audio_data
2024-03-18 02:18:37,376 - video_feats_path: video_feats.pkl
2024-03-18 02:18:37,376 - audio_feats_path: audio_feats.pkl
2024-03-18 02:18:37,376 - results_path: results
2024-03-18 02:18:37,376 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-18 02:18:37,376 - model_path: models
2024-03-18 02:18:37,376 - config_file_name: mag_bert_MIntRec2
2024-03-18 02:18:37,376 - results_file_name: mag_bert.csv
2024-03-18 02:18:37,376 - padding_mode: zero
2024-03-18 02:18:37,376 - padding_loc: end
2024-03-18 02:18:37,376 - need_aligned: True
2024-03-18 02:18:37,376 - eval_monitor: f1
2024-03-18 02:18:37,376 - train_batch_size: 32
2024-03-18 02:18:37,377 - eval_batch_size: 16
2024-03-18 02:18:37,377 - test_batch_size: 16
2024-03-18 02:18:37,377 - wait_patience: 8
2024-03-18 02:18:37,377 - num_train_epochs: 100
2024-03-18 02:18:37,377 - beta_shift: 0.01
2024-03-18 02:18:37,377 - dropout_prob: 0.1
2024-03-18 02:18:37,377 - warmup_proportion: 0.05
2024-03-18 02:18:37,377 - lr: 9e-06
2024-03-18 02:18:37,377 - aligned_method: ctc
2024-03-18 02:18:37,377 - weight_decay: 0.1
2024-03-18 02:18:37,377 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-18-02-18-37
2024-03-18 02:18:37,377 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-18-02-18-37/models
2024-03-18 02:18:37,377 - num_labels: 30
2024-03-18 02:18:37,377 - text_feat_dim: 768
2024-03-18 02:18:37,377 - video_feat_dim: 256
2024-03-18 02:18:37,377 - audio_feat_dim: 768
2024-03-18 02:18:37,377 - text_seq_len: 50
2024-03-18 02:18:37,377 - video_seq_len: 180
2024-03-18 02:18:37,377 - audio_seq_len: 400
2024-03-18 02:18:37,377 - device: cuda:2
2024-03-18 02:18:37,377 - ============================== End Params ==============================
2024-03-18 02:18:37,506 - Generate Text Features Begin...
2024-03-18 02:18:39,324 - Generate Text Features Finished...
2024-03-18 02:18:39,325 - Load Video Features Begin...
2024-03-18 02:19:00,058 - Load Video Features Finished...
2024-03-18 02:19:02,571 - Load Audio Features Begin...
2024-03-18 02:22:14,534 - Load Audio Features Finished...
2024-03-18 02:22:27,507 - method  begins...
2024-03-18 02:22:45,948 - Multimodal intent recognition begins...
2024-03-18 02:22:45,948 - Training begins...
2024-03-18 02:23:20,836 - ***** Epoch: 1: Eval results *****
2024-03-18 02:23:20,837 -   train_loss = 3.2875
2024-03-18 02:23:20,837 -   best_eval_score = 0.0
2024-03-18 02:23:20,837 -   eval_score = 0.0483
2024-03-18 02:23:56,532 - ***** Epoch: 2: Eval results *****
2024-03-18 02:23:56,533 -   train_loss = 2.8838
2024-03-18 02:23:56,533 -   best_eval_score = 0.0483
2024-03-18 02:23:56,533 -   eval_score = 0.1596
2024-03-18 02:24:31,450 - ***** Epoch: 3: Eval results *****
2024-03-18 02:24:31,451 -   train_loss = 2.4242
2024-03-18 02:24:31,451 -   best_eval_score = 0.1596
2024-03-18 02:24:31,451 -   eval_score = 0.2737
2024-03-18 02:25:04,748 - ***** Epoch: 4: Eval results *****
2024-03-18 02:25:04,748 -   train_loss = 1.987
2024-03-18 02:25:04,749 -   best_eval_score = 0.2737
2024-03-18 02:25:04,749 -   eval_score = 0.338
2024-03-18 02:25:39,473 - ***** Epoch: 5: Eval results *****
2024-03-18 02:25:39,473 -   train_loss = 1.6624
2024-03-18 02:25:39,473 -   best_eval_score = 0.338
2024-03-18 02:25:39,473 -   eval_score = 0.382
2024-03-18 02:26:13,874 - ***** Epoch: 6: Eval results *****
2024-03-18 02:26:13,874 -   train_loss = 1.4108
2024-03-18 02:26:13,874 -   best_eval_score = 0.382
2024-03-18 02:26:13,874 -   eval_score = 0.4073
2024-03-18 02:26:49,107 - ***** Epoch: 7: Eval results *****
2024-03-18 02:26:49,107 -   train_loss = 1.2051
2024-03-18 02:26:49,107 -   best_eval_score = 0.4073
2024-03-18 02:26:49,107 -   eval_score = 0.4541
2024-03-18 02:27:24,353 - ***** Epoch: 8: Eval results *****
2024-03-18 02:27:24,362 -   train_loss = 1.0165
2024-03-18 02:27:24,362 -   best_eval_score = 0.4541
2024-03-18 02:27:24,362 -   eval_score = 0.4681
2024-03-18 02:27:59,513 - ***** Epoch: 9: Eval results *****
2024-03-18 02:27:59,514 -   train_loss = 0.8649
2024-03-18 02:27:59,514 -   best_eval_score = 0.4681
2024-03-18 02:27:59,514 -   eval_score = 0.4832
2024-03-18 02:28:34,244 - ***** Epoch: 10: Eval results *****
2024-03-18 02:28:34,244 -   train_loss = 0.7286
2024-03-18 02:28:34,244 -   best_eval_score = 0.4832
2024-03-18 02:28:34,244 -   eval_score = 0.4792
2024-03-18 02:28:34,244 - EarlyStopping counter: 1 out of 8
2024-03-18 02:29:08,915 - ***** Epoch: 11: Eval results *****
2024-03-18 02:29:08,916 -   train_loss = 0.6275
2024-03-18 02:29:08,916 -   best_eval_score = 0.4832
2024-03-18 02:29:08,916 -   eval_score = 0.4891
2024-03-18 02:29:44,022 - ***** Epoch: 12: Eval results *****
2024-03-18 02:29:44,024 -   train_loss = 0.5207
2024-03-18 02:29:44,025 -   best_eval_score = 0.4891
2024-03-18 02:29:44,026 -   eval_score = 0.4904
2024-03-18 02:30:20,702 - ***** Epoch: 13: Eval results *****
2024-03-18 02:30:20,702 -   train_loss = 0.4496
2024-03-18 02:30:20,702 -   best_eval_score = 0.4904
2024-03-18 02:30:20,702 -   eval_score = 0.4931
2024-03-18 02:30:56,428 - ***** Epoch: 14: Eval results *****
2024-03-18 02:30:56,428 -   train_loss = 0.3799
2024-03-18 02:30:56,428 -   best_eval_score = 0.4931
2024-03-18 02:30:56,428 -   eval_score = 0.4917
2024-03-18 02:30:56,428 - EarlyStopping counter: 1 out of 8
2024-03-18 02:31:31,989 - ***** Epoch: 15: Eval results *****
2024-03-18 02:31:31,989 -   train_loss = 0.3369
2024-03-18 02:31:31,989 -   best_eval_score = 0.4931
2024-03-18 02:31:31,989 -   eval_score = 0.4899
2024-03-18 02:31:31,989 - EarlyStopping counter: 2 out of 8
2024-03-18 02:32:07,153 - ***** Epoch: 16: Eval results *****
2024-03-18 02:32:07,154 -   train_loss = 0.2863
2024-03-18 02:32:07,154 -   best_eval_score = 0.4931
2024-03-18 02:32:07,154 -   eval_score = 0.4994
2024-03-18 02:32:42,151 - ***** Epoch: 17: Eval results *****
2024-03-18 02:32:42,151 -   train_loss = 0.2363
2024-03-18 02:32:42,151 -   best_eval_score = 0.4994
2024-03-18 02:32:42,151 -   eval_score = 0.4988
2024-03-18 02:32:42,151 - EarlyStopping counter: 1 out of 8
2024-03-18 02:33:17,240 - ***** Epoch: 18: Eval results *****
2024-03-18 02:33:17,240 -   train_loss = 0.2085
2024-03-18 02:33:17,240 -   best_eval_score = 0.4994
2024-03-18 02:33:17,240 -   eval_score = 0.5023
2024-03-18 02:33:52,403 - ***** Epoch: 19: Eval results *****
2024-03-18 02:33:52,403 -   train_loss = 0.1833
2024-03-18 02:33:52,403 -   best_eval_score = 0.5023
2024-03-18 02:33:52,403 -   eval_score = 0.4985
2024-03-18 02:33:52,403 - EarlyStopping counter: 1 out of 8
2024-03-18 02:34:27,818 - ***** Epoch: 20: Eval results *****
2024-03-18 02:34:27,818 -   train_loss = 0.1609
2024-03-18 02:34:27,818 -   best_eval_score = 0.5023
2024-03-18 02:34:27,819 -   eval_score = 0.515
2024-03-18 02:35:02,107 - ***** Epoch: 21: Eval results *****
2024-03-18 02:35:02,108 -   train_loss = 0.143
2024-03-18 02:35:02,108 -   best_eval_score = 0.515
2024-03-18 02:35:02,108 -   eval_score = 0.5138
2024-03-18 02:35:02,108 - EarlyStopping counter: 1 out of 8
2024-03-18 02:35:37,402 - ***** Epoch: 22: Eval results *****
2024-03-18 02:35:37,403 -   train_loss = 0.128
2024-03-18 02:35:37,403 -   best_eval_score = 0.515
2024-03-18 02:35:37,403 -   eval_score = 0.5108
2024-03-18 02:35:37,403 - EarlyStopping counter: 2 out of 8
2024-03-18 02:36:12,650 - ***** Epoch: 23: Eval results *****
2024-03-18 02:36:12,650 -   train_loss = 0.1182
2024-03-18 02:36:12,650 -   best_eval_score = 0.515
2024-03-18 02:36:12,650 -   eval_score = 0.4999
2024-03-18 02:36:12,651 - EarlyStopping counter: 3 out of 8
2024-03-18 02:36:47,357 - ***** Epoch: 24: Eval results *****
2024-03-18 02:36:47,357 -   train_loss = 0.1
2024-03-18 02:36:47,357 -   best_eval_score = 0.515
2024-03-18 02:36:47,357 -   eval_score = 0.4907
2024-03-18 02:36:47,357 - EarlyStopping counter: 4 out of 8
2024-03-18 02:37:22,838 - ***** Epoch: 25: Eval results *****
2024-03-18 02:37:22,838 -   train_loss = 0.0988
2024-03-18 02:37:22,838 -   best_eval_score = 0.515
2024-03-18 02:37:22,838 -   eval_score = 0.5035
2024-03-18 02:37:22,838 - EarlyStopping counter: 5 out of 8
2024-03-18 02:37:57,219 - ***** Epoch: 26: Eval results *****
2024-03-18 02:37:57,219 -   train_loss = 0.0884
2024-03-18 02:37:57,219 -   best_eval_score = 0.515
2024-03-18 02:37:57,219 -   eval_score = 0.5098
2024-03-18 02:37:57,219 - EarlyStopping counter: 6 out of 8
2024-03-18 02:38:32,500 - ***** Epoch: 27: Eval results *****
2024-03-18 02:38:32,500 -   train_loss = 0.0838
2024-03-18 02:38:32,500 -   best_eval_score = 0.515
2024-03-18 02:38:32,500 -   eval_score = 0.5159
2024-03-18 02:39:07,648 - ***** Epoch: 28: Eval results *****
2024-03-18 02:39:07,648 -   train_loss = 0.0835
2024-03-18 02:39:07,648 -   best_eval_score = 0.5159
2024-03-18 02:39:07,648 -   eval_score = 0.5042
2024-03-18 02:39:07,648 - EarlyStopping counter: 1 out of 8
2024-03-18 02:39:43,235 - ***** Epoch: 29: Eval results *****
2024-03-18 02:39:43,236 -   train_loss = 0.0786
2024-03-18 02:39:43,236 -   best_eval_score = 0.5159
2024-03-18 02:39:43,236 -   eval_score = 0.5037
2024-03-18 02:39:43,236 - EarlyStopping counter: 2 out of 8
2024-03-18 02:40:18,892 - ***** Epoch: 30: Eval results *****
2024-03-18 02:40:18,892 -   train_loss = 0.0731
2024-03-18 02:40:18,892 -   best_eval_score = 0.5159
2024-03-18 02:40:18,892 -   eval_score = 0.4974
2024-03-18 02:40:18,892 - EarlyStopping counter: 3 out of 8
2024-03-18 02:40:53,681 - ***** Epoch: 31: Eval results *****
2024-03-18 02:40:53,681 -   train_loss = 0.068
2024-03-18 02:40:53,681 -   best_eval_score = 0.5159
2024-03-18 02:40:53,682 -   eval_score = 0.4947
2024-03-18 02:40:53,682 - EarlyStopping counter: 4 out of 8
2024-03-18 02:41:28,996 - ***** Epoch: 32: Eval results *****
2024-03-18 02:41:28,997 -   train_loss = 0.0641
2024-03-18 02:41:28,997 -   best_eval_score = 0.5159
2024-03-18 02:41:28,997 -   eval_score = 0.5011
2024-03-18 02:41:28,997 - EarlyStopping counter: 5 out of 8
2024-03-18 02:42:04,391 - ***** Epoch: 33: Eval results *****
2024-03-18 02:42:04,392 -   train_loss = 0.0629
2024-03-18 02:42:04,392 -   best_eval_score = 0.5159
2024-03-18 02:42:04,392 -   eval_score = 0.5136
2024-03-18 02:42:04,392 - EarlyStopping counter: 6 out of 8
2024-03-18 02:42:40,206 - ***** Epoch: 34: Eval results *****
2024-03-18 02:42:40,206 -   train_loss = 0.0565
2024-03-18 02:42:40,206 -   best_eval_score = 0.5159
2024-03-18 02:42:40,206 -   eval_score = 0.5121
2024-03-18 02:42:40,206 - EarlyStopping counter: 7 out of 8
2024-03-18 02:43:18,422 - ***** Epoch: 35: Eval results *****
2024-03-18 02:43:18,431 -   train_loss = 0.0564
2024-03-18 02:43:18,431 -   best_eval_score = 0.5159
2024-03-18 02:43:18,431 -   eval_score = 0.5109
2024-03-18 02:43:18,431 - EarlyStopping counter: 8 out of 8
2024-03-18 02:43:18,431 - EarlyStopping at epoch 35
2024-03-18 02:43:18,434 - Training is finished...
2024-03-18 02:43:18,434 - Testing begins...
2024-03-18 02:43:25,955 - ***** Test: Confusion Matrix *****
2024-03-18 02:43:25,958 - [[ 47   0  16   0   0   0   0   0   1   0   2   0   0   1   0   0   0   0
    0   0   0   0   0   1   0   0   0   0   0   0]
 [  0  53   0   0   9   1   5   0   2   0   2   0   3   1   3   0   0   8
    0   4   1   0   1   0   1   0   0   3   0   0]
 [ 11   1  39   0   0   0   0   0   0   0   1   1   0   3   1   0   0   2
    0   0   0   1   0   2   2   0   0   0   0   0]
 [  0   0   0  61   0   0   0   1   0   0   0   0   0   0   2   0   0   1
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   5   0   0  30   1   0   0   1   0   0   0   0   0   0   0   0   3
    0   2   0   1   0   2   1   1   0   0   1   3]
 [  0   0   0   0   0  22   0   1   0   2   1   0   0   1   1   0   0   5
    0   2   0   0   0   0   0   1   1   0   0   0]
 [  0   1   0   0   0   4  29   8   0   1   1   0   4   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   4  28   0   1   5   0   6   0   0   0   1   0
    0   0   0   0   0   0   1   0   0   1   0   0]
 [  1   3   2   3   1   0   0   0  23   1   0   2   1   2   2   0   0   4
    0   0   0   0   2   0   2   0   0   0   0   0]
 [  0   1   1   0   1   0   1   0   3  55   0   5   9   2  10   0   0   7
    1   0   1   3   1   0   2   0   1   2   0   1]
 [  2   0   0   0   0   3   1   2   0   2  47   0  28   0   1   0   0   2
    0   3   1   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   0   2   0  10   0  19   7   0   1   0   0   1
    1   0   0   0   3   0   0   0   0   3   0   0]
 [  0   2   0   0   0   1   3  11   0   5  24   1  83   2   0   0   0   0
    0   1   1   1   0   0   0   0   0   0   0   0]
 [  0   0   2   0   1   0   0   0   2   2   0   0   0   2   2   2   0   2
    2   0   0   0   0   0   0   0   0   0   0   0]
 [  0   1   0   0   0   2   0   0   3  13   1   0   2  11 110   2   0  21
    2   1   4   0  12   0   3   0   0   5   0   0]
 [  0   0   0   0   0   0   0   0   0   5   0   0   0   2   4   6   0   0
    1   0   1   1   1   0   0   0   0   0   1   0]
 [  0   0   0   0   1   0   0   2   0   0   1   0   1   0   0   0  58   0
    2   1   0   0   0   0   0   0   0   0   0   0]
 [  1   5   1   0   7   5   0   0   1  14   0   0   1   9  17   2   1 109
    9   1   6   5   4   9   0   1   3   1   1   4]
 [  0   1   0   0   0   0   0   0   0   4   2   0   0   4   5   2   3   8
   25   0   3   0   1   0   2   0   0   0   0   0]
 [  0   4   0   0   1   0   2   0   0   0   2   0   0   0   0   0   0   0
    0   7   0   1   0   0   0   0   0   0   0   0]
 [  0   1   2   0   1   0   0   0   0   1   0   0   1   0   5   0   0   3
    4   0   5   0   0   1   3   0   0   1   0   1]
 [  7   1   0   0   0   0   0   0   0   3   0   0   0   0   1   0   4   1
    0   1   1  24   1   5   0   0   1   1   0   2]
 [  0   1   2   1   0   0   0   0   1   4   0   1   0   1   9   1   0   2
    0   0   1   0  76   0   1   4  11   1   0   0]
 [  0   3   2   0   1   0   0   0   0   2   0   0   0   0   0   1   0   7
    1   0   0   3   0  18   0   0   0   0   0   0]
 [  2   0   1   0   0   0   0   0   1   4   0   1   0   2   3   2   0   3
    1   0   0   1   1   0  84   0   0   5   2   0]
 [  1   0   0   0   0   0   0   0   0   1   0   0   1   0   0   0   0   1
    0   0   0   0   2   0   1  21   1   0   0   2]
 [  0   0   0   1   0   0   0   0   0   2   0   0   0   1   1   0   0   3
    0   0   0   2   1   0   0   0   5   0   1   0]
 [  0   3   1   0   0   0   0   1   1   7   2   3   4   1   2   1   0   3
    0   0   4   0   2   0   7   1   0  11   1   3]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
    0   0   0   0   0   0   0   0   1   0  56   0]
 [  0   2   0   0   0   0   0   0   2   2   1   1   0   0   0   0   0   3
    1   0   1   0   0   0   0   1   0   1   0   4]]
2024-03-18 02:43:25,958 - ***** Evaluation results *****
2024-03-18 02:43:25,958 -   acc = 0.5691
2024-03-18 02:43:25,958 -   f1 = 0.5202
2024-03-18 02:43:25,958 -   prec = 0.5245
2024-03-18 02:43:25,958 -   rec = 0.5225
2024-03-18 02:43:25,958 - Testing is finished...
2024-03-18 02:43:25,958 - Multimodal intent recognition is finished...
2024-03-18 02:43:25,958 - Results are saved in results/mag_bert.csv
