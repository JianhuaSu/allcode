2023-12-26 11:13:52,506 - ============================== Params ==============================
2023-12-26 11:13:52,507 - logger_name: msz_MIntRec_multi-class_seed-6_2023-12-26-11-13-52
2023-12-26 11:13:52,507 - dataset: MIntRec
2023-12-26 11:13:52,507 - data_mode: multi-class
2023-12-26 11:13:52,507 - method: msz
2023-12-26 11:13:52,508 - text_backbone: bert-base-uncased
2023-12-26 11:13:52,508 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-26 11:13:52,508 - seed: 6
2023-12-26 11:13:52,508 - num_workers: 8
2023-12-26 11:13:52,509 - gpu_id: 3
2023-12-26 11:13:52,509 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-26 11:13:52,509 - train: True
2023-12-26 11:13:52,509 - tune: False
2023-12-26 11:13:52,510 - save_model: False
2023-12-26 11:13:52,510 - save_results: True
2023-12-26 11:13:52,510 - log_path: logs
2023-12-26 11:13:52,511 - cache_path: 
2023-12-26 11:13:52,511 - video_data_path: video_data
2023-12-26 11:13:52,511 - audio_data_path: audio_data
2023-12-26 11:13:52,511 - video_feats_path: video_feats.pkl
2023-12-26 11:13:52,512 - audio_feats_path: audio_feats.pkl
2023-12-26 11:13:52,512 - results_path: results
2023-12-26 11:13:52,512 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-26 11:13:52,512 - model_path: models
2023-12-26 11:13:52,513 - config_file_name: msz
2023-12-26 11:13:52,513 - results_file_name: msz.csv
2023-12-26 11:13:52,513 - padding_mode: zero
2023-12-26 11:13:52,513 - padding_loc: end
2023-12-26 11:13:52,514 - need_aligned: False
2023-12-26 11:13:52,514 - eval_monitor: f1
2023-12-26 11:13:52,514 - train_batch_size: 16
2023-12-26 11:13:52,514 - eval_batch_size: 8
2023-12-26 11:13:52,515 - test_batch_size: 8
2023-12-26 11:13:52,515 - wait_patience: 8
2023-12-26 11:13:52,515 - nheads: 2
2023-12-26 11:13:52,515 - encoder_layers: 2
2023-12-26 11:13:52,516 - attn_dropout: 0.1
2023-12-26 11:13:52,516 - relu_dropout: 0.1
2023-12-26 11:13:52,516 - embed_dropout: 0.1
2023-12-26 11:13:52,517 - res_dropout: 0.1
2023-12-26 11:13:52,517 - attn_mask: False
2023-12-26 11:13:52,517 - hidden_size: 768
2023-12-26 11:13:52,517 - num_attention_heads: 12
2023-12-26 11:13:52,518 - attention_probs_dropout_prob: 0.2
2023-12-26 11:13:52,518 - hidden_dropout_prob: 0.2
2023-12-26 11:13:52,518 - intermediate_size: 768
2023-12-26 11:13:52,518 - num_hidden_layers: 3
2023-12-26 11:13:52,519 - max_position_embeddings: 512
2023-12-26 11:13:52,519 - position_embedding_type: absolute
2023-12-26 11:13:52,519 - add_cross_attention: False
2023-12-26 11:13:52,519 - batch_first: True
2023-12-26 11:13:52,520 - hidden_dims: 768
2023-12-26 11:13:52,520 - att_dropouts: [0.1, 0.1, 0.1]
2023-12-26 11:13:52,520 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-26 11:13:52,520 - tv_c_loss: 0.01
2023-12-26 11:13:52,521 - vt_c_loss: 0.05
2023-12-26 11:13:52,521 - at_c_loss: 0.02
2023-12-26 11:13:52,521 - aligned_method: conv1d
2023-12-26 11:13:52,522 - num_train_epochs: 100
2023-12-26 11:13:52,522 - warmup_proportion: 0.1
2023-12-26 11:13:52,522 - lr: 3e-06
2023-12-26 11:13:52,522 - weight_decay: 0.01
2023-12-26 11:13:52,523 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-6_2023-12-26-11-13-52
2023-12-26 11:13:52,523 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-6_2023-12-26-11-13-52/models
2023-12-26 11:13:52,523 - ============================== End Params ==============================
2023-12-26 11:13:52,528 - Generate Text Features Begin...
2023-12-26 11:13:53,341 - Generate Text Features Finished...
2023-12-26 11:13:53,342 - Load Video Features Begin...
2023-12-26 11:13:58,319 - Load Video Features Finished...
2023-12-26 11:13:59,173 - Load Audio Features Begin...
2023-12-26 11:14:48,796 - Load Audio Features Finished...
2023-12-26 11:14:55,349 - method  begins...
2023-12-26 11:15:01,478 - Multimodal intent recognition begins...
2023-12-26 11:15:01,478 - Training begins...
2023-12-26 11:15:43,488 - ***** Epoch: 1: Eval results *****
2023-12-26 11:15:43,495 -   train_loss = 3.742
2023-12-26 11:15:43,495 -   best_eval_score = 0.0
2023-12-26 11:15:43,496 -   eval_score = 0.027
2023-12-26 11:16:24,244 - ***** Epoch: 2: Eval results *****
2023-12-26 11:16:24,244 -   train_loss = 3.2977
2023-12-26 11:16:24,244 -   best_eval_score = 0.027
2023-12-26 11:16:24,244 -   eval_score = 0.0555
2023-12-26 11:17:08,288 - ***** Epoch: 3: Eval results *****
2023-12-26 11:17:08,289 -   train_loss = 2.9759
2023-12-26 11:17:08,289 -   best_eval_score = 0.0555
2023-12-26 11:17:08,289 -   eval_score = 0.1024
2023-12-26 11:17:53,767 - ***** Epoch: 4: Eval results *****
2023-12-26 11:17:53,768 -   train_loss = 2.6152
2023-12-26 11:17:53,768 -   best_eval_score = 0.1024
2023-12-26 11:17:53,768 -   eval_score = 0.2502
2023-12-26 11:18:35,672 - ***** Epoch: 5: Eval results *****
2023-12-26 11:18:35,672 -   train_loss = 2.1811
2023-12-26 11:18:35,672 -   best_eval_score = 0.2502
2023-12-26 11:18:35,672 -   eval_score = 0.3601
2023-12-26 11:19:16,028 - ***** Epoch: 6: Eval results *****
2023-12-26 11:19:16,029 -   train_loss = 1.8489
2023-12-26 11:19:16,029 -   best_eval_score = 0.3601
2023-12-26 11:19:16,030 -   eval_score = 0.4178
2023-12-26 11:19:57,444 - ***** Epoch: 7: Eval results *****
2023-12-26 11:19:57,444 -   train_loss = 1.4557
2023-12-26 11:19:57,444 -   best_eval_score = 0.4178
2023-12-26 11:19:57,444 -   eval_score = 0.4538
2023-12-26 11:20:43,171 - ***** Epoch: 8: Eval results *****
2023-12-26 11:20:43,172 -   train_loss = 1.0897
2023-12-26 11:20:43,173 -   best_eval_score = 0.4538
2023-12-26 11:20:43,173 -   eval_score = 0.4981
2023-12-26 11:21:24,985 - ***** Epoch: 9: Eval results *****
2023-12-26 11:21:24,986 -   train_loss = 0.7493
2023-12-26 11:21:24,986 -   best_eval_score = 0.4981
2023-12-26 11:21:24,986 -   eval_score = 0.575
2023-12-26 11:22:04,891 - ***** Epoch: 10: Eval results *****
2023-12-26 11:22:04,891 -   train_loss = 0.65
2023-12-26 11:22:04,892 -   best_eval_score = 0.575
2023-12-26 11:22:04,892 -   eval_score = 0.5918
2023-12-26 11:22:46,732 - ***** Epoch: 11: Eval results *****
2023-12-26 11:22:46,732 -   train_loss = 0.5468
2023-12-26 11:22:46,732 -   best_eval_score = 0.5918
2023-12-26 11:22:46,732 -   eval_score = 0.5806
2023-12-26 11:22:46,732 - EarlyStopping counter: 1 out of 8
2023-12-26 11:23:33,146 - ***** Epoch: 12: Eval results *****
2023-12-26 11:23:33,146 -   train_loss = 0.525
2023-12-26 11:23:33,147 -   best_eval_score = 0.5918
2023-12-26 11:23:33,147 -   eval_score = 0.6057
2023-12-26 11:24:13,247 - ***** Epoch: 13: Eval results *****
2023-12-26 11:24:13,247 -   train_loss = 0.4139
2023-12-26 11:24:13,248 -   best_eval_score = 0.6057
2023-12-26 11:24:13,248 -   eval_score = 0.5776
2023-12-26 11:24:13,248 - EarlyStopping counter: 1 out of 8
2023-12-26 11:24:51,885 - ***** Epoch: 14: Eval results *****
2023-12-26 11:24:51,885 -   train_loss = 0.4019
2023-12-26 11:24:51,885 -   best_eval_score = 0.6057
2023-12-26 11:24:51,885 -   eval_score = 0.5829
2023-12-26 11:24:51,885 - EarlyStopping counter: 2 out of 8
2023-12-26 11:25:35,407 - ***** Epoch: 15: Eval results *****
2023-12-26 11:25:35,408 -   train_loss = nan
2023-12-26 11:25:35,408 -   best_eval_score = 0.6057
2023-12-26 11:25:35,408 -   eval_score = 0.0114
2023-12-26 11:25:35,408 - EarlyStopping counter: 3 out of 8
2023-12-26 11:26:16,391 - ***** Epoch: 16: Eval results *****
2023-12-26 11:26:16,392 -   train_loss = nan
2023-12-26 11:26:16,393 -   best_eval_score = 0.6057
2023-12-26 11:26:16,393 -   eval_score = 0.0114
2023-12-26 11:26:16,393 - EarlyStopping counter: 4 out of 8
2023-12-26 11:26:52,754 - ***** Epoch: 17: Eval results *****
2023-12-26 11:26:52,754 -   train_loss = nan
2023-12-26 11:26:52,754 -   best_eval_score = 0.6057
2023-12-26 11:26:52,754 -   eval_score = 0.0114
2023-12-26 11:26:52,754 - EarlyStopping counter: 5 out of 8
2023-12-26 11:27:34,774 - ***** Epoch: 18: Eval results *****
2023-12-26 11:27:34,775 -   train_loss = nan
2023-12-26 11:27:34,775 -   best_eval_score = 0.6057
2023-12-26 11:27:34,776 -   eval_score = 0.0114
2023-12-26 11:27:34,776 - EarlyStopping counter: 6 out of 8
2023-12-26 11:28:16,466 - ***** Epoch: 19: Eval results *****
2023-12-26 11:28:16,466 -   train_loss = nan
2023-12-26 11:28:16,466 -   best_eval_score = 0.6057
2023-12-26 11:28:16,466 -   eval_score = 0.0114
2023-12-26 11:28:16,466 - EarlyStopping counter: 7 out of 8
2023-12-26 11:28:52,304 - ***** Epoch: 20: Eval results *****
2023-12-26 11:28:52,306 -   train_loss = nan
2023-12-26 11:28:52,307 -   best_eval_score = 0.6057
2023-12-26 11:28:52,307 -   eval_score = 0.0114
2023-12-26 11:28:52,308 - EarlyStopping counter: 8 out of 8
2023-12-26 11:28:52,308 - EarlyStopping at epoch 20
2023-12-26 11:28:52,310 - Training is finished...
2023-12-26 11:28:52,311 - Testing begins...
2023-12-26 11:29:00,505 - ***** Test: Confusion Matrix *****
2023-12-26 11:29:00,507 - [[33  0  0  0  0  0  3  3  1  1  1  1 10  2  1  0  0  1  0  0]
 [ 0 35  0  0  0  0  1  1  2  0  0  1  1  1  0  1  0  0  0  0]
 [ 0  0 23  1  0  0  0  0  0  0  1  0  1  0  0  0  1  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 6  0  0  0  1  0  8  0  1  0  0  2  1  2  1  0  0  1  0  0]
 [ 0  0  0  0  0 10  0  0  0  0  0  0  1  0  1  0  0  0  0  0]
 [ 3  1  0  0  0  0  0  0  2  0  0  1  4  0  1  0  0  0  0  0]
 [ 6  0  0  0  0  0  0  4  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  5  1  0  0  0  0  1  0  1  0  0  0  1]
 [ 2  0  0  0  0  0  0  0  1  1  1  0  0  0  0  3  0  2  0  0]
 [ 1  0  0  0  0  0  0  1  1  0 14  0  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 19  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  0  3  1  0  0  0 43  2  5  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  1  1 17  3  1  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  2 17  0  1  0  0  0]
 [ 0  0  0  1  0  0  0  2  1  0  0  0  3  0  1 13  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  6  0  0  0 11  0  0  0]
 [ 1  0  0  0  0  0  1  0  0  0  1  0  1  0  2  0  0  9  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  5  0  0  1  0  0  5  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  1  2  0  0  0  0  4]]
2023-12-26 11:29:00,508 - ***** Evaluation results *****
2023-12-26 11:29:00,509 -   acc = 0.6404
2023-12-26 11:29:00,509 -   f1 = 0.5678
2023-12-26 11:29:00,509 -   prec = 0.6507
2023-12-26 11:29:00,510 -   rec = 0.5695
2023-12-26 11:29:00,510 - Testing is finished...
2023-12-26 11:29:00,510 - Multimodal intent recognition is finished...
2023-12-26 11:29:00,510 - Results are saved in results/msz.csv
