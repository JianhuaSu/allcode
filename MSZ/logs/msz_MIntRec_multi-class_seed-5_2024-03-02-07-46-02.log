2024-03-02 07:46:02,408 - ============================== Params ==============================
2024-03-02 07:46:02,408 - logger_name: msz_MIntRec_multi-class_seed-5_2024-03-02-07-46-02
2024-03-02 07:46:02,408 - dataset: MIntRec
2024-03-02 07:46:02,408 - data_mode: multi-class
2024-03-02 07:46:02,408 - method: msz
2024-03-02 07:46:02,408 - text_backbone: bert-base-uncased
2024-03-02 07:46:02,408 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-02 07:46:02,408 - seed: 5
2024-03-02 07:46:02,408 - num_workers: 8
2024-03-02 07:46:02,408 - gpu_id: 3
2024-03-02 07:46:02,408 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-02 07:46:02,408 - train: True
2024-03-02 07:46:02,408 - tune: True
2024-03-02 07:46:02,408 - save_model: True
2024-03-02 07:46:02,408 - save_results: True
2024-03-02 07:46:02,408 - log_path: logs
2024-03-02 07:46:02,409 - cache_path: 
2024-03-02 07:46:02,409 - video_data_path: video_data
2024-03-02 07:46:02,409 - audio_data_path: audio_data
2024-03-02 07:46:02,409 - video_feats_path: video_feats.pkl
2024-03-02 07:46:02,409 - audio_feats_path: audio_feats.pkl
2024-03-02 07:46:02,409 - results_path: results
2024-03-02 07:46:02,409 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-03-02 07:46:02,409 - model_path: models
2024-03-02 07:46:02,409 - config_file_name: msz_MIntRec
2024-03-02 07:46:02,409 - results_file_name: msz.csv
2024-03-02 07:46:02,409 - padding_mode: zero
2024-03-02 07:46:02,409 - padding_loc: end
2024-03-02 07:46:02,409 - need_aligned: False
2024-03-02 07:46:02,409 - eval_monitor: f1
2024-03-02 07:46:02,409 - train_batch_size: 16
2024-03-02 07:46:02,409 - eval_batch_size: 8
2024-03-02 07:46:02,409 - test_batch_size: 8
2024-03-02 07:46:02,409 - wait_patience: 8
2024-03-02 07:46:02,409 - hidden_size: 768
2024-03-02 07:46:02,409 - num_attention_heads: 12
2024-03-02 07:46:02,409 - attention_probs_dropout_prob: 0.2
2024-03-02 07:46:02,409 - hidden_dropout_prob: 0.2
2024-03-02 07:46:02,409 - intermediate_size: 768
2024-03-02 07:46:02,409 - num_hidden_layers: 10
2024-03-02 07:46:02,409 - max_position_embeddings: 768
2024-03-02 07:46:02,409 - position_embedding_type: absolute
2024-03-02 07:46:02,409 - batch_first: True
2024-03-02 07:46:02,409 - hidden_dims: 768
2024-03-02 07:46:02,409 - dropout: 0.1
2024-03-02 07:46:02,410 - aligned_method: conv1d
2024-03-02 07:46:02,410 - num_train_epochs: 100
2024-03-02 07:46:02,410 - lr: 8e-06
2024-03-02 07:46:02,410 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-5_2024-03-02-07-46-02
2024-03-02 07:46:02,410 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-5_2024-03-02-07-46-02/models
2024-03-02 07:46:02,410 - ============================== End Params ==============================
2024-03-02 07:46:02,522 - Generate Text Features Begin...
2024-03-02 07:46:03,511 - Generate Text Features Finished...
2024-03-02 07:46:03,511 - Load Video Features Begin...
2024-03-02 07:46:11,003 - Load Video Features Finished...
2024-03-02 07:46:11,603 - Load Audio Features Begin...
2024-03-02 07:47:02,463 - Load Audio Features Finished...
2024-03-02 07:47:06,602 - method  begins...
2024-03-02 07:47:15,143 - Multimodal intent recognition begins...
2024-03-02 07:47:15,143 - Training begins...
2024-03-02 07:47:41,254 - ***** Epoch: 1: Eval results *****
2024-03-02 07:47:41,255 -   train_loss = 2.496
2024-03-02 07:47:41,255 -   best_eval_score = 0.0
2024-03-02 07:47:41,255 -   eval_score = 0.2252
2024-03-02 07:48:05,639 - ***** Epoch: 2: Eval results *****
2024-03-02 07:48:05,639 -   train_loss = 1.4122
2024-03-02 07:48:05,639 -   best_eval_score = 0.2252
2024-03-02 07:48:05,639 -   eval_score = 0.5682
2024-03-02 07:48:29,800 - ***** Epoch: 3: Eval results *****
2024-03-02 07:48:29,800 -   train_loss = 0.7482
2024-03-02 07:48:29,801 -   best_eval_score = 0.5682
2024-03-02 07:48:29,801 -   eval_score = 0.642
2024-03-02 07:48:53,221 - ***** Epoch: 4: Eval results *****
2024-03-02 07:48:53,222 -   train_loss = 0.3957
2024-03-02 07:48:53,222 -   best_eval_score = 0.642
2024-03-02 07:48:53,222 -   eval_score = 0.6734
2024-03-02 07:49:17,289 - ***** Epoch: 5: Eval results *****
2024-03-02 07:49:17,289 -   train_loss = 0.1942
2024-03-02 07:49:17,289 -   best_eval_score = 0.6734
2024-03-02 07:49:17,289 -   eval_score = 0.6697
2024-03-02 07:49:17,289 - EarlyStopping counter: 1 out of 8
2024-03-02 07:49:41,592 - ***** Epoch: 6: Eval results *****
2024-03-02 07:49:41,592 -   train_loss = 0.1024
2024-03-02 07:49:41,592 -   best_eval_score = 0.6734
2024-03-02 07:49:41,592 -   eval_score = 0.6688
2024-03-02 07:49:41,592 - EarlyStopping counter: 2 out of 8
2024-03-02 07:50:04,883 - ***** Epoch: 7: Eval results *****
2024-03-02 07:50:04,883 -   train_loss = 0.0477
2024-03-02 07:50:04,883 -   best_eval_score = 0.6734
2024-03-02 07:50:04,883 -   eval_score = 0.6893
2024-03-02 07:50:28,643 - ***** Epoch: 8: Eval results *****
2024-03-02 07:50:28,643 -   train_loss = 0.0322
2024-03-02 07:50:28,643 -   best_eval_score = 0.6893
2024-03-02 07:50:28,643 -   eval_score = 0.681
2024-03-02 07:50:28,644 - EarlyStopping counter: 1 out of 8
2024-03-02 07:50:52,739 - ***** Epoch: 9: Eval results *****
2024-03-02 07:50:52,739 -   train_loss = 0.0251
2024-03-02 07:50:52,739 -   best_eval_score = 0.6893
2024-03-02 07:50:52,739 -   eval_score = 0.6725
2024-03-02 07:50:52,739 - EarlyStopping counter: 2 out of 8
2024-03-02 07:51:17,991 - ***** Epoch: 10: Eval results *****
2024-03-02 07:51:17,991 -   train_loss = 0.0174
2024-03-02 07:51:17,991 -   best_eval_score = 0.6893
2024-03-02 07:51:17,991 -   eval_score = 0.6811
2024-03-02 07:51:17,991 - EarlyStopping counter: 3 out of 8
2024-03-02 07:51:42,624 - ***** Epoch: 11: Eval results *****
2024-03-02 07:51:42,625 -   train_loss = 0.0116
2024-03-02 07:51:42,625 -   best_eval_score = 0.6893
2024-03-02 07:51:42,625 -   eval_score = 0.6771
2024-03-02 07:51:42,625 - EarlyStopping counter: 4 out of 8
2024-03-02 07:52:07,670 - ***** Epoch: 12: Eval results *****
2024-03-02 07:52:07,670 -   train_loss = 0.0107
2024-03-02 07:52:07,671 -   best_eval_score = 0.6893
2024-03-02 07:52:07,671 -   eval_score = 0.6864
2024-03-02 07:52:07,671 - EarlyStopping counter: 5 out of 8
2024-03-02 07:52:30,680 - ***** Epoch: 13: Eval results *****
2024-03-02 07:52:30,680 -   train_loss = 0.0095
2024-03-02 07:52:30,680 -   best_eval_score = 0.6893
2024-03-02 07:52:30,680 -   eval_score = 0.6915
2024-03-02 07:52:54,085 - ***** Epoch: 14: Eval results *****
2024-03-02 07:52:54,085 -   train_loss = 0.0102
2024-03-02 07:52:54,085 -   best_eval_score = 0.6915
2024-03-02 07:52:54,085 -   eval_score = 0.6789
2024-03-02 07:52:54,085 - EarlyStopping counter: 1 out of 8
2024-03-02 07:53:19,060 - ***** Epoch: 15: Eval results *****
2024-03-02 07:53:19,061 -   train_loss = 0.0098
2024-03-02 07:53:19,061 -   best_eval_score = 0.6915
2024-03-02 07:53:19,061 -   eval_score = 0.6907
2024-03-02 07:53:19,061 - EarlyStopping counter: 2 out of 8
2024-03-02 07:53:42,399 - ***** Epoch: 16: Eval results *****
2024-03-02 07:53:42,400 -   train_loss = 0.0095
2024-03-02 07:53:42,400 -   best_eval_score = 0.6915
2024-03-02 07:53:42,400 -   eval_score = 0.6809
2024-03-02 07:53:42,400 - EarlyStopping counter: 3 out of 8
2024-03-02 07:54:06,295 - ***** Epoch: 17: Eval results *****
2024-03-02 07:54:06,295 -   train_loss = 0.0088
2024-03-02 07:54:06,296 -   best_eval_score = 0.6915
2024-03-02 07:54:06,296 -   eval_score = 0.682
2024-03-02 07:54:06,296 - EarlyStopping counter: 4 out of 8
2024-03-02 07:54:30,325 - ***** Epoch: 18: Eval results *****
2024-03-02 07:54:30,325 -   train_loss = 0.008
2024-03-02 07:54:30,325 -   best_eval_score = 0.6915
2024-03-02 07:54:30,325 -   eval_score = 0.6791
2024-03-02 07:54:30,325 - EarlyStopping counter: 5 out of 8
2024-03-02 07:54:53,746 - ***** Epoch: 19: Eval results *****
2024-03-02 07:54:53,746 -   train_loss = 0.0081
2024-03-02 07:54:53,746 -   best_eval_score = 0.6915
2024-03-02 07:54:53,746 -   eval_score = 0.682
2024-03-02 07:54:53,746 - EarlyStopping counter: 6 out of 8
2024-03-02 07:55:17,314 - ***** Epoch: 20: Eval results *****
2024-03-02 07:55:17,315 -   train_loss = 0.0076
2024-03-02 07:55:17,315 -   best_eval_score = 0.6915
2024-03-02 07:55:17,315 -   eval_score = 0.682
2024-03-02 07:55:17,315 - EarlyStopping counter: 7 out of 8
2024-03-02 07:55:41,798 - ***** Epoch: 21: Eval results *****
2024-03-02 07:55:41,798 -   train_loss = 0.0079
2024-03-02 07:55:41,798 -   best_eval_score = 0.6915
2024-03-02 07:55:41,798 -   eval_score = 0.682
2024-03-02 07:55:41,798 - EarlyStopping counter: 8 out of 8
2024-03-02 07:55:41,798 - EarlyStopping at epoch 21
2024-03-02 07:55:41,799 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-5_2024-03-02-07-46-02/models
2024-03-02 07:55:43,235 - Training is finished...
2024-03-02 07:55:43,236 - Testing begins...
2024-03-02 07:55:47,090 - ***** Test: Confusion Matrix *****
2024-03-02 07:55:47,090 - [[34  3  0  0  8  0  2  0  0  4  0  0  4  2  0  0  0  0  0  0]
 [ 1 34  0  0  0  3  1  0  0  0  2  0  2  0  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 4  0  0  0 12  0  3  0  0  0  0  1  1  1  0  0  0  1  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  1  0  4  0  3  0  0  0  1  0  0  0  1  0  0  0]
 [ 3  0  0  0  0  0  0  6  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  1  2  6  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  1  0  0  3  1  0  0  0  0  3  0  1  0  0]
 [ 0  1  0  0  0  0  1  0  0  2 14  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  0  1]
 [ 2  2  0  0  1  0  0  1  0  0  0  2 38  2  4  2  2  0  1  0]
 [ 1  1  0  0  0  0  1  0  0  0  1  1  0 18  2  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  1  0  0  0  0  2 15  0  1  0  0  2]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  5  1  0 14  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  3  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  2  0  0  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  1  1  0  1  0  1  5]]
2024-03-02 07:55:47,091 - ***** Evaluation results *****
2024-03-02 07:55:47,091 -   acc = 0.7079
2024-03-02 07:55:47,091 -   f1 = 0.6872
2024-03-02 07:55:47,091 -   prec = 0.6868
2024-03-02 07:55:47,091 -   rec = 0.6914
2024-03-02 07:55:47,091 - Testing is finished...
2024-03-02 07:55:47,091 - Multimodal intent recognition is finished...
2024-03-02 07:55:47,091 - Results are saved in results/msz.csv
