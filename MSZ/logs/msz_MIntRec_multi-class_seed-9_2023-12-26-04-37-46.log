2023-12-26 04:37:46,869 - ============================== Params ==============================
2023-12-26 04:37:46,869 - logger_name: msz_MIntRec_multi-class_seed-9_2023-12-26-04-37-46
2023-12-26 04:37:46,869 - dataset: MIntRec
2023-12-26 04:37:46,869 - data_mode: multi-class
2023-12-26 04:37:46,869 - method: msz
2023-12-26 04:37:46,869 - text_backbone: bert-base-uncased
2023-12-26 04:37:46,869 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-26 04:37:46,869 - seed: 9
2023-12-26 04:37:46,869 - num_workers: 8
2023-12-26 04:37:46,869 - gpu_id: 0
2023-12-26 04:37:46,869 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-26 04:37:46,869 - train: True
2023-12-26 04:37:46,869 - tune: False
2023-12-26 04:37:46,869 - save_model: False
2023-12-26 04:37:46,869 - save_results: True
2023-12-26 04:37:46,869 - log_path: logs
2023-12-26 04:37:46,869 - cache_path: 
2023-12-26 04:37:46,869 - video_data_path: video_data
2023-12-26 04:37:46,870 - audio_data_path: audio_data
2023-12-26 04:37:46,870 - video_feats_path: video_feats.pkl
2023-12-26 04:37:46,870 - audio_feats_path: audio_feats.pkl
2023-12-26 04:37:46,870 - results_path: results
2023-12-26 04:37:46,870 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-26 04:37:46,870 - model_path: models
2023-12-26 04:37:46,870 - config_file_name: msz
2023-12-26 04:37:46,870 - results_file_name: msz.csv
2023-12-26 04:37:46,870 - padding_mode: zero
2023-12-26 04:37:46,870 - padding_loc: end
2023-12-26 04:37:46,870 - need_aligned: False
2023-12-26 04:37:46,870 - eval_monitor: f1
2023-12-26 04:37:46,870 - train_batch_size: 16
2023-12-26 04:37:46,870 - eval_batch_size: 8
2023-12-26 04:37:46,870 - test_batch_size: 8
2023-12-26 04:37:46,870 - wait_patience: 8
2023-12-26 04:37:46,870 - nheads: 2
2023-12-26 04:37:46,870 - encoder_layers: 2
2023-12-26 04:37:46,870 - attn_dropout: 0.1
2023-12-26 04:37:46,870 - relu_dropout: 0.1
2023-12-26 04:37:46,870 - embed_dropout: 0.1
2023-12-26 04:37:46,870 - res_dropout: 0.1
2023-12-26 04:37:46,870 - attn_mask: False
2023-12-26 04:37:46,870 - hidden_size: 768
2023-12-26 04:37:46,870 - num_attention_heads: 12
2023-12-26 04:37:46,870 - attention_probs_dropout_prob: 0.2
2023-12-26 04:37:46,870 - hidden_dropout_prob: 0.2
2023-12-26 04:37:46,870 - intermediate_size: 768
2023-12-26 04:37:46,870 - num_hidden_layers: 3
2023-12-26 04:37:46,871 - max_position_embeddings: 512
2023-12-26 04:37:46,871 - position_embedding_type: absolute
2023-12-26 04:37:46,871 - add_cross_attention: False
2023-12-26 04:37:46,871 - batch_first: True
2023-12-26 04:37:46,871 - hidden_dims: 768
2023-12-26 04:37:46,871 - att_dropouts: [0.1, 0.1, 0.1]
2023-12-26 04:37:46,871 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-26 04:37:46,871 - sl: 0.1
2023-12-26 04:37:46,871 - cl: 0.1
2023-12-26 04:37:46,871 - num_train_epochs: 100
2023-12-26 04:37:46,871 - warmup_proportion: 0.1
2023-12-26 04:37:46,871 - lr: 5e-06
2023-12-26 04:37:46,871 - weight_decay: 0.01
2023-12-26 04:37:46,871 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-9_2023-12-26-04-37-46
2023-12-26 04:37:46,871 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-9_2023-12-26-04-37-46/models
2023-12-26 04:37:46,871 - ============================== End Params ==============================
2023-12-26 04:37:46,875 - Generate Text Features Begin...
2023-12-26 04:37:47,505 - Generate Text Features Finished...
2023-12-26 04:37:47,506 - Load Video Features Begin...
2023-12-26 04:37:48,162 - Load Video Features Finished...
2023-12-26 04:37:48,926 - Load Audio Features Begin...
2023-12-26 04:37:51,630 - Load Audio Features Finished...
2023-12-26 04:37:56,526 - method  begins...
2023-12-26 04:38:00,199 - Multimodal intent recognition begins...
2023-12-26 04:38:00,199 - Training begins...
2023-12-26 04:38:28,777 - ***** Epoch: 1: Eval results *****
2023-12-26 04:38:28,786 -   train_loss = 2.9121
2023-12-26 04:38:28,786 -   best_eval_score = 0.0
2023-12-26 04:38:28,786 -   eval_score = 0.031
2023-12-26 04:38:55,316 - ***** Epoch: 2: Eval results *****
2023-12-26 04:38:55,318 -   train_loss = 2.7137
2023-12-26 04:38:55,318 -   best_eval_score = 0.031
2023-12-26 04:38:55,318 -   eval_score = 0.1645
2023-12-26 04:39:22,046 - ***** Epoch: 3: Eval results *****
2023-12-26 04:39:22,046 -   train_loss = 2.2559
2023-12-26 04:39:22,046 -   best_eval_score = 0.1645
2023-12-26 04:39:22,046 -   eval_score = 0.2907
2023-12-26 04:39:48,880 - ***** Epoch: 4: Eval results *****
2023-12-26 04:39:48,882 -   train_loss = 1.7118
2023-12-26 04:39:48,882 -   best_eval_score = 0.2907
2023-12-26 04:39:48,882 -   eval_score = 0.3556
2023-12-26 04:40:14,322 - ***** Epoch: 5: Eval results *****
2023-12-26 04:40:14,322 -   train_loss = 1.4826
2023-12-26 04:40:14,322 -   best_eval_score = 0.3556
2023-12-26 04:40:14,322 -   eval_score = 0.4556
2023-12-26 04:40:41,088 - ***** Epoch: 6: Eval results *****
2023-12-26 04:40:41,088 -   train_loss = 1.2192
2023-12-26 04:40:41,088 -   best_eval_score = 0.4556
2023-12-26 04:40:41,089 -   eval_score = 0.4465
2023-12-26 04:40:41,089 - EarlyStopping counter: 1 out of 8
2023-12-26 04:41:07,503 - ***** Epoch: 7: Eval results *****
2023-12-26 04:41:07,504 -   train_loss = 0.9145
2023-12-26 04:41:07,504 -   best_eval_score = 0.4556
2023-12-26 04:41:07,504 -   eval_score = 0.4962
2023-12-26 04:41:35,294 - ***** Epoch: 8: Eval results *****
2023-12-26 04:41:35,295 -   train_loss = 0.7421
2023-12-26 04:41:35,295 -   best_eval_score = 0.4962
2023-12-26 04:41:35,295 -   eval_score = 0.5758
2023-12-26 04:42:01,771 - ***** Epoch: 9: Eval results *****
2023-12-26 04:42:01,772 -   train_loss = 0.6664
2023-12-26 04:42:01,773 -   best_eval_score = 0.5758
2023-12-26 04:42:01,774 -   eval_score = 0.5057
2023-12-26 04:42:01,774 - EarlyStopping counter: 1 out of 8
2023-12-26 04:42:28,257 - ***** Epoch: 10: Eval results *****
2023-12-26 04:42:28,258 -   train_loss = 0.6779
2023-12-26 04:42:28,258 -   best_eval_score = 0.5758
2023-12-26 04:42:28,258 -   eval_score = 0.485
2023-12-26 04:42:28,258 - EarlyStopping counter: 2 out of 8
2023-12-26 04:42:54,918 - ***** Epoch: 11: Eval results *****
2023-12-26 04:42:54,918 -   train_loss = 0.9519
2023-12-26 04:42:54,919 -   best_eval_score = 0.5758
2023-12-26 04:42:54,919 -   eval_score = 0.4976
2023-12-26 04:42:54,919 - EarlyStopping counter: 3 out of 8
2023-12-26 04:43:22,229 - ***** Epoch: 12: Eval results *****
2023-12-26 04:43:22,230 -   train_loss = 1.0777
2023-12-26 04:43:22,230 -   best_eval_score = 0.5758
2023-12-26 04:43:22,230 -   eval_score = 0.4778
2023-12-26 04:43:22,231 - EarlyStopping counter: 4 out of 8
2023-12-26 04:43:48,823 - ***** Epoch: 13: Eval results *****
2023-12-26 04:43:48,824 -   train_loss = 1.1668
2023-12-26 04:43:48,824 -   best_eval_score = 0.5758
2023-12-26 04:43:48,824 -   eval_score = 0.4643
2023-12-26 04:43:48,825 - EarlyStopping counter: 5 out of 8
2023-12-26 04:44:16,397 - ***** Epoch: 14: Eval results *****
2023-12-26 04:44:16,398 -   train_loss = 1.1989
2023-12-26 04:44:16,398 -   best_eval_score = 0.5758
2023-12-26 04:44:16,398 -   eval_score = 0.4797
2023-12-26 04:44:16,398 - EarlyStopping counter: 6 out of 8
2023-12-26 04:44:43,877 - ***** Epoch: 15: Eval results *****
2023-12-26 04:44:43,878 -   train_loss = 1.0793
2023-12-26 04:44:43,879 -   best_eval_score = 0.5758
2023-12-26 04:44:43,879 -   eval_score = 0.4597
2023-12-26 04:44:43,879 - EarlyStopping counter: 7 out of 8
2023-12-26 04:45:10,392 - ***** Epoch: 16: Eval results *****
2023-12-26 04:45:10,392 -   train_loss = 1.1237
2023-12-26 04:45:10,392 -   best_eval_score = 0.5758
2023-12-26 04:45:10,392 -   eval_score = 0.4705
2023-12-26 04:45:10,392 - EarlyStopping counter: 8 out of 8
2023-12-26 04:45:10,392 - EarlyStopping at epoch 16
2023-12-26 04:45:10,395 - Training is finished...
2023-12-26 04:45:10,395 - Testing begins...
2023-12-26 04:45:16,340 - ***** Test: Confusion Matrix *****
2023-12-26 04:45:16,342 - [[32  0  1  0  3  0  0  0  0  3  1  0 11  3  1  1  1  0  0  0]
 [ 2 27  0  0  0  0  0  4  0  0  0  1  5  0  1  3  0  0  0  0]
 [ 1  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0]
 [ 0  0  0 24  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0]
 [ 6  0  0  0  5  0  1  0  0  1  1  0  6  2  1  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 4  0  0  0  0  0  0  0  0  1  1  0  4  0  0  1  1  0  0  0]
 [ 3  0  0  0  0  0  0  4  0  1  0  0  2  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  0  0  0  0  1  2  0  1  1  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  3  1  0  1  0  1  1  0  2  0  0]
 [ 0  0  0  0  0  0  0  0  0  2 15  0  0  0  1  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  0  0 17  1  0  0  0  0  0  0  0]
 [ 3  0  0  0  0  1  0  0  0  1  1  0 42  0  6  0  3  0  0  0]
 [ 2  0  0  0  0  0  0  0  0  0  1  1  5 14  2  0  0  0  0  0]
 [ 0  0  1  0  0  0  0  0  0  0  0  0  4  1 14  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  7  0  2 12  0  0  0  0]
 [ 0  0  0  0  0  1  0  0  0  0  0  0  2  0  1  0 13  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  2  0  0  1  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  1  1  0  0  7  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  6  0  3  0  0  0]]
2023-12-26 04:45:16,342 - ***** Evaluation results *****
2023-12-26 04:45:16,342 -   acc = 0.6202
2023-12-26 04:45:16,342 -   f1 = 0.5515
2023-12-26 04:45:16,342 -   prec = 0.5732
2023-12-26 04:45:16,342 -   rec = 0.5612
2023-12-26 04:45:16,342 - Testing is finished...
2023-12-26 04:45:16,342 - Multimodal intent recognition is finished...
2023-12-26 04:45:16,342 - Results are saved in results/msz.csv
