2023-12-26 12:29:16,627 - ============================== Params ==============================
2023-12-26 12:29:16,627 - logger_name: msz_MIntRec_multi-class_seed-1_2023-12-26-12-29-16
2023-12-26 12:29:16,627 - dataset: MIntRec
2023-12-26 12:29:16,627 - data_mode: multi-class
2023-12-26 12:29:16,627 - method: msz
2023-12-26 12:29:16,627 - text_backbone: bert-base-uncased
2023-12-26 12:29:16,627 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-26 12:29:16,627 - seed: 1
2023-12-26 12:29:16,627 - num_workers: 8
2023-12-26 12:29:16,628 - gpu_id: 3
2023-12-26 12:29:16,628 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-26 12:29:16,628 - train: True
2023-12-26 12:29:16,628 - tune: False
2023-12-26 12:29:16,628 - save_model: False
2023-12-26 12:29:16,628 - save_results: True
2023-12-26 12:29:16,628 - log_path: logs
2023-12-26 12:29:16,628 - cache_path: 
2023-12-26 12:29:16,628 - video_data_path: video_data
2023-12-26 12:29:16,628 - audio_data_path: audio_data
2023-12-26 12:29:16,628 - video_feats_path: video_feats.pkl
2023-12-26 12:29:16,628 - audio_feats_path: audio_feats.pkl
2023-12-26 12:29:16,628 - results_path: results
2023-12-26 12:29:16,628 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-26 12:29:16,628 - model_path: models
2023-12-26 12:29:16,628 - config_file_name: msz
2023-12-26 12:29:16,628 - results_file_name: msz.csv
2023-12-26 12:29:16,628 - padding_mode: zero
2023-12-26 12:29:16,628 - padding_loc: end
2023-12-26 12:29:16,628 - need_aligned: False
2023-12-26 12:29:16,628 - eval_monitor: f1
2023-12-26 12:29:16,628 - train_batch_size: 16
2023-12-26 12:29:16,628 - eval_batch_size: 8
2023-12-26 12:29:16,628 - test_batch_size: 8
2023-12-26 12:29:16,628 - wait_patience: 8
2023-12-26 12:29:16,628 - nheads: 2
2023-12-26 12:29:16,628 - encoder_layers: 2
2023-12-26 12:29:16,628 - attn_dropout: 0.1
2023-12-26 12:29:16,629 - relu_dropout: 0.1
2023-12-26 12:29:16,629 - embed_dropout: 0.1
2023-12-26 12:29:16,629 - res_dropout: 0.1
2023-12-26 12:29:16,629 - attn_mask: False
2023-12-26 12:29:16,629 - hidden_size: 768
2023-12-26 12:29:16,629 - num_attention_heads: 12
2023-12-26 12:29:16,629 - attention_probs_dropout_prob: 0.2
2023-12-26 12:29:16,629 - hidden_dropout_prob: 0.2
2023-12-26 12:29:16,629 - intermediate_size: 768
2023-12-26 12:29:16,629 - num_hidden_layers: 3
2023-12-26 12:29:16,629 - max_position_embeddings: 512
2023-12-26 12:29:16,629 - position_embedding_type: absolute
2023-12-26 12:29:16,629 - add_cross_attention: False
2023-12-26 12:29:16,629 - batch_first: True
2023-12-26 12:29:16,629 - hidden_dims: 768
2023-12-26 12:29:16,629 - att_dropouts: [0.2, 0.2, 0.2]
2023-12-26 12:29:16,629 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-26 12:29:16,629 - tv_c_loss: 0.01
2023-12-26 12:29:16,629 - vt_c_loss: 0.05
2023-12-26 12:29:16,629 - at_c_loss: 0.02
2023-12-26 12:29:16,629 - aligned_method: conv1d
2023-12-26 12:29:16,629 - grad_clip: 2
2023-12-26 12:29:16,629 - num_train_epochs: 100
2023-12-26 12:29:16,629 - warmup_proportion: 0.1
2023-12-26 12:29:16,629 - lr: 1e-06
2023-12-26 12:29:16,629 - weight_decay: 0.03
2023-12-26 12:29:16,629 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2023-12-26-12-29-16
2023-12-26 12:29:16,629 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2023-12-26-12-29-16/models
2023-12-26 12:29:16,629 - ============================== End Params ==============================
2023-12-26 12:29:16,711 - Generate Text Features Begin...
2023-12-26 12:29:17,188 - Generate Text Features Finished...
2023-12-26 12:29:17,188 - Load Video Features Begin...
2023-12-26 12:29:18,612 - Load Video Features Finished...
2023-12-26 12:29:19,220 - Load Audio Features Begin...
2023-12-26 12:29:32,729 - Load Audio Features Finished...
2023-12-26 12:29:38,659 - method  begins...
2023-12-26 12:29:50,251 - Multimodal intent recognition begins...
2023-12-26 12:29:50,253 - Training begins...
2023-12-26 12:30:37,596 - ***** Epoch: 1: Eval results *****
2023-12-26 12:30:37,597 -   train_loss = 3.8528
2023-12-26 12:30:37,597 -   best_eval_score = 0.0
2023-12-26 12:30:37,598 -   eval_score = 0.0229
2023-12-26 12:31:24,740 - ***** Epoch: 2: Eval results *****
2023-12-26 12:31:24,740 -   train_loss = 3.5753
2023-12-26 12:31:24,740 -   best_eval_score = 0.0229
2023-12-26 12:31:24,740 -   eval_score = 0.0178
2023-12-26 12:31:24,741 - EarlyStopping counter: 1 out of 8
2023-12-26 12:32:14,399 - ***** Epoch: 3: Eval results *****
2023-12-26 12:32:14,399 -   train_loss = 3.3546
2023-12-26 12:32:14,399 -   best_eval_score = 0.0229
2023-12-26 12:32:14,399 -   eval_score = 0.0476
2023-12-26 12:32:54,287 - ***** Epoch: 4: Eval results *****
2023-12-26 12:32:54,288 -   train_loss = 3.1877
2023-12-26 12:32:54,289 -   best_eval_score = 0.0476
2023-12-26 12:32:54,289 -   eval_score = 0.0694
2023-12-26 12:33:23,493 - ***** Epoch: 5: Eval results *****
2023-12-26 12:33:23,493 -   train_loss = 3.0204
2023-12-26 12:33:23,493 -   best_eval_score = 0.0694
2023-12-26 12:33:23,494 -   eval_score = 0.0964
2023-12-26 12:33:56,539 - ***** Epoch: 6: Eval results *****
2023-12-26 12:33:56,539 -   train_loss = 2.8276
2023-12-26 12:33:56,540 -   best_eval_score = 0.0964
2023-12-26 12:33:56,540 -   eval_score = 0.1562
2023-12-26 12:34:29,884 - ***** Epoch: 7: Eval results *****
2023-12-26 12:34:29,894 -   train_loss = 2.5851
2023-12-26 12:34:29,894 -   best_eval_score = 0.1562
2023-12-26 12:34:29,894 -   eval_score = 0.2336
2023-12-26 12:35:19,327 - ***** Epoch: 8: Eval results *****
2023-12-26 12:35:19,327 -   train_loss = 2.2645
2023-12-26 12:35:19,327 -   best_eval_score = 0.2336
2023-12-26 12:35:19,327 -   eval_score = 0.3834
2023-12-26 12:36:06,292 - ***** Epoch: 9: Eval results *****
2023-12-26 12:36:06,293 -   train_loss = 1.9214
2023-12-26 12:36:06,294 -   best_eval_score = 0.3834
2023-12-26 12:36:06,294 -   eval_score = 0.4644
2023-12-26 12:36:51,543 - ***** Epoch: 10: Eval results *****
2023-12-26 12:36:51,544 -   train_loss = 1.5917
2023-12-26 12:36:51,545 -   best_eval_score = 0.4644
2023-12-26 12:36:51,545 -   eval_score = 0.5264
2023-12-26 12:37:40,941 - ***** Epoch: 11: Eval results *****
2023-12-26 12:37:40,942 -   train_loss = 1.353
2023-12-26 12:37:40,942 -   best_eval_score = 0.5264
2023-12-26 12:37:40,942 -   eval_score = 0.5657
2023-12-26 12:38:31,173 - ***** Epoch: 12: Eval results *****
2023-12-26 12:38:31,174 -   train_loss = 1.0965
2023-12-26 12:38:31,174 -   best_eval_score = 0.5657
2023-12-26 12:38:31,175 -   eval_score = 0.5474
2023-12-26 12:38:31,175 - EarlyStopping counter: 1 out of 8
2023-12-26 12:39:18,310 - ***** Epoch: 13: Eval results *****
2023-12-26 12:39:18,311 -   train_loss = 0.8925
2023-12-26 12:39:18,311 -   best_eval_score = 0.5657
2023-12-26 12:39:18,312 -   eval_score = 0.5594
2023-12-26 12:39:18,312 - EarlyStopping counter: 2 out of 8
2023-12-26 12:40:00,491 - ***** Epoch: 14: Eval results *****
2023-12-26 12:40:00,491 -   train_loss = 0.7712
2023-12-26 12:40:00,492 -   best_eval_score = 0.5657
2023-12-26 12:40:00,492 -   eval_score = 0.5837
2023-12-26 12:40:41,680 - ***** Epoch: 15: Eval results *****
2023-12-26 12:40:41,681 -   train_loss = 0.5635
2023-12-26 12:40:41,681 -   best_eval_score = 0.5837
2023-12-26 12:40:41,681 -   eval_score = 0.6116
2023-12-26 12:41:20,319 - ***** Epoch: 16: Eval results *****
2023-12-26 12:41:20,319 -   train_loss = 0.4886
2023-12-26 12:41:20,320 -   best_eval_score = 0.6116
2023-12-26 12:41:20,320 -   eval_score = 0.6209
2023-12-26 12:41:57,079 - ***** Epoch: 17: Eval results *****
2023-12-26 12:41:57,080 -   train_loss = 0.3841
2023-12-26 12:41:57,080 -   best_eval_score = 0.6209
2023-12-26 12:41:57,080 -   eval_score = 0.6319
2023-12-26 12:42:34,734 - ***** Epoch: 18: Eval results *****
2023-12-26 12:42:34,736 -   train_loss = 0.3051
2023-12-26 12:42:34,736 -   best_eval_score = 0.6319
2023-12-26 12:42:34,736 -   eval_score = 0.6355
2023-12-26 12:43:17,575 - ***** Epoch: 19: Eval results *****
2023-12-26 12:43:17,576 -   train_loss = 0.2513
2023-12-26 12:43:17,576 -   best_eval_score = 0.6355
2023-12-26 12:43:17,576 -   eval_score = 0.631
2023-12-26 12:43:17,576 - EarlyStopping counter: 1 out of 8
2023-12-26 12:44:02,808 - ***** Epoch: 20: Eval results *****
2023-12-26 12:44:02,809 -   train_loss = 0.195
2023-12-26 12:44:02,809 -   best_eval_score = 0.6355
2023-12-26 12:44:02,809 -   eval_score = 0.6686
2023-12-26 12:44:45,675 - ***** Epoch: 21: Eval results *****
2023-12-26 12:44:45,675 -   train_loss = 0.1614
2023-12-26 12:44:45,675 -   best_eval_score = 0.6686
2023-12-26 12:44:45,675 -   eval_score = 0.6655
2023-12-26 12:44:45,675 - EarlyStopping counter: 1 out of 8
2023-12-26 12:45:28,913 - ***** Epoch: 22: Eval results *****
2023-12-26 12:45:28,913 -   train_loss = 0.1337
2023-12-26 12:45:28,914 -   best_eval_score = 0.6686
2023-12-26 12:45:28,914 -   eval_score = 0.6662
2023-12-26 12:45:28,914 - EarlyStopping counter: 2 out of 8
2023-12-26 12:46:14,049 - ***** Epoch: 23: Eval results *****
2023-12-26 12:46:14,049 -   train_loss = 0.1059
2023-12-26 12:46:14,049 -   best_eval_score = 0.6686
2023-12-26 12:46:14,049 -   eval_score = 0.646
2023-12-26 12:46:14,049 - EarlyStopping counter: 3 out of 8
2023-12-26 12:46:59,007 - ***** Epoch: 24: Eval results *****
2023-12-26 12:46:59,008 -   train_loss = 0.0913
2023-12-26 12:46:59,008 -   best_eval_score = 0.6686
2023-12-26 12:46:59,008 -   eval_score = 0.6706
2023-12-26 12:47:46,598 - ***** Epoch: 25: Eval results *****
2023-12-26 12:47:46,598 -   train_loss = 0.0775
2023-12-26 12:47:46,598 -   best_eval_score = 0.6706
2023-12-26 12:47:46,598 -   eval_score = 0.6666
2023-12-26 12:47:46,598 - EarlyStopping counter: 1 out of 8
2023-12-26 12:48:31,552 - ***** Epoch: 26: Eval results *****
2023-12-26 12:48:31,553 -   train_loss = 0.0667
2023-12-26 12:48:31,553 -   best_eval_score = 0.6706
2023-12-26 12:48:31,553 -   eval_score = 0.677
2023-12-26 12:49:11,656 - ***** Epoch: 27: Eval results *****
2023-12-26 12:49:11,656 -   train_loss = 0.0549
2023-12-26 12:49:11,657 -   best_eval_score = 0.677
2023-12-26 12:49:11,657 -   eval_score = 0.6653
2023-12-26 12:49:11,657 - EarlyStopping counter: 1 out of 8
2023-12-26 12:49:55,068 - ***** Epoch: 28: Eval results *****
2023-12-26 12:49:55,069 -   train_loss = nan
2023-12-26 12:49:55,069 -   best_eval_score = 0.677
2023-12-26 12:49:55,069 -   eval_score = 0.0114
2023-12-26 12:49:55,069 - EarlyStopping counter: 2 out of 8
2023-12-26 12:50:38,823 - ***** Epoch: 29: Eval results *****
2023-12-26 12:50:38,824 -   train_loss = nan
2023-12-26 12:50:38,824 -   best_eval_score = 0.677
2023-12-26 12:50:38,824 -   eval_score = 0.0114
2023-12-26 12:50:38,825 - EarlyStopping counter: 3 out of 8
2023-12-26 12:51:16,781 - ***** Epoch: 30: Eval results *****
2023-12-26 12:51:16,782 -   train_loss = nan
2023-12-26 12:51:16,782 -   best_eval_score = 0.677
2023-12-26 12:51:16,782 -   eval_score = 0.0114
2023-12-26 12:51:16,782 - EarlyStopping counter: 4 out of 8
2023-12-26 12:51:54,832 - ***** Epoch: 31: Eval results *****
2023-12-26 12:51:54,833 -   train_loss = nan
2023-12-26 12:51:54,833 -   best_eval_score = 0.677
2023-12-26 12:51:54,834 -   eval_score = 0.0114
2023-12-26 12:51:54,834 - EarlyStopping counter: 5 out of 8
2023-12-26 12:52:27,876 - ***** Epoch: 32: Eval results *****
2023-12-26 12:52:27,877 -   train_loss = nan
2023-12-26 12:52:27,877 -   best_eval_score = 0.677
2023-12-26 12:52:27,877 -   eval_score = 0.0114
2023-12-26 12:52:27,877 - EarlyStopping counter: 6 out of 8
2023-12-26 12:53:03,982 - ***** Epoch: 33: Eval results *****
2023-12-26 12:53:03,983 -   train_loss = nan
2023-12-26 12:53:03,983 -   best_eval_score = 0.677
2023-12-26 12:53:03,983 -   eval_score = 0.0114
2023-12-26 12:53:03,984 - EarlyStopping counter: 7 out of 8
2023-12-26 12:53:48,100 - ***** Epoch: 34: Eval results *****
2023-12-26 12:53:48,109 -   train_loss = nan
2023-12-26 12:53:48,109 -   best_eval_score = 0.677
2023-12-26 12:53:48,109 -   eval_score = 0.0114
2023-12-26 12:53:48,109 - EarlyStopping counter: 8 out of 8
2023-12-26 12:53:48,109 - EarlyStopping at epoch 34
2023-12-26 12:53:48,112 - Training is finished...
2023-12-26 12:53:48,113 - Testing begins...
2023-12-26 12:53:57,417 - ***** Test: Confusion Matrix *****
2023-12-26 12:53:57,419 - [[18  0  0  0  6  0  8  4  3  5  1  0  8  2  0  1  0  1  0  0]
 [ 0 39  0  1  0  0  0  1  1  0  0  0  0  1  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0 15  0  2  0  0  0  0  1  1  1  1  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  0  0  0  0  0  1]
 [ 1  0  0  0  2  0  5  1  1  0  0  0  1  0  0  0  0  0  0  1]
 [ 3  0  0  0  0  0  0  5  0  1  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  2  5  0  0  0  0  1  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  4  1  0  0  0  0  3  0  2  0  0]
 [ 1  0  0  0  0  0  1  1  0  1 12  1  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 16  0  0  0  0  0  0  1  1]
 [ 3  1  0  0  0  1  1  0  3  0  0  1 36  1  2  3  1  1  2  1]
 [ 0  0  0  0  0  0  0  1  0  0  1  1  1 19  1  1  0  0  0  0]
 [ 0  0  0  0  1  0  1  0  2  0  0  0  0  2 13  0  1  0  0  2]
 [ 0  1  0  0  1  0  0  0  1  0  0  0  1  0  0 15  0  0  1  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  4  0  2  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0 13  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  2  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0  0  8]]
2023-12-26 12:53:57,420 - ***** Evaluation results *****
2023-12-26 12:53:57,420 -   acc = 0.6854
2023-12-26 12:53:57,420 -   f1 = 0.6665
2023-12-26 12:53:57,420 -   prec = 0.6592
2023-12-26 12:53:57,420 -   rec = 0.692
2023-12-26 12:53:57,420 - Testing is finished...
2023-12-26 12:53:57,420 - Multimodal intent recognition is finished...
2023-12-26 12:53:57,420 - Results are saved in results/msz.csv
