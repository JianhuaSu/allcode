2024-03-13 04:38:46,684 - ============================== Params ==============================
2024-03-13 04:38:46,684 - logger_name: msz_MIntRec2_multi-class_seed-2_2024-03-13-04-38-46
2024-03-13 04:38:46,684 - dataset: MIntRec2
2024-03-13 04:38:46,684 - data_mode: multi-class
2024-03-13 04:38:46,684 - method: msz
2024-03-13 04:38:46,684 - text_backbone: bert-base-uncased
2024-03-13 04:38:46,684 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-13 04:38:46,684 - seed: 2
2024-03-13 04:38:46,684 - num_workers: 8
2024-03-13 04:38:46,684 - gpu_id: 3
2024-03-13 04:38:46,684 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-13 04:38:46,684 - train: True
2024-03-13 04:38:46,684 - tune: True
2024-03-13 04:38:46,684 - save_model: False
2024-03-13 04:38:46,684 - save_results: True
2024-03-13 04:38:46,685 - log_path: logs
2024-03-13 04:38:46,685 - cache_path: 
2024-03-13 04:38:46,685 - video_data_path: video_data
2024-03-13 04:38:46,685 - audio_data_path: audio_data
2024-03-13 04:38:46,685 - video_feats_path: video_feats.pkl
2024-03-13 04:38:46,685 - audio_feats_path: audio_feats.pkl
2024-03-13 04:38:46,685 - results_path: results
2024-03-13 04:38:46,685 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-13 04:38:46,685 - model_path: models
2024-03-13 04:38:46,685 - config_file_name: msz_MIntRec2
2024-03-13 04:38:46,685 - results_file_name: msz.csv
2024-03-13 04:38:46,685 - padding_mode: zero
2024-03-13 04:38:46,685 - padding_loc: end
2024-03-13 04:38:46,685 - need_aligned: False
2024-03-13 04:38:46,685 - eval_monitor: f1
2024-03-13 04:38:46,685 - train_batch_size: 32
2024-03-13 04:38:46,685 - eval_batch_size: 16
2024-03-13 04:38:46,685 - test_batch_size: 16
2024-03-13 04:38:46,685 - wait_patience: 8
2024-03-13 04:38:46,685 - hidden_dims: 768
2024-03-13 04:38:46,685 - num_attention_heads: 6
2024-03-13 04:38:46,685 - attention_probs_dropout_prob: 0.3
2024-03-13 04:38:46,685 - hidden_dropout_prob: 0.5
2024-03-13 04:38:46,685 - intermediate_size: 768
2024-03-13 04:38:46,685 - num_hidden_layers: 6
2024-03-13 04:38:46,685 - max_position_embeddings: 1000
2024-03-13 04:38:46,685 - position_embedding_type: absolute
2024-03-13 04:38:46,685 - batch_first: True
2024-03-13 04:38:46,685 - dropout: 0.2
2024-03-13 04:38:46,685 - aligned_method: conv1d
2024-03-13 04:38:46,685 - num_train_epochs: 100
2024-03-13 04:38:46,685 - lr: 3e-06
2024-03-13 04:38:46,685 - lr_mode: min
2024-03-13 04:38:46,685 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-2_2024-03-13-04-38-46
2024-03-13 04:38:46,685 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-2_2024-03-13-04-38-46/models
2024-03-13 04:38:46,685 - ============================== End Params ==============================
2024-03-13 04:38:46,872 - Generate Text Features Begin...
2024-03-13 04:38:48,665 - Generate Text Features Finished...
2024-03-13 04:38:48,686 - Load Video Features Begin...
2024-03-13 04:39:04,435 - Load Video Features Finished...
2024-03-13 04:39:06,252 - Load Audio Features Begin...
2024-03-13 04:40:00,745 - Load Audio Features Finished...
2024-03-13 04:40:17,454 - method  begins...
2024-03-13 04:40:22,480 - Multimodal intent recognition begins...
2024-03-13 04:40:22,480 - Training begins...
2024-03-13 04:41:40,714 - ***** Epoch: 1: Eval results *****
2024-03-13 04:41:40,715 -   train_loss = 3.0371
2024-03-13 04:41:40,715 -   best_eval_score = 0.0
2024-03-13 04:41:40,715 -   eval_score = 0.1761
2024-03-13 04:42:55,375 - ***** Epoch: 2: Eval results *****
2024-03-13 04:42:55,376 -   train_loss = 2.2271
2024-03-13 04:42:55,376 -   best_eval_score = 0.1761
2024-03-13 04:42:55,376 -   eval_score = 0.303
2024-03-13 04:44:07,623 - ***** Epoch: 3: Eval results *****
2024-03-13 04:44:07,632 -   train_loss = 1.7115
2024-03-13 04:44:07,632 -   best_eval_score = 0.303
2024-03-13 04:44:07,632 -   eval_score = 0.3727
2024-03-13 04:45:17,489 - ***** Epoch: 4: Eval results *****
2024-03-13 04:45:17,498 -   train_loss = 1.4439
2024-03-13 04:45:17,498 -   best_eval_score = 0.3727
2024-03-13 04:45:17,498 -   eval_score = 0.426
2024-03-13 04:46:28,428 - ***** Epoch: 5: Eval results *****
2024-03-13 04:46:28,428 -   train_loss = 1.275
2024-03-13 04:46:28,428 -   best_eval_score = 0.426
2024-03-13 04:46:28,428 -   eval_score = 0.4507
2024-03-13 04:47:40,120 - ***** Epoch: 6: Eval results *****
2024-03-13 04:47:40,129 -   train_loss = 1.1404
2024-03-13 04:47:40,129 -   best_eval_score = 0.4507
2024-03-13 04:47:40,129 -   eval_score = 0.47
2024-03-13 04:48:51,433 - ***** Epoch: 7: Eval results *****
2024-03-13 04:48:51,433 -   train_loss = 1.0291
2024-03-13 04:48:51,433 -   best_eval_score = 0.47
2024-03-13 04:48:51,433 -   eval_score = 0.4683
2024-03-13 04:48:51,433 - EarlyStopping counter: 1 out of 8
2024-03-13 04:50:01,488 - ***** Epoch: 8: Eval results *****
2024-03-13 04:50:01,489 -   train_loss = 0.927
2024-03-13 04:50:01,489 -   best_eval_score = 0.47
2024-03-13 04:50:01,489 -   eval_score = 0.4895
2024-03-13 04:51:15,837 - ***** Epoch: 9: Eval results *****
2024-03-13 04:51:15,837 -   train_loss = 0.8326
2024-03-13 04:51:15,837 -   best_eval_score = 0.4895
2024-03-13 04:51:15,837 -   eval_score = 0.4914
2024-03-13 04:52:28,106 - ***** Epoch: 10: Eval results *****
2024-03-13 04:52:28,107 -   train_loss = 0.7413
2024-03-13 04:52:28,107 -   best_eval_score = 0.4914
2024-03-13 04:52:28,107 -   eval_score = 0.4907
2024-03-13 04:52:28,107 - EarlyStopping counter: 1 out of 8
2024-03-13 04:53:38,197 - ***** Epoch: 11: Eval results *****
2024-03-13 04:53:38,197 -   train_loss = 0.6466
2024-03-13 04:53:38,197 -   best_eval_score = 0.4914
2024-03-13 04:53:38,197 -   eval_score = 0.4996
2024-03-13 04:54:52,862 - ***** Epoch: 12: Eval results *****
2024-03-13 04:54:52,863 -   train_loss = 0.6354
2024-03-13 04:54:52,863 -   best_eval_score = 0.4996
2024-03-13 04:54:52,863 -   eval_score = 0.5024
2024-03-13 04:56:03,092 - ***** Epoch: 13: Eval results *****
2024-03-13 04:56:03,092 -   train_loss = 0.6254
2024-03-13 04:56:03,092 -   best_eval_score = 0.5024
2024-03-13 04:56:03,092 -   eval_score = 0.5016
2024-03-13 04:56:03,092 - EarlyStopping counter: 1 out of 8
2024-03-13 04:57:14,551 - ***** Epoch: 14: Eval results *****
2024-03-13 04:57:14,552 -   train_loss = 0.6156
2024-03-13 04:57:14,552 -   best_eval_score = 0.5024
2024-03-13 04:57:14,552 -   eval_score = 0.499
2024-03-13 04:57:14,552 - EarlyStopping counter: 2 out of 8
2024-03-13 04:58:25,531 - ***** Epoch: 15: Eval results *****
2024-03-13 04:58:25,531 -   train_loss = 0.604
2024-03-13 04:58:25,531 -   best_eval_score = 0.5024
2024-03-13 04:58:25,531 -   eval_score = 0.5003
2024-03-13 04:58:25,531 - EarlyStopping counter: 3 out of 8
2024-03-13 04:59:35,871 - ***** Epoch: 16: Eval results *****
2024-03-13 04:59:35,872 -   train_loss = 0.5921
2024-03-13 04:59:35,872 -   best_eval_score = 0.5024
2024-03-13 04:59:35,872 -   eval_score = 0.5069
2024-03-13 05:00:49,627 - ***** Epoch: 17: Eval results *****
2024-03-13 05:00:49,627 -   train_loss = 0.5866
2024-03-13 05:00:49,627 -   best_eval_score = 0.5069
2024-03-13 05:00:49,627 -   eval_score = 0.5039
2024-03-13 05:00:49,628 - EarlyStopping counter: 1 out of 8
2024-03-13 05:02:02,356 - ***** Epoch: 18: Eval results *****
2024-03-13 05:02:02,357 -   train_loss = 0.5834
2024-03-13 05:02:02,357 -   best_eval_score = 0.5069
2024-03-13 05:02:02,357 -   eval_score = 0.5045
2024-03-13 05:02:02,357 - EarlyStopping counter: 2 out of 8
2024-03-13 05:03:12,430 - ***** Epoch: 19: Eval results *****
2024-03-13 05:03:12,439 -   train_loss = 0.5661
2024-03-13 05:03:12,439 -   best_eval_score = 0.5069
2024-03-13 05:03:12,439 -   eval_score = 0.505
2024-03-13 05:03:12,439 - EarlyStopping counter: 3 out of 8
2024-03-13 05:04:23,358 - ***** Epoch: 20: Eval results *****
2024-03-13 05:04:23,358 -   train_loss = 0.5709
2024-03-13 05:04:23,358 -   best_eval_score = 0.5069
2024-03-13 05:04:23,358 -   eval_score = 0.5048
2024-03-13 05:04:23,358 - EarlyStopping counter: 4 out of 8
2024-03-13 05:05:33,626 - ***** Epoch: 21: Eval results *****
2024-03-13 05:05:33,627 -   train_loss = 0.5635
2024-03-13 05:05:33,627 -   best_eval_score = 0.5069
2024-03-13 05:05:33,627 -   eval_score = 0.5069
2024-03-13 05:05:33,627 - EarlyStopping counter: 5 out of 8
2024-03-13 05:06:44,864 - ***** Epoch: 22: Eval results *****
2024-03-13 05:06:44,864 -   train_loss = 0.5564
2024-03-13 05:06:44,864 -   best_eval_score = 0.5069
2024-03-13 05:06:44,864 -   eval_score = 0.5065
2024-03-13 05:06:44,864 - EarlyStopping counter: 6 out of 8
2024-03-13 05:07:59,322 - ***** Epoch: 23: Eval results *****
2024-03-13 05:07:59,330 -   train_loss = 0.5652
2024-03-13 05:07:59,330 -   best_eval_score = 0.5069
2024-03-13 05:07:59,330 -   eval_score = 0.5071
2024-03-13 05:09:11,890 - ***** Epoch: 24: Eval results *****
2024-03-13 05:09:11,890 -   train_loss = 0.5602
2024-03-13 05:09:11,890 -   best_eval_score = 0.5071
2024-03-13 05:09:11,890 -   eval_score = 0.5077
2024-03-13 05:10:22,892 - ***** Epoch: 25: Eval results *****
2024-03-13 05:10:22,893 -   train_loss = 0.5566
2024-03-13 05:10:22,893 -   best_eval_score = 0.5077
2024-03-13 05:10:22,893 -   eval_score = 0.5069
2024-03-13 05:10:22,893 - EarlyStopping counter: 1 out of 8
2024-03-13 05:11:34,381 - ***** Epoch: 26: Eval results *****
2024-03-13 05:11:34,381 -   train_loss = 0.5593
2024-03-13 05:11:34,381 -   best_eval_score = 0.5077
2024-03-13 05:11:34,381 -   eval_score = 0.5088
2024-03-13 05:12:44,573 - ***** Epoch: 27: Eval results *****
2024-03-13 05:12:44,573 -   train_loss = 0.5539
2024-03-13 05:12:44,573 -   best_eval_score = 0.5088
2024-03-13 05:12:44,573 -   eval_score = 0.5088
2024-03-13 05:12:44,574 - EarlyStopping counter: 1 out of 8
2024-03-13 05:13:54,553 - ***** Epoch: 28: Eval results *****
2024-03-13 05:13:54,554 -   train_loss = 0.5568
2024-03-13 05:13:54,554 -   best_eval_score = 0.5088
2024-03-13 05:13:54,554 -   eval_score = 0.5094
2024-03-13 05:15:03,933 - ***** Epoch: 29: Eval results *****
2024-03-13 05:15:03,933 -   train_loss = 0.5537
2024-03-13 05:15:03,933 -   best_eval_score = 0.5094
2024-03-13 05:15:03,933 -   eval_score = 0.5094
2024-03-13 05:15:03,934 - EarlyStopping counter: 1 out of 8
2024-03-13 05:16:14,808 - ***** Epoch: 30: Eval results *****
2024-03-13 05:16:14,808 -   train_loss = 0.5545
2024-03-13 05:16:14,808 -   best_eval_score = 0.5094
2024-03-13 05:16:14,808 -   eval_score = 0.5094
2024-03-13 05:16:14,808 - EarlyStopping counter: 2 out of 8
2024-03-13 05:17:24,862 - ***** Epoch: 31: Eval results *****
2024-03-13 05:17:24,863 -   train_loss = 0.5532
2024-03-13 05:17:24,863 -   best_eval_score = 0.5094
2024-03-13 05:17:24,863 -   eval_score = 0.5094
2024-03-13 05:17:24,863 - EarlyStopping counter: 3 out of 8
2024-03-13 05:18:34,194 - ***** Epoch: 32: Eval results *****
2024-03-13 05:18:34,195 -   train_loss = 0.5583
2024-03-13 05:18:34,195 -   best_eval_score = 0.5094
2024-03-13 05:18:34,195 -   eval_score = 0.5094
2024-03-13 05:18:34,195 - EarlyStopping counter: 4 out of 8
2024-03-13 05:19:44,371 - ***** Epoch: 33: Eval results *****
2024-03-13 05:19:44,371 -   train_loss = 0.5559
2024-03-13 05:19:44,372 -   best_eval_score = 0.5094
2024-03-13 05:19:44,372 -   eval_score = 0.5094
2024-03-13 05:19:44,372 - EarlyStopping counter: 5 out of 8
2024-03-13 05:20:56,169 - ***** Epoch: 34: Eval results *****
2024-03-13 05:20:56,169 -   train_loss = 0.5593
2024-03-13 05:20:56,169 -   best_eval_score = 0.5094
2024-03-13 05:20:56,169 -   eval_score = 0.5094
2024-03-13 05:20:56,169 - EarlyStopping counter: 6 out of 8
2024-03-13 05:22:08,104 - ***** Epoch: 35: Eval results *****
2024-03-13 05:22:08,113 -   train_loss = 0.5531
2024-03-13 05:22:08,113 -   best_eval_score = 0.5094
2024-03-13 05:22:08,114 -   eval_score = 0.5094
2024-03-13 05:22:08,114 - EarlyStopping counter: 7 out of 8
2024-03-13 05:23:19,080 - ***** Epoch: 36: Eval results *****
2024-03-13 05:23:19,080 -   train_loss = 0.561
2024-03-13 05:23:19,080 -   best_eval_score = 0.5094
2024-03-13 05:23:19,080 -   eval_score = 0.5094
2024-03-13 05:23:19,081 - EarlyStopping counter: 8 out of 8
2024-03-13 05:23:19,081 - EarlyStopping at epoch 36
2024-03-13 05:23:19,085 - Training is finished...
2024-03-13 05:23:19,086 - Testing begins...
2024-03-13 05:23:32,002 - ***** Test: Confusion Matrix *****
2024-03-13 05:23:32,005 - [[ 48   0  15   0   0   0   0   0   0   0   2   0   0   0   0   0   0   1
    0   0   0   1   0   0   1   0   0   0   0   0]
 [  0  58   0   0   7   1   5   0   0   0   1   1   4   0   4   0   0   8
    0   0   0   3   1   0   2   0   0   2   0   0]
 [ 10   0  43   0   1   0   0   0   0   0   1   0   0   1   2   0   0   2
    0   0   0   0   0   1   3   0   0   0   0   0]
 [  0   0   0  60   0   0   0   1   0   1   0   0   0   0   2   0   0   1
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   6   0   0  35   0   0   0   1   0   0   0   0   0   0   0   0   3
    0   1   0   2   0   1   1   0   0   0   1   0]
 [  0   1   0   0   2  22   0   0   0   1   1   0   0   0   1   0   0   8
    0   0   0   0   0   0   0   0   1   0   0   0]
 [  0   1   0   0   0   2  28   8   0   1   2   0   6   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   6  29   0   0   3   1   6   0   0   0   1   0
    0   0   0   0   1   0   0   0   0   0   0   0]
 [  1   2   1   3   1   0   0   0  20   0   0   2   0   0   5   0   0   5
    0   0   0   0   7   0   2   0   0   0   0   0]
 [  0   1   0   0   0   0   0   0   3  55   0   6   5   0  15   0   0   6
    0   0   0   0   2   1   5   1   1   6   0   0]
 [  2   0   0   0   0   3   4   3   0   1  45   0  28   0   1   0   1   2
    0   2   0   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   1   0   0   4   1  25   7   0   1   0   0   0
    1   0   0   0   3   0   1   0   0   3   0   0]
 [  0   2   0   0   0   0   2  10   0   6  26   2  84   0   0   0   1   0
    0   0   0   0   2   0   0   0   0   0   0   0]
 [  0   0   2   0   1   0   0   0   1   2   0   0   0   0   6   0   0   0
    4   0   0   0   1   0   0   0   0   0   0   0]
 [  0   3   2   0   1   2   0   0   3   9   3   1   1   0 124   0   0  19
    3   0   0   0  13   0   4   0   0   5   0   0]
 [  0   0   1   0   0   0   0   0   0   3   0   0   0   0   2   2   0   3
    3   0   0   1   2   0   1   0   0   2   1   1]
 [  0   0   0   0   1   0   1   2   0   0   2   0   1   0   0   0  53   0
    4   0   0   0   0   0   2   0   0   0   0   0]
 [  0   4   1   0   7   5   0   0   2  15   0   0   1   0  20   2   2 115
   13   1   0   4   8   9   0   2   0   4   1   1]
 [  0   2   1   0   0   0   0   0   1   4   2   0   0   0  10   0   1   6
   28   0   2   0   1   0   2   0   0   0   0   0]
 [  0   5   0   0   0   0   2   0   0   0   1   0   0   0   0   0   0   0
    0   8   0   1   0   0   0   0   0   0   0   0]
 [  0   1   2   0   1   0   0   0   0   2   1   1   0   0   5   0   0   4
    5   0   3   0   0   1   2   0   0   1   0   0]
 [  5   1   0   0   1   0   0   0   0   4   0   1   0   0   0   0   6   1
    0   0   0  25   0   6   1   0   1   0   0   1]
 [  0   0   1   1   1   0   0   0   1   4   0   3   0   1  10   0   0   1
    0   0   0   0  87   0   1   4   2   0   0   0]
 [  0   3   1   0   1   0   0   0   0   0   0   0   0   0   0   0   0   6
    1   0   0   3   0  23   0   0   0   0   0   0]
 [  1   0   3   0   0   0   0   0   0   1   1   1   0   0   3   0   0   3
    0   0   0   0   1   1  87   0   0   9   2   0]
 [  1   1   0   0   0   0   0   0   1   0   0   1   0   0   0   0   0   2
    0   0   0   0   3   0   1  20   0   0   0   1]
 [  0   0   0   1   0   0   0   0   0   2   0   0   0   0   0   0   0   4
    0   0   0   4   2   0   0   0   3   0   1   0]
 [  1   2   1   0   0   0   0   0   1   8   2   5   4   0   5   0   0   3
    2   0   0   0   1   0   8   1   0  12   1   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   1   0
    0   0   0   0   0   0   0   0   0   0  56   0]
 [  0   1   0   0   3   0   0   0   3   2   1   1   0   0   0   0   0   3
    1   0   0   0   0   0   1   1   0   0   0   2]]
2024-03-13 05:23:32,005 - ***** Evaluation results *****
2024-03-13 05:23:32,005 -   acc = 0.5903
2024-03-13 05:23:32,005 -   f1 = 0.5255
2024-03-13 05:23:32,005 -   prec = 0.5572
2024-03-13 05:23:32,005 -   rec = 0.5246
2024-03-13 05:23:32,006 - Testing is finished...
2024-03-13 05:23:32,006 - Multimodal intent recognition is finished...
2024-03-13 05:23:32,006 - Results are saved in results/msz.csv
