2024-03-31 15:56:04,576 - ============================== Params ==============================
2024-03-31 15:56:04,577 - logger_name: msz_MIntRec_multi-class_seed-1_2024-03-31-15-56-04
2024-03-31 15:56:04,577 - dataset: MIntRec
2024-03-31 15:56:04,577 - data_mode: multi-class
2024-03-31 15:56:04,577 - method: msz
2024-03-31 15:56:04,577 - text_backbone: bert-base-uncased
2024-03-31 15:56:04,577 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-31 15:56:04,577 - seed: 1
2024-03-31 15:56:04,577 - num_workers: 8
2024-03-31 15:56:04,577 - gpu_id: 3
2024-03-31 15:56:04,577 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-31 15:56:04,577 - train: True
2024-03-31 15:56:04,578 - tune: True
2024-03-31 15:56:04,578 - save_model: False
2024-03-31 15:56:04,578 - save_results: True
2024-03-31 15:56:04,578 - log_path: logs
2024-03-31 15:56:04,578 - cache_path: 
2024-03-31 15:56:04,578 - video_data_path: video_data
2024-03-31 15:56:04,578 - audio_data_path: audio_data
2024-03-31 15:56:04,578 - video_feats_path: video_feats.pkl
2024-03-31 15:56:04,578 - audio_feats_path: audio_feats.pkl
2024-03-31 15:56:04,578 - results_path: results
2024-03-31 15:56:04,578 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-03-31 15:56:04,578 - model_path: models
2024-03-31 15:56:04,578 - config_file_name: msz_MIntRec
2024-03-31 15:56:04,578 - results_file_name: msz.csv
2024-03-31 15:56:04,578 - padding_mode: zero
2024-03-31 15:56:04,578 - padding_loc: end
2024-03-31 15:56:04,579 - need_aligned: False
2024-03-31 15:56:04,579 - eval_monitor: f1
2024-03-31 15:56:04,579 - train_batch_size: 16
2024-03-31 15:56:04,579 - eval_batch_size: 8
2024-03-31 15:56:04,579 - test_batch_size: 8
2024-03-31 15:56:04,579 - wait_patience: 8
2024-03-31 15:56:04,579 - hidden_dims: 768
2024-03-31 15:56:04,579 - num_attention_heads: 8
2024-03-31 15:56:04,579 - attention_probs_dropout_prob: 0.2
2024-03-31 15:56:04,579 - hidden_dropout_prob: 0.2
2024-03-31 15:56:04,579 - intermediate_size: 768
2024-03-31 15:56:04,579 - num_hidden_layers: 8
2024-03-31 15:56:04,579 - max_position_embeddings: 768
2024-03-31 15:56:04,579 - position_embedding_type: absolute
2024-03-31 15:56:04,579 - batch_first: True
2024-03-31 15:56:04,580 - dropout: 0.4
2024-03-31 15:56:04,580 - aligned_method: conv1d
2024-03-31 15:56:04,580 - num_train_epochs: 100
2024-03-31 15:56:04,580 - lr: 6e-05
2024-03-31 15:56:04,580 - lr_mode: max
2024-03-31 15:56:04,580 - patience: 8
2024-03-31 15:56:04,580 - factor: 0.1
2024-03-31 15:56:04,580 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-03-31-15-56-04
2024-03-31 15:56:04,580 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-03-31-15-56-04/models
2024-03-31 15:56:04,580 - num_labels: 20
2024-03-31 15:56:04,580 - text_feat_dim: 768
2024-03-31 15:56:04,580 - video_feat_dim: 256
2024-03-31 15:56:04,580 - audio_feat_dim: 768
2024-03-31 15:56:04,580 - text_seq_len: 30
2024-03-31 15:56:04,580 - video_seq_len: 230
2024-03-31 15:56:04,581 - audio_seq_len: 480
2024-03-31 15:56:04,581 - device: cuda:3
2024-03-31 15:56:04,581 - ============================== End Params ==============================
2024-03-31 15:56:05,101 - Generate Text Features Begin...
2024-03-31 15:56:06,208 - Generate Text Features Finished...
2024-03-31 15:56:06,241 - Load Video Features Begin...
2024-03-31 15:56:28,247 - Load Video Features Finished...
2024-03-31 15:56:30,379 - Load Audio Features Begin...
2024-03-31 15:57:36,794 - Load Audio Features Finished...
2024-03-31 15:57:46,836 - method  begins...
2024-03-31 15:58:07,160 - Multimodal intent recognition begins...
2024-03-31 15:58:07,160 - Training begins...
2024-03-31 15:58:27,729 - ***** Epoch: 1: Eval results *****
2024-03-31 15:58:27,730 -   train_loss = 2.4099
2024-03-31 15:58:27,730 -   best_eval_score = 0.0
2024-03-31 15:58:27,730 -   eval_score = 0.4326
2024-03-31 15:58:47,062 - ***** Epoch: 2: Eval results *****
2024-03-31 15:58:47,070 -   train_loss = 1.2241
2024-03-31 15:58:47,070 -   best_eval_score = 0.4326
2024-03-31 15:58:47,071 -   eval_score = 0.5647
2024-03-31 15:59:06,886 - ***** Epoch: 3: Eval results *****
2024-03-31 15:59:06,895 -   train_loss = 0.7314
2024-03-31 15:59:06,895 -   best_eval_score = 0.5647
2024-03-31 15:59:06,895 -   eval_score = 0.5641
2024-03-31 15:59:06,895 - EarlyStopping counter: 1 out of 8
2024-03-31 15:59:27,481 - ***** Epoch: 4: Eval results *****
2024-03-31 15:59:27,481 -   train_loss = 0.4744
2024-03-31 15:59:27,481 -   best_eval_score = 0.5647
2024-03-31 15:59:27,481 -   eval_score = 0.6279
2024-03-31 15:59:48,583 - ***** Epoch: 5: Eval results *****
2024-03-31 15:59:48,592 -   train_loss = 0.4548
2024-03-31 15:59:48,592 -   best_eval_score = 0.6279
2024-03-31 15:59:48,592 -   eval_score = 0.6265
2024-03-31 15:59:48,592 - EarlyStopping counter: 1 out of 8
2024-03-31 16:00:09,545 - ***** Epoch: 6: Eval results *****
2024-03-31 16:00:09,545 -   train_loss = 0.2618
2024-03-31 16:00:09,545 -   best_eval_score = 0.6279
2024-03-31 16:00:09,545 -   eval_score = 0.6263
2024-03-31 16:00:09,546 - EarlyStopping counter: 2 out of 8
2024-03-31 16:00:30,902 - ***** Epoch: 7: Eval results *****
2024-03-31 16:00:30,903 -   train_loss = 0.2111
2024-03-31 16:00:30,903 -   best_eval_score = 0.6279
2024-03-31 16:00:30,903 -   eval_score = 0.6351
2024-03-31 16:00:53,495 - ***** Epoch: 8: Eval results *****
2024-03-31 16:00:53,496 -   train_loss = 0.221
2024-03-31 16:00:53,496 -   best_eval_score = 0.6351
2024-03-31 16:00:53,496 -   eval_score = 0.5891
2024-03-31 16:00:53,496 - EarlyStopping counter: 1 out of 8
2024-03-31 16:01:16,091 - ***** Epoch: 9: Eval results *****
2024-03-31 16:01:16,091 -   train_loss = 0.159
2024-03-31 16:01:16,091 -   best_eval_score = 0.6351
2024-03-31 16:01:16,091 -   eval_score = 0.6472
2024-03-31 16:01:38,297 - ***** Epoch: 10: Eval results *****
2024-03-31 16:01:38,297 -   train_loss = 0.1574
2024-03-31 16:01:38,297 -   best_eval_score = 0.6472
2024-03-31 16:01:38,297 -   eval_score = 0.651
2024-03-31 16:01:59,891 - ***** Epoch: 11: Eval results *****
2024-03-31 16:01:59,892 -   train_loss = 0.0566
2024-03-31 16:01:59,892 -   best_eval_score = 0.651
2024-03-31 16:01:59,892 -   eval_score = 0.6573
2024-03-31 16:02:23,421 - ***** Epoch: 12: Eval results *****
2024-03-31 16:02:23,421 -   train_loss = 0.0183
2024-03-31 16:02:23,421 -   best_eval_score = 0.6573
2024-03-31 16:02:23,421 -   eval_score = 0.6559
2024-03-31 16:02:23,421 - EarlyStopping counter: 1 out of 8
2024-03-31 16:02:43,324 - ***** Epoch: 13: Eval results *****
2024-03-31 16:02:43,325 -   train_loss = 0.0148
2024-03-31 16:02:43,325 -   best_eval_score = 0.6573
2024-03-31 16:02:43,325 -   eval_score = 0.6609
2024-03-31 16:03:04,143 - ***** Epoch: 14: Eval results *****
2024-03-31 16:03:04,143 -   train_loss = 0.0129
2024-03-31 16:03:04,143 -   best_eval_score = 0.6609
2024-03-31 16:03:04,143 -   eval_score = 0.658
2024-03-31 16:03:04,143 - EarlyStopping counter: 1 out of 8
2024-03-31 16:03:24,372 - ***** Epoch: 15: Eval results *****
2024-03-31 16:03:24,373 -   train_loss = 0.0105
2024-03-31 16:03:24,373 -   best_eval_score = 0.6609
2024-03-31 16:03:24,373 -   eval_score = 0.655
2024-03-31 16:03:24,373 - EarlyStopping counter: 2 out of 8
2024-03-31 16:03:44,482 - ***** Epoch: 16: Eval results *****
2024-03-31 16:03:44,482 -   train_loss = 0.0112
2024-03-31 16:03:44,482 -   best_eval_score = 0.6609
2024-03-31 16:03:44,483 -   eval_score = 0.6633
2024-03-31 16:04:06,675 - ***** Epoch: 17: Eval results *****
2024-03-31 16:04:06,676 -   train_loss = 0.009
2024-03-31 16:04:06,676 -   best_eval_score = 0.6633
2024-03-31 16:04:06,676 -   eval_score = 0.6583
2024-03-31 16:04:06,676 - EarlyStopping counter: 1 out of 8
2024-03-31 16:04:28,756 - ***** Epoch: 18: Eval results *****
2024-03-31 16:04:28,756 -   train_loss = 0.008
2024-03-31 16:04:28,756 -   best_eval_score = 0.6633
2024-03-31 16:04:28,757 -   eval_score = 0.6589
2024-03-31 16:04:28,757 - EarlyStopping counter: 2 out of 8
2024-03-31 16:04:55,093 - ***** Epoch: 19: Eval results *****
2024-03-31 16:04:55,094 -   train_loss = 0.0077
2024-03-31 16:04:55,094 -   best_eval_score = 0.6633
2024-03-31 16:04:55,094 -   eval_score = 0.6583
2024-03-31 16:04:55,094 - EarlyStopping counter: 3 out of 8
2024-03-31 16:05:19,068 - ***** Epoch: 20: Eval results *****
2024-03-31 16:05:19,069 -   train_loss = 0.007
2024-03-31 16:05:19,069 -   best_eval_score = 0.6633
2024-03-31 16:05:19,069 -   eval_score = 0.6583
2024-03-31 16:05:19,069 - EarlyStopping counter: 4 out of 8
2024-03-31 16:05:43,482 - ***** Epoch: 21: Eval results *****
2024-03-31 16:05:43,482 -   train_loss = 0.0076
2024-03-31 16:05:43,482 -   best_eval_score = 0.6633
2024-03-31 16:05:43,482 -   eval_score = 0.6583
2024-03-31 16:05:43,482 - EarlyStopping counter: 5 out of 8
2024-03-31 16:06:10,090 - ***** Epoch: 22: Eval results *****
2024-03-31 16:06:10,091 -   train_loss = 0.0068
2024-03-31 16:06:10,091 -   best_eval_score = 0.6633
2024-03-31 16:06:10,091 -   eval_score = 0.6583
2024-03-31 16:06:10,091 - EarlyStopping counter: 6 out of 8
2024-03-31 16:06:32,730 - ***** Epoch: 23: Eval results *****
2024-03-31 16:06:32,731 -   train_loss = 0.0081
2024-03-31 16:06:32,731 -   best_eval_score = 0.6633
2024-03-31 16:06:32,731 -   eval_score = 0.6583
2024-03-31 16:06:32,731 - EarlyStopping counter: 7 out of 8
2024-03-31 16:06:56,852 - ***** Epoch: 24: Eval results *****
2024-03-31 16:06:56,853 -   train_loss = 0.0077
2024-03-31 16:06:56,853 -   best_eval_score = 0.6633
2024-03-31 16:06:56,853 -   eval_score = 0.6583
2024-03-31 16:06:56,853 - EarlyStopping counter: 8 out of 8
2024-03-31 16:06:56,853 - EarlyStopping at epoch 24
2024-03-31 16:06:56,875 - Training is finished...
2024-03-31 16:06:56,875 - Testing begins...
2024-03-31 16:07:08,089 - ***** Test: Confusion Matrix *****
2024-03-31 16:07:08,091 - [[35  2  0  0  7  0  0  1  1  4  0  0  5  1  0  0  0  0  0  1]
 [ 0 39  0  1  0  0  2  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 0  0 27  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 3  0  0  0 13  0  3  0  0  0  0  1  2  0  1  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 1  0  0  0  4  0  2  0  2  0  0  1  1  0  0  1  0  0  0  0]
 [ 4  1  0  0  0  0  0  4  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  2  4  0  0  0  1  1  0  0  0  0  0  1]
 [ 1  1  0  0  1  0  0  0  0  3  0  0  0  0  0  3  0  1  0  0]
 [ 2  0  0  0  0  0  1  0  0  2 12  0  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0  1]
 [ 2  2  0  0  1  0  3  1  1  0  1  1 38  1  2  2  0  1  1  0]
 [ 1  0  0  0  0  0  0  0  0  0  1  1  2 17  2  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  0  0  0  0  3 15  0  0  0  0  2]
 [ 0  0  0  0  1  0  0  1  1  0  0  0  5  0  1 12  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  4  0  2  0 11  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  1  1  0  2  0  0  0  0 10  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  0  0  0  0  7]]
2024-03-31 16:07:08,092 - ***** Evaluation results *****
2024-03-31 16:07:08,092 -   acc = 0.7011
2024-03-31 16:07:08,092 -   f1 = 0.6689
2024-03-31 16:07:08,092 -   prec = 0.6825
2024-03-31 16:07:08,092 -   rec = 0.6624
2024-03-31 16:07:08,092 - Testing is finished...
2024-03-31 16:07:08,092 - Multimodal intent recognition is finished...
2024-03-31 16:07:08,092 - Results are saved in results/msz.csv
