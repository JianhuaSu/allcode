2024-01-07 11:34:36,995 - ============================== Params ==============================
2024-01-07 11:34:36,995 - logger_name: msz_MIntRec_multi-class_seed-2_2024-01-07-11-34-36
2024-01-07 11:34:36,995 - dataset: MIntRec
2024-01-07 11:34:36,995 - data_mode: multi-class
2024-01-07 11:34:36,995 - method: msz
2024-01-07 11:34:36,995 - text_backbone: bert-base-uncased
2024-01-07 11:34:36,995 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-07 11:34:36,995 - seed: 2
2024-01-07 11:34:36,995 - num_workers: 8
2024-01-07 11:34:36,995 - gpu_id: 1
2024-01-07 11:34:36,995 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-07 11:34:36,995 - train: True
2024-01-07 11:34:36,995 - tune: False
2024-01-07 11:34:36,995 - save_model: False
2024-01-07 11:34:36,995 - save_results: True
2024-01-07 11:34:36,995 - log_path: logs
2024-01-07 11:34:36,995 - cache_path: 
2024-01-07 11:34:36,995 - video_data_path: video_data
2024-01-07 11:34:36,995 - audio_data_path: audio_data
2024-01-07 11:34:36,995 - video_feats_path: video_feats.pkl
2024-01-07 11:34:36,995 - audio_feats_path: audio_feats.pkl
2024-01-07 11:34:36,995 - results_path: results
2024-01-07 11:34:36,995 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-07 11:34:36,995 - model_path: models
2024-01-07 11:34:36,995 - config_file_name: msz
2024-01-07 11:34:36,995 - results_file_name: msz.csv
2024-01-07 11:34:36,995 - padding_mode: zero
2024-01-07 11:34:36,995 - padding_loc: end
2024-01-07 11:34:36,995 - need_aligned: False
2024-01-07 11:34:36,996 - eval_monitor: f1
2024-01-07 11:34:36,996 - train_batch_size: 16
2024-01-07 11:34:36,996 - eval_batch_size: 8
2024-01-07 11:34:36,996 - test_batch_size: 8
2024-01-07 11:34:36,996 - wait_patience: 8
2024-01-07 11:34:36,996 - nheads: 2
2024-01-07 11:34:36,996 - encoder_layers: 2
2024-01-07 11:34:36,996 - attn_dropout: 0.1
2024-01-07 11:34:36,996 - relu_dropout: 0.1
2024-01-07 11:34:36,996 - embed_dropout: 0.1
2024-01-07 11:34:36,996 - res_dropout: 0.1
2024-01-07 11:34:36,996 - attn_mask: False
2024-01-07 11:34:36,996 - hidden_size: 768
2024-01-07 11:34:36,996 - num_attention_heads: 12
2024-01-07 11:34:36,996 - attention_probs_dropout_prob: 0.2
2024-01-07 11:34:36,996 - hidden_dropout_prob: 0.2
2024-01-07 11:34:36,996 - intermediate_size: 768
2024-01-07 11:34:36,996 - num_hidden_layers: 3
2024-01-07 11:34:36,996 - max_position_embeddings: 512
2024-01-07 11:34:36,996 - position_embedding_type: absolute
2024-01-07 11:34:36,996 - batch_first: True
2024-01-07 11:34:36,996 - hidden_dims: 768
2024-01-07 11:34:36,996 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-07 11:34:36,996 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-07 11:34:36,996 - ta_loss: 0.1
2024-01-07 11:34:36,996 - tv_loss: 0.1
2024-01-07 11:34:36,996 - av_loss: 0.1
2024-01-07 11:34:36,996 - aligned_method: avg_pool
2024-01-07 11:34:36,996 - grad_clip: -1
2024-01-07 11:34:36,996 - num_train_epochs: 100
2024-01-07 11:34:36,996 - warmup_proportion: 0.1
2024-01-07 11:34:36,996 - lr: 1e-06
2024-01-07 11:34:36,996 - weight_decay: 0.01
2024-01-07 11:34:36,996 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-01-07-11-34-36
2024-01-07 11:34:36,996 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-01-07-11-34-36/models
2024-01-07 11:34:36,996 - ============================== End Params ==============================
2024-01-07 11:34:36,999 - Generate Text Features Begin...
2024-01-07 11:34:37,524 - Generate Text Features Finished...
2024-01-07 11:34:37,525 - Load Video Features Begin...
2024-01-07 11:34:38,480 - Load Video Features Finished...
2024-01-07 11:34:39,182 - Load Audio Features Begin...
2024-01-07 11:34:43,520 - Load Audio Features Finished...
2024-01-07 11:34:48,558 - method  begins...
2024-01-07 11:34:54,761 - Multimodal intent recognition begins...
2024-01-07 11:34:54,761 - Training begins...
2024-01-07 11:35:16,513 - ***** Epoch: 1: Eval results *****
2024-01-07 11:35:16,513 -   train_loss = 2.9852
2024-01-07 11:35:16,513 -   best_eval_score = 0.0
2024-01-07 11:35:16,513 -   eval_score = 0.0114
2024-01-07 11:35:35,172 - ***** Epoch: 2: Eval results *****
2024-01-07 11:35:35,174 -   train_loss = 2.9319
2024-01-07 11:35:35,174 -   best_eval_score = 0.0114
2024-01-07 11:35:35,174 -   eval_score = 0.0269
2024-01-07 11:35:54,423 - ***** Epoch: 3: Eval results *****
2024-01-07 11:35:54,423 -   train_loss = 2.8581
2024-01-07 11:35:54,423 -   best_eval_score = 0.0269
2024-01-07 11:35:54,423 -   eval_score = 0.0328
2024-01-07 11:36:14,295 - ***** Epoch: 4: Eval results *****
2024-01-07 11:36:14,296 -   train_loss = 2.759
2024-01-07 11:36:14,296 -   best_eval_score = 0.0328
2024-01-07 11:36:14,296 -   eval_score = 0.0357
2024-01-07 11:36:33,656 - ***** Epoch: 5: Eval results *****
2024-01-07 11:36:33,656 -   train_loss = 2.6147
2024-01-07 11:36:33,656 -   best_eval_score = 0.0357
2024-01-07 11:36:33,656 -   eval_score = 0.155
2024-01-07 11:36:52,889 - ***** Epoch: 6: Eval results *****
2024-01-07 11:36:52,889 -   train_loss = 2.4041
2024-01-07 11:36:52,890 -   best_eval_score = 0.155
2024-01-07 11:36:52,890 -   eval_score = 0.2064
2024-01-07 11:37:12,883 - ***** Epoch: 7: Eval results *****
2024-01-07 11:37:12,883 -   train_loss = 2.0938
2024-01-07 11:37:12,883 -   best_eval_score = 0.2064
2024-01-07 11:37:12,883 -   eval_score = 0.3158
2024-01-07 11:37:32,304 - ***** Epoch: 8: Eval results *****
2024-01-07 11:37:32,305 -   train_loss = 1.7168
2024-01-07 11:37:32,305 -   best_eval_score = 0.3158
2024-01-07 11:37:32,305 -   eval_score = 0.4017
2024-01-07 11:37:51,654 - ***** Epoch: 9: Eval results *****
2024-01-07 11:37:51,655 -   train_loss = 1.3098
2024-01-07 11:37:51,655 -   best_eval_score = 0.4017
2024-01-07 11:37:51,655 -   eval_score = 0.5018
2024-01-07 11:38:10,522 - ***** Epoch: 10: Eval results *****
2024-01-07 11:38:10,523 -   train_loss = 0.9659
2024-01-07 11:38:10,523 -   best_eval_score = 0.5018
2024-01-07 11:38:10,523 -   eval_score = 0.5406
2024-01-07 11:38:29,801 - ***** Epoch: 11: Eval results *****
2024-01-07 11:38:29,801 -   train_loss = 0.6671
2024-01-07 11:38:29,801 -   best_eval_score = 0.5406
2024-01-07 11:38:29,801 -   eval_score = 0.6024
2024-01-07 11:38:49,270 - ***** Epoch: 12: Eval results *****
2024-01-07 11:38:49,271 -   train_loss = 0.4386
2024-01-07 11:38:49,271 -   best_eval_score = 0.6024
2024-01-07 11:38:49,271 -   eval_score = 0.5643
2024-01-07 11:38:49,271 - EarlyStopping counter: 1 out of 8
2024-01-07 11:39:07,576 - ***** Epoch: 13: Eval results *****
2024-01-07 11:39:07,576 -   train_loss = 0.3035
2024-01-07 11:39:07,576 -   best_eval_score = 0.6024
2024-01-07 11:39:07,576 -   eval_score = 0.6505
2024-01-07 11:39:27,074 - ***** Epoch: 14: Eval results *****
2024-01-07 11:39:27,074 -   train_loss = 0.1969
2024-01-07 11:39:27,074 -   best_eval_score = 0.6505
2024-01-07 11:39:27,074 -   eval_score = 0.669
2024-01-07 11:39:45,979 - ***** Epoch: 15: Eval results *****
2024-01-07 11:39:45,980 -   train_loss = 0.1524
2024-01-07 11:39:45,980 -   best_eval_score = 0.669
2024-01-07 11:39:45,980 -   eval_score = 0.6377
2024-01-07 11:39:45,980 - EarlyStopping counter: 1 out of 8
2024-01-07 11:40:05,176 - ***** Epoch: 16: Eval results *****
2024-01-07 11:40:05,177 -   train_loss = 0.0943
2024-01-07 11:40:05,177 -   best_eval_score = 0.669
2024-01-07 11:40:05,177 -   eval_score = 0.631
2024-01-07 11:40:05,177 - EarlyStopping counter: 2 out of 8
2024-01-07 11:40:24,146 - ***** Epoch: 17: Eval results *****
2024-01-07 11:40:24,146 -   train_loss = 0.0773
2024-01-07 11:40:24,146 -   best_eval_score = 0.669
2024-01-07 11:40:24,146 -   eval_score = 0.6428
2024-01-07 11:40:24,146 - EarlyStopping counter: 3 out of 8
2024-01-07 11:40:43,512 - ***** Epoch: 18: Eval results *****
2024-01-07 11:40:43,513 -   train_loss = 0.0493
2024-01-07 11:40:43,513 -   best_eval_score = 0.669
2024-01-07 11:40:43,513 -   eval_score = 0.6447
2024-01-07 11:40:43,513 - EarlyStopping counter: 4 out of 8
2024-01-07 11:41:02,807 - ***** Epoch: 19: Eval results *****
2024-01-07 11:41:02,807 -   train_loss = 0.035
2024-01-07 11:41:02,807 -   best_eval_score = 0.669
2024-01-07 11:41:02,807 -   eval_score = 0.6476
2024-01-07 11:41:02,808 - EarlyStopping counter: 5 out of 8
2024-01-07 11:41:21,704 - ***** Epoch: 20: Eval results *****
2024-01-07 11:41:21,704 -   train_loss = 0.0289
2024-01-07 11:41:21,704 -   best_eval_score = 0.669
2024-01-07 11:41:21,704 -   eval_score = 0.6727
2024-01-07 11:41:40,760 - ***** Epoch: 21: Eval results *****
2024-01-07 11:41:40,761 -   train_loss = 0.019
2024-01-07 11:41:40,761 -   best_eval_score = 0.6727
2024-01-07 11:41:40,761 -   eval_score = 0.6492
2024-01-07 11:41:40,761 - EarlyStopping counter: 1 out of 8
2024-01-07 11:41:59,939 - ***** Epoch: 22: Eval results *****
2024-01-07 11:41:59,939 -   train_loss = 0.0172
2024-01-07 11:41:59,939 -   best_eval_score = 0.6727
2024-01-07 11:41:59,939 -   eval_score = 0.656
2024-01-07 11:41:59,939 - EarlyStopping counter: 2 out of 8
2024-01-07 11:42:17,847 - ***** Epoch: 23: Eval results *****
2024-01-07 11:42:17,848 -   train_loss = 0.0155
2024-01-07 11:42:17,848 -   best_eval_score = 0.6727
2024-01-07 11:42:17,848 -   eval_score = 0.6438
2024-01-07 11:42:17,848 - EarlyStopping counter: 3 out of 8
2024-01-07 11:42:37,636 - ***** Epoch: 24: Eval results *****
2024-01-07 11:42:37,636 -   train_loss = 0.0107
2024-01-07 11:42:37,636 -   best_eval_score = 0.6727
2024-01-07 11:42:37,636 -   eval_score = 0.6322
2024-01-07 11:42:37,636 - EarlyStopping counter: 4 out of 8
2024-01-07 11:42:56,583 - ***** Epoch: 25: Eval results *****
2024-01-07 11:42:56,583 -   train_loss = 0.0087
2024-01-07 11:42:56,583 -   best_eval_score = 0.6727
2024-01-07 11:42:56,583 -   eval_score = 0.6305
2024-01-07 11:42:56,583 - EarlyStopping counter: 5 out of 8
2024-01-07 11:43:15,654 - ***** Epoch: 26: Eval results *****
2024-01-07 11:43:15,654 -   train_loss = 0.0087
2024-01-07 11:43:15,654 -   best_eval_score = 0.6727
2024-01-07 11:43:15,654 -   eval_score = 0.6511
2024-01-07 11:43:15,654 - EarlyStopping counter: 6 out of 8
2024-01-07 11:43:35,326 - ***** Epoch: 27: Eval results *****
2024-01-07 11:43:35,326 -   train_loss = 0.007
2024-01-07 11:43:35,326 -   best_eval_score = 0.6727
2024-01-07 11:43:35,326 -   eval_score = 0.6361
2024-01-07 11:43:35,326 - EarlyStopping counter: 7 out of 8
2024-01-07 11:43:54,324 - ***** Epoch: 28: Eval results *****
2024-01-07 11:43:54,324 -   train_loss = 0.0119
2024-01-07 11:43:54,324 -   best_eval_score = 0.6727
2024-01-07 11:43:54,325 -   eval_score = 0.6296
2024-01-07 11:43:54,325 - EarlyStopping counter: 8 out of 8
2024-01-07 11:43:54,325 - EarlyStopping at epoch 28
2024-01-07 11:43:54,329 - Training is finished...
2024-01-07 11:43:54,331 - Testing begins...
2024-01-07 11:43:58,370 - ***** Test: Confusion Matrix *****
2024-01-07 11:43:58,371 - [[28  1  0  0 12  0  6  2  0  4  0  0  3  1  0  0  0  0  0  0]
 [ 1 38  0  1  0  0  0  0  1  0  0  0  0  1  0  0  0  1  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0 17  0  1  0  0  0  0  1  0  1  1  0  0  0  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  1  0  0  4  0  2  0  2  0  0  1  0  0  0  0  0  0  0  0]
 [ 4  0  0  0  0  0  0  5  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  3  4  0  0  0  0  1  0  1  0  0  0  0]
 [ 2  0  0  0  0  0  0  1  0  2  0  0  0  0  0  1  0  4  0  0]
 [ 2  1  0  0  0  0  0  0  0  0 14  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 18  0  0  0  0  0  0  0  0]
 [ 6  2  0  1  3  1  1  2  1  0  0  1 29  3  3  0  1  0  1  2]
 [ 1  1  0  0  1  0  2  0  0  0  1  1  2 14  2  0  0  0  0  0]
 [ 0  0  0  1  1  0  0  0  1  0  0  0  0  3 13  0  1  0  0  2]
 [ 0  1  0  1  1  0  0  2  1  0  0  0  2  0  1 11  0  0  0  1]
 [ 1  0  0  0  0  0  0  2  1  0  0  0  1  0  2  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  1  0  0  0  0 12  0  0]
 [ 0  1  0  1  0  0  0  0  0  0  0  0  0  0  0  1  0  0  8  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  1  1  0  0  0  0  6]]
2024-01-07 11:43:58,371 - ***** Evaluation results *****
2024-01-07 11:43:58,372 -   acc = 0.6584
2024-01-07 11:43:58,372 -   f1 = 0.6324
2024-01-07 11:43:58,372 -   prec = 0.6406
2024-01-07 11:43:58,372 -   rec = 0.6434
2024-01-07 11:43:58,372 - Testing is finished...
2024-01-07 11:43:58,372 - Multimodal intent recognition is finished...
2024-01-07 11:43:58,372 - Results are saved in results/msz.csv
