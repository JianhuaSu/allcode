2024-03-17 16:20:59,734 - ============================== Params ==============================
2024-03-17 16:20:59,734 - logger_name: mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-16-20-59
2024-03-17 16:20:59,734 - dataset: MIntRec2
2024-03-17 16:20:59,734 - data_mode: multi-class
2024-03-17 16:20:59,734 - method: mag_bert
2024-03-17 16:20:59,734 - text_backbone: bert-base-uncased
2024-03-17 16:20:59,734 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-17 16:20:59,734 - seed: 4
2024-03-17 16:20:59,734 - num_workers: 8
2024-03-17 16:20:59,734 - gpu_id: 2
2024-03-17 16:20:59,734 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-17 16:20:59,734 - train: True
2024-03-17 16:20:59,734 - tune: True
2024-03-17 16:20:59,734 - save_model: False
2024-03-17 16:20:59,734 - save_results: True
2024-03-17 16:20:59,734 - log_path: logs
2024-03-17 16:20:59,734 - cache_path: 
2024-03-17 16:20:59,734 - video_data_path: video_data
2024-03-17 16:20:59,734 - audio_data_path: audio_data
2024-03-17 16:20:59,734 - video_feats_path: video_feats.pkl
2024-03-17 16:20:59,734 - audio_feats_path: audio_feats.pkl
2024-03-17 16:20:59,734 - results_path: results
2024-03-17 16:20:59,734 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-17 16:20:59,734 - model_path: models
2024-03-17 16:20:59,735 - config_file_name: mag_bert_MIntRec2
2024-03-17 16:20:59,735 - results_file_name: mag_bert.csv
2024-03-17 16:20:59,735 - padding_mode: zero
2024-03-17 16:20:59,735 - padding_loc: end
2024-03-17 16:20:59,735 - need_aligned: True
2024-03-17 16:20:59,735 - eval_monitor: f1
2024-03-17 16:20:59,735 - train_batch_size: 32
2024-03-17 16:20:59,735 - eval_batch_size: 16
2024-03-17 16:20:59,735 - test_batch_size: 16
2024-03-17 16:20:59,735 - wait_patience: 8
2024-03-17 16:20:59,735 - num_train_epochs: 100
2024-03-17 16:20:59,735 - beta_shift: 0.01
2024-03-17 16:20:59,735 - dropout_prob: 0.1
2024-03-17 16:20:59,735 - warmup_proportion: 0.1
2024-03-17 16:20:59,735 - lr: 3e-05
2024-03-17 16:20:59,735 - aligned_method: conv1d
2024-03-17 16:20:59,735 - weight_decay: 0.1
2024-03-17 16:20:59,735 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-16-20-59
2024-03-17 16:20:59,735 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-16-20-59/models
2024-03-17 16:20:59,735 - num_labels: 30
2024-03-17 16:20:59,735 - text_feat_dim: 768
2024-03-17 16:20:59,735 - video_feat_dim: 256
2024-03-17 16:20:59,735 - audio_feat_dim: 768
2024-03-17 16:20:59,735 - text_seq_len: 50
2024-03-17 16:20:59,735 - video_seq_len: 180
2024-03-17 16:20:59,735 - audio_seq_len: 400
2024-03-17 16:20:59,735 - device: cuda:2
2024-03-17 16:20:59,735 - ============================== End Params ==============================
2024-03-17 16:20:59,766 - Generate Text Features Begin...
2024-03-17 16:21:01,398 - Generate Text Features Finished...
2024-03-17 16:21:01,400 - Load Video Features Begin...
2024-03-17 16:21:05,815 - Load Video Features Finished...
2024-03-17 16:21:07,662 - Load Audio Features Begin...
2024-03-17 16:21:35,519 - Load Audio Features Finished...
2024-03-17 16:21:46,564 - method  begins...
2024-03-17 16:21:47,849 - Multimodal intent recognition begins...
2024-03-17 16:21:47,849 - Training begins...
2024-03-17 16:22:21,160 - ***** Epoch: 1: Eval results *****
2024-03-17 16:22:21,160 -   train_loss = 3.2726
2024-03-17 16:22:21,160 -   best_eval_score = 0.0
2024-03-17 16:22:21,160 -   eval_score = 0.1113
2024-03-17 16:22:53,070 - ***** Epoch: 2: Eval results *****
2024-03-17 16:22:53,070 -   train_loss = 2.5804
2024-03-17 16:22:53,070 -   best_eval_score = 0.1113
2024-03-17 16:22:53,071 -   eval_score = 0.2855
2024-03-17 16:23:26,952 - ***** Epoch: 3: Eval results *****
2024-03-17 16:23:26,952 -   train_loss = 1.954
2024-03-17 16:23:26,952 -   best_eval_score = 0.2855
2024-03-17 16:23:26,952 -   eval_score = 0.3413
2024-03-17 16:23:58,881 - ***** Epoch: 4: Eval results *****
2024-03-17 16:23:58,881 -   train_loss = 1.5742
2024-03-17 16:23:58,881 -   best_eval_score = 0.3413
2024-03-17 16:23:58,881 -   eval_score = 0.3903
2024-03-17 16:24:32,462 - ***** Epoch: 5: Eval results *****
2024-03-17 16:24:32,462 -   train_loss = 1.2801
2024-03-17 16:24:32,463 -   best_eval_score = 0.3903
2024-03-17 16:24:32,463 -   eval_score = 0.4328
2024-03-17 16:25:04,962 - ***** Epoch: 6: Eval results *****
2024-03-17 16:25:04,963 -   train_loss = 1.0129
2024-03-17 16:25:04,963 -   best_eval_score = 0.4328
2024-03-17 16:25:04,963 -   eval_score = 0.4698
2024-03-17 16:25:37,913 - ***** Epoch: 7: Eval results *****
2024-03-17 16:25:37,913 -   train_loss = 0.779
2024-03-17 16:25:37,913 -   best_eval_score = 0.4698
2024-03-17 16:25:37,913 -   eval_score = 0.4691
2024-03-17 16:25:37,913 - EarlyStopping counter: 1 out of 8
2024-03-17 16:26:11,401 - ***** Epoch: 8: Eval results *****
2024-03-17 16:26:11,402 -   train_loss = 0.5727
2024-03-17 16:26:11,402 -   best_eval_score = 0.4698
2024-03-17 16:26:11,402 -   eval_score = 0.4932
2024-03-17 16:26:45,184 - ***** Epoch: 9: Eval results *****
2024-03-17 16:26:45,184 -   train_loss = 0.4225
2024-03-17 16:26:45,184 -   best_eval_score = 0.4932
2024-03-17 16:26:45,184 -   eval_score = 0.5009
2024-03-17 16:27:18,905 - ***** Epoch: 10: Eval results *****
2024-03-17 16:27:18,905 -   train_loss = 0.3061
2024-03-17 16:27:18,906 -   best_eval_score = 0.5009
2024-03-17 16:27:18,906 -   eval_score = 0.4895
2024-03-17 16:27:18,906 - EarlyStopping counter: 1 out of 8
2024-03-17 16:27:52,389 - ***** Epoch: 11: Eval results *****
2024-03-17 16:27:52,389 -   train_loss = 0.2511
2024-03-17 16:27:52,389 -   best_eval_score = 0.5009
2024-03-17 16:27:52,389 -   eval_score = 0.4966
2024-03-17 16:27:52,389 - EarlyStopping counter: 2 out of 8
2024-03-17 16:28:25,524 - ***** Epoch: 12: Eval results *****
2024-03-17 16:28:25,525 -   train_loss = 0.1694
2024-03-17 16:28:25,525 -   best_eval_score = 0.5009
2024-03-17 16:28:25,525 -   eval_score = 0.5006
2024-03-17 16:28:25,525 - EarlyStopping counter: 3 out of 8
2024-03-17 16:28:59,637 - ***** Epoch: 13: Eval results *****
2024-03-17 16:28:59,638 -   train_loss = 0.1384
2024-03-17 16:28:59,638 -   best_eval_score = 0.5009
2024-03-17 16:28:59,638 -   eval_score = 0.5041
2024-03-17 16:29:33,742 - ***** Epoch: 14: Eval results *****
2024-03-17 16:29:33,743 -   train_loss = 0.1137
2024-03-17 16:29:33,743 -   best_eval_score = 0.5041
2024-03-17 16:29:33,743 -   eval_score = 0.4852
2024-03-17 16:29:33,743 - EarlyStopping counter: 1 out of 8
2024-03-17 16:30:08,048 - ***** Epoch: 15: Eval results *****
2024-03-17 16:30:08,048 -   train_loss = 0.0992
2024-03-17 16:30:08,048 -   best_eval_score = 0.5041
2024-03-17 16:30:08,048 -   eval_score = 0.4927
2024-03-17 16:30:08,048 - EarlyStopping counter: 2 out of 8
2024-03-17 16:30:42,096 - ***** Epoch: 16: Eval results *****
2024-03-17 16:30:42,096 -   train_loss = 0.0865
2024-03-17 16:30:42,096 -   best_eval_score = 0.5041
2024-03-17 16:30:42,096 -   eval_score = 0.4858
2024-03-17 16:30:42,096 - EarlyStopping counter: 3 out of 8
2024-03-17 16:31:15,729 - ***** Epoch: 17: Eval results *****
2024-03-17 16:31:15,729 -   train_loss = 0.0799
2024-03-17 16:31:15,729 -   best_eval_score = 0.5041
2024-03-17 16:31:15,729 -   eval_score = 0.5063
2024-03-17 16:31:47,845 - ***** Epoch: 18: Eval results *****
2024-03-17 16:31:47,845 -   train_loss = 0.0663
2024-03-17 16:31:47,845 -   best_eval_score = 0.5063
2024-03-17 16:31:47,845 -   eval_score = 0.493
2024-03-17 16:31:47,845 - EarlyStopping counter: 1 out of 8
2024-03-17 16:32:22,352 - ***** Epoch: 19: Eval results *****
2024-03-17 16:32:22,353 -   train_loss = 0.0741
2024-03-17 16:32:22,353 -   best_eval_score = 0.5063
2024-03-17 16:32:22,353 -   eval_score = 0.5285
2024-03-17 16:32:55,209 - ***** Epoch: 20: Eval results *****
2024-03-17 16:32:55,209 -   train_loss = 0.0687
2024-03-17 16:32:55,209 -   best_eval_score = 0.5285
2024-03-17 16:32:55,209 -   eval_score = 0.4874
2024-03-17 16:32:55,209 - EarlyStopping counter: 1 out of 8
2024-03-17 16:33:27,545 - ***** Epoch: 21: Eval results *****
2024-03-17 16:33:27,545 -   train_loss = 0.0612
2024-03-17 16:33:27,545 -   best_eval_score = 0.5285
2024-03-17 16:33:27,545 -   eval_score = 0.4906
2024-03-17 16:33:27,545 - EarlyStopping counter: 2 out of 8
2024-03-17 16:34:01,174 - ***** Epoch: 22: Eval results *****
2024-03-17 16:34:01,174 -   train_loss = 0.0679
2024-03-17 16:34:01,174 -   best_eval_score = 0.5285
2024-03-17 16:34:01,174 -   eval_score = 0.4927
2024-03-17 16:34:01,174 - EarlyStopping counter: 3 out of 8
2024-03-17 16:34:34,425 - ***** Epoch: 23: Eval results *****
2024-03-17 16:34:34,426 -   train_loss = 0.0717
2024-03-17 16:34:34,426 -   best_eval_score = 0.5285
2024-03-17 16:34:34,426 -   eval_score = 0.4883
2024-03-17 16:34:34,426 - EarlyStopping counter: 4 out of 8
2024-03-17 16:35:07,942 - ***** Epoch: 24: Eval results *****
2024-03-17 16:35:07,942 -   train_loss = 0.0609
2024-03-17 16:35:07,942 -   best_eval_score = 0.5285
2024-03-17 16:35:07,942 -   eval_score = 0.4935
2024-03-17 16:35:07,942 - EarlyStopping counter: 5 out of 8
2024-03-17 16:35:42,698 - ***** Epoch: 25: Eval results *****
2024-03-17 16:35:42,698 -   train_loss = 0.0566
2024-03-17 16:35:42,698 -   best_eval_score = 0.5285
2024-03-17 16:35:42,698 -   eval_score = 0.4856
2024-03-17 16:35:42,698 - EarlyStopping counter: 6 out of 8
2024-03-17 16:36:15,644 - ***** Epoch: 26: Eval results *****
2024-03-17 16:36:15,645 -   train_loss = 0.0622
2024-03-17 16:36:15,645 -   best_eval_score = 0.5285
2024-03-17 16:36:15,645 -   eval_score = 0.4847
2024-03-17 16:36:15,645 - EarlyStopping counter: 7 out of 8
2024-03-17 16:36:50,200 - ***** Epoch: 27: Eval results *****
2024-03-17 16:36:50,201 -   train_loss = 0.0579
2024-03-17 16:36:50,201 -   best_eval_score = 0.5285
2024-03-17 16:36:50,201 -   eval_score = 0.5051
2024-03-17 16:36:50,201 - EarlyStopping counter: 8 out of 8
2024-03-17 16:36:50,201 - EarlyStopping at epoch 27
2024-03-17 16:36:50,204 - Training is finished...
2024-03-17 16:36:50,205 - Testing begins...
2024-03-17 16:36:57,377 - ***** Test: Confusion Matrix *****
2024-03-17 16:36:57,380 - [[ 46   0  16   0   0   0   0   0   0   0   2   0   0   1   0   0   0   1
    0   0   0   0   0   1   1   0   0   0   0   0]
 [  0  56   0   0   8   3   9   0   1   0   2   0   2   0   3   0   0   7
    0   1   0   0   2   0   1   0   0   2   0   0]
 [  9   1  42   0   0   0   0   0   0   0   1   0   0   0   1   0   0   4
    0   0   0   2   0   0   2   0   0   1   0   1]
 [  0   0   0  61   0   0   0   1   0   0   0   0   0   0   2   0   0   0
    0   0   0   1   0   0   0   0   0   0   0   0]
 [  0   4   0   0  33   1   0   0   1   0   0   0   0   0   0   0   0   4
    0   1   0   4   1   1   1   0   0   0   0   0]
 [  0   1   0   0   1  23   0   0   0   2   2   0   0   0   3   0   0   5
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   1   0   0   0   4  28   4   0   0   2   0   9   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   3   0   0   0   0   5  19   0   0   7   0   9   0   0   0   2   0
    0   0   0   0   0   0   0   0   0   2   0   0]
 [  1   3   1   3   1   0   0   0  22   0   0   2   1   0   0   1   0   7
    0   0   0   0   4   0   2   1   0   0   0   0]
 [  0   1   1   1   1   0   1   0   1  44   0   4  10   2  15   0   0   8
    2   0   1   3   3   1   2   1   0   5   0   0]
 [  2   0   0   0   0   4   4   1   0   0  44   0  31   0   3   0   0   0
    0   2   0   1   0   0   1   0   0   0   0   0]
 [  0   1   0   0   0   0   0   0   1   6   0  12  12   1   1   0   0   3
    1   0   1   0   3   0   0   0   0   4   0   1]
 [  0   3   0   0   0   0   4   5   0   2  34   0  81   0   2   0   0   0
    0   0   0   1   1   0   0   0   0   2   0   0]
 [  0   0   1   0   0   0   0   0   0   2   0   0   0   1   5   1   0   4
    2   0   1   0   0   0   0   0   0   0   0   0]
 [  0   4   2   0   0   0   3   0   5   6   1   1   2   5 104   2   0  26
    5   0   3   2  13   1   2   0   1   4   0   1]
 [  0   0   1   0   0   0   0   0   0   5   0   0   0   0   2   5   0   3
    1   0   0   1   2   1   0   0   0   0   1   0]
 [  0   0   0   0   1   0   1   1   0   1   1   0   3   0   0   0  54   0
    3   0   0   0   0   0   1   0   0   0   0   0]
 [  1   7   1   0   7   3   0   0   4  12   0   0   1   3  24   3   1 107
    9   1   2   9   7   7   1   1   1   2   1   2]
 [  0   1   0   0   1   0   1   0   0   3   1   0   0   1   8   0   2  13
   23   0   3   0   1   0   1   0   0   1   0   0]
 [  0   5   0   0   0   0   3   0   0   0   2   0   0   0   0   0   0   0
    0   5   0   2   0   0   0   0   0   0   0   0]
 [  0   3   1   0   0   0   0   0   1   2   0   0   1   1   3   2   0   6
    4   0   2   0   0   1   1   0   0   1   0   0]
 [  7   0   0   0   1   0   0   0   0   4   0   0   0   0   1   0   4   0
    0   1   0  30   0   1   0   0   0   2   0   2]
 [  0   1   0   0   0   0   0   0   1   1   1   2   1   1   7   0   0   4
    0   0   0   0  87   0   1   4   5   1   0   0]
 [  0   3   0   0   1   0   0   0   0   2   0   0   0   0   2   0   0   6
    0   0   0   8   0  16   0   0   0   0   0   0]
 [  1   0   2   0   0   0   1   0   3   2   1   2   0   0   4   1   0   4
    0   0   0   0   1   0  84   0   0   6   1   0]
 [  1   1   0   0   1   0   0   0   0   0   0   1   0   0   0   0   0   1
    0   0   0   0   3   1   1  18   2   0   0   1]
 [  0   0   0   0   0   0   0   0   0   1   0   0   0   0   1   0   0   4
    0   0   0   1   3   0   0   0   5   0   2   0]
 [  0   2   1   0   2   0   0   0   2   6   2   2   4   0   5   1   0   3
    3   0   0   0   3   0   7   1   0  13   1   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
    0   0   0   0   0   0   0   0   1   0  56   0]
 [  0   2   0   0   0   0   0   0   1   1   1   0   0   0   0   0   0   3
    1   0   0   1   0   0   0   1   0   2   0   6]]
2024-03-17 16:36:57,380 - ***** Evaluation results *****
2024-03-17 16:36:57,380 -   acc = 0.5544
2024-03-17 16:36:57,380 -   f1 = 0.5056
2024-03-17 16:36:57,380 -   prec = 0.5197
2024-03-17 16:36:57,380 -   rec = 0.501
2024-03-17 16:36:57,381 - Testing is finished...
2024-03-17 16:36:57,381 - Multimodal intent recognition is finished...
2024-03-17 16:36:57,381 - Results are saved in results/mag_bert.csv
