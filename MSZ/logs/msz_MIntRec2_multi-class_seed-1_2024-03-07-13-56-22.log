2024-03-07 13:56:22,450 - ============================== Params ==============================
2024-03-07 13:56:22,450 - logger_name: msz_MIntRec2_multi-class_seed-1_2024-03-07-13-56-22
2024-03-07 13:56:22,450 - dataset: MIntRec2
2024-03-07 13:56:22,450 - data_mode: multi-class
2024-03-07 13:56:22,450 - method: msz
2024-03-07 13:56:22,450 - text_backbone: bert-base-uncased
2024-03-07 13:56:22,450 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-07 13:56:22,450 - seed: 1
2024-03-07 13:56:22,450 - num_workers: 8
2024-03-07 13:56:22,450 - gpu_id: 2
2024-03-07 13:56:22,450 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-07 13:56:22,450 - train: True
2024-03-07 13:56:22,450 - tune: True
2024-03-07 13:56:22,450 - save_model: False
2024-03-07 13:56:22,450 - save_results: True
2024-03-07 13:56:22,450 - log_path: logs
2024-03-07 13:56:22,450 - cache_path: 
2024-03-07 13:56:22,450 - video_data_path: video_data
2024-03-07 13:56:22,450 - audio_data_path: audio_data
2024-03-07 13:56:22,450 - video_feats_path: video_feats.pkl
2024-03-07 13:56:22,451 - audio_feats_path: audio_feats.pkl
2024-03-07 13:56:22,451 - results_path: results
2024-03-07 13:56:22,451 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-07 13:56:22,451 - model_path: models
2024-03-07 13:56:22,451 - config_file_name: msz_MIntRec2
2024-03-07 13:56:22,451 - results_file_name: msz.csv
2024-03-07 13:56:22,451 - padding_mode: zero
2024-03-07 13:56:22,451 - padding_loc: end
2024-03-07 13:56:22,451 - need_aligned: False
2024-03-07 13:56:22,451 - eval_monitor: f1
2024-03-07 13:56:22,451 - train_batch_size: 32
2024-03-07 13:56:22,451 - eval_batch_size: 16
2024-03-07 13:56:22,451 - test_batch_size: 16
2024-03-07 13:56:22,451 - wait_patience: 8
2024-03-07 13:56:22,451 - hidden_dims: 768
2024-03-07 13:56:22,451 - num_attention_heads: 8
2024-03-07 13:56:22,451 - attention_probs_dropout_prob: 0.2
2024-03-07 13:56:22,451 - hidden_dropout_prob: 0.1
2024-03-07 13:56:22,451 - intermediate_size: 768
2024-03-07 13:56:22,451 - num_hidden_layers: 8
2024-03-07 13:56:22,451 - max_position_embeddings: 768
2024-03-07 13:56:22,451 - position_embedding_type: absolute
2024-03-07 13:56:22,451 - batch_first: True
2024-03-07 13:56:22,451 - dropout: 0.2
2024-03-07 13:56:22,451 - aligned_method: conv1d
2024-03-07 13:56:22,451 - num_train_epochs: 100
2024-03-07 13:56:22,451 - lr: 4e-06
2024-03-07 13:56:22,451 - lr_mode: min
2024-03-07 13:56:22,451 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-1_2024-03-07-13-56-22
2024-03-07 13:56:22,451 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-1_2024-03-07-13-56-22/models
2024-03-07 13:56:22,451 - ============================== End Params ==============================
2024-03-07 13:56:22,466 - Generate Text Features Begin...
2024-03-07 13:56:24,238 - Generate Text Features Finished...
2024-03-07 13:56:24,239 - Load Video Features Begin...
2024-03-07 13:56:25,288 - Load Video Features Finished...
2024-03-07 13:56:26,932 - Load Audio Features Begin...
2024-03-07 13:56:31,513 - Load Audio Features Finished...
2024-03-07 13:56:44,158 - method  begins...
2024-03-07 13:56:47,299 - Multimodal intent recognition begins...
2024-03-07 13:56:47,299 - Training begins...
2024-03-07 13:58:08,490 - ***** Epoch: 1: Eval results *****
2024-03-07 13:58:08,491 -   train_loss = 2.8044
2024-03-07 13:58:08,491 -   best_eval_score = 0.0
2024-03-07 13:58:08,491 -   eval_score = 0.2535
2024-03-07 13:59:26,776 - ***** Epoch: 2: Eval results *****
2024-03-07 13:59:26,776 -   train_loss = 1.8541
2024-03-07 13:59:26,776 -   best_eval_score = 0.2535
2024-03-07 13:59:26,777 -   eval_score = 0.3516
2024-03-07 14:00:45,271 - ***** Epoch: 3: Eval results *****
2024-03-07 14:00:45,272 -   train_loss = 1.4633
2024-03-07 14:00:45,272 -   best_eval_score = 0.3516
2024-03-07 14:00:45,272 -   eval_score = 0.4342
2024-03-07 14:02:03,874 - ***** Epoch: 4: Eval results *****
2024-03-07 14:02:03,874 -   train_loss = 1.2366
2024-03-07 14:02:03,875 -   best_eval_score = 0.4342
2024-03-07 14:02:03,875 -   eval_score = 0.4697
2024-03-07 14:03:22,428 - ***** Epoch: 5: Eval results *****
2024-03-07 14:03:22,428 -   train_loss = 1.0648
2024-03-07 14:03:22,428 -   best_eval_score = 0.4697
2024-03-07 14:03:22,428 -   eval_score = 0.4826
2024-03-07 14:04:40,753 - ***** Epoch: 6: Eval results *****
2024-03-07 14:04:40,753 -   train_loss = 0.9238
2024-03-07 14:04:40,753 -   best_eval_score = 0.4826
2024-03-07 14:04:40,753 -   eval_score = 0.4851
2024-03-07 14:05:59,664 - ***** Epoch: 7: Eval results *****
2024-03-07 14:05:59,673 -   train_loss = 0.7982
2024-03-07 14:05:59,673 -   best_eval_score = 0.4851
2024-03-07 14:05:59,673 -   eval_score = 0.4924
2024-03-07 14:07:17,856 - ***** Epoch: 8: Eval results *****
2024-03-07 14:07:17,857 -   train_loss = 0.6665
2024-03-07 14:07:17,857 -   best_eval_score = 0.4924
2024-03-07 14:07:17,857 -   eval_score = 0.5184
2024-03-07 14:08:36,866 - ***** Epoch: 9: Eval results *****
2024-03-07 14:08:36,866 -   train_loss = 0.5565
2024-03-07 14:08:36,866 -   best_eval_score = 0.5184
2024-03-07 14:08:36,866 -   eval_score = 0.5258
2024-03-07 14:09:55,081 - ***** Epoch: 10: Eval results *****
2024-03-07 14:09:55,082 -   train_loss = 0.4596
2024-03-07 14:09:55,082 -   best_eval_score = 0.5258
2024-03-07 14:09:55,082 -   eval_score = 0.5304
2024-03-07 14:11:13,593 - ***** Epoch: 11: Eval results *****
2024-03-07 14:11:13,593 -   train_loss = 0.3538
2024-03-07 14:11:13,593 -   best_eval_score = 0.5304
2024-03-07 14:11:13,593 -   eval_score = 0.5313
2024-03-07 14:12:33,203 - ***** Epoch: 12: Eval results *****
2024-03-07 14:12:33,204 -   train_loss = 0.3376
2024-03-07 14:12:33,204 -   best_eval_score = 0.5313
2024-03-07 14:12:33,204 -   eval_score = 0.5325
2024-03-07 14:13:54,447 - ***** Epoch: 13: Eval results *****
2024-03-07 14:13:54,447 -   train_loss = 0.3261
2024-03-07 14:13:54,447 -   best_eval_score = 0.5325
2024-03-07 14:13:54,447 -   eval_score = 0.5331
2024-03-07 14:15:13,507 - ***** Epoch: 14: Eval results *****
2024-03-07 14:15:13,507 -   train_loss = 0.325
2024-03-07 14:15:13,508 -   best_eval_score = 0.5331
2024-03-07 14:15:13,508 -   eval_score = 0.5407
2024-03-07 14:16:31,670 - ***** Epoch: 15: Eval results *****
2024-03-07 14:16:31,670 -   train_loss = 0.311
2024-03-07 14:16:31,670 -   best_eval_score = 0.5407
2024-03-07 14:16:31,670 -   eval_score = 0.5388
2024-03-07 14:16:31,670 - EarlyStopping counter: 1 out of 8
2024-03-07 14:17:49,725 - ***** Epoch: 16: Eval results *****
2024-03-07 14:17:49,725 -   train_loss = 0.3007
2024-03-07 14:17:49,725 -   best_eval_score = 0.5407
2024-03-07 14:17:49,725 -   eval_score = 0.5472
2024-03-07 14:19:08,576 - ***** Epoch: 17: Eval results *****
2024-03-07 14:19:08,576 -   train_loss = 0.301
2024-03-07 14:19:08,576 -   best_eval_score = 0.5472
2024-03-07 14:19:08,576 -   eval_score = 0.5444
2024-03-07 14:19:08,576 - EarlyStopping counter: 1 out of 8
2024-03-07 14:20:26,846 - ***** Epoch: 18: Eval results *****
2024-03-07 14:20:26,846 -   train_loss = 0.2959
2024-03-07 14:20:26,846 -   best_eval_score = 0.5472
2024-03-07 14:20:26,846 -   eval_score = 0.5466
2024-03-07 14:20:26,846 - EarlyStopping counter: 2 out of 8
2024-03-07 14:21:45,951 - ***** Epoch: 19: Eval results *****
2024-03-07 14:21:45,951 -   train_loss = 0.2829
2024-03-07 14:21:45,951 -   best_eval_score = 0.5472
2024-03-07 14:21:45,951 -   eval_score = 0.5369
2024-03-07 14:21:45,952 - EarlyStopping counter: 3 out of 8
2024-03-07 14:23:04,206 - ***** Epoch: 20: Eval results *****
2024-03-07 14:23:04,206 -   train_loss = 0.2653
2024-03-07 14:23:04,206 -   best_eval_score = 0.5472
2024-03-07 14:23:04,206 -   eval_score = 0.5391
2024-03-07 14:23:04,206 - EarlyStopping counter: 4 out of 8
2024-03-07 14:24:23,390 - ***** Epoch: 21: Eval results *****
2024-03-07 14:24:23,399 -   train_loss = 0.27
2024-03-07 14:24:23,399 -   best_eval_score = 0.5472
2024-03-07 14:24:23,399 -   eval_score = 0.5416
2024-03-07 14:24:23,399 - EarlyStopping counter: 5 out of 8
2024-03-07 14:25:43,289 - ***** Epoch: 22: Eval results *****
2024-03-07 14:25:43,290 -   train_loss = 0.2678
2024-03-07 14:25:43,290 -   best_eval_score = 0.5472
2024-03-07 14:25:43,290 -   eval_score = 0.5413
2024-03-07 14:25:43,290 - EarlyStopping counter: 6 out of 8
2024-03-07 14:27:02,279 - ***** Epoch: 23: Eval results *****
2024-03-07 14:27:02,280 -   train_loss = 0.2708
2024-03-07 14:27:02,280 -   best_eval_score = 0.5472
2024-03-07 14:27:02,280 -   eval_score = 0.5433
2024-03-07 14:27:02,280 - EarlyStopping counter: 7 out of 8
2024-03-07 14:28:21,065 - ***** Epoch: 24: Eval results *****
2024-03-07 14:28:21,065 -   train_loss = 0.2661
2024-03-07 14:28:21,065 -   best_eval_score = 0.5472
2024-03-07 14:28:21,065 -   eval_score = 0.5436
2024-03-07 14:28:21,065 - EarlyStopping counter: 8 out of 8
2024-03-07 14:28:21,065 - EarlyStopping at epoch 24
2024-03-07 14:28:21,069 - Training is finished...
2024-03-07 14:28:21,069 - Testing begins...
2024-03-07 14:28:31,072 - ***** Test: Confusion Matrix *****
2024-03-07 14:28:31,074 - [[ 48   0  14   0   0   0   0   0   1   0   2   0   0   0   0   0   0   0
    0   0   0   1   1   0   1   0   0   0   0   0]
 [  0  52   1   0   9   1   5   0   0   0   1   0   4   0   3   0   0   9
    1   3   1   1   1   0   1   0   0   4   0   0]
 [  7   0  48   0   1   0   0   0   0   0   1   0   0   0   1   0   0   2
    0   0   0   0   0   1   3   0   0   0   0   0]
 [  0   0   0  60   0   0   0   1   0   0   0   0   0   0   1   0   0   2
    0   0   0   0   0   0   0   0   0   1   0   0]
 [  0   6   0   0  29   1   0   0   0   0   0   0   0   0   0   0   0   7
    0   1   0   1   0   1   1   1   0   0   1   2]
 [  0   1   0   0   2  22   0   0   0   2   1   0   0   0   1   0   0   6
    0   0   0   0   0   0   0   1   0   0   0   1]
 [  0   0   0   0   0   2  28   6   0   2   4   0   6   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   6  27   0   1   6   0   5   0   0   0   1   0
    0   0   0   0   0   0   0   1   0   0   0   0]
 [  1   2   1   3   1   0   0   0  20   1   0   0   1   1   4   1   0   3
    0   0   0   0   7   0   2   1   0   0   0   0]
 [  0   1   1   1   1   0   0   0   2  54   0   6   6   1   9   0   0   9
    0   0   3   1   3   1   3   1   1   2   0   1]
 [  0   2   0   0   0   4   3   3   2   0  42   0  31   0   2   0   0   2
    0   1   0   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   1   0   0   7   1  21   6   0   1   0   0   2
    1   0   0   0   3   0   1   0   0   2   0   1]
 [  0   0   0   0   0   1   4  10   0   7  24   0  86   0   1   0   1   0
    0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   2   0   0   0   0   0   0   2   0   0   0   1   3   0   0   4
    3   0   0   0   1   0   0   0   0   1   0   0]
 [  0   2   1   0   0   1   1   0   3   5   2   1   0   2 121   0   0  27
    4   1   2   0  13   0   4   0   1   2   0   0]
 [  0   0   1   0   1   0   0   0   0   3   0   0   0   0   2   4   0   5
    1   0   0   1   0   0   0   0   0   3   1   0]
 [  0   0   0   0   1   0   0   2   1   0   2   0   1   0   0   0  52   0
    6   0   0   0   0   0   1   0   0   0   0   0]
 [  0   5   1   0   6   7   0   0   2  10   0   1   1   1  18   0   1 128
   10   0   1   4   4   6   1   2   2   2   1   3]
 [  0   2   1   0   0   1   1   0   0   5   1   0   0   1   8   0   2   6
   27   0   2   0   1   0   2   0   0   0   0   0]
 [  0   4   0   0   0   0   2   0   0   0   1   0   0   0   0   0   0   0
    0   9   0   1   0   0   0   0   0   0   0   0]
 [  1   2   2   0   1   0   0   0   0   2   0   1   1   0   4   0   0   4
    5   0   3   0   0   0   1   0   0   2   0   0]
 [  6   1   1   0   1   0   0   0   0   4   0   0   0   0   0   0   4   0
    0   0   1  27   0   5   1   0   1   1   0   0]
 [  0   0   1   1   0   0   0   0   1   4   0   2   1   0  10   1   0   3
    0   0   0   1  82   0   1   4   5   0   0   0]
 [  0   2   2   0   1   0   0   0   0   2   0   0   0   0   3   0   0   6
    0   0   0   3   0  19   0   0   0   0   0   0]
 [  1   1   2   0   0   0   0   0   3   1   1   2   0   0   3   0   0   2
    1   0   0   0   1   1  82   1   0  10   1   0]
 [  1   0   0   0   1   0   0   0   0   0   0   1   0   0   0   0   0   2
    0   0   0   0   3   0   1  20   0   0   0   2]
 [  0   0   0   1   0   1   0   0   0   1   0   0   0   0   2   0   0   3
    0   0   0   2   2   0   0   0   4   0   1   0]
 [  0   2   1   0   0   0   0   0   3   5   3   6   3   0   4   0   0   4
    1   0   2   0   2   1   8   2   0  10   1   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   1   0
    0   0   0   0   0   0   0   0   0   0  56   0]
 [  0   3   0   0   1   0   0   0   1   2   1   1   0   0   0   0   0   3
    0   0   1   0   0   0   0   1   0   1   0   4]]
2024-03-07 14:28:31,074 - ***** Evaluation results *****
2024-03-07 14:28:31,074 -   acc = 0.5834
2024-03-07 14:28:31,074 -   f1 = 0.5254
2024-03-07 14:28:31,074 -   prec = 0.543
2024-03-07 14:28:31,075 -   rec = 0.5226
2024-03-07 14:28:31,075 - Testing is finished...
2024-03-07 14:28:31,075 - Multimodal intent recognition is finished...
2024-03-07 14:28:31,075 - Results are saved in results/msz.csv
