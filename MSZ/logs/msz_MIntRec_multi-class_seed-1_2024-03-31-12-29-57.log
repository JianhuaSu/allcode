2024-03-31 12:29:57,537 - ============================== Params ==============================
2024-03-31 12:29:57,538 - logger_name: msz_MIntRec_multi-class_seed-1_2024-03-31-12-29-57
2024-03-31 12:29:57,538 - dataset: MIntRec
2024-03-31 12:29:57,538 - data_mode: multi-class
2024-03-31 12:29:57,538 - method: msz
2024-03-31 12:29:57,539 - text_backbone: bert-base-uncased
2024-03-31 12:29:57,539 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-31 12:29:57,539 - seed: 1
2024-03-31 12:29:57,539 - num_workers: 8
2024-03-31 12:29:57,539 - gpu_id: 3
2024-03-31 12:29:57,539 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-31 12:29:57,539 - train: True
2024-03-31 12:29:57,539 - tune: True
2024-03-31 12:29:57,539 - save_model: False
2024-03-31 12:29:57,539 - save_results: True
2024-03-31 12:29:57,539 - log_path: logs
2024-03-31 12:29:57,539 - cache_path: 
2024-03-31 12:29:57,539 - video_data_path: video_data
2024-03-31 12:29:57,539 - audio_data_path: audio_data
2024-03-31 12:29:57,539 - video_feats_path: video_feats.pkl
2024-03-31 12:29:57,539 - audio_feats_path: audio_feats.pkl
2024-03-31 12:29:57,539 - results_path: results
2024-03-31 12:29:57,540 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-03-31 12:29:57,540 - model_path: models
2024-03-31 12:29:57,540 - config_file_name: msz_MIntRec
2024-03-31 12:29:57,540 - results_file_name: msz.csv
2024-03-31 12:29:57,540 - padding_mode: zero
2024-03-31 12:29:57,540 - padding_loc: end
2024-03-31 12:29:57,540 - need_aligned: False
2024-03-31 12:29:57,540 - eval_monitor: f1
2024-03-31 12:29:57,540 - train_batch_size: 16
2024-03-31 12:29:57,540 - eval_batch_size: 8
2024-03-31 12:29:57,540 - test_batch_size: 8
2024-03-31 12:29:57,540 - wait_patience: 8
2024-03-31 12:29:57,540 - hidden_dims: 768
2024-03-31 12:29:57,540 - num_attention_heads: 8
2024-03-31 12:29:57,540 - attention_probs_dropout_prob: 0.3
2024-03-31 12:29:57,541 - hidden_dropout_prob: 0.2
2024-03-31 12:29:57,541 - intermediate_size: 768
2024-03-31 12:29:57,541 - num_hidden_layers: 10
2024-03-31 12:29:57,541 - max_position_embeddings: 768
2024-03-31 12:29:57,541 - position_embedding_type: absolute
2024-03-31 12:29:57,541 - batch_first: True
2024-03-31 12:29:57,541 - dropout: 0.4
2024-03-31 12:29:57,541 - aligned_method: conv1d
2024-03-31 12:29:57,541 - num_train_epochs: 100
2024-03-31 12:29:57,541 - lr: 6e-05
2024-03-31 12:29:57,541 - lr_mode: max
2024-03-31 12:29:57,541 - patience: 8
2024-03-31 12:29:57,541 - factor: 0.1
2024-03-31 12:29:57,541 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-03-31-12-29-57
2024-03-31 12:29:57,541 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-03-31-12-29-57/models
2024-03-31 12:29:57,541 - num_labels: 20
2024-03-31 12:29:57,542 - text_feat_dim: 768
2024-03-31 12:29:57,542 - video_feat_dim: 256
2024-03-31 12:29:57,542 - audio_feat_dim: 768
2024-03-31 12:29:57,542 - text_seq_len: 30
2024-03-31 12:29:57,542 - video_seq_len: 230
2024-03-31 12:29:57,542 - audio_seq_len: 480
2024-03-31 12:29:57,542 - device: cuda:3
2024-03-31 12:29:57,542 - ============================== End Params ==============================
2024-03-31 12:29:57,655 - Generate Text Features Begin...
2024-03-31 12:29:58,271 - Generate Text Features Finished...
2024-03-31 12:29:58,272 - Load Video Features Begin...
2024-03-31 12:30:06,197 - Load Video Features Finished...
2024-03-31 12:30:06,867 - Load Audio Features Begin...
2024-03-31 12:30:22,024 - Load Audio Features Finished...
2024-03-31 12:30:26,298 - method  begins...
2024-03-31 12:30:30,379 - Multimodal intent recognition begins...
2024-03-31 12:30:30,379 - Training begins...
2024-03-31 12:30:59,029 - ***** Epoch: 1: Eval results *****
2024-03-31 12:30:59,029 -   train_loss = 2.5979
2024-03-31 12:30:59,030 -   best_eval_score = 0.0
2024-03-31 12:30:59,030 -   eval_score = 0.3317
2024-03-31 12:31:24,593 - ***** Epoch: 2: Eval results *****
2024-03-31 12:31:24,594 -   train_loss = 1.5985
2024-03-31 12:31:24,594 -   best_eval_score = 0.3317
2024-03-31 12:31:24,594 -   eval_score = 0.4489
2024-03-31 12:31:48,812 - ***** Epoch: 3: Eval results *****
2024-03-31 12:31:48,812 -   train_loss = 1.1562
2024-03-31 12:31:48,812 -   best_eval_score = 0.4489
2024-03-31 12:31:48,812 -   eval_score = 0.5667
2024-03-31 12:32:13,673 - ***** Epoch: 4: Eval results *****
2024-03-31 12:32:13,674 -   train_loss = 0.6383
2024-03-31 12:32:13,674 -   best_eval_score = 0.5667
2024-03-31 12:32:13,674 -   eval_score = 0.571
2024-03-31 12:32:38,235 - ***** Epoch: 5: Eval results *****
2024-03-31 12:32:38,235 -   train_loss = 0.5329
2024-03-31 12:32:38,235 -   best_eval_score = 0.571
2024-03-31 12:32:38,235 -   eval_score = 0.6333
2024-03-31 12:33:01,683 - ***** Epoch: 6: Eval results *****
2024-03-31 12:33:01,683 -   train_loss = 0.4432
2024-03-31 12:33:01,683 -   best_eval_score = 0.6333
2024-03-31 12:33:01,684 -   eval_score = 0.6468
2024-03-31 12:33:33,699 - ***** Epoch: 7: Eval results *****
2024-03-31 12:33:33,700 -   train_loss = 0.3744
2024-03-31 12:33:33,700 -   best_eval_score = 0.6468
2024-03-31 12:33:33,700 -   eval_score = 0.6114
2024-03-31 12:33:33,700 - EarlyStopping counter: 1 out of 8
2024-03-31 12:34:00,584 - ***** Epoch: 8: Eval results *****
2024-03-31 12:34:00,585 -   train_loss = 0.361
2024-03-31 12:34:00,585 -   best_eval_score = 0.6468
2024-03-31 12:34:00,585 -   eval_score = 0.6512
2024-03-31 12:34:26,761 - ***** Epoch: 9: Eval results *****
2024-03-31 12:34:26,762 -   train_loss = 0.2625
2024-03-31 12:34:26,762 -   best_eval_score = 0.6512
2024-03-31 12:34:26,762 -   eval_score = 0.6261
2024-03-31 12:34:26,762 - EarlyStopping counter: 1 out of 8
2024-03-31 12:34:51,833 - ***** Epoch: 10: Eval results *****
2024-03-31 12:34:51,833 -   train_loss = 0.2577
2024-03-31 12:34:51,834 -   best_eval_score = 0.6512
2024-03-31 12:34:51,834 -   eval_score = 0.6119
2024-03-31 12:34:51,834 - EarlyStopping counter: 2 out of 8
2024-03-31 12:35:15,791 - ***** Epoch: 11: Eval results *****
2024-03-31 12:35:15,791 -   train_loss = 0.1673
2024-03-31 12:35:15,791 -   best_eval_score = 0.6512
2024-03-31 12:35:15,791 -   eval_score = 0.6659
2024-03-31 12:35:39,147 - ***** Epoch: 12: Eval results *****
2024-03-31 12:35:39,156 -   train_loss = 0.0695
2024-03-31 12:35:39,156 -   best_eval_score = 0.6659
2024-03-31 12:35:39,156 -   eval_score = 0.6714
2024-03-31 12:36:03,771 - ***** Epoch: 13: Eval results *****
2024-03-31 12:36:03,772 -   train_loss = 0.037
2024-03-31 12:36:03,772 -   best_eval_score = 0.6714
2024-03-31 12:36:03,772 -   eval_score = 0.6681
2024-03-31 12:36:03,772 - EarlyStopping counter: 1 out of 8
2024-03-31 12:36:29,096 - ***** Epoch: 14: Eval results *****
2024-03-31 12:36:29,097 -   train_loss = 0.0327
2024-03-31 12:36:29,097 -   best_eval_score = 0.6714
2024-03-31 12:36:29,097 -   eval_score = 0.6664
2024-03-31 12:36:29,097 - EarlyStopping counter: 2 out of 8
2024-03-31 12:36:56,605 - ***** Epoch: 15: Eval results *****
2024-03-31 12:36:56,606 -   train_loss = 0.0245
2024-03-31 12:36:56,606 -   best_eval_score = 0.6714
2024-03-31 12:36:56,606 -   eval_score = 0.6697
2024-03-31 12:36:56,606 - EarlyStopping counter: 3 out of 8
2024-03-31 12:37:23,333 - ***** Epoch: 16: Eval results *****
2024-03-31 12:37:23,333 -   train_loss = 0.0217
2024-03-31 12:37:23,333 -   best_eval_score = 0.6714
2024-03-31 12:37:23,334 -   eval_score = 0.6715
2024-03-31 12:37:48,957 - ***** Epoch: 17: Eval results *****
2024-03-31 12:37:48,958 -   train_loss = 0.0226
2024-03-31 12:37:48,958 -   best_eval_score = 0.6715
2024-03-31 12:37:48,958 -   eval_score = 0.6737
2024-03-31 12:38:16,207 - ***** Epoch: 18: Eval results *****
2024-03-31 12:38:16,207 -   train_loss = 0.0197
2024-03-31 12:38:16,207 -   best_eval_score = 0.6737
2024-03-31 12:38:16,207 -   eval_score = 0.667
2024-03-31 12:38:16,207 - EarlyStopping counter: 1 out of 8
2024-03-31 12:38:39,826 - ***** Epoch: 19: Eval results *****
2024-03-31 12:38:39,827 -   train_loss = 0.016
2024-03-31 12:38:39,827 -   best_eval_score = 0.6737
2024-03-31 12:38:39,827 -   eval_score = 0.672
2024-03-31 12:38:39,827 - EarlyStopping counter: 2 out of 8
2024-03-31 12:39:02,117 - ***** Epoch: 20: Eval results *****
2024-03-31 12:39:02,117 -   train_loss = 0.0159
2024-03-31 12:39:02,117 -   best_eval_score = 0.6737
2024-03-31 12:39:02,117 -   eval_score = 0.6724
2024-03-31 12:39:02,117 - EarlyStopping counter: 3 out of 8
2024-03-31 12:39:25,755 - ***** Epoch: 21: Eval results *****
2024-03-31 12:39:25,755 -   train_loss = 0.0145
2024-03-31 12:39:25,755 -   best_eval_score = 0.6737
2024-03-31 12:39:25,755 -   eval_score = 0.6724
2024-03-31 12:39:25,755 - EarlyStopping counter: 4 out of 8
2024-03-31 12:39:48,554 - ***** Epoch: 22: Eval results *****
2024-03-31 12:39:48,555 -   train_loss = 0.014
2024-03-31 12:39:48,555 -   best_eval_score = 0.6737
2024-03-31 12:39:48,555 -   eval_score = 0.6724
2024-03-31 12:39:48,555 - EarlyStopping counter: 5 out of 8
2024-03-31 12:40:11,345 - ***** Epoch: 23: Eval results *****
2024-03-31 12:40:11,345 -   train_loss = 0.0149
2024-03-31 12:40:11,345 -   best_eval_score = 0.6737
2024-03-31 12:40:11,345 -   eval_score = 0.6696
2024-03-31 12:40:11,346 - EarlyStopping counter: 6 out of 8
2024-03-31 12:40:34,220 - ***** Epoch: 24: Eval results *****
2024-03-31 12:40:34,220 -   train_loss = 0.0152
2024-03-31 12:40:34,220 -   best_eval_score = 0.6737
2024-03-31 12:40:34,220 -   eval_score = 0.6717
2024-03-31 12:40:34,220 - EarlyStopping counter: 7 out of 8
2024-03-31 12:40:56,861 - ***** Epoch: 25: Eval results *****
2024-03-31 12:40:56,862 -   train_loss = 0.0117
2024-03-31 12:40:56,862 -   best_eval_score = 0.6737
2024-03-31 12:40:56,862 -   eval_score = 0.6696
2024-03-31 12:40:56,862 - EarlyStopping counter: 8 out of 8
2024-03-31 12:40:56,862 - EarlyStopping at epoch 25
2024-03-31 12:40:56,865 - Training is finished...
2024-03-31 12:40:56,866 - Testing begins...
2024-03-31 12:41:01,737 - ***** Test: Confusion Matrix *****
2024-03-31 12:41:01,739 - [[30  2  0  0  6  0  2  3  3  3  0  0  5  1  0  1  0  1  0  0]
 [ 0 34  0  0  0  1  2  1  0  0  0  0  3  1  0  1  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 4  0  0  0  8  0  5  0  2  0  0  1  1  1  0  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  2  0  2  0  4  0  0  1  2  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  0  6  1  1  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  2  3  2  0  0  0  0  1  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  1  1  0  2  0  0  0  0  0  3  0  1  0  0]
 [ 2  0  0  0  0  0  0  2  0  2 12  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  3  0  0  0  0 15  0  0  0  0  0  0  0  0]
 [ 3  2  0  0  0  0  0  1  2  0  0  0 40  4  2  0  2  1  0  0]
 [ 1  0  0  0  0  0  0  1  0  0  1  1  0 21  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  2  2 16  0  1  0  0  0]
 [ 0  0  0  1  0  1  0  2  1  0  0  0  1  0  2 13  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  2  0  1  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  1  0  1  0  0  0  0 11  0  0]
 [ 0  2  0  0  0  0  0  0  0  0  0  0  2  0  0  2  0  0  6  0]
 [ 0  0  0  0  1  0  0  0  0  0  0  1  0  1  1  0  0  0  0  6]]
2024-03-31 12:41:01,739 - ***** Evaluation results *****
2024-03-31 12:41:01,739 -   acc = 0.6719
2024-03-31 12:41:01,739 -   f1 = 0.6382
2024-03-31 12:41:01,739 -   prec = 0.6671
2024-03-31 12:41:01,739 -   rec = 0.6327
2024-03-31 12:41:01,739 - Testing is finished...
2024-03-31 12:41:01,740 - Multimodal intent recognition is finished...
2024-03-31 12:41:01,740 - Results are saved in results/msz.csv
