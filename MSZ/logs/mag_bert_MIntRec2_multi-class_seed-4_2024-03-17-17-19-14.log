2024-03-17 17:19:14,667 - ============================== Params ==============================
2024-03-17 17:19:14,667 - logger_name: mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-17-19-14
2024-03-17 17:19:14,667 - dataset: MIntRec2
2024-03-17 17:19:14,667 - data_mode: multi-class
2024-03-17 17:19:14,667 - method: mag_bert
2024-03-17 17:19:14,668 - text_backbone: bert-base-uncased
2024-03-17 17:19:14,668 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-17 17:19:14,668 - seed: 4
2024-03-17 17:19:14,668 - num_workers: 8
2024-03-17 17:19:14,668 - gpu_id: 2
2024-03-17 17:19:14,668 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-17 17:19:14,668 - train: True
2024-03-17 17:19:14,668 - tune: True
2024-03-17 17:19:14,668 - save_model: False
2024-03-17 17:19:14,668 - save_results: True
2024-03-17 17:19:14,668 - log_path: logs
2024-03-17 17:19:14,668 - cache_path: 
2024-03-17 17:19:14,668 - video_data_path: video_data
2024-03-17 17:19:14,668 - audio_data_path: audio_data
2024-03-17 17:19:14,668 - video_feats_path: video_feats.pkl
2024-03-17 17:19:14,668 - audio_feats_path: audio_feats.pkl
2024-03-17 17:19:14,668 - results_path: results
2024-03-17 17:19:14,668 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-17 17:19:14,668 - model_path: models
2024-03-17 17:19:14,668 - config_file_name: mag_bert_MIntRec2
2024-03-17 17:19:14,668 - results_file_name: mag_bert.csv
2024-03-17 17:19:14,668 - padding_mode: zero
2024-03-17 17:19:14,668 - padding_loc: end
2024-03-17 17:19:14,668 - need_aligned: True
2024-03-17 17:19:14,668 - eval_monitor: f1
2024-03-17 17:19:14,668 - train_batch_size: 32
2024-03-17 17:19:14,668 - eval_batch_size: 16
2024-03-17 17:19:14,668 - test_batch_size: 16
2024-03-17 17:19:14,668 - wait_patience: 8
2024-03-17 17:19:14,668 - num_train_epochs: 100
2024-03-17 17:19:14,668 - beta_shift: 0.01
2024-03-17 17:19:14,668 - dropout_prob: 0.1
2024-03-17 17:19:14,668 - warmup_proportion: 0.1
2024-03-17 17:19:14,668 - lr: 9e-06
2024-03-17 17:19:14,668 - aligned_method: ctc
2024-03-17 17:19:14,668 - weight_decay: 0.1
2024-03-17 17:19:14,668 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-17-19-14
2024-03-17 17:19:14,668 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-17-19-14/models
2024-03-17 17:19:14,669 - num_labels: 30
2024-03-17 17:19:14,669 - text_feat_dim: 768
2024-03-17 17:19:14,669 - video_feat_dim: 256
2024-03-17 17:19:14,669 - audio_feat_dim: 768
2024-03-17 17:19:14,669 - text_seq_len: 50
2024-03-17 17:19:14,669 - video_seq_len: 180
2024-03-17 17:19:14,669 - audio_seq_len: 400
2024-03-17 17:19:14,669 - device: cuda:2
2024-03-17 17:19:14,669 - ============================== End Params ==============================
2024-03-17 17:19:14,720 - Generate Text Features Begin...
2024-03-17 17:19:16,516 - Generate Text Features Finished...
2024-03-17 17:19:16,535 - Load Video Features Begin...
2024-03-17 17:19:17,828 - Load Video Features Finished...
2024-03-17 17:19:19,557 - Load Audio Features Begin...
2024-03-17 17:19:39,993 - Load Audio Features Finished...
2024-03-17 17:19:52,211 - method  begins...
2024-03-17 17:19:53,325 - Multimodal intent recognition begins...
2024-03-17 17:19:53,325 - Training begins...
2024-03-17 17:20:29,243 - ***** Epoch: 1: Eval results *****
2024-03-17 17:20:29,252 -   train_loss = 3.3494
2024-03-17 17:20:29,252 -   best_eval_score = 0.0
2024-03-17 17:20:29,252 -   eval_score = 0.0382
2024-03-17 17:21:04,383 - ***** Epoch: 2: Eval results *****
2024-03-17 17:21:04,384 -   train_loss = 3.0982
2024-03-17 17:21:04,384 -   best_eval_score = 0.0382
2024-03-17 17:21:04,384 -   eval_score = 0.0805
2024-03-17 17:21:39,234 - ***** Epoch: 3: Eval results *****
2024-03-17 17:21:39,234 -   train_loss = 2.8128
2024-03-17 17:21:39,235 -   best_eval_score = 0.0805
2024-03-17 17:21:39,235 -   eval_score = 0.1552
2024-03-17 17:22:14,930 - ***** Epoch: 4: Eval results *****
2024-03-17 17:22:14,930 -   train_loss = 2.5093
2024-03-17 17:22:14,930 -   best_eval_score = 0.1552
2024-03-17 17:22:14,931 -   eval_score = 0.2513
2024-03-17 17:22:50,379 - ***** Epoch: 5: Eval results *****
2024-03-17 17:22:50,379 -   train_loss = 2.192
2024-03-17 17:22:50,379 -   best_eval_score = 0.2513
2024-03-17 17:22:50,379 -   eval_score = 0.3001
2024-03-17 17:23:25,130 - ***** Epoch: 6: Eval results *****
2024-03-17 17:23:25,130 -   train_loss = 1.9113
2024-03-17 17:23:25,130 -   best_eval_score = 0.3001
2024-03-17 17:23:25,130 -   eval_score = 0.337
2024-03-17 17:23:59,832 - ***** Epoch: 7: Eval results *****
2024-03-17 17:23:59,832 -   train_loss = 1.6947
2024-03-17 17:23:59,832 -   best_eval_score = 0.337
2024-03-17 17:23:59,832 -   eval_score = 0.3733
2024-03-17 17:24:35,091 - ***** Epoch: 8: Eval results *****
2024-03-17 17:24:35,091 -   train_loss = 1.4998
2024-03-17 17:24:35,091 -   best_eval_score = 0.3733
2024-03-17 17:24:35,091 -   eval_score = 0.4159
2024-03-17 17:25:08,646 - ***** Epoch: 9: Eval results *****
2024-03-17 17:25:08,646 -   train_loss = 1.3312
2024-03-17 17:25:08,647 -   best_eval_score = 0.4159
2024-03-17 17:25:08,647 -   eval_score = 0.4391
2024-03-17 17:25:43,303 - ***** Epoch: 10: Eval results *****
2024-03-17 17:25:43,303 -   train_loss = 1.1661
2024-03-17 17:25:43,303 -   best_eval_score = 0.4391
2024-03-17 17:25:43,303 -   eval_score = 0.4541
2024-03-17 17:26:17,383 - ***** Epoch: 11: Eval results *****
2024-03-17 17:26:17,384 -   train_loss = 1.0141
2024-03-17 17:26:17,384 -   best_eval_score = 0.4541
2024-03-17 17:26:17,384 -   eval_score = 0.4756
2024-03-17 17:26:51,508 - ***** Epoch: 12: Eval results *****
2024-03-17 17:26:51,508 -   train_loss = 0.8518
2024-03-17 17:26:51,508 -   best_eval_score = 0.4756
2024-03-17 17:26:51,508 -   eval_score = 0.4914
2024-03-17 17:27:25,862 - ***** Epoch: 13: Eval results *****
2024-03-17 17:27:25,863 -   train_loss = 0.7331
2024-03-17 17:27:25,863 -   best_eval_score = 0.4914
2024-03-17 17:27:25,863 -   eval_score = 0.4775
2024-03-17 17:27:25,863 - EarlyStopping counter: 1 out of 8
2024-03-17 17:28:00,644 - ***** Epoch: 14: Eval results *****
2024-03-17 17:28:00,644 -   train_loss = 0.6199
2024-03-17 17:28:00,644 -   best_eval_score = 0.4914
2024-03-17 17:28:00,644 -   eval_score = 0.4807
2024-03-17 17:28:00,645 - EarlyStopping counter: 2 out of 8
2024-03-17 17:28:35,490 - ***** Epoch: 15: Eval results *****
2024-03-17 17:28:35,490 -   train_loss = 0.5397
2024-03-17 17:28:35,490 -   best_eval_score = 0.4914
2024-03-17 17:28:35,490 -   eval_score = 0.4913
2024-03-17 17:28:35,491 - EarlyStopping counter: 3 out of 8
2024-03-17 17:29:09,988 - ***** Epoch: 16: Eval results *****
2024-03-17 17:29:09,997 -   train_loss = 0.4625
2024-03-17 17:29:09,997 -   best_eval_score = 0.4914
2024-03-17 17:29:09,997 -   eval_score = 0.4924
2024-03-17 17:29:44,638 - ***** Epoch: 17: Eval results *****
2024-03-17 17:29:44,639 -   train_loss = 0.3855
2024-03-17 17:29:44,639 -   best_eval_score = 0.4924
2024-03-17 17:29:44,639 -   eval_score = 0.4989
2024-03-17 17:30:19,281 - ***** Epoch: 18: Eval results *****
2024-03-17 17:30:19,282 -   train_loss = 0.3383
2024-03-17 17:30:19,282 -   best_eval_score = 0.4989
2024-03-17 17:30:19,282 -   eval_score = 0.4967
2024-03-17 17:30:19,282 - EarlyStopping counter: 1 out of 8
2024-03-17 17:30:53,450 - ***** Epoch: 19: Eval results *****
2024-03-17 17:30:53,450 -   train_loss = 0.2916
2024-03-17 17:30:53,450 -   best_eval_score = 0.4989
2024-03-17 17:30:53,450 -   eval_score = 0.5082
2024-03-17 17:31:28,572 - ***** Epoch: 20: Eval results *****
2024-03-17 17:31:28,572 -   train_loss = 0.2515
2024-03-17 17:31:28,572 -   best_eval_score = 0.5082
2024-03-17 17:31:28,573 -   eval_score = 0.5172
2024-03-17 17:32:03,407 - ***** Epoch: 21: Eval results *****
2024-03-17 17:32:03,408 -   train_loss = 0.2218
2024-03-17 17:32:03,408 -   best_eval_score = 0.5172
2024-03-17 17:32:03,408 -   eval_score = 0.5155
2024-03-17 17:32:03,408 - EarlyStopping counter: 1 out of 8
2024-03-17 17:32:38,072 - ***** Epoch: 22: Eval results *****
2024-03-17 17:32:38,072 -   train_loss = 0.1891
2024-03-17 17:32:38,073 -   best_eval_score = 0.5172
2024-03-17 17:32:38,073 -   eval_score = 0.5076
2024-03-17 17:32:38,073 - EarlyStopping counter: 2 out of 8
2024-03-17 17:33:12,371 - ***** Epoch: 23: Eval results *****
2024-03-17 17:33:12,372 -   train_loss = 0.1696
2024-03-17 17:33:12,372 -   best_eval_score = 0.5172
2024-03-17 17:33:12,372 -   eval_score = 0.5102
2024-03-17 17:33:12,372 - EarlyStopping counter: 3 out of 8
2024-03-17 17:33:46,477 - ***** Epoch: 24: Eval results *****
2024-03-17 17:33:46,478 -   train_loss = 0.1437
2024-03-17 17:33:46,478 -   best_eval_score = 0.5172
2024-03-17 17:33:46,478 -   eval_score = 0.4938
2024-03-17 17:33:46,478 - EarlyStopping counter: 4 out of 8
2024-03-17 17:34:20,678 - ***** Epoch: 25: Eval results *****
2024-03-17 17:34:20,678 -   train_loss = 0.1377
2024-03-17 17:34:20,678 -   best_eval_score = 0.5172
2024-03-17 17:34:20,678 -   eval_score = 0.515
2024-03-17 17:34:20,678 - EarlyStopping counter: 5 out of 8
2024-03-17 17:34:55,308 - ***** Epoch: 26: Eval results *****
2024-03-17 17:34:55,309 -   train_loss = 0.1162
2024-03-17 17:34:55,309 -   best_eval_score = 0.5172
2024-03-17 17:34:55,309 -   eval_score = 0.5183
2024-03-17 17:35:30,170 - ***** Epoch: 27: Eval results *****
2024-03-17 17:35:30,171 -   train_loss = 0.1102
2024-03-17 17:35:30,171 -   best_eval_score = 0.5183
2024-03-17 17:35:30,171 -   eval_score = 0.5117
2024-03-17 17:35:30,171 - EarlyStopping counter: 1 out of 8
2024-03-17 17:36:04,536 - ***** Epoch: 28: Eval results *****
2024-03-17 17:36:04,536 -   train_loss = 0.1059
2024-03-17 17:36:04,536 -   best_eval_score = 0.5183
2024-03-17 17:36:04,536 -   eval_score = 0.5081
2024-03-17 17:36:04,536 - EarlyStopping counter: 2 out of 8
2024-03-17 17:36:38,861 - ***** Epoch: 29: Eval results *****
2024-03-17 17:36:38,861 -   train_loss = 0.0975
2024-03-17 17:36:38,862 -   best_eval_score = 0.5183
2024-03-17 17:36:38,862 -   eval_score = 0.5155
2024-03-17 17:36:38,862 - EarlyStopping counter: 3 out of 8
2024-03-17 17:37:13,697 - ***** Epoch: 30: Eval results *****
2024-03-17 17:37:13,697 -   train_loss = 0.0871
2024-03-17 17:37:13,697 -   best_eval_score = 0.5183
2024-03-17 17:37:13,697 -   eval_score = 0.5038
2024-03-17 17:37:13,697 - EarlyStopping counter: 4 out of 8
2024-03-17 17:37:47,900 - ***** Epoch: 31: Eval results *****
2024-03-17 17:37:47,900 -   train_loss = 0.0779
2024-03-17 17:37:47,900 -   best_eval_score = 0.5183
2024-03-17 17:37:47,901 -   eval_score = 0.5126
2024-03-17 17:37:47,901 - EarlyStopping counter: 5 out of 8
2024-03-17 17:38:22,312 - ***** Epoch: 32: Eval results *****
2024-03-17 17:38:22,313 -   train_loss = 0.0745
2024-03-17 17:38:22,313 -   best_eval_score = 0.5183
2024-03-17 17:38:22,313 -   eval_score = 0.5116
2024-03-17 17:38:22,313 - EarlyStopping counter: 6 out of 8
2024-03-17 17:38:56,932 - ***** Epoch: 33: Eval results *****
2024-03-17 17:38:56,932 -   train_loss = 0.0719
2024-03-17 17:38:56,932 -   best_eval_score = 0.5183
2024-03-17 17:38:56,932 -   eval_score = 0.5123
2024-03-17 17:38:56,932 - EarlyStopping counter: 7 out of 8
2024-03-17 17:39:31,454 - ***** Epoch: 34: Eval results *****
2024-03-17 17:39:31,454 -   train_loss = 0.0634
2024-03-17 17:39:31,454 -   best_eval_score = 0.5183
2024-03-17 17:39:31,455 -   eval_score = 0.51
2024-03-17 17:39:31,455 - EarlyStopping counter: 8 out of 8
2024-03-17 17:39:31,455 - EarlyStopping at epoch 34
2024-03-17 17:39:31,457 - Training is finished...
2024-03-17 17:39:31,458 - Testing begins...
2024-03-17 17:39:39,190 - ***** Test: Confusion Matrix *****
2024-03-17 17:39:39,192 - [[ 44   0  18   0   0   0   0   0   1   0   2   0   0   1   0   0   0   0
    0   0   0   0   0   1   1   0   0   0   0   0]
 [  0  56   0   0  10   1   4   0   1   0   1   0   4   0   3   0   0  10
    1   2   0   0   1   0   1   0   0   2   0   0]
 [  8   1  43   0   0   0   0   0   0   0   1   0   0   1   1   0   0   2
    1   0   0   1   0   2   3   0   0   0   0   0]
 [  0   0   0  60   0   0   0   1   0   0   0   0   0   0   3   0   0   1
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   4   0   0  32   0   0   0   1   0   0   0   0   1   0   0   0   3
    0   3   1   1   0   1   1   0   0   0   1   2]
 [  0   0   0   0   1  26   0   0   0   1   1   0   0   1   1   0   0   4
    0   1   0   0   0   0   0   1   0   0   0   0]
 [  0   1   0   0   0   4  28   8   0   1   2   0   4   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   7  24   0   1   5   0   7   0   0   0   2   0
    0   0   0   0   0   0   0   0   0   1   0   0]
 [  1   4   2   3   1   0   0   0  19   2   0   0   2   2   4   0   0   3
    0   0   0   0   3   0   2   1   0   0   0   0]
 [  0   1   1   0   1   0   1   0   2  51   0   6   8   4  12   0   0   5
    2   0   2   2   2   0   2   1   1   3   0   0]
 [  2   0   0   0   0   4   3   2   0   1  41   0  33   0   2   0   0   2
    0   2   0   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   0   5   1  19   9   0   3   0   0   1
    0   0   1   0   3   0   0   0   0   3   0   1]
 [  0   2   0   0   0   2   5  11   0   6  19   0  86   1   0   0   1   0
    0   0   1   0   1   0   0   0   0   0   0   0]
 [  0   0   2   0   1   0   0   0   1   1   0   0   0   2   2   2   0   3
    2   0   0   0   1   0   0   0   0   0   0   0]
 [  0   2   2   0   0   1   0   0   4   9   2   0   2   4 113   2   0  25
    3   1   1   0  12   1   4   0   0   5   0   0]
 [  0   0   2   0   1   0   0   0   0   4   0   0   0   1   0   5   0   2
    1   0   1   1   2   0   0   0   0   1   1   0]
 [  0   0   0   0   1   0   0   1   0   0   3   0   2   0   0   0  57   0
    2   0   0   0   0   0   0   0   0   0   0   0]
 [  0   4   2   0   6   4   0   0   5   9   1   0   1   6  16   3   1 122
    8   2   3   2   4  11   0   1   3   0   1   2]
 [  0   1   0   0   0   0   1   0   0   3   2   0   0   5   6   2   1   8
   25   0   2   0   2   0   2   0   0   0   0   0]
 [  0   4   0   0   1   0   2   0   0   0   2   0   0   0   0   0   0   0
    0   7   0   1   0   0   0   0   0   0   0   0]
 [  0   1   2   0   1   0   0   0   0   1   0   1   1   0   5   0   0   4
    5   0   5   0   0   0   2   0   0   1   0   0]
 [  7   1   0   0   0   0   0   0   0   2   0   0   0   0   1   0   4   0
    0   1   0  24   0   6   0   1   1   3   0   2]
 [  0   1   2   1   0   0   0   0   0   3   0   1   0   2   8   1   0   3
    0   0   0   1  81   0   1   2   9   1   0   0]
 [  0   2   2   0   0   0   0   0   0   2   0   0   0   0   0   1   0   7
    0   0   0   4   0  20   0   0   0   0   0   0]
 [  2   0   4   1   0   0   1   0   1   3   0   1   0   1   2   0   0   2
    1   0   0   0   1   0  83   0   0   8   2   0]
 [  1   1   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   1
    0   0   0   0   3   1   1  20   0   0   0   2]
 [  0   0   0   0   0   0   0   0   0   1   0   0   0   0   1   0   0   4
    0   0   0   1   2   0   0   0   5   0   3   0]
 [  1   3   1   0   0   0   0   1   2   5   2   4   3   1   4   1   0   3
    0   0   2   0   3   0   7   2   0   9   1   3]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
    0   0   0   0   0   0   0   0   1   0  56   0]
 [  0   2   0   0   0   0   0   0   1   1   1   1   0   0   0   0   0   4
    1   0   0   0   0   0   1   1   0   0   0   6]]
2024-03-17 17:39:39,192 - ***** Evaluation results *****
2024-03-17 17:39:39,192 -   acc = 0.575
2024-03-17 17:39:39,192 -   f1 = 0.5224
2024-03-17 17:39:39,192 -   prec = 0.5273
2024-03-17 17:39:39,192 -   rec = 0.5243
2024-03-17 17:39:39,192 - Testing is finished...
2024-03-17 17:39:39,193 - Multimodal intent recognition is finished...
2024-03-17 17:39:39,193 - Results are saved in results/mag_bert.csv
