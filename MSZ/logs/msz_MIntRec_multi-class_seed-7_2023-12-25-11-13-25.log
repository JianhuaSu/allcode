2023-12-25 11:13:25,749 - ============================== Params ==============================
2023-12-25 11:13:25,749 - logger_name: msz_MIntRec_multi-class_seed-7_2023-12-25-11-13-25
2023-12-25 11:13:25,749 - dataset: MIntRec
2023-12-25 11:13:25,749 - data_mode: multi-class
2023-12-25 11:13:25,749 - method: msz
2023-12-25 11:13:25,749 - text_backbone: bert-base-uncased
2023-12-25 11:13:25,750 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-25 11:13:25,750 - seed: 7
2023-12-25 11:13:25,750 - num_workers: 8
2023-12-25 11:13:25,750 - gpu_id: 0
2023-12-25 11:13:25,750 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-25 11:13:25,750 - train: True
2023-12-25 11:13:25,750 - tune: False
2023-12-25 11:13:25,750 - save_model: False
2023-12-25 11:13:25,750 - save_results: True
2023-12-25 11:13:25,750 - log_path: logs
2023-12-25 11:13:25,750 - cache_path: 
2023-12-25 11:13:25,750 - video_data_path: video_data
2023-12-25 11:13:25,750 - audio_data_path: audio_data
2023-12-25 11:13:25,750 - video_feats_path: video_feats.pkl
2023-12-25 11:13:25,750 - audio_feats_path: audio_feats.pkl
2023-12-25 11:13:25,750 - results_path: results
2023-12-25 11:13:25,750 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-25 11:13:25,750 - model_path: models
2023-12-25 11:13:25,750 - config_file_name: msz
2023-12-25 11:13:25,750 - results_file_name: msz.csv
2023-12-25 11:13:25,750 - padding_mode: zero
2023-12-25 11:13:25,750 - padding_loc: end
2023-12-25 11:13:25,750 - need_aligned: False
2023-12-25 11:13:25,750 - eval_monitor: f1
2023-12-25 11:13:25,750 - train_batch_size: 16
2023-12-25 11:13:25,750 - eval_batch_size: 8
2023-12-25 11:13:25,750 - test_batch_size: 8
2023-12-25 11:13:25,750 - wait_patience: 8
2023-12-25 11:13:25,750 - nheads: 2
2023-12-25 11:13:25,750 - encoder_layers: 2
2023-12-25 11:13:25,750 - attn_dropout: 0.1
2023-12-25 11:13:25,750 - relu_dropout: 0.1
2023-12-25 11:13:25,750 - embed_dropout: 0.1
2023-12-25 11:13:25,750 - res_dropout: 0.1
2023-12-25 11:13:25,750 - attn_mask: False
2023-12-25 11:13:25,750 - hidden_size: 768
2023-12-25 11:13:25,750 - num_attention_heads: 12
2023-12-25 11:13:25,750 - attention_probs_dropout_prob: 0.2
2023-12-25 11:13:25,750 - hidden_dropout_prob: 0.2
2023-12-25 11:13:25,750 - intermediate_size: 768
2023-12-25 11:13:25,750 - num_hidden_layers: 3
2023-12-25 11:13:25,750 - max_position_embeddings: 512
2023-12-25 11:13:25,750 - position_embedding_type: absolute
2023-12-25 11:13:25,750 - add_cross_attention: False
2023-12-25 11:13:25,751 - batch_first: True
2023-12-25 11:13:25,751 - hidden_dims: 768
2023-12-25 11:13:25,751 - att_dropouts: [0.1, 0.1, 0.1]
2023-12-25 11:13:25,751 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-25 11:13:25,751 - sl: 0.1
2023-12-25 11:13:25,751 - cl: 0.1
2023-12-25 11:13:25,751 - num_train_epochs: 100
2023-12-25 11:13:25,751 - warmup_proportion: 0.1
2023-12-25 11:13:25,751 - lr: 5e-06
2023-12-25 11:13:25,751 - weight_decay: 0.01
2023-12-25 11:13:25,751 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-7_2023-12-25-11-13-25
2023-12-25 11:13:25,751 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-7_2023-12-25-11-13-25/models
2023-12-25 11:13:25,751 - ============================== End Params ==============================
2023-12-25 11:13:25,880 - Generate Text Features Begin...
2023-12-25 11:13:26,350 - Generate Text Features Finished...
2023-12-25 11:13:26,512 - Load Video Features Begin...
2023-12-25 11:13:28,776 - Load Video Features Finished...
2023-12-25 11:13:29,543 - Load Audio Features Begin...
2023-12-25 11:13:37,265 - Load Audio Features Finished...
2023-12-25 11:13:55,093 - method  begins...
2023-12-25 11:14:32,395 - Multimodal intent recognition begins...
2023-12-25 11:14:32,395 - Training begins...
2023-12-25 11:15:12,666 - ***** Epoch: 1: Eval results *****
2023-12-25 11:15:12,670 -   train_loss = 2.9749
2023-12-25 11:15:12,670 -   best_eval_score = 0.0
2023-12-25 11:15:12,670 -   eval_score = 0.0187
2023-12-25 11:15:32,029 - ***** Epoch: 2: Eval results *****
2023-12-25 11:15:32,030 -   train_loss = 2.7996
2023-12-25 11:15:32,030 -   best_eval_score = 0.0187
2023-12-25 11:15:32,030 -   eval_score = 0.0781
2023-12-25 11:15:51,076 - ***** Epoch: 3: Eval results *****
2023-12-25 11:15:51,077 -   train_loss = 2.545
2023-12-25 11:15:51,077 -   best_eval_score = 0.0781
2023-12-25 11:15:51,077 -   eval_score = 0.0873
2023-12-25 11:16:11,040 - ***** Epoch: 4: Eval results *****
2023-12-25 11:16:11,040 -   train_loss = 2.2404
2023-12-25 11:16:11,040 -   best_eval_score = 0.0873
2023-12-25 11:16:11,040 -   eval_score = 0.1623
2023-12-25 11:16:32,657 - ***** Epoch: 5: Eval results *****
2023-12-25 11:16:32,658 -   train_loss = 1.9929
2023-12-25 11:16:32,658 -   best_eval_score = 0.1623
2023-12-25 11:16:32,658 -   eval_score = 0.3522
2023-12-25 11:16:52,809 - ***** Epoch: 6: Eval results *****
2023-12-25 11:16:52,810 -   train_loss = 1.6597
2023-12-25 11:16:52,810 -   best_eval_score = 0.3522
2023-12-25 11:16:52,810 -   eval_score = 0.3128
2023-12-25 11:16:52,810 - EarlyStopping counter: 1 out of 8
2023-12-25 11:17:13,385 - ***** Epoch: 7: Eval results *****
2023-12-25 11:17:13,385 -   train_loss = 1.4673
2023-12-25 11:17:13,386 -   best_eval_score = 0.3522
2023-12-25 11:17:13,386 -   eval_score = 0.4085
2023-12-25 11:17:36,006 - ***** Epoch: 8: Eval results *****
2023-12-25 11:17:36,007 -   train_loss = 1.2877
2023-12-25 11:17:36,007 -   best_eval_score = 0.4085
2023-12-25 11:17:36,007 -   eval_score = 0.4497
2023-12-25 11:18:02,486 - ***** Epoch: 9: Eval results *****
2023-12-25 11:18:02,486 -   train_loss = 1.1736
2023-12-25 11:18:02,486 -   best_eval_score = 0.4497
2023-12-25 11:18:02,486 -   eval_score = 0.4526
2023-12-25 11:18:21,902 - ***** Epoch: 10: Eval results *****
2023-12-25 11:18:21,903 -   train_loss = 1.1917
2023-12-25 11:18:21,903 -   best_eval_score = 0.4526
2023-12-25 11:18:21,903 -   eval_score = 0.4525
2023-12-25 11:18:21,903 - EarlyStopping counter: 1 out of 8
2023-12-25 11:18:41,663 - ***** Epoch: 11: Eval results *****
2023-12-25 11:18:41,664 -   train_loss = 1.2907
2023-12-25 11:18:41,664 -   best_eval_score = 0.4526
2023-12-25 11:18:41,664 -   eval_score = 0.5152
2023-12-25 11:19:03,251 - ***** Epoch: 12: Eval results *****
2023-12-25 11:19:03,251 -   train_loss = 1.2373
2023-12-25 11:19:03,251 -   best_eval_score = 0.5152
2023-12-25 11:19:03,251 -   eval_score = 0.407
2023-12-25 11:19:03,251 - EarlyStopping counter: 1 out of 8
2023-12-25 11:19:21,774 - ***** Epoch: 13: Eval results *****
2023-12-25 11:19:21,774 -   train_loss = 1.4929
2023-12-25 11:19:21,774 -   best_eval_score = 0.5152
2023-12-25 11:19:21,775 -   eval_score = 0.4101
2023-12-25 11:19:21,775 - EarlyStopping counter: 2 out of 8
2023-12-25 11:19:40,021 - ***** Epoch: 14: Eval results *****
2023-12-25 11:19:40,022 -   train_loss = 1.461
2023-12-25 11:19:40,022 -   best_eval_score = 0.5152
2023-12-25 11:19:40,022 -   eval_score = 0.3802
2023-12-25 11:19:40,022 - EarlyStopping counter: 3 out of 8
2023-12-25 11:19:58,165 - ***** Epoch: 15: Eval results *****
2023-12-25 11:19:58,166 -   train_loss = 1.3997
2023-12-25 11:19:58,166 -   best_eval_score = 0.5152
2023-12-25 11:19:58,166 -   eval_score = 0.4129
2023-12-25 11:19:58,166 - EarlyStopping counter: 4 out of 8
2023-12-25 11:20:17,271 - ***** Epoch: 16: Eval results *****
2023-12-25 11:20:17,273 -   train_loss = 1.3235
2023-12-25 11:20:17,273 -   best_eval_score = 0.5152
2023-12-25 11:20:17,273 -   eval_score = 0.3411
2023-12-25 11:20:17,273 - EarlyStopping counter: 5 out of 8
2023-12-25 11:20:37,170 - ***** Epoch: 17: Eval results *****
2023-12-25 11:20:37,171 -   train_loss = 1.4548
2023-12-25 11:20:37,171 -   best_eval_score = 0.5152
2023-12-25 11:20:37,171 -   eval_score = 0.399
2023-12-25 11:20:37,171 - EarlyStopping counter: 6 out of 8
2023-12-25 11:20:57,102 - ***** Epoch: 18: Eval results *****
2023-12-25 11:20:57,103 -   train_loss = 1.3997
2023-12-25 11:20:57,103 -   best_eval_score = 0.5152
2023-12-25 11:20:57,103 -   eval_score = 0.3521
2023-12-25 11:20:57,103 - EarlyStopping counter: 7 out of 8
2023-12-25 11:21:17,733 - ***** Epoch: 19: Eval results *****
2023-12-25 11:21:17,734 -   train_loss = 1.3691
2023-12-25 11:21:17,734 -   best_eval_score = 0.5152
2023-12-25 11:21:17,734 -   eval_score = 0.3595
2023-12-25 11:21:17,734 - EarlyStopping counter: 8 out of 8
2023-12-25 11:21:17,734 - EarlyStopping at epoch 19
2023-12-25 11:21:17,738 - Training is finished...
2023-12-25 11:21:17,738 - Testing begins...
2023-12-25 11:21:35,070 - ***** Test: Confusion Matrix *****
2023-12-25 11:21:35,084 - [[33  1  0  0  2  0  0  0  0  7  1  0  5  3  3  0  1  1  0  0]
 [ 3 31  0  1  0  5  0  0  0  0  0  0  1  0  0  0  2  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 22  0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  0]
 [ 5  0  0  0 10  0  0  0  0  1  2  1  0  3  0  0  0  1  0  0]
 [ 0  0  0  0  0 10  0  0  0  1  0  0  0  0  0  0  1  0  0  0]
 [ 4  0  0  0  2  0  0  0  0  2  1  0  1  0  0  0  1  1  0  0]
 [ 5  2  0  0  0  0  0  0  0  1  0  0  2  0  0  0  0  0  0  0]
 [ 3  0  0  0  1  0  0  0  0  0  0  0  0  2  1  0  3  0  0  0]
 [ 3  0  0  0  1  0  0  0  0  2  0  0  0  0  1  0  1  2  0  0]
 [ 1  0  0  0  0  2  0  0  0  1 14  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  1  0  0  0  0  0  9  7  0  0  0  0  0  0  0  0]
 [ 5  1  0  1  0  3  0  0  0  1  3  0 25  0  9  1  8  0  0  0]
 [ 0  2  0  0  0  0  0  0  0  1  1  1  0  8  5  0  7  0  0  0]
 [ 0  0  1  0  1  0  0  0  0  0  0  0  1  1  9  0  9  0  0  0]
 [ 2  1  0  1  0  0  0  0  0  1  0  0  6  0  1  8  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  3  0 13  0  0  0]
 [ 3  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 12  0  0]
 [ 0  1  0  0  0  1  0  0  0  0  0  0  2  0  0  0  0  0  8  0]
 [ 0  0  0  0  1  0  0  0  0  0  0  2  0  1  6  0  0  0  0  0]]
2023-12-25 11:21:35,084 - ***** Evaluation results *****
2023-12-25 11:21:35,084 -   acc = 0.5348
2023-12-25 11:21:35,084 -   f1 = 0.4506
2023-12-25 11:21:35,084 -   prec = 0.4694
2023-12-25 11:21:35,084 -   rec = 0.4769
2023-12-25 11:21:35,084 - Testing is finished...
2023-12-25 11:21:35,084 - Multimodal intent recognition is finished...
2023-12-25 11:21:35,084 - Results are saved in results/msz.csv
