2024-03-01 05:28:08,053 - ============================== Params ==============================
2024-03-01 05:28:08,053 - logger_name: msz_MIntRec_multi-class_seed-1_2024-03-01-05-28-07
2024-03-01 05:28:08,053 - dataset: MIntRec
2024-03-01 05:28:08,053 - data_mode: multi-class
2024-03-01 05:28:08,053 - method: msz
2024-03-01 05:28:08,053 - text_backbone: bert-base-uncased
2024-03-01 05:28:08,053 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-01 05:28:08,053 - seed: 1
2024-03-01 05:28:08,053 - num_workers: 8
2024-03-01 05:28:08,053 - gpu_id: 3
2024-03-01 05:28:08,053 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-01 05:28:08,053 - train: True
2024-03-01 05:28:08,054 - tune: True
2024-03-01 05:28:08,054 - save_model: True
2024-03-01 05:28:08,054 - save_results: True
2024-03-01 05:28:08,054 - log_path: logs
2024-03-01 05:28:08,054 - cache_path: 
2024-03-01 05:28:08,054 - video_data_path: video_data
2024-03-01 05:28:08,054 - audio_data_path: audio_data
2024-03-01 05:28:08,054 - video_feats_path: video_feats.pkl
2024-03-01 05:28:08,054 - audio_feats_path: audio_feats.pkl
2024-03-01 05:28:08,054 - results_path: results
2024-03-01 05:28:08,054 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-03-01 05:28:08,054 - model_path: models
2024-03-01 05:28:08,054 - config_file_name: msz_MIntRec
2024-03-01 05:28:08,054 - results_file_name: msz.csv
2024-03-01 05:28:08,054 - padding_mode: zero
2024-03-01 05:28:08,054 - padding_loc: end
2024-03-01 05:28:08,054 - need_aligned: False
2024-03-01 05:28:08,054 - eval_monitor: f1
2024-03-01 05:28:08,054 - train_batch_size: 16
2024-03-01 05:28:08,054 - eval_batch_size: 8
2024-03-01 05:28:08,054 - test_batch_size: 8
2024-03-01 05:28:08,054 - wait_patience: 8
2024-03-01 05:28:08,054 - hidden_size: 768
2024-03-01 05:28:08,054 - num_attention_heads: 12
2024-03-01 05:28:08,054 - attention_probs_dropout_prob: 0.1
2024-03-01 05:28:08,054 - hidden_dropout_prob: 0.2
2024-03-01 05:28:08,054 - intermediate_size: 768
2024-03-01 05:28:08,054 - num_hidden_layers: 4
2024-03-01 05:28:08,054 - max_position_embeddings: 768
2024-03-01 05:28:08,054 - position_embedding_type: absolute
2024-03-01 05:28:08,054 - batch_first: True
2024-03-01 05:28:08,054 - hidden_dims: 768
2024-03-01 05:28:08,054 - dropout: 0.3
2024-03-01 05:28:08,054 - aligned_method: conv1d
2024-03-01 05:28:08,054 - num_train_epochs: 100
2024-03-01 05:28:08,054 - lr: 6e-06
2024-03-01 05:28:08,054 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-03-01-05-28-07
2024-03-01 05:28:08,054 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-03-01-05-28-07/models
2024-03-01 05:28:08,054 - ============================== End Params ==============================
2024-03-01 05:28:08,057 - Generate Text Features Begin...
2024-03-01 05:28:08,461 - Generate Text Features Finished...
2024-03-01 05:28:08,461 - Load Video Features Begin...
2024-03-01 05:28:08,710 - Load Video Features Finished...
2024-03-01 05:28:09,185 - Load Audio Features Begin...
2024-03-01 05:28:09,961 - Load Audio Features Finished...
2024-03-01 05:28:13,398 - method  begins...
2024-03-01 05:28:15,902 - Multimodal intent recognition begins...
2024-03-01 05:28:15,903 - Training begins...
2024-03-01 05:28:35,115 - ***** Epoch: 1: Eval results *****
2024-03-01 05:28:35,116 -   train_loss = 2.7717
2024-03-01 05:28:35,116 -   best_eval_score = 0.0
2024-03-01 05:28:35,116 -   eval_score = 0.1553
2024-03-01 05:28:48,505 - ***** Epoch: 2: Eval results *****
2024-03-01 05:28:48,505 -   train_loss = 2.1161
2024-03-01 05:28:48,505 -   best_eval_score = 0.1553
2024-03-01 05:28:48,505 -   eval_score = 0.3411
2024-03-01 05:29:02,160 - ***** Epoch: 3: Eval results *****
2024-03-01 05:29:02,161 -   train_loss = 1.402
2024-03-01 05:29:02,161 -   best_eval_score = 0.3411
2024-03-01 05:29:02,161 -   eval_score = 0.5373
2024-03-01 05:29:18,032 - ***** Epoch: 4: Eval results *****
2024-03-01 05:29:18,033 -   train_loss = 0.895
2024-03-01 05:29:18,033 -   best_eval_score = 0.5373
2024-03-01 05:29:18,033 -   eval_score = 0.6259
2024-03-01 05:29:31,989 - ***** Epoch: 5: Eval results *****
2024-03-01 05:29:31,989 -   train_loss = 0.5641
2024-03-01 05:29:31,989 -   best_eval_score = 0.6259
2024-03-01 05:29:31,989 -   eval_score = 0.6613
2024-03-01 05:29:45,500 - ***** Epoch: 6: Eval results *****
2024-03-01 05:29:45,501 -   train_loss = 0.3559
2024-03-01 05:29:45,501 -   best_eval_score = 0.6613
2024-03-01 05:29:45,501 -   eval_score = 0.6728
2024-03-01 05:30:02,650 - ***** Epoch: 7: Eval results *****
2024-03-01 05:30:02,650 -   train_loss = 0.2432
2024-03-01 05:30:02,650 -   best_eval_score = 0.6728
2024-03-01 05:30:02,650 -   eval_score = 0.6821
2024-03-01 05:30:17,588 - ***** Epoch: 8: Eval results *****
2024-03-01 05:30:17,588 -   train_loss = 0.1601
2024-03-01 05:30:17,588 -   best_eval_score = 0.6821
2024-03-01 05:30:17,588 -   eval_score = 0.6846
2024-03-01 05:30:32,580 - ***** Epoch: 9: Eval results *****
2024-03-01 05:30:32,581 -   train_loss = 0.1046
2024-03-01 05:30:32,581 -   best_eval_score = 0.6846
2024-03-01 05:30:32,581 -   eval_score = 0.7025
2024-03-01 05:30:48,562 - ***** Epoch: 10: Eval results *****
2024-03-01 05:30:48,562 -   train_loss = 0.0668
2024-03-01 05:30:48,563 -   best_eval_score = 0.7025
2024-03-01 05:30:48,563 -   eval_score = 0.6766
2024-03-01 05:30:48,563 - EarlyStopping counter: 1 out of 8
2024-03-01 05:31:01,911 - ***** Epoch: 11: Eval results *****
2024-03-01 05:31:01,911 -   train_loss = 0.0451
2024-03-01 05:31:01,911 -   best_eval_score = 0.7025
2024-03-01 05:31:01,911 -   eval_score = 0.6864
2024-03-01 05:31:01,911 - EarlyStopping counter: 2 out of 8
2024-03-01 05:31:18,444 - ***** Epoch: 12: Eval results *****
2024-03-01 05:31:18,444 -   train_loss = 0.0402
2024-03-01 05:31:18,444 -   best_eval_score = 0.7025
2024-03-01 05:31:18,444 -   eval_score = 0.6969
2024-03-01 05:31:18,444 - EarlyStopping counter: 3 out of 8
2024-03-01 05:31:32,096 - ***** Epoch: 13: Eval results *****
2024-03-01 05:31:32,096 -   train_loss = 0.0413
2024-03-01 05:31:32,096 -   best_eval_score = 0.7025
2024-03-01 05:31:32,096 -   eval_score = 0.7031
2024-03-01 05:31:45,952 - ***** Epoch: 14: Eval results *****
2024-03-01 05:31:45,952 -   train_loss = 0.0384
2024-03-01 05:31:45,952 -   best_eval_score = 0.7031
2024-03-01 05:31:45,952 -   eval_score = 0.7034
2024-03-01 05:32:05,320 - ***** Epoch: 15: Eval results *****
2024-03-01 05:32:05,320 -   train_loss = 0.0364
2024-03-01 05:32:05,320 -   best_eval_score = 0.7034
2024-03-01 05:32:05,321 -   eval_score = 0.7014
2024-03-01 05:32:05,321 - EarlyStopping counter: 1 out of 8
2024-03-01 05:32:19,148 - ***** Epoch: 16: Eval results *****
2024-03-01 05:32:19,149 -   train_loss = 0.0344
2024-03-01 05:32:19,149 -   best_eval_score = 0.7034
2024-03-01 05:32:19,149 -   eval_score = 0.6964
2024-03-01 05:32:19,149 - EarlyStopping counter: 2 out of 8
2024-03-01 05:32:32,783 - ***** Epoch: 17: Eval results *****
2024-03-01 05:32:32,784 -   train_loss = 0.0337
2024-03-01 05:32:32,784 -   best_eval_score = 0.7034
2024-03-01 05:32:32,784 -   eval_score = 0.6969
2024-03-01 05:32:32,784 - EarlyStopping counter: 3 out of 8
2024-03-01 05:32:49,324 - ***** Epoch: 18: Eval results *****
2024-03-01 05:32:49,324 -   train_loss = 0.0331
2024-03-01 05:32:49,324 -   best_eval_score = 0.7034
2024-03-01 05:32:49,324 -   eval_score = 0.7016
2024-03-01 05:32:49,324 - EarlyStopping counter: 4 out of 8
2024-03-01 05:33:02,909 - ***** Epoch: 19: Eval results *****
2024-03-01 05:33:02,909 -   train_loss = 0.0307
2024-03-01 05:33:02,909 -   best_eval_score = 0.7034
2024-03-01 05:33:02,909 -   eval_score = 0.7011
2024-03-01 05:33:02,909 - EarlyStopping counter: 5 out of 8
2024-03-01 05:33:16,749 - ***** Epoch: 20: Eval results *****
2024-03-01 05:33:16,749 -   train_loss = 0.029
2024-03-01 05:33:16,749 -   best_eval_score = 0.7034
2024-03-01 05:33:16,749 -   eval_score = 0.7011
2024-03-01 05:33:16,750 - EarlyStopping counter: 6 out of 8
2024-03-01 05:33:35,440 - ***** Epoch: 21: Eval results *****
2024-03-01 05:33:35,441 -   train_loss = 0.03
2024-03-01 05:33:35,441 -   best_eval_score = 0.7034
2024-03-01 05:33:35,441 -   eval_score = 0.7011
2024-03-01 05:33:35,441 - EarlyStopping counter: 7 out of 8
2024-03-01 05:33:50,562 - ***** Epoch: 22: Eval results *****
2024-03-01 05:33:50,563 -   train_loss = 0.0296
2024-03-01 05:33:50,563 -   best_eval_score = 0.7034
2024-03-01 05:33:50,563 -   eval_score = 0.7011
2024-03-01 05:33:50,563 - EarlyStopping counter: 8 out of 8
2024-03-01 05:33:50,563 - EarlyStopping at epoch 22
2024-03-01 05:33:50,563 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-03-01-05-28-07/models
2024-03-01 05:33:51,564 - Training is finished...
2024-03-01 05:33:51,564 - Testing begins...
2024-03-01 05:33:54,294 - ***** Test: Confusion Matrix *****
2024-03-01 05:33:54,296 - [[36  1  0  0 10  0  2  1  0  1  1  0  4  1  0  0  0  0  0  0]
 [ 0 35  0  1  0  2  0  1  0  0  1  0  2  0  1  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 6  0  0  0 11  0  1  0  1  0  0  1  1  0  0  0  0  2  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 2  1  0  0  3  0  2  0  2  0  0  0  1  0  1  0  0  0  0  0]
 [ 3  1  0  0  0  0  0  5  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  2  3  0  0  0  0  2  0  2  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  3  1  0  0  0  0  3  0  1  0  0]
 [ 1  0  0  0  0  0  0  0  0  1 15  0  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  1  0]
 [ 3  2  0  0  1  0  0  1  0  0  0  1 38  4  5  0  2  0  0  0]
 [ 0  1  0  0  0  0  2  0  0  0  1  1  0 19  1  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  1  0  0  0  2  2 15  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  1  1  0  0  0  3  0  0 15  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  2  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  2  0  2  0  0  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  1  2  0  2  0  0  3]]
2024-03-01 05:33:54,296 - ***** Evaluation results *****
2024-03-01 05:33:54,296 -   acc = 0.6944
2024-03-01 05:33:54,296 -   f1 = 0.6515
2024-03-01 05:33:54,296 -   prec = 0.6701
2024-03-01 05:33:54,296 -   rec = 0.6502
2024-03-01 05:33:54,296 - Testing is finished...
2024-03-01 05:33:54,296 - Multimodal intent recognition is finished...
2024-03-01 05:33:54,296 - Results are saved in results/msz.csv
