2024-01-15 03:20:22,465 - ============================== Params ==============================
2024-01-15 03:20:22,466 - logger_name: msz_MIntRec_multi-class_seed-1_2024-01-15-03-20-22
2024-01-15 03:20:22,466 - dataset: MIntRec
2024-01-15 03:20:22,466 - data_mode: multi-class
2024-01-15 03:20:22,466 - method: msz
2024-01-15 03:20:22,466 - text_backbone: bert-base-uncased
2024-01-15 03:20:22,466 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-15 03:20:22,466 - seed: 1
2024-01-15 03:20:22,466 - num_workers: 8
2024-01-15 03:20:22,466 - gpu_id: 1
2024-01-15 03:20:22,466 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-15 03:20:22,466 - train: True
2024-01-15 03:20:22,466 - tune: False
2024-01-15 03:20:22,466 - save_model: False
2024-01-15 03:20:22,466 - save_results: True
2024-01-15 03:20:22,466 - log_path: logs
2024-01-15 03:20:22,466 - cache_path: 
2024-01-15 03:20:22,466 - video_data_path: video_data
2024-01-15 03:20:22,466 - audio_data_path: audio_data
2024-01-15 03:20:22,466 - video_feats_path: video_feats.pkl
2024-01-15 03:20:22,466 - audio_feats_path: audio_feats.pkl
2024-01-15 03:20:22,466 - results_path: results
2024-01-15 03:20:22,466 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-15 03:20:22,466 - model_path: models
2024-01-15 03:20:22,466 - config_file_name: msz
2024-01-15 03:20:22,466 - results_file_name: msz.csv
2024-01-15 03:20:22,466 - padding_mode: zero
2024-01-15 03:20:22,466 - padding_loc: end
2024-01-15 03:20:22,466 - need_aligned: False
2024-01-15 03:20:22,466 - eval_monitor: f1
2024-01-15 03:20:22,466 - train_batch_size: 16
2024-01-15 03:20:22,467 - eval_batch_size: 8
2024-01-15 03:20:22,467 - test_batch_size: 8
2024-01-15 03:20:22,467 - wait_patience: 8
2024-01-15 03:20:22,467 - nheads: 12
2024-01-15 03:20:22,467 - encoder_layers: 8
2024-01-15 03:20:22,467 - attn_dropout: 0.2
2024-01-15 03:20:22,467 - relu_dropout: 0.3
2024-01-15 03:20:22,467 - embed_dropout: 0.2
2024-01-15 03:20:22,467 - res_dropout: 0.2
2024-01-15 03:20:22,467 - attn_mask: False
2024-01-15 03:20:22,467 - hidden_size: 768
2024-01-15 03:20:22,467 - num_attention_heads: 12
2024-01-15 03:20:22,467 - attention_probs_dropout_prob: 0.2
2024-01-15 03:20:22,467 - hidden_dropout_prob: 0.2
2024-01-15 03:20:22,467 - intermediate_size: 768
2024-01-15 03:20:22,467 - num_hidden_layers: 8
2024-01-15 03:20:22,467 - max_position_embeddings: 768
2024-01-15 03:20:22,467 - position_embedding_type: absolute
2024-01-15 03:20:22,467 - batch_first: True
2024-01-15 03:20:22,467 - hidden_dims: 768
2024-01-15 03:20:22,467 - dropout: 0.3
2024-01-15 03:20:22,467 - aligned_method: conv1d
2024-01-15 03:20:22,467 - grad_clip: -1
2024-01-15 03:20:22,467 - num_train_epochs: 100
2024-01-15 03:20:22,467 - warmup_proportion: 0.1
2024-01-15 03:20:22,467 - lr: 3e-06
2024-01-15 03:20:22,467 - weight_decay: 0.01
2024-01-15 03:20:22,467 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-15-03-20-22
2024-01-15 03:20:22,467 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-15-03-20-22/models
2024-01-15 03:20:22,467 - ============================== End Params ==============================
2024-01-15 03:20:22,470 - Generate Text Features Begin...
2024-01-15 03:20:22,969 - Generate Text Features Finished...
2024-01-15 03:20:22,970 - Load Video Features Begin...
2024-01-15 03:20:23,267 - Load Video Features Finished...
2024-01-15 03:20:23,810 - Load Audio Features Begin...
2024-01-15 03:20:24,743 - Load Audio Features Finished...
2024-01-15 03:20:27,989 - method  begins...
2024-01-15 03:20:32,803 - Multimodal intent recognition begins...
2024-01-15 03:20:32,803 - Training begins...
2024-01-15 03:20:51,168 - ***** Epoch: 1: Eval results *****
2024-01-15 03:20:51,168 -   train_loss = 3.0008
2024-01-15 03:20:51,168 -   best_eval_score = 0.0
2024-01-15 03:20:51,168 -   eval_score = 0.0185
2024-01-15 03:21:07,746 - ***** Epoch: 2: Eval results *****
2024-01-15 03:21:07,747 -   train_loss = 2.9897
2024-01-15 03:21:07,747 -   best_eval_score = 0.0185
2024-01-15 03:21:07,747 -   eval_score = 0.0367
2024-01-15 03:21:24,346 - ***** Epoch: 3: Eval results *****
2024-01-15 03:21:24,346 -   train_loss = 2.9667
2024-01-15 03:21:24,346 -   best_eval_score = 0.0367
2024-01-15 03:21:24,346 -   eval_score = 0.0942
2024-01-15 03:21:40,737 - ***** Epoch: 4: Eval results *****
2024-01-15 03:21:40,738 -   train_loss = 2.9241
2024-01-15 03:21:40,738 -   best_eval_score = 0.0942
2024-01-15 03:21:40,738 -   eval_score = 0.097
2024-01-15 03:21:56,960 - ***** Epoch: 5: Eval results *****
2024-01-15 03:21:56,960 -   train_loss = 2.8615
2024-01-15 03:21:56,960 -   best_eval_score = 0.097
2024-01-15 03:21:56,960 -   eval_score = 0.1029
2024-01-15 03:22:13,646 - ***** Epoch: 6: Eval results *****
2024-01-15 03:22:13,646 -   train_loss = 2.7628
2024-01-15 03:22:13,646 -   best_eval_score = 0.1029
2024-01-15 03:22:13,646 -   eval_score = 0.1504
2024-01-15 03:22:30,022 - ***** Epoch: 7: Eval results *****
2024-01-15 03:22:30,023 -   train_loss = 2.5969
2024-01-15 03:22:30,023 -   best_eval_score = 0.1504
2024-01-15 03:22:30,023 -   eval_score = 0.2168
2024-01-15 03:22:46,561 - ***** Epoch: 8: Eval results *****
2024-01-15 03:22:46,561 -   train_loss = 2.306
2024-01-15 03:22:46,561 -   best_eval_score = 0.2168
2024-01-15 03:22:46,561 -   eval_score = 0.266
2024-01-15 03:23:02,877 - ***** Epoch: 9: Eval results *****
2024-01-15 03:23:02,877 -   train_loss = 1.9093
2024-01-15 03:23:02,878 -   best_eval_score = 0.266
2024-01-15 03:23:02,878 -   eval_score = 0.3248
2024-01-15 03:23:19,091 - ***** Epoch: 10: Eval results *****
2024-01-15 03:23:19,092 -   train_loss = 1.5355
2024-01-15 03:23:19,092 -   best_eval_score = 0.3248
2024-01-15 03:23:19,092 -   eval_score = 0.4552
2024-01-15 03:23:35,478 - ***** Epoch: 11: Eval results *****
2024-01-15 03:23:35,478 -   train_loss = 1.2063
2024-01-15 03:23:35,478 -   best_eval_score = 0.4552
2024-01-15 03:23:35,478 -   eval_score = 0.5251
2024-01-15 03:23:51,698 - ***** Epoch: 12: Eval results *****
2024-01-15 03:23:51,698 -   train_loss = 0.9628
2024-01-15 03:23:51,698 -   best_eval_score = 0.5251
2024-01-15 03:23:51,699 -   eval_score = 0.5394
2024-01-15 03:24:07,916 - ***** Epoch: 13: Eval results *****
2024-01-15 03:24:07,916 -   train_loss = 0.7754
2024-01-15 03:24:07,916 -   best_eval_score = 0.5394
2024-01-15 03:24:07,917 -   eval_score = 0.5931
2024-01-15 03:24:24,033 - ***** Epoch: 14: Eval results *****
2024-01-15 03:24:24,033 -   train_loss = 0.628
2024-01-15 03:24:24,033 -   best_eval_score = 0.5931
2024-01-15 03:24:24,033 -   eval_score = 0.6104
2024-01-15 03:24:40,666 - ***** Epoch: 15: Eval results *****
2024-01-15 03:24:40,666 -   train_loss = 0.5087
2024-01-15 03:24:40,666 -   best_eval_score = 0.6104
2024-01-15 03:24:40,666 -   eval_score = 0.61
2024-01-15 03:24:40,666 - EarlyStopping counter: 1 out of 8
2024-01-15 03:24:56,646 - ***** Epoch: 16: Eval results *****
2024-01-15 03:24:56,646 -   train_loss = 0.4273
2024-01-15 03:24:56,646 -   best_eval_score = 0.6104
2024-01-15 03:24:56,646 -   eval_score = 0.6287
2024-01-15 03:25:12,796 - ***** Epoch: 17: Eval results *****
2024-01-15 03:25:12,796 -   train_loss = 0.3572
2024-01-15 03:25:12,796 -   best_eval_score = 0.6287
2024-01-15 03:25:12,796 -   eval_score = 0.6256
2024-01-15 03:25:12,796 - EarlyStopping counter: 1 out of 8
2024-01-15 03:25:29,256 - ***** Epoch: 18: Eval results *****
2024-01-15 03:25:29,256 -   train_loss = 0.2938
2024-01-15 03:25:29,256 -   best_eval_score = 0.6287
2024-01-15 03:25:29,256 -   eval_score = 0.623
2024-01-15 03:25:29,256 - EarlyStopping counter: 2 out of 8
2024-01-15 03:25:45,510 - ***** Epoch: 19: Eval results *****
2024-01-15 03:25:45,510 -   train_loss = 0.2415
2024-01-15 03:25:45,510 -   best_eval_score = 0.6287
2024-01-15 03:25:45,510 -   eval_score = 0.6352
2024-01-15 03:26:02,098 - ***** Epoch: 20: Eval results *****
2024-01-15 03:26:02,099 -   train_loss = 0.2034
2024-01-15 03:26:02,099 -   best_eval_score = 0.6352
2024-01-15 03:26:02,099 -   eval_score = 0.6467
2024-01-15 03:26:18,743 - ***** Epoch: 21: Eval results *****
2024-01-15 03:26:18,743 -   train_loss = 0.1815
2024-01-15 03:26:18,743 -   best_eval_score = 0.6467
2024-01-15 03:26:18,743 -   eval_score = 0.6406
2024-01-15 03:26:18,744 - EarlyStopping counter: 1 out of 8
2024-01-15 03:26:35,247 - ***** Epoch: 22: Eval results *****
2024-01-15 03:26:35,248 -   train_loss = 0.151
2024-01-15 03:26:35,248 -   best_eval_score = 0.6467
2024-01-15 03:26:35,248 -   eval_score = 0.6531
2024-01-15 03:26:51,703 - ***** Epoch: 23: Eval results *****
2024-01-15 03:26:51,703 -   train_loss = 0.1309
2024-01-15 03:26:51,703 -   best_eval_score = 0.6531
2024-01-15 03:26:51,703 -   eval_score = 0.647
2024-01-15 03:26:51,703 - EarlyStopping counter: 1 out of 8
2024-01-15 03:27:08,389 - ***** Epoch: 24: Eval results *****
2024-01-15 03:27:08,389 -   train_loss = 0.1139
2024-01-15 03:27:08,389 -   best_eval_score = 0.6531
2024-01-15 03:27:08,389 -   eval_score = 0.6613
2024-01-15 03:27:25,271 - ***** Epoch: 25: Eval results *****
2024-01-15 03:27:25,272 -   train_loss = 0.0961
2024-01-15 03:27:25,272 -   best_eval_score = 0.6613
2024-01-15 03:27:25,272 -   eval_score = 0.6475
2024-01-15 03:27:25,272 - EarlyStopping counter: 1 out of 8
2024-01-15 03:27:41,669 - ***** Epoch: 26: Eval results *****
2024-01-15 03:27:41,669 -   train_loss = 0.0937
2024-01-15 03:27:41,669 -   best_eval_score = 0.6613
2024-01-15 03:27:41,669 -   eval_score = 0.6528
2024-01-15 03:27:41,669 - EarlyStopping counter: 2 out of 8
2024-01-15 03:27:58,158 - ***** Epoch: 27: Eval results *****
2024-01-15 03:27:58,160 -   train_loss = 0.0776
2024-01-15 03:27:58,160 -   best_eval_score = 0.6613
2024-01-15 03:27:58,160 -   eval_score = 0.6538
2024-01-15 03:27:58,160 - EarlyStopping counter: 3 out of 8
2024-01-15 03:28:14,373 - ***** Epoch: 28: Eval results *****
2024-01-15 03:28:14,373 -   train_loss = 0.0763
2024-01-15 03:28:14,373 -   best_eval_score = 0.6613
2024-01-15 03:28:14,373 -   eval_score = 0.6486
2024-01-15 03:28:14,373 - EarlyStopping counter: 4 out of 8
2024-01-15 03:28:30,845 - ***** Epoch: 29: Eval results *****
2024-01-15 03:28:30,845 -   train_loss = 0.0693
2024-01-15 03:28:30,845 -   best_eval_score = 0.6613
2024-01-15 03:28:30,845 -   eval_score = 0.6583
2024-01-15 03:28:30,846 - EarlyStopping counter: 5 out of 8
2024-01-15 03:28:47,399 - ***** Epoch: 30: Eval results *****
2024-01-15 03:28:47,399 -   train_loss = 0.059
2024-01-15 03:28:47,399 -   best_eval_score = 0.6613
2024-01-15 03:28:47,399 -   eval_score = 0.6512
2024-01-15 03:28:47,399 - EarlyStopping counter: 6 out of 8
2024-01-15 03:29:03,846 - ***** Epoch: 31: Eval results *****
2024-01-15 03:29:03,846 -   train_loss = 0.0496
2024-01-15 03:29:03,846 -   best_eval_score = 0.6613
2024-01-15 03:29:03,846 -   eval_score = 0.6529
2024-01-15 03:29:03,846 - EarlyStopping counter: 7 out of 8
2024-01-15 03:29:20,095 - ***** Epoch: 32: Eval results *****
2024-01-15 03:29:20,095 -   train_loss = 0.0486
2024-01-15 03:29:20,096 -   best_eval_score = 0.6613
2024-01-15 03:29:20,096 -   eval_score = 0.6578
2024-01-15 03:29:20,096 - EarlyStopping counter: 8 out of 8
2024-01-15 03:29:20,096 - EarlyStopping at epoch 32
2024-01-15 03:29:20,098 - Training is finished...
2024-01-15 03:29:20,098 - Testing begins...
2024-01-15 03:29:22,659 - ***** Test: Confusion Matrix *****
2024-01-15 03:29:22,660 - [[36  2  0  0 10  0  0  1  0  2  1  0  3  2  0  0  0  0  0  0]
 [ 0 37  0  1  0  1  0  0  0  0  0  0  2  1  0  0  0  1  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 5  0  0  0 12  0  2  0  0  0  0  1  1  1  0  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  4  0  0  0  3  0  0  0  1  0  1  1  0  0  0  0]
 [ 2  0  0  0  0  1  0  3  1  0  1  0  0  0  0  2  0  0  0  0]
 [ 1  0  0  0  0  0  2  3  2  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  3  1  0  0  0  0  3  0  1  0  0]
 [ 1  0  0  0  0  0  0  0  0  1 14  0  0  0  1  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0  1]
 [ 2  2  0  0  0  1  0  1  0  0  0  1 40  2  3  3  2  0  0  0]
 [ 0  1  0  0  0  0  2  0  0  0  1  1  0 18  2  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0  0  3  1 14  0  1  0  0  2]
 [ 0  0  0  0  0  0  0  1  1  0  0  0  4  0  0 14  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  0 15  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  0  1  2  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  1  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  2  0  2  0  0  4]]
2024-01-15 03:29:22,661 - ***** Evaluation results *****
2024-01-15 03:29:22,661 -   acc = 0.6966
2024-01-15 03:29:22,661 -   f1 = 0.6339
2024-01-15 03:29:22,661 -   prec = 0.6395
2024-01-15 03:29:22,661 -   rec = 0.638
2024-01-15 03:29:22,661 - Testing is finished...
2024-01-15 03:29:22,661 - Multimodal intent recognition is finished...
2024-01-15 03:29:22,661 - Results are saved in results/msz.csv
