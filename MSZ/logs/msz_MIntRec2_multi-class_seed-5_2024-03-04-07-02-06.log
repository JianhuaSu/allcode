2024-03-04 07:02:06,984 - ============================== Params ==============================
2024-03-04 07:02:06,984 - logger_name: msz_MIntRec2_multi-class_seed-5_2024-03-04-07-02-06
2024-03-04 07:02:06,984 - dataset: MIntRec2
2024-03-04 07:02:06,984 - data_mode: multi-class
2024-03-04 07:02:06,984 - method: msz
2024-03-04 07:02:06,984 - text_backbone: bert-base-uncased
2024-03-04 07:02:06,984 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-04 07:02:06,984 - seed: 5
2024-03-04 07:02:06,984 - num_workers: 8
2024-03-04 07:02:06,984 - gpu_id: 3
2024-03-04 07:02:06,984 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-04 07:02:06,984 - train: True
2024-03-04 07:02:06,984 - tune: True
2024-03-04 07:02:06,984 - save_model: False
2024-03-04 07:02:06,984 - save_results: True
2024-03-04 07:02:06,984 - log_path: logs
2024-03-04 07:02:06,984 - cache_path: 
2024-03-04 07:02:06,984 - video_data_path: video_data
2024-03-04 07:02:06,984 - audio_data_path: audio_data
2024-03-04 07:02:06,984 - video_feats_path: video_feats.pkl
2024-03-04 07:02:06,984 - audio_feats_path: audio_feats.pkl
2024-03-04 07:02:06,984 - results_path: results
2024-03-04 07:02:06,984 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-04 07:02:06,985 - model_path: models
2024-03-04 07:02:06,985 - config_file_name: msz_MIntRec2
2024-03-04 07:02:06,985 - results_file_name: msz.csv
2024-03-04 07:02:06,985 - padding_mode: zero
2024-03-04 07:02:06,985 - padding_loc: end
2024-03-04 07:02:06,985 - need_aligned: False
2024-03-04 07:02:06,985 - eval_monitor: f1
2024-03-04 07:02:06,985 - train_batch_size: 16
2024-03-04 07:02:06,985 - eval_batch_size: 8
2024-03-04 07:02:06,985 - test_batch_size: 8
2024-03-04 07:02:06,985 - wait_patience: 8
2024-03-04 07:02:06,985 - hidden_dims: 768
2024-03-04 07:02:06,985 - num_attention_heads: 12
2024-03-04 07:02:06,985 - attention_probs_dropout_prob: 0.2
2024-03-04 07:02:06,985 - hidden_dropout_prob: 0.2
2024-03-04 07:02:06,985 - intermediate_size: 768
2024-03-04 07:02:06,985 - num_hidden_layers: 8
2024-03-04 07:02:06,985 - max_position_embeddings: 768
2024-03-04 07:02:06,985 - position_embedding_type: absolute
2024-03-04 07:02:06,985 - batch_first: True
2024-03-04 07:02:06,985 - dropout: 0.1
2024-03-04 07:02:06,985 - aligned_method: conv1d
2024-03-04 07:02:06,985 - num_train_epochs: 100
2024-03-04 07:02:06,985 - lr: 8e-06
2024-03-04 07:02:06,985 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-5_2024-03-04-07-02-06
2024-03-04 07:02:06,985 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-5_2024-03-04-07-02-06/models
2024-03-04 07:02:06,985 - ============================== End Params ==============================
2024-03-04 07:02:07,299 - Generate Text Features Begin...
2024-03-04 07:02:09,068 - Generate Text Features Finished...
2024-03-04 07:02:09,069 - Load Video Features Begin...
2024-03-04 07:03:23,888 - Load Video Features Finished...
2024-03-04 07:03:25,773 - Load Audio Features Begin...
2024-03-04 07:06:52,902 - Load Audio Features Finished...
2024-03-04 07:07:10,558 - method  begins...
2024-03-04 07:07:18,285 - Multimodal intent recognition begins...
2024-03-04 07:07:18,295 - Training begins...
2024-03-04 07:09:00,997 - ***** Epoch: 1: Eval results *****
2024-03-04 07:09:00,997 -   train_loss = 2.1778
2024-03-04 07:09:00,997 -   best_eval_score = 0.0
2024-03-04 07:09:00,997 -   eval_score = 0.3888
2024-03-04 07:10:41,674 - ***** Epoch: 2: Eval results *****
2024-03-04 07:10:41,682 -   train_loss = 1.3349
2024-03-04 07:10:41,683 -   best_eval_score = 0.3888
2024-03-04 07:10:41,683 -   eval_score = 0.4502
2024-03-04 07:12:24,233 - ***** Epoch: 3: Eval results *****
2024-03-04 07:12:24,242 -   train_loss = 1.0095
2024-03-04 07:12:24,242 -   best_eval_score = 0.4502
2024-03-04 07:12:24,242 -   eval_score = 0.4896
2024-03-04 07:14:04,890 - ***** Epoch: 4: Eval results *****
2024-03-04 07:14:04,890 -   train_loss = 0.7324
2024-03-04 07:14:04,890 -   best_eval_score = 0.4896
2024-03-04 07:14:04,890 -   eval_score = 0.513
2024-03-04 07:15:43,489 - ***** Epoch: 5: Eval results *****
2024-03-04 07:15:43,489 -   train_loss = 0.5159
2024-03-04 07:15:43,489 -   best_eval_score = 0.513
2024-03-04 07:15:43,490 -   eval_score = 0.4977
2024-03-04 07:15:43,490 - EarlyStopping counter: 1 out of 8
2024-03-04 07:17:24,210 - ***** Epoch: 6: Eval results *****
2024-03-04 07:17:24,211 -   train_loss = 0.3415
2024-03-04 07:17:24,211 -   best_eval_score = 0.513
2024-03-04 07:17:24,211 -   eval_score = 0.5194
2024-03-04 07:19:04,894 - ***** Epoch: 7: Eval results *****
2024-03-04 07:19:04,895 -   train_loss = 0.2199
2024-03-04 07:19:04,895 -   best_eval_score = 0.5194
2024-03-04 07:19:04,895 -   eval_score = 0.5088
2024-03-04 07:19:04,895 - EarlyStopping counter: 1 out of 8
2024-03-04 07:20:46,646 - ***** Epoch: 8: Eval results *****
2024-03-04 07:20:46,647 -   train_loss = 0.1538
2024-03-04 07:20:46,647 -   best_eval_score = 0.5194
2024-03-04 07:20:46,647 -   eval_score = 0.5085
2024-03-04 07:20:46,647 - EarlyStopping counter: 2 out of 8
2024-03-04 07:22:28,124 - ***** Epoch: 9: Eval results *****
2024-03-04 07:22:28,125 -   train_loss = 0.1232
2024-03-04 07:22:28,125 -   best_eval_score = 0.5194
2024-03-04 07:22:28,125 -   eval_score = 0.5109
2024-03-04 07:22:28,125 - EarlyStopping counter: 3 out of 8
2024-03-04 07:24:12,031 - ***** Epoch: 10: Eval results *****
2024-03-04 07:24:12,032 -   train_loss = 0.1024
2024-03-04 07:24:12,032 -   best_eval_score = 0.5194
2024-03-04 07:24:12,032 -   eval_score = 0.5125
2024-03-04 07:24:12,032 - EarlyStopping counter: 4 out of 8
2024-03-04 07:25:56,013 - ***** Epoch: 11: Eval results *****
2024-03-04 07:25:56,013 -   train_loss = 0.0649
2024-03-04 07:25:56,014 -   best_eval_score = 0.5194
2024-03-04 07:25:56,014 -   eval_score = 0.5225
2024-03-04 07:27:42,904 - ***** Epoch: 12: Eval results *****
2024-03-04 07:27:42,904 -   train_loss = 0.0552
2024-03-04 07:27:42,904 -   best_eval_score = 0.5225
2024-03-04 07:27:42,904 -   eval_score = 0.5184
2024-03-04 07:27:42,904 - EarlyStopping counter: 1 out of 8
2024-03-04 07:29:27,837 - ***** Epoch: 13: Eval results *****
2024-03-04 07:29:27,837 -   train_loss = 0.0498
2024-03-04 07:29:27,837 -   best_eval_score = 0.5225
2024-03-04 07:29:27,837 -   eval_score = 0.5267
2024-03-04 07:31:07,666 - ***** Epoch: 14: Eval results *****
2024-03-04 07:31:07,675 -   train_loss = 0.0466
2024-03-04 07:31:07,675 -   best_eval_score = 0.5267
2024-03-04 07:31:07,675 -   eval_score = 0.5177
2024-03-04 07:31:07,675 - EarlyStopping counter: 1 out of 8
2024-03-04 07:32:47,247 - ***** Epoch: 15: Eval results *****
2024-03-04 07:32:47,247 -   train_loss = 0.0482
2024-03-04 07:32:47,248 -   best_eval_score = 0.5267
2024-03-04 07:32:47,248 -   eval_score = 0.5218
2024-03-04 07:32:47,248 - EarlyStopping counter: 2 out of 8
2024-03-04 07:34:43,417 - ***** Epoch: 16: Eval results *****
2024-03-04 07:34:43,418 -   train_loss = 0.0434
2024-03-04 07:34:43,418 -   best_eval_score = 0.5267
2024-03-04 07:34:43,418 -   eval_score = 0.5254
2024-03-04 07:34:43,418 - EarlyStopping counter: 3 out of 8
2024-03-04 07:36:23,494 - ***** Epoch: 17: Eval results *****
2024-03-04 07:36:23,495 -   train_loss = 0.0443
2024-03-04 07:36:23,495 -   best_eval_score = 0.5267
2024-03-04 07:36:23,495 -   eval_score = 0.5242
2024-03-04 07:36:23,495 - EarlyStopping counter: 4 out of 8
2024-03-04 07:38:18,700 - ***** Epoch: 18: Eval results *****
2024-03-04 07:38:18,700 -   train_loss = 0.0417
2024-03-04 07:38:18,700 -   best_eval_score = 0.5267
2024-03-04 07:38:18,700 -   eval_score = 0.526
2024-03-04 07:38:18,700 - EarlyStopping counter: 5 out of 8
2024-03-04 07:40:02,298 - ***** Epoch: 19: Eval results *****
2024-03-04 07:40:02,298 -   train_loss = 0.0403
2024-03-04 07:40:02,298 -   best_eval_score = 0.5267
2024-03-04 07:40:02,298 -   eval_score = 0.5178
2024-03-04 07:40:02,298 - EarlyStopping counter: 6 out of 8
2024-03-04 07:41:44,653 - ***** Epoch: 20: Eval results *****
2024-03-04 07:41:44,653 -   train_loss = 0.0369
2024-03-04 07:41:44,653 -   best_eval_score = 0.5267
2024-03-04 07:41:44,653 -   eval_score = 0.5191
2024-03-04 07:41:44,653 - EarlyStopping counter: 7 out of 8
2024-03-04 07:43:43,550 - ***** Epoch: 21: Eval results *****
2024-03-04 07:43:43,550 -   train_loss = 0.0363
2024-03-04 07:43:43,551 -   best_eval_score = 0.5267
2024-03-04 07:43:43,551 -   eval_score = 0.5199
2024-03-04 07:43:43,551 - EarlyStopping counter: 8 out of 8
2024-03-04 07:43:43,551 - EarlyStopping at epoch 21
2024-03-04 07:43:43,554 - Training is finished...
2024-03-04 07:43:43,555 - Testing begins...
2024-03-04 07:43:57,167 - ***** Test: Confusion Matrix *****
2024-03-04 07:43:57,173 - [[ 47   0  15   0   0   0   0   0   0   0   2   0   0   0   2   1   0   0
    0   0   0   0   0   0   1   0   0   0   0   0]
 [  0  53   0   0  10   2   5   0   0   0   0   0   4   0   3   0   0   9
    1   1   2   1   2   0   2   0   0   2   0   0]
 [  9   0  41   0   1   0   0   0   0   0   1   1   0   3   1   0   0   3
    0   0   0   0   0   2   2   0   0   0   0   0]
 [  0   0   0  62   0   0   0   1   0   1   0   0   0   0   0   0   0   1
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   5   0   0  32   0   0   0   0   0   0   0   0   0   0   0   0   4
    0   0   0   3   0   2   1   1   0   0   1   2]
 [  0   1   0   0   2  22   0   0   0   2   0   0   2   0   1   0   0   4
    0   0   0   0   0   2   0   0   1   0   0   0]
 [  0   1   0   0   0   4  26   9   0   2   2   1   3   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   1   0   0   0   0   5  22   0   1   7   0   6   0   0   0   3   0
    0   0   0   0   0   0   0   0   1   1   0   0]
 [  1   3   1   3   1   0   0   0  22   0   0   1   1   1   3   0   0   3
    0   0   0   0   7   0   2   0   0   0   0   0]
 [  0   0   1   1   0   1   0   0   3  49   0   6  10   1  13   2   0   6
    1   0   0   1   3   1   2   1   1   3   0   1]
 [  2   0   0   0   1   3   6   2   0   1  44   0  26   0   2   0   0   1
    0   2   0   0   0   1   1   0   0   1   0   0]
 [  0   0   0   0   0   0   1   0   0   6   1  21   7   0   1   0   0   0
    1   0   0   0   3   0   1   0   0   4   0   1]
 [  0   0   0   0   0   0   6   9   0   5  24   0  85   0   1   0   2   1
    0   0   0   0   0   0   0   0   0   2   0   0]
 [  0   0   2   0   0   0   0   0   0   2   0   0   0   2   6   1   0   2
    2   0   0   0   0   0   0   0   0   0   0   0]
 [  0   2   2   0   0   0   1   0   4   7   1   2   2   3 123   1   0  20
    3   0   1   1  11   1   3   0   0   5   0   0]
 [  0   0   1   0   1   0   0   0   0   5   0   0   0   0   3   5   0   1
    1   0   0   1   1   0   0   0   0   1   1   1]
 [  0   0   0   0   1   0   1   2   0   0   1   0   3   1   0   0  54   0
    2   0   0   0   0   0   1   0   0   0   0   0]
 [  0   5   1   1   5   5   0   0   3  10   2   2   1   1  13   3   0 117
   12   1   1   7   8   9   0   2   1   1   1   5]
 [  0   0   0   0   0   0   0   0   1   5   3   0   0   1   6   1   3  11
   24   1   3   0   0   0   1   0   0   0   0   0]
 [  0   5   0   0   0   0   2   0   0   0   1   0   0   0   0   0   0   0
    0   6   0   3   0   0   0   0   0   0   0   0]
 [  0   1   2   0   2   0   0   0   0   1   1   1   0   0   6   2   0   1
    3   0   5   0   0   1   0   0   0   3   0   0]
 [  5   1   0   0   0   0   0   0   0   3   0   0   0   0   0   0   5   1
    0   0   0  27   1   5   1   0   1   2   0   1]
 [  0   0   1   1   0   0   0   0   2   3   1   2   0   0  11   1   0   4
    0   0   0   1  75   0   0   4   9   2   0   0]
 [  0   2   1   0   1   1   0   0   0   0   0   0   0   0   2   0   0   6
    0   0   1   1   0  23   0   0   0   0   0   0]
 [  2   0   1   0   0   0   0   0   2   1   1   2   0   0   3   0   0   3
    1   0   0   1   1   1  83   0   0  10   1   0]
 [  1   1   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   1
    0   0   0   0   3   0   1  18   2   0   0   3]
 [  0   0   0   1   0   0   0   0   0   1   0   0   0   1   2   0   0   4
    0   0   0   0   1   0   0   0   6   0   1   0]
 [  0   2   1   0   1   0   0   0   3   9   3   4   3   1   3   1   0   5
    0   0   2   0   2   0   7   1   0   9   1   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   1   0
    0   0   0   0   0   0   0   0   0   0  56   0]
 [  0   1   0   0   0   0   0   0   1   2   1   1   0   0   0   0   0   2
    1   0   0   1   0   0   0   1   0   2   0   6]]
2024-03-04 07:43:57,173 - ***** Evaluation results *****
2024-03-04 07:43:57,173 -   acc = 0.573
2024-03-04 07:43:57,174 -   f1 = 0.5214
2024-03-04 07:43:57,174 -   prec = 0.5271
2024-03-04 07:43:57,174 -   rec = 0.5215
2024-03-04 07:43:57,174 - Testing is finished...
2024-03-04 07:43:57,174 - Multimodal intent recognition is finished...
2024-03-04 07:43:57,174 - Results are saved in results/msz.csv
