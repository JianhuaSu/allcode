2024-01-05 06:40:38,082 - ============================== Params ==============================
2024-01-05 06:40:38,082 - logger_name: msz_MIntRec_multi-class_seed-4_2024-01-05-06-40-37
2024-01-05 06:40:38,082 - dataset: MIntRec
2024-01-05 06:40:38,082 - data_mode: multi-class
2024-01-05 06:40:38,082 - method: msz
2024-01-05 06:40:38,082 - text_backbone: bert-base-uncased
2024-01-05 06:40:38,082 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-05 06:40:38,082 - seed: 4
2024-01-05 06:40:38,083 - num_workers: 8
2024-01-05 06:40:38,083 - gpu_id: 1
2024-01-05 06:40:38,083 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-05 06:40:38,083 - train: True
2024-01-05 06:40:38,083 - tune: False
2024-01-05 06:40:38,083 - save_model: False
2024-01-05 06:40:38,083 - save_results: True
2024-01-05 06:40:38,083 - log_path: logs
2024-01-05 06:40:38,083 - cache_path: 
2024-01-05 06:40:38,083 - video_data_path: video_data
2024-01-05 06:40:38,083 - audio_data_path: audio_data
2024-01-05 06:40:38,083 - video_feats_path: video_feats.pkl
2024-01-05 06:40:38,083 - audio_feats_path: audio_feats.pkl
2024-01-05 06:40:38,083 - results_path: results
2024-01-05 06:40:38,083 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-05 06:40:38,083 - model_path: models
2024-01-05 06:40:38,083 - config_file_name: msz
2024-01-05 06:40:38,083 - results_file_name: msz.csv
2024-01-05 06:40:38,083 - padding_mode: zero
2024-01-05 06:40:38,083 - padding_loc: end
2024-01-05 06:40:38,083 - need_aligned: False
2024-01-05 06:40:38,083 - eval_monitor: f1
2024-01-05 06:40:38,083 - train_batch_size: 16
2024-01-05 06:40:38,083 - eval_batch_size: 8
2024-01-05 06:40:38,083 - test_batch_size: 8
2024-01-05 06:40:38,083 - wait_patience: 8
2024-01-05 06:40:38,083 - nheads: 2
2024-01-05 06:40:38,083 - encoder_layers: 2
2024-01-05 06:40:38,083 - attn_dropout: 0.1
2024-01-05 06:40:38,083 - relu_dropout: 0.1
2024-01-05 06:40:38,083 - embed_dropout: 0.1
2024-01-05 06:40:38,083 - res_dropout: 0.1
2024-01-05 06:40:38,083 - attn_mask: False
2024-01-05 06:40:38,083 - hidden_size: 768
2024-01-05 06:40:38,083 - num_attention_heads: 12
2024-01-05 06:40:38,083 - attention_probs_dropout_prob: 0.2
2024-01-05 06:40:38,083 - hidden_dropout_prob: 0.2
2024-01-05 06:40:38,084 - intermediate_size: 768
2024-01-05 06:40:38,084 - num_hidden_layers: 3
2024-01-05 06:40:38,084 - max_position_embeddings: 512
2024-01-05 06:40:38,084 - position_embedding_type: absolute
2024-01-05 06:40:38,084 - batch_first: True
2024-01-05 06:40:38,084 - hidden_dims: 768
2024-01-05 06:40:38,084 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-05 06:40:38,084 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-05 06:40:38,084 - ta_loss: 0.1
2024-01-05 06:40:38,084 - tv_loss: 0.1
2024-01-05 06:40:38,084 - av_loss: 0.1
2024-01-05 06:40:38,084 - aligned_method: conv1d
2024-01-05 06:40:38,084 - grad_clip: -1
2024-01-05 06:40:38,084 - num_train_epochs: 100
2024-01-05 06:40:38,084 - warmup_proportion: 0.1
2024-01-05 06:40:38,084 - lr: 1e-06
2024-01-05 06:40:38,084 - weight_decay: 0.01
2024-01-05 06:40:38,084 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-05-06-40-37
2024-01-05 06:40:38,084 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-05-06-40-37/models
2024-01-05 06:40:38,084 - ============================== End Params ==============================
2024-01-05 06:40:38,087 - Generate Text Features Begin...
2024-01-05 06:40:38,622 - Generate Text Features Finished...
2024-01-05 06:40:38,623 - Load Video Features Begin...
2024-01-05 06:40:38,949 - Load Video Features Finished...
2024-01-05 06:40:39,653 - Load Audio Features Begin...
2024-01-05 06:40:40,818 - Load Audio Features Finished...
2024-01-05 06:40:44,602 - method  begins...
2024-01-05 06:40:48,385 - Multimodal intent recognition begins...
2024-01-05 06:40:48,386 - Training begins...
2024-01-05 06:41:11,773 - ***** Epoch: 1: Eval results *****
2024-01-05 06:41:11,773 -   train_loss = 2.9968
2024-01-05 06:41:11,773 -   best_eval_score = 0.0
2024-01-05 06:41:11,773 -   eval_score = 0.0202
2024-01-05 06:41:33,039 - ***** Epoch: 2: Eval results *****
2024-01-05 06:41:33,039 -   train_loss = 2.9624
2024-01-05 06:41:33,040 -   best_eval_score = 0.0202
2024-01-05 06:41:33,040 -   eval_score = 0.0464
2024-01-05 06:41:53,786 - ***** Epoch: 3: Eval results *****
2024-01-05 06:41:53,786 -   train_loss = 2.8942
2024-01-05 06:41:53,786 -   best_eval_score = 0.0464
2024-01-05 06:41:53,786 -   eval_score = 0.0637
2024-01-05 06:42:14,458 - ***** Epoch: 4: Eval results *****
2024-01-05 06:42:14,458 -   train_loss = 2.7789
2024-01-05 06:42:14,459 -   best_eval_score = 0.0637
2024-01-05 06:42:14,459 -   eval_score = 0.1193
2024-01-05 06:42:35,544 - ***** Epoch: 5: Eval results *****
2024-01-05 06:42:35,544 -   train_loss = 2.6097
2024-01-05 06:42:35,544 -   best_eval_score = 0.1193
2024-01-05 06:42:35,544 -   eval_score = 0.1721
2024-01-05 06:42:56,084 - ***** Epoch: 6: Eval results *****
2024-01-05 06:42:56,086 -   train_loss = 2.3356
2024-01-05 06:42:56,086 -   best_eval_score = 0.1721
2024-01-05 06:42:56,086 -   eval_score = 0.2048
2024-01-05 06:43:16,736 - ***** Epoch: 7: Eval results *****
2024-01-05 06:43:16,736 -   train_loss = 1.9843
2024-01-05 06:43:16,736 -   best_eval_score = 0.2048
2024-01-05 06:43:16,736 -   eval_score = 0.3326
2024-01-05 06:43:37,437 - ***** Epoch: 8: Eval results *****
2024-01-05 06:43:37,437 -   train_loss = 1.5903
2024-01-05 06:43:37,437 -   best_eval_score = 0.3326
2024-01-05 06:43:37,437 -   eval_score = 0.4438
2024-01-05 06:43:57,978 - ***** Epoch: 9: Eval results *****
2024-01-05 06:43:57,978 -   train_loss = 1.2488
2024-01-05 06:43:57,978 -   best_eval_score = 0.4438
2024-01-05 06:43:57,978 -   eval_score = 0.4961
2024-01-05 06:44:18,736 - ***** Epoch: 10: Eval results *****
2024-01-05 06:44:18,737 -   train_loss = 0.9471
2024-01-05 06:44:18,737 -   best_eval_score = 0.4961
2024-01-05 06:44:18,737 -   eval_score = 0.5456
2024-01-05 06:44:39,280 - ***** Epoch: 11: Eval results *****
2024-01-05 06:44:39,281 -   train_loss = 0.6563
2024-01-05 06:44:39,281 -   best_eval_score = 0.5456
2024-01-05 06:44:39,281 -   eval_score = 0.5599
2024-01-05 06:44:59,701 - ***** Epoch: 12: Eval results *****
2024-01-05 06:44:59,702 -   train_loss = 0.5214
2024-01-05 06:44:59,702 -   best_eval_score = 0.5599
2024-01-05 06:44:59,702 -   eval_score = 0.5945
2024-01-05 06:45:20,275 - ***** Epoch: 13: Eval results *****
2024-01-05 06:45:20,275 -   train_loss = 0.3064
2024-01-05 06:45:20,275 -   best_eval_score = 0.5945
2024-01-05 06:45:20,275 -   eval_score = 0.6154
2024-01-05 06:45:41,050 - ***** Epoch: 14: Eval results *****
2024-01-05 06:45:41,051 -   train_loss = 0.1946
2024-01-05 06:45:41,051 -   best_eval_score = 0.6154
2024-01-05 06:45:41,051 -   eval_score = 0.6334
2024-01-05 06:46:01,715 - ***** Epoch: 15: Eval results *****
2024-01-05 06:46:01,715 -   train_loss = 0.1464
2024-01-05 06:46:01,716 -   best_eval_score = 0.6334
2024-01-05 06:46:01,716 -   eval_score = 0.685
2024-01-05 06:46:22,301 - ***** Epoch: 16: Eval results *****
2024-01-05 06:46:22,301 -   train_loss = 0.1002
2024-01-05 06:46:22,301 -   best_eval_score = 0.685
2024-01-05 06:46:22,301 -   eval_score = 0.6582
2024-01-05 06:46:22,302 - EarlyStopping counter: 1 out of 8
2024-01-05 06:46:42,907 - ***** Epoch: 17: Eval results *****
2024-01-05 06:46:42,908 -   train_loss = 0.0794
2024-01-05 06:46:42,908 -   best_eval_score = 0.685
2024-01-05 06:46:42,908 -   eval_score = 0.6448
2024-01-05 06:46:42,908 - EarlyStopping counter: 2 out of 8
2024-01-05 06:47:03,581 - ***** Epoch: 18: Eval results *****
2024-01-05 06:47:03,581 -   train_loss = 0.0518
2024-01-05 06:47:03,581 -   best_eval_score = 0.685
2024-01-05 06:47:03,581 -   eval_score = 0.6436
2024-01-05 06:47:03,581 - EarlyStopping counter: 3 out of 8
2024-01-05 06:47:24,146 - ***** Epoch: 19: Eval results *****
2024-01-05 06:47:24,146 -   train_loss = 0.0473
2024-01-05 06:47:24,146 -   best_eval_score = 0.685
2024-01-05 06:47:24,146 -   eval_score = 0.6509
2024-01-05 06:47:24,146 - EarlyStopping counter: 4 out of 8
2024-01-05 06:47:44,589 - ***** Epoch: 20: Eval results *****
2024-01-05 06:47:44,589 -   train_loss = 0.0341
2024-01-05 06:47:44,589 -   best_eval_score = 0.685
2024-01-05 06:47:44,589 -   eval_score = 0.6457
2024-01-05 06:47:44,589 - EarlyStopping counter: 5 out of 8
2024-01-05 06:48:04,978 - ***** Epoch: 21: Eval results *****
2024-01-05 06:48:04,979 -   train_loss = 0.0257
2024-01-05 06:48:04,979 -   best_eval_score = 0.685
2024-01-05 06:48:04,979 -   eval_score = 0.6321
2024-01-05 06:48:04,979 - EarlyStopping counter: 6 out of 8
2024-01-05 06:48:25,397 - ***** Epoch: 22: Eval results *****
2024-01-05 06:48:25,397 -   train_loss = 0.0189
2024-01-05 06:48:25,397 -   best_eval_score = 0.685
2024-01-05 06:48:25,397 -   eval_score = 0.642
2024-01-05 06:48:25,397 - EarlyStopping counter: 7 out of 8
2024-01-05 06:48:46,101 - ***** Epoch: 23: Eval results *****
2024-01-05 06:48:46,101 -   train_loss = 0.0137
2024-01-05 06:48:46,101 -   best_eval_score = 0.685
2024-01-05 06:48:46,101 -   eval_score = 0.6355
2024-01-05 06:48:46,101 - EarlyStopping counter: 8 out of 8
2024-01-05 06:48:46,102 - EarlyStopping at epoch 23
2024-01-05 06:48:46,103 - Training is finished...
2024-01-05 06:48:46,103 - Testing begins...
2024-01-05 06:48:49,702 - ***** Test: Confusion Matrix *****
2024-01-05 06:48:49,703 - [[37  0  0  0  7  0  1  3  0  2  0  0  4  2  0  0  0  1  0  0]
 [ 0 39  0  1  0  0  0  0  0  0  1  0  1  0  1  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 5  0  0  0 14  0  1  0  0  0  0  0  0  1  1  0  0  1  0  0]
 [ 1  0  0  0  0 10  0  0  0  0  0  0  0  0  0  0  0  1  0  0]
 [ 1  0  0  0  5  0  2  0  2  0  0  0  1  0  0  0  0  0  0  1]
 [ 4  0  0  0  0  0  0  5  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  0  4  1  0  0  0  0  3  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  0  0  0  3  1  0  0  0  0  2  0  2  0  0]
 [ 0  0  0  0  0  0  0  1  0  3 13  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  1  0  1  0  0  0  0 15  0  0  0  0  0  0  1  1]
 [ 3  2  1  1  0  1  0  1  0  0  0  1 28  0 12  0  3  1  1  2]
 [ 0  0  0  0  0  0  1  0  0  0  1  1  0 19  2  0  0  0  0  1]
 [ 0  0  0  0  1  0  0  0  0  0  0  0  0  1 17  0  1  0  0  2]
 [ 0  0  0  0  1  0  0  2  3  0  0  0  3  0  1  9  0  0  1  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  0  0  1  0 15  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0 14  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  9  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  2  0  0  0  0  7]]
2024-01-05 06:48:49,703 - ***** Evaluation results *****
2024-01-05 06:48:49,703 -   acc = 0.6921
2024-01-05 06:48:49,703 -   f1 = 0.6431
2024-01-05 06:48:49,703 -   prec = 0.6478
2024-01-05 06:48:49,703 -   rec = 0.6629
2024-01-05 06:48:49,703 - Testing is finished...
2024-01-05 06:48:49,703 - Multimodal intent recognition is finished...
2024-01-05 06:48:49,703 - Results are saved in results/msz.csv
