2024-01-03 04:47:19,838 - ============================== Params ==============================
2024-01-03 04:47:19,838 - logger_name: msz_MIntRec_multi-class_seed-4_2024-01-03-04-47-19
2024-01-03 04:47:19,838 - dataset: MIntRec
2024-01-03 04:47:19,838 - data_mode: multi-class
2024-01-03 04:47:19,838 - method: msz
2024-01-03 04:47:19,838 - text_backbone: bert-base-uncased
2024-01-03 04:47:19,838 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-03 04:47:19,838 - seed: 4
2024-01-03 04:47:19,838 - num_workers: 8
2024-01-03 04:47:19,838 - gpu_id: 1
2024-01-03 04:47:19,838 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-03 04:47:19,838 - train: True
2024-01-03 04:47:19,838 - tune: False
2024-01-03 04:47:19,838 - save_model: False
2024-01-03 04:47:19,838 - save_results: True
2024-01-03 04:47:19,838 - log_path: logs
2024-01-03 04:47:19,838 - cache_path: 
2024-01-03 04:47:19,838 - video_data_path: video_data
2024-01-03 04:47:19,838 - audio_data_path: audio_data
2024-01-03 04:47:19,839 - video_feats_path: video_feats.pkl
2024-01-03 04:47:19,839 - audio_feats_path: audio_feats.pkl
2024-01-03 04:47:19,839 - results_path: results
2024-01-03 04:47:19,839 - output_path: /home/sujianhua/Outputs/MIntRec
2024-01-03 04:47:19,839 - model_path: models
2024-01-03 04:47:19,839 - config_file_name: msz
2024-01-03 04:47:19,839 - results_file_name: msz.csv
2024-01-03 04:47:19,839 - padding_mode: zero
2024-01-03 04:47:19,839 - padding_loc: end
2024-01-03 04:47:19,839 - need_aligned: False
2024-01-03 04:47:19,839 - eval_monitor: f1
2024-01-03 04:47:19,839 - train_batch_size: 16
2024-01-03 04:47:19,839 - eval_batch_size: 8
2024-01-03 04:47:19,839 - test_batch_size: 8
2024-01-03 04:47:19,839 - wait_patience: 8
2024-01-03 04:47:19,839 - nheads: 2
2024-01-03 04:47:19,839 - encoder_layers: 2
2024-01-03 04:47:19,839 - attn_dropout: 0.1
2024-01-03 04:47:19,839 - relu_dropout: 0.1
2024-01-03 04:47:19,839 - embed_dropout: 0.1
2024-01-03 04:47:19,839 - res_dropout: 0.1
2024-01-03 04:47:19,839 - attn_mask: False
2024-01-03 04:47:19,839 - hidden_size: 768
2024-01-03 04:47:19,839 - num_attention_heads: 12
2024-01-03 04:47:19,839 - attention_probs_dropout_prob: 0.2
2024-01-03 04:47:19,839 - hidden_dropout_prob: 0.2
2024-01-03 04:47:19,839 - intermediate_size: 768
2024-01-03 04:47:19,839 - num_hidden_layers: 3
2024-01-03 04:47:19,839 - max_position_embeddings: 512
2024-01-03 04:47:19,839 - position_embedding_type: absolute
2024-01-03 04:47:19,839 - batch_first: True
2024-01-03 04:47:19,839 - hidden_dims: 768
2024-01-03 04:47:19,839 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-03 04:47:19,839 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-03 04:47:19,839 - ta_loss: 0.07
2024-01-03 04:47:19,839 - tv_loss: 0.02
2024-01-03 04:47:19,839 - av_loss: 0.01
2024-01-03 04:47:19,839 - aligned_method: conv1d
2024-01-03 04:47:19,839 - grad_clip: -1
2024-01-03 04:47:19,840 - num_train_epochs: 100
2024-01-03 04:47:19,840 - warmup_proportion: 0.1
2024-01-03 04:47:19,840 - lr: 1e-06
2024-01-03 04:47:19,840 - weight_decay: 0.02
2024-01-03 04:47:19,840 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-03-04-47-19
2024-01-03 04:47:19,840 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-03-04-47-19/models
2024-01-03 04:47:19,840 - ============================== End Params ==============================
2024-01-03 04:47:19,842 - Generate Text Features Begin...
2024-01-03 04:47:20,334 - Generate Text Features Finished...
2024-01-03 04:47:20,335 - Load Video Features Begin...
2024-01-03 04:47:20,630 - Load Video Features Finished...
2024-01-03 04:47:21,168 - Load Audio Features Begin...
2024-01-03 04:47:22,265 - Load Audio Features Finished...
2024-01-03 04:47:26,264 - method  begins...
2024-01-03 04:47:29,479 - Multimodal intent recognition begins...
2024-01-03 04:47:29,479 - Training begins...
2024-01-03 04:47:54,575 - ***** Epoch: 1: Eval results *****
2024-01-03 04:47:54,575 -   train_loss = 3.5437
2024-01-03 04:47:54,575 -   best_eval_score = 0.0
2024-01-03 04:47:54,575 -   eval_score = 0.0482
2024-01-03 04:48:17,865 - ***** Epoch: 2: Eval results *****
2024-01-03 04:48:17,866 -   train_loss = 3.2653
2024-01-03 04:48:17,866 -   best_eval_score = 0.0482
2024-01-03 04:48:17,866 -   eval_score = 0.0506
2024-01-03 04:48:41,137 - ***** Epoch: 3: Eval results *****
2024-01-03 04:48:41,137 -   train_loss = 3.0316
2024-01-03 04:48:41,137 -   best_eval_score = 0.0506
2024-01-03 04:48:41,137 -   eval_score = 0.1008
2024-01-03 04:49:04,747 - ***** Epoch: 4: Eval results *****
2024-01-03 04:49:04,748 -   train_loss = 2.7895
2024-01-03 04:49:04,748 -   best_eval_score = 0.1008
2024-01-03 04:49:04,748 -   eval_score = 0.1976
2024-01-03 04:49:28,311 - ***** Epoch: 5: Eval results *****
2024-01-03 04:49:28,311 -   train_loss = 2.4609
2024-01-03 04:49:28,311 -   best_eval_score = 0.1976
2024-01-03 04:49:28,311 -   eval_score = 0.2804
2024-01-03 04:49:52,023 - ***** Epoch: 6: Eval results *****
2024-01-03 04:49:52,024 -   train_loss = 2.0664
2024-01-03 04:49:52,024 -   best_eval_score = 0.2804
2024-01-03 04:49:52,024 -   eval_score = 0.3452
2024-01-03 04:50:15,763 - ***** Epoch: 7: Eval results *****
2024-01-03 04:50:15,763 -   train_loss = 1.7139
2024-01-03 04:50:15,763 -   best_eval_score = 0.3452
2024-01-03 04:50:15,763 -   eval_score = 0.5019
2024-01-03 04:50:39,314 - ***** Epoch: 8: Eval results *****
2024-01-03 04:50:39,314 -   train_loss = 1.385
2024-01-03 04:50:39,314 -   best_eval_score = 0.5019
2024-01-03 04:50:39,314 -   eval_score = 0.5311
2024-01-03 04:51:02,994 - ***** Epoch: 9: Eval results *****
2024-01-03 04:51:02,994 -   train_loss = 1.1218
2024-01-03 04:51:02,994 -   best_eval_score = 0.5311
2024-01-03 04:51:02,994 -   eval_score = 0.5401
2024-01-03 04:51:26,026 - ***** Epoch: 10: Eval results *****
2024-01-03 04:51:26,026 -   train_loss = 0.9265
2024-01-03 04:51:26,026 -   best_eval_score = 0.5401
2024-01-03 04:51:26,026 -   eval_score = 0.5686
2024-01-03 04:51:49,373 - ***** Epoch: 11: Eval results *****
2024-01-03 04:51:49,374 -   train_loss = 0.8169
2024-01-03 04:51:49,374 -   best_eval_score = 0.5686
2024-01-03 04:51:49,374 -   eval_score = 0.5816
2024-01-03 04:52:12,197 - ***** Epoch: 12: Eval results *****
2024-01-03 04:52:12,197 -   train_loss = 0.7034
2024-01-03 04:52:12,197 -   best_eval_score = 0.5816
2024-01-03 04:52:12,197 -   eval_score = 0.624
2024-01-03 04:52:34,935 - ***** Epoch: 13: Eval results *****
2024-01-03 04:52:34,938 -   train_loss = 0.613
2024-01-03 04:52:34,938 -   best_eval_score = 0.624
2024-01-03 04:52:34,938 -   eval_score = 0.6091
2024-01-03 04:52:34,938 - EarlyStopping counter: 1 out of 8
2024-01-03 04:52:58,234 - ***** Epoch: 14: Eval results *****
2024-01-03 04:52:58,235 -   train_loss = 0.459
2024-01-03 04:52:58,235 -   best_eval_score = 0.624
2024-01-03 04:52:58,235 -   eval_score = 0.6159
2024-01-03 04:52:58,235 - EarlyStopping counter: 2 out of 8
2024-01-03 04:53:21,077 - ***** Epoch: 15: Eval results *****
2024-01-03 04:53:21,078 -   train_loss = 0.3327
2024-01-03 04:53:21,078 -   best_eval_score = 0.624
2024-01-03 04:53:21,078 -   eval_score = 0.5812
2024-01-03 04:53:21,078 - EarlyStopping counter: 3 out of 8
2024-01-03 04:53:44,172 - ***** Epoch: 16: Eval results *****
2024-01-03 04:53:44,172 -   train_loss = 0.3487
2024-01-03 04:53:44,172 -   best_eval_score = 0.624
2024-01-03 04:53:44,172 -   eval_score = 0.5966
2024-01-03 04:53:44,172 - EarlyStopping counter: 4 out of 8
2024-01-03 04:54:07,222 - ***** Epoch: 17: Eval results *****
2024-01-03 04:54:07,222 -   train_loss = 0.2223
2024-01-03 04:54:07,222 -   best_eval_score = 0.624
2024-01-03 04:54:07,222 -   eval_score = 0.6232
2024-01-03 04:54:07,222 - EarlyStopping counter: 5 out of 8
2024-01-03 04:54:30,309 - ***** Epoch: 18: Eval results *****
2024-01-03 04:54:30,309 -   train_loss = 0.1578
2024-01-03 04:54:30,309 -   best_eval_score = 0.624
2024-01-03 04:54:30,309 -   eval_score = 0.6297
2024-01-03 04:54:53,136 - ***** Epoch: 19: Eval results *****
2024-01-03 04:54:53,136 -   train_loss = 0.1429
2024-01-03 04:54:53,136 -   best_eval_score = 0.6297
2024-01-03 04:54:53,136 -   eval_score = 0.6434
2024-01-03 04:55:15,850 - ***** Epoch: 20: Eval results *****
2024-01-03 04:55:15,851 -   train_loss = 0.1238
2024-01-03 04:55:15,851 -   best_eval_score = 0.6434
2024-01-03 04:55:15,851 -   eval_score = 0.649
2024-01-03 04:55:38,900 - ***** Epoch: 21: Eval results *****
2024-01-03 04:55:38,901 -   train_loss = 0.0847
2024-01-03 04:55:38,901 -   best_eval_score = 0.649
2024-01-03 04:55:38,901 -   eval_score = 0.6395
2024-01-03 04:55:38,901 - EarlyStopping counter: 1 out of 8
2024-01-03 04:56:02,002 - ***** Epoch: 22: Eval results *****
2024-01-03 04:56:02,003 -   train_loss = 0.0708
2024-01-03 04:56:02,003 -   best_eval_score = 0.649
2024-01-03 04:56:02,003 -   eval_score = 0.6398
2024-01-03 04:56:02,003 - EarlyStopping counter: 2 out of 8
2024-01-03 04:56:24,914 - ***** Epoch: 23: Eval results *****
2024-01-03 04:56:24,914 -   train_loss = 0.0544
2024-01-03 04:56:24,914 -   best_eval_score = 0.649
2024-01-03 04:56:24,914 -   eval_score = 0.6443
2024-01-03 04:56:24,914 - EarlyStopping counter: 3 out of 8
2024-01-03 04:56:48,042 - ***** Epoch: 24: Eval results *****
2024-01-03 04:56:48,042 -   train_loss = 0.0489
2024-01-03 04:56:48,042 -   best_eval_score = 0.649
2024-01-03 04:56:48,042 -   eval_score = 0.6428
2024-01-03 04:56:48,042 - EarlyStopping counter: 4 out of 8
2024-01-03 04:57:10,774 - ***** Epoch: 25: Eval results *****
2024-01-03 04:57:10,774 -   train_loss = 0.0434
2024-01-03 04:57:10,774 -   best_eval_score = 0.649
2024-01-03 04:57:10,774 -   eval_score = 0.6403
2024-01-03 04:57:10,774 - EarlyStopping counter: 5 out of 8
2024-01-03 04:57:33,571 - ***** Epoch: 26: Eval results *****
2024-01-03 04:57:33,571 -   train_loss = 0.0387
2024-01-03 04:57:33,571 -   best_eval_score = 0.649
2024-01-03 04:57:33,571 -   eval_score = 0.6461
2024-01-03 04:57:33,571 - EarlyStopping counter: 6 out of 8
2024-01-03 04:57:56,488 - ***** Epoch: 27: Eval results *****
2024-01-03 04:57:56,488 -   train_loss = 0.0377
2024-01-03 04:57:56,488 -   best_eval_score = 0.649
2024-01-03 04:57:56,489 -   eval_score = 0.6528
2024-01-03 04:58:19,591 - ***** Epoch: 28: Eval results *****
2024-01-03 04:58:19,591 -   train_loss = 0.0241
2024-01-03 04:58:19,591 -   best_eval_score = 0.6528
2024-01-03 04:58:19,591 -   eval_score = 0.6383
2024-01-03 04:58:19,591 - EarlyStopping counter: 1 out of 8
2024-01-03 04:58:42,738 - ***** Epoch: 29: Eval results *****
2024-01-03 04:58:42,739 -   train_loss = 0.0197
2024-01-03 04:58:42,739 -   best_eval_score = 0.6528
2024-01-03 04:58:42,739 -   eval_score = 0.6513
2024-01-03 04:58:42,739 - EarlyStopping counter: 2 out of 8
2024-01-03 04:59:06,002 - ***** Epoch: 30: Eval results *****
2024-01-03 04:59:06,002 -   train_loss = 0.0182
2024-01-03 04:59:06,002 -   best_eval_score = 0.6528
2024-01-03 04:59:06,002 -   eval_score = 0.6461
2024-01-03 04:59:06,002 - EarlyStopping counter: 3 out of 8
2024-01-03 04:59:29,122 - ***** Epoch: 31: Eval results *****
2024-01-03 04:59:29,123 -   train_loss = 0.0158
2024-01-03 04:59:29,123 -   best_eval_score = 0.6528
2024-01-03 04:59:29,123 -   eval_score = 0.6417
2024-01-03 04:59:29,123 - EarlyStopping counter: 4 out of 8
2024-01-03 04:59:52,605 - ***** Epoch: 32: Eval results *****
2024-01-03 04:59:52,606 -   train_loss = 0.0133
2024-01-03 04:59:52,606 -   best_eval_score = 0.6528
2024-01-03 04:59:52,606 -   eval_score = 0.6318
2024-01-03 04:59:52,606 - EarlyStopping counter: 5 out of 8
2024-01-03 05:00:16,043 - ***** Epoch: 33: Eval results *****
2024-01-03 05:00:16,043 -   train_loss = 0.0158
2024-01-03 05:00:16,043 -   best_eval_score = 0.6528
2024-01-03 05:00:16,043 -   eval_score = 0.6209
2024-01-03 05:00:16,043 - EarlyStopping counter: 6 out of 8
2024-01-03 05:00:38,997 - ***** Epoch: 34: Eval results *****
2024-01-03 05:00:38,997 -   train_loss = 0.0127
2024-01-03 05:00:38,997 -   best_eval_score = 0.6528
2024-01-03 05:00:38,997 -   eval_score = 0.6201
2024-01-03 05:00:38,997 - EarlyStopping counter: 7 out of 8
2024-01-03 05:01:02,185 - ***** Epoch: 35: Eval results *****
2024-01-03 05:01:02,185 -   train_loss = 0.0183
2024-01-03 05:01:02,185 -   best_eval_score = 0.6528
2024-01-03 05:01:02,185 -   eval_score = 0.6246
2024-01-03 05:01:02,185 - EarlyStopping counter: 8 out of 8
2024-01-03 05:01:02,185 - EarlyStopping at epoch 35
2024-01-03 05:01:02,187 - Training is finished...
2024-01-03 05:01:02,187 - Testing begins...
2024-01-03 05:01:06,520 - ***** Test: Confusion Matrix *****
2024-01-03 05:01:06,521 - [[27  0  0  0  9  1  5  1  1  2  1  0  8  0  0  2  0  0  0  0]
 [ 0 36  0  1  0  0  2  1  0  0  0  0  1  1  0  1  0  0  0  0]
 [ 0  0 27  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0 14  0  4  0  0  0  0  1  2  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 10  0  0  0  1  0  0  1  0  0  0  0  0  0  0]
 [ 0  0  0  0  3  0  4  0  2  0  0  1  1  0  0  1  0  0  0  0]
 [ 2  0  0  0  0  0  1  4  1  1  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  2  4  0  0  0  0  1  0  2  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  3  1  0  0  0  0  3  0  1  0  0]
 [ 1  0  0  0  0  0  4  0  0  1 11  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0  1]
 [ 2  0  0  0  0  0  2  2  1  0  0  1 44  0  1  4  0  0  0  0]
 [ 0  0  0  0  1  1  3  0  0  0  1  1  4 12  1  1  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0  0  4  1 15  0  0  0  0  1]
 [ 0  0  0  0  1  0  0  0  1  0  0  0  1  0  1 17  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  3  0  3  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  2  0  0  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  4  0  0  1  0  0  7  0]
 [ 0  0  0  0  0  0  1  0  0  0  0  0  2  0  2  0  0  0  0  5]]
2024-01-03 05:01:06,521 - ***** Evaluation results *****
2024-01-03 05:01:06,521 -   acc = 0.6854
2024-01-03 05:01:06,521 -   f1 = 0.6575
2024-01-03 05:01:06,521 -   prec = 0.6983
2024-01-03 05:01:06,521 -   rec = 0.648
2024-01-03 05:01:06,521 - Testing is finished...
2024-01-03 05:01:06,521 - Multimodal intent recognition is finished...
2024-01-03 05:01:06,521 - Results are saved in results/msz.csv
