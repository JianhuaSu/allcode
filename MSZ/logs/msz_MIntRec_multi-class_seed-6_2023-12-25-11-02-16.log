2023-12-25 11:02:16,357 - ============================== Params ==============================
2023-12-25 11:02:16,357 - logger_name: msz_MIntRec_multi-class_seed-6_2023-12-25-11-02-16
2023-12-25 11:02:16,357 - dataset: MIntRec
2023-12-25 11:02:16,357 - data_mode: multi-class
2023-12-25 11:02:16,357 - method: msz
2023-12-25 11:02:16,357 - text_backbone: bert-base-uncased
2023-12-25 11:02:16,357 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-25 11:02:16,357 - seed: 6
2023-12-25 11:02:16,357 - num_workers: 8
2023-12-25 11:02:16,357 - gpu_id: 0
2023-12-25 11:02:16,357 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-25 11:02:16,358 - train: True
2023-12-25 11:02:16,358 - tune: False
2023-12-25 11:02:16,358 - save_model: False
2023-12-25 11:02:16,358 - save_results: True
2023-12-25 11:02:16,358 - log_path: logs
2023-12-25 11:02:16,358 - cache_path: 
2023-12-25 11:02:16,358 - video_data_path: video_data
2023-12-25 11:02:16,358 - audio_data_path: audio_data
2023-12-25 11:02:16,358 - video_feats_path: video_feats.pkl
2023-12-25 11:02:16,358 - audio_feats_path: audio_feats.pkl
2023-12-25 11:02:16,358 - results_path: results
2023-12-25 11:02:16,358 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-25 11:02:16,358 - model_path: models
2023-12-25 11:02:16,358 - config_file_name: msz
2023-12-25 11:02:16,358 - results_file_name: msz.csv
2023-12-25 11:02:16,358 - padding_mode: zero
2023-12-25 11:02:16,358 - padding_loc: end
2023-12-25 11:02:16,358 - need_aligned: False
2023-12-25 11:02:16,358 - eval_monitor: f1
2023-12-25 11:02:16,358 - train_batch_size: 16
2023-12-25 11:02:16,358 - eval_batch_size: 8
2023-12-25 11:02:16,358 - test_batch_size: 8
2023-12-25 11:02:16,358 - wait_patience: 8
2023-12-25 11:02:16,358 - nheads: 2
2023-12-25 11:02:16,358 - encoder_layers: 2
2023-12-25 11:02:16,358 - attn_dropout: 0.1
2023-12-25 11:02:16,358 - relu_dropout: 0.1
2023-12-25 11:02:16,358 - embed_dropout: 0.1
2023-12-25 11:02:16,358 - res_dropout: 0.1
2023-12-25 11:02:16,358 - attn_mask: False
2023-12-25 11:02:16,358 - hidden_size: 768
2023-12-25 11:02:16,358 - num_attention_heads: 12
2023-12-25 11:02:16,358 - attention_probs_dropout_prob: 0.2
2023-12-25 11:02:16,359 - hidden_dropout_prob: 0.2
2023-12-25 11:02:16,359 - intermediate_size: 768
2023-12-25 11:02:16,359 - num_hidden_layers: 3
2023-12-25 11:02:16,359 - max_position_embeddings: 512
2023-12-25 11:02:16,359 - position_embedding_type: absolute
2023-12-25 11:02:16,359 - add_cross_attention: False
2023-12-25 11:02:16,359 - batch_first: True
2023-12-25 11:02:16,359 - hidden_dims: 768
2023-12-25 11:02:16,359 - att_dropouts: [0.1, 0.1, 0.1]
2023-12-25 11:02:16,359 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-25 11:02:16,359 - sl: 0.1
2023-12-25 11:02:16,359 - cl: 0.1
2023-12-25 11:02:16,359 - num_train_epochs: 100
2023-12-25 11:02:16,359 - warmup_proportion: 0.1
2023-12-25 11:02:16,359 - lr: 5e-06
2023-12-25 11:02:16,359 - weight_decay: 0.01
2023-12-25 11:02:16,359 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-6_2023-12-25-11-02-16
2023-12-25 11:02:16,359 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-6_2023-12-25-11-02-16/models
2023-12-25 11:02:16,359 - ============================== End Params ==============================
2023-12-25 11:02:17,501 - Generate Text Features Begin...
2023-12-25 11:02:20,474 - Generate Text Features Finished...
2023-12-25 11:02:20,474 - Load Video Features Begin...
2023-12-25 11:02:33,692 - Load Video Features Finished...
2023-12-25 11:02:34,390 - Load Audio Features Begin...
2023-12-25 11:03:14,325 - Load Audio Features Finished...
2023-12-25 11:03:18,293 - method  begins...
2023-12-25 11:03:34,237 - Multimodal intent recognition begins...
2023-12-25 11:03:34,237 - Training begins...
2023-12-25 11:03:55,074 - ***** Epoch: 1: Eval results *****
2023-12-25 11:03:55,075 -   train_loss = 2.9492
2023-12-25 11:03:55,076 -   best_eval_score = 0.0
2023-12-25 11:03:55,076 -   eval_score = 0.0131
2023-12-25 11:04:14,592 - ***** Epoch: 2: Eval results *****
2023-12-25 11:04:14,594 -   train_loss = 2.7804
2023-12-25 11:04:14,595 -   best_eval_score = 0.0131
2023-12-25 11:04:14,595 -   eval_score = 0.0392
2023-12-25 11:04:34,664 - ***** Epoch: 3: Eval results *****
2023-12-25 11:04:34,666 -   train_loss = 2.5309
2023-12-25 11:04:34,667 -   best_eval_score = 0.0392
2023-12-25 11:04:34,667 -   eval_score = 0.1628
2023-12-25 11:04:55,671 - ***** Epoch: 4: Eval results *****
2023-12-25 11:04:55,672 -   train_loss = 2.2226
2023-12-25 11:04:55,672 -   best_eval_score = 0.1628
2023-12-25 11:04:55,672 -   eval_score = 0.189
2023-12-25 11:05:18,937 - ***** Epoch: 5: Eval results *****
2023-12-25 11:05:18,937 -   train_loss = 1.9446
2023-12-25 11:05:18,937 -   best_eval_score = 0.189
2023-12-25 11:05:18,937 -   eval_score = 0.2446
2023-12-25 11:05:39,282 - ***** Epoch: 6: Eval results *****
2023-12-25 11:05:39,282 -   train_loss = 1.5843
2023-12-25 11:05:39,282 -   best_eval_score = 0.2446
2023-12-25 11:05:39,282 -   eval_score = 0.4213
2023-12-25 11:05:58,985 - ***** Epoch: 7: Eval results *****
2023-12-25 11:05:58,985 -   train_loss = 1.3445
2023-12-25 11:05:58,986 -   best_eval_score = 0.4213
2023-12-25 11:05:58,986 -   eval_score = 0.4481
2023-12-25 11:06:19,253 - ***** Epoch: 8: Eval results *****
2023-12-25 11:06:19,254 -   train_loss = 1.1176
2023-12-25 11:06:19,254 -   best_eval_score = 0.4481
2023-12-25 11:06:19,254 -   eval_score = 0.4724
2023-12-25 11:06:39,841 - ***** Epoch: 9: Eval results *****
2023-12-25 11:06:39,841 -   train_loss = 1.3098
2023-12-25 11:06:39,842 -   best_eval_score = 0.4724
2023-12-25 11:06:39,842 -   eval_score = 0.4334
2023-12-25 11:06:39,842 - EarlyStopping counter: 1 out of 8
2023-12-25 11:07:27,343 - ***** Epoch: 10: Eval results *****
2023-12-25 11:07:27,344 -   train_loss = 1.2669
2023-12-25 11:07:27,344 -   best_eval_score = 0.4724
2023-12-25 11:07:27,344 -   eval_score = 0.4602
2023-12-25 11:07:27,344 - EarlyStopping counter: 2 out of 8
2023-12-25 11:09:18,487 - ***** Epoch: 11: Eval results *****
2023-12-25 11:09:18,487 -   train_loss = 1.1881
2023-12-25 11:09:18,487 -   best_eval_score = 0.4724
2023-12-25 11:09:18,488 -   eval_score = 0.4729
2023-12-25 11:09:38,796 - ***** Epoch: 12: Eval results *****
2023-12-25 11:09:38,797 -   train_loss = 1.1571
2023-12-25 11:09:38,798 -   best_eval_score = 0.4729
2023-12-25 11:09:38,798 -   eval_score = 0.4177
2023-12-25 11:09:38,798 - EarlyStopping counter: 1 out of 8
2023-12-25 11:10:04,914 - ***** Epoch: 13: Eval results *****
2023-12-25 11:10:04,915 -   train_loss = 1.107
2023-12-25 11:10:04,916 -   best_eval_score = 0.4729
2023-12-25 11:10:04,916 -   eval_score = 0.453
2023-12-25 11:10:04,917 - EarlyStopping counter: 2 out of 8
2023-12-25 11:10:30,071 - ***** Epoch: 14: Eval results *****
2023-12-25 11:10:30,072 -   train_loss = 1.0908
2023-12-25 11:10:30,073 -   best_eval_score = 0.4729
2023-12-25 11:10:30,073 -   eval_score = 0.442
2023-12-25 11:10:30,073 - EarlyStopping counter: 3 out of 8
2023-12-25 11:11:00,376 - ***** Epoch: 15: Eval results *****
2023-12-25 11:11:00,377 -   train_loss = 1.0565
2023-12-25 11:11:00,377 -   best_eval_score = 0.4729
2023-12-25 11:11:00,377 -   eval_score = 0.4443
2023-12-25 11:11:00,377 - EarlyStopping counter: 4 out of 8
2023-12-25 11:11:27,822 - ***** Epoch: 16: Eval results *****
2023-12-25 11:11:27,823 -   train_loss = 0.9744
2023-12-25 11:11:27,824 -   best_eval_score = 0.4729
2023-12-25 11:11:27,824 -   eval_score = 0.4257
2023-12-25 11:11:27,824 - EarlyStopping counter: 5 out of 8
2023-12-25 11:11:51,242 - ***** Epoch: 17: Eval results *****
2023-12-25 11:11:51,247 -   train_loss = 1.0167
2023-12-25 11:11:51,247 -   best_eval_score = 0.4729
2023-12-25 11:11:51,247 -   eval_score = 0.393
2023-12-25 11:11:51,247 - EarlyStopping counter: 6 out of 8
2023-12-25 11:12:15,788 - ***** Epoch: 18: Eval results *****
2023-12-25 11:12:15,789 -   train_loss = 1.3262
2023-12-25 11:12:15,789 -   best_eval_score = 0.4729
2023-12-25 11:12:15,789 -   eval_score = 0.4584
2023-12-25 11:12:15,789 - EarlyStopping counter: 7 out of 8
2023-12-25 11:12:35,911 - ***** Epoch: 19: Eval results *****
2023-12-25 11:12:35,912 -   train_loss = 1.032
2023-12-25 11:12:35,912 -   best_eval_score = 0.4729
2023-12-25 11:12:35,912 -   eval_score = 0.4219
2023-12-25 11:12:35,912 - EarlyStopping counter: 8 out of 8
2023-12-25 11:12:35,912 - EarlyStopping at epoch 19
2023-12-25 11:12:35,943 - Training is finished...
2023-12-25 11:12:35,943 - Testing begins...
2023-12-25 11:12:55,616 - ***** Test: Confusion Matrix *****
2023-12-25 11:12:55,642 - [[37  2  0  0  6  0  0  0  0  1  0  2  1  0  2  3  0  0  0  3]
 [ 0 40  0  0  1  0  0  0  0  0  0  0  1  0  0  0  0  0  0  1]
 [ 3  0 23  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0]
 [ 0  0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1]
 [10  1  0  0  8  0  0  0  0  0  0  1  0  0  1  0  0  0  0  2]
 [ 0  0  0  0  1  9  0  0  0  0  0  0  0  0  1  0  0  0  1  0]
 [ 4  0  0  0  3  0  0  0  0  0  1  2  0  0  1  0  0  0  0  1]
 [ 5  3  0  0  0  1  0  0  0  0  0  0  0  1  0  0  0  0  0  0]
 [ 3  2  0  0  1  0  0  0  0  0  0  0  0  2  0  1  0  0  0  1]
 [ 3  1  0  0  1  0  0  0  0  1  0  0  0  0  0  3  0  1  0  0]
 [ 1  1  0  0  1  5  0  0  0  1  7  0  0  0  1  0  1  0  0  0]
 [ 1  1  0  0  0  0  0  0  0  0  0 17  0  0  0  0  0  0  0  0]
 [14  6  0  1  7  0  0  0  0  0  0  2  6  2  6  4  2  0  0  7]
 [ 3  2  0  0  2  0  0  0  0  0  0  1  0 11  0  0  0  0  0  6]
 [ 1  0  1  0  1  0  0  0  0  0  0  0  0  1  9  0  2  0  0  7]
 [ 2  3  0  1  1  0  0  0  0  0  0  0  2  0  0 12  0  0  0  0]
 [ 1  1  0  0  0  0  0  1  0  0  0  0  0  1  1  1 10  0  0  1]
 [ 2  0  0  0  3  0  0  0  0  1  1  0  0  0  1  0  0  7  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  2  0  1  1  0  0  7  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  5  0  0  0  0  0  3]]
2023-12-25 11:12:55,643 - ***** Evaluation results *****
2023-12-25 11:12:55,643 -   acc = 0.5191
2023-12-25 11:12:55,643 -   f1 = 0.4516
2023-12-25 11:12:55,643 -   prec = 0.4848
2023-12-25 11:12:55,643 -   rec = 0.4668
2023-12-25 11:12:55,643 - Testing is finished...
2023-12-25 11:12:55,643 - Multimodal intent recognition is finished...
2023-12-25 11:12:55,643 - Results are saved in results/msz.csv
