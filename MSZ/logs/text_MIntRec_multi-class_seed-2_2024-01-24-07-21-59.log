2024-01-24 07:21:59,751 - ============================== Params ==============================
2024-01-24 07:21:59,751 - logger_name: text_MIntRec_multi-class_seed-2_2024-01-24-07-21-59
2024-01-24 07:21:59,751 - dataset: MIntRec
2024-01-24 07:21:59,751 - data_mode: multi-class
2024-01-24 07:21:59,751 - method: text
2024-01-24 07:21:59,751 - text_backbone: bert-base-uncased
2024-01-24 07:21:59,751 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-24 07:21:59,751 - seed: 2
2024-01-24 07:21:59,751 - num_workers: 8
2024-01-24 07:21:59,751 - gpu_id: 0
2024-01-24 07:21:59,751 - data_path: /home/sharing/Datasets
2024-01-24 07:21:59,751 - train: True
2024-01-24 07:21:59,751 - tune: False
2024-01-24 07:21:59,752 - save_model: False
2024-01-24 07:21:59,752 - save_results: True
2024-01-24 07:21:59,752 - log_path: logs
2024-01-24 07:21:59,752 - cache_path: 
2024-01-24 07:21:59,752 - video_data_path: video_data
2024-01-24 07:21:59,752 - audio_data_path: audio_data
2024-01-24 07:21:59,752 - video_feats_path: video_feats.pkl
2024-01-24 07:21:59,752 - audio_feats_path: audio_feats.pkl
2024-01-24 07:21:59,752 - results_path: results
2024-01-24 07:21:59,752 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-24 07:21:59,752 - model_path: models
2024-01-24 07:21:59,752 - config_file_name: text_bert
2024-01-24 07:21:59,752 - results_file_name: text_bert.csv
2024-01-24 07:21:59,752 - padding_mode: zero
2024-01-24 07:21:59,752 - padding_loc: end
2024-01-24 07:21:59,752 - eval_monitor: f1
2024-01-24 07:21:59,752 - train_batch_size: 16
2024-01-24 07:21:59,752 - eval_batch_size: 8
2024-01-24 07:21:59,752 - test_batch_size: 8
2024-01-24 07:21:59,752 - wait_patience: 8
2024-01-24 07:21:59,752 - num_train_epochs: 100
2024-01-24 07:21:59,752 - warmup_proportion: 0.1
2024-01-24 07:21:59,752 - lr: 2e-05
2024-01-24 07:21:59,752 - weight_decay: 0.1
2024-01-24 07:21:59,752 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/text_MIntRec_multi-class_seed-2_2024-01-24-07-21-59
2024-01-24 07:21:59,752 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/text_MIntRec_multi-class_seed-2_2024-01-24-07-21-59/models
2024-01-24 07:21:59,752 - ============================== End Params ==============================
2024-01-24 07:21:59,754 - Generate Text Features Begin...
2024-01-24 07:22:00,154 - Generate Text Features Finished...
2024-01-24 07:22:00,155 - Load Video Features Begin...
2024-01-24 07:22:00,419 - Load Video Features Finished...
2024-01-24 07:22:00,918 - Load Audio Features Begin...
2024-01-24 07:22:01,770 - Load Audio Features Finished...
2024-01-24 07:22:05,311 - method  begins...
2024-01-24 07:22:07,163 - text_data loading complete...
2024-01-24 07:22:07,163 - Multimodal intent recognition begins...
2024-01-24 07:22:07,163 - Training begins...
2024-01-24 07:22:15,712 - ***** Epoch: 1: Eval results *****
2024-01-24 07:22:15,712 -   train_loss = 2.9604
2024-01-24 07:22:15,712 -   best_eval_score = 0.0
2024-01-24 07:22:15,712 -   eval_score = 0.0291
2024-01-24 07:22:22,845 - ***** Epoch: 2: Eval results *****
2024-01-24 07:22:22,845 -   train_loss = 2.6381
2024-01-24 07:22:22,845 -   best_eval_score = 0.0291
2024-01-24 07:22:22,845 -   eval_score = 0.2387
2024-01-24 07:22:30,865 - ***** Epoch: 3: Eval results *****
2024-01-24 07:22:30,865 -   train_loss = 2.1455
2024-01-24 07:22:30,866 -   best_eval_score = 0.2387
2024-01-24 07:22:30,866 -   eval_score = 0.3295
2024-01-24 07:22:38,986 - ***** Epoch: 4: Eval results *****
2024-01-24 07:22:38,986 -   train_loss = 1.6143
2024-01-24 07:22:38,986 -   best_eval_score = 0.3295
2024-01-24 07:22:38,986 -   eval_score = 0.4879
2024-01-24 07:22:47,186 - ***** Epoch: 5: Eval results *****
2024-01-24 07:22:47,186 -   train_loss = 1.177
2024-01-24 07:22:47,186 -   best_eval_score = 0.4879
2024-01-24 07:22:47,186 -   eval_score = 0.5771
2024-01-24 07:22:55,419 - ***** Epoch: 6: Eval results *****
2024-01-24 07:22:55,419 -   train_loss = 0.8183
2024-01-24 07:22:55,419 -   best_eval_score = 0.5771
2024-01-24 07:22:55,419 -   eval_score = 0.6064
2024-01-24 07:23:03,418 - ***** Epoch: 7: Eval results *****
2024-01-24 07:23:03,419 -   train_loss = 0.5408
2024-01-24 07:23:03,419 -   best_eval_score = 0.6064
2024-01-24 07:23:03,419 -   eval_score = 0.6188
2024-01-24 07:23:11,388 - ***** Epoch: 8: Eval results *****
2024-01-24 07:23:11,389 -   train_loss = 0.3518
2024-01-24 07:23:11,389 -   best_eval_score = 0.6188
2024-01-24 07:23:11,389 -   eval_score = 0.664
2024-01-24 07:23:19,626 - ***** Epoch: 9: Eval results *****
2024-01-24 07:23:19,626 -   train_loss = 0.2409
2024-01-24 07:23:19,626 -   best_eval_score = 0.664
2024-01-24 07:23:19,626 -   eval_score = 0.6651
2024-01-24 07:23:28,303 - ***** Epoch: 10: Eval results *****
2024-01-24 07:23:28,303 -   train_loss = 0.1543
2024-01-24 07:23:28,303 -   best_eval_score = 0.6651
2024-01-24 07:23:28,303 -   eval_score = 0.6686
2024-01-24 07:23:36,214 - ***** Epoch: 11: Eval results *****
2024-01-24 07:23:36,214 -   train_loss = 0.1018
2024-01-24 07:23:36,214 -   best_eval_score = 0.6686
2024-01-24 07:23:36,214 -   eval_score = 0.6674
2024-01-24 07:23:36,214 - EarlyStopping counter: 1 out of 8
2024-01-24 07:23:44,342 - ***** Epoch: 12: Eval results *****
2024-01-24 07:23:44,342 -   train_loss = 0.0732
2024-01-24 07:23:44,342 -   best_eval_score = 0.6686
2024-01-24 07:23:44,343 -   eval_score = 0.6806
2024-01-24 07:23:52,436 - ***** Epoch: 13: Eval results *****
2024-01-24 07:23:52,436 -   train_loss = 0.0486
2024-01-24 07:23:52,436 -   best_eval_score = 0.6806
2024-01-24 07:23:52,436 -   eval_score = 0.6835
2024-01-24 07:24:00,511 - ***** Epoch: 14: Eval results *****
2024-01-24 07:24:00,511 -   train_loss = 0.0374
2024-01-24 07:24:00,512 -   best_eval_score = 0.6835
2024-01-24 07:24:00,512 -   eval_score = 0.672
2024-01-24 07:24:00,512 - EarlyStopping counter: 1 out of 8
2024-01-24 07:24:08,608 - ***** Epoch: 15: Eval results *****
2024-01-24 07:24:08,608 -   train_loss = 0.0299
2024-01-24 07:24:08,608 -   best_eval_score = 0.6835
2024-01-24 07:24:08,608 -   eval_score = 0.6853
2024-01-24 07:24:16,898 - ***** Epoch: 16: Eval results *****
2024-01-24 07:24:16,898 -   train_loss = 0.0257
2024-01-24 07:24:16,899 -   best_eval_score = 0.6853
2024-01-24 07:24:16,899 -   eval_score = 0.6846
2024-01-24 07:24:16,899 - EarlyStopping counter: 1 out of 8
2024-01-24 07:24:24,915 - ***** Epoch: 17: Eval results *****
2024-01-24 07:24:24,915 -   train_loss = 0.0221
2024-01-24 07:24:24,916 -   best_eval_score = 0.6853
2024-01-24 07:24:24,916 -   eval_score = 0.6814
2024-01-24 07:24:24,916 - EarlyStopping counter: 2 out of 8
2024-01-24 07:24:33,461 - ***** Epoch: 18: Eval results *****
2024-01-24 07:24:33,465 -   train_loss = 0.0199
2024-01-24 07:24:33,465 -   best_eval_score = 0.6853
2024-01-24 07:24:33,465 -   eval_score = 0.6832
2024-01-24 07:24:33,465 - EarlyStopping counter: 3 out of 8
2024-01-24 07:24:41,631 - ***** Epoch: 19: Eval results *****
2024-01-24 07:24:41,631 -   train_loss = 0.0177
2024-01-24 07:24:41,631 -   best_eval_score = 0.6853
2024-01-24 07:24:41,631 -   eval_score = 0.6781
2024-01-24 07:24:41,631 - EarlyStopping counter: 4 out of 8
2024-01-24 07:24:49,798 - ***** Epoch: 20: Eval results *****
2024-01-24 07:24:49,798 -   train_loss = 0.016
2024-01-24 07:24:49,798 -   best_eval_score = 0.6853
2024-01-24 07:24:49,798 -   eval_score = 0.6871
2024-01-24 07:24:57,787 - ***** Epoch: 21: Eval results *****
2024-01-24 07:24:57,787 -   train_loss = 0.0144
2024-01-24 07:24:57,787 -   best_eval_score = 0.6871
2024-01-24 07:24:57,787 -   eval_score = 0.6845
2024-01-24 07:24:57,787 - EarlyStopping counter: 1 out of 8
2024-01-24 07:25:05,422 - ***** Epoch: 22: Eval results *****
2024-01-24 07:25:05,422 -   train_loss = 0.0133
2024-01-24 07:25:05,422 -   best_eval_score = 0.6871
2024-01-24 07:25:05,423 -   eval_score = 0.6854
2024-01-24 07:25:05,423 - EarlyStopping counter: 2 out of 8
2024-01-24 07:25:13,941 - ***** Epoch: 23: Eval results *****
2024-01-24 07:25:13,941 -   train_loss = 0.012
2024-01-24 07:25:13,941 -   best_eval_score = 0.6871
2024-01-24 07:25:13,941 -   eval_score = 0.6871
2024-01-24 07:25:13,941 - EarlyStopping counter: 3 out of 8
2024-01-24 07:25:22,410 - ***** Epoch: 24: Eval results *****
2024-01-24 07:25:22,410 -   train_loss = 0.0112
2024-01-24 07:25:22,410 -   best_eval_score = 0.6871
2024-01-24 07:25:22,410 -   eval_score = 0.682
2024-01-24 07:25:22,410 - EarlyStopping counter: 4 out of 8
2024-01-24 07:25:29,162 - ***** Epoch: 25: Eval results *****
2024-01-24 07:25:29,162 -   train_loss = 0.0104
2024-01-24 07:25:29,162 -   best_eval_score = 0.6871
2024-01-24 07:25:29,162 -   eval_score = 0.6789
2024-01-24 07:25:29,162 - EarlyStopping counter: 5 out of 8
2024-01-24 07:25:37,326 - ***** Epoch: 26: Eval results *****
2024-01-24 07:25:37,326 -   train_loss = 0.0098
2024-01-24 07:25:37,326 -   best_eval_score = 0.6871
2024-01-24 07:25:37,326 -   eval_score = 0.6689
2024-01-24 07:25:37,327 - EarlyStopping counter: 6 out of 8
2024-01-24 07:25:45,455 - ***** Epoch: 27: Eval results *****
2024-01-24 07:25:45,455 -   train_loss = 0.0091
2024-01-24 07:25:45,455 -   best_eval_score = 0.6871
2024-01-24 07:25:45,455 -   eval_score = 0.6731
2024-01-24 07:25:45,455 - EarlyStopping counter: 7 out of 8
2024-01-24 07:25:53,353 - ***** Epoch: 28: Eval results *****
2024-01-24 07:25:53,354 -   train_loss = 0.0086
2024-01-24 07:25:53,354 -   best_eval_score = 0.6871
2024-01-24 07:25:53,354 -   eval_score = 0.688
2024-01-24 07:26:01,566 - ***** Epoch: 29: Eval results *****
2024-01-24 07:26:01,566 -   train_loss = 0.008
2024-01-24 07:26:01,566 -   best_eval_score = 0.688
2024-01-24 07:26:01,566 -   eval_score = 0.6821
2024-01-24 07:26:01,566 - EarlyStopping counter: 1 out of 8
2024-01-24 07:26:09,759 - ***** Epoch: 30: Eval results *****
2024-01-24 07:26:09,759 -   train_loss = 0.0076
2024-01-24 07:26:09,759 -   best_eval_score = 0.688
2024-01-24 07:26:09,759 -   eval_score = 0.6787
2024-01-24 07:26:09,759 - EarlyStopping counter: 2 out of 8
2024-01-24 07:26:18,980 - ***** Epoch: 31: Eval results *****
2024-01-24 07:26:18,981 -   train_loss = 0.0071
2024-01-24 07:26:18,981 -   best_eval_score = 0.688
2024-01-24 07:26:18,981 -   eval_score = 0.6772
2024-01-24 07:26:18,981 - EarlyStopping counter: 3 out of 8
2024-01-24 07:26:27,754 - ***** Epoch: 32: Eval results *****
2024-01-24 07:26:27,754 -   train_loss = 0.0068
2024-01-24 07:26:27,754 -   best_eval_score = 0.688
2024-01-24 07:26:27,754 -   eval_score = 0.6891
2024-01-24 07:26:35,660 - ***** Epoch: 33: Eval results *****
2024-01-24 07:26:35,660 -   train_loss = 0.0064
2024-01-24 07:26:35,660 -   best_eval_score = 0.6891
2024-01-24 07:26:35,660 -   eval_score = 0.6796
2024-01-24 07:26:35,660 - EarlyStopping counter: 1 out of 8
2024-01-24 07:26:43,884 - ***** Epoch: 34: Eval results *****
2024-01-24 07:26:43,884 -   train_loss = 0.0061
2024-01-24 07:26:43,884 -   best_eval_score = 0.6891
2024-01-24 07:26:43,884 -   eval_score = 0.6821
2024-01-24 07:26:43,884 - EarlyStopping counter: 2 out of 8
2024-01-24 07:26:51,820 - ***** Epoch: 35: Eval results *****
2024-01-24 07:26:51,820 -   train_loss = 0.0066
2024-01-24 07:26:51,820 -   best_eval_score = 0.6891
2024-01-24 07:26:51,820 -   eval_score = 0.6843
2024-01-24 07:26:51,820 - EarlyStopping counter: 3 out of 8
2024-01-24 07:27:00,056 - ***** Epoch: 36: Eval results *****
2024-01-24 07:27:00,056 -   train_loss = 0.0058
2024-01-24 07:27:00,056 -   best_eval_score = 0.6891
2024-01-24 07:27:00,056 -   eval_score = 0.6929
2024-01-24 07:27:08,259 - ***** Epoch: 37: Eval results *****
2024-01-24 07:27:08,260 -   train_loss = 0.0073
2024-01-24 07:27:08,260 -   best_eval_score = 0.6929
2024-01-24 07:27:08,260 -   eval_score = 0.6367
2024-01-24 07:27:08,260 - EarlyStopping counter: 1 out of 8
2024-01-24 07:27:16,409 - ***** Epoch: 38: Eval results *****
2024-01-24 07:27:16,409 -   train_loss = 0.0384
2024-01-24 07:27:16,409 -   best_eval_score = 0.6929
2024-01-24 07:27:16,409 -   eval_score = 0.6585
2024-01-24 07:27:16,409 - EarlyStopping counter: 2 out of 8
2024-01-24 07:27:25,274 - ***** Epoch: 39: Eval results *****
2024-01-24 07:27:25,274 -   train_loss = 0.0186
2024-01-24 07:27:25,274 -   best_eval_score = 0.6929
2024-01-24 07:27:25,274 -   eval_score = 0.6647
2024-01-24 07:27:25,274 - EarlyStopping counter: 3 out of 8
2024-01-24 07:27:33,162 - ***** Epoch: 40: Eval results *****
2024-01-24 07:27:33,162 -   train_loss = 0.0067
2024-01-24 07:27:33,163 -   best_eval_score = 0.6929
2024-01-24 07:27:33,163 -   eval_score = 0.6755
2024-01-24 07:27:33,163 - EarlyStopping counter: 4 out of 8
2024-01-24 07:27:40,561 - ***** Epoch: 41: Eval results *****
2024-01-24 07:27:40,562 -   train_loss = 0.0056
2024-01-24 07:27:40,562 -   best_eval_score = 0.6929
2024-01-24 07:27:40,562 -   eval_score = 0.6762
2024-01-24 07:27:40,562 - EarlyStopping counter: 5 out of 8
2024-01-24 07:27:48,537 - ***** Epoch: 42: Eval results *****
2024-01-24 07:27:48,538 -   train_loss = 0.0051
2024-01-24 07:27:48,538 -   best_eval_score = 0.6929
2024-01-24 07:27:48,538 -   eval_score = 0.6676
2024-01-24 07:27:48,538 - EarlyStopping counter: 6 out of 8
2024-01-24 07:27:57,112 - ***** Epoch: 43: Eval results *****
2024-01-24 07:27:57,113 -   train_loss = 0.0046
2024-01-24 07:27:57,113 -   best_eval_score = 0.6929
2024-01-24 07:27:57,113 -   eval_score = 0.6732
2024-01-24 07:27:57,113 - EarlyStopping counter: 7 out of 8
2024-01-24 07:28:06,726 - ***** Epoch: 44: Eval results *****
2024-01-24 07:28:06,726 -   train_loss = 0.0043
2024-01-24 07:28:06,726 -   best_eval_score = 0.6929
2024-01-24 07:28:06,726 -   eval_score = 0.674
2024-01-24 07:28:06,726 - EarlyStopping counter: 8 out of 8
2024-01-24 07:28:06,726 - EarlyStopping at epoch 44
2024-01-24 07:28:06,728 - Training is finished...
2024-01-24 07:28:06,728 - Testing begins...
2024-01-24 07:28:08,282 - ***** Test: Confusion Matrix *****
2024-01-24 07:28:08,283 - [[32  2  0  0  6  0  4  1  1  5  0  0  4  2  0  0  0  0  0  0]
 [ 1 37  0  1  0  1  1  0  0  0  0  0  1  1  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 3  0  0  0 12  0  4  0  0  0  0  2  0  2  0  0  0  0  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  2  0  3  1  2  0  0  0  1  0  1  0  0  0  0  0]
 [ 3  0  0  0  0  0  0  5  0  1  1  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  1  2  5  0  0  0  0  1  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  4  1  0  0  0  0  2  0  1  0  0]
 [ 1  0  0  0  0  0  1  0  0  2 12  0  0  1  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  0  1]
 [ 4  2  0  0  0  0  0  0  0  0  0  1 42  3  2  2  1  0  0  0]
 [ 0  2  0  0  0  0  1  0  0  0  1  1  0 19  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  2  0  0  0  0  0  0  2 15  0  1  0  0  2]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  4  1  0 14  0  0  1  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  2  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  0  0  1  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  2  0  0  0  0  7]]
2024-01-24 07:28:08,283 - ***** Evaluation results *****
2024-01-24 07:28:08,283 -   acc = 0.7213
2024-01-24 07:28:08,283 -   f1 = 0.7002
2024-01-24 07:28:08,283 -   prec = 0.7076
2024-01-24 07:28:08,283 -   rec = 0.6989
2024-01-24 07:28:08,283 - Testing is finished...
2024-01-24 07:28:08,283 - Multimodal intent recognition is finished...
2024-01-24 07:28:08,283 - Results are saved in results/text_bert.csv
