2024-03-30 01:39:33,076 - ============================== Params ==============================
2024-03-30 01:39:33,076 - logger_name: msz_MIntRec_multi-class_seed-2_2024-03-30-01-39-33
2024-03-30 01:39:33,076 - dataset: MIntRec
2024-03-30 01:39:33,076 - data_mode: multi-class
2024-03-30 01:39:33,076 - method: msz
2024-03-30 01:39:33,076 - text_backbone: bert-base-uncased
2024-03-30 01:39:33,076 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-30 01:39:33,076 - seed: 2
2024-03-30 01:39:33,076 - num_workers: 8
2024-03-30 01:39:33,076 - gpu_id: 3
2024-03-30 01:39:33,076 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-30 01:39:33,076 - train: True
2024-03-30 01:39:33,076 - tune: True
2024-03-30 01:39:33,076 - save_model: False
2024-03-30 01:39:33,077 - save_results: True
2024-03-30 01:39:33,077 - log_path: logs
2024-03-30 01:39:33,077 - cache_path: 
2024-03-30 01:39:33,077 - video_data_path: video_data
2024-03-30 01:39:33,077 - audio_data_path: audio_data
2024-03-30 01:39:33,077 - video_feats_path: video_feats.pkl
2024-03-30 01:39:33,077 - audio_feats_path: audio_feats.pkl
2024-03-30 01:39:33,077 - results_path: results
2024-03-30 01:39:33,077 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-03-30 01:39:33,077 - model_path: models
2024-03-30 01:39:33,077 - config_file_name: msz_MIntRec
2024-03-30 01:39:33,077 - results_file_name: msz.csv
2024-03-30 01:39:33,077 - padding_mode: zero
2024-03-30 01:39:33,077 - padding_loc: end
2024-03-30 01:39:33,077 - need_aligned: False
2024-03-30 01:39:33,077 - eval_monitor: f1
2024-03-30 01:39:33,077 - train_batch_size: 16
2024-03-30 01:39:33,077 - eval_batch_size: 8
2024-03-30 01:39:33,077 - test_batch_size: 8
2024-03-30 01:39:33,077 - wait_patience: 8
2024-03-30 01:39:33,077 - hidden_dims: 768
2024-03-30 01:39:33,077 - num_attention_heads: 8
2024-03-30 01:39:33,077 - attention_probs_dropout_prob: 0.2
2024-03-30 01:39:33,077 - hidden_dropout_prob: 0.4
2024-03-30 01:39:33,077 - intermediate_size: 768
2024-03-30 01:39:33,077 - num_hidden_layers: 6
2024-03-30 01:39:33,077 - max_position_embeddings: 768
2024-03-30 01:39:33,077 - position_embedding_type: absolute
2024-03-30 01:39:33,077 - batch_first: True
2024-03-30 01:39:33,077 - dropout: 0.3
2024-03-30 01:39:33,077 - aligned_method: conv1d
2024-03-30 01:39:33,077 - num_train_epochs: 100
2024-03-30 01:39:33,077 - lr: 5e-06
2024-03-30 01:39:33,077 - lr_mode: max
2024-03-30 01:39:33,077 - patience: 4
2024-03-30 01:39:33,077 - factor: 0.6
2024-03-30 01:39:33,077 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-03-30-01-39-33
2024-03-30 01:39:33,077 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-03-30-01-39-33/models
2024-03-30 01:39:33,077 - num_labels: 20
2024-03-30 01:39:33,077 - text_feat_dim: 768
2024-03-30 01:39:33,077 - video_feat_dim: 256
2024-03-30 01:39:33,077 - audio_feat_dim: 768
2024-03-30 01:39:33,077 - text_seq_len: 30
2024-03-30 01:39:33,077 - video_seq_len: 230
2024-03-30 01:39:33,077 - audio_seq_len: 480
2024-03-30 01:39:33,077 - device: cuda:3
2024-03-30 01:39:33,078 - ============================== End Params ==============================
2024-03-30 01:39:33,156 - Generate Text Features Begin...
2024-03-30 01:39:33,610 - Generate Text Features Finished...
2024-03-30 01:39:33,610 - Load Video Features Begin...
2024-03-30 01:39:51,502 - Load Video Features Finished...
2024-03-30 01:39:52,043 - Load Audio Features Begin...
2024-03-30 01:40:33,940 - Load Audio Features Finished...
2024-03-30 01:40:36,811 - method  begins...
2024-03-30 01:40:40,923 - Multimodal intent recognition begins...
2024-03-30 01:40:40,923 - Training begins...
2024-03-30 01:40:59,367 - ***** Epoch: 1: Eval results *****
2024-03-30 01:40:59,368 -   train_loss = 2.7821
2024-03-30 01:40:59,368 -   best_eval_score = 0.0
2024-03-30 01:40:59,368 -   eval_score = 0.1406
2024-03-30 01:41:17,977 - ***** Epoch: 2: Eval results *****
2024-03-30 01:41:17,977 -   train_loss = 2.2013
2024-03-30 01:41:17,977 -   best_eval_score = 0.1406
2024-03-30 01:41:17,977 -   eval_score = 0.3451
2024-03-30 01:41:36,796 - ***** Epoch: 3: Eval results *****
2024-03-30 01:41:36,796 -   train_loss = 1.4924
2024-03-30 01:41:36,796 -   best_eval_score = 0.3451
2024-03-30 01:41:36,796 -   eval_score = 0.5099
2024-03-30 01:41:54,739 - ***** Epoch: 4: Eval results *****
2024-03-30 01:41:54,739 -   train_loss = 0.9989
2024-03-30 01:41:54,739 -   best_eval_score = 0.5099
2024-03-30 01:41:54,739 -   eval_score = 0.5687
2024-03-30 01:42:12,900 - ***** Epoch: 5: Eval results *****
2024-03-30 01:42:12,900 -   train_loss = 0.6696
2024-03-30 01:42:12,900 -   best_eval_score = 0.5687
2024-03-30 01:42:12,900 -   eval_score = 0.6247
2024-03-30 01:42:31,020 - ***** Epoch: 6: Eval results *****
2024-03-30 01:42:31,020 -   train_loss = 0.4391
2024-03-30 01:42:31,020 -   best_eval_score = 0.6247
2024-03-30 01:42:31,020 -   eval_score = 0.639
2024-03-30 01:42:48,909 - ***** Epoch: 7: Eval results *****
2024-03-30 01:42:48,910 -   train_loss = 0.2863
2024-03-30 01:42:48,910 -   best_eval_score = 0.639
2024-03-30 01:42:48,910 -   eval_score = 0.6472
2024-03-30 01:43:07,712 - ***** Epoch: 8: Eval results *****
2024-03-30 01:43:07,712 -   train_loss = 0.216
2024-03-30 01:43:07,713 -   best_eval_score = 0.6472
2024-03-30 01:43:07,713 -   eval_score = 0.6533
2024-03-30 01:43:25,222 - ***** Epoch: 9: Eval results *****
2024-03-30 01:43:25,223 -   train_loss = 0.1547
2024-03-30 01:43:25,223 -   best_eval_score = 0.6533
2024-03-30 01:43:25,223 -   eval_score = 0.6576
2024-03-30 01:43:44,792 - ***** Epoch: 10: Eval results *****
2024-03-30 01:43:44,792 -   train_loss = 0.1228
2024-03-30 01:43:44,792 -   best_eval_score = 0.6576
2024-03-30 01:43:44,792 -   eval_score = 0.6733
2024-03-30 01:44:02,216 - ***** Epoch: 11: Eval results *****
2024-03-30 01:44:02,217 -   train_loss = 0.0964
2024-03-30 01:44:02,217 -   best_eval_score = 0.6733
2024-03-30 01:44:02,217 -   eval_score = 0.6703
2024-03-30 01:44:02,217 - EarlyStopping counter: 1 out of 8
2024-03-30 01:44:20,263 - ***** Epoch: 12: Eval results *****
2024-03-30 01:44:20,263 -   train_loss = 0.0756
2024-03-30 01:44:20,263 -   best_eval_score = 0.6733
2024-03-30 01:44:20,263 -   eval_score = 0.6795
2024-03-30 01:44:37,486 - ***** Epoch: 13: Eval results *****
2024-03-30 01:44:37,487 -   train_loss = 0.0653
2024-03-30 01:44:37,487 -   best_eval_score = 0.6795
2024-03-30 01:44:37,487 -   eval_score = 0.6726
2024-03-30 01:44:37,487 - EarlyStopping counter: 1 out of 8
2024-03-30 01:44:55,053 - ***** Epoch: 14: Eval results *****
2024-03-30 01:44:55,054 -   train_loss = 0.0568
2024-03-30 01:44:55,054 -   best_eval_score = 0.6795
2024-03-30 01:44:55,054 -   eval_score = 0.6693
2024-03-30 01:44:55,054 - EarlyStopping counter: 2 out of 8
2024-03-30 01:45:12,841 - ***** Epoch: 15: Eval results *****
2024-03-30 01:45:12,842 -   train_loss = 0.0514
2024-03-30 01:45:12,842 -   best_eval_score = 0.6795
2024-03-30 01:45:12,842 -   eval_score = 0.6822
2024-03-30 01:45:30,989 - ***** Epoch: 16: Eval results *****
2024-03-30 01:45:30,989 -   train_loss = 0.0437
2024-03-30 01:45:30,989 -   best_eval_score = 0.6822
2024-03-30 01:45:30,989 -   eval_score = 0.673
2024-03-30 01:45:30,989 - EarlyStopping counter: 1 out of 8
2024-03-30 01:45:48,528 - ***** Epoch: 17: Eval results *****
2024-03-30 01:45:48,528 -   train_loss = 0.0392
2024-03-30 01:45:48,528 -   best_eval_score = 0.6822
2024-03-30 01:45:48,528 -   eval_score = 0.6808
2024-03-30 01:45:48,528 - EarlyStopping counter: 2 out of 8
2024-03-30 01:46:05,752 - ***** Epoch: 18: Eval results *****
2024-03-30 01:46:05,752 -   train_loss = 0.0351
2024-03-30 01:46:05,752 -   best_eval_score = 0.6822
2024-03-30 01:46:05,752 -   eval_score = 0.6716
2024-03-30 01:46:05,752 - EarlyStopping counter: 3 out of 8
2024-03-30 01:46:23,267 - ***** Epoch: 19: Eval results *****
2024-03-30 01:46:23,268 -   train_loss = 0.0346
2024-03-30 01:46:23,268 -   best_eval_score = 0.6822
2024-03-30 01:46:23,268 -   eval_score = 0.689
2024-03-30 01:46:40,571 - ***** Epoch: 20: Eval results *****
2024-03-30 01:46:40,571 -   train_loss = 0.0305
2024-03-30 01:46:40,571 -   best_eval_score = 0.689
2024-03-30 01:46:40,571 -   eval_score = 0.688
2024-03-30 01:46:40,571 - EarlyStopping counter: 1 out of 8
2024-03-30 01:46:57,686 - ***** Epoch: 21: Eval results *****
2024-03-30 01:46:57,686 -   train_loss = 0.0298
2024-03-30 01:46:57,686 -   best_eval_score = 0.689
2024-03-30 01:46:57,686 -   eval_score = 0.6892
2024-03-30 01:47:15,060 - ***** Epoch: 22: Eval results *****
2024-03-30 01:47:15,060 -   train_loss = 0.0273
2024-03-30 01:47:15,060 -   best_eval_score = 0.6892
2024-03-30 01:47:15,060 -   eval_score = 0.6931
2024-03-30 01:47:32,295 - ***** Epoch: 23: Eval results *****
2024-03-30 01:47:32,295 -   train_loss = 0.0286
2024-03-30 01:47:32,295 -   best_eval_score = 0.6931
2024-03-30 01:47:32,296 -   eval_score = 0.6915
2024-03-30 01:47:32,296 - EarlyStopping counter: 1 out of 8
2024-03-30 01:47:49,197 - ***** Epoch: 24: Eval results *****
2024-03-30 01:47:49,197 -   train_loss = 0.0239
2024-03-30 01:47:49,197 -   best_eval_score = 0.6931
2024-03-30 01:47:49,197 -   eval_score = 0.6911
2024-03-30 01:47:49,197 - EarlyStopping counter: 2 out of 8
2024-03-30 01:48:06,576 - ***** Epoch: 25: Eval results *****
2024-03-30 01:48:06,576 -   train_loss = 0.0277
2024-03-30 01:48:06,576 -   best_eval_score = 0.6931
2024-03-30 01:48:06,576 -   eval_score = 0.6907
2024-03-30 01:48:06,576 - EarlyStopping counter: 3 out of 8
2024-03-30 01:48:24,074 - ***** Epoch: 26: Eval results *****
2024-03-30 01:48:24,074 -   train_loss = 0.0242
2024-03-30 01:48:24,074 -   best_eval_score = 0.6931
2024-03-30 01:48:24,074 -   eval_score = 0.6876
2024-03-30 01:48:24,074 - EarlyStopping counter: 4 out of 8
2024-03-30 01:48:41,924 - ***** Epoch: 27: Eval results *****
2024-03-30 01:48:41,924 -   train_loss = 0.0232
2024-03-30 01:48:41,924 -   best_eval_score = 0.6931
2024-03-30 01:48:41,924 -   eval_score = 0.6895
2024-03-30 01:48:41,924 - EarlyStopping counter: 5 out of 8
2024-03-30 01:48:59,360 - ***** Epoch: 28: Eval results *****
2024-03-30 01:48:59,361 -   train_loss = 0.0235
2024-03-30 01:48:59,361 -   best_eval_score = 0.6931
2024-03-30 01:48:59,361 -   eval_score = 0.6902
2024-03-30 01:48:59,361 - EarlyStopping counter: 6 out of 8
2024-03-30 01:49:16,641 - ***** Epoch: 29: Eval results *****
2024-03-30 01:49:16,641 -   train_loss = 0.0225
2024-03-30 01:49:16,641 -   best_eval_score = 0.6931
2024-03-30 01:49:16,641 -   eval_score = 0.6903
2024-03-30 01:49:16,641 - EarlyStopping counter: 7 out of 8
2024-03-30 01:49:34,025 - ***** Epoch: 30: Eval results *****
2024-03-30 01:49:34,026 -   train_loss = 0.0216
2024-03-30 01:49:34,026 -   best_eval_score = 0.6931
2024-03-30 01:49:34,026 -   eval_score = 0.6904
2024-03-30 01:49:34,026 - EarlyStopping counter: 8 out of 8
2024-03-30 01:49:34,026 - EarlyStopping at epoch 30
2024-03-30 01:49:34,033 - Training is finished...
2024-03-30 01:49:34,034 - Testing begins...
2024-03-30 01:49:37,997 - ***** Test: Confusion Matrix *****
2024-03-30 01:49:37,999 - [[38  1  0  0  6  0  2  0  1  2  1  0  4  1  1  0  0  0  0  0]
 [ 0 35  0  1  0  2  1  0  0  0  1  0  2  0  1  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 6  0  0  0 10  0  1  0  0  0  0  1  2  1  0  0  0  2  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 2  1  0  0  3  0  1  1  2  0  0  0  1  0  0  0  1  0  0  0]
 [ 3  0  0  0  0  1  0  5  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  3  3  0  0  0  0  2  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  3  0  0  0  0  0  3  1  1  0  0]
 [ 1  0  0  0  0  0  1  0  0  1 13  0  0  0  1  0  1  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  0  1]
 [ 3  2  0  0  1  0  0  0  0  0  0  1 40  1  4  2  2  0  0  1]
 [ 1  0  0  0  0  0  1  0  0  0  1  1  1 18  2  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  2 14  0  1  0  0  2]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  3  0  0 16  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  3  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  2  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  0  2  0  0  5]]
2024-03-30 01:49:37,999 - ***** Evaluation results *****
2024-03-30 01:49:38,000 -   acc = 0.6989
2024-03-30 01:49:38,000 -   f1 = 0.6551
2024-03-30 01:49:38,000 -   prec = 0.6639
2024-03-30 01:49:38,000 -   rec = 0.6532
2024-03-30 01:49:38,000 - Testing is finished...
2024-03-30 01:49:38,000 - Multimodal intent recognition is finished...
2024-03-30 01:49:38,000 - Results are saved in results/msz.csv
