2024-01-07 10:30:53,539 - ============================== Params ==============================
2024-01-07 10:30:53,539 - logger_name: msz_MIntRec_multi-class_seed-3_2024-01-07-10-30-53
2024-01-07 10:30:53,539 - dataset: MIntRec
2024-01-07 10:30:53,539 - data_mode: multi-class
2024-01-07 10:30:53,539 - method: msz
2024-01-07 10:30:53,539 - text_backbone: bert-base-uncased
2024-01-07 10:30:53,539 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-07 10:30:53,539 - seed: 3
2024-01-07 10:30:53,539 - num_workers: 8
2024-01-07 10:30:53,539 - gpu_id: 1
2024-01-07 10:30:53,539 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-07 10:30:53,539 - train: True
2024-01-07 10:30:53,539 - tune: False
2024-01-07 10:30:53,539 - save_model: False
2024-01-07 10:30:53,539 - save_results: True
2024-01-07 10:30:53,540 - log_path: logs
2024-01-07 10:30:53,540 - cache_path: 
2024-01-07 10:30:53,540 - video_data_path: video_data
2024-01-07 10:30:53,540 - audio_data_path: audio_data
2024-01-07 10:30:53,540 - video_feats_path: video_feats.pkl
2024-01-07 10:30:53,540 - audio_feats_path: audio_feats.pkl
2024-01-07 10:30:53,540 - results_path: results
2024-01-07 10:30:53,540 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-07 10:30:53,540 - model_path: models
2024-01-07 10:30:53,540 - config_file_name: msz
2024-01-07 10:30:53,540 - results_file_name: msz.csv
2024-01-07 10:30:53,540 - padding_mode: zero
2024-01-07 10:30:53,540 - padding_loc: end
2024-01-07 10:30:53,540 - need_aligned: False
2024-01-07 10:30:53,540 - eval_monitor: f1
2024-01-07 10:30:53,540 - train_batch_size: 16
2024-01-07 10:30:53,540 - eval_batch_size: 8
2024-01-07 10:30:53,540 - test_batch_size: 8
2024-01-07 10:30:53,540 - wait_patience: 8
2024-01-07 10:30:53,540 - nheads: 2
2024-01-07 10:30:53,540 - encoder_layers: 2
2024-01-07 10:30:53,540 - attn_dropout: 0.1
2024-01-07 10:30:53,540 - relu_dropout: 0.1
2024-01-07 10:30:53,540 - embed_dropout: 0.1
2024-01-07 10:30:53,540 - res_dropout: 0.1
2024-01-07 10:30:53,540 - attn_mask: False
2024-01-07 10:30:53,540 - hidden_size: 768
2024-01-07 10:30:53,540 - num_attention_heads: 12
2024-01-07 10:30:53,540 - attention_probs_dropout_prob: 0.2
2024-01-07 10:30:53,540 - hidden_dropout_prob: 0.2
2024-01-07 10:30:53,540 - intermediate_size: 768
2024-01-07 10:30:53,540 - num_hidden_layers: 3
2024-01-07 10:30:53,540 - max_position_embeddings: 512
2024-01-07 10:30:53,540 - position_embedding_type: absolute
2024-01-07 10:30:53,540 - batch_first: True
2024-01-07 10:30:53,540 - hidden_dims: 768
2024-01-07 10:30:53,540 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-07 10:30:53,540 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-07 10:30:53,541 - ta_loss: 0.1
2024-01-07 10:30:53,541 - tv_loss: 0.1
2024-01-07 10:30:53,541 - av_loss: 0.1
2024-01-07 10:30:53,541 - aligned_method: ctc
2024-01-07 10:30:53,541 - grad_clip: -1
2024-01-07 10:30:53,541 - num_train_epochs: 100
2024-01-07 10:30:53,541 - warmup_proportion: 0.1
2024-01-07 10:30:53,541 - lr: 1e-06
2024-01-07 10:30:53,541 - weight_decay: 0.01
2024-01-07 10:30:53,541 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2024-01-07-10-30-53
2024-01-07 10:30:53,541 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2024-01-07-10-30-53/models
2024-01-07 10:30:53,541 - ============================== End Params ==============================
2024-01-07 10:30:53,543 - Generate Text Features Begin...
2024-01-07 10:30:54,046 - Generate Text Features Finished...
2024-01-07 10:30:54,047 - Load Video Features Begin...
2024-01-07 10:30:54,381 - Load Video Features Finished...
2024-01-07 10:30:55,012 - Load Audio Features Begin...
2024-01-07 10:30:56,078 - Load Audio Features Finished...
2024-01-07 10:30:59,840 - method  begins...
2024-01-07 10:31:03,938 - Multimodal intent recognition begins...
2024-01-07 10:31:03,938 - Training begins...
2024-01-07 10:31:18,167 - ***** Epoch: 1: Eval results *****
2024-01-07 10:31:18,168 -   train_loss = 2.9807
2024-01-07 10:31:18,168 -   best_eval_score = 0.0
2024-01-07 10:31:18,168 -   eval_score = 0.0294
2024-01-07 10:31:31,369 - ***** Epoch: 2: Eval results *****
2024-01-07 10:31:31,369 -   train_loss = 2.9371
2024-01-07 10:31:31,369 -   best_eval_score = 0.0294
2024-01-07 10:31:31,369 -   eval_score = 0.0164
2024-01-07 10:31:31,369 - EarlyStopping counter: 1 out of 8
2024-01-07 10:31:45,068 - ***** Epoch: 3: Eval results *****
2024-01-07 10:31:45,068 -   train_loss = 2.8585
2024-01-07 10:31:45,068 -   best_eval_score = 0.0294
2024-01-07 10:31:45,068 -   eval_score = 0.0164
2024-01-07 10:31:45,068 - EarlyStopping counter: 2 out of 8
2024-01-07 10:31:58,295 - ***** Epoch: 4: Eval results *****
2024-01-07 10:31:58,295 -   train_loss = 2.7654
2024-01-07 10:31:58,295 -   best_eval_score = 0.0294
2024-01-07 10:31:58,295 -   eval_score = 0.0423
2024-01-07 10:32:12,226 - ***** Epoch: 5: Eval results *****
2024-01-07 10:32:12,226 -   train_loss = 2.635
2024-01-07 10:32:12,226 -   best_eval_score = 0.0423
2024-01-07 10:32:12,226 -   eval_score = 0.1258
2024-01-07 10:32:25,367 - ***** Epoch: 6: Eval results *****
2024-01-07 10:32:25,368 -   train_loss = 2.4344
2024-01-07 10:32:25,369 -   best_eval_score = 0.1258
2024-01-07 10:32:25,369 -   eval_score = 0.1691
2024-01-07 10:32:38,872 - ***** Epoch: 7: Eval results *****
2024-01-07 10:32:38,872 -   train_loss = 2.1526
2024-01-07 10:32:38,872 -   best_eval_score = 0.1691
2024-01-07 10:32:38,872 -   eval_score = 0.1965
2024-01-07 10:32:52,356 - ***** Epoch: 8: Eval results *****
2024-01-07 10:32:52,356 -   train_loss = 1.7784
2024-01-07 10:32:52,356 -   best_eval_score = 0.1965
2024-01-07 10:32:52,356 -   eval_score = 0.3951
2024-01-07 10:33:05,730 - ***** Epoch: 9: Eval results *****
2024-01-07 10:33:05,730 -   train_loss = 1.4146
2024-01-07 10:33:05,730 -   best_eval_score = 0.3951
2024-01-07 10:33:05,730 -   eval_score = 0.4863
2024-01-07 10:33:19,148 - ***** Epoch: 10: Eval results *****
2024-01-07 10:33:19,148 -   train_loss = 1.1118
2024-01-07 10:33:19,148 -   best_eval_score = 0.4863
2024-01-07 10:33:19,148 -   eval_score = 0.5548
2024-01-07 10:33:32,632 - ***** Epoch: 11: Eval results *****
2024-01-07 10:33:32,632 -   train_loss = 0.9078
2024-01-07 10:33:32,632 -   best_eval_score = 0.5548
2024-01-07 10:33:32,632 -   eval_score = 0.5485
2024-01-07 10:33:32,632 - EarlyStopping counter: 1 out of 8
2024-01-07 10:33:45,800 - ***** Epoch: 12: Eval results *****
2024-01-07 10:33:45,800 -   train_loss = 0.6793
2024-01-07 10:33:45,800 -   best_eval_score = 0.5548
2024-01-07 10:33:45,800 -   eval_score = 0.5614
2024-01-07 10:33:59,058 - ***** Epoch: 13: Eval results *****
2024-01-07 10:33:59,059 -   train_loss = 0.5509
2024-01-07 10:33:59,059 -   best_eval_score = 0.5614
2024-01-07 10:33:59,059 -   eval_score = 0.5689
2024-01-07 10:34:13,566 - ***** Epoch: 14: Eval results *****
2024-01-07 10:34:13,566 -   train_loss = 0.3529
2024-01-07 10:34:13,566 -   best_eval_score = 0.5689
2024-01-07 10:34:13,567 -   eval_score = 0.6547
2024-01-07 10:34:27,132 - ***** Epoch: 15: Eval results *****
2024-01-07 10:34:27,132 -   train_loss = 0.3162
2024-01-07 10:34:27,132 -   best_eval_score = 0.6547
2024-01-07 10:34:27,132 -   eval_score = 0.624
2024-01-07 10:34:27,132 - EarlyStopping counter: 1 out of 8
2024-01-07 10:34:41,036 - ***** Epoch: 16: Eval results *****
2024-01-07 10:34:41,037 -   train_loss = 0.2045
2024-01-07 10:34:41,037 -   best_eval_score = 0.6547
2024-01-07 10:34:41,037 -   eval_score = 0.6209
2024-01-07 10:34:41,037 - EarlyStopping counter: 2 out of 8
2024-01-07 10:34:54,266 - ***** Epoch: 17: Eval results *****
2024-01-07 10:34:54,267 -   train_loss = 0.1446
2024-01-07 10:34:54,267 -   best_eval_score = 0.6547
2024-01-07 10:34:54,267 -   eval_score = 0.6185
2024-01-07 10:34:54,267 - EarlyStopping counter: 3 out of 8
2024-01-07 10:35:07,898 - ***** Epoch: 18: Eval results *****
2024-01-07 10:35:07,899 -   train_loss = 0.1235
2024-01-07 10:35:07,899 -   best_eval_score = 0.6547
2024-01-07 10:35:07,899 -   eval_score = 0.6248
2024-01-07 10:35:07,899 - EarlyStopping counter: 4 out of 8
2024-01-07 10:35:21,090 - ***** Epoch: 19: Eval results *****
2024-01-07 10:35:21,090 -   train_loss = 0.0786
2024-01-07 10:35:21,090 -   best_eval_score = 0.6547
2024-01-07 10:35:21,090 -   eval_score = 0.6289
2024-01-07 10:35:21,090 - EarlyStopping counter: 5 out of 8
2024-01-07 10:35:34,758 - ***** Epoch: 20: Eval results *****
2024-01-07 10:35:34,759 -   train_loss = 0.0549
2024-01-07 10:35:34,759 -   best_eval_score = 0.6547
2024-01-07 10:35:34,759 -   eval_score = 0.6097
2024-01-07 10:35:34,759 - EarlyStopping counter: 6 out of 8
2024-01-07 10:35:48,009 - ***** Epoch: 21: Eval results *****
2024-01-07 10:35:48,010 -   train_loss = 0.044
2024-01-07 10:35:48,010 -   best_eval_score = 0.6547
2024-01-07 10:35:48,010 -   eval_score = 0.6011
2024-01-07 10:35:48,010 - EarlyStopping counter: 7 out of 8
2024-01-07 10:36:01,537 - ***** Epoch: 22: Eval results *****
2024-01-07 10:36:01,537 -   train_loss = 0.0365
2024-01-07 10:36:01,537 -   best_eval_score = 0.6547
2024-01-07 10:36:01,537 -   eval_score = 0.6002
2024-01-07 10:36:01,537 - EarlyStopping counter: 8 out of 8
2024-01-07 10:36:01,537 - EarlyStopping at epoch 22
2024-01-07 10:36:01,539 - Training is finished...
2024-01-07 10:36:01,539 - Testing begins...
2024-01-07 10:36:04,130 - ***** Test: Confusion Matrix *****
2024-01-07 10:36:04,131 - [[28  0  0  0 12  0  2  1  0  4  0  0  8  2  0  0  0  0  0  0]
 [ 0 32  0  1  0  1  0  3  1  0  0  0  2  1  1  0  0  1  0  0]
 [ 1  0 25  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1]
 [ 0  0  0  0 14  0  1  0  1  1  0  0  2  2  1  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  4  0  1  1  2  1  0  0  1  0  0  0  1  1  0  0]
 [ 1  0  0  0  0  0  0  6  1  1  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  1  0  0  0  0  3  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  3  1  0  0  0  0  2  0  3  0  0]
 [ 0  0  0  0  0  0  0  0  0  3 12  0  0  1  0  0  0  2  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 15  1  0  0  0  0  1  0  1]
 [ 3  1  0  0  0  1  0  1  1  1  0  0 39  1  9  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  1  1  1 17  4  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0 19  0  1  1  0  0]
 [ 0  0  0  0  0  0  0  0  2  0  0  0  5  0  1 13  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  4  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0 14  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  1  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  1  3  0  0  0  0  4]]
2024-01-07 10:36:04,131 - ***** Evaluation results *****
2024-01-07 10:36:04,131 -   acc = 0.6674
2024-01-07 10:36:04,131 -   f1 = 0.6259
2024-01-07 10:36:04,131 -   prec = 0.6513
2024-01-07 10:36:04,131 -   rec = 0.634
2024-01-07 10:36:04,131 - Testing is finished...
2024-01-07 10:36:04,131 - Multimodal intent recognition is finished...
2024-01-07 10:36:04,131 - Results are saved in results/msz.csv
