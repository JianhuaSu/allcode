2024-03-16 12:23:32,513 - ============================== Params ==============================
2024-03-16 12:23:32,513 - logger_name: mag_bert_MIntRec2_multi-class_seed-4_2024-03-16-12-23-32
2024-03-16 12:23:32,514 - dataset: MIntRec2
2024-03-16 12:23:32,514 - data_mode: multi-class
2024-03-16 12:23:32,514 - method: mag_bert
2024-03-16 12:23:32,514 - text_backbone: bert-base-uncased
2024-03-16 12:23:32,514 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-16 12:23:32,514 - seed: 4
2024-03-16 12:23:32,514 - num_workers: 8
2024-03-16 12:23:32,514 - gpu_id: 2
2024-03-16 12:23:32,514 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-16 12:23:32,514 - train: True
2024-03-16 12:23:32,514 - tune: True
2024-03-16 12:23:32,514 - save_model: False
2024-03-16 12:23:32,514 - save_results: True
2024-03-16 12:23:32,514 - log_path: logs
2024-03-16 12:23:32,514 - cache_path: 
2024-03-16 12:23:32,514 - video_data_path: video_data
2024-03-16 12:23:32,514 - audio_data_path: audio_data
2024-03-16 12:23:32,514 - video_feats_path: video_feats.pkl
2024-03-16 12:23:32,514 - audio_feats_path: audio_feats.pkl
2024-03-16 12:23:32,514 - results_path: results
2024-03-16 12:23:32,514 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-16 12:23:32,514 - model_path: models
2024-03-16 12:23:32,514 - config_file_name: mag_bert_MIntRec2
2024-03-16 12:23:32,514 - results_file_name: mag_bert.csv
2024-03-16 12:23:32,514 - padding_mode: zero
2024-03-16 12:23:32,514 - padding_loc: end
2024-03-16 12:23:32,514 - need_aligned: True
2024-03-16 12:23:32,514 - eval_monitor: f1
2024-03-16 12:23:32,514 - train_batch_size: 32
2024-03-16 12:23:32,514 - eval_batch_size: 16
2024-03-16 12:23:32,514 - test_batch_size: 16
2024-03-16 12:23:32,515 - wait_patience: 8
2024-03-16 12:23:32,515 - num_train_epochs: 100
2024-03-16 12:23:32,515 - beta_shift: 0.01
2024-03-16 12:23:32,515 - dropout_prob: 0.5
2024-03-16 12:23:32,515 - warmup_proportion: 0.1
2024-03-16 12:23:32,515 - lr: 9e-06
2024-03-16 12:23:32,515 - aligned_method: ctc
2024-03-16 12:23:32,515 - weight_decay: 0.1
2024-03-16 12:23:32,515 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-16-12-23-32
2024-03-16 12:23:32,515 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-16-12-23-32/models
2024-03-16 12:23:32,515 - num_labels: 30
2024-03-16 12:23:32,515 - text_feat_dim: 768
2024-03-16 12:23:32,515 - video_feat_dim: 256
2024-03-16 12:23:32,515 - audio_feat_dim: 768
2024-03-16 12:23:32,515 - text_seq_len: 50
2024-03-16 12:23:32,515 - video_seq_len: 180
2024-03-16 12:23:32,515 - audio_seq_len: 400
2024-03-16 12:23:32,515 - device: cuda:2
2024-03-16 12:23:32,515 - ============================== End Params ==============================
2024-03-16 12:23:32,531 - Generate Text Features Begin...
2024-03-16 12:23:34,503 - Generate Text Features Finished...
2024-03-16 12:23:34,504 - Load Video Features Begin...
2024-03-16 12:23:35,563 - Load Video Features Finished...
2024-03-16 12:23:37,201 - Load Audio Features Begin...
2024-03-16 12:23:40,904 - Load Audio Features Finished...
2024-03-16 12:23:59,602 - method  begins...
2024-03-16 12:24:00,481 - Multimodal intent recognition begins...
2024-03-16 12:24:00,481 - Training begins...
2024-03-16 12:24:34,698 - ***** Epoch: 1: Eval results *****
2024-03-16 12:24:34,700 -   train_loss = 3.3689
2024-03-16 12:24:34,700 -   best_eval_score = 0.0
2024-03-16 12:24:34,701 -   eval_score = 0.023
2024-03-16 12:25:11,979 - ***** Epoch: 2: Eval results *****
2024-03-16 12:25:11,979 -   train_loss = 3.1269
2024-03-16 12:25:11,979 -   best_eval_score = 0.023
2024-03-16 12:25:11,979 -   eval_score = 0.0502
2024-03-16 12:25:45,896 - ***** Epoch: 3: Eval results *****
2024-03-16 12:25:45,896 -   train_loss = 2.8346
2024-03-16 12:25:45,896 -   best_eval_score = 0.0502
2024-03-16 12:25:45,896 -   eval_score = 0.1356
2024-03-16 12:26:22,412 - ***** Epoch: 4: Eval results *****
2024-03-16 12:26:22,412 -   train_loss = 2.5493
2024-03-16 12:26:22,412 -   best_eval_score = 0.1356
2024-03-16 12:26:22,412 -   eval_score = 0.2248
2024-03-16 12:26:55,731 - ***** Epoch: 5: Eval results *****
2024-03-16 12:26:55,731 -   train_loss = 2.2481
2024-03-16 12:26:55,732 -   best_eval_score = 0.2248
2024-03-16 12:26:55,732 -   eval_score = 0.2859
2024-03-16 12:27:32,622 - ***** Epoch: 6: Eval results *****
2024-03-16 12:27:32,622 -   train_loss = 1.9942
2024-03-16 12:27:32,622 -   best_eval_score = 0.2859
2024-03-16 12:27:32,622 -   eval_score = 0.3199
2024-03-16 12:28:06,916 - ***** Epoch: 7: Eval results *****
2024-03-16 12:28:06,917 -   train_loss = 1.797
2024-03-16 12:28:06,917 -   best_eval_score = 0.3199
2024-03-16 12:28:06,917 -   eval_score = 0.3599
2024-03-16 12:28:43,038 - ***** Epoch: 8: Eval results *****
2024-03-16 12:28:43,039 -   train_loss = 1.6293
2024-03-16 12:28:43,039 -   best_eval_score = 0.3599
2024-03-16 12:28:43,039 -   eval_score = 0.4041
2024-03-16 12:29:18,798 - ***** Epoch: 9: Eval results *****
2024-03-16 12:29:18,799 -   train_loss = 1.492
2024-03-16 12:29:18,799 -   best_eval_score = 0.4041
2024-03-16 12:29:18,799 -   eval_score = 0.4257
2024-03-16 12:29:53,215 - ***** Epoch: 10: Eval results *****
2024-03-16 12:29:53,215 -   train_loss = 1.3717
2024-03-16 12:29:53,215 -   best_eval_score = 0.4257
2024-03-16 12:29:53,215 -   eval_score = 0.4441
2024-03-16 12:30:31,146 - ***** Epoch: 11: Eval results *****
2024-03-16 12:30:31,147 -   train_loss = 1.2648
2024-03-16 12:30:31,147 -   best_eval_score = 0.4441
2024-03-16 12:30:31,147 -   eval_score = 0.4602
2024-03-16 12:31:04,399 - ***** Epoch: 12: Eval results *****
2024-03-16 12:31:04,400 -   train_loss = 1.151
2024-03-16 12:31:04,400 -   best_eval_score = 0.4602
2024-03-16 12:31:04,400 -   eval_score = 0.4709
2024-03-16 12:31:41,884 - ***** Epoch: 13: Eval results *****
2024-03-16 12:31:41,884 -   train_loss = 1.0514
2024-03-16 12:31:41,884 -   best_eval_score = 0.4709
2024-03-16 12:31:41,884 -   eval_score = 0.4601
2024-03-16 12:31:41,884 - EarlyStopping counter: 1 out of 8
2024-03-16 12:32:15,848 - ***** Epoch: 14: Eval results *****
2024-03-16 12:32:15,848 -   train_loss = 0.9497
2024-03-16 12:32:15,848 -   best_eval_score = 0.4709
2024-03-16 12:32:15,848 -   eval_score = 0.4882
2024-03-16 12:32:51,985 - ***** Epoch: 15: Eval results *****
2024-03-16 12:32:51,986 -   train_loss = 0.865
2024-03-16 12:32:51,986 -   best_eval_score = 0.4882
2024-03-16 12:32:51,986 -   eval_score = 0.4882
2024-03-16 12:32:51,987 - EarlyStopping counter: 1 out of 8
2024-03-16 12:33:27,723 - ***** Epoch: 16: Eval results *****
2024-03-16 12:33:27,723 -   train_loss = 0.7913
2024-03-16 12:33:27,723 -   best_eval_score = 0.4882
2024-03-16 12:33:27,723 -   eval_score = 0.4833
2024-03-16 12:33:27,723 - EarlyStopping counter: 2 out of 8
2024-03-16 12:34:01,782 - ***** Epoch: 17: Eval results *****
2024-03-16 12:34:01,782 -   train_loss = 0.7114
2024-03-16 12:34:01,782 -   best_eval_score = 0.4882
2024-03-16 12:34:01,782 -   eval_score = 0.4919
2024-03-16 12:34:38,567 - ***** Epoch: 18: Eval results *****
2024-03-16 12:34:38,568 -   train_loss = 0.6521
2024-03-16 12:34:38,568 -   best_eval_score = 0.4919
2024-03-16 12:34:38,568 -   eval_score = 0.5
2024-03-16 12:35:11,629 - ***** Epoch: 19: Eval results *****
2024-03-16 12:35:11,630 -   train_loss = 0.5867
2024-03-16 12:35:11,630 -   best_eval_score = 0.5
2024-03-16 12:35:11,630 -   eval_score = 0.4979
2024-03-16 12:35:11,630 - EarlyStopping counter: 1 out of 8
2024-03-16 12:35:48,669 - ***** Epoch: 20: Eval results *****
2024-03-16 12:35:48,669 -   train_loss = 0.532
2024-03-16 12:35:48,669 -   best_eval_score = 0.5
2024-03-16 12:35:48,669 -   eval_score = 0.498
2024-03-16 12:35:48,670 - EarlyStopping counter: 2 out of 8
2024-03-16 12:36:23,309 - ***** Epoch: 21: Eval results *****
2024-03-16 12:36:23,309 -   train_loss = 0.4816
2024-03-16 12:36:23,309 -   best_eval_score = 0.5
2024-03-16 12:36:23,309 -   eval_score = 0.4908
2024-03-16 12:36:23,309 - EarlyStopping counter: 3 out of 8
2024-03-16 12:37:00,312 - ***** Epoch: 22: Eval results *****
2024-03-16 12:37:00,313 -   train_loss = 0.4348
2024-03-16 12:37:00,313 -   best_eval_score = 0.5
2024-03-16 12:37:00,314 -   eval_score = 0.4925
2024-03-16 12:37:00,314 - EarlyStopping counter: 4 out of 8
2024-03-16 12:37:36,795 - ***** Epoch: 23: Eval results *****
2024-03-16 12:37:36,795 -   train_loss = 0.3953
2024-03-16 12:37:36,795 -   best_eval_score = 0.5
2024-03-16 12:37:36,795 -   eval_score = 0.4979
2024-03-16 12:37:36,795 - EarlyStopping counter: 5 out of 8
2024-03-16 12:38:11,673 - ***** Epoch: 24: Eval results *****
2024-03-16 12:38:11,673 -   train_loss = 0.3613
2024-03-16 12:38:11,673 -   best_eval_score = 0.5
2024-03-16 12:38:11,673 -   eval_score = 0.4879
2024-03-16 12:38:11,673 - EarlyStopping counter: 6 out of 8
2024-03-16 12:38:47,215 - ***** Epoch: 25: Eval results *****
2024-03-16 12:38:47,215 -   train_loss = 0.3348
2024-03-16 12:38:47,215 -   best_eval_score = 0.5
2024-03-16 12:38:47,215 -   eval_score = 0.5023
2024-03-16 12:39:22,328 - ***** Epoch: 26: Eval results *****
2024-03-16 12:39:22,329 -   train_loss = 0.2931
2024-03-16 12:39:22,329 -   best_eval_score = 0.5023
2024-03-16 12:39:22,329 -   eval_score = 0.4961
2024-03-16 12:39:22,330 - EarlyStopping counter: 1 out of 8
2024-03-16 12:39:58,153 - ***** Epoch: 27: Eval results *****
2024-03-16 12:39:58,154 -   train_loss = 0.2722
2024-03-16 12:39:58,154 -   best_eval_score = 0.5023
2024-03-16 12:39:58,154 -   eval_score = 0.4861
2024-03-16 12:39:58,154 - EarlyStopping counter: 2 out of 8
2024-03-16 12:40:32,265 - ***** Epoch: 28: Eval results *****
2024-03-16 12:40:32,265 -   train_loss = 0.2462
2024-03-16 12:40:32,265 -   best_eval_score = 0.5023
2024-03-16 12:40:32,265 -   eval_score = 0.5057
2024-03-16 12:41:10,634 - ***** Epoch: 29: Eval results *****
2024-03-16 12:41:10,635 -   train_loss = 0.23
2024-03-16 12:41:10,635 -   best_eval_score = 0.5057
2024-03-16 12:41:10,635 -   eval_score = 0.4877
2024-03-16 12:41:10,635 - EarlyStopping counter: 1 out of 8
2024-03-16 12:41:44,254 - ***** Epoch: 30: Eval results *****
2024-03-16 12:41:44,254 -   train_loss = 0.215
2024-03-16 12:41:44,255 -   best_eval_score = 0.5057
2024-03-16 12:41:44,255 -   eval_score = 0.4897
2024-03-16 12:41:44,255 - EarlyStopping counter: 2 out of 8
2024-03-16 12:42:21,479 - ***** Epoch: 31: Eval results *****
2024-03-16 12:42:21,479 -   train_loss = 0.1893
2024-03-16 12:42:21,479 -   best_eval_score = 0.5057
2024-03-16 12:42:21,479 -   eval_score = 0.5015
2024-03-16 12:42:21,479 - EarlyStopping counter: 3 out of 8
2024-03-16 12:42:55,935 - ***** Epoch: 32: Eval results *****
2024-03-16 12:42:55,935 -   train_loss = 0.1769
2024-03-16 12:42:55,935 -   best_eval_score = 0.5057
2024-03-16 12:42:55,935 -   eval_score = 0.4826
2024-03-16 12:42:55,936 - EarlyStopping counter: 4 out of 8
2024-03-16 12:43:32,534 - ***** Epoch: 33: Eval results *****
2024-03-16 12:43:32,535 -   train_loss = 0.1693
2024-03-16 12:43:32,535 -   best_eval_score = 0.5057
2024-03-16 12:43:32,535 -   eval_score = 0.4915
2024-03-16 12:43:32,535 - EarlyStopping counter: 5 out of 8
2024-03-16 12:44:07,526 - ***** Epoch: 34: Eval results *****
2024-03-16 12:44:07,526 -   train_loss = 0.1534
2024-03-16 12:44:07,527 -   best_eval_score = 0.5057
2024-03-16 12:44:07,527 -   eval_score = 0.4952
2024-03-16 12:44:07,527 - EarlyStopping counter: 6 out of 8
2024-03-16 12:44:42,426 - ***** Epoch: 35: Eval results *****
2024-03-16 12:44:42,426 -   train_loss = 0.1422
2024-03-16 12:44:42,426 -   best_eval_score = 0.5057
2024-03-16 12:44:42,426 -   eval_score = 0.5062
2024-03-16 12:45:18,693 - ***** Epoch: 36: Eval results *****
2024-03-16 12:45:18,694 -   train_loss = 0.13
2024-03-16 12:45:18,694 -   best_eval_score = 0.5062
2024-03-16 12:45:18,694 -   eval_score = 0.4928
2024-03-16 12:45:18,694 - EarlyStopping counter: 1 out of 8
2024-03-16 12:45:51,878 - ***** Epoch: 37: Eval results *****
2024-03-16 12:45:51,879 -   train_loss = 0.1275
2024-03-16 12:45:51,879 -   best_eval_score = 0.5062
2024-03-16 12:45:51,879 -   eval_score = 0.496
2024-03-16 12:45:51,880 - EarlyStopping counter: 2 out of 8
2024-03-16 12:46:29,448 - ***** Epoch: 38: Eval results *****
2024-03-16 12:46:29,448 -   train_loss = 0.1148
2024-03-16 12:46:29,448 -   best_eval_score = 0.5062
2024-03-16 12:46:29,448 -   eval_score = 0.4831
2024-03-16 12:46:29,448 - EarlyStopping counter: 3 out of 8
2024-03-16 12:47:04,162 - ***** Epoch: 39: Eval results *****
2024-03-16 12:47:04,162 -   train_loss = 0.118
2024-03-16 12:47:04,163 -   best_eval_score = 0.5062
2024-03-16 12:47:04,163 -   eval_score = 0.4922
2024-03-16 12:47:04,163 - EarlyStopping counter: 4 out of 8
2024-03-16 12:47:41,772 - ***** Epoch: 40: Eval results *****
2024-03-16 12:47:41,772 -   train_loss = 0.1044
2024-03-16 12:47:41,772 -   best_eval_score = 0.5062
2024-03-16 12:47:41,772 -   eval_score = 0.4885
2024-03-16 12:47:41,772 - EarlyStopping counter: 5 out of 8
2024-03-16 12:48:15,477 - ***** Epoch: 41: Eval results *****
2024-03-16 12:48:15,478 -   train_loss = 0.1033
2024-03-16 12:48:15,478 -   best_eval_score = 0.5062
2024-03-16 12:48:15,478 -   eval_score = 0.4936
2024-03-16 12:48:15,478 - EarlyStopping counter: 6 out of 8
2024-03-16 12:48:52,409 - ***** Epoch: 42: Eval results *****
2024-03-16 12:48:52,409 -   train_loss = 0.0944
2024-03-16 12:48:52,409 -   best_eval_score = 0.5062
2024-03-16 12:48:52,409 -   eval_score = 0.4992
2024-03-16 12:48:52,409 - EarlyStopping counter: 7 out of 8
2024-03-16 12:49:26,816 - ***** Epoch: 43: Eval results *****
2024-03-16 12:49:26,816 -   train_loss = 0.0934
2024-03-16 12:49:26,817 -   best_eval_score = 0.5062
2024-03-16 12:49:26,817 -   eval_score = 0.4863
2024-03-16 12:49:26,817 - EarlyStopping counter: 8 out of 8
2024-03-16 12:49:26,817 - EarlyStopping at epoch 43
2024-03-16 12:49:26,818 - Training is finished...
2024-03-16 12:49:26,819 - Testing begins...
2024-03-16 12:49:33,266 - ***** Test: Confusion Matrix *****
2024-03-16 12:49:33,268 - [[ 46   0  17   0   0   0   0   0   1   0   2   0   0   1   0   0   0   0
    0   0   0   0   0   1   0   0   0   0   0   0]
 [  0  53   2   0   9   1   3   0   1   0   2   0   3   0   5   0   0   8
    2   2   0   2   0   0   2   0   0   2   0   0]
 [  7   0  46   0   1   0   0   0   0   0   1   0   0   0   0   0   0   3
    0   0   0   2   0   2   2   0   0   0   0   0]
 [  0   0   0  62   0   0   0   1   0   0   0   0   0   0   2   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   4   0   0  27   1   0   0   1   0   0   0   0   0   0   0   0   8
    0   4   0   1   0   1   1   1   0   0   1   1]
 [  0   0   0   0   1  26   0   0   0   1   1   0   0   0   1   0   0   3
    1   0   0   0   0   1   0   1   1   0   0   0]
 [  0   1   0   0   0   3  29   7   0   1   1   0   5   0   0   0   0   0
    0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   2   0   0   0   1   4  23   0   0   6   0   5   0   0   0   3   0
    0   1   0   0   0   0   0   0   0   2   0   0]
 [  1   2   3   2   1   0   0   0  24   1   0   1   1   1   3   0   0   5
    0   1   0   0   1   0   2   0   0   0   0   0]
 [  0   2   1   1   1   0   1   0   1  48   0   4   9   1  13   1   0   6
    2   0   0   4   2   1   4   1   0   3   0   1]
 [  2   0   0   0   0   4   4   2   0   1  41   0  30   0   3   0   1   1
    0   2   0   1   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   0   5   0  20   8   1   1   0   0   3
    1   0   0   0   3   0   1   0   0   2   0   1]
 [  0   2   1   0   0   3   6  10   0   3  20   1  84   0   0   0   3   0
    0   1   0   0   1   0   0   0   0   0   0   0]
 [  0   0   2   0   1   0   0   0   0   1   0   0   0   2   4   1   0   3
    1   0   1   0   1   0   0   0   0   0   0   0]
 [  0   2   2   2   0   2   1   0   2  10   2   0   2   2 101   2   0  36
    5   1   1   0  12   0   5   0   0   3   0   0]
 [  0   0   2   0   0   0   0   0   0   5   0   0   0   1   1   4   0   1
    2   0   1   2   2   0   0   0   0   1   0   0]
 [  0   0   0   0   1   0   0   0   0   0   2   0   1   0   0   0  58   1
    3   0   0   0   0   0   0   0   0   0   0   0]
 [  1   3   2   0   7   2   0   0   2  10   1   0   1   4  19   2   1 118
   10   3   1   4   6  10   2   2   2   0   1   3]
 [  0   2   1   0   0   0   1   0   0   3   1   0   0   3   7   0   3   5
   28   1   2   0   0   0   3   0   0   0   0   0]
 [  0   5   0   0   1   0   2   0   0   0   1   0   0   0   0   0   0   0
    0   6   0   2   0   0   0   0   0   0   0   0]
 [  0   3   2   0   0   0   0   0   0   1   0   0   1   0   5   0   0   2
    5   0   4   0   0   1   2   0   0   2   0   1]
 [  7   1   0   0   1   0   0   0   0   5   0   0   0   0   1   0   4   1
    0   0   0  26   0   2   0   0   1   2   0   2]
 [  0   1   2   1   0   0   0   0   1   1   0   2   0   0   8   1   0   4
    0   0   0   0  83   0   2   5   6   0   0   0]
 [  0   2   2   0   1   0   0   0   0   0   0   0   0   0   1   0   0  10
    0   0   0   4   0  18   0   0   0   0   0   0]
 [  2   0   2   0   0   0   1   0   0   3   0   1   0   2   2   0   0   3
    2   0   0   0   1   0  89   0   0   2   3   0]
 [  1   0   0   0   0   0   0   1   0   0   0   0   0   0   0   0   0   2
    0   0   0   1   2   0   0  20   0   1   0   3]
 [  0   0   0   1   0   0   0   0   0   1   0   0   0   0   1   0   0   3
    0   0   0   1   3   0   0   0   7   0   0   0]
 [  0   3   3   0   0   0   0   1   1   4   2   5   3   1   4   0   0   4
    2   0   1   0   2   0   9   3   0   7   1   2]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
    0   0   0   0   0   0   0   0   1   0  56   0]
 [  0   1   0   0   0   0   0   0   1   2   1   1   0   0   0   0   0   4
    2   0   0   0   0   0   1   1   0   1   0   4]]
2024-03-16 12:49:33,268 - ***** Evaluation results *****
2024-03-16 12:49:33,268 -   acc = 0.5706
2024-03-16 12:49:33,268 -   f1 = 0.5176
2024-03-16 12:49:33,268 -   prec = 0.5248
2024-03-16 12:49:33,268 -   rec = 0.5222
2024-03-16 12:49:33,268 - Testing is finished...
2024-03-16 12:49:33,268 - Multimodal intent recognition is finished...
2024-03-16 12:49:33,268 - Results are saved in results/mag_bert.csv
