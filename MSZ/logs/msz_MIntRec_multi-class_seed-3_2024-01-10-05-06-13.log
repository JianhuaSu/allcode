2024-01-10 05:06:13,560 - ============================== Params ==============================
2024-01-10 05:06:13,560 - logger_name: msz_MIntRec_multi-class_seed-3_2024-01-10-05-06-13
2024-01-10 05:06:13,561 - dataset: MIntRec
2024-01-10 05:06:13,561 - data_mode: multi-class
2024-01-10 05:06:13,561 - method: msz
2024-01-10 05:06:13,561 - text_backbone: bert-base-uncased
2024-01-10 05:06:13,561 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-10 05:06:13,561 - seed: 3
2024-01-10 05:06:13,561 - num_workers: 8
2024-01-10 05:06:13,561 - gpu_id: 1
2024-01-10 05:06:13,561 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-10 05:06:13,561 - train: True
2024-01-10 05:06:13,561 - tune: False
2024-01-10 05:06:13,561 - save_model: False
2024-01-10 05:06:13,561 - save_results: True
2024-01-10 05:06:13,561 - log_path: logs
2024-01-10 05:06:13,561 - cache_path: 
2024-01-10 05:06:13,561 - video_data_path: video_data
2024-01-10 05:06:13,561 - audio_data_path: audio_data
2024-01-10 05:06:13,561 - video_feats_path: video_feats.pkl
2024-01-10 05:06:13,561 - audio_feats_path: audio_feats.pkl
2024-01-10 05:06:13,561 - results_path: results
2024-01-10 05:06:13,561 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-10 05:06:13,561 - model_path: models
2024-01-10 05:06:13,561 - config_file_name: msz
2024-01-10 05:06:13,561 - results_file_name: msz.csv
2024-01-10 05:06:13,561 - padding_mode: zero
2024-01-10 05:06:13,561 - padding_loc: end
2024-01-10 05:06:13,561 - need_aligned: False
2024-01-10 05:06:13,561 - eval_monitor: f1
2024-01-10 05:06:13,561 - train_batch_size: 16
2024-01-10 05:06:13,561 - eval_batch_size: 8
2024-01-10 05:06:13,561 - test_batch_size: 8
2024-01-10 05:06:13,561 - wait_patience: 8
2024-01-10 05:06:13,561 - nheads: 12
2024-01-10 05:06:13,561 - encoder_layers: 6
2024-01-10 05:06:13,562 - attn_dropout: 0.1
2024-01-10 05:06:13,562 - relu_dropout: 0.1
2024-01-10 05:06:13,562 - embed_dropout: 0.1
2024-01-10 05:06:13,562 - res_dropout: 0.1
2024-01-10 05:06:13,562 - attn_mask: False
2024-01-10 05:06:13,562 - hidden_size: 768
2024-01-10 05:06:13,562 - num_attention_heads: 12
2024-01-10 05:06:13,562 - attention_probs_dropout_prob: 0.1
2024-01-10 05:06:13,562 - hidden_dropout_prob: 0.1
2024-01-10 05:06:13,562 - intermediate_size: 768
2024-01-10 05:06:13,562 - num_hidden_layers: 6
2024-01-10 05:06:13,562 - max_position_embeddings: 768
2024-01-10 05:06:13,562 - position_embedding_type: absolute
2024-01-10 05:06:13,562 - batch_first: True
2024-01-10 05:06:13,562 - hidden_dims: 768
2024-01-10 05:06:13,562 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-10 05:06:13,562 - spe_dropouts: [0.2, 0.1, 0.1]
2024-01-10 05:06:13,562 - aligned_method: conv1d
2024-01-10 05:06:13,562 - grad_clip: 2
2024-01-10 05:06:13,562 - num_train_epochs: 100
2024-01-10 05:06:13,562 - warmup_proportion: 0.1
2024-01-10 05:06:13,562 - lr: 2e-05
2024-01-10 05:06:13,562 - weight_decay: 0.01
2024-01-10 05:06:13,562 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2024-01-10-05-06-13
2024-01-10 05:06:13,562 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2024-01-10-05-06-13/models
2024-01-10 05:06:13,562 - ============================== End Params ==============================
2024-01-10 05:06:13,565 - Generate Text Features Begin...
2024-01-10 05:06:14,072 - Generate Text Features Finished...
2024-01-10 05:06:14,072 - Load Video Features Begin...
2024-01-10 05:06:14,417 - Load Video Features Finished...
2024-01-10 05:06:15,104 - Load Audio Features Begin...
2024-01-10 05:06:16,242 - Load Audio Features Finished...
2024-01-10 05:06:20,166 - method  begins...
2024-01-10 05:06:25,826 - Multimodal intent recognition begins...
2024-01-10 05:06:25,826 - Training begins...
2024-01-10 05:07:13,115 - ***** Epoch: 1: Eval results *****
2024-01-10 05:07:13,116 -   train_loss = 2.9957
2024-01-10 05:07:13,116 -   best_eval_score = 0.0
2024-01-10 05:07:13,116 -   eval_score = 0.0146
2024-01-10 05:07:58,918 - ***** Epoch: 2: Eval results *****
2024-01-10 05:07:58,918 -   train_loss = 2.9957
2024-01-10 05:07:58,918 -   best_eval_score = 0.0146
2024-01-10 05:07:58,918 -   eval_score = 0.0269
2024-01-10 05:08:44,631 - ***** Epoch: 3: Eval results *****
2024-01-10 05:08:44,633 -   train_loss = 2.9957
2024-01-10 05:08:44,633 -   best_eval_score = 0.0269
2024-01-10 05:08:44,633 -   eval_score = 0.0219
2024-01-10 05:08:44,633 - EarlyStopping counter: 1 out of 8
2024-01-10 05:09:29,894 - ***** Epoch: 4: Eval results *****
2024-01-10 05:09:29,894 -   train_loss = 2.9957
2024-01-10 05:09:29,894 -   best_eval_score = 0.0269
2024-01-10 05:09:29,894 -   eval_score = 0.0329
2024-01-10 05:10:15,240 - ***** Epoch: 5: Eval results *****
2024-01-10 05:10:15,241 -   train_loss = 2.9957
2024-01-10 05:10:15,241 -   best_eval_score = 0.0329
2024-01-10 05:10:15,241 -   eval_score = 0.0346
2024-01-10 05:11:00,656 - ***** Epoch: 6: Eval results *****
2024-01-10 05:11:00,656 -   train_loss = 2.9957
2024-01-10 05:11:00,656 -   best_eval_score = 0.0346
2024-01-10 05:11:00,656 -   eval_score = 0.0258
2024-01-10 05:11:00,656 - EarlyStopping counter: 1 out of 8
2024-01-10 05:11:46,176 - ***** Epoch: 7: Eval results *****
2024-01-10 05:11:46,177 -   train_loss = 2.9957
2024-01-10 05:11:46,177 -   best_eval_score = 0.0346
2024-01-10 05:11:46,177 -   eval_score = 0.0289
2024-01-10 05:11:46,177 - EarlyStopping counter: 2 out of 8
2024-01-10 05:12:31,339 - ***** Epoch: 8: Eval results *****
2024-01-10 05:12:31,339 -   train_loss = 2.9957
2024-01-10 05:12:31,339 -   best_eval_score = 0.0346
2024-01-10 05:12:31,339 -   eval_score = 0.0287
2024-01-10 05:12:31,339 - EarlyStopping counter: 3 out of 8
2024-01-10 05:13:16,947 - ***** Epoch: 9: Eval results *****
2024-01-10 05:13:16,947 -   train_loss = 2.9957
2024-01-10 05:13:16,947 -   best_eval_score = 0.0346
2024-01-10 05:13:16,947 -   eval_score = 0.0351
2024-01-10 05:14:02,254 - ***** Epoch: 10: Eval results *****
2024-01-10 05:14:02,254 -   train_loss = 2.9957
2024-01-10 05:14:02,254 -   best_eval_score = 0.0351
2024-01-10 05:14:02,254 -   eval_score = 0.0337
2024-01-10 05:14:02,254 - EarlyStopping counter: 1 out of 8
2024-01-10 05:14:47,271 - ***** Epoch: 11: Eval results *****
2024-01-10 05:14:47,271 -   train_loss = 2.9957
2024-01-10 05:14:47,271 -   best_eval_score = 0.0351
2024-01-10 05:14:47,271 -   eval_score = 0.0344
2024-01-10 05:14:47,271 - EarlyStopping counter: 2 out of 8
2024-01-10 05:15:32,078 - ***** Epoch: 12: Eval results *****
2024-01-10 05:15:32,078 -   train_loss = 2.9957
2024-01-10 05:15:32,078 -   best_eval_score = 0.0351
2024-01-10 05:15:32,078 -   eval_score = 0.0376
2024-01-10 05:16:17,346 - ***** Epoch: 13: Eval results *****
2024-01-10 05:16:17,346 -   train_loss = 2.9957
2024-01-10 05:16:17,346 -   best_eval_score = 0.0376
2024-01-10 05:16:17,346 -   eval_score = 0.0363
2024-01-10 05:16:17,346 - EarlyStopping counter: 1 out of 8
2024-01-10 05:17:02,984 - ***** Epoch: 14: Eval results *****
2024-01-10 05:17:02,985 -   train_loss = 2.9957
2024-01-10 05:17:02,985 -   best_eval_score = 0.0376
2024-01-10 05:17:02,985 -   eval_score = 0.0412
2024-01-10 05:17:49,247 - ***** Epoch: 15: Eval results *****
2024-01-10 05:17:49,247 -   train_loss = 2.9957
2024-01-10 05:17:49,247 -   best_eval_score = 0.0412
2024-01-10 05:17:49,247 -   eval_score = 0.0474
2024-01-10 05:18:34,618 - ***** Epoch: 16: Eval results *****
2024-01-10 05:18:34,618 -   train_loss = 2.9957
2024-01-10 05:18:34,618 -   best_eval_score = 0.0474
2024-01-10 05:18:34,618 -   eval_score = 0.0525
2024-01-10 05:19:19,990 - ***** Epoch: 17: Eval results *****
2024-01-10 05:19:19,990 -   train_loss = 2.9957
2024-01-10 05:19:19,991 -   best_eval_score = 0.0525
2024-01-10 05:19:19,991 -   eval_score = 0.0402
2024-01-10 05:19:19,991 - EarlyStopping counter: 1 out of 8
2024-01-10 05:20:05,379 - ***** Epoch: 18: Eval results *****
2024-01-10 05:20:05,379 -   train_loss = 2.9957
2024-01-10 05:20:05,379 -   best_eval_score = 0.0525
2024-01-10 05:20:05,379 -   eval_score = 0.039
2024-01-10 05:20:05,379 - EarlyStopping counter: 2 out of 8
2024-01-10 05:20:50,678 - ***** Epoch: 19: Eval results *****
2024-01-10 05:20:50,678 -   train_loss = 2.9957
2024-01-10 05:20:50,678 -   best_eval_score = 0.0525
2024-01-10 05:20:50,678 -   eval_score = 0.0317
2024-01-10 05:20:50,678 - EarlyStopping counter: 3 out of 8
2024-01-10 05:21:35,791 - ***** Epoch: 20: Eval results *****
2024-01-10 05:21:35,791 -   train_loss = 2.9957
2024-01-10 05:21:35,791 -   best_eval_score = 0.0525
2024-01-10 05:21:35,791 -   eval_score = 0.0377
2024-01-10 05:21:35,792 - EarlyStopping counter: 4 out of 8
2024-01-10 05:22:21,071 - ***** Epoch: 21: Eval results *****
2024-01-10 05:22:21,071 -   train_loss = 2.9957
2024-01-10 05:22:21,071 -   best_eval_score = 0.0525
2024-01-10 05:22:21,071 -   eval_score = 0.0342
2024-01-10 05:22:21,071 - EarlyStopping counter: 5 out of 8
2024-01-10 05:23:07,224 - ***** Epoch: 22: Eval results *****
2024-01-10 05:23:07,224 -   train_loss = 2.9957
2024-01-10 05:23:07,224 -   best_eval_score = 0.0525
2024-01-10 05:23:07,224 -   eval_score = 0.0366
2024-01-10 05:23:07,224 - EarlyStopping counter: 6 out of 8
2024-01-10 05:23:52,616 - ***** Epoch: 23: Eval results *****
2024-01-10 05:23:52,616 -   train_loss = 2.9957
2024-01-10 05:23:52,616 -   best_eval_score = 0.0525
2024-01-10 05:23:52,616 -   eval_score = 0.0378
2024-01-10 05:23:52,616 - EarlyStopping counter: 7 out of 8
2024-01-10 05:24:37,963 - ***** Epoch: 24: Eval results *****
2024-01-10 05:24:37,964 -   train_loss = 2.9957
2024-01-10 05:24:37,964 -   best_eval_score = 0.0525
2024-01-10 05:24:37,964 -   eval_score = 0.037
2024-01-10 05:24:37,964 - EarlyStopping counter: 8 out of 8
2024-01-10 05:24:37,964 - EarlyStopping at epoch 24
2024-01-10 05:24:37,970 - Training is finished...
2024-01-10 05:24:37,971 - Testing begins...
2024-01-10 05:24:43,916 - ***** Test: Confusion Matrix *****
2024-01-10 05:24:43,917 - [[2 5 3 2 1 2 5 6 1 0 5 2 4 0 3 4 5 2 1 4]
 [1 5 4 4 0 3 2 3 4 0 1 1 4 0 1 2 5 0 3 0]
 [0 2 4 1 0 2 0 2 4 0 1 0 5 1 0 0 0 0 4 1]
 [1 3 5 1 1 1 0 0 4 0 0 1 0 1 0 0 2 1 3 1]
 [1 1 1 0 1 0 2 4 3 0 3 0 2 0 0 0 3 0 1 1]
 [0 1 1 0 0 0 0 3 0 0 0 0 2 1 0 1 0 0 2 1]
 [1 0 0 0 0 0 3 1 0 0 2 1 3 0 1 0 0 0 0 0]
 [0 2 0 1 1 0 0 0 1 0 1 0 0 0 1 0 1 0 1 1]
 [1 2 0 0 1 0 0 1 0 0 0 0 0 1 0 0 4 0 0 0]
 [1 0 0 0 1 0 1 1 1 0 0 0 1 0 1 1 2 0 0 0]
 [2 1 0 2 0 0 1 2 0 0 2 0 4 0 1 1 1 0 1 0]
 [0 0 2 0 0 3 0 7 0 1 0 1 4 0 0 0 1 0 0 0]
 [2 2 9 4 2 3 1 8 3 0 3 0 3 2 1 2 4 1 6 1]
 [0 1 2 0 0 2 2 1 0 0 3 3 4 0 1 1 1 0 3 1]
 [2 2 1 0 1 1 1 4 0 1 1 0 3 0 0 1 2 0 2 0]
 [1 4 1 1 0 1 0 1 5 3 0 0 1 0 0 0 1 1 0 1]
 [1 3 2 0 0 0 1 2 0 0 0 0 2 0 2 1 0 1 2 0]
 [0 1 0 0 2 1 1 2 0 0 0 0 2 0 1 1 0 0 3 1]
 [0 0 1 0 0 0 0 0 1 0 0 0 3 0 2 1 1 0 3 0]
 [1 0 1 1 0 0 1 3 1 0 0 1 0 0 0 1 0 0 0 0]]
2024-01-10 05:24:43,917 - ***** Evaluation results *****
2024-01-10 05:24:43,917 -   acc = 0.0562
2024-01-10 05:24:43,917 -   f1 = 0.0475
2024-01-10 05:24:43,917 -   prec = 0.0501
2024-01-10 05:24:43,917 -   rec = 0.055
2024-01-10 05:24:43,917 - Testing is finished...
2024-01-10 05:24:43,917 - Multimodal intent recognition is finished...
2024-01-10 05:24:43,917 - Results are saved in results/msz.csv
