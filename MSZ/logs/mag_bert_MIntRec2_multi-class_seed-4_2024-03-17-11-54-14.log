2024-03-17 11:54:14,117 - ============================== Params ==============================
2024-03-17 11:54:14,117 - logger_name: mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-11-54-14
2024-03-17 11:54:14,117 - dataset: MIntRec2
2024-03-17 11:54:14,117 - data_mode: multi-class
2024-03-17 11:54:14,117 - method: mag_bert
2024-03-17 11:54:14,117 - text_backbone: bert-base-uncased
2024-03-17 11:54:14,117 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-17 11:54:14,118 - seed: 4
2024-03-17 11:54:14,118 - num_workers: 8
2024-03-17 11:54:14,118 - gpu_id: 2
2024-03-17 11:54:14,118 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-17 11:54:14,118 - train: True
2024-03-17 11:54:14,118 - tune: True
2024-03-17 11:54:14,118 - save_model: False
2024-03-17 11:54:14,118 - save_results: True
2024-03-17 11:54:14,118 - log_path: logs
2024-03-17 11:54:14,118 - cache_path: 
2024-03-17 11:54:14,118 - video_data_path: video_data
2024-03-17 11:54:14,118 - audio_data_path: audio_data
2024-03-17 11:54:14,118 - video_feats_path: video_feats.pkl
2024-03-17 11:54:14,118 - audio_feats_path: audio_feats.pkl
2024-03-17 11:54:14,118 - results_path: results
2024-03-17 11:54:14,118 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-17 11:54:14,118 - model_path: models
2024-03-17 11:54:14,118 - config_file_name: mag_bert_MIntRec2
2024-03-17 11:54:14,118 - results_file_name: mag_bert.csv
2024-03-17 11:54:14,118 - padding_mode: zero
2024-03-17 11:54:14,118 - padding_loc: end
2024-03-17 11:54:14,118 - need_aligned: True
2024-03-17 11:54:14,118 - eval_monitor: f1
2024-03-17 11:54:14,118 - train_batch_size: 32
2024-03-17 11:54:14,118 - eval_batch_size: 16
2024-03-17 11:54:14,118 - test_batch_size: 16
2024-03-17 11:54:14,118 - wait_patience: 8
2024-03-17 11:54:14,118 - num_train_epochs: 100
2024-03-17 11:54:14,118 - beta_shift: 0.01
2024-03-17 11:54:14,118 - dropout_prob: 0.3
2024-03-17 11:54:14,118 - warmup_proportion: 0.05
2024-03-17 11:54:14,118 - lr: 9e-06
2024-03-17 11:54:14,118 - aligned_method: ctc
2024-03-17 11:54:14,118 - weight_decay: 0.01
2024-03-17 11:54:14,118 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-11-54-14
2024-03-17 11:54:14,118 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-11-54-14/models
2024-03-17 11:54:14,118 - num_labels: 30
2024-03-17 11:54:14,118 - text_feat_dim: 768
2024-03-17 11:54:14,119 - video_feat_dim: 256
2024-03-17 11:54:14,119 - audio_feat_dim: 768
2024-03-17 11:54:14,119 - text_seq_len: 50
2024-03-17 11:54:14,119 - video_seq_len: 180
2024-03-17 11:54:14,119 - audio_seq_len: 400
2024-03-17 11:54:14,119 - device: cuda:2
2024-03-17 11:54:14,119 - ============================== End Params ==============================
2024-03-17 11:54:14,134 - Generate Text Features Begin...
2024-03-17 11:54:16,112 - Generate Text Features Finished...
2024-03-17 11:54:16,114 - Load Video Features Begin...
2024-03-17 11:54:17,292 - Load Video Features Finished...
2024-03-17 11:54:18,965 - Load Audio Features Begin...
2024-03-17 11:54:23,013 - Load Audio Features Finished...
2024-03-17 11:54:33,910 - method  begins...
2024-03-17 11:54:34,792 - Multimodal intent recognition begins...
2024-03-17 11:54:34,792 - Training begins...
2024-03-17 11:55:11,482 - ***** Epoch: 1: Eval results *****
2024-03-17 11:55:11,482 -   train_loss = 3.2909
2024-03-17 11:55:11,482 -   best_eval_score = 0.0
2024-03-17 11:55:11,482 -   eval_score = 0.048
2024-03-17 11:55:48,555 - ***** Epoch: 2: Eval results *****
2024-03-17 11:55:48,555 -   train_loss = 2.8875
2024-03-17 11:55:48,555 -   best_eval_score = 0.048
2024-03-17 11:55:48,555 -   eval_score = 0.1505
2024-03-17 11:56:26,161 - ***** Epoch: 3: Eval results *****
2024-03-17 11:56:26,162 -   train_loss = 2.4389
2024-03-17 11:56:26,162 -   best_eval_score = 0.1505
2024-03-17 11:56:26,162 -   eval_score = 0.2721
2024-03-17 11:57:03,985 - ***** Epoch: 4: Eval results *****
2024-03-17 11:57:03,986 -   train_loss = 2.0115
2024-03-17 11:57:03,986 -   best_eval_score = 0.2721
2024-03-17 11:57:03,986 -   eval_score = 0.3267
2024-03-17 11:57:37,213 - ***** Epoch: 5: Eval results *****
2024-03-17 11:57:37,213 -   train_loss = 1.6988
2024-03-17 11:57:37,213 -   best_eval_score = 0.3267
2024-03-17 11:57:37,213 -   eval_score = 0.3782
2024-03-17 11:58:14,907 - ***** Epoch: 6: Eval results *****
2024-03-17 11:58:14,907 -   train_loss = 1.4688
2024-03-17 11:58:14,907 -   best_eval_score = 0.3782
2024-03-17 11:58:14,907 -   eval_score = 0.4189
2024-03-17 11:58:50,982 - ***** Epoch: 7: Eval results *****
2024-03-17 11:58:50,983 -   train_loss = 1.2841
2024-03-17 11:58:50,983 -   best_eval_score = 0.4189
2024-03-17 11:58:50,983 -   eval_score = 0.4463
2024-03-17 11:59:27,769 - ***** Epoch: 8: Eval results *****
2024-03-17 11:59:27,769 -   train_loss = 1.1209
2024-03-17 11:59:27,770 -   best_eval_score = 0.4463
2024-03-17 11:59:27,770 -   eval_score = 0.4723
2024-03-17 12:00:06,504 - ***** Epoch: 9: Eval results *****
2024-03-17 12:00:06,504 -   train_loss = 0.9899
2024-03-17 12:00:06,505 -   best_eval_score = 0.4723
2024-03-17 12:00:06,505 -   eval_score = 0.4674
2024-03-17 12:00:06,505 - EarlyStopping counter: 1 out of 8
2024-03-17 12:00:42,648 - ***** Epoch: 10: Eval results *****
2024-03-17 12:00:42,649 -   train_loss = 0.8637
2024-03-17 12:00:42,649 -   best_eval_score = 0.4723
2024-03-17 12:00:42,649 -   eval_score = 0.4714
2024-03-17 12:00:42,649 - EarlyStopping counter: 2 out of 8
2024-03-17 12:01:21,329 - ***** Epoch: 11: Eval results *****
2024-03-17 12:01:21,329 -   train_loss = 0.7635
2024-03-17 12:01:21,329 -   best_eval_score = 0.4723
2024-03-17 12:01:21,330 -   eval_score = 0.484
2024-03-17 12:02:00,175 - ***** Epoch: 12: Eval results *****
2024-03-17 12:02:00,176 -   train_loss = 0.66
2024-03-17 12:02:00,176 -   best_eval_score = 0.484
2024-03-17 12:02:00,176 -   eval_score = 0.498
2024-03-17 12:02:37,544 - ***** Epoch: 13: Eval results *****
2024-03-17 12:02:37,544 -   train_loss = 0.5822
2024-03-17 12:02:37,544 -   best_eval_score = 0.498
2024-03-17 12:02:37,544 -   eval_score = 0.4941
2024-03-17 12:02:37,545 - EarlyStopping counter: 1 out of 8
2024-03-17 12:03:13,662 - ***** Epoch: 14: Eval results *****
2024-03-17 12:03:13,662 -   train_loss = 0.5023
2024-03-17 12:03:13,662 -   best_eval_score = 0.498
2024-03-17 12:03:13,662 -   eval_score = 0.4938
2024-03-17 12:03:13,662 - EarlyStopping counter: 2 out of 8
2024-03-17 12:03:48,789 - ***** Epoch: 15: Eval results *****
2024-03-17 12:03:48,790 -   train_loss = 0.4411
2024-03-17 12:03:48,790 -   best_eval_score = 0.498
2024-03-17 12:03:48,790 -   eval_score = 0.5015
2024-03-17 12:04:23,804 - ***** Epoch: 16: Eval results *****
2024-03-17 12:04:23,804 -   train_loss = 0.4002
2024-03-17 12:04:23,805 -   best_eval_score = 0.5015
2024-03-17 12:04:23,805 -   eval_score = 0.4945
2024-03-17 12:04:23,805 - EarlyStopping counter: 1 out of 8
2024-03-17 12:04:59,561 - ***** Epoch: 17: Eval results *****
2024-03-17 12:04:59,561 -   train_loss = 0.338
2024-03-17 12:04:59,561 -   best_eval_score = 0.5015
2024-03-17 12:04:59,562 -   eval_score = 0.4912
2024-03-17 12:04:59,562 - EarlyStopping counter: 2 out of 8
2024-03-17 12:05:35,054 - ***** Epoch: 18: Eval results *****
2024-03-17 12:05:35,054 -   train_loss = 0.3073
2024-03-17 12:05:35,054 -   best_eval_score = 0.5015
2024-03-17 12:05:35,054 -   eval_score = 0.5046
2024-03-17 12:06:11,368 - ***** Epoch: 19: Eval results *****
2024-03-17 12:06:11,368 -   train_loss = 0.2707
2024-03-17 12:06:11,368 -   best_eval_score = 0.5046
2024-03-17 12:06:11,368 -   eval_score = 0.5074
2024-03-17 12:06:49,057 - ***** Epoch: 20: Eval results *****
2024-03-17 12:06:49,057 -   train_loss = 0.237
2024-03-17 12:06:49,057 -   best_eval_score = 0.5074
2024-03-17 12:06:49,057 -   eval_score = 0.4944
2024-03-17 12:06:49,057 - EarlyStopping counter: 1 out of 8
2024-03-17 12:07:26,174 - ***** Epoch: 21: Eval results *****
2024-03-17 12:07:26,175 -   train_loss = 0.2141
2024-03-17 12:07:26,175 -   best_eval_score = 0.5074
2024-03-17 12:07:26,175 -   eval_score = 0.5108
2024-03-17 12:08:02,834 - ***** Epoch: 22: Eval results *****
2024-03-17 12:08:02,835 -   train_loss = 0.1937
2024-03-17 12:08:02,836 -   best_eval_score = 0.5108
2024-03-17 12:08:02,836 -   eval_score = 0.5074
2024-03-17 12:08:02,836 - EarlyStopping counter: 1 out of 8
2024-03-17 12:08:41,341 - ***** Epoch: 23: Eval results *****
2024-03-17 12:08:41,342 -   train_loss = 0.1739
2024-03-17 12:08:41,342 -   best_eval_score = 0.5108
2024-03-17 12:08:41,342 -   eval_score = 0.4927
2024-03-17 12:08:41,342 - EarlyStopping counter: 2 out of 8
2024-03-17 12:09:19,671 - ***** Epoch: 24: Eval results *****
2024-03-17 12:09:19,671 -   train_loss = 0.1514
2024-03-17 12:09:19,671 -   best_eval_score = 0.5108
2024-03-17 12:09:19,671 -   eval_score = 0.4998
2024-03-17 12:09:19,672 - EarlyStopping counter: 3 out of 8
2024-03-17 12:09:55,749 - ***** Epoch: 25: Eval results *****
2024-03-17 12:09:55,749 -   train_loss = 0.1414
2024-03-17 12:09:55,749 -   best_eval_score = 0.5108
2024-03-17 12:09:55,749 -   eval_score = 0.5082
2024-03-17 12:09:55,749 - EarlyStopping counter: 4 out of 8
2024-03-17 12:10:32,835 - ***** Epoch: 26: Eval results *****
2024-03-17 12:10:32,836 -   train_loss = 0.1261
2024-03-17 12:10:32,836 -   best_eval_score = 0.5108
2024-03-17 12:10:32,836 -   eval_score = 0.5227
2024-03-17 12:11:07,683 - ***** Epoch: 27: Eval results *****
2024-03-17 12:11:07,684 -   train_loss = 0.1167
2024-03-17 12:11:07,684 -   best_eval_score = 0.5227
2024-03-17 12:11:07,685 -   eval_score = 0.5143
2024-03-17 12:11:07,685 - EarlyStopping counter: 1 out of 8
2024-03-17 12:11:42,792 - ***** Epoch: 28: Eval results *****
2024-03-17 12:11:42,792 -   train_loss = 0.1119
2024-03-17 12:11:42,792 -   best_eval_score = 0.5227
2024-03-17 12:11:42,792 -   eval_score = 0.5049
2024-03-17 12:11:42,793 - EarlyStopping counter: 2 out of 8
2024-03-17 12:12:18,597 - ***** Epoch: 29: Eval results *****
2024-03-17 12:12:18,597 -   train_loss = 0.1048
2024-03-17 12:12:18,597 -   best_eval_score = 0.5227
2024-03-17 12:12:18,597 -   eval_score = 0.507
2024-03-17 12:12:18,597 - EarlyStopping counter: 3 out of 8
2024-03-17 12:12:54,861 - ***** Epoch: 30: Eval results *****
2024-03-17 12:12:54,861 -   train_loss = 0.0983
2024-03-17 12:12:54,861 -   best_eval_score = 0.5227
2024-03-17 12:12:54,861 -   eval_score = 0.5013
2024-03-17 12:12:54,861 - EarlyStopping counter: 4 out of 8
2024-03-17 12:13:31,161 - ***** Epoch: 31: Eval results *****
2024-03-17 12:13:31,161 -   train_loss = 0.091
2024-03-17 12:13:31,161 -   best_eval_score = 0.5227
2024-03-17 12:13:31,161 -   eval_score = 0.5114
2024-03-17 12:13:31,162 - EarlyStopping counter: 5 out of 8
2024-03-17 12:14:09,806 - ***** Epoch: 32: Eval results *****
2024-03-17 12:14:09,806 -   train_loss = 0.0867
2024-03-17 12:14:09,806 -   best_eval_score = 0.5227
2024-03-17 12:14:09,806 -   eval_score = 0.5007
2024-03-17 12:14:09,807 - EarlyStopping counter: 6 out of 8
2024-03-17 12:14:46,827 - ***** Epoch: 33: Eval results *****
2024-03-17 12:14:46,828 -   train_loss = 0.0818
2024-03-17 12:14:46,828 -   best_eval_score = 0.5227
2024-03-17 12:14:46,828 -   eval_score = 0.5155
2024-03-17 12:14:46,829 - EarlyStopping counter: 7 out of 8
2024-03-17 12:15:26,044 - ***** Epoch: 34: Eval results *****
2024-03-17 12:15:26,045 -   train_loss = 0.0776
2024-03-17 12:15:26,045 -   best_eval_score = 0.5227
2024-03-17 12:15:26,045 -   eval_score = 0.5117
2024-03-17 12:15:26,045 - EarlyStopping counter: 8 out of 8
2024-03-17 12:15:26,045 - EarlyStopping at epoch 34
2024-03-17 12:15:26,047 - Training is finished...
2024-03-17 12:15:26,048 - Testing begins...
2024-03-17 12:15:36,343 - ***** Test: Confusion Matrix *****
2024-03-17 12:15:36,345 - [[ 45   0  18   0   0   0   0   0   0   0   2   0   0   1   0   0   0   1
    0   0   0   0   0   1   0   0   0   0   0   0]
 [  0  52   0   0   9   1   6   0   1   0   1   0   3   0   3   0   0  13
    1   1   0   1   1   0   1   0   0   3   0   0]
 [  8   1  46   0   0   0   0   0   0   0   1   1   0   1   0   0   0   3
    0   0   0   0   0   2   1   0   0   0   0   0]
 [  0   0   0  59   0   0   0   1   0   0   0   0   0   0   3   0   0   1
    0   0   0   0   0   0   1   0   0   0   0   0]
 [  0   6   0   0  28   1   0   0   1   0   0   0   0   0   0   0   0   6
    0   2   0   1   0   1   1   1   0   0   1   2]
 [  0   1   0   0   1  26   0   0   0   1   1   0   0   0   1   0   0   4
    0   0   0   0   0   1   0   0   1   0   0   0]
 [  0   1   0   0   0   5  29   4   0   1   3   1   4   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   6  26   0   0   5   0   6   0   0   0   1   1
    0   0   0   0   0   0   0   0   0   2   0   0]
 [  1   3   3   2   1   0   0   0  21   0   0   2   1   2   2   0   0   6
    0   0   0   0   3   0   2   0   0   0   0   0]
 [  0   1   1   0   1   0   1   0   3  46   0   6   9   2  13   1   0   8
    2   0   0   4   2   0   2   1   0   3   0   1]
 [  2   1   0   0   0   5   3   3   0   1  48   0  23   0   2   0   1   2
    0   2   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   4   1  19  10   0   2   0   0   3
    1   0   1   0   2   0   1   0   1   2   0   0]
 [  0   2   0   0   0   2   6  11   0   3  24   1  79   1   0   0   2   0
    0   2   0   0   1   0   0   1   0   0   0   0]
 [  0   0   2   0   1   0   0   0   0   1   0   0   0   1   3   2   0   4
    2   0   0   0   1   0   0   0   0   0   0   0]
 [  0   3   3   0   0   1   0   0   4  11   2   0   2   3 103   3   0  33
    6   1   1   0  11   0   3   0   0   3   0   0]
 [  0   0   1   0   1   0   0   0   0   4   0   0   0   2   1   7   0   2
    1   0   0   2   1   0   0   0   0   0   0   0]
 [  0   0   0   0   1   0   0   2   0   0   3   0   1   0   0   0  57   0
    2   0   0   0   0   0   0   0   0   0   0   0]
 [  0   4   2   0   5   3   0   0   3  11   0   0   1   3  15   2   2 127
    9   2   2   4   7  11   0   1   2   0   1   0]
 [  0   1   1   0   0   0   1   0   0   3   1   0   0   2   8   1   2   8
   28   0   2   0   0   0   1   0   0   1   0   0]
 [  0   4   0   0   1   0   2   0   0   0   1   0   0   0   0   0   0   0
    0   8   0   1   0   0   0   0   0   0   0   0]
 [  0   1   2   0   1   0   0   0   0   1   0   0   1   0   5   1   0   2
    5   0   5   0   0   1   2   0   0   1   0   1]
 [  7   1   0   0   1   0   0   0   0   2   0   0   0   0   1   0   5   0
    0   1   0  25   2   5   0   1   0   0   0   2]
 [  0   1   2   1   0   0   0   0   0   2   0   1   0   2   5   0   0   7
    0   0   0   0  84   0   1   4   7   0   0   0]
 [  0   2   2   0   1   0   0   0   0   2   0   0   0   0   1   0   0   9
    0   0   0   4   0  17   0   0   0   0   0   0]
 [  2   0   1   0   0   0   0   0   0   2   0   2   0   2   1   0   0   4
    0   0   1   0   1   0  90   0   0   5   2   0]
 [  1   1   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0   2
    0   0   0   0   2   0   0  21   0   1   0   2]
 [  0   0   0   0   0   0   0   0   0   1   0   0   0   0   1   0   0   3
    0   0   0   1   4   1   0   0   4   0   2   0]
 [  1   3   1   0   1   0   0   1   2   5   3   3   2   3   3   0   0   4
    1   0   1   0   2   0   9   1   0  10   1   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
    0   0   0   0   0   0   0   0   1   0  56   0]
 [  0   1   0   0   0   0   0   0   3   1   1   1   0   0   0   0   0   3
    0   0   2   0   0   0   1   1   0   0   0   5]]
2024-03-17 12:15:36,345 - ***** Evaluation results *****
2024-03-17 12:15:36,345 -   acc = 0.5765
2024-03-17 12:15:36,345 -   f1 = 0.5267
2024-03-17 12:15:36,345 -   prec = 0.5341
2024-03-17 12:15:36,345 -   rec = 0.5271
2024-03-17 12:15:36,345 - Testing is finished...
2024-03-17 12:15:36,345 - Multimodal intent recognition is finished...
2024-03-17 12:15:36,346 - Results are saved in results/mag_bert.csv
