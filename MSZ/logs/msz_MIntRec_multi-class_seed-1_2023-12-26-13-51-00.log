2023-12-26 13:51:00,077 - ============================== Params ==============================
2023-12-26 13:51:00,078 - logger_name: msz_MIntRec_multi-class_seed-1_2023-12-26-13-51-00
2023-12-26 13:51:00,079 - dataset: MIntRec
2023-12-26 13:51:00,079 - data_mode: multi-class
2023-12-26 13:51:00,079 - method: msz
2023-12-26 13:51:00,079 - text_backbone: bert-base-uncased
2023-12-26 13:51:00,080 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-26 13:51:00,080 - seed: 1
2023-12-26 13:51:00,080 - num_workers: 8
2023-12-26 13:51:00,081 - gpu_id: 3
2023-12-26 13:51:00,081 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-26 13:51:00,081 - train: True
2023-12-26 13:51:00,082 - tune: False
2023-12-26 13:51:00,082 - save_model: False
2023-12-26 13:51:00,082 - save_results: True
2023-12-26 13:51:00,083 - log_path: logs
2023-12-26 13:51:00,083 - cache_path: 
2023-12-26 13:51:00,083 - video_data_path: video_data
2023-12-26 13:51:00,084 - audio_data_path: audio_data
2023-12-26 13:51:00,084 - video_feats_path: video_feats.pkl
2023-12-26 13:51:00,084 - audio_feats_path: audio_feats.pkl
2023-12-26 13:51:00,085 - results_path: results
2023-12-26 13:51:00,085 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-26 13:51:00,085 - model_path: models
2023-12-26 13:51:00,086 - config_file_name: msz
2023-12-26 13:51:00,086 - results_file_name: msz.csv
2023-12-26 13:51:00,086 - padding_mode: zero
2023-12-26 13:51:00,086 - padding_loc: end
2023-12-26 13:51:00,087 - need_aligned: False
2023-12-26 13:51:00,087 - eval_monitor: f1
2023-12-26 13:51:00,087 - train_batch_size: 16
2023-12-26 13:51:00,088 - eval_batch_size: 8
2023-12-26 13:51:00,088 - test_batch_size: 8
2023-12-26 13:51:00,088 - wait_patience: 8
2023-12-26 13:51:00,089 - nheads: 2
2023-12-26 13:51:00,089 - encoder_layers: 2
2023-12-26 13:51:00,089 - attn_dropout: 0.1
2023-12-26 13:51:00,090 - relu_dropout: 0.1
2023-12-26 13:51:00,090 - embed_dropout: 0.1
2023-12-26 13:51:00,090 - res_dropout: 0.1
2023-12-26 13:51:00,091 - attn_mask: False
2023-12-26 13:51:00,091 - hidden_size: 768
2023-12-26 13:51:00,091 - num_attention_heads: 12
2023-12-26 13:51:00,092 - attention_probs_dropout_prob: 0.2
2023-12-26 13:51:00,092 - hidden_dropout_prob: 0.2
2023-12-26 13:51:00,092 - intermediate_size: 768
2023-12-26 13:51:00,092 - num_hidden_layers: 3
2023-12-26 13:51:00,093 - max_position_embeddings: 512
2023-12-26 13:51:00,093 - position_embedding_type: absolute
2023-12-26 13:51:00,093 - add_cross_attention: False
2023-12-26 13:51:00,094 - batch_first: True
2023-12-26 13:51:00,094 - hidden_dims: 768
2023-12-26 13:51:00,094 - att_dropouts: [0.2, 0.2, 0.2]
2023-12-26 13:51:00,095 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-26 13:51:00,095 - tv_c_loss: 0.005
2023-12-26 13:51:00,095 - vt_c_loss: 0.02
2023-12-26 13:51:00,096 - at_c_loss: 0.02
2023-12-26 13:51:00,096 - aligned_method: conv1d
2023-12-26 13:51:00,096 - grad_clip: 2
2023-12-26 13:51:00,097 - num_train_epochs: 100
2023-12-26 13:51:00,097 - warmup_proportion: 0.1
2023-12-26 13:51:00,097 - lr: 1e-06
2023-12-26 13:51:00,098 - weight_decay: 0.02
2023-12-26 13:51:00,098 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2023-12-26-13-51-00
2023-12-26 13:51:00,098 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2023-12-26-13-51-00/models
2023-12-26 13:51:00,099 - ============================== End Params ==============================
2023-12-26 13:51:00,143 - Generate Text Features Begin...
2023-12-26 13:51:00,792 - Generate Text Features Finished...
2023-12-26 13:51:00,793 - Load Video Features Begin...
2023-12-26 13:51:01,642 - Load Video Features Finished...
2023-12-26 13:51:02,246 - Load Audio Features Begin...
2023-12-26 13:51:07,362 - Load Audio Features Finished...
2023-12-26 13:51:11,556 - method  begins...
2023-12-26 13:51:17,901 - Multimodal intent recognition begins...
2023-12-26 13:51:17,901 - Training begins...
2023-12-26 13:52:00,093 - ***** Epoch: 1: Eval results *****
2023-12-26 13:52:00,094 -   train_loss = 3.4804
2023-12-26 13:52:00,094 -   best_eval_score = 0.0
2023-12-26 13:52:00,094 -   eval_score = 0.0314
2023-12-26 13:52:44,621 - ***** Epoch: 2: Eval results *****
2023-12-26 13:52:44,622 -   train_loss = 3.2685
2023-12-26 13:52:44,623 -   best_eval_score = 0.0314
2023-12-26 13:52:44,623 -   eval_score = 0.0215
2023-12-26 13:52:44,624 - EarlyStopping counter: 1 out of 8
2023-12-26 13:53:21,203 - ***** Epoch: 3: Eval results *****
2023-12-26 13:53:21,203 -   train_loss = 3.0509
2023-12-26 13:53:21,203 -   best_eval_score = 0.0314
2023-12-26 13:53:21,204 -   eval_score = 0.1438
2023-12-26 13:53:59,291 - ***** Epoch: 4: Eval results *****
2023-12-26 13:53:59,291 -   train_loss = 2.8105
2023-12-26 13:53:59,292 -   best_eval_score = 0.1438
2023-12-26 13:53:59,292 -   eval_score = 0.2309
2023-12-26 13:54:44,600 - ***** Epoch: 5: Eval results *****
2023-12-26 13:54:44,603 -   train_loss = 2.486
2023-12-26 13:54:44,603 -   best_eval_score = 0.2309
2023-12-26 13:54:44,604 -   eval_score = 0.3713
2023-12-26 13:55:23,406 - ***** Epoch: 6: Eval results *****
2023-12-26 13:55:23,407 -   train_loss = 2.1402
2023-12-26 13:55:23,408 -   best_eval_score = 0.3713
2023-12-26 13:55:23,409 -   eval_score = 0.4461
2023-12-26 13:56:03,369 - ***** Epoch: 7: Eval results *****
2023-12-26 13:56:03,370 -   train_loss = 1.815
2023-12-26 13:56:03,370 -   best_eval_score = 0.4461
2023-12-26 13:56:03,370 -   eval_score = 0.5045
2023-12-26 13:56:46,358 - ***** Epoch: 8: Eval results *****
2023-12-26 13:56:46,361 -   train_loss = 1.5326
2023-12-26 13:56:46,361 -   best_eval_score = 0.5045
2023-12-26 13:56:46,362 -   eval_score = 0.5087
2023-12-26 13:57:29,070 - ***** Epoch: 9: Eval results *****
2023-12-26 13:57:29,070 -   train_loss = 1.3143
2023-12-26 13:57:29,070 -   best_eval_score = 0.5087
2023-12-26 13:57:29,071 -   eval_score = 0.5414
2023-12-26 13:58:06,172 - ***** Epoch: 10: Eval results *****
2023-12-26 13:58:06,172 -   train_loss = 1.0759
2023-12-26 13:58:06,172 -   best_eval_score = 0.5414
2023-12-26 13:58:06,172 -   eval_score = 0.5926
2023-12-26 13:58:46,932 - ***** Epoch: 11: Eval results *****
2023-12-26 13:58:46,933 -   train_loss = 0.9657
2023-12-26 13:58:46,933 -   best_eval_score = 0.5926
2023-12-26 13:58:46,933 -   eval_score = 0.5604
2023-12-26 13:58:46,933 - EarlyStopping counter: 1 out of 8
2023-12-26 13:59:32,182 - ***** Epoch: 12: Eval results *****
2023-12-26 13:59:32,184 -   train_loss = 0.7827
2023-12-26 13:59:32,184 -   best_eval_score = 0.5926
2023-12-26 13:59:32,185 -   eval_score = 0.578
2023-12-26 13:59:32,185 - EarlyStopping counter: 2 out of 8
2023-12-26 14:00:11,264 - ***** Epoch: 13: Eval results *****
2023-12-26 14:00:11,265 -   train_loss = 0.7329
2023-12-26 14:00:11,265 -   best_eval_score = 0.5926
2023-12-26 14:00:11,265 -   eval_score = 0.5865
2023-12-26 14:00:11,265 - EarlyStopping counter: 3 out of 8
2023-12-26 14:00:48,944 - ***** Epoch: 14: Eval results *****
2023-12-26 14:00:48,944 -   train_loss = 0.5536
2023-12-26 14:00:48,944 -   best_eval_score = 0.5926
2023-12-26 14:00:48,944 -   eval_score = 0.6396
2023-12-26 14:01:33,527 - ***** Epoch: 15: Eval results *****
2023-12-26 14:01:33,527 -   train_loss = 0.4728
2023-12-26 14:01:33,527 -   best_eval_score = 0.6396
2023-12-26 14:01:33,527 -   eval_score = 0.6089
2023-12-26 14:01:33,527 - EarlyStopping counter: 1 out of 8
2023-12-26 14:02:14,069 - ***** Epoch: 16: Eval results *****
2023-12-26 14:02:14,070 -   train_loss = 0.438
2023-12-26 14:02:14,071 -   best_eval_score = 0.6396
2023-12-26 14:02:14,071 -   eval_score = 0.62
2023-12-26 14:02:14,072 - EarlyStopping counter: 2 out of 8
2023-12-26 14:02:50,792 - ***** Epoch: 17: Eval results *****
2023-12-26 14:02:50,792 -   train_loss = 0.3049
2023-12-26 14:02:50,792 -   best_eval_score = 0.6396
2023-12-26 14:02:50,792 -   eval_score = 0.6756
2023-12-26 14:03:22,251 - ***** Epoch: 18: Eval results *****
2023-12-26 14:03:22,252 -   train_loss = 0.2342
2023-12-26 14:03:22,252 -   best_eval_score = 0.6756
2023-12-26 14:03:22,253 -   eval_score = 0.6714
2023-12-26 14:03:22,253 - EarlyStopping counter: 1 out of 8
2023-12-26 14:04:05,992 - ***** Epoch: 19: Eval results *****
2023-12-26 14:04:05,992 -   train_loss = 0.2194
2023-12-26 14:04:05,993 -   best_eval_score = 0.6756
2023-12-26 14:04:05,993 -   eval_score = 0.6632
2023-12-26 14:04:05,994 - EarlyStopping counter: 2 out of 8
2023-12-26 14:04:49,545 - ***** Epoch: 20: Eval results *****
2023-12-26 14:04:49,545 -   train_loss = 0.1941
2023-12-26 14:04:49,545 -   best_eval_score = 0.6756
2023-12-26 14:04:49,545 -   eval_score = 0.65
2023-12-26 14:04:49,545 - EarlyStopping counter: 3 out of 8
2023-12-26 14:05:26,073 - ***** Epoch: 21: Eval results *****
2023-12-26 14:05:26,073 -   train_loss = 0.1557
2023-12-26 14:05:26,073 -   best_eval_score = 0.6756
2023-12-26 14:05:26,073 -   eval_score = 0.6496
2023-12-26 14:05:26,073 - EarlyStopping counter: 4 out of 8
2023-12-26 14:06:08,979 - ***** Epoch: 22: Eval results *****
2023-12-26 14:06:08,979 -   train_loss = 0.117
2023-12-26 14:06:08,979 -   best_eval_score = 0.6756
2023-12-26 14:06:08,979 -   eval_score = 0.6483
2023-12-26 14:06:08,979 - EarlyStopping counter: 5 out of 8
2023-12-26 14:06:50,245 - ***** Epoch: 23: Eval results *****
2023-12-26 14:06:50,246 -   train_loss = 0.0946
2023-12-26 14:06:50,247 -   best_eval_score = 0.6756
2023-12-26 14:06:50,247 -   eval_score = 0.6317
2023-12-26 14:06:50,248 - EarlyStopping counter: 6 out of 8
2023-12-26 14:07:27,237 - ***** Epoch: 24: Eval results *****
2023-12-26 14:07:27,238 -   train_loss = 0.0845
2023-12-26 14:07:27,239 -   best_eval_score = 0.6756
2023-12-26 14:07:27,239 -   eval_score = 0.6331
2023-12-26 14:07:27,239 - EarlyStopping counter: 7 out of 8
2023-12-26 14:08:10,961 - ***** Epoch: 25: Eval results *****
2023-12-26 14:08:10,964 -   train_loss = 0.074
2023-12-26 14:08:10,965 -   best_eval_score = 0.6756
2023-12-26 14:08:10,965 -   eval_score = 0.6357
2023-12-26 14:08:10,966 - EarlyStopping counter: 8 out of 8
2023-12-26 14:08:10,966 - EarlyStopping at epoch 25
2023-12-26 14:08:10,969 - Training is finished...
2023-12-26 14:08:10,971 - Testing begins...
2023-12-26 14:08:19,474 - ***** Test: Confusion Matrix *****
2023-12-26 14:08:19,477 - [[26  1  0  0  9  0  4  2  0  5  0  0  7  2  0  1  0  0  0  0]
 [ 0 37  0  1  0  0  1  1  0  0  1  0  1  1  0  0  0  0  0  0]
 [ 0  0 27  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 13  0  4  0  0  1  0  0  1  2  1  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  0  0  0  0  1  0]
 [ 0  0  0  0  1  0  3  1  2  2  0  0  2  0  0  0  1  0  0  0]
 [ 2  0  0  0  0  0  0  6  0  1  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  5  1  0  0  0  0  2  0  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  5  0  0  0  0  0  3  0  1  0  0]
 [ 1  0  0  0  0  0  0  1  0  1 14  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 15  1  0  0  0  0  0  1  1]
 [ 3  2  0  1  0  1  0  1  1  0  0  0 43  2  1  0  0  1  1  0]
 [ 0  0  0  0  0  0  1  1  0  0  1  1  1 19  1  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  0  0  0  0  2  2 13  0  1  0  0  3]
 [ 0  0  0  1  1  0  0  1  0  0  0  0  4  1  0 13  0  0  0  0]
 [ 2  0  0  0  0  0  0  0  0  0  0  0  3  0  0  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0 10  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  0  0  0  0  7]]
2023-12-26 14:08:19,478 - ***** Evaluation results *****
2023-12-26 14:08:19,478 -   acc = 0.7011
2023-12-26 14:08:19,478 -   f1 = 0.6671
2023-12-26 14:08:19,479 -   prec = 0.6753
2023-12-26 14:08:19,479 -   rec = 0.679
2023-12-26 14:08:19,479 - Testing is finished...
2023-12-26 14:08:19,480 - Multimodal intent recognition is finished...
2023-12-26 14:08:19,480 - Results are saved in results/msz.csv
