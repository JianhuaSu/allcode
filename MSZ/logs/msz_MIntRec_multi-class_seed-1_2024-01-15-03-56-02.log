2024-01-15 03:56:02,824 - ============================== Params ==============================
2024-01-15 03:56:02,824 - logger_name: msz_MIntRec_multi-class_seed-1_2024-01-15-03-56-02
2024-01-15 03:56:02,824 - dataset: MIntRec
2024-01-15 03:56:02,824 - data_mode: multi-class
2024-01-15 03:56:02,824 - method: msz
2024-01-15 03:56:02,824 - text_backbone: bert-base-uncased
2024-01-15 03:56:02,824 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-15 03:56:02,824 - seed: 1
2024-01-15 03:56:02,824 - num_workers: 8
2024-01-15 03:56:02,824 - gpu_id: 1
2024-01-15 03:56:02,824 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-15 03:56:02,824 - train: True
2024-01-15 03:56:02,824 - tune: False
2024-01-15 03:56:02,824 - save_model: False
2024-01-15 03:56:02,824 - save_results: True
2024-01-15 03:56:02,825 - log_path: logs
2024-01-15 03:56:02,825 - cache_path: 
2024-01-15 03:56:02,825 - video_data_path: video_data
2024-01-15 03:56:02,825 - audio_data_path: audio_data
2024-01-15 03:56:02,825 - video_feats_path: video_feats.pkl
2024-01-15 03:56:02,825 - audio_feats_path: audio_feats.pkl
2024-01-15 03:56:02,825 - results_path: results
2024-01-15 03:56:02,825 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-15 03:56:02,825 - model_path: models
2024-01-15 03:56:02,825 - config_file_name: msz
2024-01-15 03:56:02,825 - results_file_name: msz.csv
2024-01-15 03:56:02,825 - padding_mode: zero
2024-01-15 03:56:02,825 - padding_loc: end
2024-01-15 03:56:02,825 - need_aligned: False
2024-01-15 03:56:02,825 - eval_monitor: f1
2024-01-15 03:56:02,825 - train_batch_size: 16
2024-01-15 03:56:02,825 - eval_batch_size: 8
2024-01-15 03:56:02,825 - test_batch_size: 8
2024-01-15 03:56:02,825 - wait_patience: 8
2024-01-15 03:56:02,825 - nheads: 12
2024-01-15 03:56:02,825 - encoder_layers: 8
2024-01-15 03:56:02,826 - attn_dropout: 0.1
2024-01-15 03:56:02,826 - relu_dropout: 0.1
2024-01-15 03:56:02,826 - embed_dropout: 0.1
2024-01-15 03:56:02,826 - res_dropout: 0.1
2024-01-15 03:56:02,826 - attn_mask: False
2024-01-15 03:56:02,826 - hidden_size: 768
2024-01-15 03:56:02,826 - num_attention_heads: 12
2024-01-15 03:56:02,826 - attention_probs_dropout_prob: 0.1
2024-01-15 03:56:02,826 - hidden_dropout_prob: 0.1
2024-01-15 03:56:02,826 - intermediate_size: 768
2024-01-15 03:56:02,826 - num_hidden_layers: 8
2024-01-15 03:56:02,826 - max_position_embeddings: 768
2024-01-15 03:56:02,826 - position_embedding_type: absolute
2024-01-15 03:56:02,826 - batch_first: True
2024-01-15 03:56:02,826 - hidden_dims: 768
2024-01-15 03:56:02,826 - dropout: 0.2
2024-01-15 03:56:02,826 - aligned_method: conv1d
2024-01-15 03:56:02,826 - grad_clip: -1
2024-01-15 03:56:02,826 - num_train_epochs: 100
2024-01-15 03:56:02,826 - warmup_proportion: 0.1
2024-01-15 03:56:02,827 - lr: 3e-06
2024-01-15 03:56:02,827 - weight_decay: 0.01
2024-01-15 03:56:02,827 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-15-03-56-02
2024-01-15 03:56:02,827 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-15-03-56-02/models
2024-01-15 03:56:02,827 - ============================== End Params ==============================
2024-01-15 03:56:02,829 - Generate Text Features Begin...
2024-01-15 03:56:03,322 - Generate Text Features Finished...
2024-01-15 03:56:03,322 - Load Video Features Begin...
2024-01-15 03:56:03,624 - Load Video Features Finished...
2024-01-15 03:56:04,157 - Load Audio Features Begin...
2024-01-15 03:56:05,029 - Load Audio Features Finished...
2024-01-15 03:56:08,214 - method  begins...
2024-01-15 03:56:12,993 - Multimodal intent recognition begins...
2024-01-15 03:56:12,993 - Training begins...
2024-01-15 03:56:31,333 - ***** Epoch: 1: Eval results *****
2024-01-15 03:56:31,333 -   train_loss = 3.0078
2024-01-15 03:56:31,333 -   best_eval_score = 0.0
2024-01-15 03:56:31,333 -   eval_score = 0.0413
2024-01-15 03:56:48,226 - ***** Epoch: 2: Eval results *****
2024-01-15 03:56:48,226 -   train_loss = 2.9731
2024-01-15 03:56:48,226 -   best_eval_score = 0.0413
2024-01-15 03:56:48,226 -   eval_score = 0.0201
2024-01-15 03:56:48,226 - EarlyStopping counter: 1 out of 8
2024-01-15 03:57:05,080 - ***** Epoch: 3: Eval results *****
2024-01-15 03:57:05,080 -   train_loss = 2.9252
2024-01-15 03:57:05,080 -   best_eval_score = 0.0413
2024-01-15 03:57:05,080 -   eval_score = 0.0184
2024-01-15 03:57:05,080 - EarlyStopping counter: 2 out of 8
2024-01-15 03:57:22,085 - ***** Epoch: 4: Eval results *****
2024-01-15 03:57:22,085 -   train_loss = 2.8665
2024-01-15 03:57:22,085 -   best_eval_score = 0.0413
2024-01-15 03:57:22,085 -   eval_score = 0.045
2024-01-15 03:57:39,301 - ***** Epoch: 5: Eval results *****
2024-01-15 03:57:39,302 -   train_loss = 2.7619
2024-01-15 03:57:39,302 -   best_eval_score = 0.045
2024-01-15 03:57:39,302 -   eval_score = 0.1202
2024-01-15 03:57:56,290 - ***** Epoch: 6: Eval results *****
2024-01-15 03:57:56,290 -   train_loss = 2.582
2024-01-15 03:57:56,290 -   best_eval_score = 0.1202
2024-01-15 03:57:56,290 -   eval_score = 0.1671
2024-01-15 03:58:13,352 - ***** Epoch: 7: Eval results *****
2024-01-15 03:58:13,352 -   train_loss = 2.2927
2024-01-15 03:58:13,352 -   best_eval_score = 0.1671
2024-01-15 03:58:13,352 -   eval_score = 0.211
2024-01-15 03:58:30,430 - ***** Epoch: 8: Eval results *****
2024-01-15 03:58:30,431 -   train_loss = 1.904
2024-01-15 03:58:30,431 -   best_eval_score = 0.211
2024-01-15 03:58:30,431 -   eval_score = 0.3425
2024-01-15 03:58:47,929 - ***** Epoch: 9: Eval results *****
2024-01-15 03:58:47,929 -   train_loss = 1.4966
2024-01-15 03:58:47,929 -   best_eval_score = 0.3425
2024-01-15 03:58:47,929 -   eval_score = 0.5121
2024-01-15 03:59:04,984 - ***** Epoch: 10: Eval results *****
2024-01-15 03:59:04,984 -   train_loss = 1.1449
2024-01-15 03:59:04,984 -   best_eval_score = 0.5121
2024-01-15 03:59:04,984 -   eval_score = 0.535
2024-01-15 03:59:21,960 - ***** Epoch: 11: Eval results *****
2024-01-15 03:59:21,960 -   train_loss = 0.8448
2024-01-15 03:59:21,960 -   best_eval_score = 0.535
2024-01-15 03:59:21,960 -   eval_score = 0.5869
2024-01-15 03:59:39,202 - ***** Epoch: 12: Eval results *****
2024-01-15 03:59:39,202 -   train_loss = 0.634
2024-01-15 03:59:39,202 -   best_eval_score = 0.5869
2024-01-15 03:59:39,202 -   eval_score = 0.6229
2024-01-15 03:59:56,266 - ***** Epoch: 13: Eval results *****
2024-01-15 03:59:56,266 -   train_loss = 0.4741
2024-01-15 03:59:56,267 -   best_eval_score = 0.6229
2024-01-15 03:59:56,267 -   eval_score = 0.6277
2024-01-15 04:00:13,177 - ***** Epoch: 14: Eval results *****
2024-01-15 04:00:13,177 -   train_loss = 0.364
2024-01-15 04:00:13,177 -   best_eval_score = 0.6277
2024-01-15 04:00:13,177 -   eval_score = 0.6538
2024-01-15 04:00:30,132 - ***** Epoch: 15: Eval results *****
2024-01-15 04:00:30,133 -   train_loss = 0.2929
2024-01-15 04:00:30,133 -   best_eval_score = 0.6538
2024-01-15 04:00:30,133 -   eval_score = 0.6484
2024-01-15 04:00:30,133 - EarlyStopping counter: 1 out of 8
2024-01-15 04:00:47,136 - ***** Epoch: 16: Eval results *****
2024-01-15 04:00:47,137 -   train_loss = 0.2379
2024-01-15 04:00:47,137 -   best_eval_score = 0.6538
2024-01-15 04:00:47,137 -   eval_score = 0.6672
2024-01-15 04:01:04,104 - ***** Epoch: 17: Eval results *****
2024-01-15 04:01:04,104 -   train_loss = 0.1868
2024-01-15 04:01:04,104 -   best_eval_score = 0.6672
2024-01-15 04:01:04,104 -   eval_score = 0.6659
2024-01-15 04:01:04,104 - EarlyStopping counter: 1 out of 8
2024-01-15 04:01:21,366 - ***** Epoch: 18: Eval results *****
2024-01-15 04:01:21,366 -   train_loss = 0.1536
2024-01-15 04:01:21,366 -   best_eval_score = 0.6672
2024-01-15 04:01:21,366 -   eval_score = 0.6741
2024-01-15 04:01:38,504 - ***** Epoch: 19: Eval results *****
2024-01-15 04:01:38,504 -   train_loss = 0.1318
2024-01-15 04:01:38,504 -   best_eval_score = 0.6741
2024-01-15 04:01:38,504 -   eval_score = 0.6697
2024-01-15 04:01:38,504 - EarlyStopping counter: 1 out of 8
2024-01-15 04:01:55,394 - ***** Epoch: 20: Eval results *****
2024-01-15 04:01:55,394 -   train_loss = 0.1118
2024-01-15 04:01:55,394 -   best_eval_score = 0.6741
2024-01-15 04:01:55,394 -   eval_score = 0.668
2024-01-15 04:01:55,394 - EarlyStopping counter: 2 out of 8
2024-01-15 04:02:12,082 - ***** Epoch: 21: Eval results *****
2024-01-15 04:02:12,082 -   train_loss = 0.0964
2024-01-15 04:02:12,082 -   best_eval_score = 0.6741
2024-01-15 04:02:12,083 -   eval_score = 0.6727
2024-01-15 04:02:12,083 - EarlyStopping counter: 3 out of 8
2024-01-15 04:02:29,047 - ***** Epoch: 22: Eval results *****
2024-01-15 04:02:29,047 -   train_loss = 0.0829
2024-01-15 04:02:29,047 -   best_eval_score = 0.6741
2024-01-15 04:02:29,047 -   eval_score = 0.6756
2024-01-15 04:02:46,136 - ***** Epoch: 23: Eval results *****
2024-01-15 04:02:46,136 -   train_loss = 0.0692
2024-01-15 04:02:46,136 -   best_eval_score = 0.6756
2024-01-15 04:02:46,136 -   eval_score = 0.6728
2024-01-15 04:02:46,136 - EarlyStopping counter: 1 out of 8
2024-01-15 04:03:03,016 - ***** Epoch: 24: Eval results *****
2024-01-15 04:03:03,016 -   train_loss = 0.0613
2024-01-15 04:03:03,016 -   best_eval_score = 0.6756
2024-01-15 04:03:03,016 -   eval_score = 0.6822
2024-01-15 04:03:20,049 - ***** Epoch: 25: Eval results *****
2024-01-15 04:03:20,049 -   train_loss = 0.0544
2024-01-15 04:03:20,049 -   best_eval_score = 0.6822
2024-01-15 04:03:20,049 -   eval_score = 0.6852
2024-01-15 04:03:37,161 - ***** Epoch: 26: Eval results *****
2024-01-15 04:03:37,161 -   train_loss = 0.0526
2024-01-15 04:03:37,161 -   best_eval_score = 0.6852
2024-01-15 04:03:37,161 -   eval_score = 0.6694
2024-01-15 04:03:37,161 - EarlyStopping counter: 1 out of 8
2024-01-15 04:03:54,413 - ***** Epoch: 27: Eval results *****
2024-01-15 04:03:54,413 -   train_loss = 0.0454
2024-01-15 04:03:54,413 -   best_eval_score = 0.6852
2024-01-15 04:03:54,413 -   eval_score = 0.6675
2024-01-15 04:03:54,413 - EarlyStopping counter: 2 out of 8
2024-01-15 04:04:11,220 - ***** Epoch: 28: Eval results *****
2024-01-15 04:04:11,220 -   train_loss = 0.0373
2024-01-15 04:04:11,220 -   best_eval_score = 0.6852
2024-01-15 04:04:11,220 -   eval_score = 0.6756
2024-01-15 04:04:11,220 - EarlyStopping counter: 3 out of 8
2024-01-15 04:04:28,130 - ***** Epoch: 29: Eval results *****
2024-01-15 04:04:28,130 -   train_loss = 0.0353
2024-01-15 04:04:28,130 -   best_eval_score = 0.6852
2024-01-15 04:04:28,130 -   eval_score = 0.6708
2024-01-15 04:04:28,131 - EarlyStopping counter: 4 out of 8
2024-01-15 04:04:45,148 - ***** Epoch: 30: Eval results *****
2024-01-15 04:04:45,148 -   train_loss = 0.029
2024-01-15 04:04:45,148 -   best_eval_score = 0.6852
2024-01-15 04:04:45,148 -   eval_score = 0.661
2024-01-15 04:04:45,148 - EarlyStopping counter: 5 out of 8
2024-01-15 04:05:02,193 - ***** Epoch: 31: Eval results *****
2024-01-15 04:05:02,193 -   train_loss = 0.0283
2024-01-15 04:05:02,193 -   best_eval_score = 0.6852
2024-01-15 04:05:02,193 -   eval_score = 0.6706
2024-01-15 04:05:02,193 - EarlyStopping counter: 6 out of 8
2024-01-15 04:05:19,439 - ***** Epoch: 32: Eval results *****
2024-01-15 04:05:19,440 -   train_loss = 0.0259
2024-01-15 04:05:19,440 -   best_eval_score = 0.6852
2024-01-15 04:05:19,440 -   eval_score = 0.6769
2024-01-15 04:05:19,440 - EarlyStopping counter: 7 out of 8
2024-01-15 04:05:36,344 - ***** Epoch: 33: Eval results *****
2024-01-15 04:05:36,344 -   train_loss = 0.0225
2024-01-15 04:05:36,344 -   best_eval_score = 0.6852
2024-01-15 04:05:36,344 -   eval_score = 0.6792
2024-01-15 04:05:36,344 - EarlyStopping counter: 8 out of 8
2024-01-15 04:05:36,344 - EarlyStopping at epoch 33
2024-01-15 04:05:36,347 - Training is finished...
2024-01-15 04:05:36,347 - Testing begins...
2024-01-15 04:05:39,149 - ***** Test: Confusion Matrix *****
2024-01-15 04:05:39,150 - [[32  1  0  0  9  0  2  1  2  2  1  0  5  2  0  0  0  0  0  0]
 [ 0 36  0  1  0  1  0  1  0  0  1  0  2  0  1  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 4  0  0  0 11  0  1  0  1  1  0  1  2  1  0  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 1  0  0  0  4  0  1  1  2  0  0  0  1  0  1  1  0  0  0  0]
 [ 3  0  0  0  0  0  0  6  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  2  2  4  0  0  0  0  0  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  3  0  0  1  0  0  2  0  1  0  1]
 [ 0  0  0  0  0  0  1  0  1  1 13  0  0  0  1  0  1  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  0  1]
 [ 4  1  0  0  0  0  1  1  0  0  0  1 38  2  5  1  2  0  0  1]
 [ 1  1  0  0  1  0  0  0  0  0  1  1  1 17  2  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  3  2 15  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  3  0  0 16  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  2  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  1  1  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  0  1  0  0  6]]
2024-01-15 04:05:39,150 - ***** Evaluation results *****
2024-01-15 04:05:39,150 -   acc = 0.6944
2024-01-15 04:05:39,150 -   f1 = 0.6671
2024-01-15 04:05:39,150 -   prec = 0.6725
2024-01-15 04:05:39,150 -   rec = 0.6678
2024-01-15 04:05:39,150 - Testing is finished...
2024-01-15 04:05:39,150 - Multimodal intent recognition is finished...
2024-01-15 04:05:39,150 - Results are saved in results/msz.csv
