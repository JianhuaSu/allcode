2024-05-08 06:16:17,541 - ============================== Params ==============================
2024-05-08 06:16:17,541 - logger_name: msz_MIntRec2_multi-class_seed-5_2024-05-08-06-16-17
2024-05-08 06:16:17,541 - dataset: MIntRec2
2024-05-08 06:16:17,541 - data_mode: multi-class
2024-05-08 06:16:17,541 - method: msz
2024-05-08 06:16:17,541 - text_backbone: bert-base-uncased
2024-05-08 06:16:17,541 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-08 06:16:17,541 - seed: 5
2024-05-08 06:16:17,541 - num_workers: 8
2024-05-08 06:16:17,541 - gpu_id: 1
2024-05-08 06:16:17,541 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-08 06:16:17,541 - train: True
2024-05-08 06:16:17,541 - tune: True
2024-05-08 06:16:17,541 - save_model: False
2024-05-08 06:16:17,541 - save_results: True
2024-05-08 06:16:17,541 - log_path: logs
2024-05-08 06:16:17,541 - cache_path: 
2024-05-08 06:16:17,541 - video_data_path: video_data
2024-05-08 06:16:17,541 - audio_data_path: audio_data
2024-05-08 06:16:17,541 - video_feats_path: video_feats.pkl
2024-05-08 06:16:17,541 - audio_feats_path: audio_feats.pkl
2024-05-08 06:16:17,542 - results_path: results
2024-05-08 06:16:17,542 - output_path: /home/sharing/disk2/sjh/Outputs/ablation_MIntRec2
2024-05-08 06:16:17,542 - model_path: models
2024-05-08 06:16:17,542 - config_file_name: msz_MIntRec2
2024-05-08 06:16:17,542 - results_file_name: ablation_msz.csv
2024-05-08 06:16:17,542 - ablation: no_cross
2024-05-08 06:16:17,542 - padding_mode: zero
2024-05-08 06:16:17,542 - padding_loc: end
2024-05-08 06:16:17,542 - need_aligned: False
2024-05-08 06:16:17,542 - eval_monitor: f1
2024-05-08 06:16:17,542 - train_batch_size: 32
2024-05-08 06:16:17,542 - eval_batch_size: 16
2024-05-08 06:16:17,542 - test_batch_size: 16
2024-05-08 06:16:17,542 - wait_patience: 8
2024-05-08 06:16:17,542 - hidden_dims: 768
2024-05-08 06:16:17,542 - num_attention_heads: 6
2024-05-08 06:16:17,542 - attention_probs_dropout_prob: 0.3
2024-05-08 06:16:17,542 - hidden_dropout_prob: 0.5
2024-05-08 06:16:17,542 - intermediate_size: 768
2024-05-08 06:16:17,542 - num_hidden_layers: 6
2024-05-08 06:16:17,542 - max_position_embeddings: 1000
2024-05-08 06:16:17,542 - position_embedding_type: absolute
2024-05-08 06:16:17,542 - batch_first: True
2024-05-08 06:16:17,542 - dropout: 0.2
2024-05-08 06:16:17,542 - aligned_method: conv1d
2024-05-08 06:16:17,542 - num_train_epochs: 100
2024-05-08 06:16:17,542 - lr: 5e-06
2024-05-08 06:16:17,542 - lr_mode: max
2024-05-08 06:16:17,542 - patience: 5
2024-05-08 06:16:17,542 - factor: 0.2
2024-05-08 06:16:17,542 - pred_output_path: /home/sharing/disk2/sjh/Outputs/ablation_MIntRec2/msz_MIntRec2_multi-class_seed-5_2024-05-08-06-16-17
2024-05-08 06:16:17,542 - model_output_path: /home/sharing/disk2/sjh/Outputs/ablation_MIntRec2/msz_MIntRec2_multi-class_seed-5_2024-05-08-06-16-17/models
2024-05-08 06:16:17,542 - ============================== End Params ==============================
2024-05-08 06:16:17,555 - Generate Text Features Begin...
2024-05-08 06:16:19,180 - Generate Text Features Finished...
2024-05-08 06:16:19,181 - Load Video Features Begin...
2024-05-08 06:16:20,239 - Load Video Features Finished...
2024-05-08 06:16:21,847 - Load Audio Features Begin...
2024-05-08 06:16:26,263 - Load Audio Features Finished...
2024-05-08 06:16:38,607 - method  begins...
2024-05-08 06:16:41,315 - Multimodal intent recognition begins...
2024-05-08 06:16:41,315 - Training begins...
2024-05-08 06:17:13,693 - ***** Epoch: 1: Eval results *****
2024-05-08 06:17:13,694 -   train_loss = 3.3058
2024-05-08 06:17:13,694 -   best_eval_score = 0.0
2024-05-08 06:17:13,694 -   eval_score = 0.0058
2024-05-08 06:17:42,675 - ***** Epoch: 2: Eval results *****
2024-05-08 06:17:42,676 -   train_loss = 3.2179
2024-05-08 06:17:42,676 -   best_eval_score = 0.0058
2024-05-08 06:17:42,676 -   eval_score = 0.0058
2024-05-08 06:17:42,676 - EarlyStopping counter: 1 out of 8
2024-05-08 06:18:11,680 - ***** Epoch: 3: Eval results *****
2024-05-08 06:18:11,680 -   train_loss = 3.194
2024-05-08 06:18:11,680 -   best_eval_score = 0.0058
2024-05-08 06:18:11,680 -   eval_score = 0.0125
2024-05-08 06:18:40,588 - ***** Epoch: 4: Eval results *****
2024-05-08 06:18:40,588 -   train_loss = 3.1729
2024-05-08 06:18:40,588 -   best_eval_score = 0.0125
2024-05-08 06:18:40,588 -   eval_score = 0.0183
2024-05-08 06:19:10,164 - ***** Epoch: 5: Eval results *****
2024-05-08 06:19:10,164 -   train_loss = 3.1524
2024-05-08 06:19:10,164 -   best_eval_score = 0.0183
2024-05-08 06:19:10,164 -   eval_score = 0.0221
2024-05-08 06:19:39,135 - ***** Epoch: 6: Eval results *****
2024-05-08 06:19:39,135 -   train_loss = 3.1238
2024-05-08 06:19:39,135 -   best_eval_score = 0.0221
2024-05-08 06:19:39,135 -   eval_score = 0.0258
2024-05-08 06:20:08,195 - ***** Epoch: 7: Eval results *****
2024-05-08 06:20:08,195 -   train_loss = 3.0958
2024-05-08 06:20:08,196 -   best_eval_score = 0.0258
2024-05-08 06:20:08,196 -   eval_score = 0.0492
2024-05-08 06:20:37,757 - ***** Epoch: 8: Eval results *****
2024-05-08 06:20:37,757 -   train_loss = 3.0776
2024-05-08 06:20:37,757 -   best_eval_score = 0.0492
2024-05-08 06:20:37,757 -   eval_score = 0.0458
2024-05-08 06:20:37,757 - EarlyStopping counter: 1 out of 8
2024-05-08 06:21:07,346 - ***** Epoch: 9: Eval results *****
2024-05-08 06:21:07,346 -   train_loss = 3.0689
2024-05-08 06:21:07,347 -   best_eval_score = 0.0492
2024-05-08 06:21:07,347 -   eval_score = 0.0457
2024-05-08 06:21:07,347 - EarlyStopping counter: 2 out of 8
2024-05-08 06:21:37,116 - ***** Epoch: 10: Eval results *****
2024-05-08 06:21:37,116 -   train_loss = 3.0656
2024-05-08 06:21:37,116 -   best_eval_score = 0.0492
2024-05-08 06:21:37,116 -   eval_score = 0.0474
2024-05-08 06:21:37,116 - EarlyStopping counter: 3 out of 8
2024-05-08 06:22:06,360 - ***** Epoch: 11: Eval results *****
2024-05-08 06:22:06,361 -   train_loss = 3.0605
2024-05-08 06:22:06,361 -   best_eval_score = 0.0492
2024-05-08 06:22:06,361 -   eval_score = 0.048
2024-05-08 06:22:06,361 - EarlyStopping counter: 4 out of 8
2024-05-08 06:22:36,092 - ***** Epoch: 12: Eval results *****
2024-05-08 06:22:36,092 -   train_loss = 3.0518
2024-05-08 06:22:36,092 -   best_eval_score = 0.0492
2024-05-08 06:22:36,092 -   eval_score = 0.0488
2024-05-08 06:22:36,092 - EarlyStopping counter: 5 out of 8
2024-05-08 06:23:05,532 - ***** Epoch: 13: Eval results *****
2024-05-08 06:23:05,533 -   train_loss = 3.0502
2024-05-08 06:23:05,533 -   best_eval_score = 0.0492
2024-05-08 06:23:05,533 -   eval_score = 0.051
2024-05-08 06:23:34,759 - ***** Epoch: 14: Eval results *****
2024-05-08 06:23:34,760 -   train_loss = 3.0471
2024-05-08 06:23:34,760 -   best_eval_score = 0.051
2024-05-08 06:23:34,760 -   eval_score = 0.0516
2024-05-08 06:24:04,067 - ***** Epoch: 15: Eval results *****
2024-05-08 06:24:04,068 -   train_loss = 3.0437
2024-05-08 06:24:04,068 -   best_eval_score = 0.0516
2024-05-08 06:24:04,068 -   eval_score = 0.0534
2024-05-08 06:24:33,702 - ***** Epoch: 16: Eval results *****
2024-05-08 06:24:33,702 -   train_loss = 3.0429
2024-05-08 06:24:33,702 -   best_eval_score = 0.0534
2024-05-08 06:24:33,702 -   eval_score = 0.054
2024-05-08 06:25:03,543 - ***** Epoch: 17: Eval results *****
2024-05-08 06:25:03,543 -   train_loss = 3.0394
2024-05-08 06:25:03,543 -   best_eval_score = 0.054
2024-05-08 06:25:03,543 -   eval_score = 0.0548
2024-05-08 06:25:33,011 - ***** Epoch: 18: Eval results *****
2024-05-08 06:25:33,011 -   train_loss = 3.0408
2024-05-08 06:25:33,012 -   best_eval_score = 0.0548
2024-05-08 06:25:33,012 -   eval_score = 0.0559
2024-05-08 06:26:02,372 - ***** Epoch: 19: Eval results *****
2024-05-08 06:26:02,372 -   train_loss = 3.0388
2024-05-08 06:26:02,372 -   best_eval_score = 0.0559
2024-05-08 06:26:02,372 -   eval_score = 0.0569
2024-05-08 06:26:32,300 - ***** Epoch: 20: Eval results *****
2024-05-08 06:26:32,301 -   train_loss = 3.0403
2024-05-08 06:26:32,301 -   best_eval_score = 0.0569
2024-05-08 06:26:32,301 -   eval_score = 0.0569
2024-05-08 06:26:32,301 - EarlyStopping counter: 1 out of 8
2024-05-08 06:27:02,191 - ***** Epoch: 21: Eval results *****
2024-05-08 06:27:02,191 -   train_loss = 3.037
2024-05-08 06:27:02,191 -   best_eval_score = 0.0569
2024-05-08 06:27:02,191 -   eval_score = 0.0569
2024-05-08 06:27:02,191 - EarlyStopping counter: 2 out of 8
2024-05-08 06:27:31,741 - ***** Epoch: 22: Eval results *****
2024-05-08 06:27:31,741 -   train_loss = 3.039
2024-05-08 06:27:31,741 -   best_eval_score = 0.0569
2024-05-08 06:27:31,741 -   eval_score = 0.0569
2024-05-08 06:27:31,741 - EarlyStopping counter: 3 out of 8
2024-05-08 06:28:01,013 - ***** Epoch: 23: Eval results *****
2024-05-08 06:28:01,014 -   train_loss = 3.0416
2024-05-08 06:28:01,014 -   best_eval_score = 0.0569
2024-05-08 06:28:01,014 -   eval_score = 0.0569
2024-05-08 06:28:01,014 - EarlyStopping counter: 4 out of 8
2024-05-08 06:28:30,555 - ***** Epoch: 24: Eval results *****
2024-05-08 06:28:30,556 -   train_loss = 3.0413
2024-05-08 06:28:30,556 -   best_eval_score = 0.0569
2024-05-08 06:28:30,556 -   eval_score = 0.0569
2024-05-08 06:28:30,556 - EarlyStopping counter: 5 out of 8
2024-05-08 06:29:00,510 - ***** Epoch: 25: Eval results *****
2024-05-08 06:29:00,510 -   train_loss = 3.0387
2024-05-08 06:29:00,510 -   best_eval_score = 0.0569
2024-05-08 06:29:00,510 -   eval_score = 0.0572
2024-05-08 06:29:30,325 - ***** Epoch: 26: Eval results *****
2024-05-08 06:29:30,325 -   train_loss = 3.0373
2024-05-08 06:29:30,325 -   best_eval_score = 0.0572
2024-05-08 06:29:30,325 -   eval_score = 0.0572
2024-05-08 06:29:30,325 - EarlyStopping counter: 1 out of 8
2024-05-08 06:30:00,421 - ***** Epoch: 27: Eval results *****
2024-05-08 06:30:00,422 -   train_loss = 3.0381
2024-05-08 06:30:00,422 -   best_eval_score = 0.0572
2024-05-08 06:30:00,422 -   eval_score = 0.0572
2024-05-08 06:30:00,422 - EarlyStopping counter: 2 out of 8
2024-05-08 06:30:30,342 - ***** Epoch: 28: Eval results *****
2024-05-08 06:30:30,343 -   train_loss = 3.038
2024-05-08 06:30:30,343 -   best_eval_score = 0.0572
2024-05-08 06:30:30,343 -   eval_score = 0.0572
2024-05-08 06:30:30,343 - EarlyStopping counter: 3 out of 8
2024-05-08 06:31:01,218 - ***** Epoch: 29: Eval results *****
2024-05-08 06:31:01,219 -   train_loss = 3.0385
2024-05-08 06:31:01,219 -   best_eval_score = 0.0572
2024-05-08 06:31:01,219 -   eval_score = 0.0572
2024-05-08 06:31:01,219 - EarlyStopping counter: 4 out of 8
2024-05-08 06:31:32,821 - ***** Epoch: 30: Eval results *****
2024-05-08 06:31:32,821 -   train_loss = 3.0397
2024-05-08 06:31:32,821 -   best_eval_score = 0.0572
2024-05-08 06:31:32,821 -   eval_score = 0.0572
2024-05-08 06:31:32,821 - EarlyStopping counter: 5 out of 8
2024-05-08 06:32:02,680 - ***** Epoch: 31: Eval results *****
2024-05-08 06:32:02,681 -   train_loss = 3.0375
2024-05-08 06:32:02,681 -   best_eval_score = 0.0572
2024-05-08 06:32:02,681 -   eval_score = 0.0572
2024-05-08 06:32:02,681 - EarlyStopping counter: 6 out of 8
2024-05-08 06:32:33,345 - ***** Epoch: 32: Eval results *****
2024-05-08 06:32:33,345 -   train_loss = 3.0345
2024-05-08 06:32:33,345 -   best_eval_score = 0.0572
2024-05-08 06:32:33,345 -   eval_score = 0.0572
2024-05-08 06:32:33,345 - EarlyStopping counter: 7 out of 8
2024-05-08 06:33:03,601 - ***** Epoch: 33: Eval results *****
2024-05-08 06:33:03,601 -   train_loss = 3.038
2024-05-08 06:33:03,601 -   best_eval_score = 0.0572
2024-05-08 06:33:03,601 -   eval_score = 0.0572
2024-05-08 06:33:03,602 - EarlyStopping counter: 8 out of 8
2024-05-08 06:33:03,602 - EarlyStopping at epoch 33
2024-05-08 06:33:03,603 - Training is finished...
2024-05-08 06:33:03,603 - Testing begins...
2024-05-08 06:33:14,965 - ***** Test: Confusion Matrix *****
2024-05-08 06:33:14,968 - [[ 26   0   7   0   0   0   0   0   0   0   0   0  11   0   5   0   0  19
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  22   0   3   0   0  72
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  7   0   8   0   0   0   0   0   0   0   0   0   5   0  12   0   0  32
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  1   0   2   0   0   0   0   0   0   0   0   0   3   0  14   0   0  45
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   3   0   0   0   0  48
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   8   0   0   0   0  29
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  31   0   0   0   0  17
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  36   0   0   0   0  11
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   3   0  10   0   0  36
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  28   0  16   0   0  63
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  69   0   2   0   0  22
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  19   0   2   0   0  26
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0 126   0   1   0   0   8
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   2   0   1   0   0  14
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  17   0  51   0   0 125
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0  21
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  20   0   0   0   0  46
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   9   0   9   0   0 199
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   3   0   4   0   0  53
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   6   0   0   0   0  11
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   4   0   4   0   0  21
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  1   0   0   0   0   0   0   0   0   0   0   0   4   0   3   0   0  45
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0  17   0  36   0   0  50
    0   0   0   0  14   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   0  37
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  1   0   0   0   0   0   0   0   0   0   0   0   6   0  15   0   0  82
    0   0   0   0   0   0   9   0   0   0   0   0]
 [  1   0   0   0   0   0   0   0   0   0   0   0  11   0   0   0   0  19
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   1   0   7   0   0   9
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   8   0   8   0   0  42
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  2   0   0   0   0   0   0   0   0   0   0   0   0   0   3   0   0  53
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   1   0   0   0   0  18
    0   0   0   0   0   0   0   0   0   0   0   0]]
2024-05-08 06:33:14,968 - ***** Evaluation results *****
2024-05-08 06:33:14,968 -   acc = 0.213
2024-05-08 06:33:14,968 -   f1 = 0.066
2024-05-08 06:33:14,968 -   prec = 0.1269
2024-05-08 06:33:14,968 -   rec = 0.094
2024-05-08 06:33:14,968 - Testing is finished...
2024-05-08 06:33:14,969 - Multimodal intent recognition is finished...
2024-05-08 06:33:14,969 - Results are saved in results/ablation_msz.csv
