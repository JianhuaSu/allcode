2023-12-25 07:42:14,650 - ============================== Params ==============================
2023-12-25 07:42:14,651 - logger_name: msz_MIntRec_multi-class_seed-2_2023-12-25-07-42-14
2023-12-25 07:42:14,651 - dataset: MIntRec
2023-12-25 07:42:14,651 - data_mode: multi-class
2023-12-25 07:42:14,651 - method: msz
2023-12-25 07:42:14,651 - text_backbone: bert-base-uncased
2023-12-25 07:42:14,652 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-25 07:42:14,652 - seed: 2
2023-12-25 07:42:14,652 - num_workers: 8
2023-12-25 07:42:14,652 - gpu_id: 0
2023-12-25 07:42:14,652 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-25 07:42:14,653 - train: True
2023-12-25 07:42:14,653 - tune: False
2023-12-25 07:42:14,653 - save_model: False
2023-12-25 07:42:14,653 - save_results: True
2023-12-25 07:42:14,654 - log_path: logs
2023-12-25 07:42:14,654 - cache_path: 
2023-12-25 07:42:14,654 - video_data_path: video_data
2023-12-25 07:42:14,655 - audio_data_path: audio_data
2023-12-25 07:42:14,655 - video_feats_path: video_feats.pkl
2023-12-25 07:42:14,655 - audio_feats_path: audio_feats.pkl
2023-12-25 07:42:14,656 - results_path: results
2023-12-25 07:42:14,656 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-25 07:42:14,656 - model_path: models
2023-12-25 07:42:14,657 - config_file_name: msz
2023-12-25 07:42:14,657 - results_file_name: msz.csv
2023-12-25 07:42:14,657 - padding_mode: zero
2023-12-25 07:42:14,658 - padding_loc: end
2023-12-25 07:42:14,658 - need_aligned: False
2023-12-25 07:42:14,658 - eval_monitor: f1
2023-12-25 07:42:14,658 - train_batch_size: 16
2023-12-25 07:42:14,658 - eval_batch_size: 8
2023-12-25 07:42:14,658 - test_batch_size: 8
2023-12-25 07:42:14,658 - wait_patience: 8
2023-12-25 07:42:14,658 - nheads: 2
2023-12-25 07:42:14,658 - encoder_layers: 2
2023-12-25 07:42:14,658 - attn_dropout: 0.1
2023-12-25 07:42:14,658 - relu_dropout: 0.1
2023-12-25 07:42:14,658 - embed_dropout: 0.1
2023-12-25 07:42:14,658 - res_dropout: 0.1
2023-12-25 07:42:14,658 - attn_mask: False
2023-12-25 07:42:14,658 - hidden_size: 768
2023-12-25 07:42:14,658 - num_attention_heads: 12
2023-12-25 07:42:14,659 - attention_probs_dropout_prob: 0.2
2023-12-25 07:42:14,659 - hidden_dropout_prob: 0.2
2023-12-25 07:42:14,659 - intermediate_size: 768
2023-12-25 07:42:14,659 - num_hidden_layers: 3
2023-12-25 07:42:14,659 - max_position_embeddings: 512
2023-12-25 07:42:14,659 - position_embedding_type: absolute
2023-12-25 07:42:14,659 - add_cross_attention: True
2023-12-25 07:42:14,659 - batch_first: True
2023-12-25 07:42:14,659 - hidden_dims: 768
2023-12-25 07:42:14,659 - att_dropouts: [0.1, 0.1, 0.1]
2023-12-25 07:42:14,659 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-25 07:42:14,659 - sl: 0.1
2023-12-25 07:42:14,659 - cl: 0.1
2023-12-25 07:42:14,659 - num_train_epochs: 100
2023-12-25 07:42:14,659 - warmup_proportion: 0.1
2023-12-25 07:42:14,659 - lr: 3e-06
2023-12-25 07:42:14,659 - weight_decay: 0.01
2023-12-25 07:42:14,659 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2023-12-25-07-42-14
2023-12-25 07:42:14,659 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2023-12-25-07-42-14/models
2023-12-25 07:42:14,659 - ============================== End Params ==============================
2023-12-25 07:42:14,985 - Generate Text Features Begin...
2023-12-25 07:42:15,663 - Generate Text Features Finished...
2023-12-25 07:42:15,664 - Load Video Features Begin...
2023-12-25 07:42:16,527 - Load Video Features Finished...
2023-12-25 07:42:17,128 - Load Audio Features Begin...
2023-12-25 07:42:22,256 - Load Audio Features Finished...
2023-12-25 07:42:29,590 - method  begins...
2023-12-25 07:42:35,344 - Multimodal intent recognition begins...
2023-12-25 07:42:35,344 - Training begins...
2023-12-25 07:42:55,904 - ***** Epoch: 1: Eval results *****
2023-12-25 07:42:55,950 -   train_loss = 2.9213
2023-12-25 07:42:55,951 -   best_eval_score = 0.0
2023-12-25 07:42:55,952 -   eval_score = 0.0522
2023-12-25 07:43:11,075 - ***** Epoch: 2: Eval results *****
2023-12-25 07:43:11,076 -   train_loss = 2.6587
2023-12-25 07:43:11,076 -   best_eval_score = 0.0522
2023-12-25 07:43:11,076 -   eval_score = 0.1629
2023-12-25 07:43:25,104 - ***** Epoch: 3: Eval results *****
2023-12-25 07:43:25,105 -   train_loss = 2.2235
2023-12-25 07:43:25,105 -   best_eval_score = 0.1629
2023-12-25 07:43:25,106 -   eval_score = 0.3324
2023-12-25 07:43:39,742 - ***** Epoch: 4: Eval results *****
2023-12-25 07:43:39,742 -   train_loss = 1.7058
2023-12-25 07:43:39,742 -   best_eval_score = 0.3324
2023-12-25 07:43:39,742 -   eval_score = 0.444
2023-12-25 07:43:54,607 - ***** Epoch: 5: Eval results *****
2023-12-25 07:43:54,608 -   train_loss = 1.2788
2023-12-25 07:43:54,608 -   best_eval_score = 0.444
2023-12-25 07:43:54,608 -   eval_score = 0.547
2023-12-25 07:44:08,812 - ***** Epoch: 6: Eval results *****
2023-12-25 07:44:08,821 -   train_loss = 0.973
2023-12-25 07:44:08,822 -   best_eval_score = 0.547
2023-12-25 07:44:08,822 -   eval_score = 0.5464
2023-12-25 07:44:08,822 - EarlyStopping counter: 1 out of 8
2023-12-25 07:44:23,565 - ***** Epoch: 7: Eval results *****
2023-12-25 07:44:23,574 -   train_loss = 0.7721
2023-12-25 07:44:23,574 -   best_eval_score = 0.547
2023-12-25 07:44:23,574 -   eval_score = 0.5556
2023-12-25 07:44:37,548 - ***** Epoch: 8: Eval results *****
2023-12-25 07:44:37,557 -   train_loss = 0.587
2023-12-25 07:44:37,557 -   best_eval_score = 0.5556
2023-12-25 07:44:37,557 -   eval_score = 0.5809
2023-12-25 07:44:52,109 - ***** Epoch: 9: Eval results *****
2023-12-25 07:44:52,110 -   train_loss = 0.4224
2023-12-25 07:44:52,110 -   best_eval_score = 0.5809
2023-12-25 07:44:52,110 -   eval_score = 0.5539
2023-12-25 07:44:52,111 - EarlyStopping counter: 1 out of 8
2023-12-25 07:45:05,684 - ***** Epoch: 10: Eval results *****
2023-12-25 07:45:05,684 -   train_loss = 0.3103
2023-12-25 07:45:05,685 -   best_eval_score = 0.5809
2023-12-25 07:45:05,685 -   eval_score = 0.5956
2023-12-25 07:45:19,306 - ***** Epoch: 11: Eval results *****
2023-12-25 07:45:19,306 -   train_loss = 0.2215
2023-12-25 07:45:19,306 -   best_eval_score = 0.5956
2023-12-25 07:45:19,306 -   eval_score = 0.594
2023-12-25 07:45:19,306 - EarlyStopping counter: 1 out of 8
2023-12-25 07:45:34,563 - ***** Epoch: 12: Eval results *****
2023-12-25 07:45:34,564 -   train_loss = 0.1507
2023-12-25 07:45:34,564 -   best_eval_score = 0.5956
2023-12-25 07:45:34,564 -   eval_score = 0.6196
2023-12-25 07:45:47,936 - ***** Epoch: 13: Eval results *****
2023-12-25 07:45:47,937 -   train_loss = 0.1999
2023-12-25 07:45:47,937 -   best_eval_score = 0.6196
2023-12-25 07:45:47,937 -   eval_score = 0.6162
2023-12-25 07:45:47,937 - EarlyStopping counter: 1 out of 8
2023-12-25 07:46:01,686 - ***** Epoch: 14: Eval results *****
2023-12-25 07:46:01,687 -   train_loss = 0.1839
2023-12-25 07:46:01,687 -   best_eval_score = 0.6196
2023-12-25 07:46:01,687 -   eval_score = 0.603
2023-12-25 07:46:01,688 - EarlyStopping counter: 2 out of 8
2023-12-25 07:46:14,496 - ***** Epoch: 15: Eval results *****
2023-12-25 07:46:14,505 -   train_loss = 0.1437
2023-12-25 07:46:14,506 -   best_eval_score = 0.6196
2023-12-25 07:46:14,506 -   eval_score = 0.6032
2023-12-25 07:46:14,506 - EarlyStopping counter: 3 out of 8
2023-12-25 07:46:27,462 - ***** Epoch: 16: Eval results *****
2023-12-25 07:46:27,463 -   train_loss = 0.1527
2023-12-25 07:46:27,463 -   best_eval_score = 0.6196
2023-12-25 07:46:27,463 -   eval_score = 0.5851
2023-12-25 07:46:27,463 - EarlyStopping counter: 4 out of 8
2023-12-25 07:46:40,454 - ***** Epoch: 17: Eval results *****
2023-12-25 07:46:40,463 -   train_loss = 0.1259
2023-12-25 07:46:40,463 -   best_eval_score = 0.6196
2023-12-25 07:46:40,464 -   eval_score = 0.601
2023-12-25 07:46:40,464 - EarlyStopping counter: 5 out of 8
2023-12-25 07:46:53,361 - ***** Epoch: 18: Eval results *****
2023-12-25 07:46:53,361 -   train_loss = 0.1591
2023-12-25 07:46:53,361 -   best_eval_score = 0.6196
2023-12-25 07:46:53,361 -   eval_score = 0.5657
2023-12-25 07:46:53,361 - EarlyStopping counter: 6 out of 8
2023-12-25 07:47:06,129 - ***** Epoch: 19: Eval results *****
2023-12-25 07:47:06,138 -   train_loss = 0.1073
2023-12-25 07:47:06,138 -   best_eval_score = 0.6196
2023-12-25 07:47:06,138 -   eval_score = 0.5659
2023-12-25 07:47:06,138 - EarlyStopping counter: 7 out of 8
2023-12-25 07:47:19,326 - ***** Epoch: 20: Eval results *****
2023-12-25 07:47:19,335 -   train_loss = 0.1001
2023-12-25 07:47:19,335 -   best_eval_score = 0.6196
2023-12-25 07:47:19,335 -   eval_score = 0.612
2023-12-25 07:47:19,335 - EarlyStopping counter: 8 out of 8
2023-12-25 07:47:19,335 - EarlyStopping at epoch 20
2023-12-25 07:47:19,336 - Training is finished...
2023-12-25 07:47:19,337 - Testing begins...
2023-12-25 07:47:27,817 - ***** Test: Confusion Matrix *****
2023-12-25 07:47:27,838 - [[27  0  0  0  6  0  1  3  1  7  0  0  9  3  0  0  0  0  0  0]
 [ 1 35  0  0  0  1  0  3  0  0  0  0  1  2  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  1 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0 13  0  2  0  0  0  0  1  2  2  1  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  3  0  1  0  1  2  0  0  2  1  0  1  0  0  0  1]
 [ 4  0  0  0  0  0  0  5  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  1  3  1  0  0  0  0  1  0  1  1  0  0  0]
 [ 1  0  0  0  0  0  0  1  0  3  0  0  0  0  0  3  0  2  0  0]
 [ 1  0  0  0  0  0  0  0  0  1 15  0  1  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0  1]
 [ 3  0  0  0  0  0  1  0  0  1  1  0 39  0  3  7  2  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  0  2  1  7 14  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  2 13  0  3  0  0  1]
 [ 0  0  0  0  1  0  0  0  0  0  0  0  1  0  1 18  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  1  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  2  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  2  1  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0  0  8]]
2023-12-25 07:47:27,839 - ***** Evaluation results *****
2023-12-25 07:47:27,839 -   acc = 0.6809
2023-12-25 07:47:27,840 -   f1 = 0.649
2023-12-25 07:47:27,840 -   prec = 0.6607
2023-12-25 07:47:27,840 -   rec = 0.6557
2023-12-25 07:47:27,840 - Testing is finished...
2023-12-25 07:47:27,840 - Multimodal intent recognition is finished...
2023-12-25 07:47:27,842 - Results are saved in results/msz.csv
