2024-03-09 13:34:07,969 - ============================== Params ==============================
2024-03-09 13:34:07,969 - logger_name: msz_MIntRec_multi-class_seed-1_2024-03-09-13-34-07
2024-03-09 13:34:07,969 - dataset: MIntRec
2024-03-09 13:34:07,969 - data_mode: multi-class
2024-03-09 13:34:07,969 - method: msz
2024-03-09 13:34:07,969 - text_backbone: bert-base-uncased
2024-03-09 13:34:07,969 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-09 13:34:07,969 - seed: 1
2024-03-09 13:34:07,969 - num_workers: 8
2024-03-09 13:34:07,969 - gpu_id: 2
2024-03-09 13:34:07,969 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-09 13:34:07,969 - train: True
2024-03-09 13:34:07,969 - tune: True
2024-03-09 13:34:07,969 - save_model: False
2024-03-09 13:34:07,969 - save_results: True
2024-03-09 13:34:07,969 - log_path: logs
2024-03-09 13:34:07,969 - cache_path: 
2024-03-09 13:34:07,969 - video_data_path: video_data
2024-03-09 13:34:07,970 - audio_data_path: audio_data
2024-03-09 13:34:07,970 - video_feats_path: video_feats.pkl
2024-03-09 13:34:07,970 - audio_feats_path: audio_feats.pkl
2024-03-09 13:34:07,970 - results_path: results
2024-03-09 13:34:07,970 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-03-09 13:34:07,970 - model_path: models
2024-03-09 13:34:07,970 - config_file_name: msz_MIntRec
2024-03-09 13:34:07,970 - results_file_name: msz.csv
2024-03-09 13:34:07,970 - padding_mode: zero
2024-03-09 13:34:07,970 - padding_loc: end
2024-03-09 13:34:07,970 - need_aligned: False
2024-03-09 13:34:07,970 - eval_monitor: f1
2024-03-09 13:34:07,970 - train_batch_size: 16
2024-03-09 13:34:07,970 - eval_batch_size: 8
2024-03-09 13:34:07,970 - test_batch_size: 8
2024-03-09 13:34:07,970 - wait_patience: 8
2024-03-09 13:34:07,970 - hidden_dims: 768
2024-03-09 13:34:07,970 - intermediate_size: 768
2024-03-09 13:34:07,970 - position_embedding_type: absolute
2024-03-09 13:34:07,970 - batch_first: True
2024-03-09 13:34:07,970 - d_num_attention_heads: 8
2024-03-09 13:34:07,970 - d_attention_probs_dropout_prob: 0.1
2024-03-09 13:34:07,970 - d_hidden_dropout_prob: 0.2
2024-03-09 13:34:07,970 - d_num_hidden_layers: 10
2024-03-09 13:34:07,970 - d_max_position_embeddings: 768
2024-03-09 13:34:07,970 - m_num_attention_heads: 12
2024-03-09 13:34:07,970 - m_attention_probs_dropout_prob: 0.3
2024-03-09 13:34:07,970 - m_hidden_dropout_prob: 0.1
2024-03-09 13:34:07,970 - m_num_hidden_layers: 8
2024-03-09 13:34:07,970 - m_max_position_embeddings: 768
2024-03-09 13:34:07,970 - dropout: 0.1
2024-03-09 13:34:07,970 - aligned_method: conv1d
2024-03-09 13:34:07,970 - num_train_epochs: 100
2024-03-09 13:34:07,970 - lr: 8e-06
2024-03-09 13:34:07,970 - lr_mode: min
2024-03-09 13:34:07,970 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-03-09-13-34-07
2024-03-09 13:34:07,970 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-03-09-13-34-07/models
2024-03-09 13:34:07,970 - num_labels: 20
2024-03-09 13:34:07,971 - text_feat_dim: 768
2024-03-09 13:34:07,971 - video_feat_dim: 256
2024-03-09 13:34:07,971 - audio_feat_dim: 768
2024-03-09 13:34:07,971 - text_seq_len: 30
2024-03-09 13:34:07,971 - video_seq_len: 230
2024-03-09 13:34:07,971 - audio_seq_len: 480
2024-03-09 13:34:07,971 - device: cuda:2
2024-03-09 13:34:07,971 - ============================== End Params ==============================
2024-03-09 13:34:07,973 - Generate Text Features Begin...
2024-03-09 13:34:08,432 - Generate Text Features Finished...
2024-03-09 13:34:08,432 - Load Video Features Begin...
2024-03-09 13:34:08,720 - Load Video Features Finished...
2024-03-09 13:34:09,204 - Load Audio Features Begin...
2024-03-09 13:34:10,040 - Load Audio Features Finished...
2024-03-09 13:34:12,378 - method  begins...
2024-03-09 13:34:14,280 - Multimodal intent recognition begins...
2024-03-09 13:34:14,280 - Training begins...
2024-03-09 13:34:37,172 - ***** Epoch: 1: Eval results *****
2024-03-09 13:34:37,173 -   train_loss = 2.5486
2024-03-09 13:34:37,173 -   best_eval_score = 0.0
2024-03-09 13:34:37,173 -   eval_score = 0.3466
2024-03-09 13:34:59,361 - ***** Epoch: 2: Eval results *****
2024-03-09 13:34:59,361 -   train_loss = 1.4312
2024-03-09 13:34:59,361 -   best_eval_score = 0.3466
2024-03-09 13:34:59,361 -   eval_score = 0.5604
2024-03-09 13:35:22,104 - ***** Epoch: 3: Eval results *****
2024-03-09 13:35:22,104 -   train_loss = 0.7378
2024-03-09 13:35:22,104 -   best_eval_score = 0.5604
2024-03-09 13:35:22,104 -   eval_score = 0.6108
2024-03-09 13:35:44,733 - ***** Epoch: 4: Eval results *****
2024-03-09 13:35:44,733 -   train_loss = 0.4032
2024-03-09 13:35:44,733 -   best_eval_score = 0.6108
2024-03-09 13:35:44,733 -   eval_score = 0.6501
2024-03-09 13:36:07,095 - ***** Epoch: 5: Eval results *****
2024-03-09 13:36:07,095 -   train_loss = 0.2136
2024-03-09 13:36:07,095 -   best_eval_score = 0.6501
2024-03-09 13:36:07,095 -   eval_score = 0.6633
2024-03-09 13:36:29,195 - ***** Epoch: 6: Eval results *****
2024-03-09 13:36:29,195 -   train_loss = 0.1132
2024-03-09 13:36:29,195 -   best_eval_score = 0.6633
2024-03-09 13:36:29,195 -   eval_score = 0.697
2024-03-09 13:36:51,734 - ***** Epoch: 7: Eval results *****
2024-03-09 13:36:51,734 -   train_loss = 0.0538
2024-03-09 13:36:51,735 -   best_eval_score = 0.697
2024-03-09 13:36:51,735 -   eval_score = 0.6828
2024-03-09 13:36:51,735 - EarlyStopping counter: 1 out of 8
2024-03-09 13:37:14,468 - ***** Epoch: 8: Eval results *****
2024-03-09 13:37:14,469 -   train_loss = 0.0326
2024-03-09 13:37:14,469 -   best_eval_score = 0.697
2024-03-09 13:37:14,469 -   eval_score = 0.6843
2024-03-09 13:37:14,469 - EarlyStopping counter: 2 out of 8
2024-03-09 13:37:36,969 - ***** Epoch: 9: Eval results *****
2024-03-09 13:37:36,969 -   train_loss = 0.0201
2024-03-09 13:37:36,969 -   best_eval_score = 0.697
2024-03-09 13:37:36,969 -   eval_score = 0.699
2024-03-09 13:37:59,345 - ***** Epoch: 10: Eval results *****
2024-03-09 13:37:59,345 -   train_loss = 0.0172
2024-03-09 13:37:59,345 -   best_eval_score = 0.699
2024-03-09 13:37:59,345 -   eval_score = 0.6933
2024-03-09 13:37:59,345 - EarlyStopping counter: 1 out of 8
2024-03-09 13:38:21,511 - ***** Epoch: 11: Eval results *****
2024-03-09 13:38:21,511 -   train_loss = 0.0115
2024-03-09 13:38:21,511 -   best_eval_score = 0.699
2024-03-09 13:38:21,511 -   eval_score = 0.6957
2024-03-09 13:38:21,511 - EarlyStopping counter: 2 out of 8
2024-03-09 13:38:43,571 - ***** Epoch: 12: Eval results *****
2024-03-09 13:38:43,571 -   train_loss = 0.0107
2024-03-09 13:38:43,571 -   best_eval_score = 0.699
2024-03-09 13:38:43,571 -   eval_score = 0.6969
2024-03-09 13:38:43,571 - EarlyStopping counter: 3 out of 8
2024-03-09 13:39:05,324 - ***** Epoch: 13: Eval results *****
2024-03-09 13:39:05,324 -   train_loss = 0.0108
2024-03-09 13:39:05,324 -   best_eval_score = 0.699
2024-03-09 13:39:05,324 -   eval_score = 0.699
2024-03-09 13:39:27,415 - ***** Epoch: 14: Eval results *****
2024-03-09 13:39:27,415 -   train_loss = 0.0111
2024-03-09 13:39:27,415 -   best_eval_score = 0.699
2024-03-09 13:39:27,415 -   eval_score = 0.6992
2024-03-09 13:39:50,347 - ***** Epoch: 15: Eval results *****
2024-03-09 13:39:50,347 -   train_loss = 0.0107
2024-03-09 13:39:50,347 -   best_eval_score = 0.6992
2024-03-09 13:39:50,347 -   eval_score = 0.6968
2024-03-09 13:39:50,347 - EarlyStopping counter: 1 out of 8
2024-03-09 13:40:13,144 - ***** Epoch: 16: Eval results *****
2024-03-09 13:40:13,144 -   train_loss = 0.0099
2024-03-09 13:40:13,144 -   best_eval_score = 0.6992
2024-03-09 13:40:13,144 -   eval_score = 0.6968
2024-03-09 13:40:13,144 - EarlyStopping counter: 2 out of 8
2024-03-09 13:40:36,103 - ***** Epoch: 17: Eval results *****
2024-03-09 13:40:36,103 -   train_loss = 0.0091
2024-03-09 13:40:36,103 -   best_eval_score = 0.6992
2024-03-09 13:40:36,103 -   eval_score = 0.6952
2024-03-09 13:40:36,103 - EarlyStopping counter: 3 out of 8
2024-03-09 13:40:59,028 - ***** Epoch: 18: Eval results *****
2024-03-09 13:40:59,028 -   train_loss = 0.0093
2024-03-09 13:40:59,028 -   best_eval_score = 0.6992
2024-03-09 13:40:59,028 -   eval_score = 0.6978
2024-03-09 13:40:59,028 - EarlyStopping counter: 4 out of 8
2024-03-09 13:41:21,880 - ***** Epoch: 19: Eval results *****
2024-03-09 13:41:21,880 -   train_loss = 0.0087
2024-03-09 13:41:21,880 -   best_eval_score = 0.6992
2024-03-09 13:41:21,880 -   eval_score = 0.6969
2024-03-09 13:41:21,880 - EarlyStopping counter: 5 out of 8
2024-03-09 13:41:44,417 - ***** Epoch: 20: Eval results *****
2024-03-09 13:41:44,417 -   train_loss = 0.0083
2024-03-09 13:41:44,417 -   best_eval_score = 0.6992
2024-03-09 13:41:44,417 -   eval_score = 0.6971
2024-03-09 13:41:44,417 - EarlyStopping counter: 6 out of 8
2024-03-09 13:42:05,780 - ***** Epoch: 21: Eval results *****
2024-03-09 13:42:05,780 -   train_loss = 0.009
2024-03-09 13:42:05,780 -   best_eval_score = 0.6992
2024-03-09 13:42:05,781 -   eval_score = 0.6992
2024-03-09 13:42:05,781 - EarlyStopping counter: 7 out of 8
2024-03-09 13:42:27,777 - ***** Epoch: 22: Eval results *****
2024-03-09 13:42:27,777 -   train_loss = 0.0082
2024-03-09 13:42:27,777 -   best_eval_score = 0.6992
2024-03-09 13:42:27,778 -   eval_score = 0.6988
2024-03-09 13:42:27,778 - EarlyStopping counter: 8 out of 8
2024-03-09 13:42:27,778 - EarlyStopping at epoch 22
2024-03-09 13:42:27,783 - Training is finished...
2024-03-09 13:42:27,783 - Testing begins...
2024-03-09 13:42:31,901 - ***** Test: Confusion Matrix *****
2024-03-09 13:42:31,902 - [[39  3  0  0  8  0  0  1  0  1  1  0  3  1  0  0  0  0  0  0]
 [ 0 34  0  1  0  3  1  0  0  0  1  0  2  0  1  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 7  0  0  0 11  0  1  0  0  0  0  1  1  0  1  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 1  1  0  0  3  0  2  0  2  0  0  0  1  0  0  1  1  0  0  0]
 [ 3  0  0  0  0  0  0  4  1  2  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  2  4  0  0  0  0  2  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  1  0  0  4  1  0  0  0  0  2  0  1  0  0]
 [ 1  0  0  0  0  0  1  0  0  2 13  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 16  0  0  0  0  0  0  1  1]
 [ 4  3  0  0  1  0  0  0  0  0  0  1 41  3  3  0  1  0  0  0]
 [ 0  0  0  0  0  0  2  0  0  0  1  1  0 20  0  1  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  0  0  0  0  0  3 14  0  1  0  0  3]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  4  0  0 15  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  2  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  2  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  1  0  0  6]]
2024-03-09 13:42:31,902 - ***** Evaluation results *****
2024-03-09 13:42:31,902 -   acc = 0.7101
2024-03-09 13:42:31,902 -   f1 = 0.6732
2024-03-09 13:42:31,902 -   prec = 0.6824
2024-03-09 13:42:31,902 -   rec = 0.6691
2024-03-09 13:42:31,903 - Testing is finished...
2024-03-09 13:42:31,903 - Multimodal intent recognition is finished...
2024-03-09 13:42:31,903 - Results are saved in results/msz.csv
