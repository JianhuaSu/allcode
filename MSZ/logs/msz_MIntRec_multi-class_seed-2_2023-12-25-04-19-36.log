2023-12-25 04:19:36,789 - ============================== Params ==============================
2023-12-25 04:19:36,789 - logger_name: msz_MIntRec_multi-class_seed-2_2023-12-25-04-19-36
2023-12-25 04:19:36,789 - dataset: MIntRec
2023-12-25 04:19:36,789 - data_mode: multi-class
2023-12-25 04:19:36,789 - method: msz
2023-12-25 04:19:36,789 - text_backbone: bert-base-uncased
2023-12-25 04:19:36,789 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-25 04:19:36,789 - seed: 2
2023-12-25 04:19:36,789 - num_workers: 8
2023-12-25 04:19:36,789 - gpu_id: 0
2023-12-25 04:19:36,789 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-25 04:19:36,789 - train: True
2023-12-25 04:19:36,789 - tune: False
2023-12-25 04:19:36,789 - save_model: False
2023-12-25 04:19:36,789 - save_results: True
2023-12-25 04:19:36,789 - log_path: logs
2023-12-25 04:19:36,789 - cache_path: 
2023-12-25 04:19:36,789 - video_data_path: video_data
2023-12-25 04:19:36,789 - audio_data_path: audio_data
2023-12-25 04:19:36,790 - video_feats_path: video_feats.pkl
2023-12-25 04:19:36,790 - audio_feats_path: audio_feats.pkl
2023-12-25 04:19:36,790 - results_path: results
2023-12-25 04:19:36,790 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-25 04:19:36,790 - model_path: models
2023-12-25 04:19:36,790 - config_file_name: msz
2023-12-25 04:19:36,790 - results_file_name: msz.csv
2023-12-25 04:19:36,790 - padding_mode: zero
2023-12-25 04:19:36,790 - padding_loc: end
2023-12-25 04:19:36,790 - need_aligned: False
2023-12-25 04:19:36,790 - eval_monitor: f1
2023-12-25 04:19:36,790 - train_batch_size: 16
2023-12-25 04:19:36,790 - eval_batch_size: 8
2023-12-25 04:19:36,790 - test_batch_size: 8
2023-12-25 04:19:36,790 - wait_patience: 8
2023-12-25 04:19:36,790 - nheads: 2
2023-12-25 04:19:36,790 - encoder_layers: 1
2023-12-25 04:19:36,790 - attn_dropout: 0.1
2023-12-25 04:19:36,790 - relu_dropout: 0.1
2023-12-25 04:19:36,790 - embed_dropout: 0.1
2023-12-25 04:19:36,790 - res_dropout: 0.1
2023-12-25 04:19:36,790 - attn_mask: False
2023-12-25 04:19:36,790 - hidden_size: 768
2023-12-25 04:19:36,790 - num_attention_heads: 12
2023-12-25 04:19:36,790 - attention_probs_dropout_prob: 0.2
2023-12-25 04:19:36,790 - hidden_dropout_prob: 0.2
2023-12-25 04:19:36,790 - intermediate_size: 768
2023-12-25 04:19:36,790 - num_hidden_layers: 3
2023-12-25 04:19:36,790 - max_position_embeddings: 512
2023-12-25 04:19:36,790 - position_embedding_type: absolute
2023-12-25 04:19:36,790 - add_cross_attention: True
2023-12-25 04:19:36,790 - batch_first: True
2023-12-25 04:19:36,790 - hidden_dims: 768
2023-12-25 04:19:36,790 - att_dropouts: [0.1, 0.1, 0.1]
2023-12-25 04:19:36,790 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-25 04:19:36,790 - sl: 0.1
2023-12-25 04:19:36,790 - cl: 0.1
2023-12-25 04:19:36,790 - num_train_epochs: 100
2023-12-25 04:19:36,790 - warmup_proportion: 0.1
2023-12-25 04:19:36,790 - lr: 5e-06
2023-12-25 04:19:36,790 - weight_decay: 0.01
2023-12-25 04:19:36,790 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2023-12-25-04-19-36
2023-12-25 04:19:36,790 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2023-12-25-04-19-36/models
2023-12-25 04:19:36,791 - ============================== End Params ==============================
2023-12-25 04:19:38,883 - Generate Text Features Begin...
2023-12-25 04:19:40,570 - Generate Text Features Finished...
2023-12-25 04:19:40,585 - Load Video Features Begin...
2023-12-25 04:19:41,496 - Load Video Features Finished...
2023-12-25 04:19:42,231 - Load Audio Features Begin...
2023-12-25 04:22:13,361 - Load Audio Features Finished...
2023-12-25 04:22:18,041 - method  begins...
2023-12-25 04:22:23,604 - Multimodal intent recognition begins...
2023-12-25 04:22:23,605 - Training begins...
2023-12-25 04:22:42,512 - ***** Epoch: 1: Eval results *****
2023-12-25 04:22:42,513 -   train_loss = 2.9572
2023-12-25 04:22:42,513 -   best_eval_score = 0.0
2023-12-25 04:22:42,514 -   eval_score = 0.07
2023-12-25 04:23:00,195 - ***** Epoch: 2: Eval results *****
2023-12-25 04:23:00,195 -   train_loss = 2.7301
2023-12-25 04:23:00,195 -   best_eval_score = 0.07
2023-12-25 04:23:00,195 -   eval_score = 0.1761
2023-12-25 04:23:16,588 - ***** Epoch: 3: Eval results *****
2023-12-25 04:23:16,589 -   train_loss = 2.2518
2023-12-25 04:23:16,590 -   best_eval_score = 0.1761
2023-12-25 04:23:16,590 -   eval_score = 0.3085
2023-12-25 04:23:34,090 - ***** Epoch: 4: Eval results *****
2023-12-25 04:23:34,091 -   train_loss = 1.6963
2023-12-25 04:23:34,091 -   best_eval_score = 0.3085
2023-12-25 04:23:34,092 -   eval_score = 0.4365
2023-12-25 04:23:50,882 - ***** Epoch: 5: Eval results *****
2023-12-25 04:23:50,891 -   train_loss = 1.3163
2023-12-25 04:23:50,891 -   best_eval_score = 0.4365
2023-12-25 04:23:50,891 -   eval_score = 0.4579
2023-12-25 04:24:07,976 - ***** Epoch: 6: Eval results *****
2023-12-25 04:24:07,976 -   train_loss = 1.0882
2023-12-25 04:24:07,977 -   best_eval_score = 0.4579
2023-12-25 04:24:07,977 -   eval_score = 0.5243
2023-12-25 04:24:24,873 - ***** Epoch: 7: Eval results *****
2023-12-25 04:24:24,874 -   train_loss = 0.8894
2023-12-25 04:24:24,874 -   best_eval_score = 0.5243
2023-12-25 04:24:24,874 -   eval_score = 0.526
2023-12-25 04:24:41,765 - ***** Epoch: 8: Eval results *****
2023-12-25 04:24:41,766 -   train_loss = 0.8618
2023-12-25 04:24:41,767 -   best_eval_score = 0.526
2023-12-25 04:24:41,768 -   eval_score = 0.4981
2023-12-25 04:24:41,769 - EarlyStopping counter: 1 out of 8
2023-12-25 04:24:58,381 - ***** Epoch: 9: Eval results *****
2023-12-25 04:24:58,381 -   train_loss = 0.7232
2023-12-25 04:24:58,381 -   best_eval_score = 0.526
2023-12-25 04:24:58,382 -   eval_score = 0.5377
2023-12-25 04:25:15,549 - ***** Epoch: 10: Eval results *****
2023-12-25 04:25:15,558 -   train_loss = 0.7186
2023-12-25 04:25:15,558 -   best_eval_score = 0.5377
2023-12-25 04:25:15,558 -   eval_score = 0.4853
2023-12-25 04:25:15,558 - EarlyStopping counter: 1 out of 8
2023-12-25 04:25:31,171 - ***** Epoch: 11: Eval results *****
2023-12-25 04:25:31,171 -   train_loss = 0.7648
2023-12-25 04:25:31,171 -   best_eval_score = 0.5377
2023-12-25 04:25:31,171 -   eval_score = 0.5218
2023-12-25 04:25:31,171 - EarlyStopping counter: 2 out of 8
2023-12-25 04:25:47,378 - ***** Epoch: 12: Eval results *****
2023-12-25 04:25:47,379 -   train_loss = 0.931
2023-12-25 04:25:47,380 -   best_eval_score = 0.5377
2023-12-25 04:25:47,380 -   eval_score = 0.5128
2023-12-25 04:25:47,381 - EarlyStopping counter: 3 out of 8
2023-12-25 04:26:04,049 - ***** Epoch: 13: Eval results *****
2023-12-25 04:26:04,050 -   train_loss = 0.9196
2023-12-25 04:26:04,050 -   best_eval_score = 0.5377
2023-12-25 04:26:04,050 -   eval_score = 0.503
2023-12-25 04:26:04,050 - EarlyStopping counter: 4 out of 8
2023-12-25 04:26:21,366 - ***** Epoch: 14: Eval results *****
2023-12-25 04:26:21,374 -   train_loss = 0.6988
2023-12-25 04:26:21,375 -   best_eval_score = 0.5377
2023-12-25 04:26:21,375 -   eval_score = 0.5261
2023-12-25 04:26:21,375 - EarlyStopping counter: 5 out of 8
2023-12-25 04:26:37,743 - ***** Epoch: 15: Eval results *****
2023-12-25 04:26:37,752 -   train_loss = 0.7831
2023-12-25 04:26:37,752 -   best_eval_score = 0.5377
2023-12-25 04:26:37,752 -   eval_score = 0.4726
2023-12-25 04:26:37,752 - EarlyStopping counter: 6 out of 8
2023-12-25 04:26:53,829 - ***** Epoch: 16: Eval results *****
2023-12-25 04:26:53,831 -   train_loss = 0.7514
2023-12-25 04:26:53,831 -   best_eval_score = 0.5377
2023-12-25 04:26:53,832 -   eval_score = 0.5069
2023-12-25 04:26:53,833 - EarlyStopping counter: 7 out of 8
2023-12-25 04:27:10,787 - ***** Epoch: 17: Eval results *****
2023-12-25 04:27:10,788 -   train_loss = 0.6052
2023-12-25 04:27:10,789 -   best_eval_score = 0.5377
2023-12-25 04:27:10,789 -   eval_score = 0.5131
2023-12-25 04:27:10,790 - EarlyStopping counter: 8 out of 8
2023-12-25 04:27:10,790 - EarlyStopping at epoch 17
2023-12-25 04:27:10,792 - Training is finished...
2023-12-25 04:27:10,793 - Testing begins...
2023-12-25 04:27:15,476 - ***** Test: Confusion Matrix *****
2023-12-25 04:27:15,477 - [[19  3  1  0  9  1  2  2  0  7  0  0  8  2  1  0  0  2  0  0]
 [ 0 40  0  1  0  0  0  0  0  0  0  0  1  0  1  0  0  0  0  0]
 [ 0  0 26  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  2  0  0 12  0  1  0  0  4  0  0  0  2  1  0  0  1  0  0]
 [ 0  0  0  0  0 10  0  0  0  1  0  0  0  0  0  0  0  1  0  0]
 [ 0  5  0  0  1  0  0  0  0  2  0  0  2  0  2  0  0  0  0  0]
 [ 1  1  0  0  0  0  0  4  0  2  0  0  1  0  1  0  0  0  0  0]
 [ 1  0  0  0  2  0  0  4  2  0  0  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  0  3  0  0  2  0  1  1  0  2  0  0]
 [ 0  1  0  0  0  1  0  0  0  3 10  0  1  0  0  0  0  2  0  0]
 [ 0  1  1  0  1  0  0  0  1  0  0 11  1  0  2  0  0  0  0  1]
 [ 2  6  0  4  2  1  0  1  0  3  0  0 27  0  4  1  3  2  0  1]
 [ 0  4  0  0  0  0  0  0  0  0  3  1  2 10  3  0  0  0  0  2]
 [ 0  0  1  0  1  0  0  0  0  0  0  0  1  2 13  0  3  0  0  1]
 [ 0  3  0  2  0  1  0  0  1  0  0  0  6  0  1  6  1  0  0  0]
 [ 2  0  0  0  0  0  0  1  0  0  0  0  1  0  0  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0 14  0  0]
 [ 0  1  0  1  0  1  0  0  0  0  0  0  3  0  0  1  2  0  3  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  1  1  0  4  0  0  3]]
2023-12-25 04:27:15,477 - ***** Evaluation results *****
2023-12-25 04:27:15,477 -   acc = 0.564
2023-12-25 04:27:15,477 -   f1 = 0.5109
2023-12-25 04:27:15,477 -   prec = 0.5617
2023-12-25 04:27:15,477 -   rec = 0.5307
2023-12-25 04:27:15,477 - Testing is finished...
2023-12-25 04:27:15,477 - Multimodal intent recognition is finished...
2023-12-25 04:27:15,478 - Results are saved in results/msz.csv
