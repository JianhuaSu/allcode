2024-04-27 06:41:39,058 - Lists of intent labels are: ['Acknowledge', 'Advise', 'Agree', 'Apologise', 'Arrange', 'Ask for help', 'Asking for opinions', 'Care', 'Comfort', 'Complain', 'Confirm', 'Criticize', 'Doubt', 'Emphasize', 'Explain', 'Flaunt', 'Greet', 'Inform', 'Introduce', 'Invite', 'Joke', 'Leave', 'Oppose', 'Plan', 'Praise', 'Prevent', 'Refuse', 'Taunt', 'Thank', 'Warn']
2024-04-27 06:41:39,058 - ID Data preparation...
2024-04-27 06:41:59,587 - OOD Data preparation...
2024-04-27 06:42:04,190 - ============================== Params ==============================
2024-04-27 06:42:04,190 - logger_name: mmim_ma_MIntRec2_multi-class_0
2024-04-27 06:42:04,190 - dataset: MIntRec2
2024-04-27 06:42:04,190 - ood_dataset: MIntRec2-OOD
2024-04-27 06:42:04,190 - data_mode: multi-class
2024-04-27 06:42:04,190 - multimodal_method: mmim
2024-04-27 06:42:04,190 - method: mmim
2024-04-27 06:42:04,190 - ood_detection_method: ma
2024-04-27 06:42:04,190 - text_backbone: bert-base-uncased
2024-04-27 06:42:04,190 - seed: 1
2024-04-27 06:42:04,190 - num_workers: 8
2024-04-27 06:42:04,190 - log_id: mmim_ma_MIntRec2_multi-class_0_2024-04-27-06-41-39
2024-04-27 06:42:04,190 - gpu_id: 2
2024-04-27 06:42:04,190 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-27 06:42:04,190 - train: True
2024-04-27 06:42:04,190 - tune: True
2024-04-27 06:42:04,190 - ood: True
2024-04-27 06:42:04,190 - save_model: False
2024-04-27 06:42:04,190 - save_results: True
2024-04-27 06:42:04,190 - log_path: logs
2024-04-27 06:42:04,190 - cache_path: cache
2024-04-27 06:42:04,190 - video_data_path: video_data
2024-04-27 06:42:04,190 - audio_data_path: audio_data
2024-04-27 06:42:04,190 - video_feats_path: swin_feats.pkl
2024-04-27 06:42:04,190 - ood_video_feats_path: swin_feats.pkl
2024-04-27 06:42:04,190 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-27 06:42:04,190 - audio_feats_path: wavlm_feats.pkl
2024-04-27 06:42:04,190 - results_path: results
2024-04-27 06:42:04,190 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim
2024-04-27 06:42:04,191 - model_path: models
2024-04-27 06:42:04,191 - config_file_name: mmim_MIntRec2
2024-04-27 06:42:04,191 - results_file_name: results_mmim_MIntRec2.csv
2024-04-27 06:42:04,191 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-27 06:42:04,191 - text_seq_len: 50
2024-04-27 06:42:04,191 - video_seq_len: 180
2024-04-27 06:42:04,191 - audio_seq_len: 400
2024-04-27 06:42:04,191 - text_feat_dim: 768
2024-04-27 06:42:04,191 - video_feat_dim: 256
2024-04-27 06:42:04,191 - audio_feat_dim: 768
2024-04-27 06:42:04,191 - ood_label_id: 30
2024-04-27 06:42:04,191 - num_labels: 30
2024-04-27 06:42:04,191 - num_train_examples: 6165
2024-04-27 06:42:04,191 - need_aligned: False
2024-04-27 06:42:04,191 - eval_monitor: f1
2024-04-27 06:42:04,191 - train_batch_size: 32
2024-04-27 06:42:04,191 - eval_batch_size: 16
2024-04-27 06:42:04,191 - test_batch_size: 16
2024-04-27 06:42:04,191 - wait_patience: 3
2024-04-27 06:42:04,191 - num_train_epochs: 100
2024-04-27 06:42:04,191 - add_va: False
2024-04-27 06:42:04,191 - cpc_activation: Tanh
2024-04-27 06:42:04,191 - mmilb_mid_activation: ReLU
2024-04-27 06:42:04,191 - mmilb_last_activation: Tanh
2024-04-27 06:42:04,191 - optim: Adam
2024-04-27 06:42:04,191 - contrast: True
2024-04-27 06:42:04,191 - bidirectional: True
2024-04-27 06:42:04,191 - grad_clip: 1.0
2024-04-27 06:42:04,191 - lr_main: [0.0002]
2024-04-27 06:42:04,191 - weight_decay_main: [0.0003]
2024-04-27 06:42:04,191 - lr_bert: [4e-05]
2024-04-27 06:42:04,191 - weight_decay_bert: [5e-05]
2024-04-27 06:42:04,191 - lr_mmilb: [0.003]
2024-04-27 06:42:04,191 - weight_decay_mmilb: [0.0001]
2024-04-27 06:42:04,191 - alpha: [0.1]
2024-04-27 06:42:04,191 - dropout_a: [0.1]
2024-04-27 06:42:04,191 - dropout_v: [0.1]
2024-04-27 06:42:04,191 - dropout_prj: [0.1]
2024-04-27 06:42:04,191 - n_layer: [1]
2024-04-27 06:42:04,191 - cpc_layers: [1]
2024-04-27 06:42:04,191 - d_vh: [16]
2024-04-27 06:42:04,191 - d_ah: [16]
2024-04-27 06:42:04,191 - d_vout: [8]
2024-04-27 06:42:04,191 - d_aout: [16]
2024-04-27 06:42:04,191 - d_prjh: [512]
2024-04-27 06:42:04,192 - scale: [20]
2024-04-27 06:42:04,192 - beta: [0.5]
2024-04-27 06:42:04,192 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim/mmim_MIntRec2_bert-base-uncased_multi-class_1
2024-04-27 06:42:04,192 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim/mmim_MIntRec2_bert-base-uncased_multi-class_1/models
2024-04-27 06:42:04,192 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim/binary_mmim_MIntRec2_bert-base-uncased_1
2024-04-27 06:42:04,192 - ============================== End Params ==============================
2024-04-27 06:42:07,107 - Multimodal Intent Recognition begins...
2024-04-27 06:42:07,107 - Training begins...
2024-04-27 06:43:35,422 - ***** Epoch: 1: Eval results *****
2024-04-27 06:43:35,422 -   best_eval_score = 0.0
2024-04-27 06:43:35,422 -   eval_score = 0.4763
2024-04-27 06:43:35,422 -   train_loss_main = 2.819
2024-04-27 06:43:35,422 -   train_loss_mmilb = 0.0741
2024-04-27 06:45:04,337 - ***** Epoch: 2: Eval results *****
2024-04-27 06:45:04,338 -   best_eval_score = 0.4763
2024-04-27 06:45:04,338 -   eval_score = 0.4875
2024-04-27 06:45:04,338 -   train_loss_main = 2.0563
2024-04-27 06:45:04,338 -   train_loss_mmilb = 0.0004
2024-04-27 06:46:33,310 - ***** Epoch: 3: Eval results *****
2024-04-27 06:46:33,310 -   best_eval_score = 0.4875
2024-04-27 06:46:33,310 -   eval_score = 0.5006
2024-04-27 06:46:33,310 -   train_loss_main = 1.5323
2024-04-27 06:46:33,310 -   train_loss_mmilb = 0.0002
2024-04-27 06:48:02,478 - ***** Epoch: 4: Eval results *****
2024-04-27 06:48:02,479 -   best_eval_score = 0.5006
2024-04-27 06:48:02,479 -   eval_score = 0.5133
2024-04-27 06:48:02,479 -   train_loss_main = 1.2113
2024-04-27 06:48:02,479 -   train_loss_mmilb = 0.0002
2024-04-27 06:49:30,970 - ***** Epoch: 5: Eval results *****
2024-04-27 06:49:30,971 -   best_eval_score = 0.5133
2024-04-27 06:49:30,971 -   eval_score = 0.4903
2024-04-27 06:49:30,971 -   train_loss_main = 1.0767
2024-04-27 06:49:30,971 -   train_loss_mmilb = 0.0002
2024-04-27 06:49:30,971 - EarlyStopping counter: 1 out of 3
2024-04-27 06:50:59,130 - ***** Epoch: 6: Eval results *****
2024-04-27 06:50:59,131 -   best_eval_score = 0.5133
2024-04-27 06:50:59,132 -   eval_score = 0.4895
2024-04-27 06:50:59,132 -   train_loss_main = 1.0142
2024-04-27 06:50:59,132 -   train_loss_mmilb = 0.0002
2024-04-27 06:50:59,132 - EarlyStopping counter: 2 out of 3
2024-04-27 06:52:28,945 - ***** Epoch: 7: Eval results *****
2024-04-27 06:52:28,946 -   best_eval_score = 0.5133
2024-04-27 06:52:28,946 -   eval_score = 0.4941
2024-04-27 06:52:28,946 -   train_loss_main = 0.9624
2024-04-27 06:52:28,946 -   train_loss_mmilb = 0.0002
2024-04-27 06:52:28,946 - EarlyStopping counter: 3 out of 3
2024-04-27 06:52:28,946 - EarlyStopping at epoch 7
2024-04-27 06:52:29,031 - Training is finished...
2024-04-27 06:52:29,032 - Testing begins...
2024-04-27 06:53:26,577 - ***** Out-of-domain Evaluation results *****
2024-04-27 06:53:26,577 -   aupr_in = 0.5689
2024-04-27 06:53:26,578 -   aupr_out = 0.444
2024-04-27 06:53:26,578 -   auroc = 0.5088
2024-04-27 06:53:26,578 -   der = 0.5556
2024-04-27 06:53:26,578 -   eer = 0.492
2024-04-27 06:53:26,578 -   fpr95 = 0.9437
2024-04-27 06:53:26,578 - Testing is finished...
2024-04-27 06:53:26,578 - Multimodal intent recognition is finished...
2024-04-27 06:53:26,578 - Results are saved in results/results_mmim_MIntRec2.csv
2024-04-27 06:53:26,648 - ============================== Params ==============================
2024-04-27 06:53:26,648 - logger_name: mmim_ma_MIntRec2_multi-class_0
2024-04-27 06:53:26,648 - dataset: MIntRec2
2024-04-27 06:53:26,648 - ood_dataset: MIntRec2-OOD
2024-04-27 06:53:26,648 - data_mode: multi-class
2024-04-27 06:53:26,648 - multimodal_method: mmim
2024-04-27 06:53:26,648 - method: mmim
2024-04-27 06:53:26,648 - ood_detection_method: ma
2024-04-27 06:53:26,648 - text_backbone: bert-base-uncased
2024-04-27 06:53:26,648 - seed: 2
2024-04-27 06:53:26,648 - num_workers: 8
2024-04-27 06:53:26,648 - log_id: mmim_ma_MIntRec2_multi-class_0_2024-04-27-06-41-39
2024-04-27 06:53:26,648 - gpu_id: 2
2024-04-27 06:53:26,648 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-27 06:53:26,648 - train: True
2024-04-27 06:53:26,648 - tune: True
2024-04-27 06:53:26,649 - ood: True
2024-04-27 06:53:26,649 - save_model: False
2024-04-27 06:53:26,649 - save_results: True
2024-04-27 06:53:26,649 - log_path: logs
2024-04-27 06:53:26,649 - cache_path: cache
2024-04-27 06:53:26,649 - video_data_path: video_data
2024-04-27 06:53:26,649 - audio_data_path: audio_data
2024-04-27 06:53:26,649 - video_feats_path: swin_feats.pkl
2024-04-27 06:53:26,649 - ood_video_feats_path: swin_feats.pkl
2024-04-27 06:53:26,649 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-27 06:53:26,649 - audio_feats_path: wavlm_feats.pkl
2024-04-27 06:53:26,649 - results_path: results
2024-04-27 06:53:26,649 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim
2024-04-27 06:53:26,649 - model_path: models
2024-04-27 06:53:26,649 - config_file_name: mmim_MIntRec2
2024-04-27 06:53:26,649 - results_file_name: results_mmim_MIntRec2.csv
2024-04-27 06:53:26,649 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-27 06:53:26,649 - text_seq_len: 50
2024-04-27 06:53:26,649 - video_seq_len: 180
2024-04-27 06:53:26,649 - audio_seq_len: 400
2024-04-27 06:53:26,649 - text_feat_dim: 768
2024-04-27 06:53:26,649 - video_feat_dim: 256
2024-04-27 06:53:26,649 - audio_feat_dim: 768
2024-04-27 06:53:26,649 - ood_label_id: 30
2024-04-27 06:53:26,649 - num_labels: 30
2024-04-27 06:53:26,649 - num_train_examples: 6165
2024-04-27 06:53:26,649 - need_aligned: False
2024-04-27 06:53:26,649 - eval_monitor: f1
2024-04-27 06:53:26,649 - train_batch_size: 32
2024-04-27 06:53:26,649 - eval_batch_size: 16
2024-04-27 06:53:26,649 - test_batch_size: 16
2024-04-27 06:53:26,649 - wait_patience: 3
2024-04-27 06:53:26,649 - num_train_epochs: 100
2024-04-27 06:53:26,649 - add_va: False
2024-04-27 06:53:26,649 - cpc_activation: Tanh
2024-04-27 06:53:26,649 - mmilb_mid_activation: ReLU
2024-04-27 06:53:26,649 - mmilb_last_activation: Tanh
2024-04-27 06:53:26,649 - optim: Adam
2024-04-27 06:53:26,649 - contrast: True
2024-04-27 06:53:26,649 - bidirectional: True
2024-04-27 06:53:26,650 - grad_clip: 1.0
2024-04-27 06:53:26,650 - lr_main: [0.0002]
2024-04-27 06:53:26,650 - weight_decay_main: [0.0003]
2024-04-27 06:53:26,650 - lr_bert: [4e-05]
2024-04-27 06:53:26,650 - weight_decay_bert: [5e-05]
2024-04-27 06:53:26,650 - lr_mmilb: [0.003]
2024-04-27 06:53:26,650 - weight_decay_mmilb: [0.0001]
2024-04-27 06:53:26,650 - alpha: [0.1]
2024-04-27 06:53:26,650 - dropout_a: [0.1]
2024-04-27 06:53:26,650 - dropout_v: [0.1]
2024-04-27 06:53:26,650 - dropout_prj: [0.1]
2024-04-27 06:53:26,650 - n_layer: [1]
2024-04-27 06:53:26,650 - cpc_layers: [1]
2024-04-27 06:53:26,650 - d_vh: [16]
2024-04-27 06:53:26,650 - d_ah: [16]
2024-04-27 06:53:26,650 - d_vout: [8]
2024-04-27 06:53:26,650 - d_aout: [16]
2024-04-27 06:53:26,650 - d_prjh: [512]
2024-04-27 06:53:26,650 - scale: [20]
2024-04-27 06:53:26,650 - beta: [0.5]
2024-04-27 06:53:26,650 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim/mmim_MIntRec2_bert-base-uncased_multi-class_2
2024-04-27 06:53:26,650 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim/mmim_MIntRec2_bert-base-uncased_multi-class_2/models
2024-04-27 06:53:26,650 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim/binary_mmim_MIntRec2_bert-base-uncased_2
2024-04-27 06:53:26,650 - device: cuda
2024-04-27 06:53:26,650 - d_tout: 768
2024-04-27 06:53:26,650 - feat_size: 512
2024-04-27 06:53:26,650 - ============================== End Params ==============================
2024-04-27 06:53:27,973 - Multimodal Intent Recognition begins...
2024-04-27 06:53:27,974 - Training begins...
2024-04-27 06:54:57,139 - ***** Epoch: 1: Eval results *****
2024-04-27 06:54:57,140 -   best_eval_score = 0.0
2024-04-27 06:54:57,140 -   eval_score = 0.4378
2024-04-27 06:54:57,140 -   train_loss_main = 2.8054
2024-04-27 06:54:57,140 -   train_loss_mmilb = 0.1288
2024-04-27 06:56:25,953 - ***** Epoch: 2: Eval results *****
2024-04-27 06:56:25,953 -   best_eval_score = 0.4378
2024-04-27 06:56:25,953 -   eval_score = 0.4836
2024-04-27 06:56:25,953 -   train_loss_main = 2.0431
2024-04-27 06:56:25,953 -   train_loss_mmilb = 0.0002
2024-04-27 06:57:55,232 - ***** Epoch: 3: Eval results *****
2024-04-27 06:57:55,232 -   best_eval_score = 0.4836
2024-04-27 06:57:55,233 -   eval_score = 0.5119
2024-04-27 06:57:55,233 -   train_loss_main = 1.5449
2024-04-27 06:57:55,233 -   train_loss_mmilb = 0.0002
2024-04-27 06:59:24,916 - ***** Epoch: 4: Eval results *****
2024-04-27 06:59:24,916 -   best_eval_score = 0.5119
2024-04-27 06:59:24,917 -   eval_score = 0.5022
2024-04-27 06:59:24,917 -   train_loss_main = 1.2516
2024-04-27 06:59:24,917 -   train_loss_mmilb = 0.0002
2024-04-27 06:59:24,917 - EarlyStopping counter: 1 out of 3
2024-04-27 07:00:54,874 - ***** Epoch: 5: Eval results *****
2024-04-27 07:00:54,875 -   best_eval_score = 0.5119
2024-04-27 07:00:54,875 -   eval_score = 0.5061
2024-04-27 07:00:54,875 -   train_loss_main = 1.0711
2024-04-27 07:00:54,875 -   train_loss_mmilb = 0.0002
2024-04-27 07:00:54,876 - EarlyStopping counter: 2 out of 3
2024-04-27 07:02:23,792 - ***** Epoch: 6: Eval results *****
2024-04-27 07:02:23,792 -   best_eval_score = 0.5119
2024-04-27 07:02:23,792 -   eval_score = 0.487
2024-04-27 07:02:23,793 -   train_loss_main = 0.9978
2024-04-27 07:02:23,793 -   train_loss_mmilb = 0.0002
2024-04-27 07:02:23,793 - EarlyStopping counter: 3 out of 3
2024-04-27 07:02:23,793 - EarlyStopping at epoch 6
2024-04-27 07:02:23,884 - Training is finished...
2024-04-27 07:02:23,885 - Testing begins...
2024-04-27 07:03:21,033 - ***** Out-of-domain Evaluation results *****
2024-04-27 07:03:21,034 -   aupr_in = 0.5699
2024-04-27 07:03:21,034 -   aupr_out = 0.444
2024-04-27 07:03:21,034 -   auroc = 0.5106
2024-04-27 07:03:21,034 -   der = 0.5558
2024-04-27 07:03:21,034 -   eer = 0.4933
2024-04-27 07:03:21,034 -   fpr95 = 0.945
2024-04-27 07:03:21,034 - Testing is finished...
2024-04-27 07:03:21,034 - Multimodal intent recognition is finished...
2024-04-27 07:03:21,034 - Results are saved in results/results_mmim_MIntRec2.csv
2024-04-27 07:03:21,102 - ============================== Params ==============================
2024-04-27 07:03:21,102 - logger_name: mmim_ma_MIntRec2_multi-class_0
2024-04-27 07:03:21,102 - dataset: MIntRec2
2024-04-27 07:03:21,102 - ood_dataset: MIntRec2-OOD
2024-04-27 07:03:21,102 - data_mode: multi-class
2024-04-27 07:03:21,102 - multimodal_method: mmim
2024-04-27 07:03:21,102 - method: mmim
2024-04-27 07:03:21,102 - ood_detection_method: ma
2024-04-27 07:03:21,102 - text_backbone: bert-base-uncased
2024-04-27 07:03:21,102 - seed: 3
2024-04-27 07:03:21,102 - num_workers: 8
2024-04-27 07:03:21,102 - log_id: mmim_ma_MIntRec2_multi-class_0_2024-04-27-06-41-39
2024-04-27 07:03:21,102 - gpu_id: 2
2024-04-27 07:03:21,102 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-27 07:03:21,102 - train: True
2024-04-27 07:03:21,102 - tune: True
2024-04-27 07:03:21,103 - ood: True
2024-04-27 07:03:21,103 - save_model: False
2024-04-27 07:03:21,103 - save_results: True
2024-04-27 07:03:21,103 - log_path: logs
2024-04-27 07:03:21,103 - cache_path: cache
2024-04-27 07:03:21,103 - video_data_path: video_data
2024-04-27 07:03:21,103 - audio_data_path: audio_data
2024-04-27 07:03:21,103 - video_feats_path: swin_feats.pkl
2024-04-27 07:03:21,103 - ood_video_feats_path: swin_feats.pkl
2024-04-27 07:03:21,103 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-27 07:03:21,103 - audio_feats_path: wavlm_feats.pkl
2024-04-27 07:03:21,103 - results_path: results
2024-04-27 07:03:21,103 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim
2024-04-27 07:03:21,103 - model_path: models
2024-04-27 07:03:21,103 - config_file_name: mmim_MIntRec2
2024-04-27 07:03:21,103 - results_file_name: results_mmim_MIntRec2.csv
2024-04-27 07:03:21,103 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-27 07:03:21,103 - text_seq_len: 50
2024-04-27 07:03:21,103 - video_seq_len: 180
2024-04-27 07:03:21,103 - audio_seq_len: 400
2024-04-27 07:03:21,103 - text_feat_dim: 768
2024-04-27 07:03:21,103 - video_feat_dim: 256
2024-04-27 07:03:21,103 - audio_feat_dim: 768
2024-04-27 07:03:21,103 - ood_label_id: 30
2024-04-27 07:03:21,103 - num_labels: 30
2024-04-27 07:03:21,103 - num_train_examples: 6165
2024-04-27 07:03:21,103 - need_aligned: False
2024-04-27 07:03:21,103 - eval_monitor: f1
2024-04-27 07:03:21,103 - train_batch_size: 32
2024-04-27 07:03:21,103 - eval_batch_size: 16
2024-04-27 07:03:21,104 - test_batch_size: 16
2024-04-27 07:03:21,104 - wait_patience: 3
2024-04-27 07:03:21,104 - num_train_epochs: 100
2024-04-27 07:03:21,104 - add_va: False
2024-04-27 07:03:21,104 - cpc_activation: Tanh
2024-04-27 07:03:21,104 - mmilb_mid_activation: ReLU
2024-04-27 07:03:21,104 - mmilb_last_activation: Tanh
2024-04-27 07:03:21,104 - optim: Adam
2024-04-27 07:03:21,104 - contrast: True
2024-04-27 07:03:21,104 - bidirectional: True
2024-04-27 07:03:21,104 - grad_clip: 1.0
2024-04-27 07:03:21,104 - lr_main: [0.0002]
2024-04-27 07:03:21,104 - weight_decay_main: [0.0003]
2024-04-27 07:03:21,104 - lr_bert: [4e-05]
2024-04-27 07:03:21,104 - weight_decay_bert: [5e-05]
2024-04-27 07:03:21,104 - lr_mmilb: [0.003]
2024-04-27 07:03:21,104 - weight_decay_mmilb: [0.0001]
2024-04-27 07:03:21,104 - alpha: [0.1]
2024-04-27 07:03:21,104 - dropout_a: [0.1]
2024-04-27 07:03:21,104 - dropout_v: [0.1]
2024-04-27 07:03:21,104 - dropout_prj: [0.1]
2024-04-27 07:03:21,104 - n_layer: [1]
2024-04-27 07:03:21,104 - cpc_layers: [1]
2024-04-27 07:03:21,104 - d_vh: [16]
2024-04-27 07:03:21,104 - d_ah: [16]
2024-04-27 07:03:21,104 - d_vout: [8]
2024-04-27 07:03:21,104 - d_aout: [16]
2024-04-27 07:03:21,104 - d_prjh: [512]
2024-04-27 07:03:21,104 - scale: [20]
2024-04-27 07:03:21,105 - beta: [0.5]
2024-04-27 07:03:21,105 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim/mmim_MIntRec2_bert-base-uncased_multi-class_3
2024-04-27 07:03:21,105 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim/mmim_MIntRec2_bert-base-uncased_multi-class_3/models
2024-04-27 07:03:21,105 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim/binary_mmim_MIntRec2_bert-base-uncased_3
2024-04-27 07:03:21,105 - device: cuda
2024-04-27 07:03:21,105 - d_tout: 768
2024-04-27 07:03:21,105 - feat_size: 512
2024-04-27 07:03:21,105 - ============================== End Params ==============================
2024-04-27 07:03:22,456 - Multimodal Intent Recognition begins...
2024-04-27 07:03:22,457 - Training begins...
2024-04-27 07:04:50,108 - ***** Epoch: 1: Eval results *****
2024-04-27 07:04:50,108 -   best_eval_score = 0.0
2024-04-27 07:04:50,108 -   eval_score = 0.4602
2024-04-27 07:04:50,108 -   train_loss_main = 2.837
2024-04-27 07:04:50,108 -   train_loss_mmilb = 0.1459
2024-04-27 07:06:18,675 - ***** Epoch: 2: Eval results *****
2024-04-27 07:06:18,675 -   best_eval_score = 0.4602
2024-04-27 07:06:18,676 -   eval_score = 0.4822
2024-04-27 07:06:18,676 -   train_loss_main = 2.0827
2024-04-27 07:06:18,676 -   train_loss_mmilb = 0.0004
2024-04-27 07:07:48,481 - ***** Epoch: 3: Eval results *****
2024-04-27 07:07:48,482 -   best_eval_score = 0.4822
2024-04-27 07:07:48,482 -   eval_score = 0.4949
2024-04-27 07:07:48,482 -   train_loss_main = 1.6045
2024-04-27 07:07:48,482 -   train_loss_mmilb = 0.0003
2024-04-27 07:09:17,701 - ***** Epoch: 4: Eval results *****
2024-04-27 07:09:17,701 -   best_eval_score = 0.4949
2024-04-27 07:09:17,701 -   eval_score = 0.4845
2024-04-27 07:09:17,701 -   train_loss_main = 1.2857
2024-04-27 07:09:17,701 -   train_loss_mmilb = 0.0003
2024-04-27 07:09:17,701 - EarlyStopping counter: 1 out of 3
2024-04-27 07:10:46,407 - ***** Epoch: 5: Eval results *****
2024-04-27 07:10:46,408 -   best_eval_score = 0.4949
2024-04-27 07:10:46,408 -   eval_score = 0.493
2024-04-27 07:10:46,408 -   train_loss_main = 1.1176
2024-04-27 07:10:46,408 -   train_loss_mmilb = 0.0002
2024-04-27 07:10:46,408 - EarlyStopping counter: 2 out of 3
2024-04-27 07:12:14,904 - ***** Epoch: 6: Eval results *****
2024-04-27 07:12:14,904 -   best_eval_score = 0.4949
2024-04-27 07:12:14,905 -   eval_score = 0.4974
2024-04-27 07:12:14,905 -   train_loss_main = 1.0409
2024-04-27 07:12:14,905 -   train_loss_mmilb = 0.0002
2024-04-27 07:13:42,682 - ***** Epoch: 7: Eval results *****
2024-04-27 07:13:42,682 -   best_eval_score = 0.4974
2024-04-27 07:13:42,683 -   eval_score = 0.4814
2024-04-27 07:13:42,683 -   train_loss_main = 1.0061
2024-04-27 07:13:42,683 -   train_loss_mmilb = 0.0002
2024-04-27 07:13:42,683 - EarlyStopping counter: 1 out of 3
2024-04-27 07:15:10,671 - ***** Epoch: 8: Eval results *****
2024-04-27 07:15:10,671 -   best_eval_score = 0.4974
2024-04-27 07:15:10,672 -   eval_score = 0.4969
2024-04-27 07:15:10,672 -   train_loss_main = 0.9811
2024-04-27 07:15:10,672 -   train_loss_mmilb = 0.0002
2024-04-27 07:15:10,672 - EarlyStopping counter: 2 out of 3
2024-04-27 07:16:38,137 - ***** Epoch: 9: Eval results *****
2024-04-27 07:16:38,137 -   best_eval_score = 0.4974
2024-04-27 07:16:38,137 -   eval_score = 0.5127
2024-04-27 07:16:38,137 -   train_loss_main = 0.9563
2024-04-27 07:16:38,137 -   train_loss_mmilb = 0.0002
2024-04-27 07:18:05,650 - ***** Epoch: 10: Eval results *****
2024-04-27 07:18:05,650 -   best_eval_score = 0.5127
2024-04-27 07:18:05,651 -   eval_score = 0.5004
2024-04-27 07:18:05,651 -   train_loss_main = 0.9256
2024-04-27 07:18:05,651 -   train_loss_mmilb = 0.0002
2024-04-27 07:18:05,651 - EarlyStopping counter: 1 out of 3
2024-04-27 07:19:32,736 - ***** Epoch: 11: Eval results *****
2024-04-27 07:19:32,737 -   best_eval_score = 0.5127
2024-04-27 07:19:32,737 -   eval_score = 0.4711
2024-04-27 07:19:32,737 -   train_loss_main = 0.9162
2024-04-27 07:19:32,737 -   train_loss_mmilb = 0.0002
2024-04-27 07:19:32,737 - EarlyStopping counter: 2 out of 3
2024-04-27 07:21:01,091 - ***** Epoch: 12: Eval results *****
2024-04-27 07:21:01,091 -   best_eval_score = 0.5127
2024-04-27 07:21:01,091 -   eval_score = 0.483
2024-04-27 07:21:01,091 -   train_loss_main = 0.9048
2024-04-27 07:21:01,091 -   train_loss_mmilb = 0.0002
2024-04-27 07:21:01,092 - EarlyStopping counter: 3 out of 3
2024-04-27 07:21:01,092 - EarlyStopping at epoch 12
2024-04-27 07:21:01,190 - Training is finished...
2024-04-27 07:21:01,190 - Testing begins...
2024-04-27 07:21:58,599 - ***** Out-of-domain Evaluation results *****
2024-04-27 07:21:58,599 -   aupr_in = 0.5688
2024-04-27 07:21:58,599 -   aupr_out = 0.4392
2024-04-27 07:21:58,599 -   auroc = 0.5065
2024-04-27 07:21:58,599 -   der = 0.5588
2024-04-27 07:21:58,599 -   eer = 0.4958
2024-04-27 07:21:58,599 -   fpr95 = 0.9507
2024-04-27 07:21:58,599 - Testing is finished...
2024-04-27 07:21:58,599 - Multimodal intent recognition is finished...
2024-04-27 07:21:58,600 - Results are saved in results/results_mmim_MIntRec2.csv
2024-04-27 07:21:58,711 - ============================== Params ==============================
2024-04-27 07:21:58,711 - logger_name: mmim_ma_MIntRec2_multi-class_0
2024-04-27 07:21:58,712 - dataset: MIntRec2
2024-04-27 07:21:58,712 - ood_dataset: MIntRec2-OOD
2024-04-27 07:21:58,712 - data_mode: multi-class
2024-04-27 07:21:58,712 - multimodal_method: mmim
2024-04-27 07:21:58,712 - method: mmim
2024-04-27 07:21:58,712 - ood_detection_method: ma
2024-04-27 07:21:58,712 - text_backbone: bert-base-uncased
2024-04-27 07:21:58,712 - seed: 4
2024-04-27 07:21:58,712 - num_workers: 8
2024-04-27 07:21:58,712 - log_id: mmim_ma_MIntRec2_multi-class_0_2024-04-27-06-41-39
2024-04-27 07:21:58,712 - gpu_id: 2
2024-04-27 07:21:58,712 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-27 07:21:58,712 - train: True
2024-04-27 07:21:58,712 - tune: True
2024-04-27 07:21:58,712 - ood: True
2024-04-27 07:21:58,712 - save_model: False
2024-04-27 07:21:58,712 - save_results: True
2024-04-27 07:21:58,712 - log_path: logs
2024-04-27 07:21:58,712 - cache_path: cache
2024-04-27 07:21:58,712 - video_data_path: video_data
2024-04-27 07:21:58,712 - audio_data_path: audio_data
2024-04-27 07:21:58,712 - video_feats_path: swin_feats.pkl
2024-04-27 07:21:58,712 - ood_video_feats_path: swin_feats.pkl
2024-04-27 07:21:58,712 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-27 07:21:58,712 - audio_feats_path: wavlm_feats.pkl
2024-04-27 07:21:58,712 - results_path: results
2024-04-27 07:21:58,712 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim
2024-04-27 07:21:58,712 - model_path: models
2024-04-27 07:21:58,712 - config_file_name: mmim_MIntRec2
2024-04-27 07:21:58,712 - results_file_name: results_mmim_MIntRec2.csv
2024-04-27 07:21:58,712 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-27 07:21:58,712 - text_seq_len: 50
2024-04-27 07:21:58,712 - video_seq_len: 180
2024-04-27 07:21:58,712 - audio_seq_len: 400
2024-04-27 07:21:58,712 - text_feat_dim: 768
2024-04-27 07:21:58,712 - video_feat_dim: 256
2024-04-27 07:21:58,712 - audio_feat_dim: 768
2024-04-27 07:21:58,712 - ood_label_id: 30
2024-04-27 07:21:58,712 - num_labels: 30
2024-04-27 07:21:58,712 - num_train_examples: 6165
2024-04-27 07:21:58,712 - need_aligned: False
2024-04-27 07:21:58,712 - eval_monitor: f1
2024-04-27 07:21:58,712 - train_batch_size: 32
2024-04-27 07:21:58,712 - eval_batch_size: 16
2024-04-27 07:21:58,712 - test_batch_size: 16
2024-04-27 07:21:58,713 - wait_patience: 3
2024-04-27 07:21:58,713 - num_train_epochs: 100
2024-04-27 07:21:58,713 - add_va: False
2024-04-27 07:21:58,713 - cpc_activation: Tanh
2024-04-27 07:21:58,713 - mmilb_mid_activation: ReLU
2024-04-27 07:21:58,713 - mmilb_last_activation: Tanh
2024-04-27 07:21:58,713 - optim: Adam
2024-04-27 07:21:58,713 - contrast: True
2024-04-27 07:21:58,713 - bidirectional: True
2024-04-27 07:21:58,713 - grad_clip: 1.0
2024-04-27 07:21:58,713 - lr_main: [0.0002]
2024-04-27 07:21:58,713 - weight_decay_main: [0.0003]
2024-04-27 07:21:58,713 - lr_bert: [4e-05]
2024-04-27 07:21:58,713 - weight_decay_bert: [5e-05]
2024-04-27 07:21:58,713 - lr_mmilb: [0.003]
2024-04-27 07:21:58,713 - weight_decay_mmilb: [0.0001]
2024-04-27 07:21:58,713 - alpha: [0.1]
2024-04-27 07:21:58,713 - dropout_a: [0.1]
2024-04-27 07:21:58,713 - dropout_v: [0.1]
2024-04-27 07:21:58,713 - dropout_prj: [0.1]
2024-04-27 07:21:58,713 - n_layer: [1]
2024-04-27 07:21:58,713 - cpc_layers: [1]
2024-04-27 07:21:58,713 - d_vh: [16]
2024-04-27 07:21:58,713 - d_ah: [16]
2024-04-27 07:21:58,713 - d_vout: [8]
2024-04-27 07:21:58,713 - d_aout: [16]
2024-04-27 07:21:58,713 - d_prjh: [512]
2024-04-27 07:21:58,713 - scale: [20]
2024-04-27 07:21:58,713 - beta: [0.5]
2024-04-27 07:21:58,713 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim/mmim_MIntRec2_bert-base-uncased_multi-class_4
2024-04-27 07:21:58,713 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim/mmim_MIntRec2_bert-base-uncased_multi-class_4/models
2024-04-27 07:21:58,713 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/mmim/binary_mmim_MIntRec2_bert-base-uncased_4
2024-04-27 07:21:58,713 - device: cuda
2024-04-27 07:21:58,713 - d_tout: 768
2024-04-27 07:21:58,713 - feat_size: 512
2024-04-27 07:21:58,713 - ============================== End Params ==============================
2024-04-27 07:21:59,911 - Multimodal Intent Recognition begins...
2024-04-27 07:21:59,911 - Training begins...
2024-04-27 07:23:27,801 - ***** Epoch: 1: Eval results *****
2024-04-27 07:23:27,801 -   best_eval_score = 0.0
2024-04-27 07:23:27,801 -   eval_score = 0.4571
2024-04-27 07:23:27,801 -   train_loss_main = 2.8262
2024-04-27 07:23:27,802 -   train_loss_mmilb = 0.0704
2024-04-27 07:24:56,143 - ***** Epoch: 2: Eval results *****
2024-04-27 07:24:56,144 -   best_eval_score = 0.4571
2024-04-27 07:24:56,144 -   eval_score = 0.4775
2024-04-27 07:24:56,144 -   train_loss_main = 2.0702
2024-04-27 07:24:56,144 -   train_loss_mmilb = 0.0002
