2024-05-06 05:50:06,948 - Lists of intent labels are: ['Complain', 'Praise', 'Apologise', 'Thank', 'Criticize', 'Agree', 'Taunt', 'Flaunt', 'Joke', 'Oppose', 'Comfort', 'Care', 'Inform', 'Advise', 'Arrange', 'Introduce', 'Leave', 'Prevent', 'Greet', 'Ask for help']
2024-05-06 05:50:06,948 - ID Data preparation...
2024-05-06 05:50:13,390 - OOD Data preparation...
2024-05-06 05:50:14,861 - ============================== Params ==============================
2024-05-06 05:50:14,861 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-06 05:50:14,861 - dataset: MIntRec
2024-05-06 05:50:14,861 - ood_dataset: MIntRec-OOD
2024-05-06 05:50:14,861 - data_mode: multi-class
2024-05-06 05:50:14,862 - multimodal_method: msz
2024-05-06 05:50:14,862 - method: msz
2024-05-06 05:50:14,862 - ood_detection_method: ma
2024-05-06 05:50:14,862 - text_backbone: bert-base-uncased
2024-05-06 05:50:14,862 - seed: 0
2024-05-06 05:50:14,862 - num_workers: 8
2024-05-06 05:50:14,862 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-06-05-50-06
2024-05-06 05:50:14,862 - gpu_id: 0
2024-05-06 05:50:14,862 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-06 05:50:14,862 - train: True
2024-05-06 05:50:14,862 - tune: True
2024-05-06 05:50:14,862 - ood: True
2024-05-06 05:50:14,862 - save_model: True
2024-05-06 05:50:14,862 - save_results: True
2024-05-06 05:50:14,862 - log_path: logs
2024-05-06 05:50:14,862 - cache_path: cache
2024-05-06 05:50:14,862 - video_data_path: video_data
2024-05-06 05:50:14,862 - audio_data_path: audio_data
2024-05-06 05:50:14,862 - video_feats_path: swin_feats.pkl
2024-05-06 05:50:14,862 - ood_video_feats_path: swin_feats.pkl
2024-05-06 05:50:14,862 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-06 05:50:14,862 - audio_feats_path: wavlm_feats.pkl
2024-05-06 05:50:14,862 - results_path: results
2024-05-06 05:50:14,862 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-06 05:50:14,862 - model_path: models
2024-05-06 05:50:14,862 - config_file_name: msz_MIntRec
2024-05-06 05:50:14,862 - results_file_name: results_msz_MIntRec.csv
2024-05-06 05:50:14,862 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-06 05:50:14,862 - text_seq_len: 30
2024-05-06 05:50:14,862 - video_seq_len: 230
2024-05-06 05:50:14,862 - audio_seq_len: 480
2024-05-06 05:50:14,862 - text_feat_dim: 768
2024-05-06 05:50:14,862 - video_feat_dim: 1024
2024-05-06 05:50:14,862 - audio_feat_dim: 768
2024-05-06 05:50:14,862 - ood_label_id: 20
2024-05-06 05:50:14,862 - num_labels: 20
2024-05-06 05:50:14,862 - num_train_examples: 1334
2024-05-06 05:50:14,862 - need_aligned: True
2024-05-06 05:50:14,862 - freeze_parameters: False
2024-05-06 05:50:14,862 - eval_monitor: acc
2024-05-06 05:50:14,862 - train_batch_size: 32
2024-05-06 05:50:14,862 - eval_batch_size: 16
2024-05-06 05:50:14,862 - num_train_epochs: 100
2024-05-06 05:50:14,862 - lr: [2e-05]
2024-05-06 05:50:14,862 - weight_decay: [0.1]
2024-05-06 05:50:14,862 - wait_patience: 5
2024-05-06 05:50:14,863 - warmup_proportion: [0.01]
2024-05-06 05:50:14,863 - hidden_dims: [768]
2024-05-06 05:50:14,863 - num_attention_heads: [8]
2024-05-06 05:50:14,863 - attention_probs_dropout_prob: [0.3]
2024-05-06 05:50:14,863 - hidden_dropout_prob: [0.1]
2024-05-06 05:50:14,863 - intermediate_size: [768]
2024-05-06 05:50:14,863 - num_hidden_layers: [4]
2024-05-06 05:50:14,863 - max_position_embeddings: [900]
2024-05-06 05:50:14,863 - position_embedding_type: absolute
2024-05-06 05:50:14,863 - batch_first: True
2024-05-06 05:50:14,863 - aligned_method: ['ctc']
2024-05-06 05:50:14,863 - sampler: beta
2024-05-06 05:50:14,863 - multiple_ood: [1]
2024-05-06 05:50:14,863 - select_number_min: [2]
2024-05-06 05:50:14,863 - select_number_max: [3]
2024-05-06 05:50:14,863 - alpha: [3]
2024-05-06 05:50:14,863 - mlp_hidden_size: [256]
2024-05-06 05:50:14,863 - mlp_dropout: [0.3]
2024-05-06 05:50:14,863 - scale: [8]
2024-05-06 05:50:14,863 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_0
2024-05-06 05:50:14,863 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_0/models
2024-05-06 05:50:14,863 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_0
2024-05-06 05:50:14,863 - ============================== End Params ==============================
2024-05-06 05:50:17,736 - Multimodal Intent Recognition begins...
2024-05-06 05:50:17,736 - Training begins...
2024-05-06 05:50:49,893 - ***** Epoch: 1: Eval results *****
2024-05-06 05:50:49,893 -   binary_train_loss = 0.6834
2024-05-06 05:50:49,894 -   binary_eval_score = 0.8562
2024-05-06 05:50:49,894 -   train_loss = 1.9868
2024-05-06 05:50:49,894 -   eval_score = 0.6764
2024-05-06 05:50:49,894 -   best_eval_score = 0.0
2024-05-06 05:51:20,325 - ***** Epoch: 2: Eval results *****
2024-05-06 05:51:20,326 -   binary_train_loss = 0.6685
2024-05-06 05:51:20,326 -   binary_eval_score = 0.6775
2024-05-06 05:51:20,326 -   train_loss = 0.7532
2024-05-06 05:51:20,326 -   eval_score = 0.7348
2024-05-06 05:51:20,326 -   best_eval_score = 0.6764
2024-05-06 05:51:50,543 - ***** Epoch: 3: Eval results *****
2024-05-06 05:51:50,544 -   binary_train_loss = 0.6193
2024-05-06 05:51:50,544 -   binary_eval_score = 0.8618
2024-05-06 05:51:50,544 -   train_loss = 0.3546
2024-05-06 05:51:50,544 -   eval_score = 0.7191
2024-05-06 05:51:50,544 -   best_eval_score = 0.7348
2024-05-06 05:51:50,544 - EarlyStopping counter: 1 out of 5
2024-05-06 05:52:20,693 - ***** Epoch: 4: Eval results *****
2024-05-06 05:52:20,693 -   binary_train_loss = 0.4365
2024-05-06 05:52:20,693 -   binary_eval_score = 0.909
2024-05-06 05:52:20,693 -   train_loss = 0.1805
2024-05-06 05:52:20,693 -   eval_score = 0.7393
2024-05-06 05:52:20,693 -   best_eval_score = 0.7348
2024-05-06 05:52:51,152 - ***** Epoch: 5: Eval results *****
2024-05-06 05:52:51,152 -   binary_train_loss = 0.2493
2024-05-06 05:52:51,152 -   binary_eval_score = 0.8551
2024-05-06 05:52:51,152 -   train_loss = 0.141
2024-05-06 05:52:51,152 -   eval_score = 0.7213
2024-05-06 05:52:51,153 -   best_eval_score = 0.7393
2024-05-06 05:52:51,153 - EarlyStopping counter: 1 out of 5
2024-05-06 05:53:21,473 - ***** Epoch: 6: Eval results *****
2024-05-06 05:53:21,473 -   binary_train_loss = 0.2265
2024-05-06 05:53:21,473 -   binary_eval_score = 0.9416
2024-05-06 05:53:21,473 -   train_loss = 0.0892
2024-05-06 05:53:21,473 -   eval_score = 0.7236
2024-05-06 05:53:21,473 -   best_eval_score = 0.7393
2024-05-06 05:53:21,473 - EarlyStopping counter: 2 out of 5
2024-05-06 05:53:52,491 - ***** Epoch: 7: Eval results *****
2024-05-06 05:53:52,491 -   binary_train_loss = 0.207
2024-05-06 05:53:52,491 -   binary_eval_score = 0.9281
2024-05-06 05:53:52,491 -   train_loss = 0.057
2024-05-06 05:53:52,491 -   eval_score = 0.7326
2024-05-06 05:53:52,491 -   best_eval_score = 0.7393
2024-05-06 05:53:52,491 - EarlyStopping counter: 3 out of 5
2024-05-06 05:54:22,562 - ***** Epoch: 8: Eval results *****
2024-05-06 05:54:22,563 -   binary_train_loss = 0.1694
2024-05-06 05:54:22,563 -   binary_eval_score = 0.9494
2024-05-06 05:54:22,563 -   train_loss = 0.0462
2024-05-06 05:54:22,563 -   eval_score = 0.7326
2024-05-06 05:54:22,563 -   best_eval_score = 0.7393
2024-05-06 05:54:22,563 - EarlyStopping counter: 4 out of 5
2024-05-06 05:54:52,707 - ***** Epoch: 9: Eval results *****
2024-05-06 05:54:52,707 -   binary_train_loss = 0.1445
2024-05-06 05:54:52,707 -   binary_eval_score = 0.9124
2024-05-06 05:54:52,708 -   train_loss = 0.0409
2024-05-06 05:54:52,708 -   eval_score = 0.7303
2024-05-06 05:54:52,708 -   best_eval_score = 0.7393
2024-05-06 05:54:52,708 - EarlyStopping counter: 5 out of 5
2024-05-06 05:54:52,708 - EarlyStopping at epoch 9
2024-05-06 05:54:52,709 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_0/models
2024-05-06 05:54:57,539 - Training is finished...
2024-05-06 05:54:57,540 - Testing begins...
2024-05-06 05:55:09,826 - ***** Out-of-domain Evaluation results *****
2024-05-06 05:55:09,827 -   aupr_in = 0.785
2024-05-06 05:55:09,827 -   aupr_out = 0.8057
2024-05-06 05:55:09,827 -   auroc = 0.8
2024-05-06 05:55:09,828 -   der = 0.3287
2024-05-06 05:55:09,828 -   eer = 0.2644
2024-05-06 05:55:09,828 -   fpr95 = 0.6111
2024-05-06 05:55:09,828 - Testing is finished...
2024-05-06 05:55:09,829 - Multimodal intent recognition is finished...
2024-05-06 05:55:09,829 - Results are saved in results/results_msz_MIntRec.csv
2024-05-06 05:55:09,938 - ============================== Params ==============================
2024-05-06 05:55:09,938 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-06 05:55:09,938 - dataset: MIntRec
2024-05-06 05:55:09,938 - ood_dataset: MIntRec-OOD
2024-05-06 05:55:09,938 - data_mode: multi-class
2024-05-06 05:55:09,939 - multimodal_method: msz
2024-05-06 05:55:09,939 - method: msz
2024-05-06 05:55:09,939 - ood_detection_method: ma
2024-05-06 05:55:09,939 - text_backbone: bert-base-uncased
2024-05-06 05:55:09,939 - seed: 1
2024-05-06 05:55:09,939 - num_workers: 8
2024-05-06 05:55:09,939 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-06-05-50-06
2024-05-06 05:55:09,939 - gpu_id: 0
2024-05-06 05:55:09,939 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-06 05:55:09,939 - train: True
2024-05-06 05:55:09,939 - tune: True
2024-05-06 05:55:09,939 - ood: True
2024-05-06 05:55:09,940 - save_model: True
2024-05-06 05:55:09,940 - save_results: True
2024-05-06 05:55:09,940 - log_path: logs
2024-05-06 05:55:09,940 - cache_path: cache
2024-05-06 05:55:09,940 - video_data_path: video_data
2024-05-06 05:55:09,940 - audio_data_path: audio_data
2024-05-06 05:55:09,940 - video_feats_path: swin_feats.pkl
2024-05-06 05:55:09,940 - ood_video_feats_path: swin_feats.pkl
2024-05-06 05:55:09,940 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-06 05:55:09,940 - audio_feats_path: wavlm_feats.pkl
2024-05-06 05:55:09,940 - results_path: results
2024-05-06 05:55:09,940 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-06 05:55:09,940 - model_path: models
2024-05-06 05:55:09,940 - config_file_name: msz_MIntRec
2024-05-06 05:55:09,941 - results_file_name: results_msz_MIntRec.csv
2024-05-06 05:55:09,941 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-06 05:55:09,941 - text_seq_len: 30
2024-05-06 05:55:09,941 - video_seq_len: 230
2024-05-06 05:55:09,941 - audio_seq_len: 480
2024-05-06 05:55:09,941 - text_feat_dim: 768
2024-05-06 05:55:09,941 - video_feat_dim: 1024
2024-05-06 05:55:09,941 - audio_feat_dim: 768
2024-05-06 05:55:09,941 - ood_label_id: 20
2024-05-06 05:55:09,941 - num_labels: 20
2024-05-06 05:55:09,941 - num_train_examples: 1334
2024-05-06 05:55:09,941 - need_aligned: True
2024-05-06 05:55:09,941 - freeze_parameters: False
2024-05-06 05:55:09,941 - eval_monitor: acc
2024-05-06 05:55:09,941 - train_batch_size: 32
2024-05-06 05:55:09,941 - eval_batch_size: 16
2024-05-06 05:55:09,941 - num_train_epochs: 100
2024-05-06 05:55:09,941 - lr: [2e-05]
2024-05-06 05:55:09,941 - weight_decay: [0.1]
2024-05-06 05:55:09,941 - wait_patience: 5
2024-05-06 05:55:09,941 - warmup_proportion: [0.01]
2024-05-06 05:55:09,941 - hidden_dims: [768]
2024-05-06 05:55:09,941 - num_attention_heads: [8]
2024-05-06 05:55:09,941 - attention_probs_dropout_prob: [0.3]
2024-05-06 05:55:09,941 - hidden_dropout_prob: [0.1]
2024-05-06 05:55:09,941 - intermediate_size: [768]
2024-05-06 05:55:09,941 - num_hidden_layers: [4]
2024-05-06 05:55:09,941 - max_position_embeddings: [900]
2024-05-06 05:55:09,941 - position_embedding_type: absolute
2024-05-06 05:55:09,941 - batch_first: True
2024-05-06 05:55:09,941 - aligned_method: ['ctc']
2024-05-06 05:55:09,941 - sampler: beta
2024-05-06 05:55:09,941 - multiple_ood: [1]
2024-05-06 05:55:09,941 - select_number_min: [2]
2024-05-06 05:55:09,941 - select_number_max: [3]
2024-05-06 05:55:09,941 - alpha: [3]
2024-05-06 05:55:09,941 - mlp_hidden_size: [256]
2024-05-06 05:55:09,941 - mlp_dropout: [0.3]
2024-05-06 05:55:09,942 - scale: [8]
2024-05-06 05:55:09,942 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_1
2024-05-06 05:55:09,942 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-06 05:55:09,942 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_1
2024-05-06 05:55:09,942 - device: cuda
2024-05-06 05:55:09,942 - ============================== End Params ==============================
2024-05-06 05:55:11,764 - Multimodal Intent Recognition begins...
2024-05-06 05:55:11,764 - Training begins...
2024-05-06 05:55:42,772 - ***** Epoch: 1: Eval results *****
2024-05-06 05:55:42,772 -   binary_train_loss = 0.6857
2024-05-06 05:55:42,772 -   binary_eval_score = 0.8438
2024-05-06 05:55:42,772 -   train_loss = 2.0194
2024-05-06 05:55:42,772 -   eval_score = 0.6697
2024-05-06 05:55:42,772 -   best_eval_score = 0.0
2024-05-06 05:56:13,330 - ***** Epoch: 2: Eval results *****
2024-05-06 05:56:13,330 -   binary_train_loss = 0.6731
2024-05-06 05:56:13,330 -   binary_eval_score = 0.7213
2024-05-06 05:56:13,330 -   train_loss = 0.7678
2024-05-06 05:56:13,330 -   eval_score = 0.7169
2024-05-06 05:56:13,330 -   best_eval_score = 0.6697
2024-05-06 05:56:43,834 - ***** Epoch: 3: Eval results *****
2024-05-06 05:56:43,835 -   binary_train_loss = 0.6292
2024-05-06 05:56:43,835 -   binary_eval_score = 0.8146
2024-05-06 05:56:43,835 -   train_loss = 0.3404
2024-05-06 05:56:43,835 -   eval_score = 0.7146
2024-05-06 05:56:43,835 -   best_eval_score = 0.7169
2024-05-06 05:56:43,835 - EarlyStopping counter: 1 out of 5
2024-05-06 05:57:14,342 - ***** Epoch: 4: Eval results *****
2024-05-06 05:57:14,342 -   binary_train_loss = 0.4458
2024-05-06 05:57:14,342 -   binary_eval_score = 0.9112
2024-05-06 05:57:14,342 -   train_loss = 0.2275
2024-05-06 05:57:14,342 -   eval_score = 0.7191
2024-05-06 05:57:14,342 -   best_eval_score = 0.7169
2024-05-06 05:57:44,816 - ***** Epoch: 5: Eval results *****
2024-05-06 05:57:44,817 -   binary_train_loss = 0.2578
2024-05-06 05:57:44,817 -   binary_eval_score = 0.8382
2024-05-06 05:57:44,817 -   train_loss = 0.1512
2024-05-06 05:57:44,817 -   eval_score = 0.7281
2024-05-06 05:57:44,817 -   best_eval_score = 0.7191
2024-05-06 05:58:16,038 - ***** Epoch: 6: Eval results *****
2024-05-06 05:58:16,038 -   binary_train_loss = 0.221
2024-05-06 05:58:16,038 -   binary_eval_score = 0.9034
2024-05-06 05:58:16,038 -   train_loss = 0.0823
2024-05-06 05:58:16,038 -   eval_score = 0.7169
2024-05-06 05:58:16,038 -   best_eval_score = 0.7281
2024-05-06 05:58:16,039 - EarlyStopping counter: 1 out of 5
2024-05-06 05:58:46,803 - ***** Epoch: 7: Eval results *****
2024-05-06 05:58:46,803 -   binary_train_loss = 0.2293
2024-05-06 05:58:46,803 -   binary_eval_score = 0.9416
2024-05-06 05:58:46,803 -   train_loss = 0.0624
2024-05-06 05:58:46,803 -   eval_score = 0.7169
2024-05-06 05:58:46,803 -   best_eval_score = 0.7281
2024-05-06 05:58:46,803 - EarlyStopping counter: 2 out of 5
2024-05-06 05:59:17,686 - ***** Epoch: 8: Eval results *****
2024-05-06 05:59:17,686 -   binary_train_loss = 0.1624
2024-05-06 05:59:17,686 -   binary_eval_score = 0.9573
2024-05-06 05:59:17,686 -   train_loss = 0.0467
2024-05-06 05:59:17,686 -   eval_score = 0.7236
2024-05-06 05:59:17,686 -   best_eval_score = 0.7281
2024-05-06 05:59:17,686 - EarlyStopping counter: 3 out of 5
2024-05-06 05:59:48,630 - ***** Epoch: 9: Eval results *****
2024-05-06 05:59:48,630 -   binary_train_loss = 0.1319
2024-05-06 05:59:48,630 -   binary_eval_score = 0.9427
2024-05-06 05:59:48,630 -   train_loss = 0.037
2024-05-06 05:59:48,630 -   eval_score = 0.7213
2024-05-06 05:59:48,630 -   best_eval_score = 0.7281
2024-05-06 05:59:48,630 - EarlyStopping counter: 4 out of 5
2024-05-06 06:00:19,636 - ***** Epoch: 10: Eval results *****
2024-05-06 06:00:19,636 -   binary_train_loss = 0.1444
2024-05-06 06:00:19,636 -   binary_eval_score = 0.9809
2024-05-06 06:00:19,636 -   train_loss = 0.0335
2024-05-06 06:00:19,636 -   eval_score = 0.7079
2024-05-06 06:00:19,636 -   best_eval_score = 0.7281
2024-05-06 06:00:19,636 - EarlyStopping counter: 5 out of 5
2024-05-06 06:00:19,636 - EarlyStopping at epoch 10
2024-05-06 06:00:19,638 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-06 06:00:24,669 - Training is finished...
2024-05-06 06:00:24,670 - Testing begins...
2024-05-06 06:00:36,358 - ***** Out-of-domain Evaluation results *****
2024-05-06 06:00:36,358 -   aupr_in = 0.7847
2024-05-06 06:00:36,358 -   aupr_out = 0.7866
2024-05-06 06:00:36,359 -   auroc = 0.7931
2024-05-06 06:00:36,359 -   der = 0.3795
2024-05-06 06:00:36,359 -   eer = 0.2733
2024-05-06 06:00:36,359 -   fpr95 = 0.7133
2024-05-06 06:00:36,360 - Testing is finished...
2024-05-06 06:00:36,360 - Multimodal intent recognition is finished...
2024-05-06 06:00:36,360 - Results are saved in results/results_msz_MIntRec.csv
2024-05-06 06:00:36,467 - ============================== Params ==============================
2024-05-06 06:00:36,467 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-06 06:00:36,467 - dataset: MIntRec
2024-05-06 06:00:36,467 - ood_dataset: MIntRec-OOD
2024-05-06 06:00:36,467 - data_mode: multi-class
2024-05-06 06:00:36,467 - multimodal_method: msz
2024-05-06 06:00:36,467 - method: msz
2024-05-06 06:00:36,467 - ood_detection_method: ma
2024-05-06 06:00:36,467 - text_backbone: bert-base-uncased
2024-05-06 06:00:36,467 - seed: 2
2024-05-06 06:00:36,467 - num_workers: 8
2024-05-06 06:00:36,467 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-06-05-50-06
2024-05-06 06:00:36,467 - gpu_id: 0
2024-05-06 06:00:36,467 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-06 06:00:36,467 - train: True
2024-05-06 06:00:36,467 - tune: True
2024-05-06 06:00:36,468 - ood: True
2024-05-06 06:00:36,468 - save_model: True
2024-05-06 06:00:36,468 - save_results: True
2024-05-06 06:00:36,468 - log_path: logs
2024-05-06 06:00:36,468 - cache_path: cache
2024-05-06 06:00:36,468 - video_data_path: video_data
2024-05-06 06:00:36,468 - audio_data_path: audio_data
2024-05-06 06:00:36,468 - video_feats_path: swin_feats.pkl
2024-05-06 06:00:36,468 - ood_video_feats_path: swin_feats.pkl
2024-05-06 06:00:36,468 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-06 06:00:36,468 - audio_feats_path: wavlm_feats.pkl
2024-05-06 06:00:36,468 - results_path: results
2024-05-06 06:00:36,468 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-06 06:00:36,468 - model_path: models
2024-05-06 06:00:36,468 - config_file_name: msz_MIntRec
2024-05-06 06:00:36,468 - results_file_name: results_msz_MIntRec.csv
2024-05-06 06:00:36,468 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-06 06:00:36,468 - text_seq_len: 30
2024-05-06 06:00:36,468 - video_seq_len: 230
2024-05-06 06:00:36,468 - audio_seq_len: 480
2024-05-06 06:00:36,468 - text_feat_dim: 768
2024-05-06 06:00:36,468 - video_feat_dim: 1024
2024-05-06 06:00:36,468 - audio_feat_dim: 768
2024-05-06 06:00:36,468 - ood_label_id: 20
2024-05-06 06:00:36,468 - num_labels: 20
2024-05-06 06:00:36,468 - num_train_examples: 1334
2024-05-06 06:00:36,468 - need_aligned: True
2024-05-06 06:00:36,468 - freeze_parameters: False
2024-05-06 06:00:36,468 - eval_monitor: acc
2024-05-06 06:00:36,468 - train_batch_size: 32
2024-05-06 06:00:36,468 - eval_batch_size: 16
2024-05-06 06:00:36,468 - num_train_epochs: 100
2024-05-06 06:00:36,468 - lr: [2e-05]
2024-05-06 06:00:36,468 - weight_decay: [0.1]
2024-05-06 06:00:36,468 - wait_patience: 5
2024-05-06 06:00:36,468 - warmup_proportion: [0.01]
2024-05-06 06:00:36,468 - hidden_dims: [768]
2024-05-06 06:00:36,468 - num_attention_heads: [8]
2024-05-06 06:00:36,469 - attention_probs_dropout_prob: [0.3]
2024-05-06 06:00:36,469 - hidden_dropout_prob: [0.1]
2024-05-06 06:00:36,469 - intermediate_size: [768]
2024-05-06 06:00:36,469 - num_hidden_layers: [4]
2024-05-06 06:00:36,469 - max_position_embeddings: [900]
2024-05-06 06:00:36,469 - position_embedding_type: absolute
2024-05-06 06:00:36,469 - batch_first: True
2024-05-06 06:00:36,469 - aligned_method: ['ctc']
2024-05-06 06:00:36,469 - sampler: beta
2024-05-06 06:00:36,469 - multiple_ood: [1]
2024-05-06 06:00:36,469 - select_number_min: [2]
2024-05-06 06:00:36,469 - select_number_max: [3]
2024-05-06 06:00:36,469 - alpha: [3]
2024-05-06 06:00:36,469 - mlp_hidden_size: [256]
2024-05-06 06:00:36,469 - mlp_dropout: [0.3]
2024-05-06 06:00:36,469 - scale: [8]
2024-05-06 06:00:36,469 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_2
2024-05-06 06:00:36,469 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-06 06:00:36,469 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_2
2024-05-06 06:00:36,469 - device: cuda
2024-05-06 06:00:36,469 - ============================== End Params ==============================
2024-05-06 06:00:38,131 - Multimodal Intent Recognition begins...
2024-05-06 06:00:38,132 - Training begins...
2024-05-06 06:01:08,761 - ***** Epoch: 1: Eval results *****
2024-05-06 06:01:08,762 -   binary_train_loss = 0.6831
2024-05-06 06:01:08,762 -   binary_eval_score = 0.7247
2024-05-06 06:01:08,762 -   train_loss = 2.0723
2024-05-06 06:01:08,762 -   eval_score = 0.6629
2024-05-06 06:01:08,762 -   best_eval_score = 0.0
2024-05-06 06:01:40,337 - ***** Epoch: 2: Eval results *****
2024-05-06 06:01:40,338 -   binary_train_loss = 0.6657
2024-05-06 06:01:40,338 -   binary_eval_score = 0.6596
2024-05-06 06:01:40,338 -   train_loss = 0.8273
2024-05-06 06:01:40,338 -   eval_score = 0.7101
2024-05-06 06:01:40,338 -   best_eval_score = 0.6629
2024-05-06 06:02:11,124 - ***** Epoch: 3: Eval results *****
2024-05-06 06:02:11,124 -   binary_train_loss = 0.6016
2024-05-06 06:02:11,124 -   binary_eval_score = 0.8371
2024-05-06 06:02:11,125 -   train_loss = 0.4006
2024-05-06 06:02:11,125 -   eval_score = 0.7124
2024-05-06 06:02:11,125 -   best_eval_score = 0.7101
2024-05-06 06:02:42,161 - ***** Epoch: 4: Eval results *****
2024-05-06 06:02:42,162 -   binary_train_loss = 0.4127
2024-05-06 06:02:42,162 -   binary_eval_score = 0.7674
2024-05-06 06:02:42,162 -   train_loss = 0.2327
2024-05-06 06:02:42,162 -   eval_score = 0.7213
2024-05-06 06:02:42,162 -   best_eval_score = 0.7124
2024-05-06 06:03:13,126 - ***** Epoch: 5: Eval results *****
2024-05-06 06:03:13,127 -   binary_train_loss = 0.2483
2024-05-06 06:03:13,127 -   binary_eval_score = 0.882
2024-05-06 06:03:13,127 -   train_loss = 0.1498
2024-05-06 06:03:13,127 -   eval_score = 0.7191
2024-05-06 06:03:13,127 -   best_eval_score = 0.7213
2024-05-06 06:03:13,127 - EarlyStopping counter: 1 out of 5
2024-05-06 06:03:43,767 - ***** Epoch: 6: Eval results *****
2024-05-06 06:03:43,767 -   binary_train_loss = 0.1897
2024-05-06 06:03:43,767 -   binary_eval_score = 0.9191
2024-05-06 06:03:43,767 -   train_loss = 0.096
2024-05-06 06:03:43,767 -   eval_score = 0.7146
2024-05-06 06:03:43,767 -   best_eval_score = 0.7213
2024-05-06 06:03:43,767 - EarlyStopping counter: 2 out of 5
2024-05-06 06:04:14,462 - ***** Epoch: 7: Eval results *****
2024-05-06 06:04:14,462 -   binary_train_loss = 0.162
2024-05-06 06:04:14,462 -   binary_eval_score = 0.9112
2024-05-06 06:04:14,462 -   train_loss = 0.0606
2024-05-06 06:04:14,462 -   eval_score = 0.7079
2024-05-06 06:04:14,462 -   best_eval_score = 0.7213
2024-05-06 06:04:14,462 - EarlyStopping counter: 3 out of 5
2024-05-06 06:04:45,159 - ***** Epoch: 8: Eval results *****
2024-05-06 06:04:45,159 -   binary_train_loss = 0.1641
2024-05-06 06:04:45,159 -   binary_eval_score = 0.8112
2024-05-06 06:04:45,159 -   train_loss = 0.0502
2024-05-06 06:04:45,159 -   eval_score = 0.7169
2024-05-06 06:04:45,159 -   best_eval_score = 0.7213
2024-05-06 06:04:45,159 - EarlyStopping counter: 4 out of 5
2024-05-06 06:05:16,036 - ***** Epoch: 9: Eval results *****
2024-05-06 06:05:16,036 -   binary_train_loss = 0.1639
2024-05-06 06:05:16,036 -   binary_eval_score = 0.8674
2024-05-06 06:05:16,036 -   train_loss = 0.037
2024-05-06 06:05:16,036 -   eval_score = 0.7281
2024-05-06 06:05:16,036 -   best_eval_score = 0.7213
2024-05-06 06:05:46,989 - ***** Epoch: 10: Eval results *****
2024-05-06 06:05:46,989 -   binary_train_loss = 0.1165
2024-05-06 06:05:46,989 -   binary_eval_score = 0.973
2024-05-06 06:05:46,989 -   train_loss = 0.032
2024-05-06 06:05:46,989 -   eval_score = 0.7326
2024-05-06 06:05:46,989 -   best_eval_score = 0.7281
2024-05-06 06:06:18,246 - ***** Epoch: 11: Eval results *****
2024-05-06 06:06:18,246 -   binary_train_loss = 0.0958
2024-05-06 06:06:18,246 -   binary_eval_score = 0.9337
2024-05-06 06:06:18,246 -   train_loss = 0.0329
2024-05-06 06:06:18,246 -   eval_score = 0.7326
2024-05-06 06:06:18,246 -   best_eval_score = 0.7326
2024-05-06 06:06:18,246 - EarlyStopping counter: 1 out of 5
2024-05-06 06:06:49,075 - ***** Epoch: 12: Eval results *****
2024-05-06 06:06:49,075 -   binary_train_loss = 0.1002
2024-05-06 06:06:49,075 -   binary_eval_score = 0.9775
2024-05-06 06:06:49,075 -   train_loss = 0.0271
2024-05-06 06:06:49,075 -   eval_score = 0.7236
2024-05-06 06:06:49,076 -   best_eval_score = 0.7326
2024-05-06 06:06:49,076 - EarlyStopping counter: 2 out of 5
2024-05-06 06:07:19,592 - ***** Epoch: 13: Eval results *****
2024-05-06 06:07:19,593 -   binary_train_loss = 0.1177
2024-05-06 06:07:19,593 -   binary_eval_score = 0.9843
2024-05-06 06:07:19,593 -   train_loss = 0.0288
2024-05-06 06:07:19,593 -   eval_score = 0.7303
2024-05-06 06:07:19,593 -   best_eval_score = 0.7326
2024-05-06 06:07:19,593 - EarlyStopping counter: 3 out of 5
2024-05-06 06:07:50,444 - ***** Epoch: 14: Eval results *****
2024-05-06 06:07:50,444 -   binary_train_loss = 0.0878
2024-05-06 06:07:50,444 -   binary_eval_score = 0.964
2024-05-06 06:07:50,444 -   train_loss = 0.0267
2024-05-06 06:07:50,444 -   eval_score = 0.7416
2024-05-06 06:07:50,444 -   best_eval_score = 0.7326
2024-05-06 06:08:22,052 - ***** Epoch: 15: Eval results *****
2024-05-06 06:08:22,052 -   binary_train_loss = 0.0831
2024-05-06 06:08:22,052 -   binary_eval_score = 0.9303
2024-05-06 06:08:22,052 -   train_loss = 0.0239
2024-05-06 06:08:22,053 -   eval_score = 0.7281
2024-05-06 06:08:22,053 -   best_eval_score = 0.7416
2024-05-06 06:08:22,053 - EarlyStopping counter: 1 out of 5
2024-05-06 06:08:52,519 - ***** Epoch: 16: Eval results *****
2024-05-06 06:08:52,519 -   binary_train_loss = 0.1136
2024-05-06 06:08:52,519 -   binary_eval_score = 0.9966
2024-05-06 06:08:52,519 -   train_loss = 0.022
2024-05-06 06:08:52,519 -   eval_score = 0.7326
2024-05-06 06:08:52,519 -   best_eval_score = 0.7416
2024-05-06 06:08:52,519 - EarlyStopping counter: 2 out of 5
2024-05-06 06:09:22,895 - ***** Epoch: 17: Eval results *****
2024-05-06 06:09:22,895 -   binary_train_loss = 0.0969
2024-05-06 06:09:22,895 -   binary_eval_score = 0.9775
2024-05-06 06:09:22,895 -   train_loss = 0.0174
2024-05-06 06:09:22,895 -   eval_score = 0.7326
2024-05-06 06:09:22,895 -   best_eval_score = 0.7416
2024-05-06 06:09:22,895 - EarlyStopping counter: 3 out of 5
2024-05-06 06:09:53,960 - ***** Epoch: 18: Eval results *****
2024-05-06 06:09:53,960 -   binary_train_loss = 0.0706
2024-05-06 06:09:53,960 -   binary_eval_score = 0.9787
2024-05-06 06:09:53,960 -   train_loss = 0.0159
2024-05-06 06:09:53,960 -   eval_score = 0.7281
2024-05-06 06:09:53,960 -   best_eval_score = 0.7416
2024-05-06 06:09:53,960 - EarlyStopping counter: 4 out of 5
2024-05-06 06:10:25,413 - ***** Epoch: 19: Eval results *****
2024-05-06 06:10:25,413 -   binary_train_loss = 0.054
2024-05-06 06:10:25,413 -   binary_eval_score = 0.9933
2024-05-06 06:10:25,414 -   train_loss = 0.0178
2024-05-06 06:10:25,414 -   eval_score = 0.7236
2024-05-06 06:10:25,414 -   best_eval_score = 0.7416
2024-05-06 06:10:25,414 - EarlyStopping counter: 5 out of 5
2024-05-06 06:10:25,414 - EarlyStopping at epoch 19
2024-05-06 06:10:25,417 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-06 06:10:30,236 - Training is finished...
2024-05-06 06:10:30,237 - Testing begins...
2024-05-06 06:10:42,156 - ***** Out-of-domain Evaluation results *****
2024-05-06 06:10:42,156 -   aupr_in = 0.7785
2024-05-06 06:10:42,157 -   aupr_out = 0.7926
2024-05-06 06:10:42,157 -   auroc = 0.7895
2024-05-06 06:10:42,157 -   der = 0.3652
2024-05-06 06:10:42,157 -   eer = 0.2844
2024-05-06 06:10:42,157 -   fpr95 = 0.6844
2024-05-06 06:10:42,157 - Testing is finished...
2024-05-06 06:10:42,157 - Multimodal intent recognition is finished...
2024-05-06 06:10:42,157 - Results are saved in results/results_msz_MIntRec.csv
2024-05-06 06:10:42,231 - ============================== Params ==============================
2024-05-06 06:10:42,231 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-06 06:10:42,231 - dataset: MIntRec
2024-05-06 06:10:42,232 - ood_dataset: MIntRec-OOD
2024-05-06 06:10:42,232 - data_mode: multi-class
2024-05-06 06:10:42,232 - multimodal_method: msz
2024-05-06 06:10:42,232 - method: msz
2024-05-06 06:10:42,232 - ood_detection_method: ma
2024-05-06 06:10:42,232 - text_backbone: bert-base-uncased
2024-05-06 06:10:42,232 - seed: 3
2024-05-06 06:10:42,232 - num_workers: 8
2024-05-06 06:10:42,232 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-06-05-50-06
2024-05-06 06:10:42,232 - gpu_id: 0
2024-05-06 06:10:42,232 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-06 06:10:42,232 - train: True
2024-05-06 06:10:42,232 - tune: True
2024-05-06 06:10:42,232 - ood: True
2024-05-06 06:10:42,232 - save_model: True
2024-05-06 06:10:42,233 - save_results: True
2024-05-06 06:10:42,233 - log_path: logs
2024-05-06 06:10:42,233 - cache_path: cache
2024-05-06 06:10:42,233 - video_data_path: video_data
2024-05-06 06:10:42,233 - audio_data_path: audio_data
2024-05-06 06:10:42,233 - video_feats_path: swin_feats.pkl
2024-05-06 06:10:42,233 - ood_video_feats_path: swin_feats.pkl
2024-05-06 06:10:42,233 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-06 06:10:42,233 - audio_feats_path: wavlm_feats.pkl
2024-05-06 06:10:42,233 - results_path: results
2024-05-06 06:10:42,233 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-06 06:10:42,233 - model_path: models
2024-05-06 06:10:42,233 - config_file_name: msz_MIntRec
2024-05-06 06:10:42,233 - results_file_name: results_msz_MIntRec.csv
2024-05-06 06:10:42,233 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-06 06:10:42,234 - text_seq_len: 30
2024-05-06 06:10:42,234 - video_seq_len: 230
2024-05-06 06:10:42,234 - audio_seq_len: 480
2024-05-06 06:10:42,234 - text_feat_dim: 768
2024-05-06 06:10:42,234 - video_feat_dim: 1024
2024-05-06 06:10:42,234 - audio_feat_dim: 768
2024-05-06 06:10:42,234 - ood_label_id: 20
2024-05-06 06:10:42,234 - num_labels: 20
2024-05-06 06:10:42,234 - num_train_examples: 1334
2024-05-06 06:10:42,234 - need_aligned: True
2024-05-06 06:10:42,234 - freeze_parameters: False
2024-05-06 06:10:42,234 - eval_monitor: acc
2024-05-06 06:10:42,234 - train_batch_size: 32
2024-05-06 06:10:42,234 - eval_batch_size: 16
2024-05-06 06:10:42,235 - num_train_epochs: 100
2024-05-06 06:10:42,235 - lr: [2e-05]
2024-05-06 06:10:42,235 - weight_decay: [0.1]
2024-05-06 06:10:42,235 - wait_patience: 5
2024-05-06 06:10:42,235 - warmup_proportion: [0.01]
2024-05-06 06:10:42,235 - hidden_dims: [768]
2024-05-06 06:10:42,235 - num_attention_heads: [8]
2024-05-06 06:10:42,235 - attention_probs_dropout_prob: [0.3]
2024-05-06 06:10:42,235 - hidden_dropout_prob: [0.1]
2024-05-06 06:10:42,235 - intermediate_size: [768]
2024-05-06 06:10:42,235 - num_hidden_layers: [4]
2024-05-06 06:10:42,235 - max_position_embeddings: [900]
2024-05-06 06:10:42,235 - position_embedding_type: absolute
2024-05-06 06:10:42,235 - batch_first: True
2024-05-06 06:10:42,235 - aligned_method: ['ctc']
2024-05-06 06:10:42,236 - sampler: beta
2024-05-06 06:10:42,236 - multiple_ood: [1]
2024-05-06 06:10:42,236 - select_number_min: [2]
2024-05-06 06:10:42,236 - select_number_max: [3]
2024-05-06 06:10:42,236 - alpha: [3]
2024-05-06 06:10:42,236 - mlp_hidden_size: [256]
2024-05-06 06:10:42,236 - mlp_dropout: [0.3]
2024-05-06 06:10:42,236 - scale: [8]
2024-05-06 06:10:42,236 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_3
2024-05-06 06:10:42,236 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-06 06:10:42,236 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_3
2024-05-06 06:10:42,236 - device: cuda
2024-05-06 06:10:42,236 - ============================== End Params ==============================
2024-05-06 06:10:43,986 - Multimodal Intent Recognition begins...
2024-05-06 06:10:43,986 - Training begins...
2024-05-06 06:11:15,127 - ***** Epoch: 1: Eval results *****
2024-05-06 06:11:15,128 -   binary_train_loss = 0.684
2024-05-06 06:11:15,128 -   binary_eval_score = 0.873
2024-05-06 06:11:15,128 -   train_loss = 2.042
2024-05-06 06:11:15,128 -   eval_score = 0.6292
2024-05-06 06:11:15,128 -   best_eval_score = 0.0
2024-05-06 06:11:46,454 - ***** Epoch: 2: Eval results *****
2024-05-06 06:11:46,454 -   binary_train_loss = 0.6735
2024-05-06 06:11:46,454 -   binary_eval_score = 0.709
2024-05-06 06:11:46,454 -   train_loss = 0.8325
2024-05-06 06:11:46,454 -   eval_score = 0.7034
2024-05-06 06:11:46,454 -   best_eval_score = 0.6292
2024-05-06 06:12:18,416 - ***** Epoch: 3: Eval results *****
2024-05-06 06:12:18,416 -   binary_train_loss = 0.6376
2024-05-06 06:12:18,417 -   binary_eval_score = 0.8607
2024-05-06 06:12:18,417 -   train_loss = 0.3821
2024-05-06 06:12:18,417 -   eval_score = 0.7056
2024-05-06 06:12:18,417 -   best_eval_score = 0.7034
2024-05-06 06:12:50,262 - ***** Epoch: 4: Eval results *****
2024-05-06 06:12:50,262 -   binary_train_loss = 0.4862
2024-05-06 06:12:50,262 -   binary_eval_score = 0.8652
2024-05-06 06:12:50,263 -   train_loss = 0.2141
2024-05-06 06:12:50,263 -   eval_score = 0.7101
2024-05-06 06:12:50,263 -   best_eval_score = 0.7056
2024-05-06 06:13:21,709 - ***** Epoch: 5: Eval results *****
2024-05-06 06:13:21,709 -   binary_train_loss = 0.3043
2024-05-06 06:13:21,709 -   binary_eval_score = 0.7011
2024-05-06 06:13:21,709 -   train_loss = 0.1554
2024-05-06 06:13:21,709 -   eval_score = 0.7303
2024-05-06 06:13:21,709 -   best_eval_score = 0.7101
2024-05-06 06:13:53,638 - ***** Epoch: 6: Eval results *****
2024-05-06 06:13:53,639 -   binary_train_loss = 0.2602
2024-05-06 06:13:53,639 -   binary_eval_score = 0.8652
2024-05-06 06:13:53,639 -   train_loss = 0.0736
2024-05-06 06:13:53,639 -   eval_score = 0.7483
2024-05-06 06:13:53,639 -   best_eval_score = 0.7303
2024-05-06 06:14:24,939 - ***** Epoch: 7: Eval results *****
2024-05-06 06:14:24,940 -   binary_train_loss = 0.1759
2024-05-06 06:14:24,940 -   binary_eval_score = 0.9461
2024-05-06 06:14:24,940 -   train_loss = 0.0724
2024-05-06 06:14:24,941 -   eval_score = 0.7393
2024-05-06 06:14:24,941 -   best_eval_score = 0.7483
2024-05-06 06:14:24,941 - EarlyStopping counter: 1 out of 5
2024-05-06 06:14:56,632 - ***** Epoch: 8: Eval results *****
2024-05-06 06:14:56,632 -   binary_train_loss = 0.1278
2024-05-06 06:14:56,632 -   binary_eval_score = 0.8787
2024-05-06 06:14:56,632 -   train_loss = 0.0599
2024-05-06 06:14:56,632 -   eval_score = 0.7393
2024-05-06 06:14:56,632 -   best_eval_score = 0.7483
2024-05-06 06:14:56,632 - EarlyStopping counter: 2 out of 5
2024-05-06 06:15:28,638 - ***** Epoch: 9: Eval results *****
2024-05-06 06:15:28,638 -   binary_train_loss = 0.1607
2024-05-06 06:15:28,638 -   binary_eval_score = 0.9596
2024-05-06 06:15:28,638 -   train_loss = 0.0459
2024-05-06 06:15:28,638 -   eval_score = 0.7506
2024-05-06 06:15:28,638 -   best_eval_score = 0.7483
2024-05-06 06:16:00,328 - ***** Epoch: 10: Eval results *****
2024-05-06 06:16:00,328 -   binary_train_loss = 0.1129
2024-05-06 06:16:00,328 -   binary_eval_score = 0.9674
2024-05-06 06:16:00,328 -   train_loss = 0.0337
2024-05-06 06:16:00,328 -   eval_score = 0.7483
2024-05-06 06:16:00,328 -   best_eval_score = 0.7506
2024-05-06 06:16:00,328 - EarlyStopping counter: 1 out of 5
2024-05-06 06:16:31,805 - ***** Epoch: 11: Eval results *****
2024-05-06 06:16:31,805 -   binary_train_loss = 0.1754
2024-05-06 06:16:31,805 -   binary_eval_score = 0.9483
2024-05-06 06:16:31,805 -   train_loss = 0.0374
2024-05-06 06:16:31,805 -   eval_score = 0.7371
2024-05-06 06:16:31,805 -   best_eval_score = 0.7506
2024-05-06 06:16:31,805 - EarlyStopping counter: 2 out of 5
2024-05-06 06:17:03,378 - ***** Epoch: 12: Eval results *****
2024-05-06 06:17:03,379 -   binary_train_loss = 0.1057
2024-05-06 06:17:03,379 -   binary_eval_score = 0.9865
2024-05-06 06:17:03,379 -   train_loss = 0.0333
2024-05-06 06:17:03,379 -   eval_score = 0.7281
2024-05-06 06:17:03,379 -   best_eval_score = 0.7506
2024-05-06 06:17:03,379 - EarlyStopping counter: 3 out of 5
2024-05-06 06:17:34,796 - ***** Epoch: 13: Eval results *****
2024-05-06 06:17:34,796 -   binary_train_loss = 0.0946
2024-05-06 06:17:34,796 -   binary_eval_score = 0.9764
2024-05-06 06:17:34,796 -   train_loss = 0.0315
2024-05-06 06:17:34,796 -   eval_score = 0.7236
2024-05-06 06:17:34,796 -   best_eval_score = 0.7506
2024-05-06 06:17:34,796 - EarlyStopping counter: 4 out of 5
2024-05-06 06:18:06,178 - ***** Epoch: 14: Eval results *****
2024-05-06 06:18:06,178 -   binary_train_loss = 0.0805
2024-05-06 06:18:06,178 -   binary_eval_score = 0.9719
2024-05-06 06:18:06,179 -   train_loss = 0.0205
2024-05-06 06:18:06,179 -   eval_score = 0.7348
2024-05-06 06:18:06,179 -   best_eval_score = 0.7506
2024-05-06 06:18:06,179 - EarlyStopping counter: 5 out of 5
2024-05-06 06:18:06,179 - EarlyStopping at epoch 14
2024-05-06 06:18:06,182 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-06 06:18:11,490 - Training is finished...
2024-05-06 06:18:11,491 - Testing begins...
2024-05-06 06:18:24,587 - ***** Out-of-domain Evaluation results *****
2024-05-06 06:18:24,587 -   aupr_in = 0.7793
2024-05-06 06:18:24,588 -   aupr_out = 0.7975
2024-05-06 06:18:24,588 -   auroc = 0.7953
2024-05-06 06:18:24,588 -   der = 0.3641
2024-05-06 06:18:24,588 -   eer = 0.2822
2024-05-06 06:18:24,588 -   fpr95 = 0.6822
2024-05-06 06:18:24,588 - Testing is finished...
2024-05-06 06:18:24,588 - Multimodal intent recognition is finished...
2024-05-06 06:18:24,588 - Results are saved in results/results_msz_MIntRec.csv
2024-05-06 06:18:24,703 - ============================== Params ==============================
2024-05-06 06:18:24,703 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-06 06:18:24,703 - dataset: MIntRec
2024-05-06 06:18:24,703 - ood_dataset: MIntRec-OOD
2024-05-06 06:18:24,703 - data_mode: multi-class
2024-05-06 06:18:24,703 - multimodal_method: msz
2024-05-06 06:18:24,704 - method: msz
2024-05-06 06:18:24,704 - ood_detection_method: ma
2024-05-06 06:18:24,704 - text_backbone: bert-base-uncased
2024-05-06 06:18:24,704 - seed: 4
2024-05-06 06:18:24,704 - num_workers: 8
2024-05-06 06:18:24,704 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-06-05-50-06
2024-05-06 06:18:24,704 - gpu_id: 0
2024-05-06 06:18:24,704 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-06 06:18:24,704 - train: True
2024-05-06 06:18:24,704 - tune: True
2024-05-06 06:18:24,704 - ood: True
2024-05-06 06:18:24,704 - save_model: True
2024-05-06 06:18:24,704 - save_results: True
2024-05-06 06:18:24,704 - log_path: logs
2024-05-06 06:18:24,704 - cache_path: cache
2024-05-06 06:18:24,704 - video_data_path: video_data
2024-05-06 06:18:24,704 - audio_data_path: audio_data
2024-05-06 06:18:24,704 - video_feats_path: swin_feats.pkl
2024-05-06 06:18:24,704 - ood_video_feats_path: swin_feats.pkl
2024-05-06 06:18:24,704 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-06 06:18:24,704 - audio_feats_path: wavlm_feats.pkl
2024-05-06 06:18:24,704 - results_path: results
2024-05-06 06:18:24,704 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-06 06:18:24,704 - model_path: models
2024-05-06 06:18:24,704 - config_file_name: msz_MIntRec
2024-05-06 06:18:24,704 - results_file_name: results_msz_MIntRec.csv
2024-05-06 06:18:24,704 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-06 06:18:24,704 - text_seq_len: 30
2024-05-06 06:18:24,704 - video_seq_len: 230
2024-05-06 06:18:24,704 - audio_seq_len: 480
2024-05-06 06:18:24,704 - text_feat_dim: 768
2024-05-06 06:18:24,704 - video_feat_dim: 1024
2024-05-06 06:18:24,704 - audio_feat_dim: 768
2024-05-06 06:18:24,704 - ood_label_id: 20
2024-05-06 06:18:24,704 - num_labels: 20
2024-05-06 06:18:24,704 - num_train_examples: 1334
2024-05-06 06:18:24,704 - need_aligned: True
2024-05-06 06:18:24,704 - freeze_parameters: False
2024-05-06 06:18:24,704 - eval_monitor: acc
2024-05-06 06:18:24,705 - train_batch_size: 32
2024-05-06 06:18:24,705 - eval_batch_size: 16
2024-05-06 06:18:24,705 - num_train_epochs: 100
2024-05-06 06:18:24,705 - lr: [2e-05]
2024-05-06 06:18:24,705 - weight_decay: [0.1]
2024-05-06 06:18:24,705 - wait_patience: 5
2024-05-06 06:18:24,705 - warmup_proportion: [0.01]
2024-05-06 06:18:24,705 - hidden_dims: [768]
2024-05-06 06:18:24,705 - num_attention_heads: [8]
2024-05-06 06:18:24,705 - attention_probs_dropout_prob: [0.3]
2024-05-06 06:18:24,705 - hidden_dropout_prob: [0.1]
2024-05-06 06:18:24,705 - intermediate_size: [768]
2024-05-06 06:18:24,705 - num_hidden_layers: [4]
2024-05-06 06:18:24,705 - max_position_embeddings: [900]
2024-05-06 06:18:24,705 - position_embedding_type: absolute
2024-05-06 06:18:24,705 - batch_first: True
2024-05-06 06:18:24,705 - aligned_method: ['ctc']
2024-05-06 06:18:24,705 - sampler: beta
2024-05-06 06:18:24,705 - multiple_ood: [1]
2024-05-06 06:18:24,705 - select_number_min: [2]
2024-05-06 06:18:24,705 - select_number_max: [3]
2024-05-06 06:18:24,705 - alpha: [3]
2024-05-06 06:18:24,705 - mlp_hidden_size: [256]
2024-05-06 06:18:24,705 - mlp_dropout: [0.3]
2024-05-06 06:18:24,705 - scale: [8]
2024-05-06 06:18:24,705 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_4
2024-05-06 06:18:24,705 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_4/models
2024-05-06 06:18:24,705 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_4
2024-05-06 06:18:24,705 - device: cuda
2024-05-06 06:18:24,705 - ============================== End Params ==============================
2024-05-06 06:18:26,579 - Multimodal Intent Recognition begins...
2024-05-06 06:18:26,579 - Training begins...
2024-05-06 06:18:57,967 - ***** Epoch: 1: Eval results *****
2024-05-06 06:18:57,967 -   binary_train_loss = 0.6807
2024-05-06 06:18:57,967 -   binary_eval_score = 0.827
2024-05-06 06:18:57,967 -   train_loss = 2.0498
2024-05-06 06:18:57,967 -   eval_score = 0.6674
2024-05-06 06:18:57,967 -   best_eval_score = 0.0
2024-05-06 06:19:29,406 - ***** Epoch: 2: Eval results *****
2024-05-06 06:19:29,406 -   binary_train_loss = 0.6608
2024-05-06 06:19:29,406 -   binary_eval_score = 0.7247
2024-05-06 06:19:29,406 -   train_loss = 0.7965
2024-05-06 06:19:29,406 -   eval_score = 0.7169
2024-05-06 06:19:29,406 -   best_eval_score = 0.6674
2024-05-06 06:20:00,146 - ***** Epoch: 3: Eval results *****
2024-05-06 06:20:00,146 -   binary_train_loss = 0.5802
2024-05-06 06:20:00,146 -   binary_eval_score = 0.8798
2024-05-06 06:20:00,146 -   train_loss = 0.3719
2024-05-06 06:20:00,146 -   eval_score = 0.7034
2024-05-06 06:20:00,146 -   best_eval_score = 0.7169
2024-05-06 06:20:00,146 - EarlyStopping counter: 1 out of 5
2024-05-06 06:20:31,510 - ***** Epoch: 4: Eval results *****
2024-05-06 06:20:31,511 -   binary_train_loss = 0.3622
2024-05-06 06:20:31,511 -   binary_eval_score = 0.9258
2024-05-06 06:20:31,511 -   train_loss = 0.2073
2024-05-06 06:20:31,511 -   eval_score = 0.7213
2024-05-06 06:20:31,511 -   best_eval_score = 0.7169
2024-05-06 06:21:02,583 - ***** Epoch: 5: Eval results *****
2024-05-06 06:21:02,583 -   binary_train_loss = 0.2366
2024-05-06 06:21:02,583 -   binary_eval_score = 0.8742
2024-05-06 06:21:02,583 -   train_loss = 0.1343
2024-05-06 06:21:02,583 -   eval_score = 0.7326
2024-05-06 06:21:02,583 -   best_eval_score = 0.7213
2024-05-06 06:21:33,975 - ***** Epoch: 6: Eval results *****
2024-05-06 06:21:33,975 -   binary_train_loss = 0.2068
2024-05-06 06:21:33,975 -   binary_eval_score = 0.9472
2024-05-06 06:21:33,975 -   train_loss = 0.075
2024-05-06 06:21:33,975 -   eval_score = 0.7326
2024-05-06 06:21:33,975 -   best_eval_score = 0.7326
2024-05-06 06:21:33,975 - EarlyStopping counter: 1 out of 5
2024-05-06 06:22:05,249 - ***** Epoch: 7: Eval results *****
2024-05-06 06:22:05,249 -   binary_train_loss = 0.139
2024-05-06 06:22:05,249 -   binary_eval_score = 0.9674
2024-05-06 06:22:05,249 -   train_loss = 0.0587
2024-05-06 06:22:05,249 -   eval_score = 0.7303
2024-05-06 06:22:05,249 -   best_eval_score = 0.7326
2024-05-06 06:22:05,249 - EarlyStopping counter: 2 out of 5
2024-05-06 06:22:36,814 - ***** Epoch: 8: Eval results *****
2024-05-06 06:22:36,814 -   binary_train_loss = 0.1244
2024-05-06 06:22:36,814 -   binary_eval_score = 0.9607
2024-05-06 06:22:36,814 -   train_loss = 0.0483
2024-05-06 06:22:36,814 -   eval_score = 0.7213
2024-05-06 06:22:36,814 -   best_eval_score = 0.7326
2024-05-06 06:22:36,814 - EarlyStopping counter: 3 out of 5
2024-05-06 06:23:07,896 - ***** Epoch: 9: Eval results *****
2024-05-06 06:23:07,896 -   binary_train_loss = 0.1877
2024-05-06 06:23:07,896 -   binary_eval_score = 0.9787
2024-05-06 06:23:07,896 -   train_loss = 0.0334
2024-05-06 06:23:07,896 -   eval_score = 0.7258
2024-05-06 06:23:07,896 -   best_eval_score = 0.7326
2024-05-06 06:23:07,897 - EarlyStopping counter: 4 out of 5
2024-05-06 06:23:39,084 - ***** Epoch: 10: Eval results *****
2024-05-06 06:23:39,084 -   binary_train_loss = 0.1257
2024-05-06 06:23:39,084 -   binary_eval_score = 0.991
2024-05-06 06:23:39,084 -   train_loss = 0.0308
2024-05-06 06:23:39,084 -   eval_score = 0.7146
2024-05-06 06:23:39,084 -   best_eval_score = 0.7326
2024-05-06 06:23:39,084 - EarlyStopping counter: 5 out of 5
2024-05-06 06:23:39,085 - EarlyStopping at epoch 10
2024-05-06 06:23:39,087 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_4/models
2024-05-06 06:23:44,341 - Training is finished...
2024-05-06 06:23:44,342 - Testing begins...
2024-05-06 06:23:57,788 - ***** Out-of-domain Evaluation results *****
2024-05-06 06:23:57,788 -   aupr_in = 0.7868
2024-05-06 06:23:57,789 -   aupr_out = 0.7959
2024-05-06 06:23:57,789 -   auroc = 0.7985
2024-05-06 06:23:57,789 -   der = 0.374
2024-05-06 06:23:57,789 -   eer = 0.2711
2024-05-06 06:23:57,789 -   fpr95 = 0.7044
2024-05-06 06:23:57,789 - Testing is finished...
2024-05-06 06:23:57,789 - Multimodal intent recognition is finished...
2024-05-06 06:23:57,789 - Results are saved in results/results_msz_MIntRec.csv
