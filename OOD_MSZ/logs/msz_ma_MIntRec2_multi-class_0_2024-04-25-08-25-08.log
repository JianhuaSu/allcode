2024-04-25 08:25:08,155 - Lists of intent labels are: ['Acknowledge', 'Advise', 'Agree', 'Apologise', 'Arrange', 'Ask for help', 'Asking for opinions', 'Care', 'Comfort', 'Complain', 'Confirm', 'Criticize', 'Doubt', 'Emphasize', 'Explain', 'Flaunt', 'Greet', 'Inform', 'Introduce', 'Invite', 'Joke', 'Leave', 'Oppose', 'Plan', 'Praise', 'Prevent', 'Refuse', 'Taunt', 'Thank', 'Warn']
2024-04-25 08:25:08,155 - ID Data preparation...
2024-04-25 08:25:53,409 - OOD Data preparation...
2024-04-25 08:26:18,893 - ============================== Params ==============================
2024-04-25 08:26:18,893 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-04-25 08:26:18,893 - dataset: MIntRec2
2024-04-25 08:26:18,893 - ood_dataset: MIntRec2-OOD
2024-04-25 08:26:18,893 - data_mode: multi-class
2024-04-25 08:26:18,893 - multimodal_method: msz
2024-04-25 08:26:18,893 - method: msz
2024-04-25 08:26:18,893 - ood_detection_method: ma
2024-04-25 08:26:18,893 - text_backbone: bert-base-uncased
2024-04-25 08:26:18,893 - seed: 0
2024-04-25 08:26:18,894 - num_workers: 8
2024-04-25 08:26:18,894 - log_id: msz_ma_MIntRec2_multi-class_0_2024-04-25-08-25-08
2024-04-25 08:26:18,894 - gpu_id: 3
2024-04-25 08:26:18,894 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-25 08:26:18,894 - train: True
2024-04-25 08:26:18,894 - tune: True
2024-04-25 08:26:18,894 - ood: True
2024-04-25 08:26:18,894 - save_model: False
2024-04-25 08:26:18,894 - save_results: True
2024-04-25 08:26:18,894 - log_path: logs
2024-04-25 08:26:18,894 - cache_path: cache
2024-04-25 08:26:18,894 - video_data_path: video_data
2024-04-25 08:26:18,894 - audio_data_path: audio_data
2024-04-25 08:26:18,894 - video_feats_path: swin_feats.pkl
2024-04-25 08:26:18,894 - ood_video_feats_path: swin_feats.pkl
2024-04-25 08:26:18,894 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-25 08:26:18,894 - audio_feats_path: wavlm_feats.pkl
2024-04-25 08:26:18,894 - results_path: results
2024-04-25 08:26:18,894 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz
2024-04-25 08:26:18,894 - model_path: models
2024-04-25 08:26:18,894 - config_file_name: msz_MIntRec2
2024-04-25 08:26:18,894 - results_file_name: results_msz_MIntRec2.csv
2024-04-25 08:26:18,894 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-25 08:26:18,894 - text_seq_len: 50
2024-04-25 08:26:18,894 - video_seq_len: 180
2024-04-25 08:26:18,894 - audio_seq_len: 400
2024-04-25 08:26:18,894 - text_feat_dim: 768
2024-04-25 08:26:18,894 - video_feat_dim: 256
2024-04-25 08:26:18,894 - audio_feat_dim: 768
2024-04-25 08:26:18,894 - ood_label_id: 30
2024-04-25 08:26:18,894 - num_labels: 30
2024-04-25 08:26:18,894 - num_train_examples: 6165
2024-04-25 08:26:18,894 - need_aligned: True
2024-04-25 08:26:18,894 - freeze_parameters: False
2024-04-25 08:26:18,894 - eval_monitor: acc
2024-04-25 08:26:18,894 - train_batch_size: 32
2024-04-25 08:26:18,894 - eval_batch_size: 16
2024-04-25 08:26:18,894 - num_train_epochs: 100
2024-04-25 08:26:18,895 - lr: [1e-05]
2024-04-25 08:26:18,895 - weight_decay: [0.1]
2024-04-25 08:26:18,895 - wait_patience: 5
2024-04-25 08:26:18,895 - warmup_proportion: [0.01]
2024-04-25 08:26:18,895 - hidden_dims: [768]
2024-04-25 08:26:18,895 - num_attention_heads: [4]
2024-04-25 08:26:18,895 - attention_probs_dropout_prob: [0.3]
2024-04-25 08:26:18,895 - hidden_dropout_prob: [0.3]
2024-04-25 08:26:18,895 - intermediate_size: [768]
2024-04-25 08:26:18,895 - num_hidden_layers: [5]
2024-04-25 08:26:18,895 - max_position_embeddings: [768]
2024-04-25 08:26:18,895 - position_embedding_type: absolute
2024-04-25 08:26:18,895 - batch_first: True
2024-04-25 08:26:18,895 - aligned_method: ['ctc']
2024-04-25 08:26:18,895 - sampler: beta
2024-04-25 08:26:18,895 - multiple_ood: [1]
2024-04-25 08:26:18,895 - select_number_min: [2]
2024-04-25 08:26:18,895 - select_number_max: [3]
2024-04-25 08:26:18,895 - mlp_hidden_size: [256]
2024-04-25 08:26:18,895 - mlp_dropout: [0.3]
2024-04-25 08:26:18,895 - alpha: [2]
2024-04-25 08:26:18,895 - scale: [8]
2024-04-25 08:26:18,895 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_0
2024-04-25 08:26:18,895 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_0/models
2024-04-25 08:26:18,895 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/binary_msz_MIntRec2_bert-base-uncased_0
2024-04-25 08:26:18,895 - ============================== End Params ==============================
2024-04-25 08:26:22,564 - Multimodal Intent Recognition begins...
2024-04-25 08:26:22,564 - Training begins...
2024-04-25 08:29:23,022 - ***** Epoch: 1: Eval results *****
2024-04-25 08:29:23,023 -   binary_train_loss = 0.5674
2024-04-25 08:29:23,023 -   binary_eval_score = 0.9607
2024-04-25 08:29:23,023 -   train_loss = 2.4706
2024-04-25 08:29:23,023 -   eval_score = 0.5163
2024-04-25 08:29:23,023 -   best_eval_score = 0.0
2024-04-25 08:32:22,366 - ***** Epoch: 2: Eval results *****
2024-04-25 08:32:22,375 -   binary_train_loss = 0.2006
2024-04-25 08:32:22,375 -   binary_eval_score = 0.9815
2024-04-25 08:32:22,375 -   train_loss = 1.4724
2024-04-25 08:32:22,375 -   eval_score = 0.5769
2024-04-25 08:32:22,375 -   best_eval_score = 0.5163
2024-04-25 08:35:21,694 - ***** Epoch: 3: Eval results *****
2024-04-25 08:35:21,694 -   binary_train_loss = 0.1431
2024-04-25 08:35:21,694 -   binary_eval_score = 0.967
2024-04-25 08:35:21,695 -   train_loss = 1.1313
2024-04-25 08:35:21,695 -   eval_score = 0.5769
2024-04-25 08:35:21,695 -   best_eval_score = 0.5769
2024-04-25 08:35:21,695 - EarlyStopping counter: 1 out of 5
2024-04-25 08:38:21,249 - ***** Epoch: 4: Eval results *****
2024-04-25 08:38:21,249 -   binary_train_loss = 0.1142
2024-04-25 08:38:21,249 -   binary_eval_score = 0.9625
2024-04-25 08:38:21,249 -   train_loss = 0.8721
2024-04-25 08:38:21,249 -   eval_score = 0.5841
2024-04-25 08:38:21,249 -   best_eval_score = 0.5769
2024-04-25 08:41:21,765 - ***** Epoch: 5: Eval results *****
2024-04-25 08:41:21,765 -   binary_train_loss = 0.1046
2024-04-25 08:41:21,765 -   binary_eval_score = 0.9742
2024-04-25 08:41:21,765 -   train_loss = 0.6472
2024-04-25 08:41:21,765 -   eval_score = 0.5814
2024-04-25 08:41:21,765 -   best_eval_score = 0.5841
2024-04-25 08:41:21,765 - EarlyStopping counter: 1 out of 5
2024-04-25 08:44:21,931 - ***** Epoch: 6: Eval results *****
2024-04-25 08:44:21,932 -   binary_train_loss = 0.0957
2024-04-25 08:44:21,932 -   binary_eval_score = 0.9833
2024-04-25 08:44:21,932 -   train_loss = 0.4746
2024-04-25 08:44:21,932 -   eval_score = 0.5859
2024-04-25 08:44:21,932 -   best_eval_score = 0.5841
2024-04-25 08:47:22,628 - ***** Epoch: 7: Eval results *****
2024-04-25 08:47:22,629 -   binary_train_loss = 0.0847
2024-04-25 08:47:22,629 -   binary_eval_score = 0.9715
2024-04-25 08:47:22,629 -   train_loss = 0.3335
2024-04-25 08:47:22,629 -   eval_score = 0.5814
2024-04-25 08:47:22,629 -   best_eval_score = 0.5859
2024-04-25 08:47:22,629 - EarlyStopping counter: 1 out of 5
2024-04-25 08:50:23,581 - ***** Epoch: 8: Eval results *****
2024-04-25 08:50:23,581 -   binary_train_loss = 0.0825
2024-04-25 08:50:23,581 -   binary_eval_score = 0.9887
2024-04-25 08:50:23,581 -   train_loss = 0.2368
2024-04-25 08:50:23,581 -   eval_score = 0.6022
2024-04-25 08:50:23,581 -   best_eval_score = 0.5859
2024-04-25 08:53:24,400 - ***** Epoch: 9: Eval results *****
2024-04-25 08:53:24,400 -   binary_train_loss = 0.0813
2024-04-25 08:53:24,400 -   binary_eval_score = 0.986
2024-04-25 08:53:24,400 -   train_loss = 0.1902
2024-04-25 08:53:24,400 -   eval_score = 0.5904
2024-04-25 08:53:24,401 -   best_eval_score = 0.6022
2024-04-25 08:53:24,401 - EarlyStopping counter: 1 out of 5
2024-04-25 08:56:25,770 - ***** Epoch: 10: Eval results *****
2024-04-25 08:56:25,770 -   binary_train_loss = 0.0654
2024-04-25 08:56:25,770 -   binary_eval_score = 0.9801
2024-04-25 08:56:25,770 -   train_loss = 0.1525
2024-04-25 08:56:25,770 -   eval_score = 0.5904
2024-04-25 08:56:25,770 -   best_eval_score = 0.6022
2024-04-25 08:56:25,770 - EarlyStopping counter: 2 out of 5
2024-04-25 08:59:29,231 - ***** Epoch: 11: Eval results *****
2024-04-25 08:59:29,232 -   binary_train_loss = 0.0711
2024-04-25 08:59:29,232 -   binary_eval_score = 0.981
2024-04-25 08:59:29,232 -   train_loss = 0.1232
2024-04-25 08:59:29,232 -   eval_score = 0.5787
2024-04-25 08:59:29,232 -   best_eval_score = 0.6022
2024-04-25 08:59:29,232 - EarlyStopping counter: 3 out of 5
2024-04-25 09:02:31,188 - ***** Epoch: 12: Eval results *****
2024-04-25 09:02:31,196 -   binary_train_loss = 0.0643
2024-04-25 09:02:31,196 -   binary_eval_score = 0.9896
2024-04-25 09:02:31,197 -   train_loss = 0.1088
2024-04-25 09:02:31,197 -   eval_score = 0.5787
2024-04-25 09:02:31,197 -   best_eval_score = 0.6022
2024-04-25 09:02:31,197 - EarlyStopping counter: 4 out of 5
2024-04-25 09:05:35,128 - ***** Epoch: 13: Eval results *****
2024-04-25 09:05:35,137 -   binary_train_loss = 0.0734
2024-04-25 09:05:35,137 -   binary_eval_score = 0.9828
2024-04-25 09:05:35,137 -   train_loss = 0.0893
2024-04-25 09:05:35,137 -   eval_score = 0.5895
2024-04-25 09:05:35,137 -   best_eval_score = 0.6022
2024-04-25 09:05:35,137 - EarlyStopping counter: 5 out of 5
2024-04-25 09:05:35,137 - EarlyStopping at epoch 13
2024-04-25 09:05:35,142 - Training is finished...
2024-04-25 09:05:35,142 - Testing begins...
2024-04-25 09:06:24,931 - ***** Out-of-domain Evaluation results *****
2024-04-25 09:06:24,931 -   aupr_in = 0.5801
2024-04-25 09:06:24,932 -   aupr_out = 0.4506
2024-04-25 09:06:24,932 -   auroc = 0.5185
2024-04-25 09:06:24,932 -   der = 0.5542
2024-04-25 09:06:24,932 -   eer = 0.4862
2024-04-25 09:06:24,932 -   fpr95 = 0.9418
2024-04-25 09:06:24,932 - Testing is finished...
2024-04-25 09:06:24,932 - Multimodal intent recognition is finished...
2024-04-25 09:06:24,932 - Results are saved in results/results_msz_MIntRec2.csv
2024-04-25 09:06:25,044 - ============================== Params ==============================
2024-04-25 09:06:25,044 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-04-25 09:06:25,044 - dataset: MIntRec2
2024-04-25 09:06:25,044 - ood_dataset: MIntRec2-OOD
2024-04-25 09:06:25,044 - data_mode: multi-class
2024-04-25 09:06:25,044 - multimodal_method: msz
2024-04-25 09:06:25,044 - method: msz
2024-04-25 09:06:25,044 - ood_detection_method: ma
2024-04-25 09:06:25,044 - text_backbone: bert-base-uncased
2024-04-25 09:06:25,044 - seed: 2
2024-04-25 09:06:25,044 - num_workers: 8
2024-04-25 09:06:25,044 - log_id: msz_ma_MIntRec2_multi-class_0_2024-04-25-08-25-08
2024-04-25 09:06:25,045 - gpu_id: 3
2024-04-25 09:06:25,045 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-25 09:06:25,045 - train: True
2024-04-25 09:06:25,045 - tune: True
2024-04-25 09:06:25,045 - ood: True
2024-04-25 09:06:25,045 - save_model: False
2024-04-25 09:06:25,045 - save_results: True
2024-04-25 09:06:25,045 - log_path: logs
2024-04-25 09:06:25,045 - cache_path: cache
2024-04-25 09:06:25,045 - video_data_path: video_data
2024-04-25 09:06:25,045 - audio_data_path: audio_data
2024-04-25 09:06:25,045 - video_feats_path: swin_feats.pkl
2024-04-25 09:06:25,045 - ood_video_feats_path: swin_feats.pkl
2024-04-25 09:06:25,045 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-25 09:06:25,045 - audio_feats_path: wavlm_feats.pkl
2024-04-25 09:06:25,045 - results_path: results
2024-04-25 09:06:25,045 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz
2024-04-25 09:06:25,045 - model_path: models
2024-04-25 09:06:25,045 - config_file_name: msz_MIntRec2
2024-04-25 09:06:25,045 - results_file_name: results_msz_MIntRec2.csv
2024-04-25 09:06:25,045 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-25 09:06:25,045 - text_seq_len: 50
2024-04-25 09:06:25,045 - video_seq_len: 180
2024-04-25 09:06:25,045 - audio_seq_len: 400
2024-04-25 09:06:25,045 - text_feat_dim: 768
2024-04-25 09:06:25,045 - video_feat_dim: 256
2024-04-25 09:06:25,045 - audio_feat_dim: 768
2024-04-25 09:06:25,045 - ood_label_id: 30
2024-04-25 09:06:25,045 - num_labels: 30
2024-04-25 09:06:25,045 - num_train_examples: 6165
2024-04-25 09:06:25,045 - need_aligned: True
2024-04-25 09:06:25,045 - freeze_parameters: False
2024-04-25 09:06:25,045 - eval_monitor: acc
2024-04-25 09:06:25,045 - train_batch_size: 32
2024-04-25 09:06:25,045 - eval_batch_size: 16
2024-04-25 09:06:25,045 - num_train_epochs: 100
2024-04-25 09:06:25,045 - lr: [1e-05]
2024-04-25 09:06:25,045 - weight_decay: [0.1]
2024-04-25 09:06:25,045 - wait_patience: 5
2024-04-25 09:06:25,045 - warmup_proportion: [0.01]
2024-04-25 09:06:25,045 - hidden_dims: [768]
2024-04-25 09:06:25,045 - num_attention_heads: [4]
2024-04-25 09:06:25,045 - attention_probs_dropout_prob: [0.3]
2024-04-25 09:06:25,045 - hidden_dropout_prob: [0.3]
2024-04-25 09:06:25,045 - intermediate_size: [768]
2024-04-25 09:06:25,046 - num_hidden_layers: [5]
2024-04-25 09:06:25,046 - max_position_embeddings: [768]
2024-04-25 09:06:25,046 - position_embedding_type: absolute
2024-04-25 09:06:25,046 - batch_first: True
2024-04-25 09:06:25,046 - aligned_method: ['ctc']
2024-04-25 09:06:25,046 - sampler: beta
2024-04-25 09:06:25,046 - multiple_ood: [1]
2024-04-25 09:06:25,046 - select_number_min: [2]
2024-04-25 09:06:25,046 - select_number_max: [3]
2024-04-25 09:06:25,046 - mlp_hidden_size: [256]
2024-04-25 09:06:25,046 - mlp_dropout: [0.3]
2024-04-25 09:06:25,046 - alpha: [2]
2024-04-25 09:06:25,046 - scale: [8]
2024-04-25 09:06:25,046 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_2
2024-04-25 09:06:25,046 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_2/models
2024-04-25 09:06:25,046 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/binary_msz_MIntRec2_bert-base-uncased_2
2024-04-25 09:06:25,046 - device: cuda
2024-04-25 09:06:25,046 - ============================== End Params ==============================
2024-04-25 09:06:26,773 - Multimodal Intent Recognition begins...
2024-04-25 09:06:26,773 - Training begins...
2024-04-25 09:09:29,019 - ***** Epoch: 1: Eval results *****
2024-04-25 09:09:29,020 -   binary_train_loss = 0.5597
2024-04-25 09:09:29,020 -   binary_eval_score = 0.9471
2024-04-25 09:09:29,020 -   train_loss = 2.5199
2024-04-25 09:09:29,020 -   eval_score = 0.4964
2024-04-25 09:09:29,020 -   best_eval_score = 0.0
2024-04-25 09:12:30,901 - ***** Epoch: 2: Eval results *****
2024-04-25 09:12:30,902 -   binary_train_loss = 0.1777
2024-04-25 09:12:30,902 -   binary_eval_score = 0.9806
2024-04-25 09:12:30,902 -   train_loss = 1.496
2024-04-25 09:12:30,902 -   eval_score = 0.5778
2024-04-25 09:12:30,902 -   best_eval_score = 0.4964
2024-04-25 09:15:32,802 - ***** Epoch: 3: Eval results *****
2024-04-25 09:15:32,803 -   binary_train_loss = 0.1205
2024-04-25 09:15:32,803 -   binary_eval_score = 0.9168
2024-04-25 09:15:32,803 -   train_loss = 1.1459
2024-04-25 09:15:32,803 -   eval_score = 0.575
2024-04-25 09:15:32,803 -   best_eval_score = 0.5778
2024-04-25 09:15:32,803 - EarlyStopping counter: 1 out of 5
2024-04-25 09:18:34,585 - ***** Epoch: 4: Eval results *****
2024-04-25 09:18:34,585 -   binary_train_loss = 0.1051
2024-04-25 09:18:34,585 -   binary_eval_score = 0.9837
2024-04-25 09:18:34,585 -   train_loss = 0.8733
2024-04-25 09:18:34,585 -   eval_score = 0.5805
2024-04-25 09:18:34,585 -   best_eval_score = 0.5778
2024-04-25 09:21:35,820 - ***** Epoch: 5: Eval results *****
2024-04-25 09:21:35,821 -   binary_train_loss = 0.1005
2024-04-25 09:21:35,821 -   binary_eval_score = 0.9846
2024-04-25 09:21:35,821 -   train_loss = 0.6447
2024-04-25 09:21:35,821 -   eval_score = 0.5922
2024-04-25 09:21:35,821 -   best_eval_score = 0.5805
2024-04-25 09:24:37,622 - ***** Epoch: 6: Eval results *****
2024-04-25 09:24:37,622 -   binary_train_loss = 0.0903
2024-04-25 09:24:37,622 -   binary_eval_score = 0.9819
2024-04-25 09:24:37,622 -   train_loss = 0.467
2024-04-25 09:24:37,622 -   eval_score = 0.5723
2024-04-25 09:24:37,622 -   best_eval_score = 0.5922
2024-04-25 09:24:37,622 - EarlyStopping counter: 1 out of 5
2024-04-25 09:27:38,380 - ***** Epoch: 7: Eval results *****
2024-04-25 09:27:38,380 -   binary_train_loss = 0.0788
2024-04-25 09:27:38,380 -   binary_eval_score = 0.9855
2024-04-25 09:27:38,380 -   train_loss = 0.348
2024-04-25 09:27:38,380 -   eval_score = 0.5787
2024-04-25 09:27:38,380 -   best_eval_score = 0.5922
2024-04-25 09:27:38,380 - EarlyStopping counter: 2 out of 5
2024-04-25 09:30:39,468 - ***** Epoch: 8: Eval results *****
2024-04-25 09:30:39,468 -   binary_train_loss = 0.0887
2024-04-25 09:30:39,468 -   binary_eval_score = 0.9435
2024-04-25 09:30:39,468 -   train_loss = 0.262
2024-04-25 09:30:39,468 -   eval_score = 0.5769
2024-04-25 09:30:39,468 -   best_eval_score = 0.5922
2024-04-25 09:30:39,468 - EarlyStopping counter: 3 out of 5
2024-04-25 09:33:41,072 - ***** Epoch: 9: Eval results *****
2024-04-25 09:33:41,072 -   binary_train_loss = 0.0732
2024-04-25 09:33:41,072 -   binary_eval_score = 0.9733
2024-04-25 09:33:41,072 -   train_loss = 0.1824
2024-04-25 09:33:41,072 -   eval_score = 0.5696
2024-04-25 09:33:41,072 -   best_eval_score = 0.5922
2024-04-25 09:33:41,072 - EarlyStopping counter: 4 out of 5
2024-04-25 09:36:42,115 - ***** Epoch: 10: Eval results *****
2024-04-25 09:36:42,115 -   binary_train_loss = 0.077
2024-04-25 09:36:42,115 -   binary_eval_score = 0.9778
2024-04-25 09:36:42,115 -   train_loss = 0.1537
2024-04-25 09:36:42,115 -   eval_score = 0.594
2024-04-25 09:36:42,115 -   best_eval_score = 0.5922
2024-04-25 09:39:43,028 - ***** Epoch: 11: Eval results *****
2024-04-25 09:39:43,028 -   binary_train_loss = 0.0688
2024-04-25 09:39:43,028 -   binary_eval_score = 0.9819
2024-04-25 09:39:43,028 -   train_loss = 0.1244
2024-04-25 09:39:43,028 -   eval_score = 0.5778
2024-04-25 09:39:43,028 -   best_eval_score = 0.594
2024-04-25 09:39:43,028 - EarlyStopping counter: 1 out of 5
2024-04-25 09:42:42,213 - ***** Epoch: 12: Eval results *****
2024-04-25 09:42:42,213 -   binary_train_loss = 0.0696
2024-04-25 09:42:42,213 -   binary_eval_score = 0.9828
2024-04-25 09:42:42,213 -   train_loss = nan
2024-04-25 09:42:42,213 -   eval_score = 0.0362
2024-04-25 09:42:42,213 -   best_eval_score = 0.594
2024-04-25 09:42:42,213 - EarlyStopping counter: 2 out of 5
2024-04-25 09:45:38,997 - ***** Epoch: 13: Eval results *****
2024-04-25 09:45:38,997 -   binary_train_loss = nan
2024-04-25 09:45:38,997 -   binary_eval_score = 0.5
2024-04-25 09:45:38,997 -   train_loss = nan
2024-04-25 09:45:38,997 -   eval_score = 0.0362
2024-04-25 09:45:38,997 -   best_eval_score = 0.594
2024-04-25 09:45:38,997 - EarlyStopping counter: 3 out of 5
2024-04-25 09:48:34,882 - ***** Epoch: 14: Eval results *****
2024-04-25 09:48:34,882 -   binary_train_loss = nan
2024-04-25 09:48:34,882 -   binary_eval_score = 0.5
2024-04-25 09:48:34,882 -   train_loss = nan
2024-04-25 09:48:34,882 -   eval_score = 0.0362
2024-04-25 09:48:34,882 -   best_eval_score = 0.594
2024-04-25 09:48:34,882 - EarlyStopping counter: 4 out of 5
2024-04-25 09:51:31,605 - ***** Epoch: 15: Eval results *****
2024-04-25 09:51:31,605 -   binary_train_loss = nan
2024-04-25 09:51:31,605 -   binary_eval_score = 0.5
2024-04-25 09:51:31,605 -   train_loss = nan
2024-04-25 09:51:31,605 -   eval_score = 0.0362
2024-04-25 09:51:31,605 -   best_eval_score = 0.594
2024-04-25 09:51:31,605 - EarlyStopping counter: 5 out of 5
2024-04-25 09:51:31,605 - EarlyStopping at epoch 15
2024-04-25 09:51:31,609 - Training is finished...
2024-04-25 09:51:31,609 - Testing begins...
2024-04-25 09:52:20,404 - ***** Out-of-domain Evaluation results *****
2024-04-25 09:52:20,404 -   aupr_in = 0.5775
2024-04-25 09:52:20,404 -   aupr_out = 0.4479
2024-04-25 09:52:20,404 -   auroc = 0.5153
2024-04-25 09:52:20,405 -   der = 0.5543
2024-04-25 09:52:20,405 -   eer = 0.4888
2024-04-25 09:52:20,405 -   fpr95 = 0.9424
2024-04-25 09:52:20,405 - Testing is finished...
2024-04-25 09:52:20,405 - Multimodal intent recognition is finished...
2024-04-25 09:52:20,406 - Results are saved in results/results_msz_MIntRec2.csv
2024-04-25 09:52:20,493 - ============================== Params ==============================
2024-04-25 09:52:20,493 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-04-25 09:52:20,493 - dataset: MIntRec2
2024-04-25 09:52:20,493 - ood_dataset: MIntRec2-OOD
2024-04-25 09:52:20,493 - data_mode: multi-class
2024-04-25 09:52:20,493 - multimodal_method: msz
2024-04-25 09:52:20,493 - method: msz
2024-04-25 09:52:20,493 - ood_detection_method: ma
2024-04-25 09:52:20,493 - text_backbone: bert-base-uncased
2024-04-25 09:52:20,493 - seed: 3
2024-04-25 09:52:20,493 - num_workers: 8
2024-04-25 09:52:20,493 - log_id: msz_ma_MIntRec2_multi-class_0_2024-04-25-08-25-08
2024-04-25 09:52:20,493 - gpu_id: 3
2024-04-25 09:52:20,493 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-25 09:52:20,493 - train: True
2024-04-25 09:52:20,493 - tune: True
2024-04-25 09:52:20,493 - ood: True
2024-04-25 09:52:20,493 - save_model: False
2024-04-25 09:52:20,493 - save_results: True
2024-04-25 09:52:20,493 - log_path: logs
2024-04-25 09:52:20,493 - cache_path: cache
2024-04-25 09:52:20,493 - video_data_path: video_data
2024-04-25 09:52:20,493 - audio_data_path: audio_data
2024-04-25 09:52:20,493 - video_feats_path: swin_feats.pkl
2024-04-25 09:52:20,493 - ood_video_feats_path: swin_feats.pkl
2024-04-25 09:52:20,493 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-25 09:52:20,493 - audio_feats_path: wavlm_feats.pkl
2024-04-25 09:52:20,493 - results_path: results
2024-04-25 09:52:20,493 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz
2024-04-25 09:52:20,493 - model_path: models
2024-04-25 09:52:20,493 - config_file_name: msz_MIntRec2
2024-04-25 09:52:20,493 - results_file_name: results_msz_MIntRec2.csv
2024-04-25 09:52:20,493 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-25 09:52:20,493 - text_seq_len: 50
2024-04-25 09:52:20,493 - video_seq_len: 180
2024-04-25 09:52:20,493 - audio_seq_len: 400
2024-04-25 09:52:20,493 - text_feat_dim: 768
2024-04-25 09:52:20,494 - video_feat_dim: 256
2024-04-25 09:52:20,494 - audio_feat_dim: 768
2024-04-25 09:52:20,494 - ood_label_id: 30
2024-04-25 09:52:20,494 - num_labels: 30
2024-04-25 09:52:20,494 - num_train_examples: 6165
2024-04-25 09:52:20,494 - need_aligned: True
2024-04-25 09:52:20,494 - freeze_parameters: False
2024-04-25 09:52:20,494 - eval_monitor: acc
2024-04-25 09:52:20,494 - train_batch_size: 32
2024-04-25 09:52:20,494 - eval_batch_size: 16
2024-04-25 09:52:20,494 - num_train_epochs: 100
2024-04-25 09:52:20,494 - lr: [1e-05]
2024-04-25 09:52:20,494 - weight_decay: [0.1]
2024-04-25 09:52:20,494 - wait_patience: 5
2024-04-25 09:52:20,494 - warmup_proportion: [0.01]
2024-04-25 09:52:20,494 - hidden_dims: [768]
2024-04-25 09:52:20,494 - num_attention_heads: [4]
2024-04-25 09:52:20,494 - attention_probs_dropout_prob: [0.3]
2024-04-25 09:52:20,494 - hidden_dropout_prob: [0.3]
2024-04-25 09:52:20,494 - intermediate_size: [768]
2024-04-25 09:52:20,494 - num_hidden_layers: [5]
2024-04-25 09:52:20,494 - max_position_embeddings: [768]
2024-04-25 09:52:20,494 - position_embedding_type: absolute
2024-04-25 09:52:20,494 - batch_first: True
2024-04-25 09:52:20,494 - aligned_method: ['ctc']
2024-04-25 09:52:20,494 - sampler: beta
2024-04-25 09:52:20,494 - multiple_ood: [1]
2024-04-25 09:52:20,494 - select_number_min: [2]
2024-04-25 09:52:20,494 - select_number_max: [3]
2024-04-25 09:52:20,494 - mlp_hidden_size: [256]
2024-04-25 09:52:20,494 - mlp_dropout: [0.3]
2024-04-25 09:52:20,494 - alpha: [2]
2024-04-25 09:52:20,494 - scale: [8]
2024-04-25 09:52:20,494 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_3
2024-04-25 09:52:20,494 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_3/models
2024-04-25 09:52:20,494 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/binary_msz_MIntRec2_bert-base-uncased_3
2024-04-25 09:52:20,494 - device: cuda
2024-04-25 09:52:20,495 - ============================== End Params ==============================
2024-04-25 09:52:23,574 - Multimodal Intent Recognition begins...
2024-04-25 09:52:23,574 - Training begins...
