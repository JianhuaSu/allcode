2024-04-13 08:01:21,226 - Lists of intent labels are: ['Acknowledge', 'Advise', 'Agree', 'Apologise', 'Arrange', 'Ask for help', 'Asking for opinions', 'Care', 'Comfort', 'Complain', 'Confirm', 'Criticize', 'Doubt', 'Emphasize', 'Explain', 'Flaunt', 'Greet', 'Inform', 'Introduce', 'Invite', 'Joke', 'Leave', 'Oppose', 'Plan', 'Praise', 'Prevent', 'Refuse', 'Taunt', 'Thank', 'Warn']
2024-04-13 08:01:21,227 - ID Data preparation...
2024-04-13 08:01:43,929 - OOD Data preparation...
2024-04-13 08:02:00,798 - ============================== Params ==============================
2024-04-13 08:02:00,798 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-04-13 08:02:00,798 - dataset: MIntRec2
2024-04-13 08:02:00,798 - ood_dataset: MIntRec2-OOD
2024-04-13 08:02:00,798 - data_mode: multi-class
2024-04-13 08:02:00,798 - multimodal_method: msz
2024-04-13 08:02:00,798 - method: msz
2024-04-13 08:02:00,798 - ood_detection_method: ma
2024-04-13 08:02:00,798 - text_backbone: bert-base-uncased
2024-04-13 08:02:00,798 - seed: 0
2024-04-13 08:02:00,798 - num_workers: 8
2024-04-13 08:02:00,798 - log_id: msz_ma_MIntRec2_multi-class_0_2024-04-13-08-01-21
2024-04-13 08:02:00,798 - gpu_id: 2
2024-04-13 08:02:00,798 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-13 08:02:00,798 - train: True
2024-04-13 08:02:00,798 - tune: True
2024-04-13 08:02:00,798 - ood: True
2024-04-13 08:02:00,799 - save_model: False
2024-04-13 08:02:00,799 - save_results: True
2024-04-13 08:02:00,799 - log_path: logs
2024-04-13 08:02:00,799 - cache_path: cache
2024-04-13 08:02:00,799 - video_data_path: video_data
2024-04-13 08:02:00,799 - audio_data_path: audio_data
2024-04-13 08:02:00,799 - video_feats_path: swin_feats.pkl
2024-04-13 08:02:00,799 - ood_video_feats_path: swin_feats.pkl
2024-04-13 08:02:00,799 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-13 08:02:00,799 - audio_feats_path: wavlm_feats.pkl
2024-04-13 08:02:00,799 - results_path: results
2024-04-13 08:02:00,799 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz
2024-04-13 08:02:00,799 - model_path: models
2024-04-13 08:02:00,799 - config_file_name: msz_MIntRec2
2024-04-13 08:02:00,799 - results_file_name: results_msz_MIntRec2.csv
2024-04-13 08:02:00,799 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-13 08:02:00,799 - text_seq_len: 50
2024-04-13 08:02:00,799 - video_seq_len: 180
2024-04-13 08:02:00,799 - audio_seq_len: 400
2024-04-13 08:02:00,799 - text_feat_dim: 768
2024-04-13 08:02:00,799 - video_feat_dim: 256
2024-04-13 08:02:00,799 - audio_feat_dim: 768
2024-04-13 08:02:00,799 - ood_label_id: 30
2024-04-13 08:02:00,799 - num_labels: 30
2024-04-13 08:02:00,799 - num_train_examples: 6165
2024-04-13 08:02:00,799 - need_aligned: True
2024-04-13 08:02:00,799 - freeze_parameters: False
2024-04-13 08:02:00,799 - eval_monitor: f1
2024-04-13 08:02:00,799 - train_batch_size: 32
2024-04-13 08:02:00,799 - eval_batch_size: 16
2024-04-13 08:02:00,799 - num_train_epochs: 100
2024-04-13 08:02:00,799 - lr: [2e-05]
2024-04-13 08:02:00,799 - weight_decay: [0.1]
2024-04-13 08:02:00,799 - wait_patience: 5
2024-04-13 08:02:00,799 - warmup_proportion: [0.1]
2024-04-13 08:02:00,799 - hidden_dims: [768]
2024-04-13 08:02:00,799 - num_attention_heads: [4]
2024-04-13 08:02:00,799 - attention_probs_dropout_prob: [0.3]
2024-04-13 08:02:00,799 - hidden_dropout_prob: [0.1]
2024-04-13 08:02:00,799 - intermediate_size: [768]
2024-04-13 08:02:00,799 - num_hidden_layers: [4]
2024-04-13 08:02:00,799 - max_position_embeddings: [900]
2024-04-13 08:02:00,799 - position_embedding_type: absolute
2024-04-13 08:02:00,799 - batch_first: True
2024-04-13 08:02:00,799 - aligned_method: ['ctc']
2024-04-13 08:02:00,800 - multiple_ood: [1]
2024-04-13 08:02:00,800 - select_number_min: [2]
2024-04-13 08:02:00,800 - select_number_max: [3]
2024-04-13 08:02:00,800 - mlp_hidden_size: [256]
2024-04-13 08:02:00,800 - mlp_dropout: [0.3]
2024-04-13 08:02:00,800 - alpha: [4]
2024-04-13 08:02:00,800 - scale: [16]
2024-04-13 08:02:00,800 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_0
2024-04-13 08:02:00,800 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_0/models
2024-04-13 08:02:00,800 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/binary_msz_MIntRec2_bert-base-uncased_0
2024-04-13 08:02:00,800 - ============================== End Params ==============================
2024-04-13 08:02:05,519 - Multimodal Intent Recognition begins...
2024-04-13 08:02:05,519 - Training begins...
2024-04-13 08:05:11,041 - ***** Epoch: 1: Eval results *****
2024-04-13 08:05:11,042 -   binary_train_loss = 0.6789
2024-04-13 08:05:11,042 -   binary_eval_score = 0.9259
2024-04-13 08:05:11,042 -   train_loss = 2.2121
2024-04-13 08:05:11,042 -   eval_score = 0.5063
2024-04-13 08:05:11,042 -   best_eval_score = 0.0
2024-04-13 08:08:16,508 - ***** Epoch: 2: Eval results *****
2024-04-13 08:08:16,508 -   binary_train_loss = 0.6078
2024-04-13 08:08:16,508 -   binary_eval_score = 0.9335
2024-04-13 08:08:16,508 -   train_loss = 1.4156
2024-04-13 08:08:16,508 -   eval_score = 0.5597
2024-04-13 08:08:16,508 -   best_eval_score = 0.5063
2024-04-13 08:13:18,424 - ***** Epoch: 3: Eval results *****
2024-04-13 08:13:18,433 -   binary_train_loss = 0.2787
2024-04-13 08:13:18,433 -   binary_eval_score = 0.9742
2024-04-13 08:13:18,433 -   train_loss = 1.1333
2024-04-13 08:13:18,433 -   eval_score = 0.5615
2024-04-13 08:13:18,433 -   best_eval_score = 0.5597
2024-04-13 08:18:51,322 - ***** Epoch: 4: Eval results *****
2024-04-13 08:18:51,322 -   binary_train_loss = 0.0901
2024-04-13 08:18:51,322 -   binary_eval_score = 0.991
2024-04-13 08:18:51,322 -   train_loss = 0.8074
2024-04-13 08:18:51,322 -   eval_score = 0.585
2024-04-13 08:18:51,323 -   best_eval_score = 0.5615
2024-04-13 08:24:24,407 - ***** Epoch: 5: Eval results *****
2024-04-13 08:24:24,408 -   binary_train_loss = 0.0728
2024-04-13 08:24:24,408 -   binary_eval_score = 0.9634
2024-04-13 08:24:24,408 -   train_loss = 0.5444
2024-04-13 08:24:24,408 -   eval_score = 0.5633
2024-04-13 08:24:24,408 -   best_eval_score = 0.585
2024-04-13 08:24:24,409 - EarlyStopping counter: 1 out of 5
2024-04-13 08:29:53,184 - ***** Epoch: 6: Eval results *****
2024-04-13 08:29:53,185 -   binary_train_loss = 0.066
2024-04-13 08:29:53,185 -   binary_eval_score = 0.9887
2024-04-13 08:29:53,185 -   train_loss = 0.3084
2024-04-13 08:29:53,185 -   eval_score = 0.5705
2024-04-13 08:29:53,185 -   best_eval_score = 0.585
2024-04-13 08:29:53,185 - EarlyStopping counter: 2 out of 5
2024-04-13 08:35:25,003 - ***** Epoch: 7: Eval results *****
2024-04-13 08:35:25,003 -   binary_train_loss = 0.0456
2024-04-13 08:35:25,003 -   binary_eval_score = 0.9923
2024-04-13 08:35:25,003 -   train_loss = 0.1803
2024-04-13 08:35:25,003 -   eval_score = 0.575
2024-04-13 08:35:25,003 -   best_eval_score = 0.585
2024-04-13 08:35:25,004 - EarlyStopping counter: 3 out of 5
2024-04-13 08:40:56,929 - ***** Epoch: 8: Eval results *****
2024-04-13 08:40:56,929 -   binary_train_loss = 0.0392
2024-04-13 08:40:56,929 -   binary_eval_score = 0.9923
2024-04-13 08:40:56,929 -   train_loss = 0.1254
2024-04-13 08:40:56,929 -   eval_score = 0.5624
2024-04-13 08:40:56,929 -   best_eval_score = 0.585
2024-04-13 08:40:56,929 - EarlyStopping counter: 4 out of 5
2024-04-13 08:46:27,451 - ***** Epoch: 9: Eval results *****
2024-04-13 08:46:27,460 -   binary_train_loss = 0.0364
2024-04-13 08:46:27,460 -   binary_eval_score = 0.9914
2024-04-13 08:46:27,460 -   train_loss = 0.1063
2024-04-13 08:46:27,460 -   eval_score = 0.5606
2024-04-13 08:46:27,460 -   best_eval_score = 0.585
2024-04-13 08:46:27,460 - EarlyStopping counter: 5 out of 5
2024-04-13 08:46:27,460 - EarlyStopping at epoch 9
2024-04-13 08:46:27,465 - Training is finished...
2024-04-13 08:46:27,465 - Testing begins...
2024-04-13 08:48:10,826 - ***** Out-of-domain Evaluation results *****
2024-04-13 08:48:10,835 -   aupr_in = 0.5747
2024-04-13 08:48:10,835 -   aupr_out = 0.4507
2024-04-13 08:48:10,835 -   auroc = 0.516
2024-04-13 08:48:10,835 -   der = 0.5555
2024-04-13 08:48:10,835 -   eer = 0.4888
2024-04-13 08:48:10,835 -   fpr95 = 0.9399
2024-04-13 08:48:10,835 - Testing is finished...
2024-04-13 08:48:10,835 - Multimodal intent recognition is finished...
2024-04-13 08:48:10,835 - Results are saved in results/results_msz_MIntRec2.csv
2024-04-13 08:48:10,915 - ============================== Params ==============================
2024-04-13 08:48:10,915 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-04-13 08:48:10,915 - dataset: MIntRec2
2024-04-13 08:48:10,915 - ood_dataset: MIntRec2-OOD
2024-04-13 08:48:10,915 - data_mode: multi-class
2024-04-13 08:48:10,915 - multimodal_method: msz
2024-04-13 08:48:10,915 - method: msz
2024-04-13 08:48:10,915 - ood_detection_method: ma
2024-04-13 08:48:10,915 - text_backbone: bert-base-uncased
2024-04-13 08:48:10,915 - seed: 1
2024-04-13 08:48:10,915 - num_workers: 8
2024-04-13 08:48:10,915 - log_id: msz_ma_MIntRec2_multi-class_0_2024-04-13-08-01-21
2024-04-13 08:48:10,915 - gpu_id: 2
2024-04-13 08:48:10,915 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-13 08:48:10,915 - train: True
2024-04-13 08:48:10,915 - tune: True
2024-04-13 08:48:10,915 - ood: True
2024-04-13 08:48:10,915 - save_model: False
2024-04-13 08:48:10,915 - save_results: True
2024-04-13 08:48:10,915 - log_path: logs
2024-04-13 08:48:10,915 - cache_path: cache
2024-04-13 08:48:10,915 - video_data_path: video_data
2024-04-13 08:48:10,915 - audio_data_path: audio_data
2024-04-13 08:48:10,915 - video_feats_path: swin_feats.pkl
2024-04-13 08:48:10,915 - ood_video_feats_path: swin_feats.pkl
2024-04-13 08:48:10,915 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-13 08:48:10,915 - audio_feats_path: wavlm_feats.pkl
2024-04-13 08:48:10,915 - results_path: results
2024-04-13 08:48:10,915 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz
2024-04-13 08:48:10,915 - model_path: models
2024-04-13 08:48:10,915 - config_file_name: msz_MIntRec2
2024-04-13 08:48:10,915 - results_file_name: results_msz_MIntRec2.csv
2024-04-13 08:48:10,915 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-13 08:48:10,915 - text_seq_len: 50
2024-04-13 08:48:10,916 - video_seq_len: 180
2024-04-13 08:48:10,916 - audio_seq_len: 400
2024-04-13 08:48:10,916 - text_feat_dim: 768
2024-04-13 08:48:10,916 - video_feat_dim: 256
2024-04-13 08:48:10,916 - audio_feat_dim: 768
2024-04-13 08:48:10,916 - ood_label_id: 30
2024-04-13 08:48:10,916 - num_labels: 30
2024-04-13 08:48:10,916 - num_train_examples: 6165
2024-04-13 08:48:10,916 - need_aligned: True
2024-04-13 08:48:10,916 - freeze_parameters: False
2024-04-13 08:48:10,916 - eval_monitor: f1
2024-04-13 08:48:10,916 - train_batch_size: 32
2024-04-13 08:48:10,916 - eval_batch_size: 16
2024-04-13 08:48:10,916 - num_train_epochs: 100
2024-04-13 08:48:10,916 - lr: [2e-05]
2024-04-13 08:48:10,916 - weight_decay: [0.1]
2024-04-13 08:48:10,916 - wait_patience: 5
2024-04-13 08:48:10,916 - warmup_proportion: [0.1]
2024-04-13 08:48:10,916 - hidden_dims: [768]
2024-04-13 08:48:10,916 - num_attention_heads: [4]
2024-04-13 08:48:10,916 - attention_probs_dropout_prob: [0.3]
2024-04-13 08:48:10,916 - hidden_dropout_prob: [0.1]
2024-04-13 08:48:10,916 - intermediate_size: [768]
2024-04-13 08:48:10,916 - num_hidden_layers: [4]
2024-04-13 08:48:10,916 - max_position_embeddings: [900]
2024-04-13 08:48:10,916 - position_embedding_type: absolute
2024-04-13 08:48:10,916 - batch_first: True
2024-04-13 08:48:10,916 - aligned_method: ['ctc']
2024-04-13 08:48:10,916 - multiple_ood: [1]
2024-04-13 08:48:10,916 - select_number_min: [2]
2024-04-13 08:48:10,916 - select_number_max: [3]
2024-04-13 08:48:10,916 - mlp_hidden_size: [256]
2024-04-13 08:48:10,916 - mlp_dropout: [0.3]
2024-04-13 08:48:10,916 - alpha: [4]
2024-04-13 08:48:10,916 - scale: [16]
2024-04-13 08:48:10,916 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_1
2024-04-13 08:48:10,916 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_1/models
2024-04-13 08:48:10,916 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/binary_msz_MIntRec2_bert-base-uncased_1
2024-04-13 08:48:10,916 - device: cuda
2024-04-13 08:48:10,916 - ============================== End Params ==============================
2024-04-13 08:48:14,243 - Multimodal Intent Recognition begins...
2024-04-13 08:48:14,243 - Training begins...
