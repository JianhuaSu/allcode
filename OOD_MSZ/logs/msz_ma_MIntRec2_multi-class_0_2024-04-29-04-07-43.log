2024-04-29 04:07:43,726 - Lists of intent labels are: ['Acknowledge', 'Advise', 'Agree', 'Apologise', 'Arrange', 'Ask for help', 'Asking for opinions', 'Care', 'Comfort', 'Complain', 'Confirm', 'Criticize', 'Doubt', 'Emphasize', 'Explain', 'Flaunt', 'Greet', 'Inform', 'Introduce', 'Invite', 'Joke', 'Leave', 'Oppose', 'Plan', 'Praise', 'Prevent', 'Refuse', 'Taunt', 'Thank', 'Warn']
2024-04-29 04:07:43,727 - ID Data preparation...
2024-04-29 04:08:12,450 - OOD Data preparation...
2024-04-29 04:09:18,940 - ============================== Params ==============================
2024-04-29 04:09:18,941 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-04-29 04:09:18,941 - dataset: MIntRec2
2024-04-29 04:09:18,941 - ood_dataset: MIntRec2-OOD
2024-04-29 04:09:18,941 - data_mode: multi-class
2024-04-29 04:09:18,941 - multimodal_method: msz
2024-04-29 04:09:18,941 - method: msz
2024-04-29 04:09:18,941 - ood_detection_method: ma
2024-04-29 04:09:18,941 - text_backbone: bert-base-uncased
2024-04-29 04:09:18,941 - seed: 0
2024-04-29 04:09:18,941 - num_workers: 8
2024-04-29 04:09:18,941 - log_id: msz_ma_MIntRec2_multi-class_0_2024-04-29-04-07-43
2024-04-29 04:09:18,941 - gpu_id: 2
2024-04-29 04:09:18,941 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-29 04:09:18,941 - train: True
2024-04-29 04:09:18,941 - tune: True
2024-04-29 04:09:18,941 - ood: True
2024-04-29 04:09:18,941 - save_model: False
2024-04-29 04:09:18,941 - save_results: True
2024-04-29 04:09:18,941 - log_path: logs
2024-04-29 04:09:18,941 - cache_path: cache
2024-04-29 04:09:18,941 - video_data_path: video_data
2024-04-29 04:09:18,941 - audio_data_path: audio_data
2024-04-29 04:09:18,941 - video_feats_path: swin_feats.pkl
2024-04-29 04:09:18,941 - ood_video_feats_path: swin_feats.pkl
2024-04-29 04:09:18,941 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-29 04:09:18,941 - audio_feats_path: wavlm_feats.pkl
2024-04-29 04:09:18,941 - results_path: results
2024-04-29 04:09:18,941 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz
2024-04-29 04:09:18,941 - model_path: models
2024-04-29 04:09:18,942 - config_file_name: msz_MIntRec2
2024-04-29 04:09:18,942 - results_file_name: results_msz_MIntRec2.csv
2024-04-29 04:09:18,942 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-29 04:09:18,942 - text_seq_len: 50
2024-04-29 04:09:18,942 - video_seq_len: 180
2024-04-29 04:09:18,942 - audio_seq_len: 400
2024-04-29 04:09:18,942 - text_feat_dim: 768
2024-04-29 04:09:18,942 - video_feat_dim: 256
2024-04-29 04:09:18,942 - audio_feat_dim: 768
2024-04-29 04:09:18,942 - ood_label_id: 30
2024-04-29 04:09:18,942 - num_labels: 30
2024-04-29 04:09:18,942 - num_train_examples: 6165
2024-04-29 04:09:18,942 - need_aligned: True
2024-04-29 04:09:18,942 - freeze_parameters: False
2024-04-29 04:09:18,942 - eval_monitor: acc
2024-04-29 04:09:18,942 - train_batch_size: 32
2024-04-29 04:09:18,942 - eval_batch_size: 16
2024-04-29 04:09:18,942 - num_train_epochs: 100
2024-04-29 04:09:18,942 - lr: [1e-05]
2024-04-29 04:09:18,942 - weight_decay: [0.1]
2024-04-29 04:09:18,942 - wait_patience: 3
2024-04-29 04:09:18,942 - warmup_proportion: [0.01]
2024-04-29 04:09:18,942 - hidden_dims: [768]
2024-04-29 04:09:18,942 - num_attention_heads: [6]
2024-04-29 04:09:18,942 - attention_probs_dropout_prob: [0.3]
2024-04-29 04:09:18,942 - hidden_dropout_prob: [0.3]
2024-04-29 04:09:18,942 - intermediate_size: [768]
2024-04-29 04:09:18,942 - num_hidden_layers: [6]
2024-04-29 04:09:18,942 - max_position_embeddings: [768]
2024-04-29 04:09:18,942 - position_embedding_type: absolute
2024-04-29 04:09:18,942 - batch_first: True
2024-04-29 04:09:18,942 - aligned_method: ['ctc', 'conv1d']
2024-04-29 04:09:18,942 - sampler: beta
2024-04-29 04:09:18,942 - multiple_ood: [1]
2024-04-29 04:09:18,942 - select_number_min: [2]
2024-04-29 04:09:18,942 - select_number_max: [3]
2024-04-29 04:09:18,943 - mlp_hidden_size: [256]
2024-04-29 04:09:18,943 - mlp_dropout: [0.3]
2024-04-29 04:09:18,943 - alpha: [2]
2024-04-29 04:09:18,943 - scale: [8]
2024-04-29 04:09:18,943 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_0
2024-04-29 04:09:18,943 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_0/models
2024-04-29 04:09:18,943 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/binary_msz_MIntRec2_bert-base-uncased_0
2024-04-29 04:09:18,943 - ============================== End Params ==============================
2024-04-29 04:09:22,935 - Multimodal Intent Recognition begins...
2024-04-29 04:09:22,935 - Training begins...
2024-04-29 04:12:50,876 - ***** Epoch: 1: Eval results *****
2024-04-29 04:12:50,877 -   binary_train_loss = 0.5679
2024-04-29 04:12:50,877 -   binary_eval_score = 0.9647
2024-04-29 04:12:50,877 -   train_loss = 2.3296
2024-04-29 04:12:50,877 -   eval_score = 0.5199
2024-04-29 04:12:50,877 -   best_eval_score = 0.0
2024-04-29 04:16:23,195 - ***** Epoch: 2: Eval results *****
2024-04-29 04:16:23,195 -   binary_train_loss = 0.1892
2024-04-29 04:16:23,195 -   binary_eval_score = 0.9656
2024-04-29 04:16:23,195 -   train_loss = 1.4601
2024-04-29 04:16:23,195 -   eval_score = 0.5633
2024-04-29 04:16:23,195 -   best_eval_score = 0.5199
2024-04-29 04:19:57,344 - ***** Epoch: 3: Eval results *****
2024-04-29 04:19:57,354 -   binary_train_loss = 0.1461
2024-04-29 04:19:57,354 -   binary_eval_score = 0.953
2024-04-29 04:19:57,354 -   train_loss = 1.123
2024-04-29 04:19:57,354 -   eval_score = 0.5895
2024-04-29 04:19:57,354 -   best_eval_score = 0.5633
2024-04-29 04:23:26,634 - ***** Epoch: 4: Eval results *****
2024-04-29 04:23:26,635 -   binary_train_loss = 0.1226
2024-04-29 04:23:26,635 -   binary_eval_score = 0.981
2024-04-29 04:23:26,635 -   train_loss = 0.8737
2024-04-29 04:23:26,635 -   eval_score = 0.5913
2024-04-29 04:23:26,635 -   best_eval_score = 0.5895
2024-04-29 04:27:01,647 - ***** Epoch: 5: Eval results *****
2024-04-29 04:27:01,656 -   binary_train_loss = 0.1058
2024-04-29 04:27:01,656 -   binary_eval_score = 0.9797
2024-04-29 04:27:01,657 -   train_loss = 0.6487
2024-04-29 04:27:01,657 -   eval_score = 0.5976
2024-04-29 04:27:01,657 -   best_eval_score = 0.5913
2024-04-29 04:30:48,500 - ***** Epoch: 6: Eval results *****
2024-04-29 04:30:48,500 -   binary_train_loss = 0.097
2024-04-29 04:30:48,501 -   binary_eval_score = 0.9738
2024-04-29 04:30:48,501 -   train_loss = 0.4665
2024-04-29 04:30:48,501 -   eval_score = 0.5886
2024-04-29 04:30:48,501 -   best_eval_score = 0.5976
2024-04-29 04:30:48,502 - EarlyStopping counter: 1 out of 3
2024-04-29 04:34:37,708 - ***** Epoch: 7: Eval results *****
2024-04-29 04:34:37,708 -   binary_train_loss = 0.0998
2024-04-29 04:34:37,708 -   binary_eval_score = 0.9751
2024-04-29 04:34:37,708 -   train_loss = 0.3277
2024-04-29 04:34:37,708 -   eval_score = 0.5868
2024-04-29 04:34:37,708 -   best_eval_score = 0.5976
2024-04-29 04:34:37,708 - EarlyStopping counter: 2 out of 3
2024-04-29 04:38:07,331 - ***** Epoch: 8: Eval results *****
2024-04-29 04:38:07,340 -   binary_train_loss = 0.0788
2024-04-29 04:38:07,340 -   binary_eval_score = 0.9778
2024-04-29 04:38:07,340 -   train_loss = 0.2382
2024-04-29 04:38:07,340 -   eval_score = 0.5769
2024-04-29 04:38:07,340 -   best_eval_score = 0.5976
2024-04-29 04:38:07,340 - EarlyStopping counter: 3 out of 3
2024-04-29 04:38:07,340 - EarlyStopping at epoch 8
2024-04-29 04:38:07,348 - Training is finished...
2024-04-29 04:38:07,348 - Testing begins...
2024-04-29 04:39:01,892 - ***** Out-of-domain Evaluation results *****
2024-04-29 04:39:01,893 -   aupr_in = 0.5774
2024-04-29 04:39:01,893 -   aupr_out = 0.4493
2024-04-29 04:39:01,893 -   auroc = 0.516
2024-04-29 04:39:01,893 -   der = 0.5547
2024-04-29 04:39:01,894 -   eer = 0.4882
2024-04-29 04:39:01,894 -   fpr95 = 0.9437
2024-04-29 04:39:01,894 - Testing is finished...
2024-04-29 04:39:01,894 - Multimodal intent recognition is finished...
2024-04-29 04:39:01,895 - Results are saved in results/results_msz_MIntRec2.csv
2024-04-29 04:39:04,441 - Multimodal Intent Recognition begins...
2024-04-29 04:39:04,441 - Training begins...
2024-04-29 04:42:26,508 - ***** Epoch: 1: Eval results *****
2024-04-29 04:42:26,509 -   binary_train_loss = 0.548
2024-04-29 04:42:26,509 -   binary_eval_score = 0.9665
2024-04-29 04:42:26,509 -   train_loss = 2.3815
2024-04-29 04:42:26,509 -   eval_score = 0.5063
2024-04-29 04:42:26,509 -   best_eval_score = 0.0
2024-04-29 04:45:47,558 - ***** Epoch: 2: Eval results *****
2024-04-29 04:45:47,558 -   binary_train_loss = 0.182
2024-04-29 04:45:47,559 -   binary_eval_score = 0.9724
2024-04-29 04:45:47,559 -   train_loss = 1.4736
2024-04-29 04:45:47,559 -   eval_score = 0.5678
2024-04-29 04:45:47,559 -   best_eval_score = 0.5063
2024-04-29 04:49:07,641 - ***** Epoch: 3: Eval results *****
2024-04-29 04:49:07,641 -   binary_train_loss = 0.1329
2024-04-29 04:49:07,642 -   binary_eval_score = 0.9815
2024-04-29 04:49:07,642 -   train_loss = 1.1454
2024-04-29 04:49:07,642 -   eval_score = 0.585
2024-04-29 04:49:07,642 -   best_eval_score = 0.5678
2024-04-29 04:52:27,109 - ***** Epoch: 4: Eval results *****
2024-04-29 04:52:27,109 -   binary_train_loss = 0.1118
2024-04-29 04:52:27,109 -   binary_eval_score = 0.9738
2024-04-29 04:52:27,110 -   train_loss = 0.8964
2024-04-29 04:52:27,110 -   eval_score = 0.5958
2024-04-29 04:52:27,110 -   best_eval_score = 0.585
2024-04-29 04:55:46,304 - ***** Epoch: 5: Eval results *****
2024-04-29 04:55:46,304 -   binary_train_loss = 0.1131
2024-04-29 04:55:46,304 -   binary_eval_score = 0.976
2024-04-29 04:55:46,304 -   train_loss = 0.6783
2024-04-29 04:55:46,304 -   eval_score = 0.5823
2024-04-29 04:55:46,304 -   best_eval_score = 0.5958
2024-04-29 04:55:46,304 - EarlyStopping counter: 1 out of 3
2024-04-29 04:59:05,413 - ***** Epoch: 6: Eval results *****
2024-04-29 04:59:05,413 -   binary_train_loss = 0.1043
2024-04-29 04:59:05,413 -   binary_eval_score = 0.972
2024-04-29 04:59:05,413 -   train_loss = 0.482
2024-04-29 04:59:05,413 -   eval_score = 0.585
2024-04-29 04:59:05,413 -   best_eval_score = 0.5958
2024-04-29 04:59:05,413 - EarlyStopping counter: 2 out of 3
2024-04-29 05:02:25,790 - ***** Epoch: 7: Eval results *****
2024-04-29 05:02:25,790 -   binary_train_loss = 0.0915
2024-04-29 05:02:25,790 -   binary_eval_score = 0.9765
2024-04-29 05:02:25,790 -   train_loss = 0.3512
2024-04-29 05:02:25,790 -   eval_score = 0.5778
2024-04-29 05:02:25,790 -   best_eval_score = 0.5958
2024-04-29 05:02:25,790 - EarlyStopping counter: 3 out of 3
2024-04-29 05:02:25,790 - EarlyStopping at epoch 7
2024-04-29 05:02:25,795 - Training is finished...
2024-04-29 05:02:25,795 - Testing begins...
2024-04-29 05:03:18,634 - ***** Out-of-domain Evaluation results *****
2024-04-29 05:03:18,635 -   aupr_in = 0.5705
2024-04-29 05:03:18,635 -   aupr_out = 0.4443
2024-04-29 05:03:18,635 -   auroc = 0.5101
2024-04-29 05:03:18,635 -   der = 0.5558
2024-04-29 05:03:18,635 -   eer = 0.4914
2024-04-29 05:03:18,635 -   fpr95 = 0.9456
2024-04-29 05:03:18,636 - Testing is finished...
2024-04-29 05:03:18,636 - Multimodal intent recognition is finished...
2024-04-29 05:03:18,636 - Results are saved in results/results_msz_MIntRec2.csv
2024-04-29 05:03:18,924 - ============================== Params ==============================
2024-04-29 05:03:18,924 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-04-29 05:03:18,924 - dataset: MIntRec2
2024-04-29 05:03:18,924 - ood_dataset: MIntRec2-OOD
2024-04-29 05:03:18,924 - data_mode: multi-class
2024-04-29 05:03:18,925 - multimodal_method: msz
2024-04-29 05:03:18,925 - method: msz
2024-04-29 05:03:18,925 - ood_detection_method: ma
2024-04-29 05:03:18,925 - text_backbone: bert-base-uncased
2024-04-29 05:03:18,925 - seed: 2
2024-04-29 05:03:18,925 - num_workers: 8
2024-04-29 05:03:18,925 - log_id: msz_ma_MIntRec2_multi-class_0_2024-04-29-04-07-43
2024-04-29 05:03:18,925 - gpu_id: 2
2024-04-29 05:03:18,925 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-29 05:03:18,925 - train: True
2024-04-29 05:03:18,925 - tune: True
2024-04-29 05:03:18,925 - ood: True
2024-04-29 05:03:18,925 - save_model: False
2024-04-29 05:03:18,925 - save_results: True
2024-04-29 05:03:18,925 - log_path: logs
2024-04-29 05:03:18,925 - cache_path: cache
2024-04-29 05:03:18,925 - video_data_path: video_data
2024-04-29 05:03:18,925 - audio_data_path: audio_data
2024-04-29 05:03:18,925 - video_feats_path: swin_feats.pkl
2024-04-29 05:03:18,925 - ood_video_feats_path: swin_feats.pkl
2024-04-29 05:03:18,925 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-29 05:03:18,925 - audio_feats_path: wavlm_feats.pkl
2024-04-29 05:03:18,925 - results_path: results
2024-04-29 05:03:18,925 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz
2024-04-29 05:03:18,925 - model_path: models
2024-04-29 05:03:18,925 - config_file_name: msz_MIntRec2
2024-04-29 05:03:18,925 - results_file_name: results_msz_MIntRec2.csv
2024-04-29 05:03:18,925 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-29 05:03:18,925 - text_seq_len: 50
2024-04-29 05:03:18,925 - video_seq_len: 180
2024-04-29 05:03:18,925 - audio_seq_len: 400
2024-04-29 05:03:18,925 - text_feat_dim: 768
2024-04-29 05:03:18,925 - video_feat_dim: 256
2024-04-29 05:03:18,925 - audio_feat_dim: 768
2024-04-29 05:03:18,925 - ood_label_id: 30
2024-04-29 05:03:18,925 - num_labels: 30
2024-04-29 05:03:18,925 - num_train_examples: 6165
2024-04-29 05:03:18,925 - need_aligned: True
2024-04-29 05:03:18,925 - freeze_parameters: False
2024-04-29 05:03:18,925 - eval_monitor: acc
2024-04-29 05:03:18,925 - train_batch_size: 32
2024-04-29 05:03:18,925 - eval_batch_size: 16
2024-04-29 05:03:18,925 - num_train_epochs: 100
2024-04-29 05:03:18,925 - lr: [1e-05]
2024-04-29 05:03:18,925 - weight_decay: [0.1]
2024-04-29 05:03:18,926 - wait_patience: 3
2024-04-29 05:03:18,926 - warmup_proportion: [0.01]
2024-04-29 05:03:18,926 - hidden_dims: [768]
2024-04-29 05:03:18,926 - num_attention_heads: [6]
2024-04-29 05:03:18,926 - attention_probs_dropout_prob: [0.3]
2024-04-29 05:03:18,926 - hidden_dropout_prob: [0.3]
2024-04-29 05:03:18,926 - intermediate_size: [768]
2024-04-29 05:03:18,926 - num_hidden_layers: [6]
2024-04-29 05:03:18,926 - max_position_embeddings: [768]
2024-04-29 05:03:18,926 - position_embedding_type: absolute
2024-04-29 05:03:18,926 - batch_first: True
2024-04-29 05:03:18,926 - aligned_method: ['ctc', 'conv1d']
2024-04-29 05:03:18,926 - sampler: beta
2024-04-29 05:03:18,926 - multiple_ood: [1]
2024-04-29 05:03:18,926 - select_number_min: [2]
2024-04-29 05:03:18,926 - select_number_max: [3]
2024-04-29 05:03:18,926 - mlp_hidden_size: [256]
2024-04-29 05:03:18,926 - mlp_dropout: [0.3]
2024-04-29 05:03:18,926 - alpha: [2]
2024-04-29 05:03:18,926 - scale: [8]
2024-04-29 05:03:18,926 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_2
2024-04-29 05:03:18,926 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_2/models
2024-04-29 05:03:18,926 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/binary_msz_MIntRec2_bert-base-uncased_2
2024-04-29 05:03:18,926 - device: cuda
2024-04-29 05:03:18,926 - ============================== End Params ==============================
2024-04-29 05:03:20,657 - Multimodal Intent Recognition begins...
2024-04-29 05:03:20,658 - Training begins...
2024-04-29 05:06:44,022 - ***** Epoch: 1: Eval results *****
2024-04-29 05:06:44,022 -   binary_train_loss = 0.5512
2024-04-29 05:06:44,022 -   binary_eval_score = 0.9679
2024-04-29 05:06:44,022 -   train_loss = 2.3765
2024-04-29 05:06:44,022 -   eval_score = 0.5226
2024-04-29 05:06:44,022 -   best_eval_score = 0.0
2024-04-29 05:10:08,103 - ***** Epoch: 2: Eval results *****
2024-04-29 05:10:08,103 -   binary_train_loss = 0.2046
2024-04-29 05:10:08,103 -   binary_eval_score = 0.9602
2024-04-29 05:10:08,103 -   train_loss = 1.4586
2024-04-29 05:10:08,103 -   eval_score = 0.5669
2024-04-29 05:10:08,104 -   best_eval_score = 0.5226
2024-04-29 05:13:34,245 - ***** Epoch: 3: Eval results *****
2024-04-29 05:13:34,246 -   binary_train_loss = 0.134
2024-04-29 05:13:34,246 -   binary_eval_score = 0.9548
2024-04-29 05:13:34,246 -   train_loss = 1.1182
2024-04-29 05:13:34,246 -   eval_score = 0.5832
2024-04-29 05:13:34,246 -   best_eval_score = 0.5669
2024-04-29 05:16:59,231 - ***** Epoch: 4: Eval results *****
2024-04-29 05:16:59,231 -   binary_train_loss = 0.1185
2024-04-29 05:16:59,231 -   binary_eval_score = 0.9824
2024-04-29 05:16:59,231 -   train_loss = 0.8533
2024-04-29 05:16:59,231 -   eval_score = 0.5859
2024-04-29 05:16:59,231 -   best_eval_score = 0.5832
2024-04-29 05:20:23,551 - ***** Epoch: 5: Eval results *****
2024-04-29 05:20:23,551 -   binary_train_loss = 0.1009
2024-04-29 05:20:23,551 -   binary_eval_score = 0.9828
2024-04-29 05:20:23,551 -   train_loss = 0.6473
2024-04-29 05:20:23,551 -   eval_score = 0.5841
2024-04-29 05:20:23,551 -   best_eval_score = 0.5859
2024-04-29 05:20:23,551 - EarlyStopping counter: 1 out of 3
2024-04-29 05:23:48,210 - ***** Epoch: 6: Eval results *****
2024-04-29 05:23:48,210 -   binary_train_loss = 0.0937
2024-04-29 05:23:48,210 -   binary_eval_score = 0.9873
2024-04-29 05:23:48,210 -   train_loss = 0.4606
2024-04-29 05:23:48,210 -   eval_score = 0.585
2024-04-29 05:23:48,210 -   best_eval_score = 0.5859
2024-04-29 05:23:48,210 - EarlyStopping counter: 2 out of 3
2024-04-29 05:27:12,535 - ***** Epoch: 7: Eval results *****
2024-04-29 05:27:12,535 -   binary_train_loss = 0.0873
2024-04-29 05:27:12,535 -   binary_eval_score = 0.9765
2024-04-29 05:27:12,535 -   train_loss = 0.3364
2024-04-29 05:27:12,535 -   eval_score = 0.585
2024-04-29 05:27:12,536 -   best_eval_score = 0.5859
2024-04-29 05:27:12,536 - EarlyStopping counter: 3 out of 3
2024-04-29 05:27:12,536 - EarlyStopping at epoch 7
2024-04-29 05:27:12,542 - Training is finished...
2024-04-29 05:27:12,543 - Testing begins...
2024-04-29 05:28:07,181 - ***** Out-of-domain Evaluation results *****
2024-04-29 05:28:07,182 -   aupr_in = 0.5831
2024-04-29 05:28:07,182 -   aupr_out = 0.4511
2024-04-29 05:28:07,182 -   auroc = 0.5218
2024-04-29 05:28:07,182 -   der = 0.5566
2024-04-29 05:28:07,182 -   eer = 0.483
2024-04-29 05:28:07,182 -   fpr95 = 0.9463
2024-04-29 05:28:07,183 - Testing is finished...
2024-04-29 05:28:07,183 - Multimodal intent recognition is finished...
2024-04-29 05:28:07,183 - Results are saved in results/results_msz_MIntRec2.csv
2024-04-29 05:28:08,935 - Multimodal Intent Recognition begins...
2024-04-29 05:28:08,935 - Training begins...
2024-04-29 05:31:28,654 - ***** Epoch: 1: Eval results *****
2024-04-29 05:31:28,655 -   binary_train_loss = 0.5373
2024-04-29 05:31:28,655 -   binary_eval_score = 0.9571
2024-04-29 05:31:28,655 -   train_loss = 2.6087
2024-04-29 05:31:28,655 -   eval_score = 0.4928
2024-04-29 05:31:28,655 -   best_eval_score = 0.0
2024-04-29 05:34:48,970 - ***** Epoch: 2: Eval results *****
2024-04-29 05:34:48,971 -   binary_train_loss = 0.2071
2024-04-29 05:34:48,971 -   binary_eval_score = 0.9675
2024-04-29 05:34:48,971 -   train_loss = 1.5397
2024-04-29 05:34:48,971 -   eval_score = 0.5723
2024-04-29 05:34:48,971 -   best_eval_score = 0.4928
2024-04-29 05:38:09,589 - ***** Epoch: 3: Eval results *****
2024-04-29 05:38:09,589 -   binary_train_loss = 0.1472
2024-04-29 05:38:09,589 -   binary_eval_score = 0.9571
2024-04-29 05:38:09,589 -   train_loss = 1.1894
2024-04-29 05:38:09,590 -   eval_score = 0.5814
2024-04-29 05:38:09,590 -   best_eval_score = 0.5723
2024-04-29 05:41:29,475 - ***** Epoch: 4: Eval results *****
2024-04-29 05:41:29,475 -   binary_train_loss = 0.1247
2024-04-29 05:41:29,475 -   binary_eval_score = 0.9625
2024-04-29 05:41:29,476 -   train_loss = 0.9434
2024-04-29 05:41:29,476 -   eval_score = 0.5904
2024-04-29 05:41:29,476 -   best_eval_score = 0.5814
2024-04-29 05:44:50,002 - ***** Epoch: 5: Eval results *****
2024-04-29 05:44:50,002 -   binary_train_loss = 0.1052
2024-04-29 05:44:50,002 -   binary_eval_score = 0.9665
2024-04-29 05:44:50,002 -   train_loss = 0.7052
2024-04-29 05:44:50,002 -   eval_score = 0.5931
2024-04-29 05:44:50,002 -   best_eval_score = 0.5904
2024-04-29 05:48:09,685 - ***** Epoch: 6: Eval results *****
2024-04-29 05:48:09,685 -   binary_train_loss = 0.098
2024-04-29 05:48:09,686 -   binary_eval_score = 0.9828
2024-04-29 05:48:09,686 -   train_loss = 0.5217
2024-04-29 05:48:09,686 -   eval_score = 0.5931
2024-04-29 05:48:09,686 -   best_eval_score = 0.5931
2024-04-29 05:48:09,686 - EarlyStopping counter: 1 out of 3
2024-04-29 05:51:29,050 - ***** Epoch: 7: Eval results *****
2024-04-29 05:51:29,050 -   binary_train_loss = 0.0885
2024-04-29 05:51:29,050 -   binary_eval_score = 0.9842
2024-04-29 05:51:29,050 -   train_loss = 0.3764
2024-04-29 05:51:29,050 -   eval_score = 0.594
2024-04-29 05:51:29,050 -   best_eval_score = 0.5931
2024-04-29 05:54:49,794 - ***** Epoch: 8: Eval results *****
2024-04-29 05:54:49,794 -   binary_train_loss = 0.0891
2024-04-29 05:54:49,795 -   binary_eval_score = 0.9824
2024-04-29 05:54:49,795 -   train_loss = 0.281
2024-04-29 05:54:49,795 -   eval_score = 0.5886
2024-04-29 05:54:49,795 -   best_eval_score = 0.594
2024-04-29 05:54:49,795 - EarlyStopping counter: 1 out of 3
2024-04-29 05:58:08,936 - ***** Epoch: 9: Eval results *****
2024-04-29 05:58:08,936 -   binary_train_loss = 0.0872
2024-04-29 05:58:08,936 -   binary_eval_score = 0.981
2024-04-29 05:58:08,936 -   train_loss = 0.2011
2024-04-29 05:58:08,936 -   eval_score = 0.5949
2024-04-29 05:58:08,936 -   best_eval_score = 0.594
2024-04-29 06:01:27,655 - ***** Epoch: 10: Eval results *****
2024-04-29 06:01:27,655 -   binary_train_loss = 0.0799
2024-04-29 06:01:27,655 -   binary_eval_score = 0.9358
2024-04-29 06:01:27,655 -   train_loss = 0.1632
2024-04-29 06:01:27,655 -   eval_score = 0.5823
2024-04-29 06:01:27,655 -   best_eval_score = 0.5949
2024-04-29 06:01:27,655 - EarlyStopping counter: 1 out of 3
2024-04-29 06:04:48,006 - ***** Epoch: 11: Eval results *****
2024-04-29 06:04:48,006 -   binary_train_loss = 0.0773
2024-04-29 06:04:48,007 -   binary_eval_score = 0.9855
2024-04-29 06:04:48,007 -   train_loss = 0.1346
2024-04-29 06:04:48,007 -   eval_score = 0.5859
2024-04-29 06:04:48,007 -   best_eval_score = 0.5949
2024-04-29 06:04:48,007 - EarlyStopping counter: 2 out of 3
2024-04-29 06:08:07,551 - ***** Epoch: 12: Eval results *****
2024-04-29 06:08:07,551 -   binary_train_loss = 0.0683
2024-04-29 06:08:07,552 -   binary_eval_score = 0.9846
2024-04-29 06:08:07,552 -   train_loss = 0.121
2024-04-29 06:08:07,552 -   eval_score = 0.6013
2024-04-29 06:08:07,552 -   best_eval_score = 0.5949
2024-04-29 06:11:27,645 - ***** Epoch: 13: Eval results *****
2024-04-29 06:11:27,646 -   binary_train_loss = 0.0685
2024-04-29 06:11:27,646 -   binary_eval_score = 0.9774
2024-04-29 06:11:27,646 -   train_loss = 0.1028
2024-04-29 06:11:27,646 -   eval_score = 0.5868
2024-04-29 06:11:27,646 -   best_eval_score = 0.6013
2024-04-29 06:11:27,646 - EarlyStopping counter: 1 out of 3
2024-04-29 06:14:47,828 - ***** Epoch: 14: Eval results *****
2024-04-29 06:14:47,828 -   binary_train_loss = 0.0633
2024-04-29 06:14:47,828 -   binary_eval_score = 0.9833
2024-04-29 06:14:47,828 -   train_loss = 0.0929
2024-04-29 06:14:47,828 -   eval_score = 0.5913
2024-04-29 06:14:47,829 -   best_eval_score = 0.6013
2024-04-29 06:14:47,829 - EarlyStopping counter: 2 out of 3
2024-04-29 06:18:07,288 - ***** Epoch: 15: Eval results *****
2024-04-29 06:18:07,288 -   binary_train_loss = 0.0594
2024-04-29 06:18:07,288 -   binary_eval_score = 0.9769
2024-04-29 06:18:07,288 -   train_loss = 0.0881
2024-04-29 06:18:07,288 -   eval_score = 0.5995
2024-04-29 06:18:07,288 -   best_eval_score = 0.6013
2024-04-29 06:18:07,288 - EarlyStopping counter: 3 out of 3
2024-04-29 06:18:07,288 - EarlyStopping at epoch 15
2024-04-29 06:18:07,292 - Training is finished...
2024-04-29 06:18:07,293 - Testing begins...
2024-04-29 06:19:00,270 - ***** Out-of-domain Evaluation results *****
2024-04-29 06:19:00,270 -   aupr_in = 0.5706
2024-04-29 06:19:00,271 -   aupr_out = 0.4437
2024-04-29 06:19:00,271 -   auroc = 0.5104
2024-04-29 06:19:00,271 -   der = 0.5573
2024-04-29 06:19:00,271 -   eer = 0.4901
2024-04-29 06:19:00,271 -   fpr95 = 0.9469
2024-04-29 06:19:00,271 - Testing is finished...
2024-04-29 06:19:00,271 - Multimodal intent recognition is finished...
2024-04-29 06:19:00,272 - Results are saved in results/results_msz_MIntRec2.csv
2024-04-29 06:19:00,626 - ============================== Params ==============================
2024-04-29 06:19:00,627 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-04-29 06:19:00,627 - dataset: MIntRec2
2024-04-29 06:19:00,627 - ood_dataset: MIntRec2-OOD
2024-04-29 06:19:00,627 - data_mode: multi-class
2024-04-29 06:19:00,627 - multimodal_method: msz
2024-04-29 06:19:00,627 - method: msz
2024-04-29 06:19:00,627 - ood_detection_method: ma
2024-04-29 06:19:00,627 - text_backbone: bert-base-uncased
2024-04-29 06:19:00,627 - seed: 3
2024-04-29 06:19:00,627 - num_workers: 8
2024-04-29 06:19:00,627 - log_id: msz_ma_MIntRec2_multi-class_0_2024-04-29-04-07-43
2024-04-29 06:19:00,627 - gpu_id: 2
2024-04-29 06:19:00,627 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-29 06:19:00,627 - train: True
2024-04-29 06:19:00,627 - tune: True
2024-04-29 06:19:00,627 - ood: True
2024-04-29 06:19:00,627 - save_model: False
2024-04-29 06:19:00,627 - save_results: True
2024-04-29 06:19:00,627 - log_path: logs
2024-04-29 06:19:00,627 - cache_path: cache
2024-04-29 06:19:00,627 - video_data_path: video_data
2024-04-29 06:19:00,627 - audio_data_path: audio_data
2024-04-29 06:19:00,627 - video_feats_path: swin_feats.pkl
2024-04-29 06:19:00,627 - ood_video_feats_path: swin_feats.pkl
2024-04-29 06:19:00,627 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-29 06:19:00,627 - audio_feats_path: wavlm_feats.pkl
2024-04-29 06:19:00,627 - results_path: results
2024-04-29 06:19:00,627 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz
2024-04-29 06:19:00,627 - model_path: models
2024-04-29 06:19:00,627 - config_file_name: msz_MIntRec2
2024-04-29 06:19:00,627 - results_file_name: results_msz_MIntRec2.csv
2024-04-29 06:19:00,627 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-29 06:19:00,627 - text_seq_len: 50
2024-04-29 06:19:00,627 - video_seq_len: 180
2024-04-29 06:19:00,627 - audio_seq_len: 400
2024-04-29 06:19:00,627 - text_feat_dim: 768
2024-04-29 06:19:00,628 - video_feat_dim: 256
2024-04-29 06:19:00,628 - audio_feat_dim: 768
2024-04-29 06:19:00,628 - ood_label_id: 30
2024-04-29 06:19:00,628 - num_labels: 30
2024-04-29 06:19:00,628 - num_train_examples: 6165
2024-04-29 06:19:00,628 - need_aligned: True
2024-04-29 06:19:00,628 - freeze_parameters: False
2024-04-29 06:19:00,628 - eval_monitor: acc
2024-04-29 06:19:00,628 - train_batch_size: 32
2024-04-29 06:19:00,628 - eval_batch_size: 16
2024-04-29 06:19:00,628 - num_train_epochs: 100
2024-04-29 06:19:00,628 - lr: [1e-05]
2024-04-29 06:19:00,628 - weight_decay: [0.1]
2024-04-29 06:19:00,628 - wait_patience: 3
2024-04-29 06:19:00,628 - warmup_proportion: [0.01]
2024-04-29 06:19:00,628 - hidden_dims: [768]
2024-04-29 06:19:00,628 - num_attention_heads: [6]
2024-04-29 06:19:00,628 - attention_probs_dropout_prob: [0.3]
2024-04-29 06:19:00,628 - hidden_dropout_prob: [0.3]
2024-04-29 06:19:00,628 - intermediate_size: [768]
2024-04-29 06:19:00,628 - num_hidden_layers: [6]
2024-04-29 06:19:00,628 - max_position_embeddings: [768]
2024-04-29 06:19:00,628 - position_embedding_type: absolute
2024-04-29 06:19:00,628 - batch_first: True
2024-04-29 06:19:00,628 - aligned_method: ['ctc', 'conv1d']
2024-04-29 06:19:00,628 - sampler: beta
2024-04-29 06:19:00,628 - multiple_ood: [1]
2024-04-29 06:19:00,628 - select_number_min: [2]
2024-04-29 06:19:00,628 - select_number_max: [3]
2024-04-29 06:19:00,628 - mlp_hidden_size: [256]
2024-04-29 06:19:00,628 - mlp_dropout: [0.3]
2024-04-29 06:19:00,628 - alpha: [2]
2024-04-29 06:19:00,628 - scale: [8]
2024-04-29 06:19:00,628 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_3
2024-04-29 06:19:00,628 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_3/models
2024-04-29 06:19:00,628 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/binary_msz_MIntRec2_bert-base-uncased_3
2024-04-29 06:19:00,628 - device: cuda
2024-04-29 06:19:00,628 - ============================== End Params ==============================
2024-04-29 06:19:02,326 - Multimodal Intent Recognition begins...
2024-04-29 06:19:02,326 - Training begins...
2024-04-29 06:22:26,604 - ***** Epoch: 1: Eval results *****
2024-04-29 06:22:26,604 -   binary_train_loss = 0.553
2024-04-29 06:22:26,604 -   binary_eval_score = 0.9331
2024-04-29 06:22:26,604 -   train_loss = 2.5519
2024-04-29 06:22:26,604 -   eval_score = 0.5226
2024-04-29 06:22:26,604 -   best_eval_score = 0.0
2024-04-29 06:25:51,440 - ***** Epoch: 2: Eval results *****
2024-04-29 06:25:51,441 -   binary_train_loss = 0.1945
2024-04-29 06:25:51,441 -   binary_eval_score = 0.9702
2024-04-29 06:25:51,441 -   train_loss = 1.4963
2024-04-29 06:25:51,441 -   eval_score = 0.5696
2024-04-29 06:25:51,441 -   best_eval_score = 0.5226
2024-04-29 06:29:14,678 - ***** Epoch: 3: Eval results *****
2024-04-29 06:29:14,678 -   binary_train_loss = 0.1502
2024-04-29 06:29:14,678 -   binary_eval_score = 0.9656
2024-04-29 06:29:14,678 -   train_loss = 1.1579
2024-04-29 06:29:14,678 -   eval_score = 0.5832
2024-04-29 06:29:14,678 -   best_eval_score = 0.5696
2024-04-29 06:32:38,770 - ***** Epoch: 4: Eval results *****
2024-04-29 06:32:38,770 -   binary_train_loss = 0.1402
2024-04-29 06:32:38,770 -   binary_eval_score = 0.9702
2024-04-29 06:32:38,770 -   train_loss = 0.8843
2024-04-29 06:32:38,770 -   eval_score = 0.575
2024-04-29 06:32:38,770 -   best_eval_score = 0.5832
2024-04-29 06:32:38,770 - EarlyStopping counter: 1 out of 3
2024-04-29 06:36:02,953 - ***** Epoch: 5: Eval results *****
2024-04-29 06:36:02,953 -   binary_train_loss = 0.1153
2024-04-29 06:36:02,953 -   binary_eval_score = 0.9778
2024-04-29 06:36:02,953 -   train_loss = 0.672
2024-04-29 06:36:02,953 -   eval_score = 0.585
2024-04-29 06:36:02,953 -   best_eval_score = 0.5832
2024-04-29 06:39:27,992 - ***** Epoch: 6: Eval results *****
2024-04-29 06:39:27,992 -   binary_train_loss = 0.0892
2024-04-29 06:39:27,992 -   binary_eval_score = 0.9602
2024-04-29 06:39:27,992 -   train_loss = 0.491
2024-04-29 06:39:27,992 -   eval_score = 0.5877
2024-04-29 06:39:27,992 -   best_eval_score = 0.585
2024-04-29 06:42:51,925 - ***** Epoch: 7: Eval results *****
2024-04-29 06:42:51,925 -   binary_train_loss = 0.0823
2024-04-29 06:42:51,925 -   binary_eval_score = 0.967
2024-04-29 06:42:51,925 -   train_loss = 0.3523
2024-04-29 06:42:51,925 -   eval_score = 0.5986
2024-04-29 06:42:51,925 -   best_eval_score = 0.5877
2024-04-29 06:46:16,731 - ***** Epoch: 8: Eval results *****
2024-04-29 06:46:16,731 -   binary_train_loss = 0.0844
2024-04-29 06:46:16,732 -   binary_eval_score = 0.9778
2024-04-29 06:46:16,732 -   train_loss = 0.2614
2024-04-29 06:46:16,732 -   eval_score = 0.5814
2024-04-29 06:46:16,732 -   best_eval_score = 0.5986
2024-04-29 06:46:16,732 - EarlyStopping counter: 1 out of 3
2024-04-29 06:49:42,456 - ***** Epoch: 9: Eval results *****
2024-04-29 06:49:42,456 -   binary_train_loss = 0.0734
2024-04-29 06:49:42,456 -   binary_eval_score = 0.9684
2024-04-29 06:49:42,456 -   train_loss = 0.194
2024-04-29 06:49:42,456 -   eval_score = 0.5949
2024-04-29 06:49:42,456 -   best_eval_score = 0.5986
2024-04-29 06:49:42,456 - EarlyStopping counter: 2 out of 3
2024-04-29 06:53:09,044 - ***** Epoch: 10: Eval results *****
2024-04-29 06:53:09,044 -   binary_train_loss = 0.0752
2024-04-29 06:53:09,044 -   binary_eval_score = 0.9652
2024-04-29 06:53:09,044 -   train_loss = 0.1511
2024-04-29 06:53:09,044 -   eval_score = 0.585
2024-04-29 06:53:09,044 -   best_eval_score = 0.5986
2024-04-29 06:53:09,044 - EarlyStopping counter: 3 out of 3
2024-04-29 06:53:09,044 - EarlyStopping at epoch 10
2024-04-29 06:53:09,048 - Training is finished...
2024-04-29 06:53:09,049 - Testing begins...
2024-04-29 06:54:05,109 - ***** Out-of-domain Evaluation results *****
2024-04-29 06:54:05,110 -   aupr_in = 0.5834
2024-04-29 06:54:05,110 -   aupr_out = 0.4525
2024-04-29 06:54:05,110 -   auroc = 0.5219
2024-04-29 06:54:05,110 -   der = 0.5547
2024-04-29 06:54:05,110 -   eer = 0.4811
2024-04-29 06:54:05,110 -   fpr95 = 0.9411
2024-04-29 06:54:05,110 - Testing is finished...
2024-04-29 06:54:05,111 - Multimodal intent recognition is finished...
2024-04-29 06:54:05,111 - Results are saved in results/results_msz_MIntRec2.csv
2024-04-29 06:54:07,234 - Multimodal Intent Recognition begins...
2024-04-29 06:54:07,234 - Training begins...
2024-04-29 06:57:27,607 - ***** Epoch: 1: Eval results *****
2024-04-29 06:57:27,607 -   binary_train_loss = 0.5656
2024-04-29 06:57:27,608 -   binary_eval_score = 0.9001
2024-04-29 06:57:27,608 -   train_loss = 2.5115
2024-04-29 06:57:27,608 -   eval_score = 0.4892
2024-04-29 06:57:27,608 -   best_eval_score = 0.0
2024-04-29 07:00:47,957 - ***** Epoch: 2: Eval results *****
2024-04-29 07:00:47,957 -   binary_train_loss = 0.1972
2024-04-29 07:00:47,957 -   binary_eval_score = 0.9729
2024-04-29 07:00:47,957 -   train_loss = 1.5074
2024-04-29 07:00:47,957 -   eval_score = 0.566
2024-04-29 07:00:47,957 -   best_eval_score = 0.4892
2024-04-29 07:04:07,367 - ***** Epoch: 3: Eval results *****
2024-04-29 07:04:07,367 -   binary_train_loss = 0.1273
2024-04-29 07:04:07,367 -   binary_eval_score = 0.8549
2024-04-29 07:04:07,367 -   train_loss = 1.1627
2024-04-29 07:04:07,367 -   eval_score = 0.5759
2024-04-29 07:04:07,367 -   best_eval_score = 0.566
2024-04-29 07:07:26,347 - ***** Epoch: 4: Eval results *****
2024-04-29 07:07:26,347 -   binary_train_loss = 0.1233
2024-04-29 07:07:26,347 -   binary_eval_score = 0.9751
2024-04-29 07:07:26,347 -   train_loss = 0.8952
2024-04-29 07:07:26,347 -   eval_score = 0.5732
2024-04-29 07:07:26,347 -   best_eval_score = 0.5759
2024-04-29 07:07:26,348 - EarlyStopping counter: 1 out of 3
2024-04-29 07:10:46,099 - ***** Epoch: 5: Eval results *****
2024-04-29 07:10:46,100 -   binary_train_loss = 0.1112
2024-04-29 07:10:46,100 -   binary_eval_score = 0.976
2024-04-29 07:10:46,100 -   train_loss = 0.6756
2024-04-29 07:10:46,100 -   eval_score = 0.5805
2024-04-29 07:10:46,100 -   best_eval_score = 0.5759
2024-04-29 07:14:05,388 - ***** Epoch: 6: Eval results *****
2024-04-29 07:14:05,388 -   binary_train_loss = 0.0988
2024-04-29 07:14:05,388 -   binary_eval_score = 0.9675
2024-04-29 07:14:05,388 -   train_loss = 0.4895
2024-04-29 07:14:05,388 -   eval_score = 0.5741
2024-04-29 07:14:05,388 -   best_eval_score = 0.5805
2024-04-29 07:14:05,388 - EarlyStopping counter: 1 out of 3
2024-04-29 07:17:24,219 - ***** Epoch: 7: Eval results *****
2024-04-29 07:17:24,220 -   binary_train_loss = 0.0904
2024-04-29 07:17:24,220 -   binary_eval_score = 0.9815
2024-04-29 07:17:24,220 -   train_loss = 0.3541
2024-04-29 07:17:24,220 -   eval_score = 0.5805
2024-04-29 07:17:24,220 -   best_eval_score = 0.5805
2024-04-29 07:17:24,220 - EarlyStopping counter: 2 out of 3
2024-04-29 07:20:44,924 - ***** Epoch: 8: Eval results *****
2024-04-29 07:20:44,925 -   binary_train_loss = 0.0877
2024-04-29 07:20:44,925 -   binary_eval_score = 0.9824
2024-04-29 07:20:44,925 -   train_loss = 0.2491
2024-04-29 07:20:44,925 -   eval_score = 0.5778
2024-04-29 07:20:44,925 -   best_eval_score = 0.5805
2024-04-29 07:20:44,925 - EarlyStopping counter: 3 out of 3
2024-04-29 07:20:44,925 - EarlyStopping at epoch 8
2024-04-29 07:20:44,931 - Training is finished...
2024-04-29 07:20:44,932 - Testing begins...
2024-04-29 07:21:38,269 - ***** Out-of-domain Evaluation results *****
2024-04-29 07:21:38,269 -   aupr_in = 0.57
2024-04-29 07:21:38,269 -   aupr_out = 0.4443
2024-04-29 07:21:38,269 -   auroc = 0.5095
2024-04-29 07:21:38,269 -   der = 0.5561
2024-04-29 07:21:38,269 -   eer = 0.4894
2024-04-29 07:21:38,269 -   fpr95 = 0.9456
2024-04-29 07:21:38,269 - Testing is finished...
2024-04-29 07:21:38,270 - Multimodal intent recognition is finished...
2024-04-29 07:21:38,270 - Results are saved in results/results_msz_MIntRec2.csv
2024-04-29 07:21:38,562 - ============================== Params ==============================
2024-04-29 07:21:38,562 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-04-29 07:21:38,563 - dataset: MIntRec2
2024-04-29 07:21:38,563 - ood_dataset: MIntRec2-OOD
2024-04-29 07:21:38,563 - data_mode: multi-class
2024-04-29 07:21:38,563 - multimodal_method: msz
2024-04-29 07:21:38,563 - method: msz
2024-04-29 07:21:38,563 - ood_detection_method: ma
2024-04-29 07:21:38,563 - text_backbone: bert-base-uncased
2024-04-29 07:21:38,563 - seed: 4
2024-04-29 07:21:38,563 - num_workers: 8
2024-04-29 07:21:38,563 - log_id: msz_ma_MIntRec2_multi-class_0_2024-04-29-04-07-43
2024-04-29 07:21:38,563 - gpu_id: 2
2024-04-29 07:21:38,563 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-29 07:21:38,563 - train: True
2024-04-29 07:21:38,563 - tune: True
2024-04-29 07:21:38,563 - ood: True
2024-04-29 07:21:38,563 - save_model: False
2024-04-29 07:21:38,563 - save_results: True
2024-04-29 07:21:38,563 - log_path: logs
2024-04-29 07:21:38,563 - cache_path: cache
2024-04-29 07:21:38,563 - video_data_path: video_data
2024-04-29 07:21:38,563 - audio_data_path: audio_data
2024-04-29 07:21:38,563 - video_feats_path: swin_feats.pkl
2024-04-29 07:21:38,564 - ood_video_feats_path: swin_feats.pkl
2024-04-29 07:21:38,564 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-29 07:21:38,564 - audio_feats_path: wavlm_feats.pkl
2024-04-29 07:21:38,564 - results_path: results
2024-04-29 07:21:38,564 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz
2024-04-29 07:21:38,564 - model_path: models
2024-04-29 07:21:38,564 - config_file_name: msz_MIntRec2
2024-04-29 07:21:38,564 - results_file_name: results_msz_MIntRec2.csv
2024-04-29 07:21:38,564 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-29 07:21:38,564 - text_seq_len: 50
2024-04-29 07:21:38,564 - video_seq_len: 180
2024-04-29 07:21:38,564 - audio_seq_len: 400
2024-04-29 07:21:38,564 - text_feat_dim: 768
2024-04-29 07:21:38,564 - video_feat_dim: 256
2024-04-29 07:21:38,564 - audio_feat_dim: 768
2024-04-29 07:21:38,564 - ood_label_id: 30
2024-04-29 07:21:38,564 - num_labels: 30
2024-04-29 07:21:38,564 - num_train_examples: 6165
2024-04-29 07:21:38,564 - need_aligned: True
2024-04-29 07:21:38,564 - freeze_parameters: False
2024-04-29 07:21:38,564 - eval_monitor: acc
2024-04-29 07:21:38,564 - train_batch_size: 32
2024-04-29 07:21:38,564 - eval_batch_size: 16
2024-04-29 07:21:38,564 - num_train_epochs: 100
2024-04-29 07:21:38,564 - lr: [1e-05]
2024-04-29 07:21:38,564 - weight_decay: [0.1]
2024-04-29 07:21:38,564 - wait_patience: 3
2024-04-29 07:21:38,564 - warmup_proportion: [0.01]
2024-04-29 07:21:38,564 - hidden_dims: [768]
2024-04-29 07:21:38,564 - num_attention_heads: [6]
2024-04-29 07:21:38,564 - attention_probs_dropout_prob: [0.3]
2024-04-29 07:21:38,564 - hidden_dropout_prob: [0.3]
2024-04-29 07:21:38,564 - intermediate_size: [768]
2024-04-29 07:21:38,564 - num_hidden_layers: [6]
2024-04-29 07:21:38,564 - max_position_embeddings: [768]
2024-04-29 07:21:38,564 - position_embedding_type: absolute
2024-04-29 07:21:38,564 - batch_first: True
2024-04-29 07:21:38,565 - aligned_method: ['ctc', 'conv1d']
2024-04-29 07:21:38,565 - sampler: beta
2024-04-29 07:21:38,565 - multiple_ood: [1]
2024-04-29 07:21:38,565 - select_number_min: [2]
2024-04-29 07:21:38,565 - select_number_max: [3]
2024-04-29 07:21:38,565 - mlp_hidden_size: [256]
2024-04-29 07:21:38,565 - mlp_dropout: [0.3]
2024-04-29 07:21:38,565 - alpha: [2]
2024-04-29 07:21:38,565 - scale: [8]
2024-04-29 07:21:38,565 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_4
2024-04-29 07:21:38,565 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/msz_MIntRec2_bert-base-uncased_multi-class_4/models
2024-04-29 07:21:38,565 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/msz/binary_msz_MIntRec2_bert-base-uncased_4
2024-04-29 07:21:38,565 - device: cuda
2024-04-29 07:21:38,565 - ============================== End Params ==============================
2024-04-29 07:21:40,844 - Multimodal Intent Recognition begins...
2024-04-29 07:21:40,845 - Training begins...
2024-04-29 07:25:06,895 - ***** Epoch: 1: Eval results *****
2024-04-29 07:25:06,895 -   binary_train_loss = 0.5445
2024-04-29 07:25:06,895 -   binary_eval_score = 0.9127
2024-04-29 07:25:06,895 -   train_loss = 2.3781
2024-04-29 07:25:06,895 -   eval_score = 0.5181
2024-04-29 07:25:06,895 -   best_eval_score = 0.0
2024-04-29 07:28:31,041 - ***** Epoch: 2: Eval results *****
2024-04-29 07:28:31,041 -   binary_train_loss = 0.2219
2024-04-29 07:28:31,042 -   binary_eval_score = 0.9742
2024-04-29 07:28:31,042 -   train_loss = 1.4676
2024-04-29 07:28:31,042 -   eval_score = 0.5678
2024-04-29 07:28:31,042 -   best_eval_score = 0.5181
2024-04-29 07:31:57,126 - ***** Epoch: 3: Eval results *****
2024-04-29 07:31:57,126 -   binary_train_loss = 0.1618
2024-04-29 07:31:57,127 -   binary_eval_score = 0.9724
2024-04-29 07:31:57,127 -   train_loss = 1.1444
2024-04-29 07:31:57,127 -   eval_score = 0.5778
2024-04-29 07:31:57,127 -   best_eval_score = 0.5678
2024-04-29 07:35:21,248 - ***** Epoch: 4: Eval results *****
2024-04-29 07:35:21,249 -   binary_train_loss = 0.1304
2024-04-29 07:35:21,249 -   binary_eval_score = 0.8901
2024-04-29 07:35:21,249 -   train_loss = 0.8792
2024-04-29 07:35:21,249 -   eval_score = 0.5958
2024-04-29 07:35:21,249 -   best_eval_score = 0.5778
2024-04-29 07:38:45,905 - ***** Epoch: 5: Eval results *****
2024-04-29 07:38:45,905 -   binary_train_loss = 0.1135
2024-04-29 07:38:45,905 -   binary_eval_score = 0.9738
2024-04-29 07:38:45,905 -   train_loss = 0.6532
2024-04-29 07:38:45,905 -   eval_score = 0.594
2024-04-29 07:38:45,906 -   best_eval_score = 0.5958
2024-04-29 07:38:45,906 - EarlyStopping counter: 1 out of 3
2024-04-29 07:42:09,526 - ***** Epoch: 6: Eval results *****
2024-04-29 07:42:09,526 -   binary_train_loss = 0.1094
2024-04-29 07:42:09,526 -   binary_eval_score = 0.9693
2024-04-29 07:42:09,526 -   train_loss = 0.4764
2024-04-29 07:42:09,526 -   eval_score = 0.6004
2024-04-29 07:42:09,526 -   best_eval_score = 0.5958
2024-04-29 07:45:33,849 - ***** Epoch: 7: Eval results *****
2024-04-29 07:45:33,849 -   binary_train_loss = 0.0965
2024-04-29 07:45:33,849 -   binary_eval_score = 0.9769
2024-04-29 07:45:33,849 -   train_loss = 0.3368
2024-04-29 07:45:33,849 -   eval_score = 0.5976
2024-04-29 07:45:33,849 -   best_eval_score = 0.6004
2024-04-29 07:45:33,850 - EarlyStopping counter: 1 out of 3
2024-04-29 07:48:58,530 - ***** Epoch: 8: Eval results *****
2024-04-29 07:48:58,530 -   binary_train_loss = 0.0842
2024-04-29 07:48:58,530 -   binary_eval_score = 0.981
2024-04-29 07:48:58,530 -   train_loss = 0.256
2024-04-29 07:48:58,530 -   eval_score = 0.5895
2024-04-29 07:48:58,530 -   best_eval_score = 0.6004
2024-04-29 07:48:58,530 - EarlyStopping counter: 2 out of 3
2024-04-29 07:52:22,033 - ***** Epoch: 9: Eval results *****
2024-04-29 07:52:22,034 -   binary_train_loss = 0.079
2024-04-29 07:52:22,034 -   binary_eval_score = 0.9494
2024-04-29 07:52:22,034 -   train_loss = 0.1847
2024-04-29 07:52:22,034 -   eval_score = 0.5895
2024-04-29 07:52:22,034 -   best_eval_score = 0.6004
2024-04-29 07:52:22,034 - EarlyStopping counter: 3 out of 3
2024-04-29 07:52:22,034 - EarlyStopping at epoch 9
2024-04-29 07:52:22,039 - Training is finished...
2024-04-29 07:52:22,039 - Testing begins...
2024-04-29 07:53:16,394 - ***** Out-of-domain Evaluation results *****
2024-04-29 07:53:16,394 -   aupr_in = 0.579
2024-04-29 07:53:16,394 -   aupr_out = 0.4505
2024-04-29 07:53:16,395 -   auroc = 0.5191
2024-04-29 07:53:16,395 -   der = 0.555
2024-04-29 07:53:16,395 -   eer = 0.485
2024-04-29 07:53:16,395 -   fpr95 = 0.9443
2024-04-29 07:53:16,395 - Testing is finished...
2024-04-29 07:53:16,395 - Multimodal intent recognition is finished...
2024-04-29 07:53:16,395 - Results are saved in results/results_msz_MIntRec2.csv
2024-04-29 07:53:18,161 - Multimodal Intent Recognition begins...
2024-04-29 07:53:18,161 - Training begins...
2024-04-29 07:56:37,007 - ***** Epoch: 1: Eval results *****
2024-04-29 07:56:37,008 -   binary_train_loss = 0.5552
2024-04-29 07:56:37,008 -   binary_eval_score = 0.8617
2024-04-29 07:56:37,008 -   train_loss = 2.4112
2024-04-29 07:56:37,008 -   eval_score = 0.547
2024-04-29 07:56:37,008 -   best_eval_score = 0.0
2024-04-29 07:59:56,050 - ***** Epoch: 2: Eval results *****
2024-04-29 07:59:56,051 -   binary_train_loss = 0.2049
2024-04-29 07:59:56,051 -   binary_eval_score = 0.8436
2024-04-29 07:59:56,051 -   train_loss = 1.5107
2024-04-29 07:59:56,051 -   eval_score = 0.5759
2024-04-29 07:59:56,051 -   best_eval_score = 0.547
2024-04-29 08:03:15,093 - ***** Epoch: 3: Eval results *****
2024-04-29 08:03:15,094 -   binary_train_loss = 0.164
2024-04-29 08:03:15,094 -   binary_eval_score = 0.9715
2024-04-29 08:03:15,094 -   train_loss = 1.1492
2024-04-29 08:03:15,094 -   eval_score = 0.5904
2024-04-29 08:03:15,094 -   best_eval_score = 0.5759
