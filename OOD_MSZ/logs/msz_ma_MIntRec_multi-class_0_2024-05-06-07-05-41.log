2024-05-06 07:05:41,140 - Lists of intent labels are: ['Complain', 'Praise', 'Apologise', 'Thank', 'Criticize', 'Agree', 'Taunt', 'Flaunt', 'Joke', 'Oppose', 'Comfort', 'Care', 'Inform', 'Advise', 'Arrange', 'Introduce', 'Leave', 'Prevent', 'Greet', 'Ask for help']
2024-05-06 07:05:41,140 - ID Data preparation...
2024-05-06 07:05:47,601 - OOD Data preparation...
2024-05-06 07:05:48,959 - ============================== Params ==============================
2024-05-06 07:05:48,959 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-06 07:05:48,959 - dataset: MIntRec
2024-05-06 07:05:48,959 - ood_dataset: MIntRec-OOD
2024-05-06 07:05:48,959 - data_mode: multi-class
2024-05-06 07:05:48,959 - multimodal_method: msz
2024-05-06 07:05:48,959 - method: msz
2024-05-06 07:05:48,959 - ood_detection_method: ma
2024-05-06 07:05:48,959 - text_backbone: bert-base-uncased
2024-05-06 07:05:48,959 - seed: 0
2024-05-06 07:05:48,959 - num_workers: 8
2024-05-06 07:05:48,959 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-06-07-05-41
2024-05-06 07:05:48,959 - gpu_id: 0
2024-05-06 07:05:48,959 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-06 07:05:48,959 - train: True
2024-05-06 07:05:48,959 - tune: True
2024-05-06 07:05:48,959 - ood: True
2024-05-06 07:05:48,959 - save_model: True
2024-05-06 07:05:48,959 - save_results: True
2024-05-06 07:05:48,959 - log_path: logs
2024-05-06 07:05:48,959 - cache_path: cache
2024-05-06 07:05:48,959 - video_data_path: video_data
2024-05-06 07:05:48,959 - audio_data_path: audio_data
2024-05-06 07:05:48,959 - video_feats_path: swin_feats.pkl
2024-05-06 07:05:48,959 - ood_video_feats_path: swin_feats.pkl
2024-05-06 07:05:48,959 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-06 07:05:48,959 - audio_feats_path: wavlm_feats.pkl
2024-05-06 07:05:48,959 - results_path: results
2024-05-06 07:05:48,959 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-06 07:05:48,959 - model_path: models
2024-05-06 07:05:48,959 - config_file_name: msz_MIntRec
2024-05-06 07:05:48,959 - results_file_name: results_msz_MIntRec.csv
2024-05-06 07:05:48,959 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-06 07:05:48,959 - text_seq_len: 30
2024-05-06 07:05:48,959 - video_seq_len: 230
2024-05-06 07:05:48,960 - audio_seq_len: 480
2024-05-06 07:05:48,960 - text_feat_dim: 768
2024-05-06 07:05:48,960 - video_feat_dim: 1024
2024-05-06 07:05:48,960 - audio_feat_dim: 768
2024-05-06 07:05:48,960 - ood_label_id: 20
2024-05-06 07:05:48,960 - num_labels: 20
2024-05-06 07:05:48,960 - num_train_examples: 1334
2024-05-06 07:05:48,960 - need_aligned: True
2024-05-06 07:05:48,960 - freeze_parameters: False
2024-05-06 07:05:48,960 - eval_monitor: acc
2024-05-06 07:05:48,960 - train_batch_size: 32
2024-05-06 07:05:48,960 - eval_batch_size: 16
2024-05-06 07:05:48,960 - num_train_epochs: 100
2024-05-06 07:05:48,960 - lr: [2e-05]
2024-05-06 07:05:48,960 - weight_decay: [0.1]
2024-05-06 07:05:48,960 - wait_patience: 5
2024-05-06 07:05:48,960 - warmup_proportion: [0.01]
2024-05-06 07:05:48,960 - hidden_dims: [768]
2024-05-06 07:05:48,960 - num_attention_heads: [8]
2024-05-06 07:05:48,960 - attention_probs_dropout_prob: [0.3]
2024-05-06 07:05:48,960 - hidden_dropout_prob: [0.1]
2024-05-06 07:05:48,960 - intermediate_size: [768]
2024-05-06 07:05:48,960 - num_hidden_layers: [4]
2024-05-06 07:05:48,960 - max_position_embeddings: [900]
2024-05-06 07:05:48,960 - position_embedding_type: absolute
2024-05-06 07:05:48,960 - batch_first: True
2024-05-06 07:05:48,960 - aligned_method: ['ctc']
2024-05-06 07:05:48,960 - sampler: beta
2024-05-06 07:05:48,960 - multiple_ood: [1]
2024-05-06 07:05:48,960 - select_number_min: [2]
2024-05-06 07:05:48,960 - select_number_max: [3]
2024-05-06 07:05:48,960 - alpha: [4]
2024-05-06 07:05:48,960 - mlp_hidden_size: [256]
2024-05-06 07:05:48,960 - mlp_dropout: [0.3]
2024-05-06 07:05:48,960 - scale: [8]
2024-05-06 07:05:48,960 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_0
2024-05-06 07:05:48,960 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_0/models
2024-05-06 07:05:48,960 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_0
2024-05-06 07:05:48,960 - ============================== End Params ==============================
2024-05-06 07:05:51,769 - Multimodal Intent Recognition begins...
2024-05-06 07:05:51,769 - Training begins...
2024-05-06 07:06:25,160 - ***** Epoch: 1: Eval results *****
2024-05-06 07:06:25,161 -   binary_train_loss = 0.6824
2024-05-06 07:06:25,162 -   binary_eval_score = 0.8461
2024-05-06 07:06:25,162 -   train_loss = 1.9958
2024-05-06 07:06:25,162 -   eval_score = 0.6742
2024-05-06 07:06:25,162 -   best_eval_score = 0.0
2024-05-06 07:06:57,885 - ***** Epoch: 2: Eval results *****
2024-05-06 07:06:57,886 -   binary_train_loss = 0.6619
2024-05-06 07:06:57,886 -   binary_eval_score = 0.7101
2024-05-06 07:06:57,886 -   train_loss = 0.7601
2024-05-06 07:06:57,886 -   eval_score = 0.7213
2024-05-06 07:06:57,886 -   best_eval_score = 0.6742
2024-05-06 07:07:31,432 - ***** Epoch: 3: Eval results *****
2024-05-06 07:07:31,432 -   binary_train_loss = 0.5869
2024-05-06 07:07:31,432 -   binary_eval_score = 0.8798
2024-05-06 07:07:31,432 -   train_loss = 0.3585
2024-05-06 07:07:31,432 -   eval_score = 0.7303
2024-05-06 07:07:31,432 -   best_eval_score = 0.7213
2024-05-06 07:08:03,425 - ***** Epoch: 4: Eval results *****
2024-05-06 07:08:03,425 -   binary_train_loss = 0.3496
2024-05-06 07:08:03,425 -   binary_eval_score = 0.9169
2024-05-06 07:08:03,426 -   train_loss = 0.202
2024-05-06 07:08:03,426 -   eval_score = 0.7348
2024-05-06 07:08:03,426 -   best_eval_score = 0.7303
2024-05-06 07:08:43,769 - ***** Epoch: 5: Eval results *****
2024-05-06 07:08:43,769 -   binary_train_loss = 0.2258
2024-05-06 07:08:43,769 -   binary_eval_score = 0.9056
2024-05-06 07:08:43,769 -   train_loss = 0.1442
2024-05-06 07:08:43,769 -   eval_score = 0.7258
2024-05-06 07:08:43,769 -   best_eval_score = 0.7348
2024-05-06 07:08:43,769 - EarlyStopping counter: 1 out of 5
2024-05-06 07:09:34,250 - ***** Epoch: 6: Eval results *****
2024-05-06 07:09:34,251 -   binary_train_loss = 0.203
2024-05-06 07:09:34,251 -   binary_eval_score = 0.9562
2024-05-06 07:09:34,251 -   train_loss = 0.0786
2024-05-06 07:09:34,251 -   eval_score = 0.7371
2024-05-06 07:09:34,251 -   best_eval_score = 0.7348
2024-05-06 07:10:25,673 - ***** Epoch: 7: Eval results *****
2024-05-06 07:10:25,673 -   binary_train_loss = 0.1088
2024-05-06 07:10:25,673 -   binary_eval_score = 0.9045
2024-05-06 07:10:25,673 -   train_loss = 0.0597
2024-05-06 07:10:25,673 -   eval_score = 0.7348
2024-05-06 07:10:25,673 -   best_eval_score = 0.7371
2024-05-06 07:10:25,673 - EarlyStopping counter: 1 out of 5
2024-05-06 07:11:16,896 - ***** Epoch: 8: Eval results *****
2024-05-06 07:11:16,896 -   binary_train_loss = 0.1253
2024-05-06 07:11:16,896 -   binary_eval_score = 0.9573
2024-05-06 07:11:16,896 -   train_loss = 0.0435
2024-05-06 07:11:16,896 -   eval_score = 0.7438
2024-05-06 07:11:16,896 -   best_eval_score = 0.7371
2024-05-06 07:12:08,905 - ***** Epoch: 9: Eval results *****
2024-05-06 07:12:08,905 -   binary_train_loss = 0.1291
2024-05-06 07:12:08,905 -   binary_eval_score = 0.9865
2024-05-06 07:12:08,905 -   train_loss = 0.0416
2024-05-06 07:12:08,905 -   eval_score = 0.7348
2024-05-06 07:12:08,905 -   best_eval_score = 0.7438
2024-05-06 07:12:08,905 - EarlyStopping counter: 1 out of 5
2024-05-06 07:12:58,441 - ***** Epoch: 10: Eval results *****
2024-05-06 07:12:58,441 -   binary_train_loss = 0.1374
2024-05-06 07:12:58,441 -   binary_eval_score = 0.9854
2024-05-06 07:12:58,441 -   train_loss = 0.0394
2024-05-06 07:12:58,441 -   eval_score = 0.7191
2024-05-06 07:12:58,441 -   best_eval_score = 0.7438
2024-05-06 07:12:58,441 - EarlyStopping counter: 2 out of 5
2024-05-06 07:13:31,200 - ***** Epoch: 11: Eval results *****
2024-05-06 07:13:31,200 -   binary_train_loss = 0.0812
2024-05-06 07:13:31,200 -   binary_eval_score = 0.9764
2024-05-06 07:13:31,200 -   train_loss = 0.0353
2024-05-06 07:13:31,200 -   eval_score = 0.7438
2024-05-06 07:13:31,200 -   best_eval_score = 0.7438
2024-05-06 07:13:31,200 - EarlyStopping counter: 3 out of 5
2024-05-06 07:14:03,305 - ***** Epoch: 12: Eval results *****
2024-05-06 07:14:03,305 -   binary_train_loss = 0.0612
2024-05-06 07:14:03,306 -   binary_eval_score = 0.9876
2024-05-06 07:14:03,306 -   train_loss = 0.0264
2024-05-06 07:14:03,306 -   eval_score = 0.7326
2024-05-06 07:14:03,306 -   best_eval_score = 0.7438
2024-05-06 07:14:03,306 - EarlyStopping counter: 4 out of 5
2024-05-06 07:14:34,766 - ***** Epoch: 13: Eval results *****
2024-05-06 07:14:34,766 -   binary_train_loss = 0.0731
2024-05-06 07:14:34,766 -   binary_eval_score = 0.9618
2024-05-06 07:14:34,766 -   train_loss = 0.0245
2024-05-06 07:14:34,766 -   eval_score = 0.7303
2024-05-06 07:14:34,766 -   best_eval_score = 0.7438
2024-05-06 07:14:34,766 - EarlyStopping counter: 5 out of 5
2024-05-06 07:14:34,766 - EarlyStopping at epoch 13
2024-05-06 07:14:34,768 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_0/models
2024-05-06 07:14:40,024 - Training is finished...
2024-05-06 07:14:40,024 - Testing begins...
2024-05-06 07:14:53,348 - ***** Out-of-domain Evaluation results *****
2024-05-06 07:14:53,348 -   aupr_in = 0.7873
2024-05-06 07:14:53,348 -   aupr_out = 0.8074
2024-05-06 07:14:53,348 -   auroc = 0.8071
2024-05-06 07:14:53,348 -   der = 0.363
2024-05-06 07:14:53,348 -   eer = 0.2578
2024-05-06 07:14:53,348 -   fpr95 = 0.68
2024-05-06 07:14:53,348 - Testing is finished...
2024-05-06 07:14:53,348 - Multimodal intent recognition is finished...
2024-05-06 07:14:53,348 - Results are saved in results/results_msz_MIntRec.csv
2024-05-06 07:14:53,422 - ============================== Params ==============================
2024-05-06 07:14:53,422 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-06 07:14:53,422 - dataset: MIntRec
2024-05-06 07:14:53,422 - ood_dataset: MIntRec-OOD
2024-05-06 07:14:53,422 - data_mode: multi-class
2024-05-06 07:14:53,422 - multimodal_method: msz
2024-05-06 07:14:53,422 - method: msz
2024-05-06 07:14:53,422 - ood_detection_method: ma
2024-05-06 07:14:53,422 - text_backbone: bert-base-uncased
2024-05-06 07:14:53,422 - seed: 1
2024-05-06 07:14:53,422 - num_workers: 8
2024-05-06 07:14:53,423 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-06-07-05-41
2024-05-06 07:14:53,423 - gpu_id: 0
2024-05-06 07:14:53,423 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-06 07:14:53,423 - train: True
2024-05-06 07:14:53,423 - tune: True
2024-05-06 07:14:53,423 - ood: True
2024-05-06 07:14:53,423 - save_model: True
2024-05-06 07:14:53,423 - save_results: True
2024-05-06 07:14:53,423 - log_path: logs
2024-05-06 07:14:53,423 - cache_path: cache
2024-05-06 07:14:53,423 - video_data_path: video_data
2024-05-06 07:14:53,423 - audio_data_path: audio_data
2024-05-06 07:14:53,423 - video_feats_path: swin_feats.pkl
2024-05-06 07:14:53,423 - ood_video_feats_path: swin_feats.pkl
2024-05-06 07:14:53,423 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-06 07:14:53,423 - audio_feats_path: wavlm_feats.pkl
2024-05-06 07:14:53,423 - results_path: results
2024-05-06 07:14:53,423 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-06 07:14:53,423 - model_path: models
2024-05-06 07:14:53,423 - config_file_name: msz_MIntRec
2024-05-06 07:14:53,423 - results_file_name: results_msz_MIntRec.csv
2024-05-06 07:14:53,423 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-06 07:14:53,423 - text_seq_len: 30
2024-05-06 07:14:53,423 - video_seq_len: 230
2024-05-06 07:14:53,423 - audio_seq_len: 480
2024-05-06 07:14:53,423 - text_feat_dim: 768
2024-05-06 07:14:53,423 - video_feat_dim: 1024
2024-05-06 07:14:53,423 - audio_feat_dim: 768
2024-05-06 07:14:53,423 - ood_label_id: 20
2024-05-06 07:14:53,423 - num_labels: 20
2024-05-06 07:14:53,423 - num_train_examples: 1334
2024-05-06 07:14:53,423 - need_aligned: True
2024-05-06 07:14:53,423 - freeze_parameters: False
2024-05-06 07:14:53,423 - eval_monitor: acc
2024-05-06 07:14:53,424 - train_batch_size: 32
2024-05-06 07:14:53,424 - eval_batch_size: 16
2024-05-06 07:14:53,424 - num_train_epochs: 100
2024-05-06 07:14:53,424 - lr: [2e-05]
2024-05-06 07:14:53,424 - weight_decay: [0.1]
2024-05-06 07:14:53,424 - wait_patience: 5
2024-05-06 07:14:53,424 - warmup_proportion: [0.01]
2024-05-06 07:14:53,424 - hidden_dims: [768]
2024-05-06 07:14:53,424 - num_attention_heads: [8]
2024-05-06 07:14:53,424 - attention_probs_dropout_prob: [0.3]
2024-05-06 07:14:53,424 - hidden_dropout_prob: [0.1]
2024-05-06 07:14:53,424 - intermediate_size: [768]
2024-05-06 07:14:53,424 - num_hidden_layers: [4]
2024-05-06 07:14:53,424 - max_position_embeddings: [900]
2024-05-06 07:14:53,424 - position_embedding_type: absolute
2024-05-06 07:14:53,424 - batch_first: True
2024-05-06 07:14:53,424 - aligned_method: ['ctc']
2024-05-06 07:14:53,424 - sampler: beta
2024-05-06 07:14:53,424 - multiple_ood: [1]
2024-05-06 07:14:53,424 - select_number_min: [2]
2024-05-06 07:14:53,424 - select_number_max: [3]
2024-05-06 07:14:53,424 - alpha: [4]
2024-05-06 07:14:53,424 - mlp_hidden_size: [256]
2024-05-06 07:14:53,424 - mlp_dropout: [0.3]
2024-05-06 07:14:53,424 - scale: [8]
2024-05-06 07:14:53,424 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_1
2024-05-06 07:14:53,424 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-06 07:14:53,424 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_1
2024-05-06 07:14:53,424 - device: cuda
2024-05-06 07:14:53,424 - ============================== End Params ==============================
2024-05-06 07:14:55,123 - Multimodal Intent Recognition begins...
2024-05-06 07:14:55,123 - Training begins...
2024-05-06 07:15:27,355 - ***** Epoch: 1: Eval results *****
2024-05-06 07:15:27,355 -   binary_train_loss = 0.6845
2024-05-06 07:15:27,355 -   binary_eval_score = 0.8798
2024-05-06 07:15:27,355 -   train_loss = 2.0166
2024-05-06 07:15:27,355 -   eval_score = 0.6674
2024-05-06 07:15:27,355 -   best_eval_score = 0.0
2024-05-06 07:15:59,590 - ***** Epoch: 2: Eval results *****
2024-05-06 07:15:59,590 -   binary_train_loss = 0.6691
2024-05-06 07:15:59,590 -   binary_eval_score = 0.7742
2024-05-06 07:15:59,590 -   train_loss = 0.7747
2024-05-06 07:15:59,590 -   eval_score = 0.7101
2024-05-06 07:15:59,590 -   best_eval_score = 0.6674
2024-05-06 07:16:31,892 - ***** Epoch: 3: Eval results *****
2024-05-06 07:16:31,892 -   binary_train_loss = 0.608
2024-05-06 07:16:31,892 -   binary_eval_score = 0.8899
2024-05-06 07:16:31,892 -   train_loss = 0.3441
2024-05-06 07:16:31,892 -   eval_score = 0.7348
2024-05-06 07:16:31,892 -   best_eval_score = 0.7101
2024-05-06 07:17:04,115 - ***** Epoch: 4: Eval results *****
2024-05-06 07:17:04,116 -   binary_train_loss = 0.3658
2024-05-06 07:17:04,116 -   binary_eval_score = 0.9416
2024-05-06 07:17:04,116 -   train_loss = 0.2463
2024-05-06 07:17:04,116 -   eval_score = 0.7213
2024-05-06 07:17:04,116 -   best_eval_score = 0.7348
2024-05-06 07:17:04,116 - EarlyStopping counter: 1 out of 5
2024-05-06 07:17:35,907 - ***** Epoch: 5: Eval results *****
2024-05-06 07:17:35,908 -   binary_train_loss = 0.2322
2024-05-06 07:17:35,908 -   binary_eval_score = 0.7483
2024-05-06 07:17:35,908 -   train_loss = 0.1494
2024-05-06 07:17:35,908 -   eval_score = 0.7393
2024-05-06 07:17:35,908 -   best_eval_score = 0.7348
2024-05-06 07:18:08,469 - ***** Epoch: 6: Eval results *****
2024-05-06 07:18:08,469 -   binary_train_loss = 0.1805
2024-05-06 07:18:08,469 -   binary_eval_score = 0.8742
2024-05-06 07:18:08,469 -   train_loss = 0.0883
2024-05-06 07:18:08,470 -   eval_score = 0.7191
2024-05-06 07:18:08,470 -   best_eval_score = 0.7393
2024-05-06 07:18:08,470 - EarlyStopping counter: 1 out of 5
2024-05-06 07:18:40,681 - ***** Epoch: 7: Eval results *****
2024-05-06 07:18:40,681 -   binary_train_loss = 0.1894
2024-05-06 07:18:40,681 -   binary_eval_score = 0.9506
2024-05-06 07:18:40,681 -   train_loss = 0.0565
2024-05-06 07:18:40,681 -   eval_score = 0.7191
2024-05-06 07:18:40,681 -   best_eval_score = 0.7393
2024-05-06 07:18:40,681 - EarlyStopping counter: 2 out of 5
2024-05-06 07:19:13,653 - ***** Epoch: 8: Eval results *****
2024-05-06 07:19:13,653 -   binary_train_loss = 0.133
2024-05-06 07:19:13,653 -   binary_eval_score = 0.9708
2024-05-06 07:19:13,653 -   train_loss = 0.0406
2024-05-06 07:19:13,653 -   eval_score = 0.7146
2024-05-06 07:19:13,653 -   best_eval_score = 0.7393
2024-05-06 07:19:13,653 - EarlyStopping counter: 3 out of 5
2024-05-06 07:19:46,045 - ***** Epoch: 9: Eval results *****
2024-05-06 07:19:46,045 -   binary_train_loss = 0.1018
2024-05-06 07:19:46,045 -   binary_eval_score = 0.9753
2024-05-06 07:19:46,045 -   train_loss = 0.0359
2024-05-06 07:19:46,045 -   eval_score = 0.7258
2024-05-06 07:19:46,045 -   best_eval_score = 0.7393
2024-05-06 07:19:46,045 - EarlyStopping counter: 4 out of 5
2024-05-06 07:20:18,194 - ***** Epoch: 10: Eval results *****
2024-05-06 07:20:18,195 -   binary_train_loss = 0.1411
2024-05-06 07:20:18,195 -   binary_eval_score = 0.9888
2024-05-06 07:20:18,195 -   train_loss = 0.0437
2024-05-06 07:20:18,195 -   eval_score = 0.7169
2024-05-06 07:20:18,195 -   best_eval_score = 0.7393
2024-05-06 07:20:18,195 - EarlyStopping counter: 5 out of 5
2024-05-06 07:20:18,195 - EarlyStopping at epoch 10
2024-05-06 07:20:18,197 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-06 07:20:22,835 - Training is finished...
2024-05-06 07:20:22,835 - Testing begins...
2024-05-06 07:20:37,053 - ***** Out-of-domain Evaluation results *****
2024-05-06 07:20:37,053 -   aupr_in = 0.7776
2024-05-06 07:20:37,053 -   aupr_out = 0.7902
2024-05-06 07:20:37,053 -   auroc = 0.7951
2024-05-06 07:20:37,053 -   der = 0.3651
2024-05-06 07:20:37,053 -   eer = 0.2733
2024-05-06 07:20:37,053 -   fpr95 = 0.6889
2024-05-06 07:20:37,053 - Testing is finished...
2024-05-06 07:20:37,053 - Multimodal intent recognition is finished...
2024-05-06 07:20:37,054 - Results are saved in results/results_msz_MIntRec.csv
2024-05-06 07:20:37,174 - ============================== Params ==============================
2024-05-06 07:20:37,174 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-06 07:20:37,174 - dataset: MIntRec
2024-05-06 07:20:37,174 - ood_dataset: MIntRec-OOD
2024-05-06 07:20:37,174 - data_mode: multi-class
2024-05-06 07:20:37,174 - multimodal_method: msz
2024-05-06 07:20:37,174 - method: msz
2024-05-06 07:20:37,174 - ood_detection_method: ma
2024-05-06 07:20:37,174 - text_backbone: bert-base-uncased
2024-05-06 07:20:37,174 - seed: 2
2024-05-06 07:20:37,174 - num_workers: 8
2024-05-06 07:20:37,174 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-06-07-05-41
2024-05-06 07:20:37,174 - gpu_id: 0
2024-05-06 07:20:37,174 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-06 07:20:37,174 - train: True
2024-05-06 07:20:37,174 - tune: True
2024-05-06 07:20:37,174 - ood: True
2024-05-06 07:20:37,174 - save_model: True
2024-05-06 07:20:37,174 - save_results: True
2024-05-06 07:20:37,174 - log_path: logs
2024-05-06 07:20:37,174 - cache_path: cache
2024-05-06 07:20:37,174 - video_data_path: video_data
2024-05-06 07:20:37,174 - audio_data_path: audio_data
2024-05-06 07:20:37,174 - video_feats_path: swin_feats.pkl
2024-05-06 07:20:37,174 - ood_video_feats_path: swin_feats.pkl
2024-05-06 07:20:37,174 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-06 07:20:37,174 - audio_feats_path: wavlm_feats.pkl
2024-05-06 07:20:37,174 - results_path: results
2024-05-06 07:20:37,175 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-06 07:20:37,175 - model_path: models
2024-05-06 07:20:37,175 - config_file_name: msz_MIntRec
2024-05-06 07:20:37,175 - results_file_name: results_msz_MIntRec.csv
2024-05-06 07:20:37,175 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-06 07:20:37,175 - text_seq_len: 30
2024-05-06 07:20:37,175 - video_seq_len: 230
2024-05-06 07:20:37,175 - audio_seq_len: 480
2024-05-06 07:20:37,175 - text_feat_dim: 768
2024-05-06 07:20:37,175 - video_feat_dim: 1024
2024-05-06 07:20:37,175 - audio_feat_dim: 768
2024-05-06 07:20:37,175 - ood_label_id: 20
2024-05-06 07:20:37,175 - num_labels: 20
2024-05-06 07:20:37,175 - num_train_examples: 1334
2024-05-06 07:20:37,175 - need_aligned: True
2024-05-06 07:20:37,175 - freeze_parameters: False
2024-05-06 07:20:37,175 - eval_monitor: acc
2024-05-06 07:20:37,175 - train_batch_size: 32
2024-05-06 07:20:37,175 - eval_batch_size: 16
2024-05-06 07:20:37,175 - num_train_epochs: 100
2024-05-06 07:20:37,175 - lr: [2e-05]
2024-05-06 07:20:37,175 - weight_decay: [0.1]
2024-05-06 07:20:37,175 - wait_patience: 5
2024-05-06 07:20:37,175 - warmup_proportion: [0.01]
2024-05-06 07:20:37,175 - hidden_dims: [768]
2024-05-06 07:20:37,175 - num_attention_heads: [8]
2024-05-06 07:20:37,175 - attention_probs_dropout_prob: [0.3]
2024-05-06 07:20:37,175 - hidden_dropout_prob: [0.1]
2024-05-06 07:20:37,175 - intermediate_size: [768]
2024-05-06 07:20:37,175 - num_hidden_layers: [4]
2024-05-06 07:20:37,175 - max_position_embeddings: [900]
2024-05-06 07:20:37,175 - position_embedding_type: absolute
2024-05-06 07:20:37,175 - batch_first: True
2024-05-06 07:20:37,175 - aligned_method: ['ctc']
2024-05-06 07:20:37,175 - sampler: beta
2024-05-06 07:20:37,175 - multiple_ood: [1]
2024-05-06 07:20:37,175 - select_number_min: [2]
2024-05-06 07:20:37,175 - select_number_max: [3]
2024-05-06 07:20:37,175 - alpha: [4]
2024-05-06 07:20:37,175 - mlp_hidden_size: [256]
2024-05-06 07:20:37,176 - mlp_dropout: [0.3]
2024-05-06 07:20:37,176 - scale: [8]
2024-05-06 07:20:37,176 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_2
2024-05-06 07:20:37,176 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-06 07:20:37,176 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_2
2024-05-06 07:20:37,176 - device: cuda
2024-05-06 07:20:37,176 - ============================== End Params ==============================
2024-05-06 07:20:39,074 - Multimodal Intent Recognition begins...
2024-05-06 07:20:39,074 - Training begins...
2024-05-06 07:21:13,347 - ***** Epoch: 1: Eval results *****
2024-05-06 07:21:13,348 -   binary_train_loss = 0.6821
2024-05-06 07:21:13,348 -   binary_eval_score = 0.8124
2024-05-06 07:21:13,348 -   train_loss = 2.0602
2024-05-06 07:21:13,348 -   eval_score = 0.6629
2024-05-06 07:21:13,348 -   best_eval_score = 0.0
2024-05-06 07:21:46,251 - ***** Epoch: 2: Eval results *****
2024-05-06 07:21:46,251 -   binary_train_loss = 0.6593
2024-05-06 07:21:46,251 -   binary_eval_score = 0.673
2024-05-06 07:21:46,251 -   train_loss = 0.8351
2024-05-06 07:21:46,252 -   eval_score = 0.7079
2024-05-06 07:21:46,252 -   best_eval_score = 0.6629
2024-05-06 07:22:18,925 - ***** Epoch: 3: Eval results *****
2024-05-06 07:22:18,926 -   binary_train_loss = 0.5766
2024-05-06 07:22:18,926 -   binary_eval_score = 0.8079
2024-05-06 07:22:18,926 -   train_loss = 0.3991
2024-05-06 07:22:18,926 -   eval_score = 0.7191
2024-05-06 07:22:18,926 -   best_eval_score = 0.7079
2024-05-06 07:22:51,401 - ***** Epoch: 4: Eval results *****
2024-05-06 07:22:51,401 -   binary_train_loss = 0.3937
2024-05-06 07:22:51,401 -   binary_eval_score = 0.8472
2024-05-06 07:22:51,401 -   train_loss = 0.2489
2024-05-06 07:22:51,401 -   eval_score = 0.7236
2024-05-06 07:22:51,401 -   best_eval_score = 0.7191
2024-05-06 07:23:24,635 - ***** Epoch: 5: Eval results *****
2024-05-06 07:23:24,635 -   binary_train_loss = 0.2268
2024-05-06 07:23:24,635 -   binary_eval_score = 0.8337
2024-05-06 07:23:24,635 -   train_loss = 0.1394
2024-05-06 07:23:24,635 -   eval_score = 0.7281
2024-05-06 07:23:24,635 -   best_eval_score = 0.7236
2024-05-06 07:23:57,424 - ***** Epoch: 6: Eval results *****
2024-05-06 07:23:57,424 -   binary_train_loss = 0.1411
2024-05-06 07:23:57,424 -   binary_eval_score = 0.9416
2024-05-06 07:23:57,424 -   train_loss = 0.093
2024-05-06 07:23:57,424 -   eval_score = 0.7303
2024-05-06 07:23:57,424 -   best_eval_score = 0.7281
2024-05-06 07:24:30,512 - ***** Epoch: 7: Eval results *****
2024-05-06 07:24:30,513 -   binary_train_loss = 0.1499
2024-05-06 07:24:30,513 -   binary_eval_score = 0.9326
2024-05-06 07:24:30,513 -   train_loss = 0.0613
2024-05-06 07:24:30,513 -   eval_score = 0.7169
2024-05-06 07:24:30,513 -   best_eval_score = 0.7303
2024-05-06 07:24:30,513 - EarlyStopping counter: 1 out of 5
2024-05-06 07:25:03,874 - ***** Epoch: 8: Eval results *****
2024-05-06 07:25:03,874 -   binary_train_loss = 0.1468
2024-05-06 07:25:03,874 -   binary_eval_score = 0.8933
2024-05-06 07:25:03,874 -   train_loss = 0.0475
2024-05-06 07:25:03,874 -   eval_score = 0.7348
2024-05-06 07:25:03,874 -   best_eval_score = 0.7303
2024-05-06 07:25:37,024 - ***** Epoch: 9: Eval results *****
2024-05-06 07:25:37,024 -   binary_train_loss = 0.1496
2024-05-06 07:25:37,024 -   binary_eval_score = 0.9427
2024-05-06 07:25:37,024 -   train_loss = 0.0535
2024-05-06 07:25:37,024 -   eval_score = 0.7281
2024-05-06 07:25:37,024 -   best_eval_score = 0.7348
2024-05-06 07:25:37,024 - EarlyStopping counter: 1 out of 5
2024-05-06 07:26:10,638 - ***** Epoch: 10: Eval results *****
2024-05-06 07:26:10,638 -   binary_train_loss = 0.0951
2024-05-06 07:26:10,638 -   binary_eval_score = 0.9596
2024-05-06 07:26:10,638 -   train_loss = 0.0311
2024-05-06 07:26:10,638 -   eval_score = 0.7393
2024-05-06 07:26:10,638 -   best_eval_score = 0.7348
2024-05-06 07:26:43,969 - ***** Epoch: 11: Eval results *****
2024-05-06 07:26:43,970 -   binary_train_loss = 0.1005
2024-05-06 07:26:43,970 -   binary_eval_score = 0.9213
2024-05-06 07:26:43,970 -   train_loss = 0.0326
2024-05-06 07:26:43,970 -   eval_score = 0.7303
2024-05-06 07:26:43,970 -   best_eval_score = 0.7393
2024-05-06 07:26:43,970 - EarlyStopping counter: 1 out of 5
2024-05-06 07:27:17,016 - ***** Epoch: 12: Eval results *****
2024-05-06 07:27:17,017 -   binary_train_loss = 0.1094
2024-05-06 07:27:17,017 -   binary_eval_score = 0.9461
2024-05-06 07:27:17,017 -   train_loss = 0.0305
2024-05-06 07:27:17,017 -   eval_score = 0.7281
2024-05-06 07:27:17,017 -   best_eval_score = 0.7393
2024-05-06 07:27:17,017 - EarlyStopping counter: 2 out of 5
2024-05-06 07:27:49,641 - ***** Epoch: 13: Eval results *****
2024-05-06 07:27:49,641 -   binary_train_loss = 0.1122
2024-05-06 07:27:49,641 -   binary_eval_score = 0.9685
2024-05-06 07:27:49,641 -   train_loss = 0.0294
2024-05-06 07:27:49,641 -   eval_score = 0.7236
2024-05-06 07:27:49,641 -   best_eval_score = 0.7393
2024-05-06 07:27:49,641 - EarlyStopping counter: 3 out of 5
2024-05-06 07:28:22,735 - ***** Epoch: 14: Eval results *****
2024-05-06 07:28:22,735 -   binary_train_loss = 0.0921
2024-05-06 07:28:22,735 -   binary_eval_score = 0.9719
2024-05-06 07:28:22,735 -   train_loss = 0.0273
2024-05-06 07:28:22,735 -   eval_score = 0.7303
2024-05-06 07:28:22,735 -   best_eval_score = 0.7393
2024-05-06 07:28:22,736 - EarlyStopping counter: 4 out of 5
2024-05-06 07:28:56,179 - ***** Epoch: 15: Eval results *****
2024-05-06 07:28:56,180 -   binary_train_loss = 0.0996
2024-05-06 07:28:56,180 -   binary_eval_score = 0.9112
2024-05-06 07:28:56,180 -   train_loss = 0.021
2024-05-06 07:28:56,180 -   eval_score = 0.7258
2024-05-06 07:28:56,180 -   best_eval_score = 0.7393
2024-05-06 07:28:56,181 - EarlyStopping counter: 5 out of 5
2024-05-06 07:28:56,181 - EarlyStopping at epoch 15
2024-05-06 07:28:56,185 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-06 07:29:01,081 - Training is finished...
2024-05-06 07:29:01,082 - Testing begins...
2024-05-06 07:29:17,927 - ***** Out-of-domain Evaluation results *****
2024-05-06 07:29:17,927 -   aupr_in = 0.7888
2024-05-06 07:29:17,928 -   aupr_out = 0.7953
2024-05-06 07:29:17,928 -   auroc = 0.8002
2024-05-06 07:29:17,928 -   der = 0.3519
2024-05-06 07:29:17,928 -   eer = 0.2867
2024-05-06 07:29:17,928 -   fpr95 = 0.6578
2024-05-06 07:29:17,928 - Testing is finished...
2024-05-06 07:29:17,928 - Multimodal intent recognition is finished...
2024-05-06 07:29:17,929 - Results are saved in results/results_msz_MIntRec.csv
2024-05-06 07:29:18,028 - ============================== Params ==============================
2024-05-06 07:29:18,028 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-06 07:29:18,028 - dataset: MIntRec
2024-05-06 07:29:18,028 - ood_dataset: MIntRec-OOD
2024-05-06 07:29:18,028 - data_mode: multi-class
2024-05-06 07:29:18,029 - multimodal_method: msz
2024-05-06 07:29:18,029 - method: msz
2024-05-06 07:29:18,029 - ood_detection_method: ma
2024-05-06 07:29:18,029 - text_backbone: bert-base-uncased
2024-05-06 07:29:18,029 - seed: 3
2024-05-06 07:29:18,029 - num_workers: 8
2024-05-06 07:29:18,029 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-06-07-05-41
2024-05-06 07:29:18,029 - gpu_id: 0
2024-05-06 07:29:18,029 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-06 07:29:18,029 - train: True
2024-05-06 07:29:18,029 - tune: True
2024-05-06 07:29:18,029 - ood: True
2024-05-06 07:29:18,030 - save_model: True
2024-05-06 07:29:18,030 - save_results: True
2024-05-06 07:29:18,030 - log_path: logs
2024-05-06 07:29:18,030 - cache_path: cache
2024-05-06 07:29:18,030 - video_data_path: video_data
2024-05-06 07:29:18,030 - audio_data_path: audio_data
2024-05-06 07:29:18,030 - video_feats_path: swin_feats.pkl
2024-05-06 07:29:18,030 - ood_video_feats_path: swin_feats.pkl
2024-05-06 07:29:18,030 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-06 07:29:18,030 - audio_feats_path: wavlm_feats.pkl
2024-05-06 07:29:18,030 - results_path: results
2024-05-06 07:29:18,030 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-06 07:29:18,030 - model_path: models
2024-05-06 07:29:18,031 - config_file_name: msz_MIntRec
2024-05-06 07:29:18,031 - results_file_name: results_msz_MIntRec.csv
2024-05-06 07:29:18,031 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-06 07:29:18,031 - text_seq_len: 30
2024-05-06 07:29:18,031 - video_seq_len: 230
2024-05-06 07:29:18,031 - audio_seq_len: 480
2024-05-06 07:29:18,031 - text_feat_dim: 768
2024-05-06 07:29:18,031 - video_feat_dim: 1024
2024-05-06 07:29:18,031 - audio_feat_dim: 768
2024-05-06 07:29:18,031 - ood_label_id: 20
2024-05-06 07:29:18,031 - num_labels: 20
2024-05-06 07:29:18,031 - num_train_examples: 1334
2024-05-06 07:29:18,032 - need_aligned: True
2024-05-06 07:29:18,032 - freeze_parameters: False
2024-05-06 07:29:18,032 - eval_monitor: acc
2024-05-06 07:29:18,032 - train_batch_size: 32
2024-05-06 07:29:18,032 - eval_batch_size: 16
2024-05-06 07:29:18,032 - num_train_epochs: 100
2024-05-06 07:29:18,032 - lr: [2e-05]
2024-05-06 07:29:18,032 - weight_decay: [0.1]
2024-05-06 07:29:18,032 - wait_patience: 5
2024-05-06 07:29:18,032 - warmup_proportion: [0.01]
2024-05-06 07:29:18,032 - hidden_dims: [768]
2024-05-06 07:29:18,032 - num_attention_heads: [8]
2024-05-06 07:29:18,032 - attention_probs_dropout_prob: [0.3]
2024-05-06 07:29:18,033 - hidden_dropout_prob: [0.1]
2024-05-06 07:29:18,033 - intermediate_size: [768]
2024-05-06 07:29:18,033 - num_hidden_layers: [4]
2024-05-06 07:29:18,033 - max_position_embeddings: [900]
2024-05-06 07:29:18,033 - position_embedding_type: absolute
2024-05-06 07:29:18,033 - batch_first: True
2024-05-06 07:29:18,033 - aligned_method: ['ctc']
2024-05-06 07:29:18,033 - sampler: beta
2024-05-06 07:29:18,033 - multiple_ood: [1]
2024-05-06 07:29:18,033 - select_number_min: [2]
2024-05-06 07:29:18,033 - select_number_max: [3]
2024-05-06 07:29:18,033 - alpha: [4]
2024-05-06 07:29:18,034 - mlp_hidden_size: [256]
2024-05-06 07:29:18,034 - mlp_dropout: [0.3]
2024-05-06 07:29:18,034 - scale: [8]
2024-05-06 07:29:18,034 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_3
2024-05-06 07:29:18,034 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-06 07:29:18,034 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_3
2024-05-06 07:29:18,034 - device: cuda
2024-05-06 07:29:18,034 - ============================== End Params ==============================
2024-05-06 07:29:19,562 - Multimodal Intent Recognition begins...
2024-05-06 07:29:19,562 - Training begins...
2024-05-06 07:29:52,551 - ***** Epoch: 1: Eval results *****
2024-05-06 07:29:52,552 -   binary_train_loss = 0.6835
2024-05-06 07:29:52,552 -   binary_eval_score = 0.9011
2024-05-06 07:29:52,552 -   train_loss = 2.0248
2024-05-06 07:29:52,552 -   eval_score = 0.6404
2024-05-06 07:29:52,552 -   best_eval_score = 0.0
2024-05-06 07:30:26,070 - ***** Epoch: 2: Eval results *****
2024-05-06 07:30:26,070 -   binary_train_loss = 0.671
2024-05-06 07:30:26,070 -   binary_eval_score = 0.7382
2024-05-06 07:30:26,070 -   train_loss = 0.8044
2024-05-06 07:30:26,071 -   eval_score = 0.7146
2024-05-06 07:30:26,071 -   best_eval_score = 0.6404
2024-05-06 07:30:59,960 - ***** Epoch: 3: Eval results *****
2024-05-06 07:30:59,960 -   binary_train_loss = 0.6186
2024-05-06 07:30:59,960 -   binary_eval_score = 0.8876
2024-05-06 07:30:59,960 -   train_loss = 0.3946
2024-05-06 07:30:59,960 -   eval_score = 0.7079
2024-05-06 07:30:59,960 -   best_eval_score = 0.7146
2024-05-06 07:30:59,960 - EarlyStopping counter: 1 out of 5
2024-05-06 07:31:34,460 - ***** Epoch: 4: Eval results *****
2024-05-06 07:31:34,460 -   binary_train_loss = 0.4319
2024-05-06 07:31:34,460 -   binary_eval_score = 0.9146
2024-05-06 07:31:34,460 -   train_loss = 0.2206
2024-05-06 07:31:34,460 -   eval_score = 0.7236
2024-05-06 07:31:34,460 -   best_eval_score = 0.7146
2024-05-06 07:32:07,659 - ***** Epoch: 5: Eval results *****
2024-05-06 07:32:07,660 -   binary_train_loss = 0.2395
2024-05-06 07:32:07,660 -   binary_eval_score = 0.9135
2024-05-06 07:32:07,660 -   train_loss = 0.1586
2024-05-06 07:32:07,660 -   eval_score = 0.7236
2024-05-06 07:32:07,660 -   best_eval_score = 0.7236
2024-05-06 07:32:07,660 - EarlyStopping counter: 1 out of 5
2024-05-06 07:32:41,456 - ***** Epoch: 6: Eval results *****
2024-05-06 07:32:41,456 -   binary_train_loss = 0.1784
2024-05-06 07:32:41,456 -   binary_eval_score = 0.9034
2024-05-06 07:32:41,457 -   train_loss = 0.0786
2024-05-06 07:32:41,457 -   eval_score = 0.7393
2024-05-06 07:32:41,457 -   best_eval_score = 0.7236
2024-05-06 07:33:16,464 - ***** Epoch: 7: Eval results *****
2024-05-06 07:33:16,464 -   binary_train_loss = 0.1304
2024-05-06 07:33:16,465 -   binary_eval_score = 0.9494
2024-05-06 07:33:16,465 -   train_loss = 0.0584
2024-05-06 07:33:16,465 -   eval_score = 0.7303
2024-05-06 07:33:16,465 -   best_eval_score = 0.7393
2024-05-06 07:33:16,465 - EarlyStopping counter: 1 out of 5
2024-05-06 07:33:49,563 - ***** Epoch: 8: Eval results *****
2024-05-06 07:33:49,563 -   binary_train_loss = 0.1435
2024-05-06 07:33:49,563 -   binary_eval_score = 0.9337
2024-05-06 07:33:49,563 -   train_loss = 0.0525
2024-05-06 07:33:49,563 -   eval_score = 0.7326
2024-05-06 07:33:49,563 -   best_eval_score = 0.7393
2024-05-06 07:33:49,563 - EarlyStopping counter: 2 out of 5
2024-05-06 07:34:23,073 - ***** Epoch: 9: Eval results *****
2024-05-06 07:34:23,073 -   binary_train_loss = 0.1241
2024-05-06 07:34:23,073 -   binary_eval_score = 0.927
2024-05-06 07:34:23,073 -   train_loss = 0.0364
2024-05-06 07:34:23,073 -   eval_score = 0.7393
2024-05-06 07:34:23,073 -   best_eval_score = 0.7393
2024-05-06 07:34:23,073 - EarlyStopping counter: 3 out of 5
2024-05-06 07:34:57,640 - ***** Epoch: 10: Eval results *****
2024-05-06 07:34:57,641 -   binary_train_loss = 0.0849
2024-05-06 07:34:57,641 -   binary_eval_score = 0.9427
2024-05-06 07:34:57,641 -   train_loss = 0.038
2024-05-06 07:34:57,641 -   eval_score = 0.7348
2024-05-06 07:34:57,641 -   best_eval_score = 0.7393
2024-05-06 07:34:57,641 - EarlyStopping counter: 4 out of 5
2024-05-06 07:35:31,480 - ***** Epoch: 11: Eval results *****
2024-05-06 07:35:31,480 -   binary_train_loss = 0.0891
2024-05-06 07:35:31,480 -   binary_eval_score = 0.9551
2024-05-06 07:35:31,481 -   train_loss = 0.0318
2024-05-06 07:35:31,481 -   eval_score = 0.7281
2024-05-06 07:35:31,481 -   best_eval_score = 0.7393
2024-05-06 07:35:31,481 - EarlyStopping counter: 5 out of 5
2024-05-06 07:35:31,481 - EarlyStopping at epoch 11
2024-05-06 07:35:31,485 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-06 07:35:36,788 - Training is finished...
2024-05-06 07:35:36,789 - Testing begins...
2024-05-06 07:35:52,641 - ***** Out-of-domain Evaluation results *****
2024-05-06 07:35:52,641 -   aupr_in = 0.7845
2024-05-06 07:35:52,641 -   aupr_out = 0.8018
2024-05-06 07:35:52,642 -   auroc = 0.8003
2024-05-06 07:35:52,642 -   der = 0.3563
2024-05-06 07:35:52,642 -   eer = 0.2644
2024-05-06 07:35:52,642 -   fpr95 = 0.6667
2024-05-06 07:35:52,642 - Testing is finished...
2024-05-06 07:35:52,643 - Multimodal intent recognition is finished...
2024-05-06 07:35:52,643 - Results are saved in results/results_msz_MIntRec.csv
2024-05-06 07:35:52,752 - ============================== Params ==============================
2024-05-06 07:35:52,752 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-06 07:35:52,752 - dataset: MIntRec
2024-05-06 07:35:52,752 - ood_dataset: MIntRec-OOD
2024-05-06 07:35:52,752 - data_mode: multi-class
2024-05-06 07:35:52,752 - multimodal_method: msz
2024-05-06 07:35:52,752 - method: msz
2024-05-06 07:35:52,752 - ood_detection_method: ma
2024-05-06 07:35:52,753 - text_backbone: bert-base-uncased
2024-05-06 07:35:52,753 - seed: 4
2024-05-06 07:35:52,753 - num_workers: 8
2024-05-06 07:35:52,753 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-06-07-05-41
2024-05-06 07:35:52,753 - gpu_id: 0
2024-05-06 07:35:52,753 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-06 07:35:52,753 - train: True
2024-05-06 07:35:52,753 - tune: True
2024-05-06 07:35:52,753 - ood: True
2024-05-06 07:35:52,753 - save_model: True
2024-05-06 07:35:52,753 - save_results: True
2024-05-06 07:35:52,753 - log_path: logs
2024-05-06 07:35:52,753 - cache_path: cache
2024-05-06 07:35:52,753 - video_data_path: video_data
2024-05-06 07:35:52,753 - audio_data_path: audio_data
2024-05-06 07:35:52,753 - video_feats_path: swin_feats.pkl
2024-05-06 07:35:52,753 - ood_video_feats_path: swin_feats.pkl
2024-05-06 07:35:52,753 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-06 07:35:52,753 - audio_feats_path: wavlm_feats.pkl
2024-05-06 07:35:52,753 - results_path: results
2024-05-06 07:35:52,753 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-06 07:35:52,753 - model_path: models
2024-05-06 07:35:52,753 - config_file_name: msz_MIntRec
2024-05-06 07:35:52,753 - results_file_name: results_msz_MIntRec.csv
2024-05-06 07:35:52,753 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-06 07:35:52,753 - text_seq_len: 30
2024-05-06 07:35:52,753 - video_seq_len: 230
2024-05-06 07:35:52,753 - audio_seq_len: 480
2024-05-06 07:35:52,753 - text_feat_dim: 768
2024-05-06 07:35:52,753 - video_feat_dim: 1024
2024-05-06 07:35:52,753 - audio_feat_dim: 768
2024-05-06 07:35:52,753 - ood_label_id: 20
2024-05-06 07:35:52,753 - num_labels: 20
2024-05-06 07:35:52,753 - num_train_examples: 1334
2024-05-06 07:35:52,753 - need_aligned: True
2024-05-06 07:35:52,753 - freeze_parameters: False
2024-05-06 07:35:52,753 - eval_monitor: acc
2024-05-06 07:35:52,753 - train_batch_size: 32
2024-05-06 07:35:52,753 - eval_batch_size: 16
2024-05-06 07:35:52,753 - num_train_epochs: 100
2024-05-06 07:35:52,754 - lr: [2e-05]
2024-05-06 07:35:52,754 - weight_decay: [0.1]
2024-05-06 07:35:52,754 - wait_patience: 5
2024-05-06 07:35:52,754 - warmup_proportion: [0.01]
2024-05-06 07:35:52,754 - hidden_dims: [768]
2024-05-06 07:35:52,754 - num_attention_heads: [8]
2024-05-06 07:35:52,754 - attention_probs_dropout_prob: [0.3]
2024-05-06 07:35:52,754 - hidden_dropout_prob: [0.1]
2024-05-06 07:35:52,754 - intermediate_size: [768]
2024-05-06 07:35:52,754 - num_hidden_layers: [4]
2024-05-06 07:35:52,754 - max_position_embeddings: [900]
2024-05-06 07:35:52,754 - position_embedding_type: absolute
2024-05-06 07:35:52,754 - batch_first: True
2024-05-06 07:35:52,754 - aligned_method: ['ctc']
2024-05-06 07:35:52,754 - sampler: beta
2024-05-06 07:35:52,754 - multiple_ood: [1]
2024-05-06 07:35:52,754 - select_number_min: [2]
2024-05-06 07:35:52,754 - select_number_max: [3]
2024-05-06 07:35:52,754 - alpha: [4]
2024-05-06 07:35:52,754 - mlp_hidden_size: [256]
2024-05-06 07:35:52,754 - mlp_dropout: [0.3]
2024-05-06 07:35:52,754 - scale: [8]
2024-05-06 07:35:52,754 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_4
2024-05-06 07:35:52,754 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_4/models
2024-05-06 07:35:52,754 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_4
2024-05-06 07:35:52,754 - device: cuda
2024-05-06 07:35:52,754 - ============================== End Params ==============================
2024-05-06 07:35:54,588 - Multimodal Intent Recognition begins...
2024-05-06 07:35:54,588 - Training begins...
