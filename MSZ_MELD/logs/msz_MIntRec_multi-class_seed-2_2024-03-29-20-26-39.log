2024-03-29 20:26:40,300 - ============================== Params ==============================
2024-03-29 20:26:40,301 - logger_name: msz_MIntRec_multi-class_seed-2_2024-03-29-20-26-39
2024-03-29 20:26:40,301 - dataset: MIntRec
2024-03-29 20:26:40,301 - data_mode: multi-class
2024-03-29 20:26:40,301 - method: msz
2024-03-29 20:26:40,301 - text_backbone: bert-base-uncased
2024-03-29 20:26:40,301 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-29 20:26:40,301 - seed: 2
2024-03-29 20:26:40,301 - num_workers: 8
2024-03-29 20:26:40,301 - gpu_id: 3
2024-03-29 20:26:40,301 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-29 20:26:40,301 - train: True
2024-03-29 20:26:40,301 - tune: True
2024-03-29 20:26:40,301 - save_model: False
2024-03-29 20:26:40,301 - save_results: True
2024-03-29 20:26:40,301 - log_path: logs
2024-03-29 20:26:40,301 - cache_path: 
2024-03-29 20:26:40,301 - video_data_path: video_data
2024-03-29 20:26:40,301 - audio_data_path: audio_data
2024-03-29 20:26:40,301 - video_feats_path: video_feats.pkl
2024-03-29 20:26:40,301 - audio_feats_path: audio_feats.pkl
2024-03-29 20:26:40,301 - results_path: results
2024-03-29 20:26:40,301 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-03-29 20:26:40,301 - model_path: models
2024-03-29 20:26:40,301 - config_file_name: msz_MIntRec
2024-03-29 20:26:40,301 - results_file_name: msz.csv
2024-03-29 20:26:40,302 - padding_mode: zero
2024-03-29 20:26:40,302 - padding_loc: end
2024-03-29 20:26:40,302 - need_aligned: False
2024-03-29 20:26:40,302 - eval_monitor: f1
2024-03-29 20:26:40,302 - train_batch_size: 16
2024-03-29 20:26:40,302 - eval_batch_size: 8
2024-03-29 20:26:40,302 - test_batch_size: 8
2024-03-29 20:26:40,302 - wait_patience: 8
2024-03-29 20:26:40,302 - hidden_dims: 768
2024-03-29 20:26:40,302 - num_attention_heads: 8
2024-03-29 20:26:40,302 - attention_probs_dropout_prob: 0.2
2024-03-29 20:26:40,302 - hidden_dropout_prob: 0.4
2024-03-29 20:26:40,302 - intermediate_size: 768
2024-03-29 20:26:40,302 - num_hidden_layers: 8
2024-03-29 20:26:40,302 - max_position_embeddings: 768
2024-03-29 20:26:40,302 - position_embedding_type: absolute
2024-03-29 20:26:40,302 - batch_first: True
2024-03-29 20:26:40,302 - dropout: 0.1
2024-03-29 20:26:40,302 - aligned_method: conv1d
2024-03-29 20:26:40,302 - num_train_epochs: 100
2024-03-29 20:26:40,302 - lr: 5e-06
2024-03-29 20:26:40,302 - lr_mode: max
2024-03-29 20:26:40,302 - patience: 5
2024-03-29 20:26:40,302 - factor: 0.6
2024-03-29 20:26:40,302 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-03-29-20-26-39
2024-03-29 20:26:40,302 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-03-29-20-26-39/models
2024-03-29 20:26:40,302 - num_labels: 20
2024-03-29 20:26:40,302 - text_feat_dim: 768
2024-03-29 20:26:40,302 - video_feat_dim: 256
2024-03-29 20:26:40,302 - audio_feat_dim: 768
2024-03-29 20:26:40,303 - text_seq_len: 30
2024-03-29 20:26:40,303 - video_seq_len: 230
2024-03-29 20:26:40,303 - audio_seq_len: 480
2024-03-29 20:26:40,303 - device: cuda:3
2024-03-29 20:26:40,303 - ============================== End Params ==============================
2024-03-29 20:26:40,531 - Generate Text Features Begin...
2024-03-29 20:26:41,199 - Generate Text Features Finished...
2024-03-29 20:26:41,219 - Load Video Features Begin...
2024-03-29 20:27:18,793 - Load Video Features Finished...
2024-03-29 20:27:23,261 - Load Audio Features Begin...
2024-03-29 20:29:16,288 - Load Audio Features Finished...
2024-03-29 20:30:30,422 - method  begins...
2024-03-29 20:30:40,210 - Multimodal intent recognition begins...
2024-03-29 20:30:40,210 - Training begins...
2024-03-29 20:31:01,823 - ***** Epoch: 1: Eval results *****
2024-03-29 20:31:01,824 -   train_loss = 2.7062
2024-03-29 20:31:01,824 -   best_eval_score = 0.0
2024-03-29 20:31:01,824 -   eval_score = 0.1519
2024-03-29 20:31:22,310 - ***** Epoch: 2: Eval results *****
2024-03-29 20:31:22,311 -   train_loss = 1.9524
2024-03-29 20:31:22,311 -   best_eval_score = 0.1519
2024-03-29 20:31:22,311 -   eval_score = 0.4469
2024-03-29 20:31:44,271 - ***** Epoch: 3: Eval results *****
2024-03-29 20:31:44,272 -   train_loss = 1.2703
2024-03-29 20:31:44,272 -   best_eval_score = 0.4469
2024-03-29 20:31:44,272 -   eval_score = 0.5539
2024-03-29 20:32:05,503 - ***** Epoch: 4: Eval results *****
2024-03-29 20:32:05,504 -   train_loss = 0.804
2024-03-29 20:32:05,504 -   best_eval_score = 0.5539
2024-03-29 20:32:05,504 -   eval_score = 0.603
2024-03-29 20:32:27,120 - ***** Epoch: 5: Eval results *****
2024-03-29 20:32:27,121 -   train_loss = 0.5153
2024-03-29 20:32:27,121 -   best_eval_score = 0.603
2024-03-29 20:32:27,121 -   eval_score = 0.652
2024-03-29 20:32:48,671 - ***** Epoch: 6: Eval results *****
2024-03-29 20:32:48,671 -   train_loss = 0.3113
2024-03-29 20:32:48,672 -   best_eval_score = 0.652
2024-03-29 20:32:48,672 -   eval_score = 0.6875
2024-03-29 20:33:12,269 - ***** Epoch: 7: Eval results *****
2024-03-29 20:33:12,270 -   train_loss = 0.1983
2024-03-29 20:33:12,270 -   best_eval_score = 0.6875
2024-03-29 20:33:12,270 -   eval_score = 0.6768
2024-03-29 20:33:12,270 - EarlyStopping counter: 1 out of 8
2024-03-29 20:33:37,505 - ***** Epoch: 8: Eval results *****
2024-03-29 20:33:37,506 -   train_loss = 0.1231
2024-03-29 20:33:37,506 -   best_eval_score = 0.6875
2024-03-29 20:33:37,506 -   eval_score = 0.7037
2024-03-29 20:33:59,983 - ***** Epoch: 9: Eval results *****
2024-03-29 20:33:59,984 -   train_loss = 0.094
2024-03-29 20:33:59,984 -   best_eval_score = 0.7037
2024-03-29 20:33:59,984 -   eval_score = 0.6954
2024-03-29 20:33:59,984 - EarlyStopping counter: 1 out of 8
2024-03-29 20:34:27,162 - ***** Epoch: 10: Eval results *****
2024-03-29 20:34:27,162 -   train_loss = 0.0709
2024-03-29 20:34:27,162 -   best_eval_score = 0.7037
2024-03-29 20:34:27,162 -   eval_score = 0.6975
2024-03-29 20:34:27,162 - EarlyStopping counter: 2 out of 8
2024-03-29 20:34:50,218 - ***** Epoch: 11: Eval results *****
2024-03-29 20:34:50,218 -   train_loss = 0.0563
2024-03-29 20:34:50,218 -   best_eval_score = 0.7037
2024-03-29 20:34:50,218 -   eval_score = 0.6936
2024-03-29 20:34:50,218 - EarlyStopping counter: 3 out of 8
2024-03-29 20:35:12,410 - ***** Epoch: 12: Eval results *****
2024-03-29 20:35:12,411 -   train_loss = 0.0424
2024-03-29 20:35:12,411 -   best_eval_score = 0.7037
2024-03-29 20:35:12,411 -   eval_score = 0.6914
2024-03-29 20:35:12,411 - EarlyStopping counter: 4 out of 8
2024-03-29 20:35:34,863 - ***** Epoch: 13: Eval results *****
2024-03-29 20:35:34,863 -   train_loss = 0.0339
2024-03-29 20:35:34,863 -   best_eval_score = 0.7037
2024-03-29 20:35:34,863 -   eval_score = 0.6928
2024-03-29 20:35:34,863 - EarlyStopping counter: 5 out of 8
2024-03-29 20:35:56,703 - ***** Epoch: 14: Eval results *****
2024-03-29 20:35:56,704 -   train_loss = 0.0284
2024-03-29 20:35:56,704 -   best_eval_score = 0.7037
2024-03-29 20:35:56,704 -   eval_score = 0.7032
2024-03-29 20:35:56,704 - EarlyStopping counter: 6 out of 8
2024-03-29 20:36:21,196 - ***** Epoch: 15: Eval results *****
2024-03-29 20:36:21,196 -   train_loss = 0.0261
2024-03-29 20:36:21,196 -   best_eval_score = 0.7037
2024-03-29 20:36:21,196 -   eval_score = 0.7052
2024-03-29 20:36:43,560 - ***** Epoch: 16: Eval results *****
2024-03-29 20:36:43,560 -   train_loss = 0.0226
2024-03-29 20:36:43,561 -   best_eval_score = 0.7052
2024-03-29 20:36:43,561 -   eval_score = 0.6954
2024-03-29 20:36:43,561 - EarlyStopping counter: 1 out of 8
2024-03-29 20:37:05,238 - ***** Epoch: 17: Eval results *****
2024-03-29 20:37:05,239 -   train_loss = 0.0204
2024-03-29 20:37:05,239 -   best_eval_score = 0.7052
2024-03-29 20:37:05,239 -   eval_score = 0.6969
2024-03-29 20:37:05,239 - EarlyStopping counter: 2 out of 8
2024-03-29 20:37:26,931 - ***** Epoch: 18: Eval results *****
2024-03-29 20:37:26,940 -   train_loss = 0.0179
2024-03-29 20:37:26,940 -   best_eval_score = 0.7052
2024-03-29 20:37:26,940 -   eval_score = 0.6915
2024-03-29 20:37:26,940 - EarlyStopping counter: 3 out of 8
2024-03-29 20:37:49,545 - ***** Epoch: 19: Eval results *****
2024-03-29 20:37:49,545 -   train_loss = 0.0178
2024-03-29 20:37:49,545 -   best_eval_score = 0.7052
2024-03-29 20:37:49,545 -   eval_score = 0.7036
2024-03-29 20:37:49,545 - EarlyStopping counter: 4 out of 8
2024-03-29 20:38:10,976 - ***** Epoch: 20: Eval results *****
2024-03-29 20:38:10,976 -   train_loss = 0.0149
2024-03-29 20:38:10,976 -   best_eval_score = 0.7052
2024-03-29 20:38:10,976 -   eval_score = 0.6951
2024-03-29 20:38:10,976 - EarlyStopping counter: 5 out of 8
2024-03-29 20:38:32,064 - ***** Epoch: 21: Eval results *****
2024-03-29 20:38:32,065 -   train_loss = 0.0146
2024-03-29 20:38:32,065 -   best_eval_score = 0.7052
2024-03-29 20:38:32,065 -   eval_score = 0.6994
2024-03-29 20:38:32,065 - EarlyStopping counter: 6 out of 8
2024-03-29 20:38:53,805 - ***** Epoch: 22: Eval results *****
2024-03-29 20:38:53,805 -   train_loss = 0.0139
2024-03-29 20:38:53,805 -   best_eval_score = 0.7052
2024-03-29 20:38:53,805 -   eval_score = 0.6952
2024-03-29 20:38:53,805 - EarlyStopping counter: 7 out of 8
2024-03-29 20:39:15,472 - ***** Epoch: 23: Eval results *****
2024-03-29 20:39:15,473 -   train_loss = 0.0134
2024-03-29 20:39:15,473 -   best_eval_score = 0.7052
2024-03-29 20:39:15,473 -   eval_score = 0.7107
2024-03-29 20:39:37,190 - ***** Epoch: 24: Eval results *****
2024-03-29 20:39:37,190 -   train_loss = 0.012
2024-03-29 20:39:37,190 -   best_eval_score = 0.7107
2024-03-29 20:39:37,190 -   eval_score = 0.7063
2024-03-29 20:39:37,190 - EarlyStopping counter: 1 out of 8
2024-03-29 20:39:58,377 - ***** Epoch: 25: Eval results *****
2024-03-29 20:39:58,377 -   train_loss = 0.0118
2024-03-29 20:39:58,377 -   best_eval_score = 0.7107
2024-03-29 20:39:58,377 -   eval_score = 0.7043
2024-03-29 20:39:58,377 - EarlyStopping counter: 2 out of 8
2024-03-29 20:40:19,416 - ***** Epoch: 26: Eval results *****
2024-03-29 20:40:19,417 -   train_loss = 0.0109
2024-03-29 20:40:19,417 -   best_eval_score = 0.7107
2024-03-29 20:40:19,417 -   eval_score = 0.6979
2024-03-29 20:40:19,417 - EarlyStopping counter: 3 out of 8
2024-03-29 20:40:40,468 - ***** Epoch: 27: Eval results *****
2024-03-29 20:40:40,468 -   train_loss = 0.0112
2024-03-29 20:40:40,468 -   best_eval_score = 0.7107
2024-03-29 20:40:40,468 -   eval_score = 0.6989
2024-03-29 20:40:40,468 - EarlyStopping counter: 4 out of 8
2024-03-29 20:41:01,451 - ***** Epoch: 28: Eval results *****
2024-03-29 20:41:01,452 -   train_loss = 0.011
2024-03-29 20:41:01,452 -   best_eval_score = 0.7107
2024-03-29 20:41:01,452 -   eval_score = 0.7003
2024-03-29 20:41:01,452 - EarlyStopping counter: 5 out of 8
2024-03-29 20:41:22,393 - ***** Epoch: 29: Eval results *****
2024-03-29 20:41:22,394 -   train_loss = 0.0099
2024-03-29 20:41:22,394 -   best_eval_score = 0.7107
2024-03-29 20:41:22,394 -   eval_score = 0.6969
2024-03-29 20:41:22,394 - EarlyStopping counter: 6 out of 8
2024-03-29 20:41:43,143 - ***** Epoch: 30: Eval results *****
2024-03-29 20:41:43,143 -   train_loss = 0.0094
2024-03-29 20:41:43,143 -   best_eval_score = 0.7107
2024-03-29 20:41:43,143 -   eval_score = 0.6871
2024-03-29 20:41:43,143 - EarlyStopping counter: 7 out of 8
2024-03-29 20:42:04,185 - ***** Epoch: 31: Eval results *****
2024-03-29 20:42:04,186 -   train_loss = 0.0094
2024-03-29 20:42:04,186 -   best_eval_score = 0.7107
2024-03-29 20:42:04,186 -   eval_score = 0.6871
2024-03-29 20:42:04,186 - EarlyStopping counter: 8 out of 8
2024-03-29 20:42:04,186 - EarlyStopping at epoch 31
2024-03-29 20:42:04,191 - Training is finished...
2024-03-29 20:42:04,192 - Testing begins...
2024-03-29 20:42:20,252 - ***** Test: Confusion Matrix *****
2024-03-29 20:42:20,256 - [[38  2  0  0  7  0  3  0  0  1  1  0  4  1  0  0  0  0  0  0]
 [ 0 34  0  1  0  3  1  0  0  0  1  0  2  1  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 5  0  0  0 10  0  3  0  0  0  0  1  2  1  0  0  0  1  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  3  0  2  0  3  0  0  0  1  0  0  0  1  0  0  0]
 [ 3  1  0  0  0  0  0  5  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  1  2  5  0  0  0  0  1  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  4  0  0  0  0  0  2  0  1  0  1]
 [ 1  0  0  0  0  0  1  0  0  2 12  0  0  0  1  0  1  0  0  0]
 [ 0  0  0  0  1  0  1  0  0  0  0 15  0  0  0  0  0  0  1  1]
 [ 3  1  0  0  1  0  0  0  0  0  1  1 39  4  2  1  2  0  1  1]
 [ 0  1  0  0  0  0  2  0  0  0  1  1  0 19  1  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  1  0  0  0  0  2 16  0  1  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  4  0  0 15  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  1  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  2  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  0  1  0  0  6]]
2024-03-29 20:42:20,257 - ***** Evaluation results *****
2024-03-29 20:42:20,257 -   acc = 0.7079
2024-03-29 20:42:20,257 -   f1 = 0.68
2024-03-29 20:42:20,257 -   prec = 0.6855
2024-03-29 20:42:20,257 -   rec = 0.6786
2024-03-29 20:42:20,257 - Testing is finished...
2024-03-29 20:42:20,257 - Multimodal intent recognition is finished...
2024-03-29 20:42:20,257 - Results are saved in results/msz.csv
