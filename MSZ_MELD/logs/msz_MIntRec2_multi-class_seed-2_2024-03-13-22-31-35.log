2024-03-13 22:31:35,744 - ============================== Params ==============================
2024-03-13 22:31:35,744 - logger_name: msz_MIntRec2_multi-class_seed-2_2024-03-13-22-31-35
2024-03-13 22:31:35,745 - dataset: MIntRec2
2024-03-13 22:31:35,745 - data_mode: multi-class
2024-03-13 22:31:35,745 - method: msz
2024-03-13 22:31:35,745 - text_backbone: bert-base-uncased
2024-03-13 22:31:35,745 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-13 22:31:35,745 - seed: 2
2024-03-13 22:31:35,745 - num_workers: 8
2024-03-13 22:31:35,745 - gpu_id: 3
2024-03-13 22:31:35,745 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-13 22:31:35,745 - train: True
2024-03-13 22:31:35,745 - tune: True
2024-03-13 22:31:35,745 - save_model: False
2024-03-13 22:31:35,745 - save_results: True
2024-03-13 22:31:35,745 - log_path: logs
2024-03-13 22:31:35,745 - cache_path: 
2024-03-13 22:31:35,745 - video_data_path: video_data
2024-03-13 22:31:35,745 - audio_data_path: audio_data
2024-03-13 22:31:35,745 - video_feats_path: video_feats.pkl
2024-03-13 22:31:35,745 - audio_feats_path: audio_feats.pkl
2024-03-13 22:31:35,745 - results_path: results
2024-03-13 22:31:35,745 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-13 22:31:35,745 - model_path: models
2024-03-13 22:31:35,745 - config_file_name: msz_MIntRec2
2024-03-13 22:31:35,745 - results_file_name: msz.csv
2024-03-13 22:31:35,745 - padding_mode: zero
2024-03-13 22:31:35,745 - padding_loc: end
2024-03-13 22:31:35,745 - need_aligned: False
2024-03-13 22:31:35,745 - eval_monitor: f1
2024-03-13 22:31:35,745 - train_batch_size: 32
2024-03-13 22:31:35,745 - eval_batch_size: 16
2024-03-13 22:31:35,745 - test_batch_size: 16
2024-03-13 22:31:35,745 - wait_patience: 8
2024-03-13 22:31:35,745 - hidden_dims: 768
2024-03-13 22:31:35,745 - num_attention_heads: 6
2024-03-13 22:31:35,745 - attention_probs_dropout_prob: 0.5
2024-03-13 22:31:35,745 - hidden_dropout_prob: 0.5
2024-03-13 22:31:35,745 - intermediate_size: 768
2024-03-13 22:31:35,745 - num_hidden_layers: 6
2024-03-13 22:31:35,745 - max_position_embeddings: 1000
2024-03-13 22:31:35,746 - position_embedding_type: absolute
2024-03-13 22:31:35,746 - batch_first: True
2024-03-13 22:31:35,746 - dropout: 0.5
2024-03-13 22:31:35,746 - aligned_method: conv1d
2024-03-13 22:31:35,746 - num_train_epochs: 100
2024-03-13 22:31:35,746 - lr: 4e-06
2024-03-13 22:31:35,746 - lr_mode: min
2024-03-13 22:31:35,746 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-2_2024-03-13-22-31-35
2024-03-13 22:31:35,746 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-2_2024-03-13-22-31-35/models
2024-03-13 22:31:35,746 - num_labels: 30
2024-03-13 22:31:35,746 - text_feat_dim: 768
2024-03-13 22:31:35,746 - video_feat_dim: 256
2024-03-13 22:31:35,746 - audio_feat_dim: 768
2024-03-13 22:31:35,746 - text_seq_len: 50
2024-03-13 22:31:35,746 - video_seq_len: 180
2024-03-13 22:31:35,746 - audio_seq_len: 400
2024-03-13 22:31:35,746 - device: cuda:3
2024-03-13 22:31:35,746 - ============================== End Params ==============================
2024-03-13 22:31:35,791 - Generate Text Features Begin...
2024-03-13 22:31:37,473 - Generate Text Features Finished...
2024-03-13 22:31:37,475 - Load Video Features Begin...
2024-03-13 22:31:41,128 - Load Video Features Finished...
2024-03-13 22:31:42,839 - Load Audio Features Begin...
2024-03-13 22:31:53,852 - Load Audio Features Finished...
2024-03-13 22:32:06,804 - method  begins...
2024-03-13 22:32:08,512 - Multimodal intent recognition begins...
2024-03-13 22:32:08,512 - Training begins...
2024-03-13 22:33:20,224 - ***** Epoch: 1: Eval results *****
2024-03-13 22:33:20,224 -   train_loss = 3.0179
2024-03-13 22:33:20,224 -   best_eval_score = 0.0
2024-03-13 22:33:20,224 -   eval_score = 0.1959
2024-03-13 22:34:32,911 - ***** Epoch: 2: Eval results *****
2024-03-13 22:34:32,912 -   train_loss = 2.1807
2024-03-13 22:34:32,912 -   best_eval_score = 0.1959
2024-03-13 22:34:32,912 -   eval_score = 0.3154
2024-03-13 22:35:45,839 - ***** Epoch: 3: Eval results *****
2024-03-13 22:35:45,839 -   train_loss = 1.6882
2024-03-13 22:35:45,839 -   best_eval_score = 0.3154
2024-03-13 22:35:45,839 -   eval_score = 0.3911
2024-03-13 22:36:57,825 - ***** Epoch: 4: Eval results *****
2024-03-13 22:36:57,825 -   train_loss = 1.4289
2024-03-13 22:36:57,825 -   best_eval_score = 0.3911
2024-03-13 22:36:57,825 -   eval_score = 0.4381
2024-03-13 22:38:10,151 - ***** Epoch: 5: Eval results *****
2024-03-13 22:38:10,151 -   train_loss = 1.2489
2024-03-13 22:38:10,151 -   best_eval_score = 0.4381
2024-03-13 22:38:10,151 -   eval_score = 0.4516
2024-03-13 22:39:22,791 - ***** Epoch: 6: Eval results *****
2024-03-13 22:39:22,791 -   train_loss = 1.1034
2024-03-13 22:39:22,791 -   best_eval_score = 0.4516
2024-03-13 22:39:22,792 -   eval_score = 0.4739
2024-03-13 22:40:35,634 - ***** Epoch: 7: Eval results *****
2024-03-13 22:40:35,634 -   train_loss = 0.9801
2024-03-13 22:40:35,634 -   best_eval_score = 0.4739
2024-03-13 22:40:35,634 -   eval_score = 0.4816
2024-03-13 22:41:47,079 - ***** Epoch: 8: Eval results *****
2024-03-13 22:41:47,079 -   train_loss = 0.8615
2024-03-13 22:41:47,079 -   best_eval_score = 0.4816
2024-03-13 22:41:47,079 -   eval_score = 0.4915
2024-03-13 22:42:59,643 - ***** Epoch: 9: Eval results *****
2024-03-13 22:42:59,644 -   train_loss = 0.7561
2024-03-13 22:42:59,644 -   best_eval_score = 0.4915
2024-03-13 22:42:59,644 -   eval_score = 0.4845
2024-03-13 22:42:59,644 - EarlyStopping counter: 1 out of 8
2024-03-13 22:44:12,906 - ***** Epoch: 10: Eval results *****
2024-03-13 22:44:12,906 -   train_loss = 0.6527
2024-03-13 22:44:12,906 -   best_eval_score = 0.4915
2024-03-13 22:44:12,906 -   eval_score = 0.4952
2024-03-13 22:45:25,383 - ***** Epoch: 11: Eval results *****
2024-03-13 22:45:25,383 -   train_loss = 0.5429
2024-03-13 22:45:25,383 -   best_eval_score = 0.4952
2024-03-13 22:45:25,383 -   eval_score = 0.4989
2024-03-13 22:46:37,396 - ***** Epoch: 12: Eval results *****
2024-03-13 22:46:37,397 -   train_loss = 0.5355
2024-03-13 22:46:37,397 -   best_eval_score = 0.4989
2024-03-13 22:46:37,397 -   eval_score = 0.5039
2024-03-13 22:47:52,099 - ***** Epoch: 13: Eval results *****
2024-03-13 22:47:52,099 -   train_loss = 0.522
2024-03-13 22:47:52,100 -   best_eval_score = 0.5039
2024-03-13 22:47:52,100 -   eval_score = 0.5
2024-03-13 22:47:52,100 - EarlyStopping counter: 1 out of 8
2024-03-13 22:49:03,712 - ***** Epoch: 14: Eval results *****
2024-03-13 22:49:03,712 -   train_loss = 0.5033
2024-03-13 22:49:03,712 -   best_eval_score = 0.5039
2024-03-13 22:49:03,712 -   eval_score = 0.5052
2024-03-13 22:50:15,882 - ***** Epoch: 15: Eval results *****
2024-03-13 22:50:15,883 -   train_loss = 0.4966
2024-03-13 22:50:15,883 -   best_eval_score = 0.5052
2024-03-13 22:50:15,883 -   eval_score = 0.499
2024-03-13 22:50:15,883 - EarlyStopping counter: 1 out of 8
2024-03-13 22:51:29,808 - ***** Epoch: 16: Eval results *****
2024-03-13 22:51:29,809 -   train_loss = 0.4809
2024-03-13 22:51:29,809 -   best_eval_score = 0.5052
2024-03-13 22:51:29,809 -   eval_score = 0.5025
2024-03-13 22:51:29,809 - EarlyStopping counter: 2 out of 8
2024-03-13 22:52:41,586 - ***** Epoch: 17: Eval results *****
2024-03-13 22:52:41,587 -   train_loss = 0.4764
2024-03-13 22:52:41,587 -   best_eval_score = 0.5052
2024-03-13 22:52:41,587 -   eval_score = 0.5083
2024-03-13 22:53:55,506 - ***** Epoch: 18: Eval results *****
2024-03-13 22:53:55,507 -   train_loss = 0.4759
2024-03-13 22:53:55,508 -   best_eval_score = 0.5083
2024-03-13 22:53:55,508 -   eval_score = 0.5013
2024-03-13 22:53:55,508 - EarlyStopping counter: 1 out of 8
2024-03-13 22:55:11,050 - ***** Epoch: 19: Eval results *****
2024-03-13 22:55:11,051 -   train_loss = 0.4514
2024-03-13 22:55:11,051 -   best_eval_score = 0.5083
2024-03-13 22:55:11,051 -   eval_score = 0.5062
2024-03-13 22:55:11,051 - EarlyStopping counter: 2 out of 8
2024-03-13 22:56:23,007 - ***** Epoch: 20: Eval results *****
2024-03-13 22:56:23,008 -   train_loss = 0.4594
2024-03-13 22:56:23,008 -   best_eval_score = 0.5083
2024-03-13 22:56:23,008 -   eval_score = 0.5053
2024-03-13 22:56:23,008 - EarlyStopping counter: 3 out of 8
2024-03-13 22:57:36,363 - ***** Epoch: 21: Eval results *****
2024-03-13 22:57:36,363 -   train_loss = 0.4509
2024-03-13 22:57:36,363 -   best_eval_score = 0.5083
2024-03-13 22:57:36,363 -   eval_score = 0.5059
2024-03-13 22:57:36,363 - EarlyStopping counter: 4 out of 8
2024-03-13 22:58:48,969 - ***** Epoch: 22: Eval results *****
2024-03-13 22:58:48,969 -   train_loss = 0.4485
2024-03-13 22:58:48,969 -   best_eval_score = 0.5083
2024-03-13 22:58:48,969 -   eval_score = 0.5068
2024-03-13 22:58:48,969 - EarlyStopping counter: 5 out of 8
2024-03-13 23:00:00,115 - ***** Epoch: 23: Eval results *****
2024-03-13 23:00:00,115 -   train_loss = 0.4527
2024-03-13 23:00:00,115 -   best_eval_score = 0.5083
2024-03-13 23:00:00,115 -   eval_score = 0.5063
2024-03-13 23:00:00,115 - EarlyStopping counter: 6 out of 8
2024-03-13 23:01:13,261 - ***** Epoch: 24: Eval results *****
2024-03-13 23:01:13,261 -   train_loss = 0.442
2024-03-13 23:01:13,261 -   best_eval_score = 0.5083
2024-03-13 23:01:13,261 -   eval_score = 0.5059
2024-03-13 23:01:13,261 - EarlyStopping counter: 7 out of 8
2024-03-13 23:02:24,658 - ***** Epoch: 25: Eval results *****
2024-03-13 23:02:24,658 -   train_loss = 0.44
2024-03-13 23:02:24,658 -   best_eval_score = 0.5083
2024-03-13 23:02:24,658 -   eval_score = 0.5057
2024-03-13 23:02:24,658 - EarlyStopping counter: 8 out of 8
2024-03-13 23:02:24,658 - EarlyStopping at epoch 25
2024-03-13 23:02:24,662 - Training is finished...
2024-03-13 23:02:24,663 - Testing begins...
2024-03-13 23:02:34,939 - ***** Test: Confusion Matrix *****
2024-03-13 23:02:34,944 - [[ 48   0  14   0   0   0   0   0   0   0   2   0   0   0   0   0   0   1
    0   0   0   1   1   0   1   0   0   0   0   0]
 [  0  61   0   0   7   1   4   0   0   0   1   1   4   0   4   0   0   7
    1   0   0   3   1   0   1   0   0   1   0   0]
 [ 10   0  44   0   1   0   0   0   0   0   1   0   0   0   2   0   0   2
    0   0   0   0   0   1   3   0   0   0   0   0]
 [  0   0   0  60   0   0   0   1   0   1   0   0   0   0   2   0   0   1
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   6   0   0  35   0   0   0   1   0   0   0   0   0   0   0   0   2
    0   1   0   2   0   1   1   0   0   0   1   1]
 [  0   1   0   0   2  21   0   0   0   1   1   0   0   0   1   0   0   8
    0   1   0   0   0   0   0   0   1   0   0   0]
 [  0   1   0   0   0   2  30   7   0   0   3   0   5   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   6  28   0   0   3   1   8   0   0   0   0   0
    0   0   0   0   1   0   0   0   0   0   0   0]
 [  1   3   1   3   0   0   0   0  22   0   0   1   1   0   3   1   0   3
    0   0   0   0   7   0   2   0   0   1   0   0]
 [  0   1   0   0   0   0   0   0   3  55   0   6   6   0  14   0   0   6
    0   0   0   1   2   1   4   1   1   6   0   0]
 [  0   0   0   0   0   2   5   3   2   2  46   0  26   0   1   0   1   2
    0   2   0   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   1   0   0   5   1  22   7   0   1   0   0   0
    1   0   0   0   3   0   1   0   0   4   0   1]
 [  0   2   0   0   0   0   5  10   0   5  27   0  83   0   0   0   1   0
    0   0   0   0   2   0   0   0   0   0   0   0]
 [  0   0   2   0   1   0   0   0   1   1   0   0   0   0   4   1   0   0
    4   0   0   0   2   0   0   0   0   1   0   0]
 [  0   3   2   0   1   2   0   0   6   6   3   1   1   0 118   2   0  21
    3   0   0   0  13   0   4   0   0   7   0   0]
 [  0   0   1   0   1   0   0   0   0   3   0   0   0   0   1   3   0   4
    2   0   0   1   2   0   1   0   0   2   1   0]
 [  0   0   0   0   1   0   1   3   0   0   2   0   1   0   0   0  52   0
    4   0   0   0   0   0   2   0   0   0   0   0]
 [  0   6   1   0   6   5   0   0   2  14   0   0   1   0  23   2   2 108
   15   1   0   6   7   9   1   2   0   4   1   1]
 [  0   3   1   0   0   0   1   0   1   4   1   0   0   0   9   0   1   5
   29   0   2   0   1   0   2   0   0   0   0   0]
 [  0   6   0   0   0   0   2   0   0   0   1   0   0   0   0   0   0   0
    0   7   0   1   0   0   0   0   0   0   0   0]
 [  0   1   2   0   1   0   0   0   0   2   1   1   0   0   5   0   0   4
    5   0   3   0   0   1   1   0   0   2   0   0]
 [  5   1   0   0   1   0   0   0   0   4   0   1   0   0   0   0   5   0
    0   0   0  26   1   6   1   0   1   0   0   1]
 [  0   0   1   1   1   0   0   0   1   4   0   3   0   1   9   0   0   2
    0   0   0   0  87   0   1   4   2   0   0   0]
 [  0   3   1   0   1   0   0   0   0   0   0   0   0   0   0   0   0   6
    1   0   0   3   0  23   0   0   0   0   0   0]
 [  1   0   3   0   0   0   0   0   0   2   1   1   0   0   2   0   0   3
    0   0   0   0   1   1  88   0   0   8   2   0]
 [  1   1   0   0   0   0   0   0   1   1   0   1   0   0   0   0   0   1
    0   0   0   0   2   0   1  21   0   0   0   1]
 [  0   0   0   2   0   0   0   0   0   2   0   0   0   0   0   0   0   3
    0   0   0   3   3   0   0   0   3   0   1   0]
 [  1   2   1   0   0   0   0   1   1   9   2   4   3   1   3   0   0   3
    1   0   0   0   1   0   8   2   0  13   1   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1
    0   0   0   0   0   0   0   0   0   0  56   0]
 [  0   1   0   0   3   0   0   0   3   2   1   1   0   0   0   0   0   3
    1   0   0   0   0   0   1   1   0   0   0   2]]
2024-03-13 23:02:34,944 - ***** Evaluation results *****
2024-03-13 23:02:34,944 -   acc = 0.5873
2024-03-13 23:02:34,944 -   f1 = 0.5244
2024-03-13 23:02:34,944 -   prec = 0.5459
2024-03-13 23:02:34,944 -   rec = 0.5253
2024-03-13 23:02:34,945 - Testing is finished...
2024-03-13 23:02:34,945 - Multimodal intent recognition is finished...
2024-03-13 23:02:34,945 - Results are saved in results/msz.csv
