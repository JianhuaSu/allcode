2024-03-30 08:43:13,315 - ============================== Params ==============================
2024-03-30 08:43:13,315 - logger_name: msz_MIntRec_multi-class_seed-2_2024-03-30-08-43-13
2024-03-30 08:43:13,315 - dataset: MIntRec
2024-03-30 08:43:13,316 - data_mode: multi-class
2024-03-30 08:43:13,316 - method: msz
2024-03-30 08:43:13,316 - text_backbone: bert-base-uncased
2024-03-30 08:43:13,316 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-30 08:43:13,316 - seed: 2
2024-03-30 08:43:13,316 - num_workers: 8
2024-03-30 08:43:13,316 - gpu_id: 3
2024-03-30 08:43:13,316 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-30 08:43:13,316 - train: True
2024-03-30 08:43:13,316 - tune: True
2024-03-30 08:43:13,316 - save_model: False
2024-03-30 08:43:13,316 - save_results: True
2024-03-30 08:43:13,316 - log_path: logs
2024-03-30 08:43:13,316 - cache_path: 
2024-03-30 08:43:13,316 - video_data_path: video_data
2024-03-30 08:43:13,316 - audio_data_path: audio_data
2024-03-30 08:43:13,316 - video_feats_path: video_feats.pkl
2024-03-30 08:43:13,316 - audio_feats_path: audio_feats.pkl
2024-03-30 08:43:13,316 - results_path: results
2024-03-30 08:43:13,316 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-03-30 08:43:13,316 - model_path: models
2024-03-30 08:43:13,316 - config_file_name: msz_MIntRec
2024-03-30 08:43:13,316 - results_file_name: msz.csv
2024-03-30 08:43:13,316 - padding_mode: zero
2024-03-30 08:43:13,316 - padding_loc: end
2024-03-30 08:43:13,316 - need_aligned: False
2024-03-30 08:43:13,316 - eval_monitor: f1
2024-03-30 08:43:13,316 - train_batch_size: 16
2024-03-30 08:43:13,316 - eval_batch_size: 8
2024-03-30 08:43:13,316 - test_batch_size: 8
2024-03-30 08:43:13,316 - wait_patience: 8
2024-03-30 08:43:13,316 - hidden_dims: 768
2024-03-30 08:43:13,316 - num_attention_heads: 8
2024-03-30 08:43:13,317 - attention_probs_dropout_prob: 0.2
2024-03-30 08:43:13,317 - hidden_dropout_prob: 0.4
2024-03-30 08:43:13,317 - intermediate_size: 768
2024-03-30 08:43:13,317 - num_hidden_layers: 6
2024-03-30 08:43:13,317 - max_position_embeddings: 768
2024-03-30 08:43:13,317 - position_embedding_type: absolute
2024-03-30 08:43:13,317 - batch_first: True
2024-03-30 08:43:13,317 - dropout: 0.1
2024-03-30 08:43:13,317 - aligned_method: conv1d
2024-03-30 08:43:13,317 - num_train_epochs: 100
2024-03-30 08:43:13,317 - lr: 5e-06
2024-03-30 08:43:13,317 - lr_mode: max
2024-03-30 08:43:13,317 - patience: 3
2024-03-30 08:43:13,317 - factor: 0.6
2024-03-30 08:43:13,317 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-03-30-08-43-13
2024-03-30 08:43:13,317 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-03-30-08-43-13/models
2024-03-30 08:43:13,317 - num_labels: 20
2024-03-30 08:43:13,317 - text_feat_dim: 768
2024-03-30 08:43:13,317 - video_feat_dim: 256
2024-03-30 08:43:13,317 - audio_feat_dim: 768
2024-03-30 08:43:13,317 - text_seq_len: 30
2024-03-30 08:43:13,317 - video_seq_len: 230
2024-03-30 08:43:13,317 - audio_seq_len: 480
2024-03-30 08:43:13,317 - device: cuda:3
2024-03-30 08:43:13,317 - ============================== End Params ==============================
2024-03-30 08:43:13,321 - Generate Text Features Begin...
2024-03-30 08:43:13,828 - Generate Text Features Finished...
2024-03-30 08:43:13,829 - Load Video Features Begin...
2024-03-30 08:43:14,105 - Load Video Features Finished...
2024-03-30 08:43:14,572 - Load Audio Features Begin...
2024-03-30 08:43:15,376 - Load Audio Features Finished...
2024-03-30 08:43:17,579 - method  begins...
2024-03-30 08:43:19,029 - Multimodal intent recognition begins...
2024-03-30 08:43:19,029 - Training begins...
2024-03-30 08:43:36,820 - ***** Epoch: 1: Eval results *****
2024-03-30 08:43:36,820 -   train_loss = 2.76
2024-03-30 08:43:36,820 -   best_eval_score = 0.0
2024-03-30 08:43:36,820 -   eval_score = 0.1534
2024-03-30 08:43:54,475 - ***** Epoch: 2: Eval results *****
2024-03-30 08:43:54,475 -   train_loss = 2.0971
2024-03-30 08:43:54,475 -   best_eval_score = 0.1534
2024-03-30 08:43:54,475 -   eval_score = 0.4076
2024-03-30 08:44:12,406 - ***** Epoch: 3: Eval results *****
2024-03-30 08:44:12,406 -   train_loss = 1.37
2024-03-30 08:44:12,406 -   best_eval_score = 0.4076
2024-03-30 08:44:12,406 -   eval_score = 0.5257
2024-03-30 08:44:29,670 - ***** Epoch: 4: Eval results *****
2024-03-30 08:44:29,670 -   train_loss = 0.8865
2024-03-30 08:44:29,670 -   best_eval_score = 0.5257
2024-03-30 08:44:29,670 -   eval_score = 0.5682
2024-03-30 08:44:46,972 - ***** Epoch: 5: Eval results *****
2024-03-30 08:44:46,973 -   train_loss = 0.5777
2024-03-30 08:44:46,973 -   best_eval_score = 0.5682
2024-03-30 08:44:46,973 -   eval_score = 0.6458
2024-03-30 08:45:12,382 - ***** Epoch: 6: Eval results *****
2024-03-30 08:45:12,382 -   train_loss = 0.3726
2024-03-30 08:45:12,382 -   best_eval_score = 0.6458
2024-03-30 08:45:12,382 -   eval_score = 0.6417
2024-03-30 08:45:12,382 - EarlyStopping counter: 1 out of 8
2024-03-30 08:45:40,733 - ***** Epoch: 7: Eval results *****
2024-03-30 08:45:40,733 -   train_loss = 0.2766
2024-03-30 08:45:40,733 -   best_eval_score = 0.6458
2024-03-30 08:45:40,733 -   eval_score = 0.673
2024-03-30 08:46:09,478 - ***** Epoch: 8: Eval results *****
2024-03-30 08:46:09,478 -   train_loss = 0.2006
2024-03-30 08:46:09,478 -   best_eval_score = 0.673
2024-03-30 08:46:09,478 -   eval_score = 0.6691
2024-03-30 08:46:09,478 - EarlyStopping counter: 1 out of 8
2024-03-30 08:46:38,121 - ***** Epoch: 9: Eval results *****
2024-03-30 08:46:38,121 -   train_loss = 0.1459
2024-03-30 08:46:38,121 -   best_eval_score = 0.673
2024-03-30 08:46:38,121 -   eval_score = 0.6727
2024-03-30 08:46:38,121 - EarlyStopping counter: 2 out of 8
2024-03-30 08:47:06,761 - ***** Epoch: 10: Eval results *****
2024-03-30 08:47:06,761 -   train_loss = 0.1127
2024-03-30 08:47:06,762 -   best_eval_score = 0.673
2024-03-30 08:47:06,762 -   eval_score = 0.6767
2024-03-30 08:47:35,329 - ***** Epoch: 11: Eval results *****
2024-03-30 08:47:35,329 -   train_loss = 0.0949
2024-03-30 08:47:35,329 -   best_eval_score = 0.6767
2024-03-30 08:47:35,329 -   eval_score = 0.6801
2024-03-30 08:48:03,899 - ***** Epoch: 12: Eval results *****
2024-03-30 08:48:03,899 -   train_loss = 0.0835
2024-03-30 08:48:03,899 -   best_eval_score = 0.6801
2024-03-30 08:48:03,899 -   eval_score = 0.6818
2024-03-30 08:48:29,305 - ***** Epoch: 13: Eval results *****
2024-03-30 08:48:29,305 -   train_loss = 0.0693
2024-03-30 08:48:29,305 -   best_eval_score = 0.6818
2024-03-30 08:48:29,305 -   eval_score = 0.6732
2024-03-30 08:48:29,305 - EarlyStopping counter: 1 out of 8
2024-03-30 08:48:56,561 - ***** Epoch: 14: Eval results *****
2024-03-30 08:48:56,562 -   train_loss = 0.0607
2024-03-30 08:48:56,562 -   best_eval_score = 0.6818
2024-03-30 08:48:56,562 -   eval_score = 0.6783
2024-03-30 08:48:56,562 - EarlyStopping counter: 2 out of 8
2024-03-30 08:49:25,490 - ***** Epoch: 15: Eval results *****
2024-03-30 08:49:25,490 -   train_loss = 0.0562
2024-03-30 08:49:25,491 -   best_eval_score = 0.6818
2024-03-30 08:49:25,491 -   eval_score = 0.6803
2024-03-30 08:49:25,491 - EarlyStopping counter: 3 out of 8
2024-03-30 08:49:53,927 - ***** Epoch: 16: Eval results *****
2024-03-30 08:49:53,927 -   train_loss = 0.0498
2024-03-30 08:49:53,927 -   best_eval_score = 0.6818
2024-03-30 08:49:53,927 -   eval_score = 0.6847
2024-03-30 08:50:21,784 - ***** Epoch: 17: Eval results *****
2024-03-30 08:50:21,784 -   train_loss = 0.0468
2024-03-30 08:50:21,784 -   best_eval_score = 0.6847
2024-03-30 08:50:21,784 -   eval_score = 0.6844
2024-03-30 08:50:21,784 - EarlyStopping counter: 1 out of 8
2024-03-30 08:50:49,956 - ***** Epoch: 18: Eval results *****
2024-03-30 08:50:49,957 -   train_loss = 0.0419
2024-03-30 08:50:49,957 -   best_eval_score = 0.6847
2024-03-30 08:50:49,957 -   eval_score = 0.6827
2024-03-30 08:50:49,957 - EarlyStopping counter: 2 out of 8
2024-03-30 08:51:17,852 - ***** Epoch: 19: Eval results *****
2024-03-30 08:51:17,853 -   train_loss = 0.0404
2024-03-30 08:51:17,853 -   best_eval_score = 0.6847
2024-03-30 08:51:17,853 -   eval_score = 0.6884
2024-03-30 08:51:46,852 - ***** Epoch: 20: Eval results *****
2024-03-30 08:51:46,853 -   train_loss = 0.0375
2024-03-30 08:51:46,853 -   best_eval_score = 0.6884
2024-03-30 08:51:46,853 -   eval_score = 0.6898
2024-03-30 08:52:15,605 - ***** Epoch: 21: Eval results *****
2024-03-30 08:52:15,605 -   train_loss = 0.0376
2024-03-30 08:52:15,605 -   best_eval_score = 0.6898
2024-03-30 08:52:15,605 -   eval_score = 0.6897
2024-03-30 08:52:15,605 - EarlyStopping counter: 1 out of 8
2024-03-30 08:52:44,185 - ***** Epoch: 22: Eval results *****
2024-03-30 08:52:44,185 -   train_loss = 0.0345
2024-03-30 08:52:44,185 -   best_eval_score = 0.6898
2024-03-30 08:52:44,185 -   eval_score = 0.6911
2024-03-30 08:53:12,586 - ***** Epoch: 23: Eval results *****
2024-03-30 08:53:12,587 -   train_loss = 0.0364
2024-03-30 08:53:12,587 -   best_eval_score = 0.6911
2024-03-30 08:53:12,587 -   eval_score = 0.6879
2024-03-30 08:53:12,587 - EarlyStopping counter: 1 out of 8
2024-03-30 08:53:41,150 - ***** Epoch: 24: Eval results *****
2024-03-30 08:53:41,150 -   train_loss = 0.0308
2024-03-30 08:53:41,150 -   best_eval_score = 0.6911
2024-03-30 08:53:41,150 -   eval_score = 0.6945
2024-03-30 08:54:09,933 - ***** Epoch: 25: Eval results *****
2024-03-30 08:54:09,933 -   train_loss = 0.0332
2024-03-30 08:54:09,933 -   best_eval_score = 0.6945
2024-03-30 08:54:09,934 -   eval_score = 0.6848
2024-03-30 08:54:09,934 - EarlyStopping counter: 1 out of 8
2024-03-30 08:54:38,797 - ***** Epoch: 26: Eval results *****
2024-03-30 08:54:38,797 -   train_loss = 0.0307
2024-03-30 08:54:38,798 -   best_eval_score = 0.6945
2024-03-30 08:54:38,798 -   eval_score = 0.6871
2024-03-30 08:54:38,798 - EarlyStopping counter: 2 out of 8
2024-03-30 08:55:01,864 - ***** Epoch: 27: Eval results *****
2024-03-30 08:55:01,864 -   train_loss = 0.0305
2024-03-30 08:55:01,864 -   best_eval_score = 0.6945
2024-03-30 08:55:01,864 -   eval_score = 0.6874
2024-03-30 08:55:01,864 - EarlyStopping counter: 3 out of 8
2024-03-30 08:55:28,859 - ***** Epoch: 28: Eval results *****
2024-03-30 08:55:28,859 -   train_loss = 0.03
2024-03-30 08:55:28,859 -   best_eval_score = 0.6945
2024-03-30 08:55:28,859 -   eval_score = 0.6917
2024-03-30 08:55:28,859 - EarlyStopping counter: 4 out of 8
2024-03-30 08:55:46,337 - ***** Epoch: 29: Eval results *****
2024-03-30 08:55:46,337 -   train_loss = 0.03
2024-03-30 08:55:46,337 -   best_eval_score = 0.6945
2024-03-30 08:55:46,337 -   eval_score = 0.6859
2024-03-30 08:55:46,337 - EarlyStopping counter: 5 out of 8
2024-03-30 08:56:03,852 - ***** Epoch: 30: Eval results *****
2024-03-30 08:56:03,852 -   train_loss = 0.0286
2024-03-30 08:56:03,852 -   best_eval_score = 0.6945
2024-03-30 08:56:03,852 -   eval_score = 0.6884
2024-03-30 08:56:03,852 - EarlyStopping counter: 6 out of 8
2024-03-30 08:56:21,003 - ***** Epoch: 31: Eval results *****
2024-03-30 08:56:21,003 -   train_loss = 0.0284
2024-03-30 08:56:21,003 -   best_eval_score = 0.6945
2024-03-30 08:56:21,003 -   eval_score = 0.688
2024-03-30 08:56:21,003 - EarlyStopping counter: 7 out of 8
2024-03-30 08:56:38,636 - ***** Epoch: 32: Eval results *****
2024-03-30 08:56:38,636 -   train_loss = 0.0285
2024-03-30 08:56:38,636 -   best_eval_score = 0.6945
2024-03-30 08:56:38,636 -   eval_score = 0.6841
2024-03-30 08:56:38,636 - EarlyStopping counter: 8 out of 8
2024-03-30 08:56:38,636 - EarlyStopping at epoch 32
2024-03-30 08:56:38,639 - Training is finished...
2024-03-30 08:56:38,639 - Testing begins...
2024-03-30 08:56:41,548 - ***** Test: Confusion Matrix *****
2024-03-30 08:56:41,549 - [[38  1  0  0  5  0  3  0  1  2  1  0  5  1  0  0  0  0  0  0]
 [ 1 35  0  1  0  2  0  0  0  0  1  0  2  0  1  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 6  0  0  0  9  0  1  0  0  1  0  1  2  0  1  0  0  2  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 2  1  0  0  3  0  1  0  3  0  0  0  1  0  0  0  1  0  0  0]
 [ 3  0  0  0  0  1  0  5  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  3  3  0  0  0  0  2  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  3  0  0  0  0  0  3  1  1  0  0]
 [ 1  0  0  0  0  0  0  0  0  2 14  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  0  1]
 [ 3  2  0  0  1  0  0  0  0  0  0  1 41  1  4  1  2  0  0  1]
 [ 1  0  0  0  0  0  1  0  0  0  1  1  1 18  2  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  2 14  0  1  0  0  2]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  2  0  0 17  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  3  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  2  0  2  0  0  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  8  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  1  0  2  0  0  5]]
2024-03-30 08:56:41,549 - ***** Evaluation results *****
2024-03-30 08:56:41,549 -   acc = 0.6989
2024-03-30 08:56:41,549 -   f1 = 0.6511
2024-03-30 08:56:41,549 -   prec = 0.6603
2024-03-30 08:56:41,549 -   rec = 0.6496
2024-03-30 08:56:41,550 - Testing is finished...
2024-03-30 08:56:41,550 - Multimodal intent recognition is finished...
2024-03-30 08:56:41,550 - Results are saved in results/msz.csv
