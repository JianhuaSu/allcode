2024-03-17 02:53:59,463 - ============================== Params ==============================
2024-03-17 02:53:59,463 - logger_name: mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-02-53-59
2024-03-17 02:53:59,463 - dataset: MIntRec2
2024-03-17 02:53:59,463 - data_mode: multi-class
2024-03-17 02:53:59,463 - method: mag_bert
2024-03-17 02:53:59,463 - text_backbone: bert-base-uncased
2024-03-17 02:53:59,463 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-17 02:53:59,463 - seed: 4
2024-03-17 02:53:59,463 - num_workers: 8
2024-03-17 02:53:59,463 - gpu_id: 2
2024-03-17 02:53:59,463 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-17 02:53:59,463 - train: True
2024-03-17 02:53:59,463 - tune: True
2024-03-17 02:53:59,463 - save_model: False
2024-03-17 02:53:59,463 - save_results: True
2024-03-17 02:53:59,463 - log_path: logs
2024-03-17 02:53:59,463 - cache_path: 
2024-03-17 02:53:59,463 - video_data_path: video_data
2024-03-17 02:53:59,463 - audio_data_path: audio_data
2024-03-17 02:53:59,463 - video_feats_path: video_feats.pkl
2024-03-17 02:53:59,463 - audio_feats_path: audio_feats.pkl
2024-03-17 02:53:59,463 - results_path: results
2024-03-17 02:53:59,463 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-17 02:53:59,463 - model_path: models
2024-03-17 02:53:59,463 - config_file_name: mag_bert_MIntRec2
2024-03-17 02:53:59,463 - results_file_name: mag_bert.csv
2024-03-17 02:53:59,463 - padding_mode: zero
2024-03-17 02:53:59,463 - padding_loc: end
2024-03-17 02:53:59,463 - need_aligned: True
2024-03-17 02:53:59,463 - eval_monitor: f1
2024-03-17 02:53:59,463 - train_batch_size: 32
2024-03-17 02:53:59,463 - eval_batch_size: 16
2024-03-17 02:53:59,463 - test_batch_size: 16
2024-03-17 02:53:59,463 - wait_patience: 8
2024-03-17 02:53:59,463 - num_train_epochs: 100
2024-03-17 02:53:59,464 - beta_shift: 0.01
2024-03-17 02:53:59,464 - dropout_prob: 0.3
2024-03-17 02:53:59,464 - warmup_proportion: 0.1
2024-03-17 02:53:59,464 - lr: 9e-06
2024-03-17 02:53:59,464 - aligned_method: conv1d
2024-03-17 02:53:59,464 - weight_decay: 0.03
2024-03-17 02:53:59,464 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-02-53-59
2024-03-17 02:53:59,464 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-02-53-59/models
2024-03-17 02:53:59,464 - num_labels: 30
2024-03-17 02:53:59,464 - text_feat_dim: 768
2024-03-17 02:53:59,464 - video_feat_dim: 256
2024-03-17 02:53:59,464 - audio_feat_dim: 768
2024-03-17 02:53:59,464 - text_seq_len: 50
2024-03-17 02:53:59,464 - video_seq_len: 180
2024-03-17 02:53:59,464 - audio_seq_len: 400
2024-03-17 02:53:59,464 - device: cuda:2
2024-03-17 02:53:59,464 - ============================== End Params ==============================
2024-03-17 02:53:59,479 - Generate Text Features Begin...
2024-03-17 02:54:01,385 - Generate Text Features Finished...
2024-03-17 02:54:01,386 - Load Video Features Begin...
2024-03-17 02:54:02,503 - Load Video Features Finished...
2024-03-17 02:54:04,180 - Load Audio Features Begin...
2024-03-17 02:54:08,103 - Load Audio Features Finished...
2024-03-17 02:54:26,808 - method  begins...
2024-03-17 02:54:27,696 - Multimodal intent recognition begins...
2024-03-17 02:54:27,696 - Training begins...
2024-03-17 02:55:05,044 - ***** Epoch: 1: Eval results *****
2024-03-17 02:55:05,044 -   train_loss = 3.4019
2024-03-17 02:55:05,045 -   best_eval_score = 0.0
2024-03-17 02:55:05,045 -   eval_score = 0.0345
2024-03-17 02:55:43,003 - ***** Epoch: 2: Eval results *****
2024-03-17 02:55:43,003 -   train_loss = 3.1752
2024-03-17 02:55:43,003 -   best_eval_score = 0.0345
2024-03-17 02:55:43,003 -   eval_score = 0.1089
2024-03-17 02:56:21,973 - ***** Epoch: 3: Eval results *****
2024-03-17 02:56:21,974 -   train_loss = 2.8078
2024-03-17 02:56:21,974 -   best_eval_score = 0.1089
2024-03-17 02:56:21,974 -   eval_score = 0.1746
2024-03-17 02:57:00,846 - ***** Epoch: 4: Eval results *****
2024-03-17 02:57:00,847 -   train_loss = 2.4308
2024-03-17 02:57:00,847 -   best_eval_score = 0.1746
2024-03-17 02:57:00,847 -   eval_score = 0.2666
2024-03-17 02:57:38,775 - ***** Epoch: 5: Eval results *****
2024-03-17 02:57:38,775 -   train_loss = 2.1125
2024-03-17 02:57:38,775 -   best_eval_score = 0.2666
2024-03-17 02:57:38,775 -   eval_score = 0.3178
2024-03-17 02:58:12,110 - ***** Epoch: 6: Eval results *****
2024-03-17 02:58:12,111 -   train_loss = 1.8673
2024-03-17 02:58:12,111 -   best_eval_score = 0.3178
2024-03-17 02:58:12,111 -   eval_score = 0.3564
2024-03-17 02:58:50,551 - ***** Epoch: 7: Eval results *****
2024-03-17 02:58:50,551 -   train_loss = 1.669
2024-03-17 02:58:50,552 -   best_eval_score = 0.3564
2024-03-17 02:58:50,552 -   eval_score = 0.3777
2024-03-17 02:59:26,362 - ***** Epoch: 8: Eval results *****
2024-03-17 02:59:26,363 -   train_loss = 1.5
2024-03-17 02:59:26,363 -   best_eval_score = 0.3777
2024-03-17 02:59:26,363 -   eval_score = 0.4087
2024-03-17 03:00:04,927 - ***** Epoch: 9: Eval results *****
2024-03-17 03:00:04,927 -   train_loss = 1.3499
2024-03-17 03:00:04,927 -   best_eval_score = 0.4087
2024-03-17 03:00:04,927 -   eval_score = 0.4145
2024-03-17 03:00:42,545 - ***** Epoch: 10: Eval results *****
2024-03-17 03:00:42,546 -   train_loss = 1.2144
2024-03-17 03:00:42,547 -   best_eval_score = 0.4145
2024-03-17 03:00:42,547 -   eval_score = 0.4268
2024-03-17 03:01:18,028 - ***** Epoch: 11: Eval results *****
2024-03-17 03:01:18,028 -   train_loss = 1.0801
2024-03-17 03:01:18,028 -   best_eval_score = 0.4268
2024-03-17 03:01:18,028 -   eval_score = 0.4446
2024-03-17 03:01:54,767 - ***** Epoch: 12: Eval results *****
2024-03-17 03:01:54,767 -   train_loss = 0.9448
2024-03-17 03:01:54,767 -   best_eval_score = 0.4446
2024-03-17 03:01:54,767 -   eval_score = 0.4762
2024-03-17 03:02:29,571 - ***** Epoch: 13: Eval results *****
2024-03-17 03:02:29,572 -   train_loss = 0.828
2024-03-17 03:02:29,572 -   best_eval_score = 0.4762
2024-03-17 03:02:29,572 -   eval_score = 0.4784
2024-03-17 03:03:07,873 - ***** Epoch: 14: Eval results *****
2024-03-17 03:03:07,874 -   train_loss = 0.7222
2024-03-17 03:03:07,874 -   best_eval_score = 0.4784
2024-03-17 03:03:07,874 -   eval_score = 0.4745
2024-03-17 03:03:07,874 - EarlyStopping counter: 1 out of 8
2024-03-17 03:03:41,411 - ***** Epoch: 15: Eval results *****
2024-03-17 03:03:41,412 -   train_loss = 0.6212
2024-03-17 03:03:41,412 -   best_eval_score = 0.4784
2024-03-17 03:03:41,413 -   eval_score = 0.4925
2024-03-17 03:04:18,783 - ***** Epoch: 16: Eval results *****
2024-03-17 03:04:18,783 -   train_loss = 0.5473
2024-03-17 03:04:18,783 -   best_eval_score = 0.4925
2024-03-17 03:04:18,783 -   eval_score = 0.4959
2024-03-17 03:04:55,825 - ***** Epoch: 17: Eval results *****
2024-03-17 03:04:55,825 -   train_loss = 0.4862
2024-03-17 03:04:55,826 -   best_eval_score = 0.4959
2024-03-17 03:04:55,826 -   eval_score = 0.4915
2024-03-17 03:04:55,826 - EarlyStopping counter: 1 out of 8
2024-03-17 03:05:32,513 - ***** Epoch: 18: Eval results *****
2024-03-17 03:05:32,513 -   train_loss = 0.419
2024-03-17 03:05:32,513 -   best_eval_score = 0.4959
2024-03-17 03:05:32,513 -   eval_score = 0.4861
2024-03-17 03:05:32,513 - EarlyStopping counter: 2 out of 8
2024-03-17 03:06:04,235 - ***** Epoch: 19: Eval results *****
2024-03-17 03:06:04,236 -   train_loss = 0.3686
2024-03-17 03:06:04,237 -   best_eval_score = 0.4959
2024-03-17 03:06:04,237 -   eval_score = 0.484
2024-03-17 03:06:04,237 - EarlyStopping counter: 3 out of 8
2024-03-17 03:06:40,473 - ***** Epoch: 20: Eval results *****
2024-03-17 03:06:40,473 -   train_loss = 0.3287
2024-03-17 03:06:40,473 -   best_eval_score = 0.4959
2024-03-17 03:06:40,474 -   eval_score = 0.4818
2024-03-17 03:06:40,474 - EarlyStopping counter: 4 out of 8
2024-03-17 03:07:15,265 - ***** Epoch: 21: Eval results *****
2024-03-17 03:07:15,265 -   train_loss = 0.2831
2024-03-17 03:07:15,265 -   best_eval_score = 0.4959
2024-03-17 03:07:15,265 -   eval_score = 0.4871
2024-03-17 03:07:15,265 - EarlyStopping counter: 5 out of 8
2024-03-17 03:07:52,684 - ***** Epoch: 22: Eval results *****
2024-03-17 03:07:52,684 -   train_loss = 0.2568
2024-03-17 03:07:52,685 -   best_eval_score = 0.4959
2024-03-17 03:07:52,685 -   eval_score = 0.4812
2024-03-17 03:07:52,685 - EarlyStopping counter: 6 out of 8
2024-03-17 03:08:28,521 - ***** Epoch: 23: Eval results *****
2024-03-17 03:08:28,522 -   train_loss = 0.2296
2024-03-17 03:08:28,522 -   best_eval_score = 0.4959
2024-03-17 03:08:28,522 -   eval_score = 0.4913
2024-03-17 03:08:28,522 - EarlyStopping counter: 7 out of 8
2024-03-17 03:09:08,784 - ***** Epoch: 24: Eval results *****
2024-03-17 03:09:08,784 -   train_loss = 0.2058
2024-03-17 03:09:08,785 -   best_eval_score = 0.4959
2024-03-17 03:09:08,785 -   eval_score = 0.4983
2024-03-17 03:09:47,850 - ***** Epoch: 25: Eval results *****
2024-03-17 03:09:47,850 -   train_loss = 0.182
2024-03-17 03:09:47,850 -   best_eval_score = 0.4983
2024-03-17 03:09:47,850 -   eval_score = 0.4954
2024-03-17 03:09:47,850 - EarlyStopping counter: 1 out of 8
2024-03-17 03:10:22,053 - ***** Epoch: 26: Eval results *****
2024-03-17 03:10:22,053 -   train_loss = 0.1647
2024-03-17 03:10:22,053 -   best_eval_score = 0.4983
2024-03-17 03:10:22,053 -   eval_score = 0.4919
2024-03-17 03:10:22,053 - EarlyStopping counter: 2 out of 8
2024-03-17 03:10:56,709 - ***** Epoch: 27: Eval results *****
2024-03-17 03:10:56,710 -   train_loss = 0.1525
2024-03-17 03:10:56,710 -   best_eval_score = 0.4983
2024-03-17 03:10:56,710 -   eval_score = 0.4888
2024-03-17 03:10:56,710 - EarlyStopping counter: 3 out of 8
2024-03-17 03:11:32,436 - ***** Epoch: 28: Eval results *****
2024-03-17 03:11:32,436 -   train_loss = 0.1407
2024-03-17 03:11:32,437 -   best_eval_score = 0.4983
2024-03-17 03:11:32,437 -   eval_score = 0.4945
2024-03-17 03:11:32,437 - EarlyStopping counter: 4 out of 8
2024-03-17 03:12:07,010 - ***** Epoch: 29: Eval results *****
2024-03-17 03:12:07,010 -   train_loss = 0.1245
2024-03-17 03:12:07,010 -   best_eval_score = 0.4983
2024-03-17 03:12:07,011 -   eval_score = 0.5008
2024-03-17 03:12:43,421 - ***** Epoch: 30: Eval results *****
2024-03-17 03:12:43,421 -   train_loss = 0.117
2024-03-17 03:12:43,421 -   best_eval_score = 0.5008
2024-03-17 03:12:43,421 -   eval_score = 0.486
2024-03-17 03:12:43,421 - EarlyStopping counter: 1 out of 8
2024-03-17 03:13:22,118 - ***** Epoch: 31: Eval results *****
2024-03-17 03:13:22,119 -   train_loss = 0.1102
2024-03-17 03:13:22,119 -   best_eval_score = 0.5008
2024-03-17 03:13:22,120 -   eval_score = 0.5002
2024-03-17 03:13:22,120 - EarlyStopping counter: 2 out of 8
2024-03-17 03:13:54,590 - ***** Epoch: 32: Eval results *****
2024-03-17 03:13:54,590 -   train_loss = 0.0992
2024-03-17 03:13:54,590 -   best_eval_score = 0.5008
2024-03-17 03:13:54,590 -   eval_score = 0.5082
2024-03-17 03:14:32,039 - ***** Epoch: 33: Eval results *****
2024-03-17 03:14:32,039 -   train_loss = 0.0988
2024-03-17 03:14:32,039 -   best_eval_score = 0.5082
2024-03-17 03:14:32,039 -   eval_score = 0.5027
2024-03-17 03:14:32,039 - EarlyStopping counter: 1 out of 8
2024-03-17 03:15:06,315 - ***** Epoch: 34: Eval results *****
2024-03-17 03:15:06,316 -   train_loss = 0.0894
2024-03-17 03:15:06,316 -   best_eval_score = 0.5082
2024-03-17 03:15:06,316 -   eval_score = 0.4883
2024-03-17 03:15:06,316 - EarlyStopping counter: 2 out of 8
2024-03-17 03:15:42,808 - ***** Epoch: 35: Eval results *****
2024-03-17 03:15:42,809 -   train_loss = 0.0942
2024-03-17 03:15:42,810 -   best_eval_score = 0.5082
2024-03-17 03:15:42,810 -   eval_score = 0.4876
2024-03-17 03:15:42,810 - EarlyStopping counter: 3 out of 8
2024-03-17 03:16:16,964 - ***** Epoch: 36: Eval results *****
2024-03-17 03:16:16,964 -   train_loss = 0.0771
2024-03-17 03:16:16,964 -   best_eval_score = 0.5082
2024-03-17 03:16:16,964 -   eval_score = 0.5051
2024-03-17 03:16:16,964 - EarlyStopping counter: 4 out of 8
2024-03-17 03:16:52,070 - ***** Epoch: 37: Eval results *****
2024-03-17 03:16:52,070 -   train_loss = 0.0718
2024-03-17 03:16:52,071 -   best_eval_score = 0.5082
2024-03-17 03:16:52,071 -   eval_score = 0.4932
2024-03-17 03:16:52,071 - EarlyStopping counter: 5 out of 8
2024-03-17 03:17:29,112 - ***** Epoch: 38: Eval results *****
2024-03-17 03:17:29,112 -   train_loss = 0.0722
2024-03-17 03:17:29,112 -   best_eval_score = 0.5082
2024-03-17 03:17:29,112 -   eval_score = 0.4997
2024-03-17 03:17:29,112 - EarlyStopping counter: 6 out of 8
2024-03-17 03:18:03,962 - ***** Epoch: 39: Eval results *****
2024-03-17 03:18:03,963 -   train_loss = 0.0704
2024-03-17 03:18:03,963 -   best_eval_score = 0.5082
2024-03-17 03:18:03,963 -   eval_score = 0.5039
2024-03-17 03:18:03,963 - EarlyStopping counter: 7 out of 8
2024-03-17 03:18:41,503 - ***** Epoch: 40: Eval results *****
2024-03-17 03:18:41,503 -   train_loss = 0.065
2024-03-17 03:18:41,503 -   best_eval_score = 0.5082
2024-03-17 03:18:41,503 -   eval_score = 0.502
2024-03-17 03:18:41,503 - EarlyStopping counter: 8 out of 8
2024-03-17 03:18:41,503 - EarlyStopping at epoch 40
2024-03-17 03:18:41,505 - Training is finished...
2024-03-17 03:18:41,506 - Testing begins...
2024-03-17 03:18:50,919 - ***** Test: Confusion Matrix *****
2024-03-17 03:18:50,924 - [[ 47   0  15   0   0   0   0   0   1   1   2   0   0   0   0   0   0   0
    0   0   0   0   0   1   1   0   0   0   0   0]
 [  0  54   0   0   9   2   5   0   1   0   2   0   3   0   5   0   0  10
    1   0   0   0   0   0   1   1   0   3   0   0]
 [  8   1  42   0   1   0   0   0   0   0   1   0   0   1   0   1   0   4
    0   0   0   0   0   1   4   0   0   0   0   0]
 [  0   0   0  61   0   0   0   1   0   0   0   0   0   0   3   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   5   0   0  29   1   0   0   1   1   0   0   0   0   0   0   0   5
    0   1   0   1   0   2   1   2   0   0   1   1]
 [  0   0   0   0   1  23   0   1   0   1   2   0   0   0   1   1   0   4
    0   0   0   0   0   1   0   1   1   0   0   0]
 [  0   1   0   0   0   3  27   4   0   2   5   0   6   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   2   0   0   0   0   4  22   0   0   6   0   9   0   0   0   2   0
    0   0   0   0   0   0   0   0   0   2   0   0]
 [  1   3   1   3   1   0   0   0  21   0   0   2   1   1   1   0   0   5
    0   0   0   0   4   1   2   1   0   1   0   0]
 [  0   1   1   0   1   0   0   0   1  46   0   5   9   3  17   0   0   5
    3   0   0   3   3   3   2   1   0   3   0   0]
 [  2   0   0   0   0   2   2   0   0   1  47   0  32   0   2   0   0   2
    0   2   0   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   0   5   0  17   8   1   3   0   0   2
    0   0   2   0   2   0   0   0   0   5   0   2]
 [  0   1   3   0   0   1   3   4   0   4  24   2  88   0   0   0   3   0
    0   0   0   0   1   0   0   0   0   1   0   0]
 [  0   0   2   0   0   0   0   0   1   1   0   0   0   0   5   1   0   5
    1   0   1   0   0   0   0   0   0   0   0   0]
 [  0   2   1   0   0   1   2   0   3   7   2   0   2   3 105   2   0  36
    5   0   2   0  10   0   3   0   3   4   0   0]
 [  0   0   0   0   0   0   0   0   0   4   0   0   0   1   2   6   0   2
    2   0   1   1   1   0   0   0   0   1   1   0]
 [  0   0   0   0   1   0   1   2   0   0   0   0   3   0   0   0  57   0
    2   0   0   0   0   0   0   0   0   0   0   0]
 [  1   3   2   0   6   3   0   0   3  11   2   0   0   3  19   2   1 113
    8   1   3   6   7  12   0   1   1   2   1   6]
 [  0   2   0   0   0   0   1   0   1   3   1   0   0   1   4   3   3  12
   25   0   2   0   1   0   1   0   0   0   0   0]
 [  0   6   0   0   1   0   2   0   0   0   1   0   0   0   0   0   0   0
    0   5   0   2   0   0   0   0   0   0   0   0]
 [  0   1   2   0   1   0   0   0   0   0   0   1   1   0   5   2   0   4
    4   0   3   0   1   1   1   0   0   2   0   0]
 [  6   1   1   0   1   0   0   0   0   2   0   1   0   0   1   0   4   0
    0   1   1  23   1   6   0   0   1   2   0   1]
 [  0   0   0   1   0   0   0   0   1   3   0   2   0   1   6   0   0   7
    0   0   1   1  85   0   1   3   5   0   0   0]
 [  0   2   2   0   1   0   0   0   0   2   0   0   0   0   0   0   0   8
    0   0   0   1   0  22   0   0   0   0   0   0]
 [  2   0   3   0   0   0   1   0   2   1   0   2   0   0   2   1   0   2
    0   0   0   1   1   1  83   0   0   9   2   0]
 [  2   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1
    0   0   0   0   3   0   1  21   1   0   0   2]
 [  0   0   0   1   0   0   0   0   0   2   0   0   0   0   0   0   0   2
    0   0   0   2   3   1   0   0   4   0   2   0]
 [  1   3   1   0   0   0   0   1   3   4   2   5   3   0   5   0   0   2
    1   0   0   0   2   0   8   1   0  13   1   2]
 [  0   0   0   0   0   0   0   0   0   1   0   0   0   0   0   0   1   0
    0   0   0   0   0   0   0   0   0   0  56   0]
 [  0   1   0   0   0   0   0   0   1   1   1   1   0   0   0   0   0   3
    1   0   1   0   0   0   1   2   0   1   0   5]]
2024-03-17 03:18:50,924 - ***** Evaluation results *****
2024-03-17 03:18:50,924 -   acc = 0.5657
2024-03-17 03:18:50,924 -   f1 = 0.5109
2024-03-17 03:18:50,924 -   prec = 0.5187
2024-03-17 03:18:50,924 -   rec = 0.5099
2024-03-17 03:18:50,925 - Testing is finished...
2024-03-17 03:18:50,925 - Multimodal intent recognition is finished...
2024-03-17 03:18:50,925 - Results are saved in results/mag_bert.csv
