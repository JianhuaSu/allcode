2024-07-21 18:47:56,603 - ============================== Params ==============================
2024-07-21 18:47:56,603 - logger_name: mmim_MIntRec_multi-class_seed-5
2024-07-21 18:47:56,603 - dataset: MIntRec
2024-07-21 18:47:56,603 - data_mode: multi-class
2024-07-21 18:47:56,603 - method: mmim
2024-07-21 18:47:56,603 - text_backbone: bert-base-uncased
2024-07-21 18:47:56,603 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-07-21 18:47:56,603 - seed: 5
2024-07-21 18:47:56,603 - num_workers: 8
2024-07-21 18:47:56,603 - gpu_id: 0
2024-07-21 18:47:56,603 - data_path: /home/sharing/disk1/zhanghanlei/Datasets/public
2024-07-21 18:47:56,603 - train: True
2024-07-21 18:47:56,603 - tune: True
2024-07-21 18:47:56,603 - save_model: False
2024-07-21 18:47:56,603 - save_results: True
2024-07-21 18:47:56,603 - log_path: logs
2024-07-21 18:47:56,603 - cache_path: 
2024-07-21 18:47:56,603 - video_data_path: video_data
2024-07-21 18:47:56,603 - audio_data_path: audio_data
2024-07-21 18:47:56,603 - video_feats_path: video_feats.pkl
2024-07-21 18:47:56,603 - audio_feats_path: audio_feats.pkl
2024-07-21 18:47:56,603 - results_path: results
2024-07-21 18:47:56,603 - output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ_1/outputs/MIntRec
2024-07-21 18:47:56,603 - model_path: models
2024-07-21 18:47:56,603 - config_file_name: mmim_bert_MIntRec
2024-07-21 18:47:56,603 - results_file_name: mmim_bert_MIntRec.csv
2024-07-21 18:47:56,604 - ablation: none
2024-07-21 18:47:56,604 - padding_mode: zero
2024-07-21 18:47:56,604 - padding_loc: end
2024-07-21 18:47:56,604 - need_aligned: False
2024-07-21 18:47:56,604 - eval_monitor: f1
2024-07-21 18:47:56,604 - train_batch_size: 16
2024-07-21 18:47:56,604 - eval_batch_size: 8
2024-07-21 18:47:56,604 - test_batch_size: 8
2024-07-21 18:47:56,604 - wait_patience: 8
2024-07-21 18:47:56,604 - num_train_epochs: 100
2024-07-21 18:47:56,604 - add_va: False
2024-07-21 18:47:56,604 - cpc_activation: Tanh
2024-07-21 18:47:56,604 - mmilb_mid_activation: ReLU
2024-07-21 18:47:56,604 - mmilb_last_activation: Tanh
2024-07-21 18:47:56,604 - optim: Adam
2024-07-21 18:47:56,604 - contrast: True
2024-07-21 18:47:56,604 - bidirectional: True
2024-07-21 18:47:56,604 - grad_clip: 1.0
2024-07-21 18:47:56,604 - lr_main: 0.0001
2024-07-21 18:47:56,604 - weight_decay_main: 0.0001
2024-07-21 18:47:56,604 - lr_bert: 4e-05
2024-07-21 18:47:56,604 - weight_decay_bert: 8e-05
2024-07-21 18:47:56,604 - lr_mmilb: 0.001
2024-07-21 18:47:56,604 - weight_decay_mmilb: 0.0001
2024-07-21 18:47:56,604 - alpha: 0.1
2024-07-21 18:47:56,604 - dropout_a: 0.1
2024-07-21 18:47:56,604 - dropout_v: 0.1
2024-07-21 18:47:56,604 - dropout_prj: 0.1
2024-07-21 18:47:56,604 - n_layer: 1
2024-07-21 18:47:56,604 - cpc_layers: 1
2024-07-21 18:47:56,604 - d_vh: 32
2024-07-21 18:47:56,604 - d_ah: 32
2024-07-21 18:47:56,604 - d_vout: 16
2024-07-21 18:47:56,604 - d_aout: 16
2024-07-21 18:47:56,604 - d_prjh: 512
2024-07-21 18:47:56,604 - scale: 20
2024-07-21 18:47:56,604 - beta: 0.5
2024-07-21 18:47:56,604 - pred_output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ_1/outputs/MIntRec/mmim_MIntRec_multi-class_seed-5
2024-07-21 18:47:56,604 - model_output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ_1/outputs/MIntRec/mmim_MIntRec_multi-class_seed-5/models
2024-07-21 18:47:56,604 - ============================== End Params ==============================
2024-07-21 18:47:56,607 - Generate Text Features Begin...
2024-07-21 18:47:57,271 - Generate Text Features Finished...
2024-07-21 18:47:57,271 - Load Video Features Begin...
2024-07-21 18:47:57,705 - Load Video Features Finished...
2024-07-21 18:47:58,605 - Load Audio Features Begin...
2024-07-21 18:47:59,973 - Load Audio Features Finished...
2024-07-21 18:48:05,397 - method  begins...
2024-07-21 18:48:09,688 - Multimodal intent recognition begins...
2024-07-21 18:48:09,688 - Training begins...
2024-07-21 18:48:38,787 - ***** Epoch: 1: Eval results *****
2024-07-21 18:48:38,788 -   best_eval_score = 0.0
2024-07-21 18:48:38,788 -   eval_score = 0.5768
2024-07-21 18:48:38,788 -   train_loss_main = 2.5842
2024-07-21 18:48:38,788 -   train_loss_mmilb = 0.5291
2024-07-21 18:49:06,737 - ***** Epoch: 2: Eval results *****
2024-07-21 18:49:06,737 -   best_eval_score = 0.5768
2024-07-21 18:49:06,737 -   eval_score = 0.6471
2024-07-21 18:49:06,737 -   train_loss_main = 1.4204
2024-07-21 18:49:06,737 -   train_loss_mmilb = 0.0055
2024-07-21 18:49:34,999 - ***** Epoch: 3: Eval results *****
2024-07-21 18:49:35,000 -   best_eval_score = 0.6471
2024-07-21 18:49:35,000 -   eval_score = 0.6826
2024-07-21 18:49:35,000 -   train_loss_main = 0.9981
2024-07-21 18:49:35,000 -   train_loss_mmilb = 0.0015
2024-07-21 18:50:03,305 - ***** Epoch: 4: Eval results *****
2024-07-21 18:50:03,305 -   best_eval_score = 0.6826
2024-07-21 18:50:03,306 -   eval_score = 0.6553
2024-07-21 18:50:03,306 -   train_loss_main = 0.8425
2024-07-21 18:50:03,306 -   train_loss_mmilb = 0.001
2024-07-21 18:50:03,306 - EarlyStopping counter: 1 out of 8
2024-07-21 18:50:31,943 - ***** Epoch: 5: Eval results *****
2024-07-21 18:50:31,944 -   best_eval_score = 0.6826
2024-07-21 18:50:31,944 -   eval_score = 0.7016
2024-07-21 18:50:31,944 -   train_loss_main = 0.7661
2024-07-21 18:50:31,945 -   train_loss_mmilb = 0.0007
2024-07-21 18:51:00,513 - ***** Epoch: 6: Eval results *****
2024-07-21 18:51:00,513 -   best_eval_score = 0.7016
2024-07-21 18:51:00,514 -   eval_score = 0.6616
2024-07-21 18:51:00,514 -   train_loss_main = 0.7487
2024-07-21 18:51:00,514 -   train_loss_mmilb = 0.0006
2024-07-21 18:51:00,514 - EarlyStopping counter: 1 out of 8
2024-07-21 18:51:26,274 - ***** Epoch: 7: Eval results *****
2024-07-21 18:51:26,274 -   best_eval_score = 0.7016
2024-07-21 18:51:26,274 -   eval_score = 0.6822
2024-07-21 18:51:26,274 -   train_loss_main = 0.7294
2024-07-21 18:51:26,274 -   train_loss_mmilb = 0.0005
2024-07-21 18:51:26,274 - EarlyStopping counter: 2 out of 8
2024-07-21 18:51:56,294 - ***** Epoch: 8: Eval results *****
2024-07-21 18:51:56,294 -   best_eval_score = 0.7016
2024-07-21 18:51:56,294 -   eval_score = 0.6878
2024-07-21 18:51:56,294 -   train_loss_main = 0.6905
2024-07-21 18:51:56,294 -   train_loss_mmilb = 0.0006
2024-07-21 18:51:56,295 - EarlyStopping counter: 3 out of 8
2024-07-21 18:52:26,176 - ***** Epoch: 9: Eval results *****
2024-07-21 18:52:26,176 -   best_eval_score = 0.7016
2024-07-21 18:52:26,176 -   eval_score = 0.6656
2024-07-21 18:52:26,176 -   train_loss_main = 0.6695
2024-07-21 18:52:26,177 -   train_loss_mmilb = 0.0005
2024-07-21 18:52:26,177 - EarlyStopping counter: 4 out of 8
2024-07-21 18:52:51,220 - ***** Epoch: 10: Eval results *****
2024-07-21 18:52:51,220 -   best_eval_score = 0.7016
2024-07-21 18:52:51,220 -   eval_score = 0.672
2024-07-21 18:52:51,220 -   train_loss_main = 0.6561
2024-07-21 18:52:51,220 -   train_loss_mmilb = 0.0005
2024-07-21 18:52:51,220 - EarlyStopping counter: 5 out of 8
2024-07-21 18:53:21,310 - ***** Epoch: 11: Eval results *****
2024-07-21 18:53:21,310 -   best_eval_score = 0.7016
2024-07-21 18:53:21,315 -   eval_score = 0.6694
2024-07-21 18:53:21,315 -   train_loss_main = 0.6414
2024-07-21 18:53:21,315 -   train_loss_mmilb = 0.0004
2024-07-21 18:53:21,315 - EarlyStopping counter: 6 out of 8
2024-07-21 18:53:51,472 - ***** Epoch: 12: Eval results *****
2024-07-21 18:53:51,472 -   best_eval_score = 0.7016
2024-07-21 18:53:51,472 -   eval_score = 0.7045
2024-07-21 18:53:51,472 -   train_loss_main = 0.6291
2024-07-21 18:53:51,472 -   train_loss_mmilb = 0.0004
2024-07-21 18:54:17,219 - ***** Epoch: 13: Eval results *****
2024-07-21 18:54:17,219 -   best_eval_score = 0.7045
2024-07-21 18:54:17,219 -   eval_score = 0.6935
2024-07-21 18:54:17,220 -   train_loss_main = 0.6197
2024-07-21 18:54:17,220 -   train_loss_mmilb = 0.0004
2024-07-21 18:54:17,220 - EarlyStopping counter: 1 out of 8
2024-07-21 18:54:47,016 - ***** Epoch: 14: Eval results *****
2024-07-21 18:54:47,016 -   best_eval_score = 0.7045
2024-07-21 18:54:47,016 -   eval_score = 0.6851
2024-07-21 18:54:47,016 -   train_loss_main = 0.6219
2024-07-21 18:54:47,016 -   train_loss_mmilb = 0.0004
2024-07-21 18:54:47,016 - EarlyStopping counter: 2 out of 8
2024-07-21 18:55:17,540 - ***** Epoch: 15: Eval results *****
2024-07-21 18:55:17,540 -   best_eval_score = 0.7045
2024-07-21 18:55:17,540 -   eval_score = 0.686
2024-07-21 18:55:17,541 -   train_loss_main = 0.6088
2024-07-21 18:55:17,541 -   train_loss_mmilb = 0.0004
2024-07-21 18:55:17,541 - EarlyStopping counter: 3 out of 8
2024-07-21 18:55:44,396 - ***** Epoch: 16: Eval results *****
2024-07-21 18:55:44,396 -   best_eval_score = 0.7045
2024-07-21 18:55:44,396 -   eval_score = 0.7014
2024-07-21 18:55:44,396 -   train_loss_main = 0.6061
2024-07-21 18:55:44,396 -   train_loss_mmilb = 0.0004
2024-07-21 18:55:44,396 - EarlyStopping counter: 4 out of 8
2024-07-21 18:56:12,152 - ***** Epoch: 17: Eval results *****
2024-07-21 18:56:12,152 -   best_eval_score = 0.7045
2024-07-21 18:56:12,152 -   eval_score = 0.6853
2024-07-21 18:56:12,153 -   train_loss_main = 0.6058
2024-07-21 18:56:12,153 -   train_loss_mmilb = 0.0004
2024-07-21 18:56:12,153 - EarlyStopping counter: 5 out of 8
2024-07-21 18:56:42,487 - ***** Epoch: 18: Eval results *****
2024-07-21 18:56:42,487 -   best_eval_score = 0.7045
2024-07-21 18:56:42,487 -   eval_score = 0.7024
2024-07-21 18:56:42,487 -   train_loss_main = 0.6025
2024-07-21 18:56:42,487 -   train_loss_mmilb = 0.0004
2024-07-21 18:56:42,487 - EarlyStopping counter: 6 out of 8
2024-07-21 18:57:11,860 - ***** Epoch: 19: Eval results *****
2024-07-21 18:57:11,861 -   best_eval_score = 0.7045
2024-07-21 18:57:11,861 -   eval_score = 0.6938
2024-07-21 18:57:11,861 -   train_loss_main = 0.6027
2024-07-21 18:57:11,861 -   train_loss_mmilb = 0.0004
2024-07-21 18:57:11,861 - EarlyStopping counter: 7 out of 8
2024-07-21 18:57:38,518 - ***** Epoch: 20: Eval results *****
2024-07-21 18:57:38,519 -   best_eval_score = 0.7045
2024-07-21 18:57:38,519 -   eval_score = 0.6879
2024-07-21 18:57:38,519 -   train_loss_main = 0.6011
2024-07-21 18:57:38,519 -   train_loss_mmilb = 0.0004
2024-07-21 18:57:38,519 - EarlyStopping counter: 8 out of 8
2024-07-21 18:57:38,519 - EarlyStopping at epoch 20
2024-07-21 18:57:38,562 - Training is finished...
2024-07-21 18:57:38,562 - Testing begins...
2024-07-21 18:57:42,360 - ***** Test: Confusion Matrix *****
2024-07-21 18:57:42,362 - [[28  0  0  0 14  0  2  0  1  3  1  0  6  1  0  1  0  0  0  0]
 [ 0 35  0  1  0  2  1  0  1  0  1  0  2  0  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 17  0  2  0  0  1  0  1  0  1  1  0  0  0  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  2  0  1  0  3  0  0  0  1  0  0  2  1  0  0  0]
 [ 2  0  0  0  0  0  0  6  1  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  5  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  3  0  0  0  0  0  3  0  2  0  1]
 [ 1  0  0  0  0  0  2  0  0  2 12  0  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  0  1]
 [ 3  2  0  0  1  0  0  2  0  0  1  0 37  2  3  1  0  0  1  4]
 [ 0  0  0  0  0  0  1  0  0  0  1  1  0 20  1  0  0  0  0  1]
 [ 0  0  0  0  1  0  0  0  0  0  0  0  0  2 14  0  1  0  0  4]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  6  0  0 14  0  0  0  1]
 [ 1  0  0  0  0  0  0  0  1  0  0  0  1  0  2  0 11  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0 13  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0 10  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0  0  8]]
2024-07-21 18:57:42,362 - ***** Evaluation results *****
2024-07-21 18:57:42,362 -   acc = 0.7034
2024-07-21 18:57:42,362 -   f1 = 0.6771
2024-07-21 18:57:42,362 -   prec = 0.6737
2024-07-21 18:57:42,362 -   rec = 0.6956
2024-07-21 18:57:42,363 - Testing is finished...
2024-07-21 18:57:42,363 - Multimodal intent recognition is finished...
2024-07-21 18:57:42,363 - Results are saved in results/mmim_bert_MIntRec.csv
