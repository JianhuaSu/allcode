2024-03-18 03:09:45,574 - ============================== Params ==============================
2024-03-18 03:09:45,574 - logger_name: mag_bert_MIntRec2_multi-class_seed-5_2024-03-18-03-09-45
2024-03-18 03:09:45,574 - dataset: MIntRec2
2024-03-18 03:09:45,575 - data_mode: multi-class
2024-03-18 03:09:45,575 - method: mag_bert
2024-03-18 03:09:45,575 - text_backbone: bert-base-uncased
2024-03-18 03:09:45,575 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-18 03:09:45,575 - seed: 5
2024-03-18 03:09:45,575 - num_workers: 8
2024-03-18 03:09:45,575 - gpu_id: 2
2024-03-18 03:09:45,575 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-18 03:09:45,575 - train: True
2024-03-18 03:09:45,575 - tune: True
2024-03-18 03:09:45,575 - save_model: False
2024-03-18 03:09:45,575 - save_results: True
2024-03-18 03:09:45,575 - log_path: logs
2024-03-18 03:09:45,575 - cache_path: 
2024-03-18 03:09:45,575 - video_data_path: video_data
2024-03-18 03:09:45,575 - audio_data_path: audio_data
2024-03-18 03:09:45,575 - video_feats_path: video_feats.pkl
2024-03-18 03:09:45,575 - audio_feats_path: audio_feats.pkl
2024-03-18 03:09:45,575 - results_path: results
2024-03-18 03:09:45,575 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-18 03:09:45,575 - model_path: models
2024-03-18 03:09:45,575 - config_file_name: mag_bert_MIntRec2
2024-03-18 03:09:45,575 - results_file_name: mag_bert.csv
2024-03-18 03:09:45,575 - padding_mode: zero
2024-03-18 03:09:45,575 - padding_loc: end
2024-03-18 03:09:45,575 - need_aligned: True
2024-03-18 03:09:45,575 - eval_monitor: f1
2024-03-18 03:09:45,575 - train_batch_size: 32
2024-03-18 03:09:45,575 - eval_batch_size: 16
2024-03-18 03:09:45,575 - test_batch_size: 16
2024-03-18 03:09:45,575 - wait_patience: 8
2024-03-18 03:09:45,575 - num_train_epochs: 100
2024-03-18 03:09:45,575 - beta_shift: 0.01
2024-03-18 03:09:45,575 - dropout_prob: 0.5
2024-03-18 03:09:45,575 - warmup_proportion: 0.01
2024-03-18 03:09:45,575 - lr: 3e-05
2024-03-18 03:09:45,575 - aligned_method: conv1d
2024-03-18 03:09:45,575 - weight_decay: 0.01
2024-03-18 03:09:45,575 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-5_2024-03-18-03-09-45
2024-03-18 03:09:45,575 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-5_2024-03-18-03-09-45/models
2024-03-18 03:09:45,575 - ============================== End Params ==============================
2024-03-18 03:09:46,405 - Generate Text Features Begin...
2024-03-18 03:09:48,301 - Generate Text Features Finished...
2024-03-18 03:09:48,302 - Load Video Features Begin...
2024-03-18 03:13:11,859 - Load Video Features Finished...
2024-03-18 03:13:13,702 - Load Audio Features Begin...
2024-03-18 03:19:20,040 - Load Audio Features Finished...
2024-03-18 03:19:34,062 - method  begins...
2024-03-18 03:19:43,605 - Multimodal intent recognition begins...
2024-03-18 03:19:43,605 - Training begins...
2024-03-18 03:20:19,284 - ***** Epoch: 1: Eval results *****
2024-03-18 03:20:19,284 -   train_loss = 2.627
2024-03-18 03:20:19,284 -   best_eval_score = 0.0
2024-03-18 03:20:19,285 -   eval_score = 0.3528
2024-03-18 03:20:52,076 - ***** Epoch: 2: Eval results *****
2024-03-18 03:20:52,077 -   train_loss = 1.6326
2024-03-18 03:20:52,077 -   best_eval_score = 0.3528
2024-03-18 03:20:52,077 -   eval_score = 0.4344
2024-03-18 03:21:24,832 - ***** Epoch: 3: Eval results *****
2024-03-18 03:21:24,833 -   train_loss = 1.2343
2024-03-18 03:21:24,833 -   best_eval_score = 0.4344
2024-03-18 03:21:24,833 -   eval_score = 0.4534
2024-03-18 03:21:58,233 - ***** Epoch: 4: Eval results *****
2024-03-18 03:21:58,233 -   train_loss = 0.9535
2024-03-18 03:21:58,233 -   best_eval_score = 0.4534
2024-03-18 03:21:58,233 -   eval_score = 0.4707
2024-03-18 03:22:31,043 - ***** Epoch: 5: Eval results *****
2024-03-18 03:22:31,045 -   train_loss = 0.7013
2024-03-18 03:22:31,045 -   best_eval_score = 0.4707
2024-03-18 03:22:31,045 -   eval_score = 0.4995
2024-03-18 03:23:02,402 - ***** Epoch: 6: Eval results *****
2024-03-18 03:23:02,402 -   train_loss = 0.5288
2024-03-18 03:23:02,402 -   best_eval_score = 0.4995
2024-03-18 03:23:02,403 -   eval_score = 0.4924
2024-03-18 03:23:02,403 - EarlyStopping counter: 1 out of 8
2024-03-18 03:23:34,322 - ***** Epoch: 7: Eval results *****
2024-03-18 03:23:34,322 -   train_loss = 0.3768
2024-03-18 03:23:34,322 -   best_eval_score = 0.4995
2024-03-18 03:23:34,322 -   eval_score = 0.4982
2024-03-18 03:23:34,322 - EarlyStopping counter: 2 out of 8
2024-03-18 03:24:06,706 - ***** Epoch: 8: Eval results *****
2024-03-18 03:24:06,706 -   train_loss = 0.2787
2024-03-18 03:24:06,706 -   best_eval_score = 0.4995
2024-03-18 03:24:06,706 -   eval_score = 0.4907
2024-03-18 03:24:06,706 - EarlyStopping counter: 3 out of 8
2024-03-18 03:24:37,731 - ***** Epoch: 9: Eval results *****
2024-03-18 03:24:37,732 -   train_loss = 0.2135
2024-03-18 03:24:37,732 -   best_eval_score = 0.4995
2024-03-18 03:24:37,732 -   eval_score = 0.491
2024-03-18 03:24:37,732 - EarlyStopping counter: 4 out of 8
2024-03-18 03:25:09,243 - ***** Epoch: 10: Eval results *****
2024-03-18 03:25:09,244 -   train_loss = 0.1614
2024-03-18 03:25:09,244 -   best_eval_score = 0.4995
2024-03-18 03:25:09,244 -   eval_score = 0.4813
2024-03-18 03:25:09,244 - EarlyStopping counter: 5 out of 8
2024-03-18 03:25:40,755 - ***** Epoch: 11: Eval results *****
2024-03-18 03:25:40,756 -   train_loss = 0.1334
2024-03-18 03:25:40,756 -   best_eval_score = 0.4995
2024-03-18 03:25:40,756 -   eval_score = 0.4953
2024-03-18 03:25:40,756 - EarlyStopping counter: 6 out of 8
2024-03-18 03:26:12,507 - ***** Epoch: 12: Eval results *****
2024-03-18 03:26:12,507 -   train_loss = 0.1182
2024-03-18 03:26:12,507 -   best_eval_score = 0.4995
2024-03-18 03:26:12,507 -   eval_score = 0.5016
2024-03-18 03:26:45,847 - ***** Epoch: 13: Eval results *****
2024-03-18 03:26:45,848 -   train_loss = 0.1065
2024-03-18 03:26:45,848 -   best_eval_score = 0.5016
2024-03-18 03:26:45,848 -   eval_score = 0.513
2024-03-18 03:27:19,909 - ***** Epoch: 14: Eval results *****
2024-03-18 03:27:19,909 -   train_loss = 0.098
2024-03-18 03:27:19,909 -   best_eval_score = 0.513
2024-03-18 03:27:19,909 -   eval_score = 0.4961
2024-03-18 03:27:19,909 - EarlyStopping counter: 1 out of 8
2024-03-18 03:27:51,730 - ***** Epoch: 15: Eval results *****
2024-03-18 03:27:51,731 -   train_loss = 0.0935
2024-03-18 03:27:51,731 -   best_eval_score = 0.513
2024-03-18 03:27:51,731 -   eval_score = 0.4993
2024-03-18 03:27:51,731 - EarlyStopping counter: 2 out of 8
2024-03-18 03:28:26,737 - ***** Epoch: 16: Eval results *****
2024-03-18 03:28:26,737 -   train_loss = 0.0851
2024-03-18 03:28:26,737 -   best_eval_score = 0.513
2024-03-18 03:28:26,737 -   eval_score = 0.5157
2024-03-18 03:29:00,694 - ***** Epoch: 17: Eval results *****
2024-03-18 03:29:00,695 -   train_loss = 0.0803
2024-03-18 03:29:00,695 -   best_eval_score = 0.5157
2024-03-18 03:29:00,695 -   eval_score = 0.4897
2024-03-18 03:29:00,695 - EarlyStopping counter: 1 out of 8
2024-03-18 03:29:34,452 - ***** Epoch: 18: Eval results *****
2024-03-18 03:29:34,452 -   train_loss = 0.0703
2024-03-18 03:29:34,452 -   best_eval_score = 0.5157
2024-03-18 03:29:34,452 -   eval_score = 0.5041
2024-03-18 03:29:34,452 - EarlyStopping counter: 2 out of 8
2024-03-18 03:30:08,154 - ***** Epoch: 19: Eval results *****
2024-03-18 03:30:08,154 -   train_loss = 0.0738
2024-03-18 03:30:08,154 -   best_eval_score = 0.5157
2024-03-18 03:30:08,154 -   eval_score = 0.4838
2024-03-18 03:30:08,155 - EarlyStopping counter: 3 out of 8
2024-03-18 03:30:42,397 - ***** Epoch: 20: Eval results *****
2024-03-18 03:30:42,406 -   train_loss = 0.0736
2024-03-18 03:30:42,406 -   best_eval_score = 0.5157
2024-03-18 03:30:42,406 -   eval_score = 0.4907
2024-03-18 03:30:42,406 - EarlyStopping counter: 4 out of 8
2024-03-18 03:31:15,989 - ***** Epoch: 21: Eval results *****
2024-03-18 03:31:15,990 -   train_loss = 0.063
2024-03-18 03:31:15,990 -   best_eval_score = 0.5157
2024-03-18 03:31:15,990 -   eval_score = 0.4912
2024-03-18 03:31:15,990 - EarlyStopping counter: 5 out of 8
2024-03-18 03:31:49,949 - ***** Epoch: 22: Eval results *****
2024-03-18 03:31:49,949 -   train_loss = 0.0615
2024-03-18 03:31:49,949 -   best_eval_score = 0.5157
2024-03-18 03:31:49,950 -   eval_score = 0.4906
2024-03-18 03:31:49,950 - EarlyStopping counter: 6 out of 8
2024-03-18 03:32:23,289 - ***** Epoch: 23: Eval results *****
2024-03-18 03:32:23,289 -   train_loss = 0.0558
2024-03-18 03:32:23,289 -   best_eval_score = 0.5157
2024-03-18 03:32:23,289 -   eval_score = 0.4804
2024-03-18 03:32:23,289 - EarlyStopping counter: 7 out of 8
2024-03-18 03:32:58,997 - ***** Epoch: 24: Eval results *****
2024-03-18 03:32:58,998 -   train_loss = 0.0576
2024-03-18 03:32:58,998 -   best_eval_score = 0.5157
2024-03-18 03:32:58,998 -   eval_score = 0.4822
2024-03-18 03:32:58,998 - EarlyStopping counter: 8 out of 8
2024-03-18 03:32:58,998 - EarlyStopping at epoch 24
2024-03-18 03:32:59,000 - Training is finished...
2024-03-18 03:32:59,000 - Testing begins...
2024-03-18 03:33:08,360 - ***** Test: Confusion Matrix *****
2024-03-18 03:33:08,362 - [[ 47   0  13   0   0   0   0   0   0   0   2   0   0   1   0   0   0   2
    0   0   0   0   1   0   1   1   0   0   0   0]
 [  0  50   0   0   9   3   6   0   1   0   2   0   4   0   7   0   0   8
    2   3   0   0   0   0   2   0   0   0   0   0]
 [ 10   1  37   0   0   0   0   0   0   0   1   0   0   4   1   0   0   3
    1   0   0   3   0   1   2   0   0   0   0   0]
 [  0   0   0  58   0   0   0   1   0   0   0   0   0   0   4   0   0   0
    1   0   0   1   0   0   0   0   0   0   0   0]
 [  0   5   0   0  26   1   0   0   1   0   0   0   0   0   0   0   0   6
    0   5   0   3   0   1   1   0   0   0   0   2]
 [  0   1   0   0   1  28   0   0   0   1   2   0   0   0   1   0   0   1
    0   0   0   0   0   1   0   0   1   0   0   0]
 [  0   1   0   0   0   5  27   6   0   1   2   0   5   0   0   0   0   0
    0   0   0   1   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   1   6  22   0   2   7   0   6   0   0   0   0   0
    0   1   0   0   0   0   2   0   0   0   0   0]
 [  1   2   1   2   1   0   0   0  23   2   0   2   0   0   4   1   0   5
    0   1   0   0   2   0   2   0   0   0   0   0]
 [  0   0   1   0   0   0   0   0   2  45   0   4  10   2  17   2   0   9
    2   0   0   3   2   1   1   2   0   3   0   1]
 [  2   0   0   0   0   3   2   1   1   1  43   0  33   0   2   0   1   0
    0   3   0   0   0   0   0   0   0   1   0   0]
 [  0   3   0   0   0   0   1   0   1   4   0  17   9   2   1   0   0   2
    1   0   1   0   3   0   1   0   0   1   0   0]
 [  0   3   0   0   0   2   5   4   0   5  26   0  85   0   2   0   1   0
    0   1   0   0   1   0   0   0   0   0   0   0]
 [  0   0   1   0   0   0   0   0   0   2   0   0   0   2   3   1   0   5
    2   0   0   0   1   0   0   0   0   0   0   0]
 [  0   1   0   0   0   2   1   1   4   6   3   0   1   6 122   1   0  29
    3   0   1   0   8   0   3   0   0   0   0   1]
 [  0   0   2   0   1   0   0   0   1   4   0   0   0   1   3   2   0   2
    3   0   0   0   1   0   0   0   0   1   1   0]
 [  0   0   0   0   1   0   0   0   0   0   2   0   3   0   0   1  47   0
   10   0   0   1   0   0   1   0   0   0   0   0]
 [  1   6   2   0   7   3   0   0   3   8   1   0   1   8  20   4   1 113
   12   2   3   5   7   5   0   0   0   0   2   3]
 [  0   1   0   0   1   0   1   0   0   3   2   0   0   1   8   0   2   7
   30   0   1   0   1   0   1   1   0   0   0   0]
 [  0   5   0   0   0   0   3   0   0   0   2   0   0   0   0   0   0   0
    0   5   0   2   0   0   0   0   0   0   0   0]
 [  0   0   1   0   0   0   0   0   1   2   0   1   1   0   5   1   0   5
    6   1   2   0   0   1   1   0   0   1   0   0]
 [  6   1   1   0   0   0   0   0   0   1   0   0   0   0   2   0   1   1
    0   0   0  29   1   4   0   0   2   2   0   2]
 [  0   1   0   0   0   1   0   0   0   3   0   1   0   1  12   0   0   3
    0   0   0   0  84   0   1   2   8   0   0   0]
 [  0   2   1   0   1   0   0   0   0   2   0   0   0   0   0   0   0   9
    0   0   0   4   0  19   0   0   0   0   0   0]
 [  3   0   0   0   0   0   0   0   3   3   1   1   1   1   4   0   0   3
    1   0   0   0   1   0  85   0   0   5   1   0]
 [  1   1   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   2
    0   0   0   0   2   0   1  21   1   0   0   1]
 [  0   0   0   1   0   0   0   0   0   0   0   0   0   1   2   0   0   3
    0   0   0   0   1   0   0   0   7   0   2   0]
 [  1   3   1   0   1   1   1   0   1   6   2   2   3   2   4   0   0   2
    1   0   2   1   2   0   9   1   0  10   1   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
    0   0   0   0   0   0   0   0   0   0  57   0]
 [  0   2   0   0   0   0   0   0   2   2   1   1   0   0   0   0   0   4
    1   0   0   0   0   0   1   1   0   0   0   4]]
2024-03-18 03:33:08,362 - ***** Evaluation results *****
2024-03-18 03:33:08,362 -   acc = 0.5642
2024-03-18 03:33:08,362 -   f1 = 0.5088
2024-03-18 03:33:08,363 -   prec = 0.5229
2024-03-18 03:33:08,363 -   rec = 0.5076
2024-03-18 03:33:08,363 - Testing is finished...
2024-03-18 03:33:08,363 - Multimodal intent recognition is finished...
2024-03-18 03:33:08,363 - Results are saved in results/mag_bert.csv
