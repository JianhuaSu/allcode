2024-01-03 13:39:56,000 - ============================== Params ==============================
2024-01-03 13:39:56,000 - logger_name: msz_MIntRec_multi-class_seed-0_2024-01-03-13-39-55
2024-01-03 13:39:56,000 - dataset: MIntRec
2024-01-03 13:39:56,000 - data_mode: multi-class
2024-01-03 13:39:56,000 - method: msz
2024-01-03 13:39:56,000 - text_backbone: bert-base-uncased
2024-01-03 13:39:56,001 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-03 13:39:56,001 - seed: 0
2024-01-03 13:39:56,001 - num_workers: 8
2024-01-03 13:39:56,001 - gpu_id: 1
2024-01-03 13:39:56,001 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-03 13:39:56,001 - train: True
2024-01-03 13:39:56,001 - tune: False
2024-01-03 13:39:56,001 - save_model: False
2024-01-03 13:39:56,001 - save_results: True
2024-01-03 13:39:56,001 - log_path: logs
2024-01-03 13:39:56,001 - cache_path: 
2024-01-03 13:39:56,001 - video_data_path: video_data
2024-01-03 13:39:56,001 - audio_data_path: audio_data
2024-01-03 13:39:56,001 - video_feats_path: video_feats.pkl
2024-01-03 13:39:56,001 - audio_feats_path: audio_feats.pkl
2024-01-03 13:39:56,001 - results_path: results
2024-01-03 13:39:56,001 - output_path: /home/sujianhua/Outputs/MIntRec
2024-01-03 13:39:56,001 - model_path: models
2024-01-03 13:39:56,001 - config_file_name: msz
2024-01-03 13:39:56,001 - results_file_name: msz.csv
2024-01-03 13:39:56,001 - padding_mode: zero
2024-01-03 13:39:56,001 - padding_loc: end
2024-01-03 13:39:56,001 - need_aligned: False
2024-01-03 13:39:56,001 - eval_monitor: f1
2024-01-03 13:39:56,001 - train_batch_size: 16
2024-01-03 13:39:56,001 - eval_batch_size: 8
2024-01-03 13:39:56,001 - test_batch_size: 8
2024-01-03 13:39:56,001 - wait_patience: 8
2024-01-03 13:39:56,001 - nheads: 2
2024-01-03 13:39:56,001 - encoder_layers: 2
2024-01-03 13:39:56,001 - attn_dropout: 0.1
2024-01-03 13:39:56,001 - relu_dropout: 0.1
2024-01-03 13:39:56,001 - embed_dropout: 0.1
2024-01-03 13:39:56,001 - res_dropout: 0.1
2024-01-03 13:39:56,001 - attn_mask: False
2024-01-03 13:39:56,002 - hidden_size: 768
2024-01-03 13:39:56,002 - num_attention_heads: 12
2024-01-03 13:39:56,002 - attention_probs_dropout_prob: 0.2
2024-01-03 13:39:56,002 - hidden_dropout_prob: 0.2
2024-01-03 13:39:56,002 - intermediate_size: 768
2024-01-03 13:39:56,002 - num_hidden_layers: 3
2024-01-03 13:39:56,002 - max_position_embeddings: 512
2024-01-03 13:39:56,002 - position_embedding_type: absolute
2024-01-03 13:39:56,002 - batch_first: True
2024-01-03 13:39:56,002 - hidden_dims: 768
2024-01-03 13:39:56,002 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-03 13:39:56,002 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-03 13:39:56,002 - ta_loss: 0.02
2024-01-03 13:39:56,002 - tv_loss: 0.03
2024-01-03 13:39:56,002 - av_loss: 0.03
2024-01-03 13:39:56,002 - aligned_method: conv1d
2024-01-03 13:39:56,002 - grad_clip: -1
2024-01-03 13:39:56,002 - num_train_epochs: 100
2024-01-03 13:39:56,002 - warmup_proportion: 0.1
2024-01-03 13:39:56,002 - lr: 1e-06
2024-01-03 13:39:56,002 - weight_decay: 0.02
2024-01-03 13:39:56,002 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-0_2024-01-03-13-39-55
2024-01-03 13:39:56,002 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-0_2024-01-03-13-39-55/models
2024-01-03 13:39:56,002 - ============================== End Params ==============================
2024-01-03 13:39:56,106 - Generate Text Features Begin...
2024-01-03 13:39:56,840 - Generate Text Features Finished...
2024-01-03 13:39:56,841 - Load Video Features Begin...
2024-01-03 13:40:05,039 - Load Video Features Finished...
2024-01-03 13:40:05,646 - Load Audio Features Begin...
2024-01-03 13:40:39,963 - Load Audio Features Finished...
2024-01-03 13:40:43,691 - method  begins...
2024-01-03 13:40:55,229 - Multimodal intent recognition begins...
2024-01-03 13:40:55,229 - Training begins...
2024-01-03 13:41:18,511 - ***** Epoch: 1: Eval results *****
2024-01-03 13:41:18,512 -   train_loss = 3.5067
2024-01-03 13:41:18,512 -   best_eval_score = 0.0
2024-01-03 13:41:18,512 -   eval_score = 0.071
2024-01-03 13:41:41,956 - ***** Epoch: 2: Eval results *****
2024-01-03 13:41:41,956 -   train_loss = 3.2112
2024-01-03 13:41:41,956 -   best_eval_score = 0.071
2024-01-03 13:41:41,956 -   eval_score = 0.0298
2024-01-03 13:41:41,956 - EarlyStopping counter: 1 out of 8
2024-01-03 13:42:04,643 - ***** Epoch: 3: Eval results *****
2024-01-03 13:42:04,643 -   train_loss = 2.9763
2024-01-03 13:42:04,643 -   best_eval_score = 0.071
2024-01-03 13:42:04,643 -   eval_score = 0.1926
2024-01-03 13:42:26,493 - ***** Epoch: 4: Eval results *****
2024-01-03 13:42:26,493 -   train_loss = 2.6837
2024-01-03 13:42:26,493 -   best_eval_score = 0.1926
2024-01-03 13:42:26,493 -   eval_score = 0.2953
2024-01-03 13:42:47,251 - ***** Epoch: 5: Eval results *****
2024-01-03 13:42:47,251 -   train_loss = 2.2968
2024-01-03 13:42:47,251 -   best_eval_score = 0.2953
2024-01-03 13:42:47,251 -   eval_score = 0.3414
2024-01-03 13:43:08,486 - ***** Epoch: 6: Eval results *****
2024-01-03 13:43:08,486 -   train_loss = 1.8894
2024-01-03 13:43:08,486 -   best_eval_score = 0.3414
2024-01-03 13:43:08,486 -   eval_score = 0.4887
2024-01-03 13:43:29,705 - ***** Epoch: 7: Eval results *****
2024-01-03 13:43:29,705 -   train_loss = 1.5182
2024-01-03 13:43:29,705 -   best_eval_score = 0.4887
2024-01-03 13:43:29,705 -   eval_score = 0.5263
2024-01-03 13:43:50,650 - ***** Epoch: 8: Eval results *****
2024-01-03 13:43:50,650 -   train_loss = 1.1985
2024-01-03 13:43:50,650 -   best_eval_score = 0.5263
2024-01-03 13:43:50,650 -   eval_score = 0.5386
2024-01-03 13:44:13,531 - ***** Epoch: 9: Eval results *****
2024-01-03 13:44:13,532 -   train_loss = 0.9844
2024-01-03 13:44:13,532 -   best_eval_score = 0.5386
2024-01-03 13:44:13,532 -   eval_score = 0.5576
2024-01-03 13:44:37,173 - ***** Epoch: 10: Eval results *****
2024-01-03 13:44:37,173 -   train_loss = 0.8717
2024-01-03 13:44:37,174 -   best_eval_score = 0.5576
2024-01-03 13:44:37,174 -   eval_score = 0.5596
2024-01-03 13:44:59,736 - ***** Epoch: 11: Eval results *****
2024-01-03 13:44:59,736 -   train_loss = 0.7345
2024-01-03 13:44:59,736 -   best_eval_score = 0.5596
2024-01-03 13:44:59,736 -   eval_score = 0.5902
2024-01-03 13:45:21,578 - ***** Epoch: 12: Eval results *****
2024-01-03 13:45:21,579 -   train_loss = 0.8226
2024-01-03 13:45:21,579 -   best_eval_score = 0.5902
2024-01-03 13:45:21,579 -   eval_score = 0.5838
2024-01-03 13:45:21,579 - EarlyStopping counter: 1 out of 8
2024-01-03 13:45:43,168 - ***** Epoch: 13: Eval results *****
2024-01-03 13:45:43,168 -   train_loss = 0.5855
2024-01-03 13:45:43,168 -   best_eval_score = 0.5902
2024-01-03 13:45:43,168 -   eval_score = 0.6105
2024-01-03 13:46:04,981 - ***** Epoch: 14: Eval results *****
2024-01-03 13:46:04,981 -   train_loss = 0.511
2024-01-03 13:46:04,981 -   best_eval_score = 0.6105
2024-01-03 13:46:04,981 -   eval_score = 0.5815
2024-01-03 13:46:04,981 - EarlyStopping counter: 1 out of 8
2024-01-03 13:46:26,940 - ***** Epoch: 15: Eval results *****
2024-01-03 13:46:26,940 -   train_loss = 0.4041
2024-01-03 13:46:26,940 -   best_eval_score = 0.6105
2024-01-03 13:46:26,940 -   eval_score = 0.6365
2024-01-03 13:46:49,206 - ***** Epoch: 16: Eval results *****
2024-01-03 13:46:49,207 -   train_loss = 0.3016
2024-01-03 13:46:49,207 -   best_eval_score = 0.6365
2024-01-03 13:46:49,207 -   eval_score = 0.6273
2024-01-03 13:46:49,207 - EarlyStopping counter: 1 out of 8
2024-01-03 13:47:13,393 - ***** Epoch: 17: Eval results *****
2024-01-03 13:47:13,393 -   train_loss = 0.2387
2024-01-03 13:47:13,393 -   best_eval_score = 0.6365
2024-01-03 13:47:13,393 -   eval_score = 0.6144
2024-01-03 13:47:13,393 - EarlyStopping counter: 2 out of 8
2024-01-03 13:47:36,255 - ***** Epoch: 18: Eval results *****
2024-01-03 13:47:36,255 -   train_loss = 0.1913
2024-01-03 13:47:36,255 -   best_eval_score = 0.6365
2024-01-03 13:47:36,255 -   eval_score = 0.6281
2024-01-03 13:47:36,256 - EarlyStopping counter: 3 out of 8
2024-01-03 13:47:58,442 - ***** Epoch: 19: Eval results *****
2024-01-03 13:47:58,442 -   train_loss = 0.1547
2024-01-03 13:47:58,442 -   best_eval_score = 0.6365
2024-01-03 13:47:58,443 -   eval_score = 0.6434
2024-01-03 13:48:20,120 - ***** Epoch: 20: Eval results *****
2024-01-03 13:48:20,120 -   train_loss = 0.1191
2024-01-03 13:48:20,120 -   best_eval_score = 0.6434
2024-01-03 13:48:20,120 -   eval_score = 0.6507
2024-01-03 13:48:42,430 - ***** Epoch: 21: Eval results *****
2024-01-03 13:48:42,430 -   train_loss = 0.097
2024-01-03 13:48:42,430 -   best_eval_score = 0.6507
2024-01-03 13:48:42,430 -   eval_score = 0.65
2024-01-03 13:48:42,430 - EarlyStopping counter: 1 out of 8
2024-01-03 13:49:04,050 - ***** Epoch: 22: Eval results *****
2024-01-03 13:49:04,050 -   train_loss = 0.0792
2024-01-03 13:49:04,050 -   best_eval_score = 0.6507
2024-01-03 13:49:04,050 -   eval_score = 0.6552
2024-01-03 13:49:26,474 - ***** Epoch: 23: Eval results *****
2024-01-03 13:49:26,475 -   train_loss = 0.0674
2024-01-03 13:49:26,475 -   best_eval_score = 0.6552
2024-01-03 13:49:26,475 -   eval_score = 0.6453
2024-01-03 13:49:26,475 - EarlyStopping counter: 1 out of 8
2024-01-03 13:49:50,653 - ***** Epoch: 24: Eval results *****
2024-01-03 13:49:50,653 -   train_loss = 0.0641
2024-01-03 13:49:50,653 -   best_eval_score = 0.6552
2024-01-03 13:49:50,653 -   eval_score = 0.6332
2024-01-03 13:49:50,653 - EarlyStopping counter: 2 out of 8
2024-01-03 13:50:13,792 - ***** Epoch: 25: Eval results *****
2024-01-03 13:50:13,793 -   train_loss = 0.0482
2024-01-03 13:50:13,793 -   best_eval_score = 0.6552
2024-01-03 13:50:13,793 -   eval_score = 0.6515
2024-01-03 13:50:13,793 - EarlyStopping counter: 3 out of 8
2024-01-03 13:50:36,340 - ***** Epoch: 26: Eval results *****
2024-01-03 13:50:36,340 -   train_loss = 0.0424
2024-01-03 13:50:36,340 -   best_eval_score = 0.6552
2024-01-03 13:50:36,340 -   eval_score = 0.6504
2024-01-03 13:50:36,340 - EarlyStopping counter: 4 out of 8
2024-01-03 13:50:58,305 - ***** Epoch: 27: Eval results *****
2024-01-03 13:50:58,305 -   train_loss = 0.0389
2024-01-03 13:50:58,305 -   best_eval_score = 0.6552
2024-01-03 13:50:58,305 -   eval_score = 0.6358
2024-01-03 13:50:58,305 - EarlyStopping counter: 5 out of 8
2024-01-03 13:51:20,714 - ***** Epoch: 28: Eval results *****
2024-01-03 13:51:20,714 -   train_loss = 0.0375
2024-01-03 13:51:20,714 -   best_eval_score = 0.6552
2024-01-03 13:51:20,714 -   eval_score = 0.6244
2024-01-03 13:51:20,714 - EarlyStopping counter: 6 out of 8
2024-01-03 13:51:43,124 - ***** Epoch: 29: Eval results *****
2024-01-03 13:51:43,124 -   train_loss = 0.0355
2024-01-03 13:51:43,124 -   best_eval_score = 0.6552
2024-01-03 13:51:43,124 -   eval_score = 0.6145
2024-01-03 13:51:43,124 - EarlyStopping counter: 7 out of 8
2024-01-03 13:52:04,881 - ***** Epoch: 30: Eval results *****
2024-01-03 13:52:04,881 -   train_loss = 0.0348
2024-01-03 13:52:04,881 -   best_eval_score = 0.6552
2024-01-03 13:52:04,881 -   eval_score = 0.6052
2024-01-03 13:52:04,881 - EarlyStopping counter: 8 out of 8
2024-01-03 13:52:04,881 - EarlyStopping at epoch 30
2024-01-03 13:52:04,883 - Training is finished...
2024-01-03 13:52:04,883 - Testing begins...
2024-01-03 13:52:08,596 - ***** Test: Confusion Matrix *****
2024-01-03 13:52:08,597 - [[23  0  0  0 12  0  6  1  6  5  0  0  3  1  0  0  0  0  0  0]
 [ 0 38  1  0  0  0  2  0  1  0  0  0  1  0  0  0  0  0  0  0]
 [ 0  0 27  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0 12  0  6  0  3  1  0  1  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  0  0  1  0  0  0]
 [ 1  1  1  0  1  0  2  0  5  0  0  0  0  0  0  0  0  0  0  1]
 [ 0  0  0  0  0  0  2  6  1  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  5  0  0  0  0  2  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  1  0  4  0  0  0  0  0  2  0  1  0  0]
 [ 1  2  0  0  0  2  2  0  0  1 10  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  0  1]
 [ 3  2  0  1  0  0  1  1  8  0  0  0 29  4  1  4  1  0  0  2]
 [ 0  2  0  0  1  0  1  0  3  0  1  1  0 16  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  1  0  0  0  0  4 12  0  1  0  0  3]
 [ 0  0  0  0  0  0  0  1  3  0  0  0  1  0  0 15  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  0  0  4  1 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  1  0  0  0  0 12  0  0]
 [ 0  0  0  1  0  0  0  0  0  0  0  0  1  0  0  2  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  9]]
2024-01-03 13:52:08,597 - ***** Evaluation results *****
2024-01-03 13:52:08,597 -   acc = 0.6562
2024-01-03 13:52:08,597 -   f1 = 0.6493
2024-01-03 13:52:08,597 -   prec = 0.6724
2024-01-03 13:52:08,597 -   rec = 0.6632
2024-01-03 13:52:08,597 - Testing is finished...
2024-01-03 13:52:08,597 - Multimodal intent recognition is finished...
2024-01-03 13:52:08,597 - Results are saved in results/msz.csv
