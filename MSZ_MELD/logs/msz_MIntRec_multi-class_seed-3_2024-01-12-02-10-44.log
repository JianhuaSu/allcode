2024-01-12 02:10:44,604 - ============================== Params ==============================
2024-01-12 02:10:44,604 - logger_name: msz_MIntRec_multi-class_seed-3_2024-01-12-02-10-44
2024-01-12 02:10:44,604 - dataset: MIntRec
2024-01-12 02:10:44,604 - data_mode: multi-class
2024-01-12 02:10:44,604 - method: msz
2024-01-12 02:10:44,604 - text_backbone: bert-base-uncased
2024-01-12 02:10:44,604 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-12 02:10:44,604 - seed: 3
2024-01-12 02:10:44,604 - num_workers: 8
2024-01-12 02:10:44,604 - gpu_id: 1
2024-01-12 02:10:44,604 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-12 02:10:44,604 - train: True
2024-01-12 02:10:44,604 - tune: False
2024-01-12 02:10:44,604 - save_model: False
2024-01-12 02:10:44,605 - save_results: True
2024-01-12 02:10:44,605 - log_path: logs
2024-01-12 02:10:44,605 - cache_path: 
2024-01-12 02:10:44,605 - video_data_path: video_data
2024-01-12 02:10:44,605 - audio_data_path: audio_data
2024-01-12 02:10:44,605 - video_feats_path: video_feats.pkl
2024-01-12 02:10:44,605 - audio_feats_path: audio_feats.pkl
2024-01-12 02:10:44,605 - results_path: results
2024-01-12 02:10:44,605 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-12 02:10:44,605 - model_path: models
2024-01-12 02:10:44,605 - config_file_name: msz
2024-01-12 02:10:44,605 - results_file_name: msz.csv
2024-01-12 02:10:44,605 - padding_mode: zero
2024-01-12 02:10:44,605 - padding_loc: end
2024-01-12 02:10:44,605 - need_aligned: False
2024-01-12 02:10:44,605 - eval_monitor: f1
2024-01-12 02:10:44,605 - train_batch_size: 16
2024-01-12 02:10:44,605 - eval_batch_size: 8
2024-01-12 02:10:44,605 - test_batch_size: 8
2024-01-12 02:10:44,605 - wait_patience: 8
2024-01-12 02:10:44,605 - nheads: 12
2024-01-12 02:10:44,605 - encoder_layers: 6
2024-01-12 02:10:44,605 - attn_dropout: 0.1
2024-01-12 02:10:44,605 - relu_dropout: 0.3
2024-01-12 02:10:44,605 - embed_dropout: 0.2
2024-01-12 02:10:44,605 - res_dropout: 0.1
2024-01-12 02:10:44,605 - attn_mask: False
2024-01-12 02:10:44,605 - hidden_size: 768
2024-01-12 02:10:44,605 - num_attention_heads: 12
2024-01-12 02:10:44,605 - attention_probs_dropout_prob: 0.2
2024-01-12 02:10:44,605 - hidden_dropout_prob: 0.2
2024-01-12 02:10:44,605 - intermediate_size: 768
2024-01-12 02:10:44,605 - num_hidden_layers: 6
2024-01-12 02:10:44,605 - max_position_embeddings: 768
2024-01-12 02:10:44,605 - position_embedding_type: absolute
2024-01-12 02:10:44,605 - batch_first: True
2024-01-12 02:10:44,605 - hidden_dims: 768
2024-01-12 02:10:44,605 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-12 02:10:44,605 - spe_dropouts: [0.2, 0.1, 0.1]
2024-01-12 02:10:44,606 - aligned_method: conv1d
2024-01-12 02:10:44,606 - grad_clip: 2
2024-01-12 02:10:44,606 - num_train_epochs: 100
2024-01-12 02:10:44,606 - warmup_proportion: 0.1
2024-01-12 02:10:44,606 - lr: 3e-06
2024-01-12 02:10:44,606 - weight_decay: 0.01
2024-01-12 02:10:44,606 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2024-01-12-02-10-44
2024-01-12 02:10:44,606 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2024-01-12-02-10-44/models
2024-01-12 02:10:44,606 - ============================== End Params ==============================
2024-01-12 02:10:44,608 - Generate Text Features Begin...
2024-01-12 02:10:45,049 - Generate Text Features Finished...
2024-01-12 02:10:45,050 - Load Video Features Begin...
2024-01-12 02:10:45,374 - Load Video Features Finished...
2024-01-12 02:10:46,103 - Load Audio Features Begin...
2024-01-12 02:10:47,352 - Load Audio Features Finished...
2024-01-12 02:10:51,941 - method  begins...
2024-01-12 02:10:58,173 - Multimodal intent recognition begins...
2024-01-12 02:10:58,174 - Training begins...
2024-01-12 02:11:21,327 - ***** Epoch: 1: Eval results *****
2024-01-12 02:11:21,327 -   train_loss = 2.9728
2024-01-12 02:11:21,327 -   best_eval_score = 0.0
2024-01-12 02:11:21,327 -   eval_score = 0.0146
2024-01-12 02:11:42,191 - ***** Epoch: 2: Eval results *****
2024-01-12 02:11:42,191 -   train_loss = 2.8418
2024-01-12 02:11:42,191 -   best_eval_score = 0.0146
2024-01-12 02:11:42,191 -   eval_score = 0.0274
2024-01-12 02:12:02,101 - ***** Epoch: 3: Eval results *****
2024-01-12 02:12:02,102 -   train_loss = 2.7269
2024-01-12 02:12:02,102 -   best_eval_score = 0.0274
2024-01-12 02:12:02,102 -   eval_score = 0.084
2024-01-12 02:12:23,022 - ***** Epoch: 4: Eval results *****
2024-01-12 02:12:23,022 -   train_loss = 2.5359
2024-01-12 02:12:23,022 -   best_eval_score = 0.084
2024-01-12 02:12:23,022 -   eval_score = 0.2079
2024-01-12 02:12:44,144 - ***** Epoch: 5: Eval results *****
2024-01-12 02:12:44,144 -   train_loss = 2.1947
2024-01-12 02:12:44,144 -   best_eval_score = 0.2079
2024-01-12 02:12:44,144 -   eval_score = 0.3354
2024-01-12 02:13:06,633 - ***** Epoch: 6: Eval results *****
2024-01-12 02:13:06,634 -   train_loss = 1.7598
2024-01-12 02:13:06,635 -   best_eval_score = 0.3354
2024-01-12 02:13:06,635 -   eval_score = 0.4661
2024-01-12 02:13:28,220 - ***** Epoch: 7: Eval results *****
2024-01-12 02:13:28,220 -   train_loss = 1.3781
2024-01-12 02:13:28,220 -   best_eval_score = 0.4661
2024-01-12 02:13:28,220 -   eval_score = 0.5257
2024-01-12 02:13:48,927 - ***** Epoch: 8: Eval results *****
2024-01-12 02:13:48,927 -   train_loss = 1.0583
2024-01-12 02:13:48,927 -   best_eval_score = 0.5257
2024-01-12 02:13:48,927 -   eval_score = 0.5868
2024-01-12 02:14:09,884 - ***** Epoch: 9: Eval results *****
2024-01-12 02:14:09,884 -   train_loss = 0.7861
2024-01-12 02:14:09,884 -   best_eval_score = 0.5868
2024-01-12 02:14:09,884 -   eval_score = 0.6057
2024-01-12 02:14:31,860 - ***** Epoch: 10: Eval results *****
2024-01-12 02:14:31,860 -   train_loss = 0.5759
2024-01-12 02:14:31,860 -   best_eval_score = 0.6057
2024-01-12 02:14:31,860 -   eval_score = 0.6711
2024-01-12 02:14:53,002 - ***** Epoch: 11: Eval results *****
2024-01-12 02:14:53,002 -   train_loss = 0.4241
2024-01-12 02:14:53,002 -   best_eval_score = 0.6711
2024-01-12 02:14:53,002 -   eval_score = 0.6668
2024-01-12 02:14:53,002 - EarlyStopping counter: 1 out of 8
2024-01-12 02:15:14,729 - ***** Epoch: 12: Eval results *****
2024-01-12 02:15:14,729 -   train_loss = 0.2886
2024-01-12 02:15:14,729 -   best_eval_score = 0.6711
2024-01-12 02:15:14,729 -   eval_score = 0.6613
2024-01-12 02:15:14,729 - EarlyStopping counter: 2 out of 8
2024-01-12 02:15:36,954 - ***** Epoch: 13: Eval results *****
2024-01-12 02:15:36,955 -   train_loss = 0.2063
2024-01-12 02:15:36,955 -   best_eval_score = 0.6711
2024-01-12 02:15:36,955 -   eval_score = 0.6607
2024-01-12 02:15:36,955 - EarlyStopping counter: 3 out of 8
2024-01-12 02:15:58,944 - ***** Epoch: 14: Eval results *****
2024-01-12 02:15:58,945 -   train_loss = 0.1537
2024-01-12 02:15:58,945 -   best_eval_score = 0.6711
2024-01-12 02:15:58,945 -   eval_score = 0.6645
2024-01-12 02:15:58,945 - EarlyStopping counter: 4 out of 8
2024-01-12 02:16:20,834 - ***** Epoch: 15: Eval results *****
2024-01-12 02:16:20,834 -   train_loss = 0.1171
2024-01-12 02:16:20,834 -   best_eval_score = 0.6711
2024-01-12 02:16:20,834 -   eval_score = 0.6629
2024-01-12 02:16:20,834 - EarlyStopping counter: 5 out of 8
2024-01-12 02:16:43,099 - ***** Epoch: 16: Eval results *****
2024-01-12 02:16:43,099 -   train_loss = 0.0878
2024-01-12 02:16:43,099 -   best_eval_score = 0.6711
2024-01-12 02:16:43,099 -   eval_score = 0.6573
2024-01-12 02:16:43,099 - EarlyStopping counter: 6 out of 8
2024-01-12 02:17:04,970 - ***** Epoch: 17: Eval results *****
2024-01-12 02:17:04,972 -   train_loss = 0.0703
2024-01-12 02:17:04,972 -   best_eval_score = 0.6711
2024-01-12 02:17:04,972 -   eval_score = 0.6726
2024-01-12 02:17:27,442 - ***** Epoch: 18: Eval results *****
2024-01-12 02:17:27,442 -   train_loss = 0.0558
2024-01-12 02:17:27,442 -   best_eval_score = 0.6726
2024-01-12 02:17:27,442 -   eval_score = 0.6787
2024-01-12 02:17:49,018 - ***** Epoch: 19: Eval results *****
2024-01-12 02:17:49,018 -   train_loss = 0.0444
2024-01-12 02:17:49,018 -   best_eval_score = 0.6787
2024-01-12 02:17:49,018 -   eval_score = 0.6527
2024-01-12 02:17:49,018 - EarlyStopping counter: 1 out of 8
2024-01-12 02:18:09,851 - ***** Epoch: 20: Eval results *****
2024-01-12 02:18:09,852 -   train_loss = 0.0359
2024-01-12 02:18:09,852 -   best_eval_score = 0.6787
2024-01-12 02:18:09,852 -   eval_score = 0.6692
2024-01-12 02:18:09,852 - EarlyStopping counter: 2 out of 8
2024-01-12 02:18:30,393 - ***** Epoch: 21: Eval results *****
2024-01-12 02:18:30,393 -   train_loss = 0.0334
2024-01-12 02:18:30,393 -   best_eval_score = 0.6787
2024-01-12 02:18:30,393 -   eval_score = 0.6753
2024-01-12 02:18:30,393 - EarlyStopping counter: 3 out of 8
2024-01-12 02:18:50,940 - ***** Epoch: 22: Eval results *****
2024-01-12 02:18:50,940 -   train_loss = 0.0265
2024-01-12 02:18:50,941 -   best_eval_score = 0.6787
2024-01-12 02:18:50,941 -   eval_score = 0.6679
2024-01-12 02:18:50,941 - EarlyStopping counter: 4 out of 8
2024-01-12 02:19:12,122 - ***** Epoch: 23: Eval results *****
2024-01-12 02:19:12,123 -   train_loss = 0.0226
2024-01-12 02:19:12,123 -   best_eval_score = 0.6787
2024-01-12 02:19:12,123 -   eval_score = 0.6641
2024-01-12 02:19:12,123 - EarlyStopping counter: 5 out of 8
2024-01-12 02:19:33,817 - ***** Epoch: 24: Eval results *****
2024-01-12 02:19:33,817 -   train_loss = 0.0236
2024-01-12 02:19:33,817 -   best_eval_score = 0.6787
2024-01-12 02:19:33,817 -   eval_score = 0.6725
2024-01-12 02:19:33,817 - EarlyStopping counter: 6 out of 8
2024-01-12 02:19:55,055 - ***** Epoch: 25: Eval results *****
2024-01-12 02:19:55,056 -   train_loss = 0.0191
2024-01-12 02:19:55,056 -   best_eval_score = 0.6787
2024-01-12 02:19:55,056 -   eval_score = 0.6654
2024-01-12 02:19:55,056 - EarlyStopping counter: 7 out of 8
2024-01-12 02:20:16,133 - ***** Epoch: 26: Eval results *****
2024-01-12 02:20:16,134 -   train_loss = 0.0168
2024-01-12 02:20:16,134 -   best_eval_score = 0.6787
2024-01-12 02:20:16,134 -   eval_score = 0.6641
2024-01-12 02:20:16,134 - EarlyStopping counter: 8 out of 8
2024-01-12 02:20:16,134 - EarlyStopping at epoch 26
2024-01-12 02:20:16,139 - Training is finished...
2024-01-12 02:20:16,139 - Testing begins...
2024-01-12 02:20:20,217 - ***** Test: Confusion Matrix *****
2024-01-12 02:20:20,218 - [[38  2  0  0  5  0  3  1  0  2  1  0  4  1  0  0  0  0  0  0]
 [ 1 34  0  1  0  3  0  0  0  0  2  0  2  0  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 4  0  0  0 10  0  5  0  0  0  0  1  1  1  0  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 1  1  0  0  2  0  3  0  2  0  0  0  1  0  0  1  0  0  0  1]
 [ 3  0  0  0  0  0  0  6  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  3  5  0  0  0  0  1  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  3  1  0  0  0  0  3  0  1  0  0]
 [ 1  0  0  0  0  0  1  0  0  2 12  0  0  0  1  0  1  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 16  0  0  0  0  0  1  0  1]
 [ 3  3  0  0  0  0  0  0  0  0  0  1 41  2  4  0  3  0  0  0]
 [ 0  1  0  0  0  0  2  0  0  0  1  1  0 19  1  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  1  0  0  0  2  2 14  0  1  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  3  0  0 16  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  2  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  2  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  1  1  0  2  0  0  5]]
2024-01-12 02:20:20,218 - ***** Evaluation results *****
2024-01-12 02:20:20,218 -   acc = 0.7079
2024-01-12 02:20:20,218 -   f1 = 0.6751
2024-01-12 02:20:20,218 -   prec = 0.6818
2024-01-12 02:20:20,218 -   rec = 0.6729
2024-01-12 02:20:20,218 - Testing is finished...
2024-01-12 02:20:20,218 - Multimodal intent recognition is finished...
2024-01-12 02:20:20,219 - Results are saved in results/msz.csv
