2024-03-07 14:52:07,257 - ============================== Params ==============================
2024-03-07 14:52:07,257 - logger_name: msz_MIntRec2_multi-class_seed-1_2024-03-07-14-52-07
2024-03-07 14:52:07,257 - dataset: MIntRec2
2024-03-07 14:52:07,257 - data_mode: multi-class
2024-03-07 14:52:07,257 - method: msz
2024-03-07 14:52:07,257 - text_backbone: bert-base-uncased
2024-03-07 14:52:07,257 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-07 14:52:07,257 - seed: 1
2024-03-07 14:52:07,257 - num_workers: 8
2024-03-07 14:52:07,257 - gpu_id: 2
2024-03-07 14:52:07,257 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-07 14:52:07,257 - train: True
2024-03-07 14:52:07,257 - tune: True
2024-03-07 14:52:07,257 - save_model: False
2024-03-07 14:52:07,258 - save_results: True
2024-03-07 14:52:07,258 - log_path: logs
2024-03-07 14:52:07,258 - cache_path: 
2024-03-07 14:52:07,258 - video_data_path: video_data
2024-03-07 14:52:07,258 - audio_data_path: audio_data
2024-03-07 14:52:07,258 - video_feats_path: video_feats.pkl
2024-03-07 14:52:07,258 - audio_feats_path: audio_feats.pkl
2024-03-07 14:52:07,258 - results_path: results
2024-03-07 14:52:07,258 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-07 14:52:07,258 - model_path: models
2024-03-07 14:52:07,258 - config_file_name: msz_MIntRec2
2024-03-07 14:52:07,258 - results_file_name: msz.csv
2024-03-07 14:52:07,258 - padding_mode: zero
2024-03-07 14:52:07,258 - padding_loc: end
2024-03-07 14:52:07,258 - need_aligned: False
2024-03-07 14:52:07,258 - eval_monitor: f1
2024-03-07 14:52:07,258 - train_batch_size: 32
2024-03-07 14:52:07,258 - eval_batch_size: 16
2024-03-07 14:52:07,258 - test_batch_size: 16
2024-03-07 14:52:07,258 - wait_patience: 8
2024-03-07 14:52:07,258 - hidden_dims: 768
2024-03-07 14:52:07,258 - num_attention_heads: 8
2024-03-07 14:52:07,258 - attention_probs_dropout_prob: 0.2
2024-03-07 14:52:07,258 - hidden_dropout_prob: 0.1
2024-03-07 14:52:07,258 - intermediate_size: 768
2024-03-07 14:52:07,258 - num_hidden_layers: 8
2024-03-07 14:52:07,258 - max_position_embeddings: 768
2024-03-07 14:52:07,258 - position_embedding_type: absolute
2024-03-07 14:52:07,258 - batch_first: True
2024-03-07 14:52:07,258 - dropout: 0.1
2024-03-07 14:52:07,258 - aligned_method: conv1d
2024-03-07 14:52:07,258 - num_train_epochs: 100
2024-03-07 14:52:07,258 - lr: 4e-06
2024-03-07 14:52:07,258 - lr_mode: min
2024-03-07 14:52:07,258 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-1_2024-03-07-14-52-07
2024-03-07 14:52:07,258 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-1_2024-03-07-14-52-07/models
2024-03-07 14:52:07,258 - num_labels: 30
2024-03-07 14:52:07,258 - text_feat_dim: 768
2024-03-07 14:52:07,258 - video_feat_dim: 256
2024-03-07 14:52:07,258 - audio_feat_dim: 768
2024-03-07 14:52:07,258 - text_seq_len: 50
2024-03-07 14:52:07,258 - video_seq_len: 180
2024-03-07 14:52:07,258 - audio_seq_len: 400
2024-03-07 14:52:07,259 - device: cuda:2
2024-03-07 14:52:07,259 - ============================== End Params ==============================
2024-03-07 14:52:07,308 - Generate Text Features Begin...
2024-03-07 14:52:08,940 - Generate Text Features Finished...
2024-03-07 14:52:08,941 - Load Video Features Begin...
2024-03-07 14:52:13,312 - Load Video Features Finished...
2024-03-07 14:52:14,975 - Load Audio Features Begin...
2024-03-07 14:52:40,226 - Load Audio Features Finished...
2024-03-07 14:52:53,354 - method  begins...
2024-03-07 14:52:55,808 - Multimodal intent recognition begins...
2024-03-07 14:52:55,809 - Training begins...
2024-03-07 14:54:15,770 - ***** Epoch: 1: Eval results *****
2024-03-07 14:54:15,770 -   train_loss = 2.7769
2024-03-07 14:54:15,770 -   best_eval_score = 0.0
2024-03-07 14:54:15,770 -   eval_score = 0.2613
2024-03-07 14:55:35,077 - ***** Epoch: 2: Eval results *****
2024-03-07 14:55:35,078 -   train_loss = 1.8122
2024-03-07 14:55:35,078 -   best_eval_score = 0.2613
2024-03-07 14:55:35,078 -   eval_score = 0.3536
2024-03-07 14:56:55,392 - ***** Epoch: 3: Eval results *****
2024-03-07 14:56:55,392 -   train_loss = 1.4302
2024-03-07 14:56:55,392 -   best_eval_score = 0.3536
2024-03-07 14:56:55,392 -   eval_score = 0.4346
2024-03-07 14:58:18,029 - ***** Epoch: 4: Eval results *****
2024-03-07 14:58:18,029 -   train_loss = 1.2063
2024-03-07 14:58:18,029 -   best_eval_score = 0.4346
2024-03-07 14:58:18,029 -   eval_score = 0.4731
2024-03-07 14:59:40,465 - ***** Epoch: 5: Eval results *****
2024-03-07 14:59:40,465 -   train_loss = 1.039
2024-03-07 14:59:40,465 -   best_eval_score = 0.4731
2024-03-07 14:59:40,465 -   eval_score = 0.487
2024-03-07 15:01:00,968 - ***** Epoch: 6: Eval results *****
2024-03-07 15:01:00,968 -   train_loss = 0.8982
2024-03-07 15:01:00,969 -   best_eval_score = 0.487
2024-03-07 15:01:00,969 -   eval_score = 0.4949
2024-03-07 15:02:21,532 - ***** Epoch: 7: Eval results *****
2024-03-07 15:02:21,532 -   train_loss = 0.7685
2024-03-07 15:02:21,532 -   best_eval_score = 0.4949
2024-03-07 15:02:21,533 -   eval_score = 0.492
2024-03-07 15:02:21,533 - EarlyStopping counter: 1 out of 8
2024-03-07 15:03:42,015 - ***** Epoch: 8: Eval results *****
2024-03-07 15:03:42,016 -   train_loss = 0.6376
2024-03-07 15:03:42,016 -   best_eval_score = 0.4949
2024-03-07 15:03:42,016 -   eval_score = 0.5166
2024-03-07 15:05:02,524 - ***** Epoch: 9: Eval results *****
2024-03-07 15:05:02,524 -   train_loss = 0.5309
2024-03-07 15:05:02,524 -   best_eval_score = 0.5166
2024-03-07 15:05:02,524 -   eval_score = 0.531
2024-03-07 15:06:23,066 - ***** Epoch: 10: Eval results *****
2024-03-07 15:06:23,066 -   train_loss = 0.434
2024-03-07 15:06:23,066 -   best_eval_score = 0.531
2024-03-07 15:06:23,066 -   eval_score = 0.5176
2024-03-07 15:06:23,066 - EarlyStopping counter: 1 out of 8
2024-03-07 15:07:43,723 - ***** Epoch: 11: Eval results *****
2024-03-07 15:07:43,723 -   train_loss = 0.3326
2024-03-07 15:07:43,723 -   best_eval_score = 0.531
2024-03-07 15:07:43,723 -   eval_score = 0.5386
2024-03-07 15:09:04,419 - ***** Epoch: 12: Eval results *****
2024-03-07 15:09:04,419 -   train_loss = 0.3147
2024-03-07 15:09:04,419 -   best_eval_score = 0.5386
2024-03-07 15:09:04,419 -   eval_score = 0.5404
2024-03-07 15:10:24,852 - ***** Epoch: 13: Eval results *****
2024-03-07 15:10:24,853 -   train_loss = 0.3049
2024-03-07 15:10:24,853 -   best_eval_score = 0.5404
2024-03-07 15:10:24,853 -   eval_score = 0.5321
2024-03-07 15:10:24,853 - EarlyStopping counter: 1 out of 8
2024-03-07 15:11:47,072 - ***** Epoch: 14: Eval results *****
2024-03-07 15:11:47,072 -   train_loss = 0.3028
2024-03-07 15:11:47,073 -   best_eval_score = 0.5404
2024-03-07 15:11:47,073 -   eval_score = 0.5418
2024-03-07 15:13:07,201 - ***** Epoch: 15: Eval results *****
2024-03-07 15:13:07,201 -   train_loss = 0.2896
2024-03-07 15:13:07,201 -   best_eval_score = 0.5418
2024-03-07 15:13:07,201 -   eval_score = 0.5354
2024-03-07 15:13:07,201 - EarlyStopping counter: 1 out of 8
2024-03-07 15:14:28,156 - ***** Epoch: 16: Eval results *****
2024-03-07 15:14:28,157 -   train_loss = 0.2815
2024-03-07 15:14:28,157 -   best_eval_score = 0.5418
2024-03-07 15:14:28,157 -   eval_score = 0.5421
2024-03-07 15:15:48,618 - ***** Epoch: 17: Eval results *****
2024-03-07 15:15:48,618 -   train_loss = 0.2795
2024-03-07 15:15:48,618 -   best_eval_score = 0.5421
2024-03-07 15:15:48,618 -   eval_score = 0.5462
2024-03-07 15:17:08,517 - ***** Epoch: 18: Eval results *****
2024-03-07 15:17:08,517 -   train_loss = 0.273
2024-03-07 15:17:08,517 -   best_eval_score = 0.5462
2024-03-07 15:17:08,517 -   eval_score = 0.535
2024-03-07 15:17:08,517 - EarlyStopping counter: 1 out of 8
2024-03-07 15:18:28,802 - ***** Epoch: 19: Eval results *****
2024-03-07 15:18:28,802 -   train_loss = 0.2629
2024-03-07 15:18:28,802 -   best_eval_score = 0.5462
2024-03-07 15:18:28,802 -   eval_score = 0.5423
2024-03-07 15:18:28,802 - EarlyStopping counter: 2 out of 8
2024-03-07 15:19:49,079 - ***** Epoch: 20: Eval results *****
2024-03-07 15:19:49,079 -   train_loss = 0.2471
2024-03-07 15:19:49,079 -   best_eval_score = 0.5462
2024-03-07 15:19:49,079 -   eval_score = 0.5443
2024-03-07 15:19:49,079 - EarlyStopping counter: 3 out of 8
2024-03-07 15:21:10,123 - ***** Epoch: 21: Eval results *****
2024-03-07 15:21:10,123 -   train_loss = 0.249
2024-03-07 15:21:10,123 -   best_eval_score = 0.5462
2024-03-07 15:21:10,123 -   eval_score = 0.5442
2024-03-07 15:21:10,123 - EarlyStopping counter: 4 out of 8
2024-03-07 15:22:31,068 - ***** Epoch: 22: Eval results *****
2024-03-07 15:22:31,068 -   train_loss = 0.2466
2024-03-07 15:22:31,068 -   best_eval_score = 0.5462
2024-03-07 15:22:31,068 -   eval_score = 0.5442
2024-03-07 15:22:31,068 - EarlyStopping counter: 5 out of 8
2024-03-07 15:23:51,214 - ***** Epoch: 23: Eval results *****
2024-03-07 15:23:51,215 -   train_loss = 0.2511
2024-03-07 15:23:51,215 -   best_eval_score = 0.5462
2024-03-07 15:23:51,215 -   eval_score = 0.5454
2024-03-07 15:23:51,215 - EarlyStopping counter: 6 out of 8
2024-03-07 15:25:12,450 - ***** Epoch: 24: Eval results *****
2024-03-07 15:25:12,450 -   train_loss = 0.2455
2024-03-07 15:25:12,450 -   best_eval_score = 0.5462
2024-03-07 15:25:12,450 -   eval_score = 0.5444
2024-03-07 15:25:12,450 - EarlyStopping counter: 7 out of 8
2024-03-07 15:26:33,001 - ***** Epoch: 25: Eval results *****
2024-03-07 15:26:33,002 -   train_loss = 0.246
2024-03-07 15:26:33,002 -   best_eval_score = 0.5462
2024-03-07 15:26:33,002 -   eval_score = 0.544
2024-03-07 15:26:33,002 - EarlyStopping counter: 8 out of 8
2024-03-07 15:26:33,002 - EarlyStopping at epoch 25
2024-03-07 15:26:33,008 - Training is finished...
2024-03-07 15:26:33,008 - Testing begins...
2024-03-07 15:26:43,762 - ***** Test: Confusion Matrix *****
2024-03-07 15:26:43,764 - [[ 49   0  13   0   0   0   0   0   1   0   2   0   0   0   0   0   0   0
    0   0   0   1   1   0   1   0   0   0   0   0]
 [  0  57   1   0   8   1   4   0   0   0   1   0   4   0   3   0   0   8
    1   1   1   1   1   0   1   0   0   4   0   0]
 [  9   0  45   0   1   0   0   0   0   0   1   0   0   0   1   1   0   2
    0   0   0   0   0   1   3   0   0   0   0   0]
 [  0   0   0  60   0   0   0   1   0   0   0   0   0   0   1   0   0   2
    0   0   0   0   0   0   0   0   0   1   0   0]
 [  0   6   0   0  30   1   0   0   0   0   0   0   0   0   0   0   0   6
    0   0   0   2   0   1   1   1   0   0   1   2]
 [  0   2   0   0   2  22   0   0   0   2   1   0   0   0   1   0   0   4
    0   0   0   0   0   1   0   1   0   0   0   1]
 [  0   1   0   0   0   2  29   6   0   2   3   0   5   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   6  27   0   1   5   0   5   0   0   0   2   0
    0   0   0   0   0   0   0   1   0   0   0   0]
 [  1   2   1   3   1   0   0   0  21   1   0   0   1   1   3   2   0   2
    0   0   1   0   6   0   2   1   0   0   0   0]
 [  0   1   1   1   1   0   0   0   2  57   0   6   6   0  10   0   0   7
    0   0   3   2   2   1   3   1   0   2   0   1]
 [  0   1   0   0   0   3   7   3   2   0  40   0  30   0   3   0   0   2
    0   1   0   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   1   0   0   6   1  21   6   0   1   0   0   2
    1   0   0   0   3   0   1   0   0   3   0   1]
 [  0   0   0   0   0   0   6  10   0   8  22   0  86   0   1   0   1   0
    0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   2   0   0   0   0   0   0   2   0   0   0   2   3   0   0   4
    2   0   0   0   1   0   0   0   0   1   0   0]
 [  0   2   1   0   0   0   1   0   3   6   2   1   0   2 122   0   0  25
    4   1   2   0  12   0   4   0   1   4   0   0]
 [  0   0   1   0   1   0   0   0   0   3   0   0   0   0   2   4   0   5
    1   0   0   1   0   0   0   0   0   3   1   0]
 [  0   0   0   0   1   0   0   2   1   0   2   0   1   0   0   0  52   0
    6   0   0   0   0   0   1   0   0   0   0   0]
 [  0   4   1   0   6   5   0   0   3  10   0   1   1   1  18   2   1 123
   10   2   2   4   4   7   1   2   2   2   1   4]
 [  0   2   1   0   0   0   1   0   0   4   1   0   0   1   8   0   1   6
   28   1   2   0   2   0   2   0   0   0   0   0]
 [  0   5   0   0   0   0   2   0   0   0   1   0   0   0   0   0   0   0
    0   8   0   1   0   0   0   0   0   0   0   0]
 [  1   2   2   0   1   0   0   0   0   2   0   1   1   0   4   0   0   4
    5   0   3   0   0   0   1   0   0   2   0   0]
 [  7   1   0   0   0   0   0   0   0   4   0   0   0   0   0   0   4   0
    0   0   0  26   0   6   1   0   1   2   0   1]
 [  0   0   1   1   0   0   0   0   1   4   0   2   1   1  12   1   0   3
    0   0   0   1  81   0   0   3   5   0   0   0]
 [  0   2   2   0   1   0   0   0   0   2   0   0   0   0   3   0   0   6
    0   0   0   2   0  20   0   0   0   0   0   0]
 [  1   0   2   0   0   0   0   0   2   1   1   2   0   0   3   0   0   2
    1   0   0   0   1   1  83   1   0  10   2   0]
 [  1   0   0   0   1   0   0   0   0   0   0   1   0   0   0   0   0   2
    0   0   0   0   3   0   1  20   0   0   0   2]
 [  0   0   0   1   0   1   0   0   0   2   0   0   0   0   3   0   0   3
    0   0   0   2   1   0   0   0   3   0   1   0]
 [  0   2   1   0   0   0   0   0   3   5   2   5   4   0   5   0   0   3
    1   0   0   0   2   1   8   2   0  13   1   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1
    0   0   0   0   0   0   0   0   0   0  56   0]
 [  0   3   0   0   1   0   0   0   1   2   1   1   0   0   0   0   0   3
    0   0   1   0   0   0   0   1   0   1   0   4]]
2024-03-07 15:26:43,764 - ***** Evaluation results *****
2024-03-07 15:26:43,764 -   acc = 0.5863
2024-03-07 15:26:43,764 -   f1 = 0.5283
2024-03-07 15:26:43,764 -   prec = 0.5395
2024-03-07 15:26:43,764 -   rec = 0.5255
2024-03-07 15:26:43,764 - Testing is finished...
2024-03-07 15:26:43,764 - Multimodal intent recognition is finished...
2024-03-07 15:26:43,764 - Results are saved in results/msz.csv
