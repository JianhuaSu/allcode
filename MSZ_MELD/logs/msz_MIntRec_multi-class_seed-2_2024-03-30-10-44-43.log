2024-03-30 10:44:44,035 - ============================== Params ==============================
2024-03-30 10:44:44,035 - logger_name: msz_MIntRec_multi-class_seed-2_2024-03-30-10-44-43
2024-03-30 10:44:44,035 - dataset: MIntRec
2024-03-30 10:44:44,035 - data_mode: multi-class
2024-03-30 10:44:44,035 - method: msz
2024-03-30 10:44:44,035 - text_backbone: bert-base-uncased
2024-03-30 10:44:44,035 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-30 10:44:44,035 - seed: 2
2024-03-30 10:44:44,035 - num_workers: 8
2024-03-30 10:44:44,035 - gpu_id: 3
2024-03-30 10:44:44,035 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-30 10:44:44,035 - train: True
2024-03-30 10:44:44,036 - tune: True
2024-03-30 10:44:44,036 - save_model: False
2024-03-30 10:44:44,036 - save_results: True
2024-03-30 10:44:44,036 - log_path: logs
2024-03-30 10:44:44,036 - cache_path: 
2024-03-30 10:44:44,036 - video_data_path: video_data
2024-03-30 10:44:44,036 - audio_data_path: audio_data
2024-03-30 10:44:44,036 - video_feats_path: video_feats.pkl
2024-03-30 10:44:44,036 - audio_feats_path: audio_feats.pkl
2024-03-30 10:44:44,036 - results_path: results
2024-03-30 10:44:44,036 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-03-30 10:44:44,036 - model_path: models
2024-03-30 10:44:44,036 - config_file_name: msz_MIntRec
2024-03-30 10:44:44,036 - results_file_name: msz.csv
2024-03-30 10:44:44,036 - padding_mode: zero
2024-03-30 10:44:44,036 - padding_loc: end
2024-03-30 10:44:44,036 - need_aligned: False
2024-03-30 10:44:44,036 - eval_monitor: f1
2024-03-30 10:44:44,036 - train_batch_size: 16
2024-03-30 10:44:44,036 - eval_batch_size: 8
2024-03-30 10:44:44,037 - test_batch_size: 8
2024-03-30 10:44:44,037 - wait_patience: 8
2024-03-30 10:44:44,037 - hidden_dims: 768
2024-03-30 10:44:44,037 - num_attention_heads: 8
2024-03-30 10:44:44,037 - attention_probs_dropout_prob: 0.2
2024-03-30 10:44:44,037 - hidden_dropout_prob: 0.4
2024-03-30 10:44:44,037 - intermediate_size: 768
2024-03-30 10:44:44,037 - num_hidden_layers: 6
2024-03-30 10:44:44,037 - max_position_embeddings: 768
2024-03-30 10:44:44,037 - position_embedding_type: absolute
2024-03-30 10:44:44,037 - batch_first: True
2024-03-30 10:44:44,037 - dropout: 0.1
2024-03-30 10:44:44,037 - aligned_method: conv1d
2024-03-30 10:44:44,037 - num_train_epochs: 100
2024-03-30 10:44:44,037 - lr: 6e-06
2024-03-30 10:44:44,037 - lr_mode: max
2024-03-30 10:44:44,037 - patience: 3
2024-03-30 10:44:44,037 - factor: 0.4
2024-03-30 10:44:44,038 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-03-30-10-44-43
2024-03-30 10:44:44,038 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-03-30-10-44-43/models
2024-03-30 10:44:44,038 - num_labels: 20
2024-03-30 10:44:44,038 - text_feat_dim: 768
2024-03-30 10:44:44,038 - video_feat_dim: 256
2024-03-30 10:44:44,038 - audio_feat_dim: 768
2024-03-30 10:44:44,038 - text_seq_len: 30
2024-03-30 10:44:44,038 - video_seq_len: 230
2024-03-30 10:44:44,038 - audio_seq_len: 480
2024-03-30 10:44:44,038 - device: cuda:3
2024-03-30 10:44:44,038 - ============================== End Params ==============================
2024-03-30 10:44:44,099 - Generate Text Features Begin...
2024-03-30 10:44:44,693 - Generate Text Features Finished...
2024-03-30 10:44:44,694 - Load Video Features Begin...
2024-03-30 10:44:46,102 - Load Video Features Finished...
2024-03-30 10:44:46,583 - Load Audio Features Begin...
2024-03-30 10:44:55,826 - Load Audio Features Finished...
2024-03-30 10:44:59,086 - method  begins...
2024-03-30 10:45:02,671 - Multimodal intent recognition begins...
2024-03-30 10:45:02,672 - Training begins...
2024-03-30 10:45:20,778 - ***** Epoch: 1: Eval results *****
2024-03-30 10:45:20,787 -   train_loss = 2.7224
2024-03-30 10:45:20,787 -   best_eval_score = 0.0
2024-03-30 10:45:20,787 -   eval_score = 0.1571
2024-03-30 10:45:38,392 - ***** Epoch: 2: Eval results *****
2024-03-30 10:45:38,392 -   train_loss = 1.9179
2024-03-30 10:45:38,392 -   best_eval_score = 0.1571
2024-03-30 10:45:38,393 -   eval_score = 0.4754
2024-03-30 10:45:56,105 - ***** Epoch: 3: Eval results *****
2024-03-30 10:45:56,105 -   train_loss = 1.1587
2024-03-30 10:45:56,105 -   best_eval_score = 0.4754
2024-03-30 10:45:56,105 -   eval_score = 0.554
2024-03-30 10:46:14,429 - ***** Epoch: 4: Eval results *****
2024-03-30 10:46:14,429 -   train_loss = 0.7041
2024-03-30 10:46:14,429 -   best_eval_score = 0.554
2024-03-30 10:46:14,429 -   eval_score = 0.6099
2024-03-30 10:46:32,275 - ***** Epoch: 5: Eval results *****
2024-03-30 10:46:32,275 -   train_loss = 0.4254
2024-03-30 10:46:32,275 -   best_eval_score = 0.6099
2024-03-30 10:46:32,275 -   eval_score = 0.6688
2024-03-30 10:46:50,023 - ***** Epoch: 6: Eval results *****
2024-03-30 10:46:50,023 -   train_loss = 0.2564
2024-03-30 10:46:50,023 -   best_eval_score = 0.6688
2024-03-30 10:46:50,023 -   eval_score = 0.6618
2024-03-30 10:46:50,023 - EarlyStopping counter: 1 out of 8
2024-03-30 10:47:07,749 - ***** Epoch: 7: Eval results *****
2024-03-30 10:47:07,749 -   train_loss = 0.1943
2024-03-30 10:47:07,749 -   best_eval_score = 0.6688
2024-03-30 10:47:07,749 -   eval_score = 0.6628
2024-03-30 10:47:07,749 - EarlyStopping counter: 2 out of 8
2024-03-30 10:47:25,223 - ***** Epoch: 8: Eval results *****
2024-03-30 10:47:25,223 -   train_loss = 0.1544
2024-03-30 10:47:25,223 -   best_eval_score = 0.6688
2024-03-30 10:47:25,223 -   eval_score = 0.6646
2024-03-30 10:47:25,223 - EarlyStopping counter: 3 out of 8
2024-03-30 10:47:42,843 - ***** Epoch: 9: Eval results *****
2024-03-30 10:47:42,843 -   train_loss = 0.1201
2024-03-30 10:47:42,843 -   best_eval_score = 0.6688
2024-03-30 10:47:42,843 -   eval_score = 0.6717
2024-03-30 10:48:00,941 - ***** Epoch: 10: Eval results *****
2024-03-30 10:48:00,942 -   train_loss = 0.0973
2024-03-30 10:48:00,942 -   best_eval_score = 0.6717
2024-03-30 10:48:00,942 -   eval_score = 0.6752
2024-03-30 10:48:18,764 - ***** Epoch: 11: Eval results *****
2024-03-30 10:48:18,764 -   train_loss = 0.0893
2024-03-30 10:48:18,765 -   best_eval_score = 0.6752
2024-03-30 10:48:18,765 -   eval_score = 0.6752
2024-03-30 10:48:36,884 - ***** Epoch: 12: Eval results *****
2024-03-30 10:48:36,884 -   train_loss = 0.0831
2024-03-30 10:48:36,884 -   best_eval_score = 0.6752
2024-03-30 10:48:36,884 -   eval_score = 0.6784
2024-03-30 10:48:55,371 - ***** Epoch: 13: Eval results *****
2024-03-30 10:48:55,371 -   train_loss = 0.0739
2024-03-30 10:48:55,371 -   best_eval_score = 0.6784
2024-03-30 10:48:55,371 -   eval_score = 0.6803
2024-03-30 10:49:13,069 - ***** Epoch: 14: Eval results *****
2024-03-30 10:49:13,070 -   train_loss = 0.0685
2024-03-30 10:49:13,070 -   best_eval_score = 0.6803
2024-03-30 10:49:13,070 -   eval_score = 0.6812
2024-03-30 10:49:30,408 - ***** Epoch: 15: Eval results *****
2024-03-30 10:49:30,408 -   train_loss = 0.0664
2024-03-30 10:49:30,408 -   best_eval_score = 0.6812
2024-03-30 10:49:30,408 -   eval_score = 0.6789
2024-03-30 10:49:30,408 - EarlyStopping counter: 1 out of 8
2024-03-30 10:49:47,930 - ***** Epoch: 16: Eval results *****
2024-03-30 10:49:47,930 -   train_loss = 0.0623
2024-03-30 10:49:47,930 -   best_eval_score = 0.6812
2024-03-30 10:49:47,931 -   eval_score = 0.681
2024-03-30 10:49:47,931 - EarlyStopping counter: 2 out of 8
2024-03-30 10:50:05,560 - ***** Epoch: 17: Eval results *****
2024-03-30 10:50:05,560 -   train_loss = 0.062
2024-03-30 10:50:05,560 -   best_eval_score = 0.6812
2024-03-30 10:50:05,560 -   eval_score = 0.6802
2024-03-30 10:50:05,560 - EarlyStopping counter: 3 out of 8
2024-03-30 10:50:23,143 - ***** Epoch: 18: Eval results *****
2024-03-30 10:50:23,143 -   train_loss = 0.058
2024-03-30 10:50:23,144 -   best_eval_score = 0.6812
2024-03-30 10:50:23,144 -   eval_score = 0.6804
2024-03-30 10:50:23,144 - EarlyStopping counter: 4 out of 8
2024-03-30 10:50:40,205 - ***** Epoch: 19: Eval results *****
2024-03-30 10:50:40,205 -   train_loss = 0.0584
2024-03-30 10:50:40,205 -   best_eval_score = 0.6812
2024-03-30 10:50:40,205 -   eval_score = 0.6811
2024-03-30 10:50:40,205 - EarlyStopping counter: 5 out of 8
2024-03-30 10:50:57,818 - ***** Epoch: 20: Eval results *****
2024-03-30 10:50:57,818 -   train_loss = 0.0564
2024-03-30 10:50:57,818 -   best_eval_score = 0.6812
2024-03-30 10:50:57,818 -   eval_score = 0.6791
2024-03-30 10:50:57,818 - EarlyStopping counter: 6 out of 8
2024-03-30 10:51:15,598 - ***** Epoch: 21: Eval results *****
2024-03-30 10:51:15,598 -   train_loss = 0.0577
2024-03-30 10:51:15,598 -   best_eval_score = 0.6812
2024-03-30 10:51:15,598 -   eval_score = 0.6789
2024-03-30 10:51:15,598 - EarlyStopping counter: 7 out of 8
2024-03-30 10:51:33,068 - ***** Epoch: 22: Eval results *****
2024-03-30 10:51:33,069 -   train_loss = 0.0547
2024-03-30 10:51:33,069 -   best_eval_score = 0.6812
2024-03-30 10:51:33,069 -   eval_score = 0.6789
2024-03-30 10:51:33,069 - EarlyStopping counter: 8 out of 8
2024-03-30 10:51:33,069 - EarlyStopping at epoch 22
2024-03-30 10:51:33,071 - Training is finished...
2024-03-30 10:51:33,071 - Testing begins...
2024-03-30 10:51:36,153 - ***** Test: Confusion Matrix *****
2024-03-30 10:51:36,153 - [[40  1  0  0  5  0  2  0  1  2  1  0  4  1  0  0  0  0  0  0]
 [ 0 36  0  1  0  2  0  0  0  0  1  0  2  0  1  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 6  0  0  0  9  0  1  0  0  1  0  1  2  0  1  0  0  2  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 2  1  0  0  3  0  1  0  3  0  0  0  1  0  0  0  1  0  0  0]
 [ 3  0  0  0  0  1  0  6  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  3  3  0  0  0  0  2  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  3  0  0  0  0  0  3  1  1  0  0]
 [ 1  0  0  0  0  0  0  0  0  2 14  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  0  1]
 [ 4  2  0  0  1  0  0  0  0  0  0  1 41  1  4  1  1  0  0  1]
 [ 1  1  0  0  0  0  1  0  0  0  1  1  1 17  2  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  0  0  0  0  2  2 14  0  1  0  0  2]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  2  0  0 17  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  3  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  2  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  1  0  2  0  0  6]]
2024-03-30 10:51:36,154 - ***** Evaluation results *****
2024-03-30 10:51:36,154 -   acc = 0.7124
2024-03-30 10:51:36,154 -   f1 = 0.6687
2024-03-30 10:51:36,154 -   prec = 0.6761
2024-03-30 10:51:36,154 -   rec = 0.668
2024-03-30 10:51:36,154 - Testing is finished...
2024-03-30 10:51:36,154 - Multimodal intent recognition is finished...
2024-03-30 10:51:36,154 - Results are saved in results/msz.csv
