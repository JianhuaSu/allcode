2023-12-28 07:55:58,818 - ============================== Params ==============================
2023-12-28 07:55:58,818 - logger_name: msz_MIntRec_multi-class_seed-9_2023-12-28-07-55-58
2023-12-28 07:55:58,818 - dataset: MIntRec
2023-12-28 07:55:58,818 - data_mode: multi-class
2023-12-28 07:55:58,818 - method: msz
2023-12-28 07:55:58,818 - text_backbone: bert-base-uncased
2023-12-28 07:55:58,818 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-28 07:55:58,818 - seed: 9
2023-12-28 07:55:58,818 - num_workers: 8
2023-12-28 07:55:58,818 - gpu_id: 3
2023-12-28 07:55:58,818 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-28 07:55:58,818 - train: True
2023-12-28 07:55:58,818 - tune: False
2023-12-28 07:55:58,818 - save_model: False
2023-12-28 07:55:58,819 - save_results: True
2023-12-28 07:55:58,819 - log_path: logs
2023-12-28 07:55:58,819 - cache_path: 
2023-12-28 07:55:58,819 - video_data_path: video_data
2023-12-28 07:55:58,819 - audio_data_path: audio_data
2023-12-28 07:55:58,819 - video_feats_path: video_feats.pkl
2023-12-28 07:55:58,819 - audio_feats_path: audio_feats.pkl
2023-12-28 07:55:58,819 - results_path: results
2023-12-28 07:55:58,819 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-28 07:55:58,819 - model_path: models
2023-12-28 07:55:58,819 - config_file_name: msz
2023-12-28 07:55:58,819 - results_file_name: msz.csv
2023-12-28 07:55:58,819 - padding_mode: zero
2023-12-28 07:55:58,819 - padding_loc: end
2023-12-28 07:55:58,819 - need_aligned: False
2023-12-28 07:55:58,819 - eval_monitor: f1
2023-12-28 07:55:58,819 - train_batch_size: 16
2023-12-28 07:55:58,819 - eval_batch_size: 8
2023-12-28 07:55:58,819 - test_batch_size: 8
2023-12-28 07:55:58,819 - wait_patience: 8
2023-12-28 07:55:58,819 - nheads: 2
2023-12-28 07:55:58,819 - encoder_layers: 2
2023-12-28 07:55:58,819 - attn_dropout: 0.1
2023-12-28 07:55:58,819 - relu_dropout: 0.1
2023-12-28 07:55:58,819 - embed_dropout: 0.1
2023-12-28 07:55:58,819 - res_dropout: 0.1
2023-12-28 07:55:58,819 - attn_mask: False
2023-12-28 07:55:58,819 - hidden_size: 768
2023-12-28 07:55:58,819 - num_attention_heads: 12
2023-12-28 07:55:58,819 - attention_probs_dropout_prob: 0.2
2023-12-28 07:55:58,819 - hidden_dropout_prob: 0.2
2023-12-28 07:55:58,819 - intermediate_size: 768
2023-12-28 07:55:58,819 - num_hidden_layers: 3
2023-12-28 07:55:58,819 - max_position_embeddings: 512
2023-12-28 07:55:58,819 - position_embedding_type: absolute
2023-12-28 07:55:58,819 - add_cross_attention: False
2023-12-28 07:55:58,819 - batch_first: True
2023-12-28 07:55:58,819 - hidden_dims: 768
2023-12-28 07:55:58,819 - att_dropouts: [0.2, 0.2, 0.2]
2023-12-28 07:55:58,820 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-28 07:55:58,820 - tv_c_loss: 0.01
2023-12-28 07:55:58,820 - vt_c_loss: 0.01
2023-12-28 07:55:58,820 - at_c_loss: 0.01
2023-12-28 07:55:58,820 - aligned_method: conv1d
2023-12-28 07:55:58,820 - grad_clip: 2
2023-12-28 07:55:58,820 - num_train_epochs: 100
2023-12-28 07:55:58,820 - warmup_proportion: 0.1
2023-12-28 07:55:58,820 - lr: 1e-06
2023-12-28 07:55:58,820 - weight_decay: 0.02
2023-12-28 07:55:58,820 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-9_2023-12-28-07-55-58
2023-12-28 07:55:58,820 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-9_2023-12-28-07-55-58/models
2023-12-28 07:55:58,820 - ============================== End Params ==============================
2023-12-28 07:55:58,912 - Generate Text Features Begin...
2023-12-28 07:55:59,512 - Generate Text Features Finished...
2023-12-28 07:55:59,519 - Load Video Features Begin...
2023-12-28 07:56:07,910 - Load Video Features Finished...
2023-12-28 07:56:08,496 - Load Audio Features Begin...
2023-12-28 07:56:20,177 - Load Audio Features Finished...
2023-12-28 07:56:23,995 - method  begins...
2023-12-28 07:56:29,879 - Multimodal intent recognition begins...
2023-12-28 07:56:29,879 - Training begins...
2023-12-28 07:56:53,166 - ***** Epoch: 1: Eval results *****
2023-12-28 07:56:53,166 -   train_loss = 3.6289
2023-12-28 07:56:53,166 -   best_eval_score = 0.0
2023-12-28 07:56:53,166 -   eval_score = 0.0224
2023-12-28 07:57:15,400 - ***** Epoch: 2: Eval results *****
2023-12-28 07:57:15,400 -   train_loss = 3.3674
2023-12-28 07:57:15,400 -   best_eval_score = 0.0224
2023-12-28 07:57:15,400 -   eval_score = 0.0292
2023-12-28 07:57:37,298 - ***** Epoch: 3: Eval results *****
2023-12-28 07:57:37,299 -   train_loss = 3.1481
2023-12-28 07:57:37,299 -   best_eval_score = 0.0292
2023-12-28 07:57:37,299 -   eval_score = 0.0683
2023-12-28 07:57:59,730 - ***** Epoch: 4: Eval results *****
2023-12-28 07:57:59,731 -   train_loss = 2.9424
2023-12-28 07:57:59,731 -   best_eval_score = 0.0683
2023-12-28 07:57:59,731 -   eval_score = 0.1588
2023-12-28 07:58:22,173 - ***** Epoch: 5: Eval results *****
2023-12-28 07:58:22,173 -   train_loss = 2.6543
2023-12-28 07:58:22,174 -   best_eval_score = 0.1588
2023-12-28 07:58:22,174 -   eval_score = 0.2681
2023-12-28 07:58:44,451 - ***** Epoch: 6: Eval results *****
2023-12-28 07:58:44,451 -   train_loss = 2.3174
2023-12-28 07:58:44,452 -   best_eval_score = 0.2681
2023-12-28 07:58:44,452 -   eval_score = 0.396
2023-12-28 07:59:07,408 - ***** Epoch: 7: Eval results *****
2023-12-28 07:59:07,408 -   train_loss = 1.9379
2023-12-28 07:59:07,408 -   best_eval_score = 0.396
2023-12-28 07:59:07,408 -   eval_score = 0.4959
2023-12-28 07:59:29,406 - ***** Epoch: 8: Eval results *****
2023-12-28 07:59:29,406 -   train_loss = 1.6062
2023-12-28 07:59:29,406 -   best_eval_score = 0.4959
2023-12-28 07:59:29,406 -   eval_score = 0.5289
2023-12-28 07:59:51,352 - ***** Epoch: 9: Eval results *****
2023-12-28 07:59:51,352 -   train_loss = 1.3191
2023-12-28 07:59:51,352 -   best_eval_score = 0.5289
2023-12-28 07:59:51,352 -   eval_score = 0.5814
2023-12-28 08:00:13,577 - ***** Epoch: 10: Eval results *****
2023-12-28 08:00:13,577 -   train_loss = 1.1017
2023-12-28 08:00:13,577 -   best_eval_score = 0.5814
2023-12-28 08:00:13,577 -   eval_score = 0.5952
2023-12-28 08:00:35,962 - ***** Epoch: 11: Eval results *****
2023-12-28 08:00:35,962 -   train_loss = 0.9083
2023-12-28 08:00:35,962 -   best_eval_score = 0.5952
2023-12-28 08:00:35,962 -   eval_score = 0.578
2023-12-28 08:00:35,962 - EarlyStopping counter: 1 out of 8
2023-12-28 08:00:59,060 - ***** Epoch: 12: Eval results *****
2023-12-28 08:00:59,060 -   train_loss = 0.7575
2023-12-28 08:00:59,060 -   best_eval_score = 0.5952
2023-12-28 08:00:59,060 -   eval_score = 0.6256
2023-12-28 08:01:21,747 - ***** Epoch: 13: Eval results *****
2023-12-28 08:01:21,747 -   train_loss = 0.6394
2023-12-28 08:01:21,747 -   best_eval_score = 0.6256
2023-12-28 08:01:21,747 -   eval_score = 0.5868
2023-12-28 08:01:21,747 - EarlyStopping counter: 1 out of 8
2023-12-28 08:01:44,253 - ***** Epoch: 14: Eval results *****
2023-12-28 08:01:44,253 -   train_loss = 0.5307
2023-12-28 08:01:44,253 -   best_eval_score = 0.6256
2023-12-28 08:01:44,253 -   eval_score = 0.6085
2023-12-28 08:01:44,253 - EarlyStopping counter: 2 out of 8
2023-12-28 08:02:06,473 - ***** Epoch: 15: Eval results *****
2023-12-28 08:02:06,474 -   train_loss = 0.4233
2023-12-28 08:02:06,474 -   best_eval_score = 0.6256
2023-12-28 08:02:06,474 -   eval_score = 0.6329
2023-12-28 08:02:28,427 - ***** Epoch: 16: Eval results *****
2023-12-28 08:02:28,435 -   train_loss = 0.3608
2023-12-28 08:02:28,436 -   best_eval_score = 0.6329
2023-12-28 08:02:28,436 -   eval_score = 0.636
2023-12-28 08:02:51,446 - ***** Epoch: 17: Eval results *****
2023-12-28 08:02:51,446 -   train_loss = 0.2924
2023-12-28 08:02:51,446 -   best_eval_score = 0.636
2023-12-28 08:02:51,446 -   eval_score = 0.6669
2023-12-28 08:03:15,854 - ***** Epoch: 18: Eval results *****
2023-12-28 08:03:15,862 -   train_loss = 0.2409
2023-12-28 08:03:15,862 -   best_eval_score = 0.6669
2023-12-28 08:03:15,862 -   eval_score = 0.6694
2023-12-28 08:03:38,280 - ***** Epoch: 19: Eval results *****
2023-12-28 08:03:38,280 -   train_loss = 0.2071
2023-12-28 08:03:38,280 -   best_eval_score = 0.6694
2023-12-28 08:03:38,280 -   eval_score = 0.6682
2023-12-28 08:03:38,280 - EarlyStopping counter: 1 out of 8
2023-12-28 08:04:00,316 - ***** Epoch: 20: Eval results *****
2023-12-28 08:04:00,316 -   train_loss = 0.1657
2023-12-28 08:04:00,316 -   best_eval_score = 0.6694
2023-12-28 08:04:00,316 -   eval_score = 0.6628
2023-12-28 08:04:00,316 - EarlyStopping counter: 2 out of 8
2023-12-28 08:04:23,745 - ***** Epoch: 21: Eval results *****
2023-12-28 08:04:23,745 -   train_loss = 0.1426
2023-12-28 08:04:23,745 -   best_eval_score = 0.6694
2023-12-28 08:04:23,745 -   eval_score = 0.6802
2023-12-28 08:04:45,138 - ***** Epoch: 22: Eval results *****
2023-12-28 08:04:45,139 -   train_loss = 0.1261
2023-12-28 08:04:45,139 -   best_eval_score = 0.6802
2023-12-28 08:04:45,139 -   eval_score = 0.6547
2023-12-28 08:04:45,139 - EarlyStopping counter: 1 out of 8
2023-12-28 08:05:06,392 - ***** Epoch: 23: Eval results *****
2023-12-28 08:05:06,392 -   train_loss = 0.109
2023-12-28 08:05:06,392 -   best_eval_score = 0.6802
2023-12-28 08:05:06,392 -   eval_score = 0.6564
2023-12-28 08:05:06,392 - EarlyStopping counter: 2 out of 8
2023-12-28 08:05:27,431 - ***** Epoch: 24: Eval results *****
2023-12-28 08:05:27,431 -   train_loss = 0.0924
2023-12-28 08:05:27,432 -   best_eval_score = 0.6802
2023-12-28 08:05:27,432 -   eval_score = 0.6529
2023-12-28 08:05:27,432 - EarlyStopping counter: 3 out of 8
2023-12-28 08:05:48,716 - ***** Epoch: 25: Eval results *****
2023-12-28 08:05:48,716 -   train_loss = 0.077
2023-12-28 08:05:48,717 -   best_eval_score = 0.6802
2023-12-28 08:05:48,717 -   eval_score = 0.6603
2023-12-28 08:05:48,717 - EarlyStopping counter: 4 out of 8
2023-12-28 08:06:10,053 - ***** Epoch: 26: Eval results *****
2023-12-28 08:06:10,053 -   train_loss = 0.0691
2023-12-28 08:06:10,053 -   best_eval_score = 0.6802
2023-12-28 08:06:10,053 -   eval_score = 0.6547
2023-12-28 08:06:10,053 - EarlyStopping counter: 5 out of 8
2023-12-28 08:06:31,154 - ***** Epoch: 27: Eval results *****
2023-12-28 08:06:31,154 -   train_loss = 0.0622
2023-12-28 08:06:31,154 -   best_eval_score = 0.6802
2023-12-28 08:06:31,154 -   eval_score = 0.6626
2023-12-28 08:06:31,154 - EarlyStopping counter: 6 out of 8
2023-12-28 08:06:52,605 - ***** Epoch: 28: Eval results *****
2023-12-28 08:06:52,606 -   train_loss = 0.0572
2023-12-28 08:06:52,606 -   best_eval_score = 0.6802
2023-12-28 08:06:52,606 -   eval_score = 0.6494
2023-12-28 08:06:52,606 - EarlyStopping counter: 7 out of 8
2023-12-28 08:07:13,852 - ***** Epoch: 29: Eval results *****
2023-12-28 08:07:13,852 -   train_loss = 0.0508
2023-12-28 08:07:13,852 -   best_eval_score = 0.6802
2023-12-28 08:07:13,852 -   eval_score = 0.6426
2023-12-28 08:07:13,852 - EarlyStopping counter: 8 out of 8
2023-12-28 08:07:13,852 - EarlyStopping at epoch 29
2023-12-28 08:07:13,854 - Training is finished...
2023-12-28 08:07:13,854 - Testing begins...
2023-12-28 08:07:17,147 - ***** Test: Confusion Matrix *****
2023-12-28 08:07:17,148 - [[25  0  0  0 14  0  3  3  0  4  0  0  6  2  0  0  0  0  0  0]
 [ 0 37  0  1  1  0  2  1  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 0  0 26  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0 13  0  3  0  0  1  0  0  2  1  1  0  0  1  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  2  0  5  0  3  0  0  0  1  0  0  0  1  0  0  0]
 [ 2  0  0  0  0  0  1  7  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  2  3  2  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  1  1  0  3  0  0  0  0  0  3  0  1  0  0]
 [ 1  0  0  0  0  0  2  0  0  1 13  0  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  0  0  2  0  0  0  0 16  1  0  0  0  0  0  0  0]
 [ 1  0  0  1  2  0  2  2  2  0  0  0 40  0  3  2  0  0  1  1]
 [ 0  0  0  0  1  0  4  0  0  0  1  1  1 15  2  0  0  0  0  0]
 [ 0  0  1  0  0  0  2  0  0  0  0  0  1  2 13  0  1  0  0  2]
 [ 0  0  0  0  1  0  0  1  1  0  0  0  2  0  0 15  0  0  0  1]
 [ 1  0  0  0  0  0  0  1  0  0  0  0  1  0  2  1 11  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  1  1  0  1  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  0 10  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  1  1  1  0  0  0  0  6]]
2023-12-28 08:07:17,149 - ***** Evaluation results *****
2023-12-28 08:07:17,149 -   acc = 0.6854
2023-12-28 08:07:17,149 -   f1 = 0.6652
2023-12-28 08:07:17,149 -   prec = 0.68
2023-12-28 08:07:17,149 -   rec = 0.6714
2023-12-28 08:07:17,149 - Testing is finished...
2023-12-28 08:07:17,149 - Multimodal intent recognition is finished...
2023-12-28 08:07:17,149 - Results are saved in results/msz.csv
