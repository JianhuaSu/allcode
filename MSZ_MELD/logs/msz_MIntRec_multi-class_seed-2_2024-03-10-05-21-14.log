2024-03-10 05:21:14,513 - ============================== Params ==============================
2024-03-10 05:21:14,513 - logger_name: msz_MIntRec_multi-class_seed-2_2024-03-10-05-21-14
2024-03-10 05:21:14,513 - dataset: MIntRec
2024-03-10 05:21:14,513 - data_mode: multi-class
2024-03-10 05:21:14,513 - method: msz
2024-03-10 05:21:14,513 - text_backbone: bert-base-uncased
2024-03-10 05:21:14,513 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-10 05:21:14,513 - seed: 2
2024-03-10 05:21:14,513 - num_workers: 8
2024-03-10 05:21:14,513 - gpu_id: 2
2024-03-10 05:21:14,513 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-10 05:21:14,513 - train: True
2024-03-10 05:21:14,513 - tune: True
2024-03-10 05:21:14,513 - save_model: False
2024-03-10 05:21:14,513 - save_results: True
2024-03-10 05:21:14,513 - log_path: logs
2024-03-10 05:21:14,513 - cache_path: 
2024-03-10 05:21:14,513 - video_data_path: video_data
2024-03-10 05:21:14,513 - audio_data_path: audio_data
2024-03-10 05:21:14,513 - video_feats_path: video_feats.pkl
2024-03-10 05:21:14,513 - audio_feats_path: audio_feats.pkl
2024-03-10 05:21:14,513 - results_path: results
2024-03-10 05:21:14,513 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-03-10 05:21:14,514 - model_path: models
2024-03-10 05:21:14,514 - config_file_name: msz_MIntRec
2024-03-10 05:21:14,514 - results_file_name: msz.csv
2024-03-10 05:21:14,514 - padding_mode: zero
2024-03-10 05:21:14,514 - padding_loc: end
2024-03-10 05:21:14,514 - need_aligned: False
2024-03-10 05:21:14,514 - eval_monitor: f1
2024-03-10 05:21:14,514 - train_batch_size: 16
2024-03-10 05:21:14,514 - eval_batch_size: 8
2024-03-10 05:21:14,514 - test_batch_size: 8
2024-03-10 05:21:14,514 - wait_patience: 8
2024-03-10 05:21:14,514 - hidden_dims: 768
2024-03-10 05:21:14,514 - intermediate_size: 768
2024-03-10 05:21:14,514 - position_embedding_type: absolute
2024-03-10 05:21:14,514 - batch_first: True
2024-03-10 05:21:14,514 - d_num_attention_heads: 8
2024-03-10 05:21:14,514 - d_attention_probs_dropout_prob: 0.2
2024-03-10 05:21:14,514 - d_hidden_dropout_prob: 0.2
2024-03-10 05:21:14,514 - d_num_hidden_layers: 10
2024-03-10 05:21:14,514 - d_max_position_embeddings: 768
2024-03-10 05:21:14,514 - m_num_attention_heads: 12
2024-03-10 05:21:14,514 - m_attention_probs_dropout_prob: 0.1
2024-03-10 05:21:14,514 - m_hidden_dropout_prob: 0.3
2024-03-10 05:21:14,514 - m_num_hidden_layers: 8
2024-03-10 05:21:14,514 - m_max_position_embeddings: 1024
2024-03-10 05:21:14,514 - dropout: 0.2
2024-03-10 05:21:14,514 - aligned_method: conv1d
2024-03-10 05:21:14,514 - num_train_epochs: 100
2024-03-10 05:21:14,514 - lr: 3e-06
2024-03-10 05:21:14,514 - lr_mode: min
2024-03-10 05:21:14,514 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-03-10-05-21-14
2024-03-10 05:21:14,514 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-03-10-05-21-14/models
2024-03-10 05:21:14,514 - ============================== End Params ==============================
2024-03-10 05:21:14,517 - Generate Text Features Begin...
2024-03-10 05:21:14,988 - Generate Text Features Finished...
2024-03-10 05:21:14,989 - Load Video Features Begin...
2024-03-10 05:21:15,294 - Load Video Features Finished...
2024-03-10 05:21:15,793 - Load Audio Features Begin...
2024-03-10 05:21:16,669 - Load Audio Features Finished...
2024-03-10 05:21:19,910 - method  begins...
2024-03-10 05:21:22,961 - Multimodal intent recognition begins...
2024-03-10 05:21:22,961 - Training begins...
2024-03-10 05:21:47,152 - ***** Epoch: 1: Eval results *****
2024-03-10 05:21:47,152 -   train_loss = 2.7992
2024-03-10 05:21:47,152 -   best_eval_score = 0.0
2024-03-10 05:21:47,152 -   eval_score = 0.154
2024-03-10 05:22:08,915 - ***** Epoch: 2: Eval results *****
2024-03-10 05:22:08,915 -   train_loss = 2.2973
2024-03-10 05:22:08,915 -   best_eval_score = 0.154
2024-03-10 05:22:08,915 -   eval_score = 0.3647
2024-03-10 05:22:31,341 - ***** Epoch: 3: Eval results *****
2024-03-10 05:22:31,341 -   train_loss = 1.7388
2024-03-10 05:22:31,341 -   best_eval_score = 0.3647
2024-03-10 05:22:31,341 -   eval_score = 0.4657
2024-03-10 05:22:53,334 - ***** Epoch: 4: Eval results *****
2024-03-10 05:22:53,334 -   train_loss = 1.3096
2024-03-10 05:22:53,334 -   best_eval_score = 0.4657
2024-03-10 05:22:53,334 -   eval_score = 0.5304
2024-03-10 05:23:15,168 - ***** Epoch: 5: Eval results *****
2024-03-10 05:23:15,168 -   train_loss = 0.973
2024-03-10 05:23:15,168 -   best_eval_score = 0.5304
2024-03-10 05:23:15,168 -   eval_score = 0.5641
2024-03-10 05:23:37,134 - ***** Epoch: 6: Eval results *****
2024-03-10 05:23:37,134 -   train_loss = 0.7156
2024-03-10 05:23:37,134 -   best_eval_score = 0.5641
2024-03-10 05:23:37,134 -   eval_score = 0.6055
2024-03-10 05:23:59,729 - ***** Epoch: 7: Eval results *****
2024-03-10 05:23:59,729 -   train_loss = 0.5229
2024-03-10 05:23:59,729 -   best_eval_score = 0.6055
2024-03-10 05:23:59,729 -   eval_score = 0.658
2024-03-10 05:24:22,101 - ***** Epoch: 8: Eval results *****
2024-03-10 05:24:22,101 -   train_loss = 0.3703
2024-03-10 05:24:22,101 -   best_eval_score = 0.658
2024-03-10 05:24:22,101 -   eval_score = 0.6758
2024-03-10 05:24:44,278 - ***** Epoch: 9: Eval results *****
2024-03-10 05:24:44,278 -   train_loss = 0.271
2024-03-10 05:24:44,278 -   best_eval_score = 0.6758
2024-03-10 05:24:44,278 -   eval_score = 0.6573
2024-03-10 05:24:44,278 - EarlyStopping counter: 1 out of 8
2024-03-10 05:25:06,656 - ***** Epoch: 10: Eval results *****
2024-03-10 05:25:06,656 -   train_loss = 0.1911
2024-03-10 05:25:06,656 -   best_eval_score = 0.6758
2024-03-10 05:25:06,656 -   eval_score = 0.6664
2024-03-10 05:25:06,656 - EarlyStopping counter: 2 out of 8
2024-03-10 05:25:28,963 - ***** Epoch: 11: Eval results *****
2024-03-10 05:25:28,963 -   train_loss = 0.1458
2024-03-10 05:25:28,964 -   best_eval_score = 0.6758
2024-03-10 05:25:28,964 -   eval_score = 0.6696
2024-03-10 05:25:28,964 - EarlyStopping counter: 3 out of 8
2024-03-10 05:25:50,608 - ***** Epoch: 12: Eval results *****
2024-03-10 05:25:50,608 -   train_loss = 0.1372
2024-03-10 05:25:50,608 -   best_eval_score = 0.6758
2024-03-10 05:25:50,608 -   eval_score = 0.6675
2024-03-10 05:25:50,609 - EarlyStopping counter: 4 out of 8
2024-03-10 05:26:11,416 - ***** Epoch: 13: Eval results *****
2024-03-10 05:26:11,416 -   train_loss = 0.1276
2024-03-10 05:26:11,416 -   best_eval_score = 0.6758
2024-03-10 05:26:11,416 -   eval_score = 0.6736
2024-03-10 05:26:11,416 - EarlyStopping counter: 5 out of 8
2024-03-10 05:26:33,567 - ***** Epoch: 14: Eval results *****
2024-03-10 05:26:33,567 -   train_loss = 0.1255
2024-03-10 05:26:33,567 -   best_eval_score = 0.6758
2024-03-10 05:26:33,567 -   eval_score = 0.6716
2024-03-10 05:26:33,567 - EarlyStopping counter: 6 out of 8
2024-03-10 05:26:55,983 - ***** Epoch: 15: Eval results *****
2024-03-10 05:26:55,983 -   train_loss = 0.1247
2024-03-10 05:26:55,983 -   best_eval_score = 0.6758
2024-03-10 05:26:55,983 -   eval_score = 0.6712
2024-03-10 05:26:55,983 - EarlyStopping counter: 7 out of 8
2024-03-10 05:27:18,017 - ***** Epoch: 16: Eval results *****
2024-03-10 05:27:18,017 -   train_loss = 0.1153
2024-03-10 05:27:18,017 -   best_eval_score = 0.6758
2024-03-10 05:27:18,017 -   eval_score = 0.6713
2024-03-10 05:27:18,017 - EarlyStopping counter: 8 out of 8
2024-03-10 05:27:18,017 - EarlyStopping at epoch 16
2024-03-10 05:27:18,020 - Training is finished...
2024-03-10 05:27:18,021 - Testing begins...
2024-03-10 05:27:21,493 - ***** Test: Confusion Matrix *****
2024-03-10 05:27:21,494 - [[41  1  0  0  8  0  0  0  0  1  1  0  4  1  0  0  0  0  0  0]
 [ 0 35  0  1  0  2  1  0  0  1  0  0  3  0  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 6  0  0  0 11  0  1  0  0  0  0  1  2  1  0  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 1  1  0  0  4  0  1  0  2  0  0  0  1  0  0  1  1  0  0  0]
 [ 4  0  0  0  0  1  0  4  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  5  2  0  0  0  0  2  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  4  0  0  0  0  0  2  1  1  0  0]
 [ 1  0  0  0  0  0  1  0  0  2 12  0  0  0  1  0  1  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  0  1]
 [ 4  2  0  0  1  0  0  2  1  0  0  2 35  2  3  1  3  0  1  0]
 [ 0  0  0  0  0  1  2  0  0  0  1  1  0 20  0  0  0  0  0  0]
 [ 0  0  1  0  1  0  0  0  1  0  0  0  1  3 13  0  1  0  0  1]
 [ 0  2  0  0  0  0  0  0  0  0  0  0  3  1  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  2  0  1  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  1  1  1  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0 10  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  1  1  2  0  1  0  0  4]]
2024-03-10 05:27:21,494 - ***** Evaluation results *****
2024-03-10 05:27:21,494 -   acc = 0.6921
2024-03-10 05:27:21,494 -   f1 = 0.6439
2024-03-10 05:27:21,494 -   prec = 0.6544
2024-03-10 05:27:21,494 -   rec = 0.644
2024-03-10 05:27:21,494 - Testing is finished...
2024-03-10 05:27:21,494 - Multimodal intent recognition is finished...
2024-03-10 05:27:21,494 - Results are saved in results/msz.csv
