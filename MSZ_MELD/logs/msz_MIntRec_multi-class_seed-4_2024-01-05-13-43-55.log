2024-01-05 13:43:56,036 - ============================== Params ==============================
2024-01-05 13:43:56,036 - logger_name: msz_MIntRec_multi-class_seed-4_2024-01-05-13-43-55
2024-01-05 13:43:56,036 - dataset: MIntRec
2024-01-05 13:43:56,036 - data_mode: multi-class
2024-01-05 13:43:56,036 - method: msz
2024-01-05 13:43:56,036 - text_backbone: bert-base-uncased
2024-01-05 13:43:56,036 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-05 13:43:56,036 - seed: 4
2024-01-05 13:43:56,036 - num_workers: 8
2024-01-05 13:43:56,036 - gpu_id: 1
2024-01-05 13:43:56,036 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-05 13:43:56,036 - train: True
2024-01-05 13:43:56,036 - tune: False
2024-01-05 13:43:56,036 - save_model: False
2024-01-05 13:43:56,036 - save_results: True
2024-01-05 13:43:56,036 - log_path: logs
2024-01-05 13:43:56,036 - cache_path: 
2024-01-05 13:43:56,036 - video_data_path: video_data
2024-01-05 13:43:56,037 - audio_data_path: audio_data
2024-01-05 13:43:56,037 - video_feats_path: video_feats.pkl
2024-01-05 13:43:56,037 - audio_feats_path: audio_feats.pkl
2024-01-05 13:43:56,037 - results_path: results
2024-01-05 13:43:56,037 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-05 13:43:56,037 - model_path: models
2024-01-05 13:43:56,037 - config_file_name: msz
2024-01-05 13:43:56,037 - results_file_name: msz.csv
2024-01-05 13:43:56,037 - padding_mode: zero
2024-01-05 13:43:56,037 - padding_loc: end
2024-01-05 13:43:56,037 - need_aligned: False
2024-01-05 13:43:56,037 - eval_monitor: f1
2024-01-05 13:43:56,037 - train_batch_size: 16
2024-01-05 13:43:56,037 - eval_batch_size: 8
2024-01-05 13:43:56,037 - test_batch_size: 8
2024-01-05 13:43:56,037 - wait_patience: 8
2024-01-05 13:43:56,037 - nheads: 2
2024-01-05 13:43:56,037 - encoder_layers: 2
2024-01-05 13:43:56,037 - attn_dropout: 0.1
2024-01-05 13:43:56,037 - relu_dropout: 0.1
2024-01-05 13:43:56,037 - embed_dropout: 0.1
2024-01-05 13:43:56,037 - res_dropout: 0.1
2024-01-05 13:43:56,037 - attn_mask: False
2024-01-05 13:43:56,037 - hidden_size: 768
2024-01-05 13:43:56,037 - num_attention_heads: 12
2024-01-05 13:43:56,037 - attention_probs_dropout_prob: 0.2
2024-01-05 13:43:56,037 - hidden_dropout_prob: 0.2
2024-01-05 13:43:56,037 - intermediate_size: 768
2024-01-05 13:43:56,037 - num_hidden_layers: 3
2024-01-05 13:43:56,037 - max_position_embeddings: 512
2024-01-05 13:43:56,037 - position_embedding_type: absolute
2024-01-05 13:43:56,037 - batch_first: True
2024-01-05 13:43:56,037 - hidden_dims: 768
2024-01-05 13:43:56,037 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-05 13:43:56,037 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-05 13:43:56,037 - ta_loss: 0.1
2024-01-05 13:43:56,037 - tv_loss: 0.1
2024-01-05 13:43:56,037 - av_loss: 0.1
2024-01-05 13:43:56,038 - aligned_method: conv1d
2024-01-05 13:43:56,038 - grad_clip: -1
2024-01-05 13:43:56,038 - num_train_epochs: 100
2024-01-05 13:43:56,038 - warmup_proportion: 0.1
2024-01-05 13:43:56,038 - lr: 1e-06
2024-01-05 13:43:56,038 - weight_decay: 0.01
2024-01-05 13:43:56,038 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-05-13-43-55
2024-01-05 13:43:56,038 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-05-13-43-55/models
2024-01-05 13:43:56,038 - ============================== End Params ==============================
2024-01-05 13:43:56,040 - Generate Text Features Begin...
2024-01-05 13:43:56,542 - Generate Text Features Finished...
2024-01-05 13:43:56,543 - Load Video Features Begin...
2024-01-05 13:43:56,858 - Load Video Features Finished...
2024-01-05 13:43:57,418 - Load Audio Features Begin...
2024-01-05 13:43:58,416 - Load Audio Features Finished...
2024-01-05 13:44:01,857 - method  begins...
2024-01-05 13:44:05,700 - Multimodal intent recognition begins...
2024-01-05 13:44:05,700 - Training begins...
2024-01-05 13:44:30,091 - ***** Epoch: 1: Eval results *****
2024-01-05 13:44:30,091 -   train_loss = 2.9961
2024-01-05 13:44:30,091 -   best_eval_score = 0.0
2024-01-05 13:44:30,091 -   eval_score = 0.0448
2024-01-05 13:44:52,817 - ***** Epoch: 2: Eval results *****
2024-01-05 13:44:52,818 -   train_loss = 2.9709
2024-01-05 13:44:52,818 -   best_eval_score = 0.0448
2024-01-05 13:44:52,818 -   eval_score = 0.1319
2024-01-05 13:45:15,455 - ***** Epoch: 3: Eval results *****
2024-01-05 13:45:15,455 -   train_loss = 2.9231
2024-01-05 13:45:15,455 -   best_eval_score = 0.1319
2024-01-05 13:45:15,455 -   eval_score = 0.137
2024-01-05 13:45:38,019 - ***** Epoch: 4: Eval results *****
2024-01-05 13:45:38,019 -   train_loss = 2.8544
2024-01-05 13:45:38,019 -   best_eval_score = 0.137
2024-01-05 13:45:38,019 -   eval_score = 0.1707
2024-01-05 13:46:00,754 - ***** Epoch: 5: Eval results *****
2024-01-05 13:46:00,754 -   train_loss = 2.7561
2024-01-05 13:46:00,754 -   best_eval_score = 0.1707
2024-01-05 13:46:00,754 -   eval_score = 0.1919
2024-01-05 13:46:23,371 - ***** Epoch: 6: Eval results *****
2024-01-05 13:46:23,371 -   train_loss = 2.5944
2024-01-05 13:46:23,371 -   best_eval_score = 0.1919
2024-01-05 13:46:23,371 -   eval_score = 0.1782
2024-01-05 13:46:23,371 - EarlyStopping counter: 1 out of 8
2024-01-05 13:46:46,189 - ***** Epoch: 7: Eval results *****
2024-01-05 13:46:46,189 -   train_loss = 2.3226
2024-01-05 13:46:46,189 -   best_eval_score = 0.1919
2024-01-05 13:46:46,189 -   eval_score = 0.1994
2024-01-05 13:47:08,997 - ***** Epoch: 8: Eval results *****
2024-01-05 13:47:08,998 -   train_loss = 1.9367
2024-01-05 13:47:08,998 -   best_eval_score = 0.1994
2024-01-05 13:47:08,998 -   eval_score = 0.2527
2024-01-05 13:47:31,968 - ***** Epoch: 9: Eval results *****
2024-01-05 13:47:31,968 -   train_loss = 1.5053
2024-01-05 13:47:31,969 -   best_eval_score = 0.2527
2024-01-05 13:47:31,969 -   eval_score = 0.4813
2024-01-05 13:47:54,245 - ***** Epoch: 10: Eval results *****
2024-01-05 13:47:54,246 -   train_loss = 1.2949
2024-01-05 13:47:54,246 -   best_eval_score = 0.4813
2024-01-05 13:47:54,246 -   eval_score = 0.5199
2024-01-05 13:48:16,987 - ***** Epoch: 11: Eval results *****
2024-01-05 13:48:16,987 -   train_loss = 1.0762
2024-01-05 13:48:16,987 -   best_eval_score = 0.5199
2024-01-05 13:48:16,987 -   eval_score = 0.5043
2024-01-05 13:48:16,988 - EarlyStopping counter: 1 out of 8
2024-01-05 13:48:39,635 - ***** Epoch: 12: Eval results *****
2024-01-05 13:48:39,636 -   train_loss = 0.9696
2024-01-05 13:48:39,636 -   best_eval_score = 0.5199
2024-01-05 13:48:39,636 -   eval_score = 0.5258
2024-01-05 13:49:01,971 - ***** Epoch: 13: Eval results *****
2024-01-05 13:49:01,971 -   train_loss = 0.8141
2024-01-05 13:49:01,971 -   best_eval_score = 0.5258
2024-01-05 13:49:01,971 -   eval_score = 0.5368
2024-01-05 13:49:24,570 - ***** Epoch: 14: Eval results *****
2024-01-05 13:49:24,571 -   train_loss = 0.6298
2024-01-05 13:49:24,571 -   best_eval_score = 0.5368
2024-01-05 13:49:24,571 -   eval_score = 0.5433
2024-01-05 13:49:47,036 - ***** Epoch: 15: Eval results *****
2024-01-05 13:49:47,036 -   train_loss = 0.4831
2024-01-05 13:49:47,036 -   best_eval_score = 0.5433
2024-01-05 13:49:47,036 -   eval_score = 0.5891
2024-01-05 13:50:09,362 - ***** Epoch: 16: Eval results *****
2024-01-05 13:50:09,363 -   train_loss = 0.3803
2024-01-05 13:50:09,363 -   best_eval_score = 0.5891
2024-01-05 13:50:09,363 -   eval_score = 0.625
2024-01-05 13:50:31,794 - ***** Epoch: 17: Eval results *****
2024-01-05 13:50:31,794 -   train_loss = 0.3002
2024-01-05 13:50:31,794 -   best_eval_score = 0.625
2024-01-05 13:50:31,794 -   eval_score = 0.6032
2024-01-05 13:50:31,794 - EarlyStopping counter: 1 out of 8
2024-01-05 13:50:54,066 - ***** Epoch: 18: Eval results *****
2024-01-05 13:50:54,066 -   train_loss = 0.2623
2024-01-05 13:50:54,066 -   best_eval_score = 0.625
2024-01-05 13:50:54,066 -   eval_score = 0.6181
2024-01-05 13:50:54,066 - EarlyStopping counter: 2 out of 8
2024-01-05 13:51:16,761 - ***** Epoch: 19: Eval results *****
2024-01-05 13:51:16,761 -   train_loss = 0.1991
2024-01-05 13:51:16,762 -   best_eval_score = 0.625
2024-01-05 13:51:16,762 -   eval_score = 0.6291
2024-01-05 13:51:39,365 - ***** Epoch: 20: Eval results *****
2024-01-05 13:51:39,365 -   train_loss = 0.1633
2024-01-05 13:51:39,365 -   best_eval_score = 0.6291
2024-01-05 13:51:39,365 -   eval_score = 0.6155
2024-01-05 13:51:39,365 - EarlyStopping counter: 1 out of 8
2024-01-05 13:52:01,541 - ***** Epoch: 21: Eval results *****
2024-01-05 13:52:01,541 -   train_loss = 0.1403
2024-01-05 13:52:01,541 -   best_eval_score = 0.6291
2024-01-05 13:52:01,542 -   eval_score = 0.6252
2024-01-05 13:52:01,542 - EarlyStopping counter: 2 out of 8
2024-01-05 13:52:24,140 - ***** Epoch: 22: Eval results *****
2024-01-05 13:52:24,140 -   train_loss = 0.1186
2024-01-05 13:52:24,140 -   best_eval_score = 0.6291
2024-01-05 13:52:24,140 -   eval_score = 0.6342
2024-01-05 13:52:46,612 - ***** Epoch: 23: Eval results *****
2024-01-05 13:52:46,613 -   train_loss = 0.1024
2024-01-05 13:52:46,613 -   best_eval_score = 0.6342
2024-01-05 13:52:46,613 -   eval_score = 0.6339
2024-01-05 13:52:46,613 - EarlyStopping counter: 1 out of 8
2024-01-05 13:53:09,111 - ***** Epoch: 24: Eval results *****
2024-01-05 13:53:09,111 -   train_loss = 0.0814
2024-01-05 13:53:09,111 -   best_eval_score = 0.6342
2024-01-05 13:53:09,111 -   eval_score = 0.6514
2024-01-05 13:53:31,834 - ***** Epoch: 25: Eval results *****
2024-01-05 13:53:31,834 -   train_loss = 0.0751
2024-01-05 13:53:31,834 -   best_eval_score = 0.6514
2024-01-05 13:53:31,834 -   eval_score = 0.6595
2024-01-05 13:53:54,334 - ***** Epoch: 26: Eval results *****
2024-01-05 13:53:54,334 -   train_loss = 0.0646
2024-01-05 13:53:54,334 -   best_eval_score = 0.6595
2024-01-05 13:53:54,334 -   eval_score = 0.6446
2024-01-05 13:53:54,334 - EarlyStopping counter: 1 out of 8
2024-01-05 13:54:16,948 - ***** Epoch: 27: Eval results *****
2024-01-05 13:54:16,949 -   train_loss = 0.0532
2024-01-05 13:54:16,949 -   best_eval_score = 0.6595
2024-01-05 13:54:16,949 -   eval_score = 0.6509
2024-01-05 13:54:16,949 - EarlyStopping counter: 2 out of 8
2024-01-05 13:54:40,099 - ***** Epoch: 28: Eval results *****
2024-01-05 13:54:40,099 -   train_loss = 0.0477
2024-01-05 13:54:40,099 -   best_eval_score = 0.6595
2024-01-05 13:54:40,099 -   eval_score = 0.652
2024-01-05 13:54:40,099 - EarlyStopping counter: 3 out of 8
2024-01-05 13:55:02,707 - ***** Epoch: 29: Eval results *****
2024-01-05 13:55:02,708 -   train_loss = 0.038
2024-01-05 13:55:02,708 -   best_eval_score = 0.6595
2024-01-05 13:55:02,708 -   eval_score = 0.6565
2024-01-05 13:55:02,708 - EarlyStopping counter: 4 out of 8
2024-01-05 13:55:25,435 - ***** Epoch: 30: Eval results *****
2024-01-05 13:55:25,435 -   train_loss = 0.0344
2024-01-05 13:55:25,435 -   best_eval_score = 0.6595
2024-01-05 13:55:25,435 -   eval_score = 0.6512
2024-01-05 13:55:25,435 - EarlyStopping counter: 5 out of 8
2024-01-05 13:55:47,784 - ***** Epoch: 31: Eval results *****
2024-01-05 13:55:47,785 -   train_loss = 0.0337
2024-01-05 13:55:47,785 -   best_eval_score = 0.6595
2024-01-05 13:55:47,785 -   eval_score = 0.6455
2024-01-05 13:55:47,785 - EarlyStopping counter: 6 out of 8
2024-01-05 13:56:10,615 - ***** Epoch: 32: Eval results *****
2024-01-05 13:56:10,615 -   train_loss = 0.027
2024-01-05 13:56:10,615 -   best_eval_score = 0.6595
2024-01-05 13:56:10,615 -   eval_score = 0.6429
2024-01-05 13:56:10,615 - EarlyStopping counter: 7 out of 8
2024-01-05 13:56:33,282 - ***** Epoch: 33: Eval results *****
2024-01-05 13:56:33,282 -   train_loss = 0.0207
2024-01-05 13:56:33,282 -   best_eval_score = 0.6595
2024-01-05 13:56:33,282 -   eval_score = 0.65
2024-01-05 13:56:33,282 - EarlyStopping counter: 8 out of 8
2024-01-05 13:56:33,282 - EarlyStopping at epoch 33
2024-01-05 13:56:33,284 - Training is finished...
2024-01-05 13:56:33,284 - Testing begins...
2024-01-05 13:56:37,126 - ***** Test: Confusion Matrix *****
2024-01-05 13:56:37,127 - [[29  1  0  0  6  0  6  4  2  5  1  0  1  0  0  2  0  0  0  0]
 [ 0 39  0  1  0  0  0  0  1  0  0  0  1  0  0  0  0  1  0  0]
 [ 0  0 27  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  9  0  8  0  0  0  0  2  1  0  1  0  0  0  0  0]
 [ 0  0  0  0  0 10  0  0  0  0  1  0  0  0  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  3  1  5  0  0  1  1  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  2  4  1  1  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  3  3  0  0  0  0  2  0  1  0  0  0  0]
 [ 2  0  0  0  0  0  0  1  0  2  0  0  0  0  0  3  0  2  0  0]
 [ 1  0  0  0  0  0  0  1  0  2 14  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 16  0  0  0  0  0  0  1  1]
 [ 3  2  0  1  1  1  3  4  2  0  1  1 21  7  4  4  1  1  0  0]
 [ 1  1  0  0  0  0  3  0  1  0  0  1  0 17  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  1  0  0  0  0  3 13  0  1  0  0  3]
 [ 0  1  0  0  0  0  0  0  2  0  0  0  1  0  2 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  4  1 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0 13  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  1  1  0  1  0  0  5]]
2024-01-05 13:56:37,127 - ***** Evaluation results *****
2024-01-05 13:56:37,127 -   acc = 0.6382
2024-01-05 13:56:37,127 -   f1 = 0.6114
2024-01-05 13:56:37,127 -   prec = 0.6212
2024-01-05 13:56:37,127 -   rec = 0.6234
2024-01-05 13:56:37,128 - Testing is finished...
2024-01-05 13:56:37,128 - Multimodal intent recognition is finished...
2024-01-05 13:56:37,128 - Results are saved in results/msz.csv
