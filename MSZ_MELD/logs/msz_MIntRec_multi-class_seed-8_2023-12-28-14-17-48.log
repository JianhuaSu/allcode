2023-12-28 14:17:48,149 - ============================== Params ==============================
2023-12-28 14:17:48,149 - logger_name: msz_MIntRec_multi-class_seed-8_2023-12-28-14-17-48
2023-12-28 14:17:48,149 - dataset: MIntRec
2023-12-28 14:17:48,149 - data_mode: multi-class
2023-12-28 14:17:48,149 - method: msz
2023-12-28 14:17:48,149 - text_backbone: bert-base-uncased
2023-12-28 14:17:48,149 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-28 14:17:48,149 - seed: 8
2023-12-28 14:17:48,149 - num_workers: 8
2023-12-28 14:17:48,149 - gpu_id: 3
2023-12-28 14:17:48,149 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-28 14:17:48,149 - train: True
2023-12-28 14:17:48,149 - tune: False
2023-12-28 14:17:48,149 - save_model: False
2023-12-28 14:17:48,149 - save_results: True
2023-12-28 14:17:48,149 - log_path: logs
2023-12-28 14:17:48,149 - cache_path: 
2023-12-28 14:17:48,149 - video_data_path: video_data
2023-12-28 14:17:48,149 - audio_data_path: audio_data
2023-12-28 14:17:48,149 - video_feats_path: video_feats.pkl
2023-12-28 14:17:48,149 - audio_feats_path: audio_feats.pkl
2023-12-28 14:17:48,149 - results_path: results
2023-12-28 14:17:48,149 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-28 14:17:48,149 - model_path: models
2023-12-28 14:17:48,149 - config_file_name: msz
2023-12-28 14:17:48,149 - results_file_name: msz.csv
2023-12-28 14:17:48,149 - padding_mode: zero
2023-12-28 14:17:48,149 - padding_loc: end
2023-12-28 14:17:48,150 - need_aligned: False
2023-12-28 14:17:48,150 - eval_monitor: f1
2023-12-28 14:17:48,150 - train_batch_size: 16
2023-12-28 14:17:48,150 - eval_batch_size: 8
2023-12-28 14:17:48,150 - test_batch_size: 8
2023-12-28 14:17:48,150 - wait_patience: 8
2023-12-28 14:17:48,150 - nheads: 2
2023-12-28 14:17:48,150 - encoder_layers: 2
2023-12-28 14:17:48,150 - attn_dropout: 0.1
2023-12-28 14:17:48,150 - relu_dropout: 0.1
2023-12-28 14:17:48,150 - embed_dropout: 0.1
2023-12-28 14:17:48,150 - res_dropout: 0.1
2023-12-28 14:17:48,150 - attn_mask: False
2023-12-28 14:17:48,150 - hidden_size: 768
2023-12-28 14:17:48,150 - num_attention_heads: 12
2023-12-28 14:17:48,150 - attention_probs_dropout_prob: 0.2
2023-12-28 14:17:48,150 - hidden_dropout_prob: 0.2
2023-12-28 14:17:48,150 - intermediate_size: 768
2023-12-28 14:17:48,150 - num_hidden_layers: 3
2023-12-28 14:17:48,150 - max_position_embeddings: 512
2023-12-28 14:17:48,150 - position_embedding_type: absolute
2023-12-28 14:17:48,150 - batch_first: True
2023-12-28 14:17:48,150 - hidden_dims: 768
2023-12-28 14:17:48,150 - att_dropouts: [0.2, 0.2, 0.2]
2023-12-28 14:17:48,150 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-28 14:17:48,150 - ta_loss: 0.01
2023-12-28 14:17:48,150 - tv_loss: 0.01
2023-12-28 14:17:48,150 - av_loss: 0.01
2023-12-28 14:17:48,150 - aligned_method: conv1d
2023-12-28 14:17:48,150 - grad_clip: 2
2023-12-28 14:17:48,150 - num_train_epochs: 100
2023-12-28 14:17:48,150 - warmup_proportion: 0.1
2023-12-28 14:17:48,150 - lr: 1e-06
2023-12-28 14:17:48,150 - weight_decay: 0.02
2023-12-28 14:17:48,150 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-8_2023-12-28-14-17-48
2023-12-28 14:17:48,150 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-8_2023-12-28-14-17-48/models
2023-12-28 14:17:48,150 - ============================== End Params ==============================
2023-12-28 14:17:48,315 - Generate Text Features Begin...
2023-12-28 14:17:49,033 - Generate Text Features Finished...
2023-12-28 14:17:49,034 - Load Video Features Begin...
2023-12-28 14:17:57,837 - Load Video Features Finished...
2023-12-28 14:17:58,522 - Load Audio Features Begin...
2023-12-28 14:18:26,003 - Load Audio Features Finished...
2023-12-28 14:18:29,808 - method  begins...
2023-12-28 14:18:39,914 - Multimodal intent recognition begins...
2023-12-28 14:18:39,914 - Training begins...
2023-12-28 14:19:05,247 - ***** Epoch: 1: Eval results *****
2023-12-28 14:19:05,248 -   train_loss = 3.37
2023-12-28 14:19:05,248 -   best_eval_score = 0.0
2023-12-28 14:19:05,248 -   eval_score = 0.03
2023-12-28 14:19:28,588 - ***** Epoch: 2: Eval results *****
2023-12-28 14:19:28,589 -   train_loss = 3.1821
2023-12-28 14:19:28,589 -   best_eval_score = 0.03
2023-12-28 14:19:28,589 -   eval_score = 0.0114
2023-12-28 14:19:28,589 - EarlyStopping counter: 1 out of 8
2023-12-28 14:19:52,033 - ***** Epoch: 3: Eval results *****
2023-12-28 14:19:52,033 -   train_loss = 3.0618
2023-12-28 14:19:52,033 -   best_eval_score = 0.03
2023-12-28 14:19:52,033 -   eval_score = 0.0241
2023-12-28 14:19:52,033 - EarlyStopping counter: 2 out of 8
2023-12-28 14:20:16,723 - ***** Epoch: 4: Eval results *****
2023-12-28 14:20:16,723 -   train_loss = 2.9885
2023-12-28 14:20:16,723 -   best_eval_score = 0.03
2023-12-28 14:20:16,723 -   eval_score = 0.0167
2023-12-28 14:20:16,723 - EarlyStopping counter: 3 out of 8
2023-12-28 14:20:40,001 - ***** Epoch: 5: Eval results *****
2023-12-28 14:20:40,001 -   train_loss = 2.9503
2023-12-28 14:20:40,002 -   best_eval_score = 0.03
2023-12-28 14:20:40,002 -   eval_score = 0.0341
2023-12-28 14:21:03,244 - ***** Epoch: 6: Eval results *****
2023-12-28 14:21:03,244 -   train_loss = 2.9079
2023-12-28 14:21:03,244 -   best_eval_score = 0.0341
2023-12-28 14:21:03,244 -   eval_score = 0.0229
2023-12-28 14:21:03,244 - EarlyStopping counter: 1 out of 8
2023-12-28 14:21:27,771 - ***** Epoch: 7: Eval results *****
2023-12-28 14:21:27,771 -   train_loss = 2.8851
2023-12-28 14:21:27,771 -   best_eval_score = 0.0341
2023-12-28 14:21:27,771 -   eval_score = 0.0192
2023-12-28 14:21:27,771 - EarlyStopping counter: 2 out of 8
2023-12-28 14:21:52,713 - ***** Epoch: 8: Eval results *****
2023-12-28 14:21:52,713 -   train_loss = 2.8632
2023-12-28 14:21:52,713 -   best_eval_score = 0.0341
2023-12-28 14:21:52,713 -   eval_score = 0.0244
2023-12-28 14:21:52,713 - EarlyStopping counter: 3 out of 8
2023-12-28 14:22:17,612 - ***** Epoch: 9: Eval results *****
2023-12-28 14:22:17,612 -   train_loss = 2.8398
2023-12-28 14:22:17,612 -   best_eval_score = 0.0341
2023-12-28 14:22:17,612 -   eval_score = 0.0327
2023-12-28 14:22:17,612 - EarlyStopping counter: 4 out of 8
2023-12-28 14:22:41,985 - ***** Epoch: 10: Eval results *****
2023-12-28 14:22:41,985 -   train_loss = 2.8183
2023-12-28 14:22:41,985 -   best_eval_score = 0.0341
2023-12-28 14:22:41,985 -   eval_score = 0.0334
2023-12-28 14:22:41,985 - EarlyStopping counter: 5 out of 8
2023-12-28 14:23:07,528 - ***** Epoch: 11: Eval results *****
2023-12-28 14:23:07,528 -   train_loss = 2.7864
2023-12-28 14:23:07,528 -   best_eval_score = 0.0341
2023-12-28 14:23:07,528 -   eval_score = 0.0487
2023-12-28 14:23:33,716 - ***** Epoch: 12: Eval results *****
2023-12-28 14:23:33,716 -   train_loss = 2.7449
2023-12-28 14:23:33,717 -   best_eval_score = 0.0487
2023-12-28 14:23:33,717 -   eval_score = 0.0449
2023-12-28 14:23:33,717 - EarlyStopping counter: 1 out of 8
2023-12-28 14:23:58,300 - ***** Epoch: 13: Eval results *****
2023-12-28 14:23:58,301 -   train_loss = 2.6876
2023-12-28 14:23:58,301 -   best_eval_score = 0.0487
2023-12-28 14:23:58,301 -   eval_score = 0.062
2023-12-28 14:24:22,432 - ***** Epoch: 14: Eval results *****
2023-12-28 14:24:22,432 -   train_loss = 2.6108
2023-12-28 14:24:22,432 -   best_eval_score = 0.062
2023-12-28 14:24:22,432 -   eval_score = 0.072
2023-12-28 14:24:46,974 - ***** Epoch: 15: Eval results *****
2023-12-28 14:24:46,975 -   train_loss = 2.5086
2023-12-28 14:24:46,975 -   best_eval_score = 0.072
2023-12-28 14:24:46,975 -   eval_score = 0.0973
2023-12-28 14:25:13,931 - ***** Epoch: 16: Eval results *****
2023-12-28 14:25:13,940 -   train_loss = 2.3818
2023-12-28 14:25:13,940 -   best_eval_score = 0.0973
2023-12-28 14:25:13,940 -   eval_score = 0.1097
2023-12-28 14:25:38,086 - ***** Epoch: 17: Eval results *****
2023-12-28 14:25:38,086 -   train_loss = 2.2529
2023-12-28 14:25:38,086 -   best_eval_score = 0.1097
2023-12-28 14:25:38,086 -   eval_score = 0.1604
2023-12-28 14:26:01,792 - ***** Epoch: 18: Eval results *****
2023-12-28 14:26:01,792 -   train_loss = 2.159
2023-12-28 14:26:01,792 -   best_eval_score = 0.1604
2023-12-28 14:26:01,792 -   eval_score = 0.1476
2023-12-28 14:26:01,792 - EarlyStopping counter: 1 out of 8
2023-12-28 14:26:25,704 - ***** Epoch: 19: Eval results *****
2023-12-28 14:26:25,705 -   train_loss = 2.0253
2023-12-28 14:26:25,705 -   best_eval_score = 0.1604
2023-12-28 14:26:25,705 -   eval_score = 0.2398
2023-12-28 14:26:51,741 - ***** Epoch: 20: Eval results *****
2023-12-28 14:26:51,741 -   train_loss = 1.8625
2023-12-28 14:26:51,741 -   best_eval_score = 0.2398
2023-12-28 14:26:51,741 -   eval_score = 0.3068
2023-12-28 14:27:16,587 - ***** Epoch: 21: Eval results *****
2023-12-28 14:27:16,587 -   train_loss = 1.6529
2023-12-28 14:27:16,587 -   best_eval_score = 0.3068
2023-12-28 14:27:16,587 -   eval_score = 0.2789
2023-12-28 14:27:16,587 - EarlyStopping counter: 1 out of 8
2023-12-28 14:27:40,476 - ***** Epoch: 22: Eval results *****
2023-12-28 14:27:40,476 -   train_loss = 1.5228
2023-12-28 14:27:40,476 -   best_eval_score = 0.3068
2023-12-28 14:27:40,476 -   eval_score = 0.2752
2023-12-28 14:27:40,476 - EarlyStopping counter: 2 out of 8
2023-12-28 14:28:04,576 - ***** Epoch: 23: Eval results *****
2023-12-28 14:28:04,577 -   train_loss = 1.4023
2023-12-28 14:28:04,577 -   best_eval_score = 0.3068
2023-12-28 14:28:04,577 -   eval_score = 0.4244
2023-12-28 14:28:29,552 - ***** Epoch: 24: Eval results *****
2023-12-28 14:28:29,552 -   train_loss = 1.2103
2023-12-28 14:28:29,552 -   best_eval_score = 0.4244
2023-12-28 14:28:29,552 -   eval_score = 0.4313
2023-12-28 14:29:07,722 - ***** Epoch: 25: Eval results *****
2023-12-28 14:29:07,723 -   train_loss = 1.0782
2023-12-28 14:29:07,723 -   best_eval_score = 0.4313
2023-12-28 14:29:07,723 -   eval_score = 0.4215
2023-12-28 14:29:07,723 - EarlyStopping counter: 1 out of 8
2023-12-28 14:29:32,950 - ***** Epoch: 26: Eval results *****
2023-12-28 14:29:32,959 -   train_loss = 0.929
2023-12-28 14:29:32,959 -   best_eval_score = 0.4313
2023-12-28 14:29:32,959 -   eval_score = 0.4609
2023-12-28 14:29:57,406 - ***** Epoch: 27: Eval results *****
2023-12-28 14:29:57,406 -   train_loss = 0.8345
2023-12-28 14:29:57,406 -   best_eval_score = 0.4609
2023-12-28 14:29:57,406 -   eval_score = 0.5066
2023-12-28 14:30:21,003 - ***** Epoch: 28: Eval results *****
2023-12-28 14:30:21,004 -   train_loss = 0.691
2023-12-28 14:30:21,004 -   best_eval_score = 0.5066
2023-12-28 14:30:21,004 -   eval_score = 0.5151
2023-12-28 14:30:44,548 - ***** Epoch: 29: Eval results *****
2023-12-28 14:30:44,549 -   train_loss = 0.64
2023-12-28 14:30:44,549 -   best_eval_score = 0.5151
2023-12-28 14:30:44,549 -   eval_score = 0.5286
2023-12-28 14:31:30,153 - ***** Epoch: 30: Eval results *****
2023-12-28 14:31:30,154 -   train_loss = 0.5193
2023-12-28 14:31:30,154 -   best_eval_score = 0.5286
2023-12-28 14:31:30,154 -   eval_score = 0.5849
2023-12-28 14:31:54,288 - ***** Epoch: 31: Eval results *****
2023-12-28 14:31:54,288 -   train_loss = 0.4588
2023-12-28 14:31:54,288 -   best_eval_score = 0.5849
2023-12-28 14:31:54,288 -   eval_score = 0.5641
2023-12-28 14:31:54,288 - EarlyStopping counter: 1 out of 8
2023-12-28 14:32:18,385 - ***** Epoch: 32: Eval results *****
2023-12-28 14:32:18,385 -   train_loss = 0.4034
2023-12-28 14:32:18,385 -   best_eval_score = 0.5849
2023-12-28 14:32:18,385 -   eval_score = 0.5918
2023-12-28 14:32:42,105 - ***** Epoch: 33: Eval results *****
2023-12-28 14:32:42,105 -   train_loss = 0.3375
2023-12-28 14:32:42,105 -   best_eval_score = 0.5918
2023-12-28 14:32:42,105 -   eval_score = 0.5884
2023-12-28 14:32:42,105 - EarlyStopping counter: 1 out of 8
2023-12-28 14:33:05,982 - ***** Epoch: 34: Eval results *****
2023-12-28 14:33:05,982 -   train_loss = 0.3041
2023-12-28 14:33:05,983 -   best_eval_score = 0.5918
2023-12-28 14:33:05,983 -   eval_score = 0.6058
2023-12-28 14:33:29,326 - ***** Epoch: 35: Eval results *****
2023-12-28 14:33:29,326 -   train_loss = 0.2516
2023-12-28 14:33:29,326 -   best_eval_score = 0.6058
2023-12-28 14:33:29,326 -   eval_score = 0.6158
2023-12-28 14:34:14,844 - ***** Epoch: 36: Eval results *****
2023-12-28 14:34:14,844 -   train_loss = 0.2142
2023-12-28 14:34:14,844 -   best_eval_score = 0.6158
2023-12-28 14:34:14,844 -   eval_score = 0.6159
2023-12-28 14:34:39,844 - ***** Epoch: 37: Eval results *****
2023-12-28 14:34:39,845 -   train_loss = 0.1899
2023-12-28 14:34:39,845 -   best_eval_score = 0.6159
2023-12-28 14:34:39,845 -   eval_score = 0.6198
2023-12-28 14:35:05,050 - ***** Epoch: 38: Eval results *****
2023-12-28 14:35:05,050 -   train_loss = 0.1656
2023-12-28 14:35:05,050 -   best_eval_score = 0.6198
2023-12-28 14:35:05,050 -   eval_score = 0.6239
2023-12-28 14:35:29,309 - ***** Epoch: 39: Eval results *****
2023-12-28 14:35:29,310 -   train_loss = 0.1359
2023-12-28 14:35:29,310 -   best_eval_score = 0.6239
2023-12-28 14:35:29,310 -   eval_score = 0.6248
2023-12-28 14:35:53,083 - ***** Epoch: 40: Eval results *****
2023-12-28 14:35:53,084 -   train_loss = 0.1122
2023-12-28 14:35:53,084 -   best_eval_score = 0.6248
2023-12-28 14:35:53,084 -   eval_score = 0.644
2023-12-28 14:36:17,007 - ***** Epoch: 41: Eval results *****
2023-12-28 14:36:17,007 -   train_loss = 0.1007
2023-12-28 14:36:17,007 -   best_eval_score = 0.644
2023-12-28 14:36:17,007 -   eval_score = 0.6576
2023-12-28 14:36:45,599 - ***** Epoch: 42: Eval results *****
2023-12-28 14:36:45,600 -   train_loss = 0.0862
2023-12-28 14:36:45,600 -   best_eval_score = 0.6576
2023-12-28 14:36:45,600 -   eval_score = 0.6571
2023-12-28 14:36:45,600 - EarlyStopping counter: 1 out of 8
2023-12-28 14:37:11,603 - ***** Epoch: 43: Eval results *****
2023-12-28 14:37:11,604 -   train_loss = 0.0762
2023-12-28 14:37:11,604 -   best_eval_score = 0.6576
2023-12-28 14:37:11,604 -   eval_score = 0.6473
2023-12-28 14:37:11,604 - EarlyStopping counter: 2 out of 8
2023-12-28 14:37:35,375 - ***** Epoch: 44: Eval results *****
2023-12-28 14:37:35,375 -   train_loss = 0.0658
2023-12-28 14:37:35,375 -   best_eval_score = 0.6576
2023-12-28 14:37:35,375 -   eval_score = 0.6412
2023-12-28 14:37:35,376 - EarlyStopping counter: 3 out of 8
2023-12-28 14:37:59,308 - ***** Epoch: 45: Eval results *****
2023-12-28 14:37:59,308 -   train_loss = 0.0594
2023-12-28 14:37:59,308 -   best_eval_score = 0.6576
2023-12-28 14:37:59,308 -   eval_score = 0.6367
2023-12-28 14:37:59,308 - EarlyStopping counter: 4 out of 8
2023-12-28 14:38:22,990 - ***** Epoch: 46: Eval results *****
2023-12-28 14:38:22,990 -   train_loss = 0.0501
2023-12-28 14:38:22,990 -   best_eval_score = 0.6576
2023-12-28 14:38:22,990 -   eval_score = 0.6394
2023-12-28 14:38:22,990 - EarlyStopping counter: 5 out of 8
2023-12-28 14:38:46,941 - ***** Epoch: 47: Eval results *****
2023-12-28 14:38:46,941 -   train_loss = 0.0465
2023-12-28 14:38:46,941 -   best_eval_score = 0.6576
2023-12-28 14:38:46,941 -   eval_score = 0.6498
2023-12-28 14:38:46,941 - EarlyStopping counter: 6 out of 8
2023-12-28 14:39:24,894 - ***** Epoch: 48: Eval results *****
2023-12-28 14:39:24,894 -   train_loss = 0.0414
2023-12-28 14:39:24,894 -   best_eval_score = 0.6576
2023-12-28 14:39:24,894 -   eval_score = 0.6442
2023-12-28 14:39:24,894 - EarlyStopping counter: 7 out of 8
2023-12-28 14:39:49,998 - ***** Epoch: 49: Eval results *****
2023-12-28 14:39:49,998 -   train_loss = 0.0403
2023-12-28 14:39:49,998 -   best_eval_score = 0.6576
2023-12-28 14:39:49,998 -   eval_score = 0.6406
2023-12-28 14:39:49,998 - EarlyStopping counter: 8 out of 8
2023-12-28 14:39:49,998 - EarlyStopping at epoch 49
2023-12-28 14:39:50,000 - Training is finished...
2023-12-28 14:39:50,000 - Testing begins...
2023-12-28 14:39:54,257 - ***** Test: Confusion Matrix *****
2023-12-28 14:39:54,258 - [[28  1  0  0 12  0  3  2  1  3  1  0  2  1  0  3  0  0  0  0]
 [ 0 38  1  0  0  0  1  0  1  0  0  0  1  0  0  0  0  0  0  1]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0 16  0  2  0  1  0  0  1  0  2  0  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  0  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  2  0  3  1  3  0  0  0  0  0  0  2  0  0  0  1]
 [ 2  0  0  0  0  0  1  4  1  1  1  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  1  3  2  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  1  0  0  3  0  0  0  0  1  3  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  3 11  0  0  1  1  0  0  2  0  0]
 [ 0  0  0  0  0  0  2  0  0  0  0 16  1  0  0  0  0  0  0  0]
 [ 2  2  0  0  2  0  2  1  2  1  0  1 30  0  4  7  2  0  0  1]
 [ 2  0  0  0  0  0  3  0  1  0  0  1  1 16  0  0  0  1  0  0]
 [ 0  0  1  0  0  0  1  0  1  0  0  0  0  2 13  0  1  0  0  3]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  3  0  1 15  0  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  5  0  1  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  1  0  2  0  0 10  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  3  0  0  2  0  0  6  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  2  0  1  1  0  0  0  0  6]]
2023-12-28 14:39:54,258 - ***** Evaluation results *****
2023-12-28 14:39:54,258 -   acc = 0.6494
2023-12-28 14:39:54,259 -   f1 = 0.6155
2023-12-28 14:39:54,259 -   prec = 0.6346
2023-12-28 14:39:54,259 -   rec = 0.619
2023-12-28 14:39:54,259 - Testing is finished...
2023-12-28 14:39:54,259 - Multimodal intent recognition is finished...
2023-12-28 14:39:54,259 - Results are saved in results/msz.csv
