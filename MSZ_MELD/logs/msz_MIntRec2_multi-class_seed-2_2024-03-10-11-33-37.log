2024-03-10 11:33:37,741 - ============================== Params ==============================
2024-03-10 11:33:37,741 - logger_name: msz_MIntRec2_multi-class_seed-2_2024-03-10-11-33-37
2024-03-10 11:33:37,741 - dataset: MIntRec2
2024-03-10 11:33:37,741 - data_mode: multi-class
2024-03-10 11:33:37,741 - method: msz
2024-03-10 11:33:37,741 - text_backbone: bert-base-uncased
2024-03-10 11:33:37,741 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-10 11:33:37,741 - seed: 2
2024-03-10 11:33:37,741 - num_workers: 8
2024-03-10 11:33:37,741 - gpu_id: 2
2024-03-10 11:33:37,741 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-10 11:33:37,741 - train: True
2024-03-10 11:33:37,741 - tune: True
2024-03-10 11:33:37,741 - save_model: False
2024-03-10 11:33:37,741 - save_results: True
2024-03-10 11:33:37,741 - log_path: logs
2024-03-10 11:33:37,741 - cache_path: 
2024-03-10 11:33:37,741 - video_data_path: video_data
2024-03-10 11:33:37,741 - audio_data_path: audio_data
2024-03-10 11:33:37,741 - video_feats_path: video_feats.pkl
2024-03-10 11:33:37,741 - audio_feats_path: audio_feats.pkl
2024-03-10 11:33:37,741 - results_path: results
2024-03-10 11:33:37,741 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-10 11:33:37,741 - model_path: models
2024-03-10 11:33:37,741 - config_file_name: msz_MIntRec2
2024-03-10 11:33:37,741 - results_file_name: msz.csv
2024-03-10 11:33:37,741 - padding_mode: zero
2024-03-10 11:33:37,741 - padding_loc: end
2024-03-10 11:33:37,741 - need_aligned: False
2024-03-10 11:33:37,741 - eval_monitor: f1
2024-03-10 11:33:37,741 - train_batch_size: 32
2024-03-10 11:33:37,741 - eval_batch_size: 16
2024-03-10 11:33:37,742 - test_batch_size: 16
2024-03-10 11:33:37,742 - wait_patience: 8
2024-03-10 11:33:37,742 - hidden_dims: 768
2024-03-10 11:33:37,742 - num_attention_heads: 6
2024-03-10 11:33:37,742 - attention_probs_dropout_prob: 0.3
2024-03-10 11:33:37,742 - hidden_dropout_prob: 0.5
2024-03-10 11:33:37,742 - intermediate_size: 768
2024-03-10 11:33:37,742 - num_hidden_layers: 6
2024-03-10 11:33:37,742 - max_position_embeddings: 1000
2024-03-10 11:33:37,742 - position_embedding_type: absolute
2024-03-10 11:33:37,742 - batch_first: True
2024-03-10 11:33:37,742 - dropout: 0.4
2024-03-10 11:33:37,742 - aligned_method: conv1d
2024-03-10 11:33:37,742 - num_train_epochs: 100
2024-03-10 11:33:37,742 - lr: 5e-06
2024-03-10 11:33:37,742 - lr_mode: min
2024-03-10 11:33:37,742 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-2_2024-03-10-11-33-37
2024-03-10 11:33:37,742 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-2_2024-03-10-11-33-37/models
2024-03-10 11:33:37,742 - ============================== End Params ==============================
2024-03-10 11:33:37,754 - Generate Text Features Begin...
2024-03-10 11:33:39,487 - Generate Text Features Finished...
2024-03-10 11:33:39,488 - Load Video Features Begin...
2024-03-10 11:33:40,584 - Load Video Features Finished...
2024-03-10 11:33:42,422 - Load Audio Features Begin...
2024-03-10 11:33:53,602 - Load Audio Features Finished...
2024-03-10 11:34:09,764 - method  begins...
2024-03-10 11:34:12,602 - Multimodal intent recognition begins...
2024-03-10 11:34:12,602 - Training begins...
2024-03-10 11:35:27,132 - ***** Epoch: 1: Eval results *****
2024-03-10 11:35:27,132 -   train_loss = 2.88
2024-03-10 11:35:27,132 -   best_eval_score = 0.0
2024-03-10 11:35:27,132 -   eval_score = 0.2327
2024-03-10 11:36:38,270 - ***** Epoch: 2: Eval results *****
2024-03-10 11:36:38,279 -   train_loss = 1.9249
2024-03-10 11:36:38,279 -   best_eval_score = 0.2327
2024-03-10 11:36:38,279 -   eval_score = 0.3542
2024-03-10 11:37:50,765 - ***** Epoch: 3: Eval results *****
2024-03-10 11:37:50,765 -   train_loss = 1.4885
2024-03-10 11:37:50,765 -   best_eval_score = 0.3542
2024-03-10 11:37:50,765 -   eval_score = 0.4284
2024-03-10 11:39:03,077 - ***** Epoch: 4: Eval results *****
2024-03-10 11:39:03,086 -   train_loss = 1.2559
2024-03-10 11:39:03,086 -   best_eval_score = 0.4284
2024-03-10 11:39:03,086 -   eval_score = 0.4583
2024-03-10 11:40:14,441 - ***** Epoch: 5: Eval results *****
2024-03-10 11:40:14,442 -   train_loss = 1.082
2024-03-10 11:40:14,442 -   best_eval_score = 0.4583
2024-03-10 11:40:14,442 -   eval_score = 0.4868
2024-03-10 11:41:25,672 - ***** Epoch: 6: Eval results *****
2024-03-10 11:41:25,672 -   train_loss = 0.9167
2024-03-10 11:41:25,672 -   best_eval_score = 0.4868
2024-03-10 11:41:25,673 -   eval_score = 0.482
2024-03-10 11:41:25,673 - EarlyStopping counter: 1 out of 8
2024-03-10 11:42:37,415 - ***** Epoch: 7: Eval results *****
2024-03-10 11:42:37,415 -   train_loss = 0.7865
2024-03-10 11:42:37,415 -   best_eval_score = 0.4868
2024-03-10 11:42:37,415 -   eval_score = 0.4846
2024-03-10 11:42:37,415 - EarlyStopping counter: 2 out of 8
2024-03-10 11:43:48,946 - ***** Epoch: 8: Eval results *****
2024-03-10 11:43:48,946 -   train_loss = 0.652
2024-03-10 11:43:48,947 -   best_eval_score = 0.4868
2024-03-10 11:43:48,947 -   eval_score = 0.4917
2024-03-10 11:45:01,838 - ***** Epoch: 9: Eval results *****
2024-03-10 11:45:01,839 -   train_loss = 0.5449
2024-03-10 11:45:01,839 -   best_eval_score = 0.4917
2024-03-10 11:45:01,839 -   eval_score = 0.4963
2024-03-10 11:46:16,495 - ***** Epoch: 10: Eval results *****
2024-03-10 11:46:16,496 -   train_loss = 0.4417
2024-03-10 11:46:16,496 -   best_eval_score = 0.4963
2024-03-10 11:46:16,496 -   eval_score = 0.509
2024-03-10 11:47:28,538 - ***** Epoch: 11: Eval results *****
2024-03-10 11:47:28,538 -   train_loss = 0.3407
2024-03-10 11:47:28,539 -   best_eval_score = 0.509
2024-03-10 11:47:28,539 -   eval_score = 0.5067
2024-03-10 11:47:28,539 - EarlyStopping counter: 1 out of 8
2024-03-10 11:48:41,150 - ***** Epoch: 12: Eval results *****
2024-03-10 11:48:41,151 -   train_loss = 0.3256
2024-03-10 11:48:41,151 -   best_eval_score = 0.509
2024-03-10 11:48:41,151 -   eval_score = 0.5048
2024-03-10 11:48:41,151 - EarlyStopping counter: 2 out of 8
2024-03-10 11:49:53,043 - ***** Epoch: 13: Eval results *****
2024-03-10 11:49:53,044 -   train_loss = 0.3195
2024-03-10 11:49:53,044 -   best_eval_score = 0.509
2024-03-10 11:49:53,044 -   eval_score = 0.5071
2024-03-10 11:49:53,044 - EarlyStopping counter: 3 out of 8
2024-03-10 11:51:04,747 - ***** Epoch: 14: Eval results *****
2024-03-10 11:51:04,747 -   train_loss = 0.3035
2024-03-10 11:51:04,747 -   best_eval_score = 0.509
2024-03-10 11:51:04,747 -   eval_score = 0.5047
2024-03-10 11:51:04,747 - EarlyStopping counter: 4 out of 8
2024-03-10 11:52:15,892 - ***** Epoch: 15: Eval results *****
2024-03-10 11:52:15,901 -   train_loss = 0.2976
2024-03-10 11:52:15,901 -   best_eval_score = 0.509
2024-03-10 11:52:15,901 -   eval_score = 0.5066
2024-03-10 11:52:15,901 - EarlyStopping counter: 5 out of 8
2024-03-10 11:53:27,508 - ***** Epoch: 16: Eval results *****
2024-03-10 11:53:27,508 -   train_loss = 0.2859
2024-03-10 11:53:27,508 -   best_eval_score = 0.509
2024-03-10 11:53:27,508 -   eval_score = 0.503
2024-03-10 11:53:27,508 - EarlyStopping counter: 6 out of 8
2024-03-10 11:54:40,134 - ***** Epoch: 17: Eval results *****
2024-03-10 11:54:40,134 -   train_loss = 0.2797
2024-03-10 11:54:40,134 -   best_eval_score = 0.509
2024-03-10 11:54:40,134 -   eval_score = 0.512
2024-03-10 11:55:52,201 - ***** Epoch: 18: Eval results *****
2024-03-10 11:55:52,202 -   train_loss = 0.2781
2024-03-10 11:55:52,202 -   best_eval_score = 0.512
2024-03-10 11:55:52,202 -   eval_score = 0.5039
2024-03-10 11:55:52,202 - EarlyStopping counter: 1 out of 8
2024-03-10 11:57:03,904 - ***** Epoch: 19: Eval results *****
2024-03-10 11:57:03,905 -   train_loss = 0.2595
2024-03-10 11:57:03,905 -   best_eval_score = 0.512
2024-03-10 11:57:03,905 -   eval_score = 0.5004
2024-03-10 11:57:03,905 - EarlyStopping counter: 2 out of 8
2024-03-10 11:58:15,981 - ***** Epoch: 20: Eval results *****
2024-03-10 11:58:15,981 -   train_loss = 0.2651
2024-03-10 11:58:15,981 -   best_eval_score = 0.512
2024-03-10 11:58:15,981 -   eval_score = 0.503
2024-03-10 11:58:15,981 - EarlyStopping counter: 3 out of 8
2024-03-10 11:59:28,034 - ***** Epoch: 21: Eval results *****
2024-03-10 11:59:28,035 -   train_loss = 0.257
2024-03-10 11:59:28,035 -   best_eval_score = 0.512
2024-03-10 11:59:28,035 -   eval_score = 0.5043
2024-03-10 11:59:28,035 - EarlyStopping counter: 4 out of 8
2024-03-10 12:00:39,344 - ***** Epoch: 22: Eval results *****
2024-03-10 12:00:39,344 -   train_loss = 0.2537
2024-03-10 12:00:39,345 -   best_eval_score = 0.512
2024-03-10 12:00:39,345 -   eval_score = 0.5044
2024-03-10 12:00:39,345 - EarlyStopping counter: 5 out of 8
2024-03-10 12:01:51,042 - ***** Epoch: 23: Eval results *****
2024-03-10 12:01:51,043 -   train_loss = 0.2578
2024-03-10 12:01:51,043 -   best_eval_score = 0.512
2024-03-10 12:01:51,043 -   eval_score = 0.5024
2024-03-10 12:01:51,043 - EarlyStopping counter: 6 out of 8
2024-03-10 12:03:02,665 - ***** Epoch: 24: Eval results *****
2024-03-10 12:03:02,665 -   train_loss = 0.2505
2024-03-10 12:03:02,665 -   best_eval_score = 0.512
2024-03-10 12:03:02,665 -   eval_score = 0.5029
2024-03-10 12:03:02,666 - EarlyStopping counter: 7 out of 8
2024-03-10 12:04:13,623 - ***** Epoch: 25: Eval results *****
2024-03-10 12:04:13,623 -   train_loss = 0.2485
2024-03-10 12:04:13,623 -   best_eval_score = 0.512
2024-03-10 12:04:13,623 -   eval_score = 0.5037
2024-03-10 12:04:13,623 - EarlyStopping counter: 8 out of 8
2024-03-10 12:04:13,623 - EarlyStopping at epoch 25
2024-03-10 12:04:13,626 - Training is finished...
2024-03-10 12:04:13,626 - Testing begins...
2024-03-10 12:04:24,493 - ***** Test: Confusion Matrix *****
2024-03-10 12:04:24,498 - [[ 50   0  13   0   0   0   0   0   0   0   2   0   0   1   0   0   0   0
    0   0   0   1   0   0   1   0   0   0   0   0]
 [  0  57   0   0   8   1   6   0   0   0   1   0   4   0   4   0   0   9
    1   0   0   2   1   0   1   0   0   2   0   0]
 [ 10   0  43   0   1   0   0   0   0   0   1   0   0   1   2   0   0   2
    0   0   0   0   0   1   3   0   0   0   0   0]
 [  0   0   0  61   0   0   0   1   0   1   0   0   0   0   1   0   0   1
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   5   0   0  34   1   0   0   1   0   0   0   0   0   0   0   0   3
    0   1   0   1   0   0   1   0   0   0   1   3]
 [  0   1   0   0   1  22   0   0   0   1   1   0   0   0   1   0   0   6
    0   1   0   0   0   1   0   0   1   0   0   1]
 [  0   1   0   0   0   2  29   7   0   0   4   0   5   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   6  29   0   0   3   1   6   0   0   0   0   0
    0   0   0   0   1   0   0   0   0   1   0   0]
 [  1   2   1   3   1   0   0   0  21   0   0   1   1   0   4   1   0   4
    0   0   0   0   7   0   2   0   0   0   0   0]
 [  0   1   0   0   0   0   0   0   3  52   0   8   8   0  14   1   0   5
    0   0   0   1   2   1   4   0   1   5   0   1]
 [  0   0   0   0   0   2   5   3   2   2  47   0  26   0   1   0   0   2
    0   2   0   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   1   0   0   7   1  22   5   0   1   0   0   0
    1   0   0   0   3   0   1   0   0   4   0   1]
 [  0   2   0   0   0   0   4  10   0   5  29   1  80   1   0   0   1   0
    0   0   0   0   1   0   0   0   0   1   0   0]
 [  0   0   2   0   0   0   0   0   1   1   0   0   0   1   4   2   0   1
    3   0   0   0   1   0   0   0   0   1   0   0]
 [  0   3   1   0   1   1   1   0   6   6   2   1   1   2 117   2   0  21
    5   0   1   0  13   0   4   0   0   5   0   0]
 [  0   0   1   0   1   0   0   0   0   2   0   0   0   0   3   4   0   3
    2   0   0   1   2   0   1   0   0   1   1   0]
 [  0   0   0   0   1   0   1   3   0   0   1   0   2   0   0   0  52   0
    5   0   0   0   0   0   1   0   0   0   0   0]
 [  0   5   1   0   6   3   0   0   2  12   0   1   1   2  19   3   2 110
   13   3   1   5   6  10   0   2   1   4   2   3]
 [  0   3   1   0   0   0   0   0   0   4   1   0   0   0   8   0   1   5
   30   0   2   0   2   0   3   0   0   0   0   0]
 [  0   5   0   0   0   0   2   0   0   0   1   0   0   0   0   0   0   1
    0   7   0   1   0   0   0   0   0   0   0   0]
 [  0   1   2   0   1   0   0   0   0   1   1   1   0   1   5   0   0   2
    5   0   5   0   0   1   1   0   0   2   0   0]
 [  5   0   0   0   1   0   0   0   0   3   0   0   0   0   0   0   5   0
    0   0   0  28   0   6   1   0   2   1   0   1]
 [  0   0   0   1   0   0   0   0   1   5   0   3   1   1  10   0   0   2
    0   0   1   0  84   0   1   2   5   0   0   0]
 [  0   2   1   0   1   0   0   0   0   0   0   0   0   0   2   0   0   5
    0   0   1   3   0  23   0   0   0   0   0   0]
 [  1   0   3   0   0   0   0   0   0   1   1   2   0   1   2   0   0   3
    0   0   0   0   1   1  87   0   0   8   2   0]
 [  1   1   0   0   0   0   0   0   0   1   0   1   0   0   0   0   0   1
    0   0   0   0   2   0   1  21   0   0   0   2]
 [  0   0   0   2   0   0   0   0   0   2   0   0   0   0   1   0   0   3
    0   0   0   3   2   0   0   0   3   0   1   0]
 [  0   2   1   0   0   0   0   1   2   8   2   3   3   1   3   0   0   4
    0   0   2   0   1   0   8   1   0  14   1   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   1
    0   0   0   0   0   0   0   0   0   0  56   0]
 [  0   1   0   0   1   0   0   0   3   2   1   1   0   0   0   0   0   3
    1   0   0   0   0   0   1   1   0   0   0   4]]
2024-03-10 12:04:24,499 - ***** Evaluation results *****
2024-03-10 12:04:24,499 -   acc = 0.5868
2024-03-10 12:04:24,499 -   f1 = 0.5347
2024-03-10 12:04:24,499 -   prec = 0.5426
2024-03-10 12:04:24,499 -   rec = 0.5338
2024-03-10 12:04:24,500 - Testing is finished...
2024-03-10 12:04:24,500 - Multimodal intent recognition is finished...
2024-03-10 12:04:24,500 - Results are saved in results/msz.csv
