2024-01-24 10:52:46,512 - ============================== Params ==============================
2024-01-24 10:52:46,512 - logger_name: mult_MIntRec_multi-class_seed-1_2024-01-24-10-52-46
2024-01-24 10:52:46,512 - dataset: MIntRec
2024-01-24 10:52:46,512 - data_mode: multi-class
2024-01-24 10:52:46,512 - method: mult
2024-01-24 10:52:46,512 - text_backbone: bert-base-uncased
2024-01-24 10:52:46,512 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-24 10:52:46,512 - seed: 1
2024-01-24 10:52:46,512 - num_workers: 8
2024-01-24 10:52:46,512 - gpu_id: 1
2024-01-24 10:52:46,512 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-24 10:52:46,512 - train: True
2024-01-24 10:52:46,513 - tune: False
2024-01-24 10:52:46,513 - save_model: False
2024-01-24 10:52:46,513 - save_results: True
2024-01-24 10:52:46,513 - log_path: logs
2024-01-24 10:52:46,513 - cache_path: 
2024-01-24 10:52:46,513 - video_data_path: video_data
2024-01-24 10:52:46,513 - audio_data_path: audio_data
2024-01-24 10:52:46,513 - video_feats_path: video_feats.pkl
2024-01-24 10:52:46,513 - audio_feats_path: audio_feats.pkl
2024-01-24 10:52:46,513 - results_path: results
2024-01-24 10:52:46,513 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-24 10:52:46,513 - model_path: models
2024-01-24 10:52:46,513 - config_file_name: mult_bert
2024-01-24 10:52:46,513 - results_file_name: mult_bert.csv
2024-01-24 10:52:46,513 - padding_mode: zero
2024-01-24 10:52:46,513 - padding_loc: end
2024-01-24 10:52:46,513 - need_aligned: False
2024-01-24 10:52:46,513 - eval_monitor: f1
2024-01-24 10:52:46,513 - train_batch_size: 16
2024-01-24 10:52:46,513 - eval_batch_size: 8
2024-01-24 10:52:46,513 - test_batch_size: 8
2024-01-24 10:52:46,513 - wait_patience: 8
2024-01-24 10:52:46,513 - num_train_epochs: 100
2024-01-24 10:52:46,513 - dst_feature_dims: 120
2024-01-24 10:52:46,513 - nheads: 8
2024-01-24 10:52:46,513 - n_levels: 4
2024-01-24 10:52:46,513 - attn_dropout: 0.0
2024-01-24 10:52:46,513 - attn_dropout_v: 0.2
2024-01-24 10:52:46,513 - attn_dropout_a: 0.2
2024-01-24 10:52:46,513 - relu_dropout: 0.0
2024-01-24 10:52:46,513 - embed_dropout: 0.1
2024-01-24 10:52:46,513 - res_dropout: 0.0
2024-01-24 10:52:46,513 - output_dropout: 0.2
2024-01-24 10:52:46,514 - text_dropout: 0.4
2024-01-24 10:52:46,514 - grad_clip: 0.5
2024-01-24 10:52:46,514 - attn_mask: True
2024-01-24 10:52:46,514 - conv1d_kernel_size_l: 5
2024-01-24 10:52:46,514 - conv1d_kernel_size_v: 1
2024-01-24 10:52:46,514 - conv1d_kernel_size_a: 1
2024-01-24 10:52:46,514 - lr: 3e-05
2024-01-24 10:52:46,514 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/mult_MIntRec_multi-class_seed-1_2024-01-24-10-52-46
2024-01-24 10:52:46,514 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/mult_MIntRec_multi-class_seed-1_2024-01-24-10-52-46/models
2024-01-24 10:52:46,514 - ============================== End Params ==============================
2024-01-24 10:52:46,517 - Generate Text Features Begin...
2024-01-24 10:52:46,929 - Generate Text Features Finished...
2024-01-24 10:52:46,929 - Load Video Features Begin...
2024-01-24 10:52:47,199 - Load Video Features Finished...
2024-01-24 10:52:47,732 - Load Audio Features Begin...
2024-01-24 10:52:48,795 - Load Audio Features Finished...
2024-01-24 10:52:52,936 - method  begins...
2024-01-24 10:53:02,307 - Multimodal intent recognition begins...
2024-01-24 10:53:02,307 - Training begins...
2024-01-24 10:53:27,574 - ***** Epoch: 1: Eval results *****
2024-01-24 10:53:27,575 -   best_eval_score = 0.0
2024-01-24 10:53:27,575 -   eval_score = 0.5172
2024-01-24 10:53:27,575 -   train_loss = 2.0848
2024-01-24 10:53:51,429 - ***** Epoch: 2: Eval results *****
2024-01-24 10:53:51,429 -   best_eval_score = 0.5172
2024-01-24 10:53:51,429 -   eval_score = 0.633
2024-01-24 10:53:51,429 -   train_loss = 0.8883
2024-01-24 10:54:14,074 - ***** Epoch: 3: Eval results *****
2024-01-24 10:54:14,074 -   best_eval_score = 0.633
2024-01-24 10:54:14,074 -   eval_score = 0.6697
2024-01-24 10:54:14,074 -   train_loss = 0.4098
2024-01-24 10:54:36,306 - ***** Epoch: 4: Eval results *****
2024-01-24 10:54:36,307 -   best_eval_score = 0.6697
2024-01-24 10:54:36,307 -   eval_score = 0.6985
2024-01-24 10:54:36,307 -   train_loss = 0.1624
2024-01-24 10:54:59,137 - ***** Epoch: 5: Eval results *****
2024-01-24 10:54:59,138 -   best_eval_score = 0.6985
2024-01-24 10:54:59,138 -   eval_score = 0.6879
2024-01-24 10:54:59,138 -   train_loss = 0.0639
2024-01-24 10:54:59,138 - EarlyStopping counter: 1 out of 8
2024-01-24 10:55:21,716 - ***** Epoch: 6: Eval results *****
2024-01-24 10:55:21,716 -   best_eval_score = 0.6985
2024-01-24 10:55:21,716 -   eval_score = 0.6863
2024-01-24 10:55:21,716 -   train_loss = 0.033
2024-01-24 10:55:21,717 - EarlyStopping counter: 2 out of 8
2024-01-24 10:55:44,410 - ***** Epoch: 7: Eval results *****
2024-01-24 10:55:44,410 -   best_eval_score = 0.6985
2024-01-24 10:55:44,410 -   eval_score = 0.692
2024-01-24 10:55:44,410 -   train_loss = 0.0211
2024-01-24 10:55:44,410 - EarlyStopping counter: 3 out of 8
2024-01-24 10:56:06,749 - ***** Epoch: 8: Eval results *****
2024-01-24 10:56:06,750 -   best_eval_score = 0.6985
2024-01-24 10:56:06,750 -   eval_score = 0.6979
2024-01-24 10:56:06,750 -   train_loss = 0.0126
2024-01-24 10:56:06,750 - EarlyStopping counter: 4 out of 8
2024-01-24 10:56:29,087 - ***** Epoch: 9: Eval results *****
2024-01-24 10:56:29,088 -   best_eval_score = 0.6985
2024-01-24 10:56:29,088 -   eval_score = 0.7003
2024-01-24 10:56:29,088 -   train_loss = 0.0092
2024-01-24 10:56:51,069 - ***** Epoch: 10: Eval results *****
2024-01-24 10:56:51,069 -   best_eval_score = 0.7003
2024-01-24 10:56:51,069 -   eval_score = 0.7009
2024-01-24 10:56:51,069 -   train_loss = 0.0072
2024-01-24 10:57:13,565 - ***** Epoch: 11: Eval results *****
2024-01-24 10:57:13,565 -   best_eval_score = 0.7009
2024-01-24 10:57:13,565 -   eval_score = 0.7027
2024-01-24 10:57:13,565 -   train_loss = 0.0058
2024-01-24 10:57:36,758 - ***** Epoch: 12: Eval results *****
2024-01-24 10:57:36,759 -   best_eval_score = 0.7027
2024-01-24 10:57:36,759 -   eval_score = 0.7023
2024-01-24 10:57:36,759 -   train_loss = 0.005
2024-01-24 10:57:36,759 - EarlyStopping counter: 1 out of 8
2024-01-24 10:57:58,852 - ***** Epoch: 13: Eval results *****
2024-01-24 10:57:58,852 -   best_eval_score = 0.7027
2024-01-24 10:57:58,852 -   eval_score = 0.6965
2024-01-24 10:57:58,852 -   train_loss = 0.0044
2024-01-24 10:57:58,852 - EarlyStopping counter: 2 out of 8
2024-01-24 10:58:21,974 - ***** Epoch: 14: Eval results *****
2024-01-24 10:58:21,974 -   best_eval_score = 0.7027
2024-01-24 10:58:21,974 -   eval_score = 0.702
2024-01-24 10:58:21,974 -   train_loss = 0.0043
2024-01-24 10:58:21,974 - EarlyStopping counter: 3 out of 8
2024-01-24 10:58:45,347 - ***** Epoch: 15: Eval results *****
2024-01-24 10:58:45,348 -   best_eval_score = 0.7027
2024-01-24 10:58:45,348 -   eval_score = 0.7016
2024-01-24 10:58:45,348 -   train_loss = 0.0042
2024-01-24 10:58:45,348 - EarlyStopping counter: 4 out of 8
2024-01-24 10:59:08,445 - ***** Epoch: 16: Eval results *****
2024-01-24 10:59:08,446 -   best_eval_score = 0.7027
2024-01-24 10:59:08,446 -   eval_score = 0.7016
2024-01-24 10:59:08,446 -   train_loss = 0.0043
2024-01-24 10:59:08,446 - EarlyStopping counter: 5 out of 8
2024-01-24 10:59:30,728 - ***** Epoch: 17: Eval results *****
2024-01-24 10:59:30,729 -   best_eval_score = 0.7027
2024-01-24 10:59:30,729 -   eval_score = 0.7016
2024-01-24 10:59:30,729 -   train_loss = 0.0042
2024-01-24 10:59:30,729 - EarlyStopping counter: 6 out of 8
2024-01-24 10:59:53,527 - ***** Epoch: 18: Eval results *****
2024-01-24 10:59:53,527 -   best_eval_score = 0.7027
2024-01-24 10:59:53,527 -   eval_score = 0.7016
2024-01-24 10:59:53,527 -   train_loss = 0.004
2024-01-24 10:59:53,527 - EarlyStopping counter: 7 out of 8
2024-01-24 11:00:16,847 - ***** Epoch: 19: Eval results *****
2024-01-24 11:00:16,847 -   best_eval_score = 0.7027
2024-01-24 11:00:16,847 -   eval_score = 0.7039
2024-01-24 11:00:16,847 -   train_loss = 0.004
2024-01-24 11:00:39,576 - ***** Epoch: 20: Eval results *****
2024-01-24 11:00:39,577 -   best_eval_score = 0.7039
2024-01-24 11:00:39,577 -   eval_score = 0.6994
2024-01-24 11:00:39,577 -   train_loss = 0.0038
2024-01-24 11:00:39,577 - EarlyStopping counter: 1 out of 8
2024-01-24 11:01:02,655 - ***** Epoch: 21: Eval results *****
2024-01-24 11:01:02,655 -   best_eval_score = 0.7039
2024-01-24 11:01:02,655 -   eval_score = 0.6971
2024-01-24 11:01:02,655 -   train_loss = 0.0038
2024-01-24 11:01:02,655 - EarlyStopping counter: 2 out of 8
2024-01-24 11:01:25,024 - ***** Epoch: 22: Eval results *****
2024-01-24 11:01:25,024 -   best_eval_score = 0.7039
2024-01-24 11:01:25,024 -   eval_score = 0.6971
2024-01-24 11:01:25,024 -   train_loss = 0.0038
2024-01-24 11:01:25,024 - EarlyStopping counter: 3 out of 8
2024-01-24 11:01:47,285 - ***** Epoch: 23: Eval results *****
2024-01-24 11:01:47,285 -   best_eval_score = 0.7039
2024-01-24 11:01:47,285 -   eval_score = 0.6971
2024-01-24 11:01:47,285 -   train_loss = 0.0037
2024-01-24 11:01:47,285 - EarlyStopping counter: 4 out of 8
2024-01-24 11:02:09,799 - ***** Epoch: 24: Eval results *****
2024-01-24 11:02:09,799 -   best_eval_score = 0.7039
2024-01-24 11:02:09,799 -   eval_score = 0.6971
2024-01-24 11:02:09,799 -   train_loss = 0.0038
2024-01-24 11:02:09,799 - EarlyStopping counter: 5 out of 8
2024-01-24 11:02:32,950 - ***** Epoch: 25: Eval results *****
2024-01-24 11:02:32,951 -   best_eval_score = 0.7039
2024-01-24 11:02:32,951 -   eval_score = 0.6971
2024-01-24 11:02:32,951 -   train_loss = 0.0037
2024-01-24 11:02:32,951 - EarlyStopping counter: 6 out of 8
2024-01-24 11:02:55,818 - ***** Epoch: 26: Eval results *****
2024-01-24 11:02:55,818 -   best_eval_score = 0.7039
2024-01-24 11:02:55,818 -   eval_score = 0.6971
2024-01-24 11:02:55,818 -   train_loss = 0.0037
2024-01-24 11:02:55,818 - EarlyStopping counter: 7 out of 8
2024-01-24 11:03:18,966 - ***** Epoch: 27: Eval results *****
2024-01-24 11:03:18,966 -   best_eval_score = 0.7039
2024-01-24 11:03:18,966 -   eval_score = 0.6971
2024-01-24 11:03:18,966 -   train_loss = 0.0037
2024-01-24 11:03:18,966 - EarlyStopping counter: 8 out of 8
2024-01-24 11:03:18,966 - EarlyStopping at epoch 27
2024-01-24 11:03:18,969 - Training is finished...
2024-01-24 11:03:18,969 - Testing begins...
2024-01-24 11:03:22,827 - ***** Test: Confusion Matrix *****
2024-01-24 11:03:22,828 - [[38  2  0  0  5  0  1  1  1  4  0  0  3  2  0  0  0  0  0  0]
 [ 2 34  0  1  0  1  1  0  0  0  1  0  2  1  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0 13  0  2  0  0  1  0  1  1  0  1  0  0  2  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 2  0  0  0  3  0  2  0  3  0  0  0  1  0  0  0  1  0  0  0]
 [ 3  0  0  0  0  0  0  4  1  1  1  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  3  4  0  0  0  1  0  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  4  1  0  0  0  0  2  0  1  0  0]
 [ 1  0  0  0  0  0  0  0  0  2 15  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  0  1]
 [ 3  3  0  0  1  0  0  1  0  1  0  1 37  2  4  2  1  0  1  0]
 [ 1  1  0  0  0  0  1  0  0  0  1  1  0 19  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  2 15  0  1  0  0  2]
 [ 0  1  0  0  1  0  0  0  0  0  0  0  3  0  0 15  0  0  0  1]
 [ 1  0  0  0  0  0  0  2  0  0  0  0  1  0  1  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  2  0  1  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0  0  8]]
2024-01-24 11:03:22,829 - ***** Evaluation results *****
2024-01-24 11:03:22,829 -   acc = 0.7146
2024-01-24 11:03:22,829 -   f1 = 0.6843
2024-01-24 11:03:22,829 -   prec = 0.6855
2024-01-24 11:03:22,829 -   rec = 0.6876
2024-01-24 11:03:22,829 - Testing is finished...
2024-01-24 11:03:22,829 - Multimodal intent recognition is finished...
2024-01-24 11:03:22,829 - Results are saved in results/mult_bert.csv
