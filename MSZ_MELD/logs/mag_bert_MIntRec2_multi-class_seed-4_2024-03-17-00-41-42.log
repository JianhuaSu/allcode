2024-03-17 00:41:42,528 - ============================== Params ==============================
2024-03-17 00:41:42,528 - logger_name: mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-00-41-42
2024-03-17 00:41:42,529 - dataset: MIntRec2
2024-03-17 00:41:42,529 - data_mode: multi-class
2024-03-17 00:41:42,529 - method: mag_bert
2024-03-17 00:41:42,529 - text_backbone: bert-base-uncased
2024-03-17 00:41:42,529 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-17 00:41:42,529 - seed: 4
2024-03-17 00:41:42,529 - num_workers: 8
2024-03-17 00:41:42,529 - gpu_id: 2
2024-03-17 00:41:42,529 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-17 00:41:42,529 - train: True
2024-03-17 00:41:42,529 - tune: True
2024-03-17 00:41:42,529 - save_model: False
2024-03-17 00:41:42,529 - save_results: True
2024-03-17 00:41:42,529 - log_path: logs
2024-03-17 00:41:42,529 - cache_path: 
2024-03-17 00:41:42,529 - video_data_path: video_data
2024-03-17 00:41:42,529 - audio_data_path: audio_data
2024-03-17 00:41:42,529 - video_feats_path: video_feats.pkl
2024-03-17 00:41:42,529 - audio_feats_path: audio_feats.pkl
2024-03-17 00:41:42,529 - results_path: results
2024-03-17 00:41:42,529 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-17 00:41:42,529 - model_path: models
2024-03-17 00:41:42,529 - config_file_name: mag_bert_MIntRec2
2024-03-17 00:41:42,529 - results_file_name: mag_bert.csv
2024-03-17 00:41:42,529 - padding_mode: zero
2024-03-17 00:41:42,529 - padding_loc: end
2024-03-17 00:41:42,529 - need_aligned: True
2024-03-17 00:41:42,529 - eval_monitor: f1
2024-03-17 00:41:42,529 - train_batch_size: 32
2024-03-17 00:41:42,529 - eval_batch_size: 16
2024-03-17 00:41:42,529 - test_batch_size: 16
2024-03-17 00:41:42,529 - wait_patience: 8
2024-03-17 00:41:42,529 - num_train_epochs: 100
2024-03-17 00:41:42,529 - beta_shift: 0.01
2024-03-17 00:41:42,529 - dropout_prob: 0.3
2024-03-17 00:41:42,529 - warmup_proportion: 0.1
2024-03-17 00:41:42,529 - lr: 3e-05
2024-03-17 00:41:42,529 - aligned_method: ctc
2024-03-17 00:41:42,529 - weight_decay: 0.1
2024-03-17 00:41:42,529 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-00-41-42
2024-03-17 00:41:42,529 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-17-00-41-42/models
2024-03-17 00:41:42,529 - num_labels: 30
2024-03-17 00:41:42,529 - text_feat_dim: 768
2024-03-17 00:41:42,529 - video_feat_dim: 256
2024-03-17 00:41:42,529 - audio_feat_dim: 768
2024-03-17 00:41:42,530 - text_seq_len: 50
2024-03-17 00:41:42,530 - video_seq_len: 180
2024-03-17 00:41:42,530 - audio_seq_len: 400
2024-03-17 00:41:42,530 - device: cuda:2
2024-03-17 00:41:42,530 - ============================== End Params ==============================
2024-03-17 00:41:42,543 - Generate Text Features Begin...
2024-03-17 00:41:44,166 - Generate Text Features Finished...
2024-03-17 00:41:44,167 - Load Video Features Begin...
2024-03-17 00:41:45,172 - Load Video Features Finished...
2024-03-17 00:41:46,815 - Load Audio Features Begin...
2024-03-17 00:41:50,718 - Load Audio Features Finished...
2024-03-17 00:42:09,892 - method  begins...
2024-03-17 00:42:10,839 - Multimodal intent recognition begins...
2024-03-17 00:42:10,839 - Training begins...
2024-03-17 00:42:48,394 - ***** Epoch: 1: Eval results *****
2024-03-17 00:42:48,396 -   train_loss = 3.2324
2024-03-17 00:42:48,396 -   best_eval_score = 0.0
2024-03-17 00:42:48,397 -   eval_score = 0.0686
2024-03-17 00:43:25,733 - ***** Epoch: 2: Eval results *****
2024-03-17 00:43:25,734 -   train_loss = 2.6484
2024-03-17 00:43:25,734 -   best_eval_score = 0.0686
2024-03-17 00:43:25,734 -   eval_score = 0.2464
2024-03-17 00:44:05,627 - ***** Epoch: 3: Eval results *****
2024-03-17 00:44:05,628 -   train_loss = 2.0519
2024-03-17 00:44:05,628 -   best_eval_score = 0.2464
2024-03-17 00:44:05,628 -   eval_score = 0.3419
2024-03-17 00:44:41,614 - ***** Epoch: 4: Eval results *****
2024-03-17 00:44:41,614 -   train_loss = 1.6533
2024-03-17 00:44:41,614 -   best_eval_score = 0.3419
2024-03-17 00:44:41,614 -   eval_score = 0.4001
2024-03-17 00:45:21,274 - ***** Epoch: 5: Eval results *****
2024-03-17 00:45:21,275 -   train_loss = 1.373
2024-03-17 00:45:21,275 -   best_eval_score = 0.4001
2024-03-17 00:45:21,275 -   eval_score = 0.4371
2024-03-17 00:45:55,780 - ***** Epoch: 6: Eval results *****
2024-03-17 00:45:55,781 -   train_loss = 1.14
2024-03-17 00:45:55,781 -   best_eval_score = 0.4371
2024-03-17 00:45:55,781 -   eval_score = 0.4451
2024-03-17 00:46:36,418 - ***** Epoch: 7: Eval results *****
2024-03-17 00:46:36,418 -   train_loss = 0.9281
2024-03-17 00:46:36,419 -   best_eval_score = 0.4451
2024-03-17 00:46:36,419 -   eval_score = 0.4709
2024-03-17 00:47:14,897 - ***** Epoch: 8: Eval results *****
2024-03-17 00:47:14,897 -   train_loss = 0.7132
2024-03-17 00:47:14,897 -   best_eval_score = 0.4709
2024-03-17 00:47:14,898 -   eval_score = 0.5094
2024-03-17 00:47:50,986 - ***** Epoch: 9: Eval results *****
2024-03-17 00:47:50,986 -   train_loss = 0.5523
2024-03-17 00:47:50,986 -   best_eval_score = 0.5094
2024-03-17 00:47:50,986 -   eval_score = 0.4939
2024-03-17 00:47:50,986 - EarlyStopping counter: 1 out of 8
2024-03-17 00:48:29,069 - ***** Epoch: 10: Eval results *****
2024-03-17 00:48:29,070 -   train_loss = 0.4449
2024-03-17 00:48:29,070 -   best_eval_score = 0.5094
2024-03-17 00:48:29,070 -   eval_score = 0.5134
2024-03-17 00:49:05,821 - ***** Epoch: 11: Eval results *****
2024-03-17 00:49:05,821 -   train_loss = 0.3303
2024-03-17 00:49:05,821 -   best_eval_score = 0.5134
2024-03-17 00:49:05,822 -   eval_score = 0.5214
2024-03-17 00:49:45,019 - ***** Epoch: 12: Eval results *****
2024-03-17 00:49:45,019 -   train_loss = 0.2359
2024-03-17 00:49:45,019 -   best_eval_score = 0.5214
2024-03-17 00:49:45,019 -   eval_score = 0.5228
2024-03-17 00:50:25,902 - ***** Epoch: 13: Eval results *****
2024-03-17 00:50:25,902 -   train_loss = 0.1778
2024-03-17 00:50:25,902 -   best_eval_score = 0.5228
2024-03-17 00:50:25,902 -   eval_score = 0.5032
2024-03-17 00:50:25,903 - EarlyStopping counter: 1 out of 8
2024-03-17 00:51:01,682 - ***** Epoch: 14: Eval results *****
2024-03-17 00:51:01,683 -   train_loss = 0.1378
2024-03-17 00:51:01,683 -   best_eval_score = 0.5228
2024-03-17 00:51:01,683 -   eval_score = 0.5192
2024-03-17 00:51:01,683 - EarlyStopping counter: 2 out of 8
2024-03-17 00:51:40,331 - ***** Epoch: 15: Eval results *****
2024-03-17 00:51:40,331 -   train_loss = 0.1119
2024-03-17 00:51:40,331 -   best_eval_score = 0.5228
2024-03-17 00:51:40,331 -   eval_score = 0.5225
2024-03-17 00:51:40,332 - EarlyStopping counter: 3 out of 8
2024-03-17 00:52:16,623 - ***** Epoch: 16: Eval results *****
2024-03-17 00:52:16,624 -   train_loss = 0.1093
2024-03-17 00:52:16,624 -   best_eval_score = 0.5228
2024-03-17 00:52:16,624 -   eval_score = 0.5244
2024-03-17 00:52:54,367 - ***** Epoch: 17: Eval results *****
2024-03-17 00:52:54,367 -   train_loss = 0.1049
2024-03-17 00:52:54,367 -   best_eval_score = 0.5244
2024-03-17 00:52:54,368 -   eval_score = 0.4989
2024-03-17 00:52:54,368 - EarlyStopping counter: 1 out of 8
2024-03-17 00:53:30,825 - ***** Epoch: 18: Eval results *****
2024-03-17 00:53:30,825 -   train_loss = 0.0875
2024-03-17 00:53:30,825 -   best_eval_score = 0.5244
2024-03-17 00:53:30,825 -   eval_score = 0.4961
2024-03-17 00:53:30,825 - EarlyStopping counter: 2 out of 8
2024-03-17 00:54:06,128 - ***** Epoch: 19: Eval results *****
2024-03-17 00:54:06,129 -   train_loss = 0.069
2024-03-17 00:54:06,129 -   best_eval_score = 0.5244
2024-03-17 00:54:06,129 -   eval_score = 0.5057
2024-03-17 00:54:06,129 - EarlyStopping counter: 3 out of 8
2024-03-17 00:54:46,208 - ***** Epoch: 20: Eval results *****
2024-03-17 00:54:46,209 -   train_loss = 0.0632
2024-03-17 00:54:46,209 -   best_eval_score = 0.5244
2024-03-17 00:54:46,209 -   eval_score = 0.499
2024-03-17 00:54:46,209 - EarlyStopping counter: 4 out of 8
2024-03-17 00:55:24,992 - ***** Epoch: 21: Eval results *****
2024-03-17 00:55:24,993 -   train_loss = 0.0635
2024-03-17 00:55:24,993 -   best_eval_score = 0.5244
2024-03-17 00:55:24,993 -   eval_score = 0.4997
2024-03-17 00:55:24,993 - EarlyStopping counter: 5 out of 8
2024-03-17 00:56:01,514 - ***** Epoch: 22: Eval results *****
2024-03-17 00:56:01,515 -   train_loss = 0.0683
2024-03-17 00:56:01,515 -   best_eval_score = 0.5244
2024-03-17 00:56:01,515 -   eval_score = 0.5087
2024-03-17 00:56:01,515 - EarlyStopping counter: 6 out of 8
2024-03-17 00:56:37,636 - ***** Epoch: 23: Eval results *****
2024-03-17 00:56:37,636 -   train_loss = 0.0696
2024-03-17 00:56:37,636 -   best_eval_score = 0.5244
2024-03-17 00:56:37,636 -   eval_score = 0.4927
2024-03-17 00:56:37,636 - EarlyStopping counter: 7 out of 8
2024-03-17 00:57:13,434 - ***** Epoch: 24: Eval results *****
2024-03-17 00:57:13,434 -   train_loss = 0.0759
2024-03-17 00:57:13,434 -   best_eval_score = 0.5244
2024-03-17 00:57:13,434 -   eval_score = 0.4992
2024-03-17 00:57:13,434 - EarlyStopping counter: 8 out of 8
2024-03-17 00:57:13,434 - EarlyStopping at epoch 24
2024-03-17 00:57:13,436 - Training is finished...
2024-03-17 00:57:13,437 - Testing begins...
2024-03-17 00:57:21,872 - ***** Test: Confusion Matrix *****
2024-03-17 00:57:21,878 - [[ 51   0  12   0   0   0   0   0   1   0   2   0   0   1   1   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0  51   0   0   8   3   5   0   1   0   2   0   3   0   4   0   1  11
    1   0   2   1   0   0   1   0   0   3   0   0]
 [ 11   0  40   0   0   0   0   0   0   0   1   0   0   2   0   0   0   3
    1   0   0   1   0   2   2   0   0   1   0   0]
 [  0   0   0  59   0   0   0   1   0   0   0   0   0   0   3   0   1   1
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   4   0   0  34   1   0   0   1   0   0   0   0   0   0   0   0   4
    0   1   0   1   0   1   1   0   0   0   1   2]
 [  0   0   0   0   1  28   0   0   0   1   2   0   0   0   1   0   0   2
    0   0   0   0   0   1   0   0   1   0   0   0]
 [  0   1   0   0   0   2  17  12   0   1   6   0   7   0   0   0   0   0
    0   1   0   0   0   0   0   1   0   0   0   0]
 [  0   0   0   0   0   0   3  27   0   0   7   0   5   0   0   0   3   0
    0   0   0   0   1   0   0   0   0   0   0   1]
 [  1   1   2   2   1   1   0   0  22   0   0   1   1   0   0   0   1   7
    1   0   1   0   4   0   3   0   0   0   0   0]
 [  0   0   1   1   1   0   0   0   2  53   0   4   8   2   9   1   0   8
    1   0   0   2   4   1   2   1   0   5   0   1]
 [  2   0   0   0   0   4   1   2   0   1  54   0  20   0   3   0   1   1
    0   2   0   0   0   0   1   0   0   1   0   0]
 [  0   0   0   0   0   0   0   2   0   5   0  13   8   0   2   0   0   2
    1   0   2   0   4   0   0   0   0   7   0   1]
 [  0   2   0   0   0   1   0   9   0   7  30   1  82   2   0   0   1   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   2   0   1   0   0   0   0   1   0   0   0   1   1   2   0   4
    2   0   2   0   1   0   0   0   0   0   0   0]
 [  0   2   3   0   1   2   0   0   5   9   1   0   1   4 101   3   0  33
    4   0   6   0  12   1   2   0   0   3   0   0]
 [  0   0   2   0   0   0   0   0   0   4   0   0   0   1   3   4   0   1
    2   0   2   1   1   0   0   0   0   0   1   0]
 [  0   0   0   0   1   0   0   0   0   0   2   0   2   0   0   0  59   0
    2   0   0   0   0   0   0   0   0   0   0   0]
 [  2   5   1   0   7   3   0   0   3   9   2   0   1   3  14   4   3 127
    6   1   6   3   7   5   0   1   1   1   2   0]
 [  0   2   0   0   0   0   0   0   0   3   1   0   0   2   3   0   3   7
   27   1   8   0   2   0   1   0   0   0   0   0]
 [  0   2   0   0   1   0   1   0   0   0   3   0   0   0   0   0   0   1
    0   7   0   2   0   0   0   0   0   0   0   0]
 [  0   2   2   0   0   0   0   0   0   1   0   0   1   0   4   1   0   2
    2   0  10   0   0   1   1   0   0   2   0   0]
 [  7   1   0   0   1   0   0   0   0   3   0   0   0   0   1   0   4   1
    0   1   1  24   2   3   0   0   0   2   0   2]
 [  0   0   2   0   0   0   0   0   0   4   0   0   0   1   6   2   0   5
    0   0   0   1  81   0   2   3   9   1   0   0]
 [  0   2   2   0   1   0   0   0   0   2   0   0   0   0   1   0   0  12
    0   0   1   4   0  13   0   0   0   0   0   0]
 [  2   0   4   0   0   0   0   0   1   2   0   3   0   1   3   1   0   3
    1   0   0   1   1   0  78   0   0  11   1   0]
 [  1   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   2
    0   0   0   0   2   0   0  22   1   1   0   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   1   1   0   0   3
    0   0   0   1   2   1   0   0   7   0   1   0]
 [  1   2   1   0   0   0   0   1   0   4   2   1   3   1   2   0   0   4
    0   0   5   0   3   0   8   3   0  14   1   2]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   1   0
    0   0   0   0   0   0   0   0   0   0  56   0]
 [  0   1   0   0   0   0   0   0   1   1   1   1   0   0   0   0   0   3
    0   0   3   0   0   0   1   1   0   0   0   6]]
2024-03-17 00:57:21,879 - ***** Evaluation results *****
2024-03-17 00:57:21,879 -   acc = 0.5745
2024-03-17 00:57:21,879 -   f1 = 0.5274
2024-03-17 00:57:21,879 -   prec = 0.5392
2024-03-17 00:57:21,879 -   rec = 0.528
2024-03-17 00:57:21,880 - Testing is finished...
2024-03-17 00:57:21,880 - Multimodal intent recognition is finished...
2024-03-17 00:57:21,880 - Results are saved in results/mag_bert.csv
