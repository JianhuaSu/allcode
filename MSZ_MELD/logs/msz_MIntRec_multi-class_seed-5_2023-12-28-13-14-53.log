2023-12-28 13:14:53,509 - ============================== Params ==============================
2023-12-28 13:14:53,509 - logger_name: msz_MIntRec_multi-class_seed-5_2023-12-28-13-14-53
2023-12-28 13:14:53,509 - dataset: MIntRec
2023-12-28 13:14:53,509 - data_mode: multi-class
2023-12-28 13:14:53,509 - method: msz
2023-12-28 13:14:53,509 - text_backbone: bert-base-uncased
2023-12-28 13:14:53,509 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-28 13:14:53,509 - seed: 5
2023-12-28 13:14:53,509 - num_workers: 8
2023-12-28 13:14:53,509 - gpu_id: 3
2023-12-28 13:14:53,509 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-28 13:14:53,509 - train: True
2023-12-28 13:14:53,509 - tune: False
2023-12-28 13:14:53,509 - save_model: False
2023-12-28 13:14:53,509 - save_results: True
2023-12-28 13:14:53,509 - log_path: logs
2023-12-28 13:14:53,509 - cache_path: 
2023-12-28 13:14:53,509 - video_data_path: video_data
2023-12-28 13:14:53,509 - audio_data_path: audio_data
2023-12-28 13:14:53,509 - video_feats_path: video_feats.pkl
2023-12-28 13:14:53,509 - audio_feats_path: audio_feats.pkl
2023-12-28 13:14:53,509 - results_path: results
2023-12-28 13:14:53,509 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-28 13:14:53,509 - model_path: models
2023-12-28 13:14:53,509 - config_file_name: msz
2023-12-28 13:14:53,509 - results_file_name: msz.csv
2023-12-28 13:14:53,509 - padding_mode: zero
2023-12-28 13:14:53,510 - padding_loc: end
2023-12-28 13:14:53,510 - need_aligned: False
2023-12-28 13:14:53,510 - eval_monitor: f1
2023-12-28 13:14:53,510 - train_batch_size: 16
2023-12-28 13:14:53,510 - eval_batch_size: 8
2023-12-28 13:14:53,510 - test_batch_size: 8
2023-12-28 13:14:53,510 - wait_patience: 8
2023-12-28 13:14:53,510 - nheads: 2
2023-12-28 13:14:53,510 - encoder_layers: 2
2023-12-28 13:14:53,510 - attn_dropout: 0.1
2023-12-28 13:14:53,510 - relu_dropout: 0.1
2023-12-28 13:14:53,510 - embed_dropout: 0.1
2023-12-28 13:14:53,510 - res_dropout: 0.1
2023-12-28 13:14:53,510 - attn_mask: False
2023-12-28 13:14:53,510 - hidden_size: 768
2023-12-28 13:14:53,510 - num_attention_heads: 12
2023-12-28 13:14:53,510 - attention_probs_dropout_prob: 0.2
2023-12-28 13:14:53,510 - hidden_dropout_prob: 0.2
2023-12-28 13:14:53,510 - intermediate_size: 768
2023-12-28 13:14:53,510 - num_hidden_layers: 3
2023-12-28 13:14:53,510 - max_position_embeddings: 512
2023-12-28 13:14:53,510 - position_embedding_type: absolute
2023-12-28 13:14:53,510 - batch_first: True
2023-12-28 13:14:53,510 - hidden_dims: 768
2023-12-28 13:14:53,510 - att_dropouts: [0.2, 0.2, 0.2]
2023-12-28 13:14:53,510 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-28 13:14:53,510 - ta_loss: 0.01
2023-12-28 13:14:53,510 - tv_loss: 0.01
2023-12-28 13:14:53,510 - av_loss: 0.01
2023-12-28 13:14:53,510 - aligned_method: conv1d
2023-12-28 13:14:53,510 - grad_clip: 2
2023-12-28 13:14:53,510 - num_train_epochs: 100
2023-12-28 13:14:53,510 - warmup_proportion: 0.1
2023-12-28 13:14:53,510 - lr: 1e-06
2023-12-28 13:14:53,510 - weight_decay: 0.02
2023-12-28 13:14:53,510 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-5_2023-12-28-13-14-53
2023-12-28 13:14:53,511 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-5_2023-12-28-13-14-53/models
2023-12-28 13:14:53,511 - ============================== End Params ==============================
2023-12-28 13:14:53,689 - Generate Text Features Begin...
2023-12-28 13:14:54,301 - Generate Text Features Finished...
2023-12-28 13:14:54,304 - Load Video Features Begin...
2023-12-28 13:15:02,485 - Load Video Features Finished...
2023-12-28 13:15:03,154 - Load Audio Features Begin...
2023-12-28 13:15:15,420 - Load Audio Features Finished...
2023-12-28 13:15:19,022 - method  begins...
2023-12-28 13:15:26,109 - Multimodal intent recognition begins...
2023-12-28 13:15:26,109 - Training begins...
2023-12-28 13:15:53,425 - ***** Epoch: 1: Eval results *****
2023-12-28 13:15:53,426 -   train_loss = 3.3536
2023-12-28 13:15:53,426 -   best_eval_score = 0.0
2023-12-28 13:15:53,426 -   eval_score = 0.0292
2023-12-28 13:16:18,730 - ***** Epoch: 2: Eval results *****
2023-12-28 13:16:18,732 -   train_loss = 3.1668
2023-12-28 13:16:18,732 -   best_eval_score = 0.0292
2023-12-28 13:16:18,732 -   eval_score = 0.0231
2023-12-28 13:16:18,732 - EarlyStopping counter: 1 out of 8
2023-12-28 13:16:48,504 - ***** Epoch: 3: Eval results *****
2023-12-28 13:16:48,504 -   train_loss = 3.0494
2023-12-28 13:16:48,504 -   best_eval_score = 0.0292
2023-12-28 13:16:48,504 -   eval_score = 0.0289
2023-12-28 13:16:48,504 - EarlyStopping counter: 2 out of 8
2023-12-28 13:17:13,754 - ***** Epoch: 4: Eval results *****
2023-12-28 13:17:13,754 -   train_loss = 2.9799
2023-12-28 13:17:13,754 -   best_eval_score = 0.0292
2023-12-28 13:17:13,754 -   eval_score = 0.0131
2023-12-28 13:17:13,754 - EarlyStopping counter: 3 out of 8
2023-12-28 13:17:37,863 - ***** Epoch: 5: Eval results *****
2023-12-28 13:17:37,863 -   train_loss = 2.9495
2023-12-28 13:17:37,863 -   best_eval_score = 0.0292
2023-12-28 13:17:37,863 -   eval_score = 0.0257
2023-12-28 13:17:37,863 - EarlyStopping counter: 4 out of 8
2023-12-28 13:18:01,666 - ***** Epoch: 6: Eval results *****
2023-12-28 13:18:01,667 -   train_loss = 2.9165
2023-12-28 13:18:01,667 -   best_eval_score = 0.0292
2023-12-28 13:18:01,667 -   eval_score = 0.0206
2023-12-28 13:18:01,667 - EarlyStopping counter: 5 out of 8
2023-12-28 13:18:27,644 - ***** Epoch: 7: Eval results *****
2023-12-28 13:18:27,644 -   train_loss = 2.893
2023-12-28 13:18:27,645 -   best_eval_score = 0.0292
2023-12-28 13:18:27,645 -   eval_score = 0.0297
2023-12-28 13:18:51,819 - ***** Epoch: 8: Eval results *****
2023-12-28 13:18:51,819 -   train_loss = 2.8683
2023-12-28 13:18:51,819 -   best_eval_score = 0.0297
2023-12-28 13:18:51,819 -   eval_score = 0.0148
2023-12-28 13:18:51,819 - EarlyStopping counter: 1 out of 8
2023-12-28 13:19:16,515 - ***** Epoch: 9: Eval results *****
2023-12-28 13:19:16,515 -   train_loss = 2.8404
2023-12-28 13:19:16,515 -   best_eval_score = 0.0297
2023-12-28 13:19:16,515 -   eval_score = 0.0397
2023-12-28 13:19:40,482 - ***** Epoch: 10: Eval results *****
2023-12-28 13:19:40,483 -   train_loss = 2.8123
2023-12-28 13:19:40,483 -   best_eval_score = 0.0397
2023-12-28 13:19:40,483 -   eval_score = 0.06
2023-12-28 13:20:08,399 - ***** Epoch: 11: Eval results *****
2023-12-28 13:20:08,400 -   train_loss = 2.747
2023-12-28 13:20:08,400 -   best_eval_score = 0.06
2023-12-28 13:20:08,400 -   eval_score = 0.1117
2023-12-28 13:20:32,955 - ***** Epoch: 12: Eval results *****
2023-12-28 13:20:32,955 -   train_loss = 2.6365
2023-12-28 13:20:32,955 -   best_eval_score = 0.1117
2023-12-28 13:20:32,955 -   eval_score = 0.1064
2023-12-28 13:20:32,955 - EarlyStopping counter: 1 out of 8
2023-12-28 13:20:57,930 - ***** Epoch: 13: Eval results *****
2023-12-28 13:20:57,930 -   train_loss = 2.4809
2023-12-28 13:20:57,930 -   best_eval_score = 0.1117
2023-12-28 13:20:57,931 -   eval_score = 0.1892
2023-12-28 13:21:22,389 - ***** Epoch: 14: Eval results *****
2023-12-28 13:21:22,389 -   train_loss = 2.2638
2023-12-28 13:21:22,389 -   best_eval_score = 0.1892
2023-12-28 13:21:22,390 -   eval_score = 0.2167
2023-12-28 13:21:54,325 - ***** Epoch: 15: Eval results *****
2023-12-28 13:21:54,326 -   train_loss = 2.0617
2023-12-28 13:21:54,326 -   best_eval_score = 0.2167
2023-12-28 13:21:54,326 -   eval_score = 0.2864
2023-12-28 13:22:19,781 - ***** Epoch: 16: Eval results *****
2023-12-28 13:22:19,790 -   train_loss = 1.8223
2023-12-28 13:22:19,790 -   best_eval_score = 0.2864
2023-12-28 13:22:19,790 -   eval_score = 0.2293
2023-12-28 13:22:19,790 - EarlyStopping counter: 1 out of 8
2023-12-28 13:22:48,493 - ***** Epoch: 17: Eval results *****
2023-12-28 13:22:48,494 -   train_loss = 1.6172
2023-12-28 13:22:48,494 -   best_eval_score = 0.2864
2023-12-28 13:22:48,494 -   eval_score = 0.3056
2023-12-28 13:23:13,521 - ***** Epoch: 18: Eval results *****
2023-12-28 13:23:13,522 -   train_loss = 1.4078
2023-12-28 13:23:13,522 -   best_eval_score = 0.3056
2023-12-28 13:23:13,522 -   eval_score = 0.3906
2023-12-28 13:23:38,698 - ***** Epoch: 19: Eval results *****
2023-12-28 13:23:38,698 -   train_loss = 1.2909
2023-12-28 13:23:38,698 -   best_eval_score = 0.3906
2023-12-28 13:23:38,698 -   eval_score = 0.5036
2023-12-28 13:24:03,234 - ***** Epoch: 20: Eval results *****
2023-12-28 13:24:03,234 -   train_loss = 1.1128
2023-12-28 13:24:03,234 -   best_eval_score = 0.5036
2023-12-28 13:24:03,234 -   eval_score = 0.5024
2023-12-28 13:24:03,234 - EarlyStopping counter: 1 out of 8
2023-12-28 13:24:29,025 - ***** Epoch: 21: Eval results *****
2023-12-28 13:24:29,025 -   train_loss = 0.9225
2023-12-28 13:24:29,025 -   best_eval_score = 0.5036
2023-12-28 13:24:29,025 -   eval_score = 0.5165
2023-12-28 13:24:53,829 - ***** Epoch: 22: Eval results *****
2023-12-28 13:24:53,829 -   train_loss = 0.8075
2023-12-28 13:24:53,829 -   best_eval_score = 0.5165
2023-12-28 13:24:53,829 -   eval_score = 0.5573
2023-12-28 13:25:21,329 - ***** Epoch: 23: Eval results *****
2023-12-28 13:25:21,330 -   train_loss = 0.6655
2023-12-28 13:25:21,330 -   best_eval_score = 0.5573
2023-12-28 13:25:21,330 -   eval_score = 0.5309
2023-12-28 13:25:21,330 - EarlyStopping counter: 1 out of 8
2023-12-28 13:25:45,714 - ***** Epoch: 24: Eval results *****
2023-12-28 13:25:45,715 -   train_loss = 0.5697
2023-12-28 13:25:45,715 -   best_eval_score = 0.5573
2023-12-28 13:25:45,715 -   eval_score = 0.5354
2023-12-28 13:25:45,715 - EarlyStopping counter: 2 out of 8
2023-12-28 13:26:09,661 - ***** Epoch: 25: Eval results *****
2023-12-28 13:26:09,670 -   train_loss = 0.4993
2023-12-28 13:26:09,670 -   best_eval_score = 0.5573
2023-12-28 13:26:09,670 -   eval_score = 0.5622
2023-12-28 13:26:34,590 - ***** Epoch: 26: Eval results *****
2023-12-28 13:26:34,592 -   train_loss = 0.3949
2023-12-28 13:26:34,592 -   best_eval_score = 0.5622
2023-12-28 13:26:34,592 -   eval_score = 0.6124
2023-12-28 13:27:00,746 - ***** Epoch: 27: Eval results *****
2023-12-28 13:27:00,747 -   train_loss = 0.3635
2023-12-28 13:27:00,747 -   best_eval_score = 0.6124
2023-12-28 13:27:00,747 -   eval_score = 0.6107
2023-12-28 13:27:00,747 - EarlyStopping counter: 1 out of 8
2023-12-28 13:27:25,454 - ***** Epoch: 28: Eval results *****
2023-12-28 13:27:25,454 -   train_loss = 0.2936
2023-12-28 13:27:25,454 -   best_eval_score = 0.6124
2023-12-28 13:27:25,454 -   eval_score = 0.621
2023-12-28 13:27:49,678 - ***** Epoch: 29: Eval results *****
2023-12-28 13:27:49,678 -   train_loss = 0.2454
2023-12-28 13:27:49,678 -   best_eval_score = 0.621
2023-12-28 13:27:49,678 -   eval_score = 0.6249
2023-12-28 13:28:14,375 - ***** Epoch: 30: Eval results *****
2023-12-28 13:28:14,375 -   train_loss = 0.2076
2023-12-28 13:28:14,375 -   best_eval_score = 0.6249
2023-12-28 13:28:14,375 -   eval_score = 0.6208
2023-12-28 13:28:14,375 - EarlyStopping counter: 1 out of 8
2023-12-28 13:28:39,516 - ***** Epoch: 31: Eval results *****
2023-12-28 13:28:39,517 -   train_loss = 0.1788
2023-12-28 13:28:39,517 -   best_eval_score = 0.6249
2023-12-28 13:28:39,517 -   eval_score = 0.6495
2023-12-28 13:29:05,211 - ***** Epoch: 32: Eval results *****
2023-12-28 13:29:05,211 -   train_loss = 0.1496
2023-12-28 13:29:05,211 -   best_eval_score = 0.6495
2023-12-28 13:29:05,212 -   eval_score = 0.6504
2023-12-28 13:29:29,844 - ***** Epoch: 33: Eval results *****
2023-12-28 13:29:29,844 -   train_loss = 0.1283
2023-12-28 13:29:29,844 -   best_eval_score = 0.6504
2023-12-28 13:29:29,844 -   eval_score = 0.6634
2023-12-28 13:29:54,626 - ***** Epoch: 34: Eval results *****
2023-12-28 13:29:54,626 -   train_loss = 0.1084
2023-12-28 13:29:54,626 -   best_eval_score = 0.6634
2023-12-28 13:29:54,626 -   eval_score = 0.6621
2023-12-28 13:29:54,626 - EarlyStopping counter: 1 out of 8
2023-12-28 13:30:19,567 - ***** Epoch: 35: Eval results *****
2023-12-28 13:30:19,576 -   train_loss = 0.0928
2023-12-28 13:30:19,576 -   best_eval_score = 0.6634
2023-12-28 13:30:19,576 -   eval_score = 0.6577
2023-12-28 13:30:19,576 - EarlyStopping counter: 2 out of 8
2023-12-28 13:30:43,258 - ***** Epoch: 36: Eval results *****
2023-12-28 13:30:43,267 -   train_loss = 0.0831
2023-12-28 13:30:43,267 -   best_eval_score = 0.6634
2023-12-28 13:30:43,267 -   eval_score = 0.6541
2023-12-28 13:30:43,268 - EarlyStopping counter: 3 out of 8
2023-12-28 13:31:08,854 - ***** Epoch: 37: Eval results *****
2023-12-28 13:31:08,854 -   train_loss = 0.0729
2023-12-28 13:31:08,854 -   best_eval_score = 0.6634
2023-12-28 13:31:08,854 -   eval_score = 0.6609
2023-12-28 13:31:08,854 - EarlyStopping counter: 4 out of 8
2023-12-28 13:31:32,771 - ***** Epoch: 38: Eval results *****
2023-12-28 13:31:32,771 -   train_loss = 0.0628
2023-12-28 13:31:32,771 -   best_eval_score = 0.6634
2023-12-28 13:31:32,771 -   eval_score = 0.6236
2023-12-28 13:31:32,771 - EarlyStopping counter: 5 out of 8
2023-12-28 13:31:56,872 - ***** Epoch: 39: Eval results *****
2023-12-28 13:31:56,873 -   train_loss = 0.0561
2023-12-28 13:31:56,873 -   best_eval_score = 0.6634
2023-12-28 13:31:56,873 -   eval_score = 0.632
2023-12-28 13:31:56,873 - EarlyStopping counter: 6 out of 8
2023-12-28 13:32:21,494 - ***** Epoch: 40: Eval results *****
2023-12-28 13:32:21,494 -   train_loss = 0.048
2023-12-28 13:32:21,494 -   best_eval_score = 0.6634
2023-12-28 13:32:21,494 -   eval_score = 0.6363
2023-12-28 13:32:21,494 - EarlyStopping counter: 7 out of 8
2023-12-28 13:32:46,243 - ***** Epoch: 41: Eval results *****
2023-12-28 13:32:46,243 -   train_loss = 0.0522
2023-12-28 13:32:46,243 -   best_eval_score = 0.6634
2023-12-28 13:32:46,243 -   eval_score = 0.641
2023-12-28 13:32:46,243 - EarlyStopping counter: 8 out of 8
2023-12-28 13:32:46,243 - EarlyStopping at epoch 41
2023-12-28 13:32:46,246 - Training is finished...
2023-12-28 13:32:46,246 - Testing begins...
2023-12-28 13:32:55,908 - ***** Test: Confusion Matrix *****
2023-12-28 13:32:55,910 - [[30  0  0  0  5  1  0  7  3  5  0  0  5  0  0  1  0  0  0  0]
 [ 0 38  0  1  0  1  1  1  0  0  0  0  0  0  0  1  0  0  0  0]
 [ 0  0 27  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0]
 [ 5  0  0  0 13  0  1  0  0  1  0  1  1  0  1  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  0  0  0  0  1  0]
 [ 0  0  0  0  3  0  2  0  5  0  0  1  1  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  6  1  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  2  5  0  0  0  0  0  0  0  1  1  0  0  0]
 [ 1  0  0  0  1  0  0  2  0  3  0  0  0  0  0  2  0  1  0  0]
 [ 1  0  0  0  0  1  1  1  0  2 12  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 16  1  0  0  0  0  0  0  1]
 [ 2  1  0  0  0  0  1  5  4  0  0  0 33  0  3  5  1  0  2  0]
 [ 0  0  0  0  0  0  3  1  0  0  0  1  2 12  4  1  0  0  0  1]
 [ 0  0  0  0  1  0  1  1  0  0  0  0  1  1 15  0  1  0  0  1]
 [ 0  1  0  1  0  0  0  0  3  0  0  0  1  0  2 13  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  3  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0 13  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0 10  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  1  0  0  0  0  8]]
2023-12-28 13:32:55,911 - ***** Evaluation results *****
2023-12-28 13:32:55,911 -   acc = 0.6674
2023-12-28 13:32:55,911 -   f1 = 0.6388
2023-12-28 13:32:55,911 -   prec = 0.6567
2023-12-28 13:32:55,911 -   rec = 0.6467
2023-12-28 13:32:55,911 - Testing is finished...
2023-12-28 13:32:55,911 - Multimodal intent recognition is finished...
2023-12-28 13:32:55,911 - Results are saved in results/msz.csv
