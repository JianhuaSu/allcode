2024-01-02 08:54:21,704 - ============================== Params ==============================
2024-01-02 08:54:21,704 - logger_name: msz_MIntRec_multi-class_seed-4_2024-01-02-08-54-21
2024-01-02 08:54:21,704 - dataset: MIntRec
2024-01-02 08:54:21,704 - data_mode: multi-class
2024-01-02 08:54:21,704 - method: msz
2024-01-02 08:54:21,704 - text_backbone: bert-base-uncased
2024-01-02 08:54:21,704 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-02 08:54:21,704 - seed: 4
2024-01-02 08:54:21,704 - num_workers: 8
2024-01-02 08:54:21,704 - gpu_id: 1
2024-01-02 08:54:21,704 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-02 08:54:21,704 - train: True
2024-01-02 08:54:21,704 - tune: False
2024-01-02 08:54:21,704 - save_model: False
2024-01-02 08:54:21,704 - save_results: True
2024-01-02 08:54:21,704 - log_path: logs
2024-01-02 08:54:21,704 - cache_path: 
2024-01-02 08:54:21,704 - video_data_path: video_data
2024-01-02 08:54:21,704 - audio_data_path: audio_data
2024-01-02 08:54:21,704 - video_feats_path: video_feats.pkl
2024-01-02 08:54:21,704 - audio_feats_path: audio_feats.pkl
2024-01-02 08:54:21,704 - results_path: results
2024-01-02 08:54:21,704 - output_path: /home/sujianhua/Outputs/MIntRec
2024-01-02 08:54:21,704 - model_path: models
2024-01-02 08:54:21,704 - config_file_name: msz
2024-01-02 08:54:21,704 - results_file_name: msz.csv
2024-01-02 08:54:21,704 - padding_mode: zero
2024-01-02 08:54:21,704 - padding_loc: end
2024-01-02 08:54:21,704 - need_aligned: False
2024-01-02 08:54:21,705 - eval_monitor: f1
2024-01-02 08:54:21,705 - train_batch_size: 16
2024-01-02 08:54:21,705 - eval_batch_size: 8
2024-01-02 08:54:21,705 - test_batch_size: 8
2024-01-02 08:54:21,705 - wait_patience: 8
2024-01-02 08:54:21,705 - nheads: 2
2024-01-02 08:54:21,705 - encoder_layers: 2
2024-01-02 08:54:21,705 - attn_dropout: 0.1
2024-01-02 08:54:21,705 - relu_dropout: 0.1
2024-01-02 08:54:21,705 - embed_dropout: 0.1
2024-01-02 08:54:21,705 - res_dropout: 0.1
2024-01-02 08:54:21,705 - attn_mask: False
2024-01-02 08:54:21,705 - hidden_size: 768
2024-01-02 08:54:21,705 - num_attention_heads: 12
2024-01-02 08:54:21,705 - attention_probs_dropout_prob: 0.2
2024-01-02 08:54:21,705 - hidden_dropout_prob: 0.2
2024-01-02 08:54:21,705 - intermediate_size: 768
2024-01-02 08:54:21,705 - num_hidden_layers: 3
2024-01-02 08:54:21,705 - max_position_embeddings: 512
2024-01-02 08:54:21,705 - position_embedding_type: absolute
2024-01-02 08:54:21,705 - batch_first: True
2024-01-02 08:54:21,705 - hidden_dims: 768
2024-01-02 08:54:21,705 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-02 08:54:21,705 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-02 08:54:21,705 - ta_loss: 0.01
2024-01-02 08:54:21,705 - tv_loss: 0.01
2024-01-02 08:54:21,705 - av_loss: 0.01
2024-01-02 08:54:21,705 - aligned_method: conv1d
2024-01-02 08:54:21,705 - grad_clip: 2
2024-01-02 08:54:21,705 - num_train_epochs: 100
2024-01-02 08:54:21,705 - warmup_proportion: 0.1
2024-01-02 08:54:21,705 - lr: 1e-06
2024-01-02 08:54:21,705 - weight_decay: 0.02
2024-01-02 08:54:21,705 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-02-08-54-21
2024-01-02 08:54:21,705 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-02-08-54-21/models
2024-01-02 08:54:21,705 - ============================== End Params ==============================
2024-01-02 08:54:21,719 - Generate Text Features Begin...
2024-01-02 08:54:22,241 - Generate Text Features Finished...
2024-01-02 08:54:22,242 - Load Video Features Begin...
2024-01-02 08:54:23,097 - Load Video Features Finished...
2024-01-02 08:54:23,694 - Load Audio Features Begin...
2024-01-02 08:54:27,513 - Load Audio Features Finished...
2024-01-02 08:54:31,226 - method  begins...
2024-01-02 08:54:33,951 - Multimodal intent recognition begins...
2024-01-02 08:54:33,951 - Training begins...
2024-01-02 08:54:57,991 - ***** Epoch: 1: Eval results *****
2024-01-02 08:54:57,991 -   train_loss = 3.131
2024-01-02 08:54:57,991 -   best_eval_score = 0.0
2024-01-02 08:54:57,992 -   eval_score = 0.025
2024-01-02 08:55:20,492 - ***** Epoch: 2: Eval results *****
2024-01-02 08:55:20,493 -   train_loss = 2.9473
2024-01-02 08:55:20,493 -   best_eval_score = 0.025
2024-01-02 08:55:20,493 -   eval_score = 0.0429
2024-01-02 08:55:43,380 - ***** Epoch: 3: Eval results *****
2024-01-02 08:55:43,380 -   train_loss = 2.7873
2024-01-02 08:55:43,380 -   best_eval_score = 0.0429
2024-01-02 08:55:43,380 -   eval_score = 0.1327
2024-01-02 08:56:05,979 - ***** Epoch: 4: Eval results *****
2024-01-02 08:56:05,979 -   train_loss = 2.5653
2024-01-02 08:56:05,979 -   best_eval_score = 0.1327
2024-01-02 08:56:05,979 -   eval_score = 0.2118
2024-01-02 08:56:28,845 - ***** Epoch: 5: Eval results *****
2024-01-02 08:56:28,845 -   train_loss = 2.2692
2024-01-02 08:56:28,845 -   best_eval_score = 0.2118
2024-01-02 08:56:28,845 -   eval_score = 0.3128
2024-01-02 08:56:51,809 - ***** Epoch: 6: Eval results *****
2024-01-02 08:56:51,809 -   train_loss = 1.9542
2024-01-02 08:56:51,809 -   best_eval_score = 0.3128
2024-01-02 08:56:51,809 -   eval_score = 0.3708
2024-01-02 08:57:14,462 - ***** Epoch: 7: Eval results *****
2024-01-02 08:57:14,462 -   train_loss = 1.6285
2024-01-02 08:57:14,462 -   best_eval_score = 0.3708
2024-01-02 08:57:14,462 -   eval_score = 0.4816
2024-01-02 08:57:37,714 - ***** Epoch: 8: Eval results *****
2024-01-02 08:57:37,714 -   train_loss = 1.3481
2024-01-02 08:57:37,714 -   best_eval_score = 0.4816
2024-01-02 08:57:37,714 -   eval_score = 0.5114
2024-01-02 08:58:00,445 - ***** Epoch: 9: Eval results *****
2024-01-02 08:58:00,446 -   train_loss = 1.0967
2024-01-02 08:58:00,446 -   best_eval_score = 0.5114
2024-01-02 08:58:00,446 -   eval_score = 0.5398
2024-01-02 08:58:23,883 - ***** Epoch: 10: Eval results *****
2024-01-02 08:58:23,883 -   train_loss = 0.8801
2024-01-02 08:58:23,883 -   best_eval_score = 0.5398
2024-01-02 08:58:23,883 -   eval_score = 0.5743
2024-01-02 08:58:46,981 - ***** Epoch: 11: Eval results *****
2024-01-02 08:58:46,981 -   train_loss = 0.7031
2024-01-02 08:58:46,981 -   best_eval_score = 0.5743
2024-01-02 08:58:46,981 -   eval_score = 0.5702
2024-01-02 08:58:46,981 - EarlyStopping counter: 1 out of 8
2024-01-02 08:59:09,492 - ***** Epoch: 12: Eval results *****
2024-01-02 08:59:09,492 -   train_loss = 0.5474
2024-01-02 08:59:09,492 -   best_eval_score = 0.5743
2024-01-02 08:59:09,492 -   eval_score = 0.5991
2024-01-02 08:59:32,460 - ***** Epoch: 13: Eval results *****
2024-01-02 08:59:32,460 -   train_loss = 0.4447
2024-01-02 08:59:32,460 -   best_eval_score = 0.5991
2024-01-02 08:59:32,460 -   eval_score = 0.629
2024-01-02 08:59:56,152 - ***** Epoch: 14: Eval results *****
2024-01-02 08:59:56,153 -   train_loss = 0.3556
2024-01-02 08:59:56,153 -   best_eval_score = 0.629
2024-01-02 08:59:56,153 -   eval_score = 0.626
2024-01-02 08:59:56,153 - EarlyStopping counter: 1 out of 8
2024-01-02 09:00:18,527 - ***** Epoch: 15: Eval results *****
2024-01-02 09:00:18,527 -   train_loss = 0.2993
2024-01-02 09:00:18,527 -   best_eval_score = 0.629
2024-01-02 09:00:18,527 -   eval_score = 0.6594
2024-01-02 09:00:41,442 - ***** Epoch: 16: Eval results *****
2024-01-02 09:00:41,442 -   train_loss = 0.2375
2024-01-02 09:00:41,443 -   best_eval_score = 0.6594
2024-01-02 09:00:41,443 -   eval_score = 0.6424
2024-01-02 09:00:41,443 - EarlyStopping counter: 1 out of 8
2024-01-02 09:01:04,129 - ***** Epoch: 17: Eval results *****
2024-01-02 09:01:04,130 -   train_loss = 0.192
2024-01-02 09:01:04,130 -   best_eval_score = 0.6594
2024-01-02 09:01:04,130 -   eval_score = 0.6265
2024-01-02 09:01:04,130 - EarlyStopping counter: 2 out of 8
2024-01-02 09:01:27,963 - ***** Epoch: 18: Eval results *****
2024-01-02 09:01:27,963 -   train_loss = 0.1593
2024-01-02 09:01:27,963 -   best_eval_score = 0.6594
2024-01-02 09:01:27,963 -   eval_score = 0.655
2024-01-02 09:01:27,963 - EarlyStopping counter: 3 out of 8
2024-01-02 09:01:50,683 - ***** Epoch: 19: Eval results *****
2024-01-02 09:01:50,683 -   train_loss = 0.133
2024-01-02 09:01:50,683 -   best_eval_score = 0.6594
2024-01-02 09:01:50,683 -   eval_score = 0.6563
2024-01-02 09:01:50,683 - EarlyStopping counter: 4 out of 8
2024-01-02 09:02:12,970 - ***** Epoch: 20: Eval results *****
2024-01-02 09:02:12,970 -   train_loss = 0.104
2024-01-02 09:02:12,970 -   best_eval_score = 0.6594
2024-01-02 09:02:12,970 -   eval_score = 0.6637
2024-01-02 09:02:36,037 - ***** Epoch: 21: Eval results *****
2024-01-02 09:02:36,037 -   train_loss = 0.082
2024-01-02 09:02:36,037 -   best_eval_score = 0.6637
2024-01-02 09:02:36,037 -   eval_score = 0.6713
2024-01-02 09:03:00,275 - ***** Epoch: 22: Eval results *****
2024-01-02 09:03:00,276 -   train_loss = 0.0766
2024-01-02 09:03:00,276 -   best_eval_score = 0.6713
2024-01-02 09:03:00,276 -   eval_score = 0.6675
2024-01-02 09:03:00,276 - EarlyStopping counter: 1 out of 8
2024-01-02 09:03:23,414 - ***** Epoch: 23: Eval results *****
2024-01-02 09:03:23,415 -   train_loss = 0.0667
2024-01-02 09:03:23,415 -   best_eval_score = 0.6713
2024-01-02 09:03:23,415 -   eval_score = 0.6621
2024-01-02 09:03:23,415 - EarlyStopping counter: 2 out of 8
2024-01-02 09:03:46,352 - ***** Epoch: 24: Eval results *****
2024-01-02 09:03:46,353 -   train_loss = 0.0572
2024-01-02 09:03:46,353 -   best_eval_score = 0.6713
2024-01-02 09:03:46,353 -   eval_score = 0.6664
2024-01-02 09:03:46,353 - EarlyStopping counter: 3 out of 8
2024-01-02 09:04:09,749 - ***** Epoch: 25: Eval results *****
2024-01-02 09:04:09,749 -   train_loss = 0.0435
2024-01-02 09:04:09,749 -   best_eval_score = 0.6713
2024-01-02 09:04:09,749 -   eval_score = 0.6624
2024-01-02 09:04:09,749 - EarlyStopping counter: 4 out of 8
2024-01-02 09:04:32,282 - ***** Epoch: 26: Eval results *****
2024-01-02 09:04:32,282 -   train_loss = 0.0391
2024-01-02 09:04:32,282 -   best_eval_score = 0.6713
2024-01-02 09:04:32,282 -   eval_score = 0.6684
2024-01-02 09:04:32,282 - EarlyStopping counter: 5 out of 8
2024-01-02 09:04:55,216 - ***** Epoch: 27: Eval results *****
2024-01-02 09:04:55,216 -   train_loss = 0.0325
2024-01-02 09:04:55,216 -   best_eval_score = 0.6713
2024-01-02 09:04:55,216 -   eval_score = 0.6731
2024-01-02 09:05:17,937 - ***** Epoch: 28: Eval results *****
2024-01-02 09:05:17,937 -   train_loss = 0.029
2024-01-02 09:05:17,937 -   best_eval_score = 0.6731
2024-01-02 09:05:17,937 -   eval_score = 0.6654
2024-01-02 09:05:17,937 - EarlyStopping counter: 1 out of 8
2024-01-02 09:05:40,384 - ***** Epoch: 29: Eval results *****
2024-01-02 09:05:40,384 -   train_loss = 0.029
2024-01-02 09:05:40,384 -   best_eval_score = 0.6731
2024-01-02 09:05:40,384 -   eval_score = 0.6542
2024-01-02 09:05:40,384 - EarlyStopping counter: 2 out of 8
2024-01-02 09:06:03,250 - ***** Epoch: 30: Eval results *****
2024-01-02 09:06:03,251 -   train_loss = 0.0267
2024-01-02 09:06:03,251 -   best_eval_score = 0.6731
2024-01-02 09:06:03,251 -   eval_score = 0.6488
2024-01-02 09:06:03,251 - EarlyStopping counter: 3 out of 8
2024-01-02 09:06:25,884 - ***** Epoch: 31: Eval results *****
2024-01-02 09:06:25,884 -   train_loss = 0.0204
2024-01-02 09:06:25,884 -   best_eval_score = 0.6731
2024-01-02 09:06:25,884 -   eval_score = 0.6469
2024-01-02 09:06:25,884 - EarlyStopping counter: 4 out of 8
2024-01-02 09:06:48,366 - ***** Epoch: 32: Eval results *****
2024-01-02 09:06:48,366 -   train_loss = 0.0196
2024-01-02 09:06:48,366 -   best_eval_score = 0.6731
2024-01-02 09:06:48,366 -   eval_score = 0.6424
2024-01-02 09:06:48,366 - EarlyStopping counter: 5 out of 8
2024-01-02 09:07:10,983 - ***** Epoch: 33: Eval results *****
2024-01-02 09:07:10,983 -   train_loss = 0.0213
2024-01-02 09:07:10,983 -   best_eval_score = 0.6731
2024-01-02 09:07:10,983 -   eval_score = 0.6278
2024-01-02 09:07:10,983 - EarlyStopping counter: 6 out of 8
2024-01-02 09:07:33,562 - ***** Epoch: 34: Eval results *****
2024-01-02 09:07:33,562 -   train_loss = 0.019
2024-01-02 09:07:33,562 -   best_eval_score = 0.6731
2024-01-02 09:07:33,562 -   eval_score = 0.6185
2024-01-02 09:07:33,562 - EarlyStopping counter: 7 out of 8
2024-01-02 09:07:55,957 - ***** Epoch: 35: Eval results *****
2024-01-02 09:07:55,957 -   train_loss = 0.0193
2024-01-02 09:07:55,957 -   best_eval_score = 0.6731
2024-01-02 09:07:55,957 -   eval_score = 0.6207
2024-01-02 09:07:55,957 - EarlyStopping counter: 8 out of 8
2024-01-02 09:07:55,957 - EarlyStopping at epoch 35
2024-01-02 09:07:55,959 - Training is finished...
2024-01-02 09:07:55,959 - Testing begins...
2024-01-02 09:07:59,888 - ***** Test: Confusion Matrix *****
2024-01-02 09:07:59,889 - [[26  0  0  0  7  1  8  3  1  5  0  0  5  1  0  0  0  0  0  0]
 [ 0 38  0  1  0  0  0  1  1  1  0  0  0  1  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0 11  0  6  0  0  0  0  1  2  0  1  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  1  0  0  0  0  0]
 [ 2  0  0  0  0  0  4  0  2  0  0  1  2  0  0  1  0  0  0  0]
 [ 3  0  0  0  0  0  0  4  1  1  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  6  0  0  0  0  1  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  1  1  0  3  0  0  0  0  0  3  0  1  0  0]
 [ 2  0  0  0  0  0  0  0  0  2 13  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  1  0]
 [ 3  1  0  0  0  0  1  3  3  0  0  1 36  3  0  2  2  0  1  1]
 [ 1  0  0  0  0  1  1  0  2  0  1  1  1 16  1  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  0  0  0  0  1  3 13  0  1  0  0  3]
 [ 0  0  0  0  0  0  0  1  2  0  0  0  1  0  1 15  1  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  4  0  2  0 10  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  1  0  0  2  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0 10  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  1  1  1  1  0  0  0  0  5]]
2024-01-02 09:07:59,889 - ***** Evaluation results *****
2024-01-02 09:07:59,889 -   acc = 0.6764
2024-01-02 09:07:59,889 -   f1 = 0.6527
2024-01-02 09:07:59,889 -   prec = 0.6571
2024-01-02 09:07:59,889 -   rec = 0.6616
2024-01-02 09:07:59,889 - Testing is finished...
2024-01-02 09:07:59,889 - Multimodal intent recognition is finished...
2024-01-02 09:07:59,889 - Results are saved in results/msz.csv
