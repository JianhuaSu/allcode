2024-01-08 09:04:38,992 - ============================== Params ==============================
2024-01-08 09:04:38,992 - logger_name: msz_MIntRec_multi-class_seed-1_2024-01-08-09-04-38
2024-01-08 09:04:38,992 - dataset: MIntRec
2024-01-08 09:04:38,992 - data_mode: multi-class
2024-01-08 09:04:38,992 - method: msz
2024-01-08 09:04:38,992 - text_backbone: bert-base-uncased
2024-01-08 09:04:38,992 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-08 09:04:38,992 - seed: 1
2024-01-08 09:04:38,992 - num_workers: 8
2024-01-08 09:04:38,992 - gpu_id: 1
2024-01-08 09:04:38,992 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-08 09:04:38,992 - train: True
2024-01-08 09:04:38,992 - tune: False
2024-01-08 09:04:38,992 - save_model: False
2024-01-08 09:04:38,993 - save_results: True
2024-01-08 09:04:38,993 - log_path: logs
2024-01-08 09:04:38,993 - cache_path: 
2024-01-08 09:04:38,993 - video_data_path: video_data
2024-01-08 09:04:38,993 - audio_data_path: audio_data
2024-01-08 09:04:38,993 - video_feats_path: video_feats.pkl
2024-01-08 09:04:38,993 - audio_feats_path: audio_feats.pkl
2024-01-08 09:04:38,993 - results_path: results
2024-01-08 09:04:38,993 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-08 09:04:38,993 - model_path: models
2024-01-08 09:04:38,993 - config_file_name: msz
2024-01-08 09:04:38,993 - results_file_name: msz.csv
2024-01-08 09:04:38,993 - padding_mode: zero
2024-01-08 09:04:38,993 - padding_loc: end
2024-01-08 09:04:38,993 - need_aligned: False
2024-01-08 09:04:38,993 - eval_monitor: f1
2024-01-08 09:04:38,993 - train_batch_size: 16
2024-01-08 09:04:38,993 - eval_batch_size: 8
2024-01-08 09:04:38,993 - test_batch_size: 8
2024-01-08 09:04:38,993 - wait_patience: 8
2024-01-08 09:04:38,993 - nheads: 2
2024-01-08 09:04:38,993 - encoder_layers: 3
2024-01-08 09:04:38,993 - attn_dropout: 0.1
2024-01-08 09:04:38,993 - relu_dropout: 0.1
2024-01-08 09:04:38,993 - embed_dropout: 0.1
2024-01-08 09:04:38,993 - res_dropout: 0.1
2024-01-08 09:04:38,993 - attn_mask: False
2024-01-08 09:04:38,993 - hidden_size: 768
2024-01-08 09:04:38,993 - num_attention_heads: 12
2024-01-08 09:04:38,993 - attention_probs_dropout_prob: 0.2
2024-01-08 09:04:38,993 - hidden_dropout_prob: 0.2
2024-01-08 09:04:38,993 - intermediate_size: 768
2024-01-08 09:04:38,993 - num_hidden_layers: 3
2024-01-08 09:04:38,993 - max_position_embeddings: 512
2024-01-08 09:04:38,993 - position_embedding_type: absolute
2024-01-08 09:04:38,993 - batch_first: True
2024-01-08 09:04:38,993 - hidden_dims: 768
2024-01-08 09:04:38,993 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-08 09:04:38,994 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-08 09:04:38,994 - ta_loss: 0.1
2024-01-08 09:04:38,994 - tv_loss: 0.1
2024-01-08 09:04:38,994 - av_loss: 0.1
2024-01-08 09:04:38,994 - aligned_method: conv1d
2024-01-08 09:04:38,994 - grad_clip: -1
2024-01-08 09:04:38,994 - num_train_epochs: 100
2024-01-08 09:04:38,994 - warmup_proportion: 0.1
2024-01-08 09:04:38,994 - lr: 1e-06
2024-01-08 09:04:38,994 - weight_decay: 0.01
2024-01-08 09:04:38,994 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-08-09-04-38
2024-01-08 09:04:38,994 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-08-09-04-38/models
2024-01-08 09:04:38,994 - ============================== End Params ==============================
2024-01-08 09:04:38,996 - Generate Text Features Begin...
2024-01-08 09:04:39,515 - Generate Text Features Finished...
2024-01-08 09:04:39,516 - Load Video Features Begin...
2024-01-08 09:04:39,887 - Load Video Features Finished...
2024-01-08 09:04:40,550 - Load Audio Features Begin...
2024-01-08 09:04:41,671 - Load Audio Features Finished...
2024-01-08 09:04:45,577 - method  begins...
2024-01-08 09:04:50,195 - Multimodal intent recognition begins...
2024-01-08 09:04:50,195 - Training begins...
2024-01-08 09:05:15,225 - ***** Epoch: 1: Eval results *****
2024-01-08 09:05:15,228 -   train_loss = 2.9728
2024-01-08 09:05:15,228 -   best_eval_score = 0.0
2024-01-08 09:05:15,228 -   eval_score = 0.0114
2024-01-08 09:05:39,272 - ***** Epoch: 2: Eval results *****
2024-01-08 09:05:39,273 -   train_loss = 2.8382
2024-01-08 09:05:39,273 -   best_eval_score = 0.0114
2024-01-08 09:05:39,273 -   eval_score = 0.0202
2024-01-08 09:06:02,569 - ***** Epoch: 3: Eval results *****
2024-01-08 09:06:02,569 -   train_loss = 2.7371
2024-01-08 09:06:02,569 -   best_eval_score = 0.0202
2024-01-08 09:06:02,569 -   eval_score = 0.069
2024-01-08 09:06:25,841 - ***** Epoch: 4: Eval results *****
2024-01-08 09:06:25,841 -   train_loss = 2.52
2024-01-08 09:06:25,841 -   best_eval_score = 0.069
2024-01-08 09:06:25,841 -   eval_score = 0.1269
2024-01-08 09:06:49,758 - ***** Epoch: 5: Eval results *****
2024-01-08 09:06:49,758 -   train_loss = 2.1351
2024-01-08 09:06:49,758 -   best_eval_score = 0.1269
2024-01-08 09:06:49,758 -   eval_score = 0.2338
2024-01-08 09:07:13,867 - ***** Epoch: 6: Eval results *****
2024-01-08 09:07:13,868 -   train_loss = 1.6728
2024-01-08 09:07:13,868 -   best_eval_score = 0.2338
2024-01-08 09:07:13,868 -   eval_score = 0.4025
2024-01-08 09:07:36,716 - ***** Epoch: 7: Eval results *****
2024-01-08 09:07:36,716 -   train_loss = 1.2794
2024-01-08 09:07:36,716 -   best_eval_score = 0.4025
2024-01-08 09:07:36,716 -   eval_score = 0.4746
2024-01-08 09:07:59,345 - ***** Epoch: 8: Eval results *****
2024-01-08 09:07:59,345 -   train_loss = 1.047
2024-01-08 09:07:59,345 -   best_eval_score = 0.4746
2024-01-08 09:07:59,345 -   eval_score = 0.4801
2024-01-08 09:08:22,863 - ***** Epoch: 9: Eval results *****
2024-01-08 09:08:22,863 -   train_loss = 0.8739
2024-01-08 09:08:22,863 -   best_eval_score = 0.4801
2024-01-08 09:08:22,863 -   eval_score = 0.5335
2024-01-08 09:08:45,957 - ***** Epoch: 10: Eval results *****
2024-01-08 09:08:45,958 -   train_loss = 0.7041
2024-01-08 09:08:45,958 -   best_eval_score = 0.5335
2024-01-08 09:08:45,958 -   eval_score = 0.5437
2024-01-08 09:09:08,596 - ***** Epoch: 11: Eval results *****
2024-01-08 09:09:08,596 -   train_loss = 0.5966
2024-01-08 09:09:08,596 -   best_eval_score = 0.5437
2024-01-08 09:09:08,596 -   eval_score = 0.5774
2024-01-08 09:09:32,685 - ***** Epoch: 12: Eval results *****
2024-01-08 09:09:32,685 -   train_loss = 0.486
2024-01-08 09:09:32,685 -   best_eval_score = 0.5774
2024-01-08 09:09:32,685 -   eval_score = 0.546
2024-01-08 09:09:32,685 - EarlyStopping counter: 1 out of 8
2024-01-08 09:09:55,780 - ***** Epoch: 13: Eval results *****
2024-01-08 09:09:55,780 -   train_loss = 0.3382
2024-01-08 09:09:55,780 -   best_eval_score = 0.5774
2024-01-08 09:09:55,780 -   eval_score = 0.5651
2024-01-08 09:09:55,780 - EarlyStopping counter: 2 out of 8
2024-01-08 09:10:17,605 - ***** Epoch: 14: Eval results *****
2024-01-08 09:10:17,606 -   train_loss = 0.3251
2024-01-08 09:10:17,606 -   best_eval_score = 0.5774
2024-01-08 09:10:17,606 -   eval_score = 0.6207
2024-01-08 09:10:40,107 - ***** Epoch: 15: Eval results *****
2024-01-08 09:10:40,107 -   train_loss = 0.2321
2024-01-08 09:10:40,107 -   best_eval_score = 0.6207
2024-01-08 09:10:40,107 -   eval_score = 0.6587
2024-01-08 09:11:02,476 - ***** Epoch: 16: Eval results *****
2024-01-08 09:11:02,477 -   train_loss = 0.1287
2024-01-08 09:11:02,477 -   best_eval_score = 0.6587
2024-01-08 09:11:02,477 -   eval_score = 0.6682
2024-01-08 09:11:26,379 - ***** Epoch: 17: Eval results *****
2024-01-08 09:11:26,379 -   train_loss = 0.1242
2024-01-08 09:11:26,379 -   best_eval_score = 0.6682
2024-01-08 09:11:26,379 -   eval_score = 0.6356
2024-01-08 09:11:26,379 - EarlyStopping counter: 1 out of 8
2024-01-08 09:11:50,407 - ***** Epoch: 18: Eval results *****
2024-01-08 09:11:50,407 -   train_loss = 0.1119
2024-01-08 09:11:50,407 -   best_eval_score = 0.6682
2024-01-08 09:11:50,407 -   eval_score = 0.6488
2024-01-08 09:11:50,407 - EarlyStopping counter: 2 out of 8
2024-01-08 09:12:13,844 - ***** Epoch: 19: Eval results *****
2024-01-08 09:12:13,853 -   train_loss = 0.0817
2024-01-08 09:12:13,853 -   best_eval_score = 0.6682
2024-01-08 09:12:13,853 -   eval_score = 0.6441
2024-01-08 09:12:13,853 - EarlyStopping counter: 3 out of 8
2024-01-08 09:12:38,434 - ***** Epoch: 20: Eval results *****
2024-01-08 09:12:38,434 -   train_loss = 0.0673
2024-01-08 09:12:38,434 -   best_eval_score = 0.6682
2024-01-08 09:12:38,434 -   eval_score = 0.6433
2024-01-08 09:12:38,434 - EarlyStopping counter: 4 out of 8
2024-01-08 09:13:02,804 - ***** Epoch: 21: Eval results *****
2024-01-08 09:13:02,804 -   train_loss = 0.0668
2024-01-08 09:13:02,804 -   best_eval_score = 0.6682
2024-01-08 09:13:02,804 -   eval_score = 0.6459
2024-01-08 09:13:02,804 - EarlyStopping counter: 5 out of 8
2024-01-08 09:13:26,440 - ***** Epoch: 22: Eval results *****
2024-01-08 09:13:26,441 -   train_loss = 0.059
2024-01-08 09:13:26,441 -   best_eval_score = 0.6682
2024-01-08 09:13:26,441 -   eval_score = 0.6416
2024-01-08 09:13:26,441 - EarlyStopping counter: 6 out of 8
2024-01-08 09:13:50,845 - ***** Epoch: 23: Eval results *****
2024-01-08 09:13:50,845 -   train_loss = 0.0525
2024-01-08 09:13:50,845 -   best_eval_score = 0.6682
2024-01-08 09:13:50,845 -   eval_score = 0.6321
2024-01-08 09:13:50,846 - EarlyStopping counter: 7 out of 8
2024-01-08 09:14:13,832 - ***** Epoch: 24: Eval results *****
2024-01-08 09:14:13,833 -   train_loss = 0.0498
2024-01-08 09:14:13,833 -   best_eval_score = 0.6682
2024-01-08 09:14:13,833 -   eval_score = 0.6292
2024-01-08 09:14:13,833 - EarlyStopping counter: 8 out of 8
2024-01-08 09:14:13,833 - EarlyStopping at epoch 24
2024-01-08 09:14:13,836 - Training is finished...
2024-01-08 09:14:13,836 - Testing begins...
2024-01-08 09:14:17,862 - ***** Test: Confusion Matrix *****
2024-01-08 09:14:17,864 - [[32  2  0  0  5  0  5  3  2  4  0  0  4  0  0  0  0  0  0  0]
 [ 1 37  0  0  0  1  1  2  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0 12  0  6  0  1  0  0  1  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  1  0  0  0  0  0]
 [ 0  1  0  0  0  0  5  0  3  0  0  0  2  0  0  0  1  0  0  0]
 [ 2  0  0  0  0  0  1  4  1  2  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  3  5  0  0  0  0  1  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  1  1  0  4  0  0  0  0  0  3  0  0  0  0]
 [ 1  0  0  0  0  0  1  1  2  0 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 18  0  0  0  0  0  0  0  0]
 [ 4  2  0  1  0  0  2  3  3  0  0  0 27  3  8  2  1  0  0  1]
 [ 0  0  0  0  0  0  1  1  2  0  1  1  0 19  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  2  0  1  0  0  0  0  2 15  0  1  0  0  1]
 [ 0  1  0  0  0  0  0  0  3  0  0  0  1  1  1 14  0  0  0  0]
 [ 1  0  0  0  0  0  0  2  1  0  0  0  2  0  2  0  9  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  2  1  0  1  0  1  0  0  9  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  1  2  0  0  1  0  0  7  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  3  0  1  1  0  0  0  0  4]]
2024-01-08 09:14:17,864 - ***** Evaluation results *****
2024-01-08 09:14:17,864 -   acc = 0.6629
2024-01-08 09:14:17,864 -   f1 = 0.6436
2024-01-08 09:14:17,864 -   prec = 0.6821
2024-01-08 09:14:17,864 -   rec = 0.6432
2024-01-08 09:14:17,864 - Testing is finished...
2024-01-08 09:14:17,864 - Multimodal intent recognition is finished...
2024-01-08 09:14:17,864 - Results are saved in results/msz.csv
