2023-12-28 06:28:44,603 - ============================== Params ==============================
2023-12-28 06:28:44,603 - logger_name: msz_MIntRec_multi-class_seed-2_2023-12-28-06-28-44
2023-12-28 06:28:44,603 - dataset: MIntRec
2023-12-28 06:28:44,603 - data_mode: multi-class
2023-12-28 06:28:44,603 - method: msz
2023-12-28 06:28:44,603 - text_backbone: bert-base-uncased
2023-12-28 06:28:44,603 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-28 06:28:44,603 - seed: 2
2023-12-28 06:28:44,603 - num_workers: 8
2023-12-28 06:28:44,603 - gpu_id: 3
2023-12-28 06:28:44,603 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-28 06:28:44,603 - train: True
2023-12-28 06:28:44,603 - tune: False
2023-12-28 06:28:44,603 - save_model: False
2023-12-28 06:28:44,604 - save_results: True
2023-12-28 06:28:44,604 - log_path: logs
2023-12-28 06:28:44,604 - cache_path: 
2023-12-28 06:28:44,604 - video_data_path: video_data
2023-12-28 06:28:44,604 - audio_data_path: audio_data
2023-12-28 06:28:44,604 - video_feats_path: video_feats.pkl
2023-12-28 06:28:44,604 - audio_feats_path: audio_feats.pkl
2023-12-28 06:28:44,604 - results_path: results
2023-12-28 06:28:44,604 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-28 06:28:44,604 - model_path: models
2023-12-28 06:28:44,604 - config_file_name: msz
2023-12-28 06:28:44,604 - results_file_name: msz.csv
2023-12-28 06:28:44,604 - padding_mode: zero
2023-12-28 06:28:44,604 - padding_loc: end
2023-12-28 06:28:44,604 - need_aligned: False
2023-12-28 06:28:44,604 - eval_monitor: f1
2023-12-28 06:28:44,604 - train_batch_size: 16
2023-12-28 06:28:44,604 - eval_batch_size: 8
2023-12-28 06:28:44,604 - test_batch_size: 8
2023-12-28 06:28:44,604 - wait_patience: 8
2023-12-28 06:28:44,604 - nheads: 2
2023-12-28 06:28:44,604 - encoder_layers: 2
2023-12-28 06:28:44,604 - attn_dropout: 0.1
2023-12-28 06:28:44,604 - relu_dropout: 0.1
2023-12-28 06:28:44,604 - embed_dropout: 0.1
2023-12-28 06:28:44,604 - res_dropout: 0.1
2023-12-28 06:28:44,604 - attn_mask: False
2023-12-28 06:28:44,604 - hidden_size: 768
2023-12-28 06:28:44,604 - num_attention_heads: 12
2023-12-28 06:28:44,604 - attention_probs_dropout_prob: 0.2
2023-12-28 06:28:44,604 - hidden_dropout_prob: 0.2
2023-12-28 06:28:44,604 - intermediate_size: 768
2023-12-28 06:28:44,604 - num_hidden_layers: 3
2023-12-28 06:28:44,604 - max_position_embeddings: 512
2023-12-28 06:28:44,604 - position_embedding_type: absolute
2023-12-28 06:28:44,604 - add_cross_attention: False
2023-12-28 06:28:44,604 - batch_first: True
2023-12-28 06:28:44,604 - hidden_dims: 768
2023-12-28 06:28:44,605 - att_dropouts: [0.2, 0.2, 0.2]
2023-12-28 06:28:44,605 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-28 06:28:44,605 - tv_c_loss: 0.01
2023-12-28 06:28:44,605 - vt_c_loss: 0.01
2023-12-28 06:28:44,605 - at_c_loss: 0.01
2023-12-28 06:28:44,605 - aligned_method: conv1d
2023-12-28 06:28:44,605 - grad_clip: 2
2023-12-28 06:28:44,605 - num_train_epochs: 100
2023-12-28 06:28:44,605 - warmup_proportion: 0.1
2023-12-28 06:28:44,605 - lr: 1e-06
2023-12-28 06:28:44,605 - weight_decay: 0.02
2023-12-28 06:28:44,605 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2023-12-28-06-28-44
2023-12-28 06:28:44,605 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2023-12-28-06-28-44/models
2023-12-28 06:28:44,605 - ============================== End Params ==============================
2023-12-28 06:28:44,764 - Generate Text Features Begin...
2023-12-28 06:28:45,469 - Generate Text Features Finished...
2023-12-28 06:28:45,470 - Load Video Features Begin...
2023-12-28 06:29:06,204 - Load Video Features Finished...
2023-12-28 06:29:06,875 - Load Audio Features Begin...
2023-12-28 06:29:49,243 - Load Audio Features Finished...
2023-12-28 06:30:07,549 - method  begins...
2023-12-28 06:30:23,842 - Multimodal intent recognition begins...
2023-12-28 06:30:23,842 - Training begins...
2023-12-28 06:30:55,177 - ***** Epoch: 1: Eval results *****
2023-12-28 06:30:55,178 -   train_loss = 3.6136
2023-12-28 06:30:55,178 -   best_eval_score = 0.0
2023-12-28 06:30:55,179 -   eval_score = 0.0235
2023-12-28 06:31:18,576 - ***** Epoch: 2: Eval results *****
2023-12-28 06:31:18,576 -   train_loss = 3.3728
2023-12-28 06:31:18,576 -   best_eval_score = 0.0235
2023-12-28 06:31:18,577 -   eval_score = 0.0385
2023-12-28 06:31:43,873 - ***** Epoch: 3: Eval results *****
2023-12-28 06:31:43,874 -   train_loss = 3.1701
2023-12-28 06:31:43,874 -   best_eval_score = 0.0385
2023-12-28 06:31:43,874 -   eval_score = 0.0476
2023-12-28 06:32:08,579 - ***** Epoch: 4: Eval results *****
2023-12-28 06:32:08,580 -   train_loss = 2.9653
2023-12-28 06:32:08,580 -   best_eval_score = 0.0476
2023-12-28 06:32:08,580 -   eval_score = 0.1422
2023-12-28 06:32:32,002 - ***** Epoch: 5: Eval results *****
2023-12-28 06:32:32,002 -   train_loss = 2.6926
2023-12-28 06:32:32,002 -   best_eval_score = 0.1422
2023-12-28 06:32:32,002 -   eval_score = 0.2559
2023-12-28 06:32:55,373 - ***** Epoch: 6: Eval results *****
2023-12-28 06:32:55,375 -   train_loss = 2.3466
2023-12-28 06:32:55,375 -   best_eval_score = 0.2559
2023-12-28 06:32:55,375 -   eval_score = 0.4149
2023-12-28 06:33:19,332 - ***** Epoch: 7: Eval results *****
2023-12-28 06:33:19,333 -   train_loss = 1.9781
2023-12-28 06:33:19,333 -   best_eval_score = 0.4149
2023-12-28 06:33:19,333 -   eval_score = 0.468
2023-12-28 06:33:42,187 - ***** Epoch: 8: Eval results *****
2023-12-28 06:33:42,188 -   train_loss = 1.6325
2023-12-28 06:33:42,188 -   best_eval_score = 0.468
2023-12-28 06:33:42,188 -   eval_score = 0.5086
2023-12-28 06:34:05,887 - ***** Epoch: 9: Eval results *****
2023-12-28 06:34:05,887 -   train_loss = 1.3528
2023-12-28 06:34:05,887 -   best_eval_score = 0.5086
2023-12-28 06:34:05,887 -   eval_score = 0.531
2023-12-28 06:34:29,933 - ***** Epoch: 10: Eval results *****
2023-12-28 06:34:29,933 -   train_loss = 1.1196
2023-12-28 06:34:29,933 -   best_eval_score = 0.531
2023-12-28 06:34:29,933 -   eval_score = 0.5776
2023-12-28 06:34:52,918 - ***** Epoch: 11: Eval results *****
2023-12-28 06:34:52,918 -   train_loss = 0.9218
2023-12-28 06:34:52,918 -   best_eval_score = 0.5776
2023-12-28 06:34:52,918 -   eval_score = 0.5801
2023-12-28 06:35:16,015 - ***** Epoch: 12: Eval results *****
2023-12-28 06:35:16,016 -   train_loss = 0.7898
2023-12-28 06:35:16,016 -   best_eval_score = 0.5801
2023-12-28 06:35:16,016 -   eval_score = 0.6129
2023-12-28 06:35:38,268 - ***** Epoch: 13: Eval results *****
2023-12-28 06:35:38,268 -   train_loss = 0.6672
2023-12-28 06:35:38,268 -   best_eval_score = 0.6129
2023-12-28 06:35:38,268 -   eval_score = 0.6137
2023-12-28 06:36:03,211 - ***** Epoch: 14: Eval results *****
2023-12-28 06:36:03,211 -   train_loss = 0.5373
2023-12-28 06:36:03,212 -   best_eval_score = 0.6137
2023-12-28 06:36:03,212 -   eval_score = 0.6187
2023-12-28 06:36:26,481 - ***** Epoch: 15: Eval results *****
2023-12-28 06:36:26,481 -   train_loss = 0.4456
2023-12-28 06:36:26,482 -   best_eval_score = 0.6187
2023-12-28 06:36:26,482 -   eval_score = 0.6388
2023-12-28 06:36:48,798 - ***** Epoch: 16: Eval results *****
2023-12-28 06:36:48,798 -   train_loss = 0.3815
2023-12-28 06:36:48,798 -   best_eval_score = 0.6388
2023-12-28 06:36:48,798 -   eval_score = 0.6554
2023-12-28 06:37:11,714 - ***** Epoch: 17: Eval results *****
2023-12-28 06:37:11,715 -   train_loss = 0.3087
2023-12-28 06:37:11,715 -   best_eval_score = 0.6554
2023-12-28 06:37:11,715 -   eval_score = 0.6414
2023-12-28 06:37:11,715 - EarlyStopping counter: 1 out of 8
2023-12-28 06:37:34,080 - ***** Epoch: 18: Eval results *****
2023-12-28 06:37:34,080 -   train_loss = 0.2591
2023-12-28 06:37:34,080 -   best_eval_score = 0.6554
2023-12-28 06:37:34,080 -   eval_score = 0.655
2023-12-28 06:37:34,080 - EarlyStopping counter: 2 out of 8
2023-12-28 06:37:56,582 - ***** Epoch: 19: Eval results *****
2023-12-28 06:37:56,583 -   train_loss = 0.2145
2023-12-28 06:37:56,583 -   best_eval_score = 0.6554
2023-12-28 06:37:56,583 -   eval_score = 0.6518
2023-12-28 06:37:56,583 - EarlyStopping counter: 3 out of 8
2023-12-28 06:38:34,431 - ***** Epoch: 20: Eval results *****
2023-12-28 06:38:34,432 -   train_loss = 0.1771
2023-12-28 06:38:34,432 -   best_eval_score = 0.6554
2023-12-28 06:38:34,432 -   eval_score = 0.6821
2023-12-28 06:39:01,571 - ***** Epoch: 21: Eval results *****
2023-12-28 06:39:01,572 -   train_loss = 0.1578
2023-12-28 06:39:01,572 -   best_eval_score = 0.6821
2023-12-28 06:39:01,572 -   eval_score = 0.6863
2023-12-28 06:39:31,827 - ***** Epoch: 22: Eval results *****
2023-12-28 06:39:31,828 -   train_loss = 0.1398
2023-12-28 06:39:31,828 -   best_eval_score = 0.6863
2023-12-28 06:39:31,828 -   eval_score = 0.6617
2023-12-28 06:39:31,828 - EarlyStopping counter: 1 out of 8
2023-12-28 06:39:54,840 - ***** Epoch: 23: Eval results *****
2023-12-28 06:39:54,840 -   train_loss = 0.1138
2023-12-28 06:39:54,840 -   best_eval_score = 0.6863
2023-12-28 06:39:54,840 -   eval_score = 0.6702
2023-12-28 06:39:54,840 - EarlyStopping counter: 2 out of 8
2023-12-28 06:40:17,827 - ***** Epoch: 24: Eval results *****
2023-12-28 06:40:17,827 -   train_loss = 0.0946
2023-12-28 06:40:17,827 -   best_eval_score = 0.6863
2023-12-28 06:40:17,827 -   eval_score = 0.6586
2023-12-28 06:40:17,827 - EarlyStopping counter: 3 out of 8
2023-12-28 06:40:39,790 - ***** Epoch: 25: Eval results *****
2023-12-28 06:40:39,791 -   train_loss = 0.0843
2023-12-28 06:40:39,791 -   best_eval_score = 0.6863
2023-12-28 06:40:39,791 -   eval_score = 0.6689
2023-12-28 06:40:39,791 - EarlyStopping counter: 4 out of 8
2023-12-28 06:41:01,348 - ***** Epoch: 26: Eval results *****
2023-12-28 06:41:01,349 -   train_loss = 0.0784
2023-12-28 06:41:01,349 -   best_eval_score = 0.6863
2023-12-28 06:41:01,349 -   eval_score = 0.6545
2023-12-28 06:41:01,349 - EarlyStopping counter: 5 out of 8
2023-12-28 06:41:23,290 - ***** Epoch: 27: Eval results *****
2023-12-28 06:41:23,291 -   train_loss = 0.0713
2023-12-28 06:41:23,291 -   best_eval_score = 0.6863
2023-12-28 06:41:23,291 -   eval_score = 0.6505
2023-12-28 06:41:23,291 - EarlyStopping counter: 6 out of 8
2023-12-28 06:41:45,119 - ***** Epoch: 28: Eval results *****
2023-12-28 06:41:45,128 -   train_loss = 0.0632
2023-12-28 06:41:45,128 -   best_eval_score = 0.6863
2023-12-28 06:41:45,128 -   eval_score = 0.6549
2023-12-28 06:41:45,128 - EarlyStopping counter: 7 out of 8
2023-12-28 06:42:07,847 - ***** Epoch: 29: Eval results *****
2023-12-28 06:42:07,847 -   train_loss = 0.0552
2023-12-28 06:42:07,847 -   best_eval_score = 0.6863
2023-12-28 06:42:07,847 -   eval_score = 0.6547
2023-12-28 06:42:07,847 - EarlyStopping counter: 8 out of 8
2023-12-28 06:42:07,847 - EarlyStopping at epoch 29
2023-12-28 06:42:07,849 - Training is finished...
2023-12-28 06:42:07,850 - Testing begins...
2023-12-28 06:42:13,684 - ***** Test: Confusion Matrix *****
2023-12-28 06:42:13,686 - [[28  1  0  0  6  0  5  0  1  4  0  1  6  2  0  3  0  0  0  0]
 [ 0 37  0  1  0  1  2  0  0  0  0  0  2  0  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 5  0  0  0 10  0  2  0  0  0  0  1  2  2  1  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  1  0  6  0  1  1  0  1  1  0  0  1  0  0  0  0]
 [ 2  0  0  0  0  0  1  4  1  1  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  2  1  4  0  0  0  0  2  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  3  1  0  0  0  0  3  0  2  0  0]
 [ 2  0  0  0  0  0  2  0  0  1 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 16  1  0  0  0  0  0  0  1]
 [ 2  0  0  0  1  0  2  2  2  0  0  0 37  1  5  4  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  1  1 16  3  1  0  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  2 18  0  1  0  0  1]
 [ 0  0  0  0  0  0  1  0  0  0  0  0  3  0  0 16  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  2  0 11  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0 13  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  1  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  1  1  1  0  0  0  0  6]]
2023-12-28 06:42:13,686 - ***** Evaluation results *****
2023-12-28 06:42:13,686 -   acc = 0.6921
2023-12-28 06:42:13,686 -   f1 = 0.6717
2023-12-28 06:42:13,686 -   prec = 0.6876
2023-12-28 06:42:13,686 -   rec = 0.674
2023-12-28 06:42:13,686 - Testing is finished...
2023-12-28 06:42:13,686 - Multimodal intent recognition is finished...
2023-12-28 06:42:13,686 - Results are saved in results/msz.csv
