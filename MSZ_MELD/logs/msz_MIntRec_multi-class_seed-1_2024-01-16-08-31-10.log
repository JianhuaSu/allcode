2024-01-16 08:31:10,352 - ============================== Params ==============================
2024-01-16 08:31:10,352 - logger_name: msz_MIntRec_multi-class_seed-1_2024-01-16-08-31-10
2024-01-16 08:31:10,353 - dataset: MIntRec
2024-01-16 08:31:10,353 - data_mode: multi-class
2024-01-16 08:31:10,353 - method: msz
2024-01-16 08:31:10,353 - text_backbone: bert-base-uncased
2024-01-16 08:31:10,353 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-16 08:31:10,353 - seed: 1
2024-01-16 08:31:10,353 - num_workers: 8
2024-01-16 08:31:10,353 - gpu_id: 1
2024-01-16 08:31:10,353 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-16 08:31:10,353 - train: True
2024-01-16 08:31:10,353 - tune: False
2024-01-16 08:31:10,353 - save_model: False
2024-01-16 08:31:10,353 - save_results: True
2024-01-16 08:31:10,353 - log_path: logs
2024-01-16 08:31:10,353 - cache_path: 
2024-01-16 08:31:10,353 - video_data_path: video_data
2024-01-16 08:31:10,353 - audio_data_path: audio_data
2024-01-16 08:31:10,353 - video_feats_path: video_feats.pkl
2024-01-16 08:31:10,353 - audio_feats_path: audio_feats.pkl
2024-01-16 08:31:10,353 - results_path: results
2024-01-16 08:31:10,353 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-16 08:31:10,353 - model_path: models
2024-01-16 08:31:10,353 - config_file_name: msz
2024-01-16 08:31:10,353 - results_file_name: msz.csv
2024-01-16 08:31:10,353 - padding_mode: zero
2024-01-16 08:31:10,353 - padding_loc: end
2024-01-16 08:31:10,353 - need_aligned: False
2024-01-16 08:31:10,353 - eval_monitor: f1
2024-01-16 08:31:10,353 - train_batch_size: 16
2024-01-16 08:31:10,353 - eval_batch_size: 8
2024-01-16 08:31:10,353 - test_batch_size: 8
2024-01-16 08:31:10,353 - wait_patience: 8
2024-01-16 08:31:10,353 - hidden_size: 768
2024-01-16 08:31:10,353 - num_attention_heads: 12
2024-01-16 08:31:10,353 - attention_probs_dropout_prob: 0.2
2024-01-16 08:31:10,353 - hidden_dropout_prob: 0.2
2024-01-16 08:31:10,353 - intermediate_size: 768
2024-01-16 08:31:10,354 - num_hidden_layers: 8
2024-01-16 08:31:10,354 - max_position_embeddings: 768
2024-01-16 08:31:10,354 - position_embedding_type: absolute
2024-01-16 08:31:10,354 - batch_first: True
2024-01-16 08:31:10,354 - hidden_dims: 768
2024-01-16 08:31:10,354 - dropout: 0.1
2024-01-16 08:31:10,354 - aligned_method: conv1d
2024-01-16 08:31:10,354 - num_train_epochs: 100
2024-01-16 08:31:10,354 - lr: 8e-06
2024-01-16 08:31:10,354 - scale: 32
2024-01-16 08:31:10,354 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-16-08-31-10
2024-01-16 08:31:10,354 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-16-08-31-10/models
2024-01-16 08:31:10,354 - ============================== End Params ==============================
2024-01-16 08:31:10,356 - Generate Text Features Begin...
2024-01-16 08:31:10,785 - Generate Text Features Finished...
2024-01-16 08:31:10,786 - Load Video Features Begin...
2024-01-16 08:31:11,112 - Load Video Features Finished...
2024-01-16 08:31:11,768 - Load Audio Features Begin...
2024-01-16 08:31:13,009 - Load Audio Features Finished...
2024-01-16 08:31:17,284 - method  begins...
2024-01-16 08:31:20,837 - Multimodal intent recognition begins...
2024-01-16 08:31:20,837 - Training begins...
2024-01-16 08:31:43,836 - ***** Epoch: 1: Eval results *****
2024-01-16 08:31:43,837 -   train_loss = 1.8154
2024-01-16 08:31:43,837 -   best_eval_score = 0.0
2024-01-16 08:31:43,837 -   eval_score = 0.579
2024-01-16 08:32:04,695 - ***** Epoch: 2: Eval results *****
2024-01-16 08:32:04,696 -   train_loss = 0.7396
2024-01-16 08:32:04,696 -   best_eval_score = 0.579
2024-01-16 08:32:04,696 -   eval_score = 0.667
2024-01-16 08:32:26,435 - ***** Epoch: 3: Eval results *****
2024-01-16 08:32:26,436 -   train_loss = 0.3364
2024-01-16 08:32:26,436 -   best_eval_score = 0.667
2024-01-16 08:32:26,436 -   eval_score = 0.642
2024-01-16 08:32:26,436 - EarlyStopping counter: 1 out of 8
2024-01-16 08:32:48,282 - ***** Epoch: 4: Eval results *****
2024-01-16 08:32:48,282 -   train_loss = 0.1532
2024-01-16 08:32:48,282 -   best_eval_score = 0.667
2024-01-16 08:32:48,282 -   eval_score = 0.6698
2024-01-16 08:33:08,850 - ***** Epoch: 5: Eval results *****
2024-01-16 08:33:08,850 -   train_loss = 0.0731
2024-01-16 08:33:08,850 -   best_eval_score = 0.6698
2024-01-16 08:33:08,850 -   eval_score = 0.6654
2024-01-16 08:33:08,850 - EarlyStopping counter: 1 out of 8
2024-01-16 08:33:29,922 - ***** Epoch: 6: Eval results *****
2024-01-16 08:33:29,922 -   train_loss = 0.0363
2024-01-16 08:33:29,922 -   best_eval_score = 0.6698
2024-01-16 08:33:29,922 -   eval_score = 0.6853
2024-01-16 08:33:50,909 - ***** Epoch: 7: Eval results *****
2024-01-16 08:33:50,909 -   train_loss = 0.0221
2024-01-16 08:33:50,909 -   best_eval_score = 0.6853
2024-01-16 08:33:50,909 -   eval_score = 0.6728
2024-01-16 08:33:50,910 - EarlyStopping counter: 1 out of 8
2024-01-16 08:34:11,792 - ***** Epoch: 8: Eval results *****
2024-01-16 08:34:11,792 -   train_loss = 0.0156
2024-01-16 08:34:11,792 -   best_eval_score = 0.6853
2024-01-16 08:34:11,792 -   eval_score = 0.6832
2024-01-16 08:34:11,792 - EarlyStopping counter: 2 out of 8
2024-01-16 08:34:32,869 - ***** Epoch: 9: Eval results *****
2024-01-16 08:34:32,869 -   train_loss = 0.0158
2024-01-16 08:34:32,869 -   best_eval_score = 0.6853
2024-01-16 08:34:32,870 -   eval_score = 0.6872
2024-01-16 08:34:53,718 - ***** Epoch: 10: Eval results *****
2024-01-16 08:34:53,718 -   train_loss = 0.0092
2024-01-16 08:34:53,719 -   best_eval_score = 0.6872
2024-01-16 08:34:53,719 -   eval_score = 0.6862
2024-01-16 08:34:53,719 - EarlyStopping counter: 1 out of 8
2024-01-16 08:35:13,994 - ***** Epoch: 11: Eval results *****
2024-01-16 08:35:13,994 -   train_loss = 0.0071
2024-01-16 08:35:13,994 -   best_eval_score = 0.6872
2024-01-16 08:35:13,994 -   eval_score = 0.6926
2024-01-16 08:35:34,001 - ***** Epoch: 12: Eval results *****
2024-01-16 08:35:34,001 -   train_loss = 0.0066
2024-01-16 08:35:34,001 -   best_eval_score = 0.6926
2024-01-16 08:35:34,001 -   eval_score = 0.6882
2024-01-16 08:35:34,001 - EarlyStopping counter: 1 out of 8
2024-01-16 08:35:53,717 - ***** Epoch: 13: Eval results *****
2024-01-16 08:35:53,718 -   train_loss = 0.0052
2024-01-16 08:35:53,718 -   best_eval_score = 0.6926
2024-01-16 08:35:53,718 -   eval_score = 0.688
2024-01-16 08:35:53,718 - EarlyStopping counter: 2 out of 8
2024-01-16 08:36:13,907 - ***** Epoch: 14: Eval results *****
2024-01-16 08:36:13,907 -   train_loss = 0.0052
2024-01-16 08:36:13,908 -   best_eval_score = 0.6926
2024-01-16 08:36:13,908 -   eval_score = 0.6929
2024-01-16 08:36:34,192 - ***** Epoch: 15: Eval results *****
2024-01-16 08:36:34,192 -   train_loss = 0.0053
2024-01-16 08:36:34,192 -   best_eval_score = 0.6929
2024-01-16 08:36:34,192 -   eval_score = 0.6882
2024-01-16 08:36:34,192 - EarlyStopping counter: 1 out of 8
2024-01-16 08:36:54,819 - ***** Epoch: 16: Eval results *****
2024-01-16 08:36:54,819 -   train_loss = 0.0045
2024-01-16 08:36:54,819 -   best_eval_score = 0.6929
2024-01-16 08:36:54,819 -   eval_score = 0.6836
2024-01-16 08:36:54,819 - EarlyStopping counter: 2 out of 8
2024-01-16 08:37:16,710 - ***** Epoch: 17: Eval results *****
2024-01-16 08:37:16,711 -   train_loss = 0.0045
2024-01-16 08:37:16,711 -   best_eval_score = 0.6929
2024-01-16 08:37:16,711 -   eval_score = 0.6954
2024-01-16 08:37:36,793 - ***** Epoch: 18: Eval results *****
2024-01-16 08:37:36,794 -   train_loss = 0.0041
2024-01-16 08:37:36,794 -   best_eval_score = 0.6954
2024-01-16 08:37:36,794 -   eval_score = 0.6904
2024-01-16 08:37:36,794 - EarlyStopping counter: 1 out of 8
2024-01-16 08:37:57,381 - ***** Epoch: 19: Eval results *****
2024-01-16 08:37:57,381 -   train_loss = 0.0064
2024-01-16 08:37:57,381 -   best_eval_score = 0.6954
2024-01-16 08:37:57,381 -   eval_score = 0.6859
2024-01-16 08:37:57,381 - EarlyStopping counter: 2 out of 8
2024-01-16 08:38:17,802 - ***** Epoch: 20: Eval results *****
2024-01-16 08:38:17,803 -   train_loss = 0.0036
2024-01-16 08:38:17,803 -   best_eval_score = 0.6954
2024-01-16 08:38:17,803 -   eval_score = 0.6906
2024-01-16 08:38:17,803 - EarlyStopping counter: 3 out of 8
2024-01-16 08:38:40,067 - ***** Epoch: 21: Eval results *****
2024-01-16 08:38:40,068 -   train_loss = 0.0037
2024-01-16 08:38:40,068 -   best_eval_score = 0.6954
2024-01-16 08:38:40,068 -   eval_score = 0.6892
2024-01-16 08:38:40,068 - EarlyStopping counter: 4 out of 8
2024-01-16 08:39:01,955 - ***** Epoch: 22: Eval results *****
2024-01-16 08:39:01,955 -   train_loss = 0.0036
2024-01-16 08:39:01,955 -   best_eval_score = 0.6954
2024-01-16 08:39:01,955 -   eval_score = 0.7003
2024-01-16 08:39:23,225 - ***** Epoch: 23: Eval results *****
2024-01-16 08:39:23,225 -   train_loss = 0.0034
2024-01-16 08:39:23,225 -   best_eval_score = 0.7003
2024-01-16 08:39:23,225 -   eval_score = 0.7052
2024-01-16 08:39:43,660 - ***** Epoch: 24: Eval results *****
2024-01-16 08:39:43,661 -   train_loss = 0.0033
2024-01-16 08:39:43,661 -   best_eval_score = 0.7052
2024-01-16 08:39:43,661 -   eval_score = 0.7052
2024-01-16 08:39:43,661 - EarlyStopping counter: 1 out of 8
2024-01-16 08:40:05,286 - ***** Epoch: 25: Eval results *****
2024-01-16 08:40:05,286 -   train_loss = 0.0035
2024-01-16 08:40:05,286 -   best_eval_score = 0.7052
2024-01-16 08:40:05,286 -   eval_score = 0.7003
2024-01-16 08:40:05,286 - EarlyStopping counter: 2 out of 8
2024-01-16 08:40:25,899 - ***** Epoch: 26: Eval results *****
2024-01-16 08:40:25,899 -   train_loss = 0.0032
2024-01-16 08:40:25,899 -   best_eval_score = 0.7052
2024-01-16 08:40:25,899 -   eval_score = 0.7003
2024-01-16 08:40:25,899 - EarlyStopping counter: 3 out of 8
2024-01-16 08:40:46,001 - ***** Epoch: 27: Eval results *****
2024-01-16 08:40:46,001 -   train_loss = 0.003
2024-01-16 08:40:46,001 -   best_eval_score = 0.7052
2024-01-16 08:40:46,001 -   eval_score = 0.7003
2024-01-16 08:40:46,001 - EarlyStopping counter: 4 out of 8
2024-01-16 08:41:05,990 - ***** Epoch: 28: Eval results *****
2024-01-16 08:41:05,990 -   train_loss = 0.0029
2024-01-16 08:41:05,991 -   best_eval_score = 0.7052
2024-01-16 08:41:05,991 -   eval_score = 0.7003
2024-01-16 08:41:05,991 - EarlyStopping counter: 5 out of 8
2024-01-16 08:41:26,742 - ***** Epoch: 29: Eval results *****
2024-01-16 08:41:26,743 -   train_loss = 0.003
2024-01-16 08:41:26,743 -   best_eval_score = 0.7052
2024-01-16 08:41:26,743 -   eval_score = 0.7003
2024-01-16 08:41:26,743 - EarlyStopping counter: 6 out of 8
2024-01-16 08:41:48,704 - ***** Epoch: 30: Eval results *****
2024-01-16 08:41:48,705 -   train_loss = 0.0028
2024-01-16 08:41:48,705 -   best_eval_score = 0.7052
2024-01-16 08:41:48,705 -   eval_score = 0.7003
2024-01-16 08:41:48,705 - EarlyStopping counter: 7 out of 8
2024-01-16 08:42:09,174 - ***** Epoch: 31: Eval results *****
2024-01-16 08:42:09,174 -   train_loss = 0.0029
2024-01-16 08:42:09,174 -   best_eval_score = 0.7052
2024-01-16 08:42:09,174 -   eval_score = 0.7003
2024-01-16 08:42:09,174 - EarlyStopping counter: 8 out of 8
2024-01-16 08:42:09,174 - EarlyStopping at epoch 31
2024-01-16 08:42:09,179 - Training is finished...
2024-01-16 08:42:09,179 - Testing begins...
2024-01-16 08:42:12,869 - ***** Test: Confusion Matrix *****
2024-01-16 08:42:12,871 - [[36  3  0  0  9  0  0  0  0  2  1  0  5  1  0  0  0  0  0  0]
 [ 1 35  0  1  0  2  0  0  0  0  0  0  4  0  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 5  0  0  0 12  0  1  0  0  1  0  1  0  0  1  0  0  2  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  2  0  0  2  0  3  0  2  0  0  1  1  0  0  0  0  0  0  0]
 [ 4  0  0  0  0  0  0  5  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  0  0  0  2  4  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  1  0  0  4  0  0  0  0  0  2  0  2  0  0]
 [ 1  0  0  0  0  0  0  0  0  1 14  0  0  0  1  0  1  0  0  0]
 [ 0  0  0  0  1  0  1  0  0  0  0 16  0  0  0  0  0  0  0  1]
 [ 4  2  0  0  1  0  0  0  0  0  0  1 41  3  4  1  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  1  1  0 21  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  2  1 16  0  1  0  0  1]
 [ 0  1  0  0  0  0  0  1  0  0  0  0  6  1  0 12  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  2  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  3  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 1  0  1  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0  0  6]]
2024-01-16 08:42:12,871 - ***** Evaluation results *****
2024-01-16 08:42:12,871 -   acc = 0.7191
2024-01-16 08:42:12,871 -   f1 = 0.699
2024-01-16 08:42:12,871 -   prec = 0.7202
2024-01-16 08:42:12,871 -   rec = 0.6883
2024-01-16 08:42:12,871 - Testing is finished...
2024-01-16 08:42:12,871 - Multimodal intent recognition is finished...
2024-01-16 08:42:12,871 - Results are saved in results/msz.csv
