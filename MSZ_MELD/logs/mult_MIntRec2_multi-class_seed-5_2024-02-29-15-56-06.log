2024-02-29 15:56:06,621 - ============================== Params ==============================
2024-02-29 15:56:06,621 - logger_name: mult_MIntRec2_multi-class_seed-5_2024-02-29-15-56-06
2024-02-29 15:56:06,621 - dataset: MIntRec2
2024-02-29 15:56:06,621 - data_mode: multi-class
2024-02-29 15:56:06,621 - method: mult
2024-02-29 15:56:06,621 - text_backbone: bert-base-uncased
2024-02-29 15:56:06,621 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-02-29 15:56:06,621 - seed: 5
2024-02-29 15:56:06,621 - num_workers: 8
2024-02-29 15:56:06,621 - gpu_id: 2
2024-02-29 15:56:06,622 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-02-29 15:56:06,622 - train: True
2024-02-29 15:56:06,622 - tune: False
2024-02-29 15:56:06,622 - save_model: False
2024-02-29 15:56:06,622 - save_results: True
2024-02-29 15:56:06,622 - log_path: logs
2024-02-29 15:56:06,622 - cache_path: 
2024-02-29 15:56:06,622 - video_data_path: video_data
2024-02-29 15:56:06,622 - audio_data_path: audio_data
2024-02-29 15:56:06,622 - video_feats_path: video_feats.pkl
2024-02-29 15:56:06,622 - audio_feats_path: audio_feats.pkl
2024-02-29 15:56:06,622 - results_path: results
2024-02-29 15:56:06,622 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-02-29 15:56:06,622 - model_path: models
2024-02-29 15:56:06,622 - config_file_name: mult_bert_MIntRec2
2024-02-29 15:56:06,622 - results_file_name: mult_bert.csv
2024-02-29 15:56:06,622 - padding_mode: zero
2024-02-29 15:56:06,622 - padding_loc: end
2024-02-29 15:56:06,622 - need_aligned: False
2024-02-29 15:56:06,622 - eval_monitor: f1
2024-02-29 15:56:06,622 - train_batch_size: 16
2024-02-29 15:56:06,622 - eval_batch_size: 8
2024-02-29 15:56:06,622 - test_batch_size: 8
2024-02-29 15:56:06,622 - wait_patience: 8
2024-02-29 15:56:06,622 - num_train_epochs: 100
2024-02-29 15:56:06,622 - dst_feature_dims: 120
2024-02-29 15:56:06,622 - nheads: 8
2024-02-29 15:56:06,622 - n_levels: 4
2024-02-29 15:56:06,622 - attn_dropout: 0.0
2024-02-29 15:56:06,622 - attn_dropout_v: 0.2
2024-02-29 15:56:06,622 - attn_dropout_a: 0.2
2024-02-29 15:56:06,622 - relu_dropout: 0.0
2024-02-29 15:56:06,622 - embed_dropout: 0.1
2024-02-29 15:56:06,622 - res_dropout: 0.0
2024-02-29 15:56:06,622 - output_dropout: 0.2
2024-02-29 15:56:06,622 - text_dropout: 0.4
2024-02-29 15:56:06,622 - grad_clip: 0.5
2024-02-29 15:56:06,622 - attn_mask: True
2024-02-29 15:56:06,622 - conv1d_kernel_size_l: 5
2024-02-29 15:56:06,622 - conv1d_kernel_size_v: 1
2024-02-29 15:56:06,622 - conv1d_kernel_size_a: 1
2024-02-29 15:56:06,622 - lr: 2e-05
2024-02-29 15:56:06,622 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mult_MIntRec2_multi-class_seed-5_2024-02-29-15-56-06
2024-02-29 15:56:06,622 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mult_MIntRec2_multi-class_seed-5_2024-02-29-15-56-06/models
2024-02-29 15:56:06,622 - ============================== End Params ==============================
2024-02-29 15:56:06,635 - Generate Text Features Begin...
2024-02-29 15:56:08,312 - Generate Text Features Finished...
2024-02-29 15:56:08,314 - Load Video Features Begin...
2024-02-29 15:56:09,521 - Load Video Features Finished...
2024-02-29 15:56:11,229 - Load Audio Features Begin...
2024-02-29 15:56:15,624 - Load Audio Features Finished...
2024-02-29 15:56:27,805 - method  begins...
2024-02-29 15:56:29,963 - Multimodal intent recognition begins...
2024-02-29 15:56:29,963 - Training begins...
2024-02-29 15:58:01,486 - ***** Epoch: 1: Eval results *****
2024-02-29 15:58:01,486 -   best_eval_score = 0.0
2024-02-29 15:58:01,486 -   eval_score = 0.4211
2024-02-29 15:58:01,486 -   train_loss = 2.0553
2024-02-29 15:59:30,972 - ***** Epoch: 2: Eval results *****
2024-02-29 15:59:30,973 -   best_eval_score = 0.4211
2024-02-29 15:59:30,973 -   eval_score = 0.484
2024-02-29 15:59:30,973 -   train_loss = 1.2588
2024-02-29 16:00:59,597 - ***** Epoch: 3: Eval results *****
2024-02-29 16:00:59,598 -   best_eval_score = 0.484
2024-02-29 16:00:59,598 -   eval_score = 0.4916
2024-02-29 16:00:59,598 -   train_loss = 0.836
2024-02-29 16:02:29,074 - ***** Epoch: 4: Eval results *****
2024-02-29 16:02:29,075 -   best_eval_score = 0.4916
2024-02-29 16:02:29,075 -   eval_score = 0.5247
2024-02-29 16:02:29,075 -   train_loss = 0.5093
2024-02-29 16:03:58,688 - ***** Epoch: 5: Eval results *****
2024-02-29 16:03:58,688 -   best_eval_score = 0.5247
2024-02-29 16:03:58,688 -   eval_score = 0.4948
2024-02-29 16:03:58,688 -   train_loss = 0.273
2024-02-29 16:03:58,688 - EarlyStopping counter: 1 out of 8
2024-02-29 16:05:28,200 - ***** Epoch: 6: Eval results *****
2024-02-29 16:05:28,200 -   best_eval_score = 0.5247
2024-02-29 16:05:28,201 -   eval_score = 0.5289
2024-02-29 16:05:28,201 -   train_loss = 0.1767
2024-02-29 16:06:57,670 - ***** Epoch: 7: Eval results *****
2024-02-29 16:06:57,671 -   best_eval_score = 0.5289
2024-02-29 16:06:57,671 -   eval_score = 0.4903
2024-02-29 16:06:57,671 -   train_loss = 0.1339
2024-02-29 16:06:57,671 - EarlyStopping counter: 1 out of 8
2024-02-29 16:08:28,007 - ***** Epoch: 8: Eval results *****
2024-02-29 16:08:28,015 -   best_eval_score = 0.5289
2024-02-29 16:08:28,016 -   eval_score = 0.5252
2024-02-29 16:08:28,016 -   train_loss = 0.1051
2024-02-29 16:08:28,016 - EarlyStopping counter: 2 out of 8
2024-02-29 16:09:57,186 - ***** Epoch: 9: Eval results *****
2024-02-29 16:09:57,186 -   best_eval_score = 0.5289
2024-02-29 16:09:57,186 -   eval_score = 0.5039
2024-02-29 16:09:57,186 -   train_loss = 0.079
2024-02-29 16:09:57,186 - EarlyStopping counter: 3 out of 8
2024-02-29 16:11:27,106 - ***** Epoch: 10: Eval results *****
2024-02-29 16:11:27,106 -   best_eval_score = 0.5289
2024-02-29 16:11:27,106 -   eval_score = 0.5048
2024-02-29 16:11:27,106 -   train_loss = 0.074
2024-02-29 16:11:27,106 - EarlyStopping counter: 4 out of 8
2024-02-29 16:12:56,613 - ***** Epoch: 11: Eval results *****
2024-02-29 16:12:56,614 -   best_eval_score = 0.5289
2024-02-29 16:12:56,614 -   eval_score = 0.4993
2024-02-29 16:12:56,614 -   train_loss = 0.0642
2024-02-29 16:12:56,614 - EarlyStopping counter: 5 out of 8
2024-02-29 16:14:26,331 - ***** Epoch: 12: Eval results *****
2024-02-29 16:14:26,332 -   best_eval_score = 0.5289
2024-02-29 16:14:26,332 -   eval_score = 0.5275
2024-02-29 16:14:26,332 -   train_loss = 0.0433
2024-02-29 16:14:26,332 - EarlyStopping counter: 6 out of 8
2024-02-29 16:15:57,254 - ***** Epoch: 13: Eval results *****
2024-02-29 16:15:57,254 -   best_eval_score = 0.5289
2024-02-29 16:15:57,254 -   eval_score = 0.5319
2024-02-29 16:15:57,255 -   train_loss = 0.0293
2024-02-29 16:17:29,867 - ***** Epoch: 14: Eval results *****
2024-02-29 16:17:29,867 -   best_eval_score = 0.5319
2024-02-29 16:17:29,867 -   eval_score = 0.5323
2024-02-29 16:17:29,867 -   train_loss = 0.0266
2024-02-29 16:19:01,160 - ***** Epoch: 15: Eval results *****
2024-02-29 16:19:01,161 -   best_eval_score = 0.5323
2024-02-29 16:19:01,161 -   eval_score = 0.5295
2024-02-29 16:19:01,161 -   train_loss = 0.0262
2024-02-29 16:19:01,161 - EarlyStopping counter: 1 out of 8
2024-02-29 16:20:30,983 - ***** Epoch: 16: Eval results *****
2024-02-29 16:20:30,983 -   best_eval_score = 0.5323
2024-02-29 16:20:30,983 -   eval_score = 0.5307
2024-02-29 16:20:30,983 -   train_loss = 0.0236
2024-02-29 16:20:30,983 - EarlyStopping counter: 2 out of 8
2024-02-29 16:21:59,267 - ***** Epoch: 17: Eval results *****
2024-02-29 16:21:59,267 -   best_eval_score = 0.5323
2024-02-29 16:21:59,267 -   eval_score = 0.5242
2024-02-29 16:21:59,267 -   train_loss = 0.0219
2024-02-29 16:21:59,267 - EarlyStopping counter: 3 out of 8
2024-02-29 16:23:30,479 - ***** Epoch: 18: Eval results *****
2024-02-29 16:23:30,479 -   best_eval_score = 0.5323
2024-02-29 16:23:30,479 -   eval_score = 0.524
2024-02-29 16:23:30,479 -   train_loss = 0.0213
2024-02-29 16:23:30,479 - EarlyStopping counter: 4 out of 8
2024-02-29 16:24:59,001 - ***** Epoch: 19: Eval results *****
2024-02-29 16:24:59,001 -   best_eval_score = 0.5323
2024-02-29 16:24:59,001 -   eval_score = 0.5257
2024-02-29 16:24:59,001 -   train_loss = 0.022
2024-02-29 16:24:59,001 - EarlyStopping counter: 5 out of 8
2024-02-29 16:26:28,272 - ***** Epoch: 20: Eval results *****
2024-02-29 16:26:28,272 -   best_eval_score = 0.5323
2024-02-29 16:26:28,272 -   eval_score = 0.5289
2024-02-29 16:26:28,273 -   train_loss = 0.0209
2024-02-29 16:26:28,273 - EarlyStopping counter: 6 out of 8
2024-02-29 16:27:58,822 - ***** Epoch: 21: Eval results *****
2024-02-29 16:27:58,823 -   best_eval_score = 0.5323
2024-02-29 16:27:58,823 -   eval_score = 0.5325
2024-02-29 16:27:58,823 -   train_loss = 0.0177
2024-02-29 16:29:27,554 - ***** Epoch: 22: Eval results *****
2024-02-29 16:29:27,554 -   best_eval_score = 0.5325
2024-02-29 16:29:27,554 -   eval_score = 0.5314
2024-02-29 16:29:27,555 -   train_loss = 0.0171
2024-02-29 16:29:27,555 - EarlyStopping counter: 1 out of 8
2024-02-29 16:30:57,182 - ***** Epoch: 23: Eval results *****
2024-02-29 16:30:57,183 -   best_eval_score = 0.5325
2024-02-29 16:30:57,183 -   eval_score = 0.5319
2024-02-29 16:30:57,183 -   train_loss = 0.0181
2024-02-29 16:30:57,183 - EarlyStopping counter: 2 out of 8
2024-02-29 16:32:27,242 - ***** Epoch: 24: Eval results *****
2024-02-29 16:32:27,242 -   best_eval_score = 0.5325
2024-02-29 16:32:27,242 -   eval_score = 0.53
2024-02-29 16:32:27,242 -   train_loss = 0.0173
2024-02-29 16:32:27,243 - EarlyStopping counter: 3 out of 8
2024-02-29 16:33:57,356 - ***** Epoch: 25: Eval results *****
2024-02-29 16:33:57,357 -   best_eval_score = 0.5325
2024-02-29 16:33:57,357 -   eval_score = 0.5293
2024-02-29 16:33:57,357 -   train_loss = 0.0167
2024-02-29 16:33:57,357 - EarlyStopping counter: 4 out of 8
2024-02-29 16:35:26,174 - ***** Epoch: 26: Eval results *****
2024-02-29 16:35:26,174 -   best_eval_score = 0.5325
2024-02-29 16:35:26,174 -   eval_score = 0.5304
2024-02-29 16:35:26,174 -   train_loss = 0.0172
2024-02-29 16:35:26,174 - EarlyStopping counter: 5 out of 8
2024-02-29 16:37:00,907 - ***** Epoch: 27: Eval results *****
2024-02-29 16:37:00,907 -   best_eval_score = 0.5325
2024-02-29 16:37:00,907 -   eval_score = 0.5299
2024-02-29 16:37:00,907 -   train_loss = 0.017
2024-02-29 16:37:00,907 - EarlyStopping counter: 6 out of 8
2024-02-29 16:38:32,846 - ***** Epoch: 28: Eval results *****
2024-02-29 16:38:32,846 -   best_eval_score = 0.5325
2024-02-29 16:38:32,846 -   eval_score = 0.5306
2024-02-29 16:38:32,846 -   train_loss = 0.0168
2024-02-29 16:38:32,846 - EarlyStopping counter: 7 out of 8
2024-02-29 16:40:04,736 - ***** Epoch: 29: Eval results *****
2024-02-29 16:40:04,736 -   best_eval_score = 0.5325
2024-02-29 16:40:04,736 -   eval_score = 0.5305
2024-02-29 16:40:04,736 -   train_loss = 0.016
2024-02-29 16:40:04,736 - EarlyStopping counter: 8 out of 8
2024-02-29 16:40:04,736 - EarlyStopping at epoch 29
2024-02-29 16:40:04,740 - Training is finished...
2024-02-29 16:40:04,741 - Testing begins...
2024-02-29 16:40:20,277 - ***** Test: Confusion Matrix *****
2024-02-29 16:40:20,282 - [[ 41   0  16   0   0   0   0   0   1   0   2   0   0   0   1   1   0   1
    0   0   0   0   2   0   3   0   0   0   0   0]
 [  0  56   0   0  10   3   4   0   1   0   2   1   3   0   3   0   0   7
    1   2   0   0   1   0   1   0   0   2   0   0]
 [  8   0  42   0   1   0   0   0   0   0   1   0   0   0   1   2   0   2
    0   0   0   1   1   2   3   0   0   0   0   0]
 [  0   1   0  62   0   0   0   1   0   0   0   0   0   0   1   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   5   0   0  31   1   0   0   1   0   0   0   0   0   0   0   0   3
    0   1   0   2   0   2   1   0   0   1   1   2]
 [  0   0   0   0   2  24   0   0   0   1   1   0   0   0   2   0   0   3
    0   1   0   0   0   1   0   0   1   0   0   1]
 [  0   1   0   0   0   4  29   4   0   0   1   0   9   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   1   0   0   0   0   3  25   0   0   9   1   5   0   0   0   2   0
    0   0   0   0   0   0   1   0   0   0   0   0]
 [  1   3   1   3   1   1   0   0  23   0   0   2   1   0   1   0   0   6
    0   0   0   1   2   0   2   0   0   1   0   0]
 [  0   1   1   1   1   0   0   0   1  53   0   6   8   1   9   1   0   6
    1   0   0   3   4   1   4   1   1   1   0   2]
 [  1   0   0   0   0   2   1   1   1   1  49   0  29   0   3   0   0   1
    0   2   0   0   0   0   1   0   0   1   0   0]
 [  0   0   0   0   0   0   0   0   1   6   0  17  10   1   1   0   0   1
    1   0   1   0   2   0   0   0   1   5   0   0]
 [  0   0   0   1   1   0   3   7   0   4  23   0  91   0   0   0   1   0
    0   2   0   0   0   0   0   0   0   2   0   0]
 [  0   0   1   0   1   0   0   0   0   2   0   0   0   2   4   1   0   2
    2   0   1   0   1   0   0   0   0   0   0   0]
 [  0   1   1   2   0   0   1   0   3   9   1   2   1   2 124   1   0  23
    2   0   0   0  10   0   3   0   0   6   0   1]
 [  0   0   0   0   0   0   0   0   0   4   0   0   0   0   2   4   0   2
    3   0   0   1   2   1   0   0   0   1   1   1]
 [  0   0   0   0   1   0   0   1   0   0   1   0   2   0   1   0  55   0
    4   0   0   0   0   0   1   0   0   0   0   0]
 [  0   4   2   0   8   1   0   0   3  12   2   3   1   3  18   4   1 117
    6   2   1   2   9   8   0   1   1   4   1   3]
 [  0   1   0   0   1   0   1   0   0   3   1   0   0   2   8   0   3   8
   28   1   2   0   0   0   1   0   0   0   0   0]
 [  0   5   0   0   1   0   1   0   0   0   0   0   1   0   0   0   0   0
    0   7   0   2   0   0   0   0   0   0   0   0]
 [  0   2   1   0   1   0   0   0   0   1   1   0   0   0   4   1   0   3
    5   0   5   0   0   1   0   0   0   2   0   2]
 [  7   1   0   0   0   0   0   0   0   2   0   0   0   0   1   0   4   0
    0   0   0  25   1   5   0   0   2   2   0   3]
 [  0   1   0   1   0   0   0   0   1   2   1   2   1   2   9   1   0   2
    0   0   0   1  83   0   0   1   9   0   0   0]
 [  0   3   1   0   1   0   0   0   0   2   0   0   0   0   2   0   0   6
    1   0   0   4   0  18   0   0   0   0   0   0]
 [  2   0   3   0   0   0   0   0   0   3   2   2   0   0   3   1   0   3
    0   0   0   0   1   1  82   0   0   9   1   0]
 [  1   2   0   0   1   0   0   0   0   1   0   0   0   0   0   0   0   1
    0   0   0   0   2   0   1  19   0   0   0   3]
 [  0   0   0   0   0   0   0   0   0   2   0   0   0   0   2   0   0   4
    0   0   0   1   0   1   0   0   5   0   2   0]
 [  0   2   1   0   0   0   0   1   2   6   2   2   4   0   4   0   0   3
    0   0   2   0   2   0   8   1   0  17   0   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   1   0
    0   0   0   0   0   0   0   0   0   1  55   0]
 [  0   1   0   0   0   0   0   0   1   0   1   1   0   0   0   0   0   4
    0   0   1   1   0   0   1   1   0   1   0   6]]
2024-02-29 16:40:20,282 - ***** Evaluation results *****
2024-02-29 16:40:20,282 -   acc = 0.5878
2024-02-29 16:40:20,282 -   f1 = 0.534
2024-02-29 16:40:20,282 -   prec = 0.5444
2024-02-29 16:40:20,282 -   rec = 0.5307
2024-02-29 16:40:20,283 - Testing is finished...
2024-02-29 16:40:20,283 - Multimodal intent recognition is finished...
2024-02-29 16:40:20,283 - Results are saved in results/mult_bert.csv
