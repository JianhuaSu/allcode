2024-01-03 09:22:47,927 - ============================== Params ==============================
2024-01-03 09:22:47,927 - logger_name: msz_MIntRec_multi-class_seed-0_2024-01-03-09-22-47
2024-01-03 09:22:47,927 - dataset: MIntRec
2024-01-03 09:22:47,927 - data_mode: multi-class
2024-01-03 09:22:47,927 - method: msz
2024-01-03 09:22:47,927 - text_backbone: bert-base-uncased
2024-01-03 09:22:47,927 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-03 09:22:47,927 - seed: 0
2024-01-03 09:22:47,927 - num_workers: 8
2024-01-03 09:22:47,927 - gpu_id: 1
2024-01-03 09:22:47,927 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-03 09:22:47,927 - train: True
2024-01-03 09:22:47,927 - tune: False
2024-01-03 09:22:47,927 - save_model: False
2024-01-03 09:22:47,927 - save_results: True
2024-01-03 09:22:47,927 - log_path: logs
2024-01-03 09:22:47,927 - cache_path: 
2024-01-03 09:22:47,927 - video_data_path: video_data
2024-01-03 09:22:47,927 - audio_data_path: audio_data
2024-01-03 09:22:47,927 - video_feats_path: video_feats.pkl
2024-01-03 09:22:47,927 - audio_feats_path: audio_feats.pkl
2024-01-03 09:22:47,927 - results_path: results
2024-01-03 09:22:47,927 - output_path: /home/sujianhua/Outputs/MIntRec
2024-01-03 09:22:47,927 - model_path: models
2024-01-03 09:22:47,927 - config_file_name: msz
2024-01-03 09:22:47,927 - results_file_name: msz.csv
2024-01-03 09:22:47,927 - padding_mode: zero
2024-01-03 09:22:47,927 - padding_loc: end
2024-01-03 09:22:47,927 - need_aligned: False
2024-01-03 09:22:47,927 - eval_monitor: f1
2024-01-03 09:22:47,927 - train_batch_size: 16
2024-01-03 09:22:47,927 - eval_batch_size: 8
2024-01-03 09:22:47,927 - test_batch_size: 8
2024-01-03 09:22:47,927 - wait_patience: 8
2024-01-03 09:22:47,927 - nheads: 2
2024-01-03 09:22:47,927 - encoder_layers: 2
2024-01-03 09:22:47,927 - attn_dropout: 0.1
2024-01-03 09:22:47,927 - relu_dropout: 0.1
2024-01-03 09:22:47,927 - embed_dropout: 0.1
2024-01-03 09:22:47,927 - res_dropout: 0.1
2024-01-03 09:22:47,927 - attn_mask: False
2024-01-03 09:22:47,928 - hidden_size: 768
2024-01-03 09:22:47,928 - num_attention_heads: 12
2024-01-03 09:22:47,928 - attention_probs_dropout_prob: 0.2
2024-01-03 09:22:47,928 - hidden_dropout_prob: 0.2
2024-01-03 09:22:47,928 - intermediate_size: 768
2024-01-03 09:22:47,928 - num_hidden_layers: 3
2024-01-03 09:22:47,928 - max_position_embeddings: 512
2024-01-03 09:22:47,928 - position_embedding_type: absolute
2024-01-03 09:22:47,928 - batch_first: True
2024-01-03 09:22:47,928 - hidden_dims: 768
2024-01-03 09:22:47,928 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-03 09:22:47,928 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-03 09:22:47,928 - ta_loss: 0.02
2024-01-03 09:22:47,928 - tv_loss: 0.01
2024-01-03 09:22:47,928 - av_loss: 0.01
2024-01-03 09:22:47,928 - aligned_method: conv1d
2024-01-03 09:22:47,928 - grad_clip: -1
2024-01-03 09:22:47,928 - num_train_epochs: 100
2024-01-03 09:22:47,928 - warmup_proportion: 0.1
2024-01-03 09:22:47,928 - lr: 3e-06
2024-01-03 09:22:47,928 - weight_decay: 0.02
2024-01-03 09:22:47,928 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-0_2024-01-03-09-22-47
2024-01-03 09:22:47,928 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-0_2024-01-03-09-22-47/models
2024-01-03 09:22:47,928 - ============================== End Params ==============================
2024-01-03 09:22:47,930 - Generate Text Features Begin...
2024-01-03 09:22:48,344 - Generate Text Features Finished...
2024-01-03 09:22:48,345 - Load Video Features Begin...
2024-01-03 09:22:48,628 - Load Video Features Finished...
2024-01-03 09:22:49,430 - Load Audio Features Begin...
2024-01-03 09:25:32,196 - Load Audio Features Finished...
2024-01-03 09:25:36,501 - method  begins...
2024-01-03 09:25:54,758 - Multimodal intent recognition begins...
2024-01-03 09:25:54,759 - Training begins...
2024-01-03 09:26:21,530 - ***** Epoch: 1: Eval results *****
2024-01-03 09:26:21,530 -   train_loss = 3.4
2024-01-03 09:26:21,530 -   best_eval_score = 0.0
2024-01-03 09:26:21,530 -   eval_score = 0.0334
2024-01-03 09:26:45,846 - ***** Epoch: 2: Eval results *****
2024-01-03 09:26:45,846 -   train_loss = 3.0332
2024-01-03 09:26:45,846 -   best_eval_score = 0.0334
2024-01-03 09:26:45,846 -   eval_score = 0.1032
2024-01-03 09:27:10,127 - ***** Epoch: 3: Eval results *****
2024-01-03 09:27:10,128 -   train_loss = 2.6957
2024-01-03 09:27:10,128 -   best_eval_score = 0.1032
2024-01-03 09:27:10,128 -   eval_score = 0.1948
2024-01-03 09:27:34,795 - ***** Epoch: 4: Eval results *****
2024-01-03 09:27:34,795 -   train_loss = 2.1952
2024-01-03 09:27:34,795 -   best_eval_score = 0.1948
2024-01-03 09:27:34,795 -   eval_score = 0.3688
2024-01-03 09:28:02,378 - ***** Epoch: 5: Eval results *****
2024-01-03 09:28:02,378 -   train_loss = 1.7999
2024-01-03 09:28:02,378 -   best_eval_score = 0.3688
2024-01-03 09:28:02,378 -   eval_score = 0.4008
2024-01-03 09:28:28,385 - ***** Epoch: 6: Eval results *****
2024-01-03 09:28:28,386 -   train_loss = 1.4551
2024-01-03 09:28:28,386 -   best_eval_score = 0.4008
2024-01-03 09:28:28,386 -   eval_score = 0.4886
2024-01-03 09:28:53,607 - ***** Epoch: 7: Eval results *****
2024-01-03 09:28:53,608 -   train_loss = 1.1685
2024-01-03 09:28:53,608 -   best_eval_score = 0.4886
2024-01-03 09:28:53,608 -   eval_score = 0.465
2024-01-03 09:28:53,608 - EarlyStopping counter: 1 out of 8
2024-01-03 09:29:18,971 - ***** Epoch: 8: Eval results *****
2024-01-03 09:29:18,971 -   train_loss = 0.96
2024-01-03 09:29:18,971 -   best_eval_score = 0.4886
2024-01-03 09:29:18,971 -   eval_score = 0.5754
2024-01-03 09:29:43,185 - ***** Epoch: 9: Eval results *****
2024-01-03 09:29:43,185 -   train_loss = 0.8874
2024-01-03 09:29:43,185 -   best_eval_score = 0.5754
2024-01-03 09:29:43,185 -   eval_score = 0.4901
2024-01-03 09:29:43,185 - EarlyStopping counter: 1 out of 8
2024-01-03 09:30:07,838 - ***** Epoch: 10: Eval results *****
2024-01-03 09:30:07,838 -   train_loss = 1.006
2024-01-03 09:30:07,838 -   best_eval_score = 0.5754
2024-01-03 09:30:07,838 -   eval_score = 0.5197
2024-01-03 09:30:07,838 - EarlyStopping counter: 2 out of 8
2024-01-03 09:30:33,600 - ***** Epoch: 11: Eval results *****
2024-01-03 09:30:33,609 -   train_loss = 0.8026
2024-01-03 09:30:33,609 -   best_eval_score = 0.5754
2024-01-03 09:30:33,609 -   eval_score = 0.5469
2024-01-03 09:30:33,609 - EarlyStopping counter: 3 out of 8
2024-01-03 09:30:58,911 - ***** Epoch: 12: Eval results *****
2024-01-03 09:30:58,911 -   train_loss = 0.6465
2024-01-03 09:30:58,911 -   best_eval_score = 0.5754
2024-01-03 09:30:58,911 -   eval_score = 0.5518
2024-01-03 09:30:58,912 - EarlyStopping counter: 4 out of 8
2024-01-03 09:31:24,275 - ***** Epoch: 13: Eval results *****
2024-01-03 09:31:24,275 -   train_loss = 0.4541
2024-01-03 09:31:24,275 -   best_eval_score = 0.5754
2024-01-03 09:31:24,275 -   eval_score = 0.5876
2024-01-03 09:31:48,228 - ***** Epoch: 14: Eval results *****
2024-01-03 09:31:48,228 -   train_loss = 0.4743
2024-01-03 09:31:48,228 -   best_eval_score = 0.5876
2024-01-03 09:31:48,228 -   eval_score = 0.5942
2024-01-03 09:32:12,261 - ***** Epoch: 15: Eval results *****
2024-01-03 09:32:12,261 -   train_loss = 0.3799
2024-01-03 09:32:12,262 -   best_eval_score = 0.5942
2024-01-03 09:32:12,262 -   eval_score = 0.6053
2024-01-03 09:32:36,915 - ***** Epoch: 16: Eval results *****
2024-01-03 09:32:36,915 -   train_loss = 0.3336
2024-01-03 09:32:36,916 -   best_eval_score = 0.6053
2024-01-03 09:32:36,916 -   eval_score = 0.5952
2024-01-03 09:32:36,916 - EarlyStopping counter: 1 out of 8
2024-01-03 09:33:01,981 - ***** Epoch: 17: Eval results *****
2024-01-03 09:33:01,982 -   train_loss = 0.4363
2024-01-03 09:33:01,982 -   best_eval_score = 0.6053
2024-01-03 09:33:01,982 -   eval_score = 0.5727
2024-01-03 09:33:01,982 - EarlyStopping counter: 2 out of 8
2024-01-03 09:33:27,632 - ***** Epoch: 18: Eval results *****
2024-01-03 09:33:27,633 -   train_loss = 0.4072
2024-01-03 09:33:27,633 -   best_eval_score = 0.6053
2024-01-03 09:33:27,633 -   eval_score = 0.599
2024-01-03 09:33:27,633 - EarlyStopping counter: 3 out of 8
2024-01-03 09:33:54,620 - ***** Epoch: 19: Eval results *****
2024-01-03 09:33:54,620 -   train_loss = 0.3758
2024-01-03 09:33:54,620 -   best_eval_score = 0.6053
2024-01-03 09:33:54,620 -   eval_score = 0.6055
2024-01-03 09:34:19,941 - ***** Epoch: 20: Eval results *****
2024-01-03 09:34:19,942 -   train_loss = 0.3281
2024-01-03 09:34:19,942 -   best_eval_score = 0.6055
2024-01-03 09:34:19,942 -   eval_score = 0.6074
2024-01-03 09:34:45,227 - ***** Epoch: 21: Eval results *****
2024-01-03 09:34:45,228 -   train_loss = 0.3175
2024-01-03 09:34:45,228 -   best_eval_score = 0.6074
2024-01-03 09:34:45,228 -   eval_score = 0.597
2024-01-03 09:34:45,228 - EarlyStopping counter: 1 out of 8
2024-01-03 09:35:10,359 - ***** Epoch: 22: Eval results *****
2024-01-03 09:35:10,359 -   train_loss = 0.3275
2024-01-03 09:35:10,359 -   best_eval_score = 0.6074
2024-01-03 09:35:10,359 -   eval_score = 0.5749
2024-01-03 09:35:10,360 - EarlyStopping counter: 2 out of 8
2024-01-03 09:35:35,903 - ***** Epoch: 23: Eval results *****
2024-01-03 09:35:35,903 -   train_loss = 0.1872
2024-01-03 09:35:35,903 -   best_eval_score = 0.6074
2024-01-03 09:35:35,903 -   eval_score = 0.5702
2024-01-03 09:35:35,903 - EarlyStopping counter: 3 out of 8
2024-01-03 09:36:03,506 - ***** Epoch: 24: Eval results *****
2024-01-03 09:36:03,507 -   train_loss = 0.2239
2024-01-03 09:36:03,507 -   best_eval_score = 0.6074
2024-01-03 09:36:03,507 -   eval_score = 0.575
2024-01-03 09:36:03,507 - EarlyStopping counter: 4 out of 8
2024-01-03 09:36:36,412 - ***** Epoch: 25: Eval results *****
2024-01-03 09:36:36,413 -   train_loss = 0.2469
2024-01-03 09:36:36,413 -   best_eval_score = 0.6074
2024-01-03 09:36:36,413 -   eval_score = 0.5696
2024-01-03 09:36:36,413 - EarlyStopping counter: 5 out of 8
2024-01-03 09:37:02,792 - ***** Epoch: 26: Eval results *****
2024-01-03 09:37:02,792 -   train_loss = 0.2824
2024-01-03 09:37:02,792 -   best_eval_score = 0.6074
2024-01-03 09:37:02,792 -   eval_score = 0.5172
2024-01-03 09:37:02,792 - EarlyStopping counter: 6 out of 8
2024-01-03 09:37:27,566 - ***** Epoch: 27: Eval results *****
2024-01-03 09:37:27,566 -   train_loss = 0.35
2024-01-03 09:37:27,566 -   best_eval_score = 0.6074
2024-01-03 09:37:27,566 -   eval_score = 0.5277
2024-01-03 09:37:27,566 - EarlyStopping counter: 7 out of 8
2024-01-03 09:37:52,950 - ***** Epoch: 28: Eval results *****
2024-01-03 09:37:52,951 -   train_loss = 0.4427
2024-01-03 09:37:52,951 -   best_eval_score = 0.6074
2024-01-03 09:37:52,951 -   eval_score = 0.5211
2024-01-03 09:37:52,951 - EarlyStopping counter: 8 out of 8
2024-01-03 09:37:52,951 - EarlyStopping at epoch 28
2024-01-03 09:37:52,953 - Training is finished...
2024-01-03 09:37:52,954 - Testing begins...
2024-01-03 09:37:57,703 - ***** Test: Confusion Matrix *****
2024-01-03 09:37:57,705 - [[33  1  0  0  4  0  3  0  3  2  0  0  8  2  0  1  0  0  0  0]
 [ 1 37  0  0  1  0  1  0  1  0  0  1  1  0  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  0  0  0  9  0  8  0  1  0  0  1  0  2  0  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 3  0  0  0  1  0  3  0  4  0  1  0  0  0  0  0  0  0  0  0]
 [ 4  0  0  0  0  0  0  3  2  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  2  0  0  0  0  2  0  1  0  0  0  0]
 [ 1  1  0  0  0  0  1  0  0  3  0  0  0  1  0  3  0  0  0  0]
 [ 2  0  0  0  0  0  2  1  0  2 11  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0  1]
 [ 3  1  0  0  0  1  1  1  8  0  0  1 36  3  1  0  1  0  0  0]
 [ 1  0  0  0  0  0  3  0  1  0  1  1  2 14  0  1  0  1  0  0]
 [ 0  0  0  0  1  0  1  1  0  0  0  0  3  3 11  0  1  0  0  1]
 [ 0  1  0  1  0  0  0  1  1  0  0  0  5  0  1 11  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  3  0  1  0 10  0  0  2]
 [ 1  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0 12  0  0]
 [ 0  0  0  0  0  1  0  0  0  0  0  0  3  0  0  1  0  0  7  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  1  1  1  0  0  0  0  6]]
2024-01-03 09:37:57,705 - ***** Evaluation results *****
2024-01-03 09:37:57,705 -   acc = 0.6472
2024-01-03 09:37:57,705 -   f1 = 0.6196
2024-01-03 09:37:57,705 -   prec = 0.6543
2024-01-03 09:37:57,705 -   rec = 0.6053
2024-01-03 09:37:57,705 - Testing is finished...
2024-01-03 09:37:57,705 - Multimodal intent recognition is finished...
2024-01-03 09:37:57,705 - Results are saved in results/msz.csv
