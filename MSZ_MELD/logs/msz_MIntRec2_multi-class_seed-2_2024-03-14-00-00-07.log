2024-03-14 00:00:07,325 - ============================== Params ==============================
2024-03-14 00:00:07,326 - logger_name: msz_MIntRec2_multi-class_seed-2_2024-03-14-00-00-07
2024-03-14 00:00:07,326 - dataset: MIntRec2
2024-03-14 00:00:07,326 - data_mode: multi-class
2024-03-14 00:00:07,326 - method: msz
2024-03-14 00:00:07,326 - text_backbone: bert-base-uncased
2024-03-14 00:00:07,326 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-14 00:00:07,326 - seed: 2
2024-03-14 00:00:07,326 - num_workers: 8
2024-03-14 00:00:07,326 - gpu_id: 3
2024-03-14 00:00:07,326 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-14 00:00:07,326 - train: True
2024-03-14 00:00:07,326 - tune: True
2024-03-14 00:00:07,326 - save_model: False
2024-03-14 00:00:07,326 - save_results: True
2024-03-14 00:00:07,326 - log_path: logs
2024-03-14 00:00:07,326 - cache_path: 
2024-03-14 00:00:07,326 - video_data_path: video_data
2024-03-14 00:00:07,326 - audio_data_path: audio_data
2024-03-14 00:00:07,326 - video_feats_path: video_feats.pkl
2024-03-14 00:00:07,326 - audio_feats_path: audio_feats.pkl
2024-03-14 00:00:07,326 - results_path: results
2024-03-14 00:00:07,326 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-14 00:00:07,326 - model_path: models
2024-03-14 00:00:07,326 - config_file_name: msz_MIntRec2
2024-03-14 00:00:07,326 - results_file_name: msz.csv
2024-03-14 00:00:07,326 - padding_mode: zero
2024-03-14 00:00:07,327 - padding_loc: end
2024-03-14 00:00:07,327 - need_aligned: False
2024-03-14 00:00:07,327 - eval_monitor: f1
2024-03-14 00:00:07,327 - train_batch_size: 32
2024-03-14 00:00:07,327 - eval_batch_size: 16
2024-03-14 00:00:07,327 - test_batch_size: 16
2024-03-14 00:00:07,327 - wait_patience: 8
2024-03-14 00:00:07,327 - hidden_dims: 768
2024-03-14 00:00:07,327 - num_attention_heads: 6
2024-03-14 00:00:07,327 - attention_probs_dropout_prob: 0.5
2024-03-14 00:00:07,327 - hidden_dropout_prob: 0.5
2024-03-14 00:00:07,327 - intermediate_size: 768
2024-03-14 00:00:07,327 - num_hidden_layers: 4
2024-03-14 00:00:07,327 - max_position_embeddings: 1000
2024-03-14 00:00:07,327 - position_embedding_type: absolute
2024-03-14 00:00:07,327 - batch_first: True
2024-03-14 00:00:07,327 - dropout: 0.5
2024-03-14 00:00:07,327 - aligned_method: conv1d
2024-03-14 00:00:07,327 - num_train_epochs: 100
2024-03-14 00:00:07,327 - lr: 4e-06
2024-03-14 00:00:07,327 - lr_mode: min
2024-03-14 00:00:07,327 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-2_2024-03-14-00-00-07
2024-03-14 00:00:07,327 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/msz_MIntRec2_multi-class_seed-2_2024-03-14-00-00-07/models
2024-03-14 00:00:07,327 - num_labels: 30
2024-03-14 00:00:07,327 - text_feat_dim: 768
2024-03-14 00:00:07,327 - video_feat_dim: 256
2024-03-14 00:00:07,327 - audio_feat_dim: 768
2024-03-14 00:00:07,327 - text_seq_len: 50
2024-03-14 00:00:07,327 - video_seq_len: 180
2024-03-14 00:00:07,327 - audio_seq_len: 400
2024-03-14 00:00:07,327 - device: cuda:3
2024-03-14 00:00:07,327 - ============================== End Params ==============================
2024-03-14 00:00:07,342 - Generate Text Features Begin...
2024-03-14 00:00:09,253 - Generate Text Features Finished...
2024-03-14 00:00:09,255 - Load Video Features Begin...
2024-03-14 00:00:10,352 - Load Video Features Finished...
2024-03-14 00:00:12,072 - Load Audio Features Begin...
2024-03-14 00:00:16,237 - Load Audio Features Finished...
2024-03-14 00:00:28,601 - method  begins...
2024-03-14 00:00:30,360 - Multimodal intent recognition begins...
2024-03-14 00:00:30,360 - Training begins...
2024-03-14 00:01:32,413 - ***** Epoch: 1: Eval results *****
2024-03-14 00:01:32,414 -   train_loss = 3.0836
2024-03-14 00:01:32,414 -   best_eval_score = 0.0
2024-03-14 00:01:32,415 -   eval_score = 0.1733
2024-03-14 00:02:33,572 - ***** Epoch: 2: Eval results *****
2024-03-14 00:02:33,573 -   train_loss = 2.2865
2024-03-14 00:02:33,573 -   best_eval_score = 0.1733
2024-03-14 00:02:33,573 -   eval_score = 0.2891
2024-03-14 00:03:32,858 - ***** Epoch: 3: Eval results *****
2024-03-14 00:03:32,858 -   train_loss = 1.7596
2024-03-14 00:03:32,858 -   best_eval_score = 0.2891
2024-03-14 00:03:32,858 -   eval_score = 0.3804
2024-03-14 00:04:33,624 - ***** Epoch: 4: Eval results *****
2024-03-14 00:04:33,624 -   train_loss = 1.4689
2024-03-14 00:04:33,625 -   best_eval_score = 0.3804
2024-03-14 00:04:33,625 -   eval_score = 0.4139
2024-03-14 00:05:33,029 - ***** Epoch: 5: Eval results *****
2024-03-14 00:05:33,029 -   train_loss = 1.2991
2024-03-14 00:05:33,029 -   best_eval_score = 0.4139
2024-03-14 00:05:33,029 -   eval_score = 0.4385
2024-03-14 00:06:31,848 - ***** Epoch: 6: Eval results *****
2024-03-14 00:06:31,848 -   train_loss = 1.1451
2024-03-14 00:06:31,849 -   best_eval_score = 0.4385
2024-03-14 00:06:31,849 -   eval_score = 0.4611
2024-03-14 00:07:30,440 - ***** Epoch: 7: Eval results *****
2024-03-14 00:07:30,440 -   train_loss = 1.0253
2024-03-14 00:07:30,440 -   best_eval_score = 0.4611
2024-03-14 00:07:30,440 -   eval_score = 0.4726
2024-03-14 00:08:29,414 - ***** Epoch: 8: Eval results *****
2024-03-14 00:08:29,414 -   train_loss = 0.9089
2024-03-14 00:08:29,415 -   best_eval_score = 0.4726
2024-03-14 00:08:29,415 -   eval_score = 0.4744
2024-03-14 00:09:28,468 - ***** Epoch: 9: Eval results *****
2024-03-14 00:09:28,468 -   train_loss = 0.8036
2024-03-14 00:09:28,468 -   best_eval_score = 0.4744
2024-03-14 00:09:28,468 -   eval_score = 0.4836
2024-03-14 00:10:28,461 - ***** Epoch: 10: Eval results *****
2024-03-14 00:10:28,462 -   train_loss = 0.7042
2024-03-14 00:10:28,462 -   best_eval_score = 0.4836
2024-03-14 00:10:28,462 -   eval_score = 0.4941
2024-03-14 00:11:29,134 - ***** Epoch: 11: Eval results *****
2024-03-14 00:11:29,135 -   train_loss = 0.6137
2024-03-14 00:11:29,135 -   best_eval_score = 0.4941
2024-03-14 00:11:29,135 -   eval_score = 0.4955
2024-03-14 00:12:30,137 - ***** Epoch: 12: Eval results *****
2024-03-14 00:12:30,137 -   train_loss = 0.583
2024-03-14 00:12:30,137 -   best_eval_score = 0.4955
2024-03-14 00:12:30,137 -   eval_score = 0.4957
2024-03-14 00:13:30,117 - ***** Epoch: 13: Eval results *****
2024-03-14 00:13:30,117 -   train_loss = 0.5795
2024-03-14 00:13:30,117 -   best_eval_score = 0.4957
2024-03-14 00:13:30,117 -   eval_score = 0.4956
2024-03-14 00:13:30,117 - EarlyStopping counter: 1 out of 8
2024-03-14 00:14:30,099 - ***** Epoch: 14: Eval results *****
2024-03-14 00:14:30,099 -   train_loss = 0.568
2024-03-14 00:14:30,099 -   best_eval_score = 0.4957
2024-03-14 00:14:30,099 -   eval_score = 0.4948
2024-03-14 00:14:30,100 - EarlyStopping counter: 2 out of 8
2024-03-14 00:15:29,430 - ***** Epoch: 15: Eval results *****
2024-03-14 00:15:29,430 -   train_loss = 0.5556
2024-03-14 00:15:29,430 -   best_eval_score = 0.4957
2024-03-14 00:15:29,430 -   eval_score = 0.4941
2024-03-14 00:15:29,430 - EarlyStopping counter: 3 out of 8
2024-03-14 00:16:28,699 - ***** Epoch: 16: Eval results *****
2024-03-14 00:16:28,699 -   train_loss = 0.5452
2024-03-14 00:16:28,699 -   best_eval_score = 0.4957
2024-03-14 00:16:28,699 -   eval_score = 0.4946
2024-03-14 00:16:28,700 - EarlyStopping counter: 4 out of 8
2024-03-14 00:17:27,590 - ***** Epoch: 17: Eval results *****
2024-03-14 00:17:27,590 -   train_loss = 0.5268
2024-03-14 00:17:27,590 -   best_eval_score = 0.4957
2024-03-14 00:17:27,590 -   eval_score = 0.493
2024-03-14 00:17:27,590 - EarlyStopping counter: 5 out of 8
2024-03-14 00:18:26,940 - ***** Epoch: 18: Eval results *****
2024-03-14 00:18:26,940 -   train_loss = 0.5359
2024-03-14 00:18:26,940 -   best_eval_score = 0.4957
2024-03-14 00:18:26,940 -   eval_score = 0.5007
2024-03-14 00:19:26,480 - ***** Epoch: 19: Eval results *****
2024-03-14 00:19:26,480 -   train_loss = 0.5197
2024-03-14 00:19:26,480 -   best_eval_score = 0.5007
2024-03-14 00:19:26,480 -   eval_score = 0.4995
2024-03-14 00:19:26,480 - EarlyStopping counter: 1 out of 8
2024-03-14 00:20:25,169 - ***** Epoch: 20: Eval results *****
2024-03-14 00:20:25,169 -   train_loss = 0.5141
2024-03-14 00:20:25,169 -   best_eval_score = 0.5007
2024-03-14 00:20:25,169 -   eval_score = 0.5012
2024-03-14 00:21:24,061 - ***** Epoch: 21: Eval results *****
2024-03-14 00:21:24,061 -   train_loss = 0.5057
2024-03-14 00:21:24,061 -   best_eval_score = 0.5012
2024-03-14 00:21:24,061 -   eval_score = 0.501
2024-03-14 00:21:24,061 - EarlyStopping counter: 1 out of 8
2024-03-14 00:22:23,002 - ***** Epoch: 22: Eval results *****
2024-03-14 00:22:23,002 -   train_loss = 0.5118
2024-03-14 00:22:23,002 -   best_eval_score = 0.5012
2024-03-14 00:22:23,002 -   eval_score = 0.5016
2024-03-14 00:23:22,016 - ***** Epoch: 23: Eval results *****
2024-03-14 00:23:22,017 -   train_loss = 0.5102
2024-03-14 00:23:22,017 -   best_eval_score = 0.5016
2024-03-14 00:23:22,017 -   eval_score = 0.5016
2024-03-14 00:23:22,017 - EarlyStopping counter: 1 out of 8
2024-03-14 00:24:20,780 - ***** Epoch: 24: Eval results *****
2024-03-14 00:24:20,780 -   train_loss = 0.5035
2024-03-14 00:24:20,780 -   best_eval_score = 0.5016
2024-03-14 00:24:20,780 -   eval_score = 0.501
2024-03-14 00:24:20,780 - EarlyStopping counter: 2 out of 8
2024-03-14 00:25:19,652 - ***** Epoch: 25: Eval results *****
2024-03-14 00:25:19,653 -   train_loss = 0.5017
2024-03-14 00:25:19,653 -   best_eval_score = 0.5016
2024-03-14 00:25:19,653 -   eval_score = 0.5018
2024-03-14 00:26:20,370 - ***** Epoch: 26: Eval results *****
2024-03-14 00:26:20,371 -   train_loss = 0.5104
2024-03-14 00:26:20,371 -   best_eval_score = 0.5018
2024-03-14 00:26:20,371 -   eval_score = 0.5018
2024-03-14 00:26:20,371 - EarlyStopping counter: 1 out of 8
2024-03-14 00:27:20,449 - ***** Epoch: 27: Eval results *****
2024-03-14 00:27:20,449 -   train_loss = 0.5114
2024-03-14 00:27:20,449 -   best_eval_score = 0.5018
2024-03-14 00:27:20,449 -   eval_score = 0.5017
2024-03-14 00:27:20,449 - EarlyStopping counter: 2 out of 8
2024-03-14 00:28:19,817 - ***** Epoch: 28: Eval results *****
2024-03-14 00:28:19,817 -   train_loss = 0.5002
2024-03-14 00:28:19,817 -   best_eval_score = 0.5018
2024-03-14 00:28:19,817 -   eval_score = 0.502
2024-03-14 00:29:19,276 - ***** Epoch: 29: Eval results *****
2024-03-14 00:29:19,276 -   train_loss = 0.5079
2024-03-14 00:29:19,276 -   best_eval_score = 0.502
2024-03-14 00:29:19,276 -   eval_score = 0.502
2024-03-14 00:29:19,277 - EarlyStopping counter: 1 out of 8
2024-03-14 00:30:19,688 - ***** Epoch: 30: Eval results *****
2024-03-14 00:30:19,689 -   train_loss = 0.5015
2024-03-14 00:30:19,689 -   best_eval_score = 0.502
2024-03-14 00:30:19,689 -   eval_score = 0.502
2024-03-14 00:30:19,689 - EarlyStopping counter: 2 out of 8
2024-03-14 00:31:19,471 - ***** Epoch: 31: Eval results *****
2024-03-14 00:31:19,471 -   train_loss = 0.5023
2024-03-14 00:31:19,471 -   best_eval_score = 0.502
2024-03-14 00:31:19,471 -   eval_score = 0.502
2024-03-14 00:31:19,471 - EarlyStopping counter: 3 out of 8
2024-03-14 00:32:20,009 - ***** Epoch: 32: Eval results *****
2024-03-14 00:32:20,010 -   train_loss = 0.5045
2024-03-14 00:32:20,010 -   best_eval_score = 0.502
2024-03-14 00:32:20,010 -   eval_score = 0.502
2024-03-14 00:32:20,010 - EarlyStopping counter: 4 out of 8
2024-03-14 00:33:20,407 - ***** Epoch: 33: Eval results *****
2024-03-14 00:33:20,407 -   train_loss = 0.5017
2024-03-14 00:33:20,408 -   best_eval_score = 0.502
2024-03-14 00:33:20,408 -   eval_score = 0.502
2024-03-14 00:33:20,408 - EarlyStopping counter: 5 out of 8
2024-03-14 00:34:21,401 - ***** Epoch: 34: Eval results *****
2024-03-14 00:34:21,401 -   train_loss = 0.5082
2024-03-14 00:34:21,401 -   best_eval_score = 0.502
2024-03-14 00:34:21,401 -   eval_score = 0.502
2024-03-14 00:34:21,401 - EarlyStopping counter: 6 out of 8
2024-03-14 00:35:21,488 - ***** Epoch: 35: Eval results *****
2024-03-14 00:35:21,488 -   train_loss = 0.5064
2024-03-14 00:35:21,488 -   best_eval_score = 0.502
2024-03-14 00:35:21,488 -   eval_score = 0.502
2024-03-14 00:35:21,488 - EarlyStopping counter: 7 out of 8
2024-03-14 00:36:21,008 - ***** Epoch: 36: Eval results *****
2024-03-14 00:36:21,008 -   train_loss = 0.4971
2024-03-14 00:36:21,008 -   best_eval_score = 0.502
2024-03-14 00:36:21,008 -   eval_score = 0.502
2024-03-14 00:36:21,008 - EarlyStopping counter: 8 out of 8
2024-03-14 00:36:21,008 - EarlyStopping at epoch 36
2024-03-14 00:36:21,013 - Training is finished...
2024-03-14 00:36:21,014 - Testing begins...
2024-03-14 00:36:30,461 - ***** Test: Confusion Matrix *****
2024-03-14 00:36:30,463 - [[ 47   0  15   0   0   0   0   0   1   0   2   0   0   0   0   0   0   0
    0   0   0   1   1   0   1   0   0   0   0   0]
 [  0  55   0   0   8   1   4   0   2   0   1   3   4   0   4   0   0   9
    0   0   1   2   1   0   1   0   0   1   0   0]
 [  8   0  46   0   1   0   0   0   0   0   1   0   0   1   1   0   0   2
    0   0   0   0   0   1   3   0   0   0   0   0]
 [  0   0   0  62   0   0   0   0   0   1   0   0   0   0   0   0   1   1
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   7   0   0  34   0   0   0   1   0   0   0   0   0   0   0   0   4
    0   1   0   1   0   1   1   0   0   0   1   0]
 [  0   1   0   0   2  19   0   1   0   1   1   0   0   0   2   0   0   6
    0   2   0   0   0   1   0   1   0   0   0   0]
 [  0   0   0   0   0   1  28  10   0   2   3   0   4   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   4  27   0   0   6   1   7   0   0   0   2   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  1   2   1   3   1   0   0   0  22   1   0   1   1   0   4   0   0   3
    0   0   0   1   6   0   2   0   0   0   0   0]
 [  0   0   1   1   1   0   0   0   1  56   0   6   6   0  13   0   0   8
    1   0   0   0   2   1   4   1   1   4   0   0]
 [  2   0   0   0   0   4   6   2   0   0  43   0  28   0   4   0   1   1
    0   1   0   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   1   0   0   4   1  23   8   0   1   0   0   0
    1   0   0   0   3   0   1   0   0   2   0   2]
 [  0   2   0   0   0   0   2   8   0   5  26   2  86   0   0   0   2   0
    0   1   0   0   1   0   0   0   0   0   0   0]
 [  0   0   2   0   1   0   0   0   1   2   0   0   0   0   2   1   0   3
    4   0   0   0   1   0   0   0   0   0   0   0]
 [  0   2   1   0   0   1   0   0   3   6   2   1   0   0 121   0   0  29
    4   0   2   0  12   0   4   1   0   4   0   0]
 [  0   1   1   0   0   0   0   0   0   4   0   0   0   0   1   3   0   3
    4   0   0   1   1   0   0   0   0   2   1   0]
 [  0   0   0   0   1   0   0   2   0   0   3   0   1   0   0   0  56   0
    3   0   0   0   0   0   0   0   0   0   0   0]
 [  0   4   1   1   7   4   0   0   2  15   1   0   1   0  17   2   2 120
    9   2   0   4   6   8   1   2   1   5   1   1]
 [  0   2   0   0   0   0   1   0   1   3   1   0   0   0   7   0   2   7
   29   1   1   0   2   0   2   0   0   1   0   0]
 [  0   5   0   0   1   0   2   0   0   0   1   0   0   0   0   0   0   1
    0   6   0   1   0   0   0   0   0   0   0   0]
 [  1   1   2   0   2   0   0   0   0   2   1   1   0   0   6   0   0   4
    5   0   0   0   1   1   0   0   0   2   0   0]
 [  6   0   0   0   1   0   0   0   0   4   0   1   0   0   0   0   4   1
    0   0   0  28   0   4   1   2   0   1   0   0]
 [  0   0   0   1   0   1   0   0   1   5   0   2   0   1   9   0   0   3
    0   0   0   0  87   0   1   5   1   0   0   0]
 [  0   2   1   0   1   0   0   0   0   0   0   0   0   0   1   0   0   7
    0   1   0   4   0  21   0   0   0   0   0   0]
 [  1   0   3   0   0   0   0   0   1   1   0   2   0   0   2   0   0   3
    0   0   0   0   1   1  86   0   0   9   3   0]
 [  1   0   0   0   1   0   0   0   1   0   0   1   0   0   0   0   0   2
    0   0   0   0   2   0   1  21   0   0   0   1]
 [  0   0   0   2   0   0   0   0   0   3   0   0   0   0   1   0   0   3
    0   0   0   2   3   0   0   0   2   0   1   0]
 [  1   2   1   0   0   0   0   0   2  10   2   4   4   0   4   1   0   3
    1   0   1   0   2   0   8   1   0   9   1   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   1   0
    0   0   0   0   0   0   0   0   0   0  56   0]
 [  0   1   0   0   2   0   0   0   4   2   1   1   0   0   0   0   0   3
    1   0   0   0   0   0   0   1   0   1   0   2]]
2024-03-14 00:36:30,463 - ***** Evaluation results *****
2024-03-14 00:36:30,463 -   acc = 0.5878
2024-03-14 00:36:30,464 -   f1 = 0.5106
2024-03-14 00:36:30,464 -   prec = 0.5227
2024-03-14 00:36:30,464 -   rec = 0.5146
2024-03-14 00:36:30,464 - Testing is finished...
2024-03-14 00:36:30,464 - Multimodal intent recognition is finished...
2024-03-14 00:36:30,464 - Results are saved in results/msz.csv
