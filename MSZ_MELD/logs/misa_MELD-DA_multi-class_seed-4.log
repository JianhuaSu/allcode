2024-07-16 11:56:42,890 - ============================== Params ==============================
2024-07-16 11:56:42,890 - logger_name: misa_MELD-DA_multi-class_seed-4
2024-07-16 11:56:42,890 - dataset: MELD-DA
2024-07-16 11:56:42,890 - data_mode: multi-class
2024-07-16 11:56:42,891 - method: misa
2024-07-16 11:56:42,891 - text_backbone: bert-base-uncased
2024-07-16 11:56:42,891 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-07-16 11:56:42,891 - seed: 4
2024-07-16 11:56:42,891 - num_workers: 8
2024-07-16 11:56:42,891 - gpu_id: 1
2024-07-16 11:56:42,891 - data_path: /home/sharing/disk1/zhanghanlei/Datasets/public
2024-07-16 11:56:42,891 - train: True
2024-07-16 11:56:42,891 - tune: True
2024-07-16 11:56:42,891 - save_model: False
2024-07-16 11:56:42,891 - save_results: True
2024-07-16 11:56:42,891 - log_path: logs
2024-07-16 11:56:42,891 - cache_path: 
2024-07-16 11:56:42,891 - video_data_path: video_data
2024-07-16 11:56:42,891 - audio_data_path: audio_data
2024-07-16 11:56:42,891 - video_feats_path: video_feats.pkl
2024-07-16 11:56:42,891 - audio_feats_path: audio_feats.pkl
2024-07-16 11:56:42,891 - results_path: results
2024-07-16 11:56:42,891 - output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ/outputs/MELD-DA
2024-07-16 11:56:42,891 - model_path: models
2024-07-16 11:56:42,891 - config_file_name: misa_bert_MELD-DA
2024-07-16 11:56:42,891 - results_file_name: misa_bert_MELD-DA.csv
2024-07-16 11:56:42,891 - ablation: none
2024-07-16 11:56:42,891 - padding_mode: zero
2024-07-16 11:56:42,891 - padding_loc: end
2024-07-16 11:56:42,891 - need_aligned: False
2024-07-16 11:56:42,891 - eval_monitor: f1
2024-07-16 11:56:42,891 - train_batch_size: 16
2024-07-16 11:56:42,891 - eval_batch_size: 8
2024-07-16 11:56:42,891 - test_batch_size: 8
2024-07-16 11:56:42,891 - wait_patience: 8
2024-07-16 11:56:42,891 - num_train_epochs: 100
2024-07-16 11:56:42,891 - rnncell: lstm
2024-07-16 11:56:42,891 - use_cmd_sim: False
2024-07-16 11:56:42,891 - reverse_grad_weight: 0.8
2024-07-16 11:56:42,891 - hidden_size: 256
2024-07-16 11:56:42,891 - dropout_rate: 0.2
2024-07-16 11:56:42,891 - diff_weight: 0.7
2024-07-16 11:56:42,891 - sim_weight: 0.5
2024-07-16 11:56:42,891 - recon_weight: 0.6
2024-07-16 11:56:42,891 - lr: 3e-05
2024-07-16 11:56:42,891 - grad_clip: -1.0
2024-07-16 11:56:42,891 - gamma: 0.5
2024-07-16 11:56:42,891 - pred_output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ/outputs/MELD-DA/misa_MELD-DA_multi-class_seed-4
2024-07-16 11:56:42,891 - model_output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ/outputs/MELD-DA/misa_MELD-DA_multi-class_seed-4/models
2024-07-16 11:56:42,891 - ============================== End Params ==============================
2024-07-16 11:56:42,904 - Generate Text Features Begin...
2024-07-16 11:56:44,436 - Generate Text Features Finished...
2024-07-16 11:56:44,438 - Load Video Features Begin...
2024-07-16 11:56:45,681 - Load Video Features Finished...
2024-07-16 11:56:48,427 - Load Audio Features Begin...
2024-07-16 11:56:53,384 - Load Audio Features Finished...
2024-07-16 11:57:12,348 - method  begins...
2024-07-16 11:57:16,362 - Multimodal intent recognition begins...
2024-07-16 11:57:16,363 - Training begins...
2024-07-16 11:58:15,399 - ***** Epoch: 1: Eval results *****
2024-07-16 11:58:15,399 -   best_eval_score = 0.0
2024-07-16 11:58:15,399 -   eval_score = 0.4504
2024-07-16 11:58:15,399 -   train_loss = 2.1466
2024-07-16 11:59:14,355 - ***** Epoch: 2: Eval results *****
2024-07-16 11:59:14,356 -   best_eval_score = 0.4504
2024-07-16 11:59:14,356 -   eval_score = 0.4585
2024-07-16 11:59:14,356 -   train_loss = 1.6872
2024-07-16 12:00:12,483 - ***** Epoch: 3: Eval results *****
2024-07-16 12:00:12,484 -   best_eval_score = 0.4585
2024-07-16 12:00:12,484 -   eval_score = 0.5193
2024-07-16 12:00:12,484 -   train_loss = 1.4556
2024-07-16 12:01:11,986 - ***** Epoch: 4: Eval results *****
2024-07-16 12:01:11,987 -   best_eval_score = 0.5193
2024-07-16 12:01:11,987 -   eval_score = 0.4714
2024-07-16 12:01:11,987 -   train_loss = 1.1665
2024-07-16 12:01:11,987 - EarlyStopping counter: 1 out of 8
2024-07-16 12:02:10,691 - ***** Epoch: 5: Eval results *****
2024-07-16 12:02:10,691 -   best_eval_score = 0.5193
2024-07-16 12:02:10,691 -   eval_score = 0.5041
2024-07-16 12:02:10,691 -   train_loss = 0.896
2024-07-16 12:02:10,691 - EarlyStopping counter: 2 out of 8
2024-07-16 12:03:11,603 - ***** Epoch: 6: Eval results *****
2024-07-16 12:03:11,603 -   best_eval_score = 0.5193
2024-07-16 12:03:11,607 -   eval_score = 0.5168
2024-07-16 12:03:11,607 -   train_loss = 0.7735
2024-07-16 12:03:11,607 - EarlyStopping counter: 3 out of 8
2024-07-16 12:04:11,505 - ***** Epoch: 7: Eval results *****
2024-07-16 12:04:11,505 -   best_eval_score = 0.5193
2024-07-16 12:04:11,505 -   eval_score = 0.4996
2024-07-16 12:04:11,505 -   train_loss = 0.7359
2024-07-16 12:04:11,505 - EarlyStopping counter: 4 out of 8
2024-07-16 12:05:10,498 - ***** Epoch: 8: Eval results *****
2024-07-16 12:05:10,498 -   best_eval_score = 0.5193
2024-07-16 12:05:10,499 -   eval_score = 0.499
2024-07-16 12:05:10,499 -   train_loss = 0.7215
2024-07-16 12:05:10,499 - EarlyStopping counter: 5 out of 8
2024-07-16 12:06:09,714 - ***** Epoch: 9: Eval results *****
2024-07-16 12:06:09,714 -   best_eval_score = 0.5193
2024-07-16 12:06:09,714 -   eval_score = 0.5004
2024-07-16 12:06:09,714 -   train_loss = 0.7124
2024-07-16 12:06:09,714 - EarlyStopping counter: 6 out of 8
2024-07-16 12:07:08,287 - ***** Epoch: 10: Eval results *****
2024-07-16 12:07:08,287 -   best_eval_score = 0.5193
2024-07-16 12:07:08,287 -   eval_score = 0.5011
2024-07-16 12:07:08,287 -   train_loss = 0.7091
2024-07-16 12:07:08,287 - EarlyStopping counter: 7 out of 8
2024-07-16 12:08:07,647 - ***** Epoch: 11: Eval results *****
2024-07-16 12:08:07,648 -   best_eval_score = 0.5193
2024-07-16 12:08:07,648 -   eval_score = 0.4976
2024-07-16 12:08:07,648 -   train_loss = 0.7062
2024-07-16 12:08:07,648 - EarlyStopping counter: 8 out of 8
2024-07-16 12:08:07,648 - EarlyStopping at epoch 11
2024-07-16 12:08:07,650 - Training is finished...
2024-07-16 12:08:07,651 - Testing begins...
2024-07-16 12:08:17,477 - ***** Test: Confusion Matrix *****
2024-07-16 12:08:17,478 - [[  1   4   0   0   0   0   0   7   4   0   3   1]
 [  0  40   2   0   0   0   1   0  13   2  22   5]
 [  0  22  52   2   1   1  17   1  49  11  80  13]
 [  0   2   0  26   0   0   0   0   3   3   0   0]
 [  0   6   0   0  17   0   0   0   0   1   0   8]
 [  1   0   0   0   0  26   0   1  15   1   5   4]
 [  0   0   7   1   0   0  23   0  11   3  11   0]
 [  2   0   0   1   0   0   0  73   0   2   3   4]
 [  0   9   4   4   0   2   7   1 134   8  47   1]
 [  0   0   4   0   1   0   1   2  10 367   7   2]
 [  1  14  38   0   1   9  15  11 148  23 311   9]
 [  0   5   7   1   6   7   2   3  16   6  23  36]]
2024-07-16 12:08:17,478 - ***** Evaluation results *****
2024-07-16 12:08:17,478 -   acc = 0.5769
2024-07-16 12:08:17,478 -   f1 = 0.5084
2024-07-16 12:08:17,478 -   prec = 0.5285
2024-07-16 12:08:17,479 -   rec = 0.516
2024-07-16 12:08:17,479 - Testing is finished...
2024-07-16 12:08:17,479 - Multimodal intent recognition is finished...
2024-07-16 12:08:17,479 - Results are saved in results/misa_bert_MELD-DA.csv
