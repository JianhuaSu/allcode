2023-12-25 11:31:05,488 - ============================== Params ==============================
2023-12-25 11:31:05,488 - logger_name: msz_MIntRec_multi-class_seed-9_2023-12-25-11-31-05
2023-12-25 11:31:05,488 - dataset: MIntRec
2023-12-25 11:31:05,488 - data_mode: multi-class
2023-12-25 11:31:05,488 - method: msz
2023-12-25 11:31:05,488 - text_backbone: bert-base-uncased
2023-12-25 11:31:05,488 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-25 11:31:05,488 - seed: 9
2023-12-25 11:31:05,488 - num_workers: 8
2023-12-25 11:31:05,488 - gpu_id: 0
2023-12-25 11:31:05,488 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-25 11:31:05,488 - train: True
2023-12-25 11:31:05,488 - tune: False
2023-12-25 11:31:05,488 - save_model: False
2023-12-25 11:31:05,488 - save_results: True
2023-12-25 11:31:05,488 - log_path: logs
2023-12-25 11:31:05,488 - cache_path: 
2023-12-25 11:31:05,489 - video_data_path: video_data
2023-12-25 11:31:05,489 - audio_data_path: audio_data
2023-12-25 11:31:05,489 - video_feats_path: video_feats.pkl
2023-12-25 11:31:05,489 - audio_feats_path: audio_feats.pkl
2023-12-25 11:31:05,489 - results_path: results
2023-12-25 11:31:05,489 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-25 11:31:05,489 - model_path: models
2023-12-25 11:31:05,489 - config_file_name: msz
2023-12-25 11:31:05,489 - results_file_name: msz.csv
2023-12-25 11:31:05,489 - padding_mode: zero
2023-12-25 11:31:05,489 - padding_loc: end
2023-12-25 11:31:05,489 - need_aligned: False
2023-12-25 11:31:05,489 - eval_monitor: f1
2023-12-25 11:31:05,489 - train_batch_size: 16
2023-12-25 11:31:05,489 - eval_batch_size: 8
2023-12-25 11:31:05,489 - test_batch_size: 8
2023-12-25 11:31:05,489 - wait_patience: 8
2023-12-25 11:31:05,489 - nheads: 2
2023-12-25 11:31:05,489 - encoder_layers: 2
2023-12-25 11:31:05,489 - attn_dropout: 0.1
2023-12-25 11:31:05,489 - relu_dropout: 0.1
2023-12-25 11:31:05,489 - embed_dropout: 0.1
2023-12-25 11:31:05,489 - res_dropout: 0.1
2023-12-25 11:31:05,489 - attn_mask: False
2023-12-25 11:31:05,489 - hidden_size: 768
2023-12-25 11:31:05,489 - num_attention_heads: 12
2023-12-25 11:31:05,489 - attention_probs_dropout_prob: 0.2
2023-12-25 11:31:05,489 - hidden_dropout_prob: 0.2
2023-12-25 11:31:05,489 - intermediate_size: 768
2023-12-25 11:31:05,489 - num_hidden_layers: 3
2023-12-25 11:31:05,489 - max_position_embeddings: 512
2023-12-25 11:31:05,489 - position_embedding_type: absolute
2023-12-25 11:31:05,490 - add_cross_attention: False
2023-12-25 11:31:05,490 - batch_first: True
2023-12-25 11:31:05,490 - hidden_dims: 768
2023-12-25 11:31:05,490 - att_dropouts: [0.1, 0.1, 0.1]
2023-12-25 11:31:05,490 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-25 11:31:05,490 - sl: 0.1
2023-12-25 11:31:05,490 - cl: 0.1
2023-12-25 11:31:05,490 - num_train_epochs: 100
2023-12-25 11:31:05,490 - warmup_proportion: 0.1
2023-12-25 11:31:05,490 - lr: 5e-06
2023-12-25 11:31:05,490 - weight_decay: 0.01
2023-12-25 11:31:05,490 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-9_2023-12-25-11-31-05
2023-12-25 11:31:05,490 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-9_2023-12-25-11-31-05/models
2023-12-25 11:31:05,490 - ============================== End Params ==============================
2023-12-25 11:31:05,674 - Generate Text Features Begin...
2023-12-25 11:31:06,595 - Generate Text Features Finished...
2023-12-25 11:31:06,596 - Load Video Features Begin...
2023-12-25 11:31:17,892 - Load Video Features Finished...
2023-12-25 11:31:18,488 - Load Audio Features Begin...
2023-12-25 11:32:03,363 - Load Audio Features Finished...
2023-12-25 11:32:07,783 - method  begins...
2023-12-25 11:32:14,900 - Multimodal intent recognition begins...
2023-12-25 11:32:14,901 - Training begins...
2023-12-25 11:32:37,825 - ***** Epoch: 1: Eval results *****
2023-12-25 11:32:37,843 -   train_loss = 2.9602
2023-12-25 11:32:37,843 -   best_eval_score = 0.0
2023-12-25 11:32:37,844 -   eval_score = 0.0252
2023-12-25 11:32:58,790 - ***** Epoch: 2: Eval results *****
2023-12-25 11:32:58,791 -   train_loss = 2.792
2023-12-25 11:32:58,791 -   best_eval_score = 0.0252
2023-12-25 11:32:58,791 -   eval_score = 0.0393
2023-12-25 11:33:18,751 - ***** Epoch: 3: Eval results *****
2023-12-25 11:33:18,753 -   train_loss = 2.5426
2023-12-25 11:33:18,753 -   best_eval_score = 0.0393
2023-12-25 11:33:18,753 -   eval_score = 0.1738
2023-12-25 11:33:45,114 - ***** Epoch: 4: Eval results *****
2023-12-25 11:33:45,117 -   train_loss = 2.2695
2023-12-25 11:33:45,117 -   best_eval_score = 0.1738
2023-12-25 11:33:45,117 -   eval_score = 0.2215
2023-12-25 11:34:04,273 - ***** Epoch: 5: Eval results *****
2023-12-25 11:34:04,273 -   train_loss = 1.8928
2023-12-25 11:34:04,274 -   best_eval_score = 0.2215
2023-12-25 11:34:04,274 -   eval_score = 0.3398
2023-12-25 11:34:24,468 - ***** Epoch: 6: Eval results *****
2023-12-25 11:34:24,469 -   train_loss = 1.6218
2023-12-25 11:34:24,470 -   best_eval_score = 0.3398
2023-12-25 11:34:24,470 -   eval_score = 0.5129
2023-12-25 11:34:44,774 - ***** Epoch: 7: Eval results *****
2023-12-25 11:34:44,788 -   train_loss = 1.2776
2023-12-25 11:34:44,788 -   best_eval_score = 0.5129
2023-12-25 11:34:44,789 -   eval_score = 0.4267
2023-12-25 11:34:44,789 - EarlyStopping counter: 1 out of 8
2023-12-25 11:35:06,119 - ***** Epoch: 8: Eval results *****
2023-12-25 11:35:06,120 -   train_loss = 1.1407
2023-12-25 11:35:06,121 -   best_eval_score = 0.5129
2023-12-25 11:35:06,121 -   eval_score = 0.5221
2023-12-25 11:35:27,504 - ***** Epoch: 9: Eval results *****
2023-12-25 11:35:27,505 -   train_loss = 1.0475
2023-12-25 11:35:27,505 -   best_eval_score = 0.5221
2023-12-25 11:35:27,505 -   eval_score = 0.4876
2023-12-25 11:35:27,505 - EarlyStopping counter: 1 out of 8
2023-12-25 11:35:48,800 - ***** Epoch: 10: Eval results *****
2023-12-25 11:35:48,801 -   train_loss = 0.9648
2023-12-25 11:35:48,802 -   best_eval_score = 0.5221
2023-12-25 11:35:48,802 -   eval_score = 0.4904
2023-12-25 11:35:48,802 - EarlyStopping counter: 2 out of 8
2023-12-25 11:36:08,585 - ***** Epoch: 11: Eval results *****
2023-12-25 11:36:08,586 -   train_loss = 1.4162
2023-12-25 11:36:08,586 -   best_eval_score = 0.5221
2023-12-25 11:36:08,586 -   eval_score = 0.3517
2023-12-25 11:36:08,587 - EarlyStopping counter: 3 out of 8
2023-12-25 11:36:27,243 - ***** Epoch: 12: Eval results *****
2023-12-25 11:36:27,243 -   train_loss = 1.1995
2023-12-25 11:36:27,244 -   best_eval_score = 0.5221
2023-12-25 11:36:27,244 -   eval_score = 0.4741
2023-12-25 11:36:27,244 - EarlyStopping counter: 4 out of 8
2023-12-25 11:36:45,461 - ***** Epoch: 13: Eval results *****
2023-12-25 11:36:45,462 -   train_loss = 1.1608
2023-12-25 11:36:45,462 -   best_eval_score = 0.5221
2023-12-25 11:36:45,463 -   eval_score = 0.4603
2023-12-25 11:36:45,463 - EarlyStopping counter: 5 out of 8
2023-12-25 11:37:04,703 - ***** Epoch: 14: Eval results *****
2023-12-25 11:37:04,703 -   train_loss = 1.182
2023-12-25 11:37:04,704 -   best_eval_score = 0.5221
2023-12-25 11:37:04,704 -   eval_score = 0.423
2023-12-25 11:37:04,704 - EarlyStopping counter: 6 out of 8
2023-12-25 11:37:23,499 - ***** Epoch: 15: Eval results *****
2023-12-25 11:37:23,500 -   train_loss = 1.0995
2023-12-25 11:37:23,500 -   best_eval_score = 0.5221
2023-12-25 11:37:23,500 -   eval_score = 0.4581
2023-12-25 11:37:23,500 - EarlyStopping counter: 7 out of 8
2023-12-25 11:37:42,913 - ***** Epoch: 16: Eval results *****
2023-12-25 11:37:42,914 -   train_loss = 1.0573
2023-12-25 11:37:42,914 -   best_eval_score = 0.5221
2023-12-25 11:37:42,914 -   eval_score = 0.4283
2023-12-25 11:37:42,914 - EarlyStopping counter: 8 out of 8
2023-12-25 11:37:42,915 - EarlyStopping at epoch 16
2023-12-25 11:37:42,917 - Training is finished...
2023-12-25 11:37:42,917 - Testing begins...
2023-12-25 11:37:51,955 - ***** Test: Confusion Matrix *****
2023-12-25 11:37:51,960 - [[47  1  0  0  1  0  0  0  0  4  0  0  2  1  0  0  1  0  0  0]
 [ 4 35  0  0  1  0  0  0  0  0  0  1  1  1  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 6  1  0  0 10  0  1  0  0  0  1  1  1  1  1  0  0  0  0  0]
 [ 1  0  0  0  0 10  0  0  0  0  0  0  0  0  0  0  0  1  0  0]
 [ 7  0  0  0  2  0  0  0  0  0  0  1  0  0  0  0  0  2  0  0]
 [ 6  2  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0  0  0  0]
 [ 7  2  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0]
 [ 3  1  0  0  0  0  0  0  0  1  1  0  2  0  0  1  0  1  0  0]
 [ 2  0  0  0  0  0  0  0  0  0 15  0  0  0  1  0  0  0  0  0]
 [ 3  1  0  0  0  0  0  0  0  0  1 13  1  0  0  0  0  0  0  0]
 [13  2  0  0  1  0  1  0  0  0  0  0 33  5  0  0  1  1  0  0]
 [ 7  1  0  0  0  0  0  0  0  0  2  1  0 12  2  0  0  0  0  0]
 [ 0  0  1  0  1  0  0  0  0  0  0  0  7  4  8  0  1  0  0  0]
 [ 4  1  0  1  0  0  0  0  0  0  0  0  6  0  1  7  0  1  0  0]
 [ 2  0  0  0  0  0  0  0  0  0  0  0  2  2  1  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0 14  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0 10  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  1  0  2  0  0  5  0  0  1]]
2023-12-25 11:37:51,961 - ***** Evaluation results *****
2023-12-25 11:37:51,961 -   acc = 0.6225
2023-12-25 11:37:51,962 -   f1 = 0.5342
2023-12-25 11:37:51,963 -   prec = 0.5951
2023-12-25 11:37:51,965 -   rec = 0.5349
2023-12-25 11:37:51,965 - Testing is finished...
2023-12-25 11:37:51,966 - Multimodal intent recognition is finished...
2023-12-25 11:37:51,966 - Results are saved in results/msz.csv
