2024-07-22 09:41:12,295 - ============================== Params ==============================
2024-07-22 09:41:12,295 - logger_name: mmim_MELD-DA_multi-class_seed-3
2024-07-22 09:41:12,295 - dataset: MELD-DA
2024-07-22 09:41:12,296 - data_mode: multi-class
2024-07-22 09:41:12,296 - method: mmim
2024-07-22 09:41:12,296 - text_backbone: bert-base-uncased
2024-07-22 09:41:12,296 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-07-22 09:41:12,296 - seed: 3
2024-07-22 09:41:12,296 - num_workers: 8
2024-07-22 09:41:12,296 - gpu_id: 1
2024-07-22 09:41:12,296 - data_path: /home/sharing/disk1/zhanghanlei/Datasets/public
2024-07-22 09:41:12,296 - train: True
2024-07-22 09:41:12,296 - tune: True
2024-07-22 09:41:12,296 - save_model: False
2024-07-22 09:41:12,296 - save_results: True
2024-07-22 09:41:12,296 - log_path: logs
2024-07-22 09:41:12,297 - cache_path: 
2024-07-22 09:41:12,297 - video_data_path: video_data
2024-07-22 09:41:12,297 - audio_data_path: audio_data
2024-07-22 09:41:12,297 - video_feats_path: video_feats.pkl
2024-07-22 09:41:12,297 - audio_feats_path: audio_feats.pkl
2024-07-22 09:41:12,297 - results_path: results
2024-07-22 09:41:12,297 - output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ_1/outputs/MELD-DA
2024-07-22 09:41:12,297 - model_path: models
2024-07-22 09:41:12,297 - config_file_name: mmim_bert_MELD-DA
2024-07-22 09:41:12,297 - results_file_name: mmim_bert_MELD-DA.csv
2024-07-22 09:41:12,297 - ablation: none
2024-07-22 09:41:12,297 - padding_mode: zero
2024-07-22 09:41:12,297 - padding_loc: end
2024-07-22 09:41:12,297 - need_aligned: False
2024-07-22 09:41:12,298 - eval_monitor: f1
2024-07-22 09:41:12,298 - train_batch_size: 16
2024-07-22 09:41:12,298 - eval_batch_size: 8
2024-07-22 09:41:12,298 - test_batch_size: 8
2024-07-22 09:41:12,298 - wait_patience: 8
2024-07-22 09:41:12,298 - num_train_epochs: 100
2024-07-22 09:41:12,298 - add_va: False
2024-07-22 09:41:12,298 - cpc_activation: Tanh
2024-07-22 09:41:12,298 - mmilb_mid_activation: ReLU
2024-07-22 09:41:12,298 - mmilb_last_activation: Tanh
2024-07-22 09:41:12,298 - optim: Adam
2024-07-22 09:41:12,298 - contrast: True
2024-07-22 09:41:12,298 - bidirectional: True
2024-07-22 09:41:12,298 - grad_clip: 1.0
2024-07-22 09:41:12,299 - lr_main: 0.0002
2024-07-22 09:41:12,299 - weight_decay_main: 0.0002
2024-07-22 09:41:12,299 - lr_bert: 4e-05
2024-07-22 09:41:12,299 - weight_decay_bert: 7e-05
2024-07-22 09:41:12,299 - lr_mmilb: 0.001
2024-07-22 09:41:12,299 - weight_decay_mmilb: 0.0001
2024-07-22 09:41:12,299 - alpha: 0.1
2024-07-22 09:41:12,299 - dropout_a: 0.1
2024-07-22 09:41:12,299 - dropout_v: 0.1
2024-07-22 09:41:12,299 - dropout_prj: 0.1
2024-07-22 09:41:12,299 - n_layer: 1
2024-07-22 09:41:12,299 - cpc_layers: 1
2024-07-22 09:41:12,299 - d_vh: 32
2024-07-22 09:41:12,299 - d_ah: 32
2024-07-22 09:41:12,300 - d_vout: 16
2024-07-22 09:41:12,300 - d_aout: 16
2024-07-22 09:41:12,300 - d_prjh: 512
2024-07-22 09:41:12,300 - scale: 20
2024-07-22 09:41:12,300 - beta: 0.5
2024-07-22 09:41:12,300 - pred_output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ_1/outputs/MELD-DA/mmim_MELD-DA_multi-class_seed-3
2024-07-22 09:41:12,300 - model_output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ_1/outputs/MELD-DA/mmim_MELD-DA_multi-class_seed-3/models
2024-07-22 09:41:12,300 - ============================== End Params ==============================
2024-07-22 09:41:12,326 - Generate Text Features Begin...
2024-07-22 09:41:13,786 - Generate Text Features Finished...
2024-07-22 09:41:13,787 - Load Video Features Begin...
2024-07-22 09:41:15,086 - Load Video Features Finished...
2024-07-22 09:41:18,126 - Load Audio Features Begin...
2024-07-22 09:41:23,360 - Load Audio Features Finished...
2024-07-22 09:41:41,774 - method  begins...
2024-07-22 09:41:46,231 - Multimodal intent recognition begins...
2024-07-22 09:41:46,231 - Training begins...
2024-07-22 09:43:47,874 - ***** Epoch: 1: Eval results *****
2024-07-22 09:43:47,875 -   best_eval_score = 0.0
2024-07-22 09:43:47,875 -   eval_score = 0.4433
2024-07-22 09:43:47,875 -   train_loss_main = 2.1118
2024-07-22 09:43:47,875 -   train_loss_mmilb = 0.0854
2024-07-22 09:45:50,706 - ***** Epoch: 2: Eval results *****
2024-07-22 09:45:50,707 -   best_eval_score = 0.4433
2024-07-22 09:45:50,707 -   eval_score = 0.4914
2024-07-22 09:45:50,707 -   train_loss_main = 1.7108
2024-07-22 09:45:50,707 -   train_loss_mmilb = 0.0006
2024-07-22 09:47:51,787 - ***** Epoch: 3: Eval results *****
2024-07-22 09:47:51,788 -   best_eval_score = 0.4914
2024-07-22 09:47:51,788 -   eval_score = 0.4665
2024-07-22 09:47:51,788 -   train_loss_main = 1.402
2024-07-22 09:47:51,788 -   train_loss_mmilb = 0.0003
2024-07-22 09:47:51,788 - EarlyStopping counter: 1 out of 8
2024-07-22 09:50:08,090 - ***** Epoch: 4: Eval results *****
2024-07-22 09:50:08,090 -   best_eval_score = 0.4914
2024-07-22 09:50:08,091 -   eval_score = 0.4917
2024-07-22 09:50:08,091 -   train_loss_main = 1.1395
2024-07-22 09:50:08,091 -   train_loss_mmilb = 0.0002
2024-07-22 09:52:11,893 - ***** Epoch: 5: Eval results *****
2024-07-22 09:52:11,893 -   best_eval_score = 0.4917
2024-07-22 09:52:11,893 -   eval_score = 0.4557
2024-07-22 09:52:11,893 -   train_loss_main = 0.9924
2024-07-22 09:52:11,894 -   train_loss_mmilb = 0.0002
2024-07-22 09:52:11,894 - EarlyStopping counter: 1 out of 8
2024-07-22 09:54:16,070 - ***** Epoch: 6: Eval results *****
2024-07-22 09:54:16,071 -   best_eval_score = 0.4917
2024-07-22 09:54:16,071 -   eval_score = 0.4836
2024-07-22 09:54:16,071 -   train_loss_main = 0.9473
2024-07-22 09:54:16,071 -   train_loss_mmilb = 0.0002
2024-07-22 09:54:16,071 - EarlyStopping counter: 2 out of 8
2024-07-22 09:56:20,000 - ***** Epoch: 7: Eval results *****
2024-07-22 09:56:20,000 -   best_eval_score = 0.4917
2024-07-22 09:56:20,001 -   eval_score = 0.4414
2024-07-22 09:56:20,001 -   train_loss_main = 0.91
2024-07-22 09:56:20,001 -   train_loss_mmilb = 0.0002
2024-07-22 09:56:20,001 - EarlyStopping counter: 3 out of 8
2024-07-22 09:58:24,619 - ***** Epoch: 8: Eval results *****
2024-07-22 09:58:24,620 -   best_eval_score = 0.4917
2024-07-22 09:58:24,620 -   eval_score = 0.445
2024-07-22 09:58:24,620 -   train_loss_main = 0.9069
2024-07-22 09:58:24,620 -   train_loss_mmilb = 0.0002
2024-07-22 09:58:24,620 - EarlyStopping counter: 4 out of 8
2024-07-22 10:00:28,024 - ***** Epoch: 9: Eval results *****
2024-07-22 10:00:28,025 -   best_eval_score = 0.4917
2024-07-22 10:00:28,025 -   eval_score = 0.433
2024-07-22 10:00:28,025 -   train_loss_main = 0.8927
2024-07-22 10:00:28,025 -   train_loss_mmilb = 0.0002
2024-07-22 10:00:28,025 - EarlyStopping counter: 5 out of 8
2024-07-22 10:02:38,864 - ***** Epoch: 10: Eval results *****
2024-07-22 10:02:38,864 -   best_eval_score = 0.4917
2024-07-22 10:02:38,865 -   eval_score = 0.4327
2024-07-22 10:02:38,865 -   train_loss_main = 0.8831
2024-07-22 10:02:38,865 -   train_loss_mmilb = 0.0002
2024-07-22 10:02:38,865 - EarlyStopping counter: 6 out of 8
2024-07-22 10:04:45,718 - ***** Epoch: 11: Eval results *****
2024-07-22 10:04:45,718 -   best_eval_score = 0.4917
2024-07-22 10:04:45,718 -   eval_score = 0.4571
2024-07-22 10:04:45,718 -   train_loss_main = 0.8845
2024-07-22 10:04:45,718 -   train_loss_mmilb = 0.0002
2024-07-22 10:04:45,718 - EarlyStopping counter: 7 out of 8
2024-07-22 10:06:51,003 - ***** Epoch: 12: Eval results *****
2024-07-22 10:06:51,004 -   best_eval_score = 0.4917
2024-07-22 10:06:51,004 -   eval_score = 0.4573
2024-07-22 10:06:51,004 -   train_loss_main = 0.8855
2024-07-22 10:06:51,004 -   train_loss_mmilb = 0.0002
2024-07-22 10:06:51,004 - EarlyStopping counter: 8 out of 8
2024-07-22 10:06:51,004 - EarlyStopping at epoch 12
2024-07-22 10:06:51,224 - Training is finished...
2024-07-22 10:06:51,225 - Testing begins...
2024-07-22 10:07:04,490 - ***** Test: Confusion Matrix *****
2024-07-22 10:07:04,491 - [[  5   4   1   2   0   0   0   2   1   0   4   1]
 [  0  34  13   1   0   0   1   0   9   1  21   5]
 [  1  11  76   4   1   1  14   2  28   7  87  17]
 [  1   1   0  24   0   0   0   0   3   4   1   0]
 [  0   2   8   0  12   0   0   1   0   1   0   8]
 [  1   2   0   0   0  27   0   0   5   0  15   3]
 [  0   1   8   1   0   2  19   0   7   2  16   0]
 [  2   0   2   0   0   0   0  68   1   3   4   5]
 [  1   4   3  10   0   4   8   2  81   4  95   5]
 [  1   0   5   0   0   0   1   1   6 362  18   0]
 [  4  11  47   3   1  14   8   7  78  24 364  19]
 [  1   6  14   2   6   7   0   2  11   6  19  38]]
2024-07-22 10:07:04,491 - ***** Evaluation results *****
2024-07-22 10:07:04,491 -   acc = 0.579
2024-07-22 10:07:04,491 -   f1 = 0.4974
2024-07-22 10:07:04,491 -   prec = 0.5094
2024-07-22 10:07:04,491 -   rec = 0.4953
2024-07-22 10:07:04,491 - Testing is finished...
2024-07-22 10:07:04,492 - Multimodal intent recognition is finished...
2024-07-22 10:07:04,492 - Results are saved in results/mmim_bert_MELD-DA.csv
2024-07-22 10:44:03,485 - ============================== Params ==============================
2024-07-22 10:44:03,485 - logger_name: mmim_MELD-DA_multi-class_seed-3
2024-07-22 10:44:03,485 - dataset: MELD-DA
2024-07-22 10:44:03,485 - data_mode: multi-class
2024-07-22 10:44:03,485 - method: mmim
2024-07-22 10:44:03,485 - text_backbone: bert-base-uncased
2024-07-22 10:44:03,485 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-07-22 10:44:03,485 - seed: 3
2024-07-22 10:44:03,485 - num_workers: 8
2024-07-22 10:44:03,485 - gpu_id: 1
2024-07-22 10:44:03,485 - data_path: /home/sharing/disk1/zhanghanlei/Datasets/public
2024-07-22 10:44:03,485 - train: True
2024-07-22 10:44:03,485 - tune: True
2024-07-22 10:44:03,486 - save_model: False
2024-07-22 10:44:03,486 - save_results: True
2024-07-22 10:44:03,486 - log_path: logs
2024-07-22 10:44:03,486 - cache_path: 
2024-07-22 10:44:03,486 - video_data_path: video_data
2024-07-22 10:44:03,486 - audio_data_path: audio_data
2024-07-22 10:44:03,486 - video_feats_path: video_feats.pkl
2024-07-22 10:44:03,486 - audio_feats_path: audio_feats.pkl
2024-07-22 10:44:03,486 - results_path: results
2024-07-22 10:44:03,486 - output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ_1/outputs/MELD-DA
2024-07-22 10:44:03,486 - model_path: models
2024-07-22 10:44:03,486 - config_file_name: mmim_bert_MELD-DA
2024-07-22 10:44:03,486 - results_file_name: mmim_bert_MELD-DA.csv
2024-07-22 10:44:03,486 - ablation: none
2024-07-22 10:44:03,486 - padding_mode: zero
2024-07-22 10:44:03,486 - padding_loc: end
2024-07-22 10:44:03,486 - need_aligned: False
2024-07-22 10:44:03,486 - eval_monitor: f1
2024-07-22 10:44:03,486 - train_batch_size: 16
2024-07-22 10:44:03,486 - eval_batch_size: 8
2024-07-22 10:44:03,486 - test_batch_size: 8
2024-07-22 10:44:03,486 - wait_patience: 8
2024-07-22 10:44:03,486 - num_train_epochs: 100
2024-07-22 10:44:03,486 - add_va: False
2024-07-22 10:44:03,486 - cpc_activation: Tanh
2024-07-22 10:44:03,486 - mmilb_mid_activation: ReLU
2024-07-22 10:44:03,486 - mmilb_last_activation: Tanh
2024-07-22 10:44:03,486 - optim: Adam
2024-07-22 10:44:03,486 - contrast: True
2024-07-22 10:44:03,486 - bidirectional: True
2024-07-22 10:44:03,486 - grad_clip: 1.0
2024-07-22 10:44:03,486 - lr_main: 0.0001
2024-07-22 10:44:03,486 - weight_decay_main: 0.0001
2024-07-22 10:44:03,486 - lr_bert: 4e-05
2024-07-22 10:44:03,486 - weight_decay_bert: 7e-05
2024-07-22 10:44:03,486 - lr_mmilb: 0.001
2024-07-22 10:44:03,486 - weight_decay_mmilb: 0.0001
2024-07-22 10:44:03,486 - alpha: 0.1
2024-07-22 10:44:03,486 - dropout_a: 0.1
2024-07-22 10:44:03,486 - dropout_v: 0.1
2024-07-22 10:44:03,486 - dropout_prj: 0.1
2024-07-22 10:44:03,486 - n_layer: 1
2024-07-22 10:44:03,486 - cpc_layers: 1
2024-07-22 10:44:03,486 - d_vh: 32
2024-07-22 10:44:03,486 - d_ah: 32
2024-07-22 10:44:03,486 - d_vout: 16
2024-07-22 10:44:03,487 - d_aout: 16
2024-07-22 10:44:03,487 - d_prjh: 128
2024-07-22 10:44:03,487 - scale: 20
2024-07-22 10:44:03,487 - beta: 0.5
2024-07-22 10:44:03,487 - pred_output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ_1/outputs/MELD-DA/mmim_MELD-DA_multi-class_seed-3
2024-07-22 10:44:03,487 - model_output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ_1/outputs/MELD-DA/mmim_MELD-DA_multi-class_seed-3/models
2024-07-22 10:44:03,487 - ============================== End Params ==============================
2024-07-22 10:44:03,499 - Generate Text Features Begin...
2024-07-22 10:44:04,959 - Generate Text Features Finished...
2024-07-22 10:44:04,961 - Load Video Features Begin...
2024-07-22 10:44:06,192 - Load Video Features Finished...
2024-07-22 10:44:09,132 - Load Audio Features Begin...
2024-07-22 10:44:14,175 - Load Audio Features Finished...
2024-07-22 10:44:32,438 - method  begins...
2024-07-22 10:44:36,464 - Multimodal intent recognition begins...
2024-07-22 10:44:36,465 - Training begins...
2024-07-22 10:46:33,075 - ***** Epoch: 1: Eval results *****
2024-07-22 10:46:33,076 -   best_eval_score = 0.0
2024-07-22 10:46:33,076 -   eval_score = 0.4592
2024-07-22 10:46:33,076 -   train_loss_main = 2.1179
2024-07-22 10:46:33,076 -   train_loss_mmilb = 0.0919
2024-07-22 10:48:31,126 - ***** Epoch: 2: Eval results *****
2024-07-22 10:48:31,127 -   best_eval_score = 0.4592
2024-07-22 10:48:31,127 -   eval_score = 0.4898
2024-07-22 10:48:31,127 -   train_loss_main = 1.7649
2024-07-22 10:48:31,127 -   train_loss_mmilb = 0.0002
2024-07-22 10:50:30,225 - ***** Epoch: 3: Eval results *****
2024-07-22 10:50:30,226 -   best_eval_score = 0.4898
2024-07-22 10:50:30,226 -   eval_score = 0.5035
2024-07-22 10:50:30,226 -   train_loss_main = 1.5112
2024-07-22 10:50:30,226 -   train_loss_mmilb = 0.0001
2024-07-22 10:52:28,541 - ***** Epoch: 4: Eval results *****
2024-07-22 10:52:28,541 -   best_eval_score = 0.5035
2024-07-22 10:52:28,541 -   eval_score = 0.5014
2024-07-22 10:52:28,541 -   train_loss_main = 1.2364
2024-07-22 10:52:28,541 -   train_loss_mmilb = 0.0002
2024-07-22 10:52:28,541 - EarlyStopping counter: 1 out of 8
2024-07-22 10:54:26,859 - ***** Epoch: 5: Eval results *****
2024-07-22 10:54:26,860 -   best_eval_score = 0.5035
2024-07-22 10:54:26,860 -   eval_score = 0.4956
2024-07-22 10:54:26,860 -   train_loss_main = 1.071
2024-07-22 10:54:26,860 -   train_loss_mmilb = 0.0002
2024-07-22 10:54:26,861 - EarlyStopping counter: 2 out of 8
2024-07-22 10:56:26,018 - ***** Epoch: 6: Eval results *****
2024-07-22 10:56:26,018 -   best_eval_score = 0.5035
2024-07-22 10:56:26,019 -   eval_score = 0.4462
2024-07-22 10:56:26,019 -   train_loss_main = 0.9852
2024-07-22 10:56:26,019 -   train_loss_mmilb = 0.0002
2024-07-22 10:56:26,019 - EarlyStopping counter: 3 out of 8
2024-07-22 10:58:22,874 - ***** Epoch: 7: Eval results *****
2024-07-22 10:58:22,875 -   best_eval_score = 0.5035
2024-07-22 10:58:22,875 -   eval_score = 0.4666
2024-07-22 10:58:22,875 -   train_loss_main = 0.9356
2024-07-22 10:58:22,875 -   train_loss_mmilb = 0.0002
2024-07-22 10:58:22,875 - EarlyStopping counter: 4 out of 8
2024-07-22 11:00:20,964 - ***** Epoch: 8: Eval results *****
2024-07-22 11:00:20,965 -   best_eval_score = 0.5035
2024-07-22 11:00:20,965 -   eval_score = 0.4944
2024-07-22 11:00:20,965 -   train_loss_main = 0.9069
2024-07-22 11:00:20,965 -   train_loss_mmilb = 0.0002
2024-07-22 11:00:20,965 - EarlyStopping counter: 5 out of 8
2024-07-22 11:02:20,358 - ***** Epoch: 9: Eval results *****
2024-07-22 11:02:20,359 -   best_eval_score = 0.5035
2024-07-22 11:02:20,359 -   eval_score = 0.4736
2024-07-22 11:02:20,359 -   train_loss_main = 0.8844
2024-07-22 11:02:20,359 -   train_loss_mmilb = 0.0002
2024-07-22 11:02:20,360 - EarlyStopping counter: 6 out of 8
2024-07-22 11:04:15,085 - ***** Epoch: 10: Eval results *****
2024-07-22 11:04:15,086 -   best_eval_score = 0.5035
2024-07-22 11:04:15,086 -   eval_score = 0.4218
2024-07-22 11:04:15,086 -   train_loss_main = 0.854
2024-07-22 11:04:15,086 -   train_loss_mmilb = 0.0002
2024-07-22 11:04:15,086 - EarlyStopping counter: 7 out of 8
2024-07-22 11:06:11,967 - ***** Epoch: 11: Eval results *****
2024-07-22 11:06:11,967 -   best_eval_score = 0.5035
2024-07-22 11:06:11,967 -   eval_score = 0.4668
2024-07-22 11:06:11,967 -   train_loss_main = 0.8426
2024-07-22 11:06:11,967 -   train_loss_mmilb = 0.0002
2024-07-22 11:06:11,968 - EarlyStopping counter: 8 out of 8
2024-07-22 11:06:11,968 - EarlyStopping at epoch 11
2024-07-22 11:06:12,188 - Training is finished...
2024-07-22 11:06:12,189 - Testing begins...
2024-07-22 11:06:23,834 - ***** Test: Confusion Matrix *****
2024-07-22 11:06:23,835 - [[  1   5   1   0   0   0   0   4   2   0   5   2]
 [  0  47   8   0   0   3   1   0   6   1  16   3]
 [  0  29  59   2   0   3  22   0  43   3  79   9]
 [  0   2   1  22   0   1   0   0   3   3   2   0]
 [  0  10   2   0  11   0   0   0   0   1   0   8]
 [  0   2   1   0   0  38   0   0   4   0   8   0]
 [  0   0   3   0   0   1  30   0  12   2   8   0]
 [  3   0   1   0   0   0   0  66   0   3   8   4]
 [  0  11   9   1   0   6   8   1 106   6  68   1]
 [  0   4  13   0   0   1   1   1   6 354  12   2]
 [  0  23  52   0   1  18  18   5 110  22 319  12]
 [  0  10  11   1   5  10   2   2  12   5  18  36]]
2024-07-22 11:06:23,835 - ***** Evaluation results *****
2024-07-22 11:06:23,836 -   acc = 0.5681
2024-07-22 11:06:23,836 -   f1 = 0.5017
2024-07-22 11:06:23,836 -   prec = 0.5331
2024-07-22 11:06:23,836 -   rec = 0.5099
2024-07-22 11:06:23,836 - Testing is finished...
2024-07-22 11:06:23,836 - Multimodal intent recognition is finished...
2024-07-22 11:06:23,836 - Results are saved in results/mmim_bert_MELD-DA.csv
