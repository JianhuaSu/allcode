2024-03-18 01:42:36,917 - ============================== Params ==============================
2024-03-18 01:42:36,918 - logger_name: mag_bert_MIntRec2_multi-class_seed-4_2024-03-18-01-42-36
2024-03-18 01:42:36,918 - dataset: MIntRec2
2024-03-18 01:42:36,918 - data_mode: multi-class
2024-03-18 01:42:36,918 - method: mag_bert
2024-03-18 01:42:36,918 - text_backbone: bert-base-uncased
2024-03-18 01:42:36,918 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-18 01:42:36,918 - seed: 4
2024-03-18 01:42:36,918 - num_workers: 8
2024-03-18 01:42:36,918 - gpu_id: 2
2024-03-18 01:42:36,918 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-18 01:42:36,918 - train: True
2024-03-18 01:42:36,918 - tune: True
2024-03-18 01:42:36,918 - save_model: False
2024-03-18 01:42:36,918 - save_results: True
2024-03-18 01:42:36,918 - log_path: logs
2024-03-18 01:42:36,918 - cache_path: 
2024-03-18 01:42:36,918 - video_data_path: video_data
2024-03-18 01:42:36,918 - audio_data_path: audio_data
2024-03-18 01:42:36,918 - video_feats_path: video_feats.pkl
2024-03-18 01:42:36,918 - audio_feats_path: audio_feats.pkl
2024-03-18 01:42:36,918 - results_path: results
2024-03-18 01:42:36,918 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-18 01:42:36,918 - model_path: models
2024-03-18 01:42:36,918 - config_file_name: mag_bert_MIntRec2
2024-03-18 01:42:36,918 - results_file_name: mag_bert.csv
2024-03-18 01:42:36,918 - padding_mode: zero
2024-03-18 01:42:36,918 - padding_loc: end
2024-03-18 01:42:36,918 - need_aligned: True
2024-03-18 01:42:36,918 - eval_monitor: f1
2024-03-18 01:42:36,918 - train_batch_size: 32
2024-03-18 01:42:36,918 - eval_batch_size: 16
2024-03-18 01:42:36,918 - test_batch_size: 16
2024-03-18 01:42:36,918 - wait_patience: 8
2024-03-18 01:42:36,918 - num_train_epochs: 100
2024-03-18 01:42:36,918 - beta_shift: 0.01
2024-03-18 01:42:36,918 - dropout_prob: 0.1
2024-03-18 01:42:36,918 - warmup_proportion: 0.05
2024-03-18 01:42:36,918 - lr: 9e-06
2024-03-18 01:42:36,918 - aligned_method: ctc
2024-03-18 01:42:36,918 - weight_decay: 0.03
2024-03-18 01:42:36,918 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-18-01-42-36
2024-03-18 01:42:36,918 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-18-01-42-36/models
2024-03-18 01:42:36,919 - num_labels: 30
2024-03-18 01:42:36,919 - text_feat_dim: 768
2024-03-18 01:42:36,919 - video_feat_dim: 256
2024-03-18 01:42:36,919 - audio_feat_dim: 768
2024-03-18 01:42:36,919 - text_seq_len: 50
2024-03-18 01:42:36,919 - video_seq_len: 180
2024-03-18 01:42:36,919 - audio_seq_len: 400
2024-03-18 01:42:36,919 - device: cuda:2
2024-03-18 01:42:36,919 - ============================== End Params ==============================
2024-03-18 01:42:36,931 - Generate Text Features Begin...
2024-03-18 01:42:38,596 - Generate Text Features Finished...
2024-03-18 01:42:38,598 - Load Video Features Begin...
2024-03-18 01:42:39,947 - Load Video Features Finished...
2024-03-18 01:42:41,976 - Load Audio Features Begin...
2024-03-18 01:42:47,241 - Load Audio Features Finished...
2024-03-18 01:43:00,579 - method  begins...
2024-03-18 01:43:01,870 - Multimodal intent recognition begins...
2024-03-18 01:43:01,870 - Training begins...
2024-03-18 01:43:35,496 - ***** Epoch: 1: Eval results *****
2024-03-18 01:43:35,496 -   train_loss = 3.2875
2024-03-18 01:43:35,496 -   best_eval_score = 0.0
2024-03-18 01:43:35,496 -   eval_score = 0.0518
2024-03-18 01:44:11,851 - ***** Epoch: 2: Eval results *****
2024-03-18 01:44:11,851 -   train_loss = 2.884
2024-03-18 01:44:11,851 -   best_eval_score = 0.0518
2024-03-18 01:44:11,851 -   eval_score = 0.1678
2024-03-18 01:44:46,764 - ***** Epoch: 3: Eval results *****
2024-03-18 01:44:46,764 -   train_loss = 2.4219
2024-03-18 01:44:46,764 -   best_eval_score = 0.1678
2024-03-18 01:44:46,764 -   eval_score = 0.2717
2024-03-18 01:45:22,323 - ***** Epoch: 4: Eval results *****
2024-03-18 01:45:22,323 -   train_loss = 1.9873
2024-03-18 01:45:22,323 -   best_eval_score = 0.2717
2024-03-18 01:45:22,323 -   eval_score = 0.3375
2024-03-18 01:45:58,354 - ***** Epoch: 5: Eval results *****
2024-03-18 01:45:58,355 -   train_loss = 1.6627
2024-03-18 01:45:58,355 -   best_eval_score = 0.3375
2024-03-18 01:45:58,355 -   eval_score = 0.3806
2024-03-18 01:46:33,648 - ***** Epoch: 6: Eval results *****
2024-03-18 01:46:33,648 -   train_loss = 1.4108
2024-03-18 01:46:33,648 -   best_eval_score = 0.3806
2024-03-18 01:46:33,648 -   eval_score = 0.4106
2024-03-18 01:47:09,150 - ***** Epoch: 7: Eval results *****
2024-03-18 01:47:09,150 -   train_loss = 1.2049
2024-03-18 01:47:09,150 -   best_eval_score = 0.4106
2024-03-18 01:47:09,150 -   eval_score = 0.4524
2024-03-18 01:47:46,737 - ***** Epoch: 8: Eval results *****
2024-03-18 01:47:46,737 -   train_loss = 1.0153
2024-03-18 01:47:46,737 -   best_eval_score = 0.4524
2024-03-18 01:47:46,737 -   eval_score = 0.4621
2024-03-18 01:48:23,031 - ***** Epoch: 9: Eval results *****
2024-03-18 01:48:23,031 -   train_loss = 0.864
2024-03-18 01:48:23,031 -   best_eval_score = 0.4621
2024-03-18 01:48:23,031 -   eval_score = 0.4801
2024-03-18 01:49:00,666 - ***** Epoch: 10: Eval results *****
2024-03-18 01:49:00,667 -   train_loss = 0.7282
2024-03-18 01:49:00,667 -   best_eval_score = 0.4801
2024-03-18 01:49:00,667 -   eval_score = 0.4846
2024-03-18 01:49:37,236 - ***** Epoch: 11: Eval results *****
2024-03-18 01:49:37,236 -   train_loss = 0.6252
2024-03-18 01:49:37,237 -   best_eval_score = 0.4846
2024-03-18 01:49:37,237 -   eval_score = 0.4922
2024-03-18 01:50:12,758 - ***** Epoch: 12: Eval results *****
2024-03-18 01:50:12,758 -   train_loss = 0.518
2024-03-18 01:50:12,758 -   best_eval_score = 0.4922
2024-03-18 01:50:12,758 -   eval_score = 0.4943
2024-03-18 01:50:48,544 - ***** Epoch: 13: Eval results *****
2024-03-18 01:50:48,544 -   train_loss = 0.4505
2024-03-18 01:50:48,545 -   best_eval_score = 0.4943
2024-03-18 01:50:48,545 -   eval_score = 0.4969
2024-03-18 01:51:23,647 - ***** Epoch: 14: Eval results *****
2024-03-18 01:51:23,647 -   train_loss = 0.3802
2024-03-18 01:51:23,647 -   best_eval_score = 0.4969
2024-03-18 01:51:23,647 -   eval_score = 0.4912
2024-03-18 01:51:23,648 - EarlyStopping counter: 1 out of 8
2024-03-18 01:51:59,908 - ***** Epoch: 15: Eval results *****
2024-03-18 01:51:59,912 -   train_loss = 0.3357
2024-03-18 01:51:59,913 -   best_eval_score = 0.4969
2024-03-18 01:51:59,913 -   eval_score = 0.4913
2024-03-18 01:51:59,913 - EarlyStopping counter: 2 out of 8
2024-03-18 01:52:34,523 - ***** Epoch: 16: Eval results *****
2024-03-18 01:52:34,523 -   train_loss = 0.286
2024-03-18 01:52:34,523 -   best_eval_score = 0.4969
2024-03-18 01:52:34,523 -   eval_score = 0.5032
2024-03-18 01:53:11,663 - ***** Epoch: 17: Eval results *****
2024-03-18 01:53:11,664 -   train_loss = 0.2373
2024-03-18 01:53:11,664 -   best_eval_score = 0.5032
2024-03-18 01:53:11,664 -   eval_score = 0.5048
2024-03-18 01:53:46,667 - ***** Epoch: 18: Eval results *****
2024-03-18 01:53:46,667 -   train_loss = 0.2095
2024-03-18 01:53:46,668 -   best_eval_score = 0.5048
2024-03-18 01:53:46,668 -   eval_score = 0.4959
2024-03-18 01:53:46,668 - EarlyStopping counter: 1 out of 8
2024-03-18 01:54:23,729 - ***** Epoch: 19: Eval results *****
2024-03-18 01:54:23,730 -   train_loss = 0.1844
2024-03-18 01:54:23,730 -   best_eval_score = 0.5048
2024-03-18 01:54:23,730 -   eval_score = 0.4973
2024-03-18 01:54:23,730 - EarlyStopping counter: 2 out of 8
2024-03-18 01:55:00,126 - ***** Epoch: 20: Eval results *****
2024-03-18 01:55:00,126 -   train_loss = 0.1616
2024-03-18 01:55:00,126 -   best_eval_score = 0.5048
2024-03-18 01:55:00,126 -   eval_score = 0.5101
2024-03-18 01:55:36,739 - ***** Epoch: 21: Eval results *****
2024-03-18 01:55:36,739 -   train_loss = 0.1427
2024-03-18 01:55:36,739 -   best_eval_score = 0.5101
2024-03-18 01:55:36,739 -   eval_score = 0.5132
2024-03-18 01:56:12,429 - ***** Epoch: 22: Eval results *****
2024-03-18 01:56:12,430 -   train_loss = 0.1276
2024-03-18 01:56:12,430 -   best_eval_score = 0.5132
2024-03-18 01:56:12,430 -   eval_score = 0.5013
2024-03-18 01:56:12,430 - EarlyStopping counter: 1 out of 8
2024-03-18 01:56:48,680 - ***** Epoch: 23: Eval results *****
2024-03-18 01:56:48,681 -   train_loss = 0.1188
2024-03-18 01:56:48,681 -   best_eval_score = 0.5132
2024-03-18 01:56:48,681 -   eval_score = 0.4869
2024-03-18 01:56:48,681 - EarlyStopping counter: 2 out of 8
2024-03-18 01:57:24,888 - ***** Epoch: 24: Eval results *****
2024-03-18 01:57:24,888 -   train_loss = 0.1004
2024-03-18 01:57:24,888 -   best_eval_score = 0.5132
2024-03-18 01:57:24,888 -   eval_score = 0.4903
2024-03-18 01:57:24,888 - EarlyStopping counter: 3 out of 8
2024-03-18 01:58:00,958 - ***** Epoch: 25: Eval results *****
2024-03-18 01:58:00,959 -   train_loss = 0.101
2024-03-18 01:58:00,959 -   best_eval_score = 0.5132
2024-03-18 01:58:00,959 -   eval_score = 0.5012
2024-03-18 01:58:00,959 - EarlyStopping counter: 4 out of 8
2024-03-18 01:58:36,628 - ***** Epoch: 26: Eval results *****
2024-03-18 01:58:36,628 -   train_loss = 0.0872
2024-03-18 01:58:36,628 -   best_eval_score = 0.5132
2024-03-18 01:58:36,629 -   eval_score = 0.5082
2024-03-18 01:58:36,629 - EarlyStopping counter: 5 out of 8
2024-03-18 01:59:13,193 - ***** Epoch: 27: Eval results *****
2024-03-18 01:59:13,193 -   train_loss = 0.0831
2024-03-18 01:59:13,193 -   best_eval_score = 0.5132
2024-03-18 01:59:13,193 -   eval_score = 0.5104
2024-03-18 01:59:13,194 - EarlyStopping counter: 6 out of 8
2024-03-18 01:59:50,019 - ***** Epoch: 28: Eval results *****
2024-03-18 01:59:50,019 -   train_loss = 0.0847
2024-03-18 01:59:50,019 -   best_eval_score = 0.5132
2024-03-18 01:59:50,019 -   eval_score = 0.5002
2024-03-18 01:59:50,019 - EarlyStopping counter: 7 out of 8
2024-03-18 02:00:26,720 - ***** Epoch: 29: Eval results *****
2024-03-18 02:00:26,720 -   train_loss = 0.0782
2024-03-18 02:00:26,720 -   best_eval_score = 0.5132
2024-03-18 02:00:26,720 -   eval_score = 0.5007
2024-03-18 02:00:26,720 - EarlyStopping counter: 8 out of 8
2024-03-18 02:00:26,720 - EarlyStopping at epoch 29
2024-03-18 02:00:26,722 - Training is finished...
2024-03-18 02:00:26,722 - Testing begins...
2024-03-18 02:00:35,090 - ***** Test: Confusion Matrix *****
2024-03-18 02:00:35,093 - [[ 50   0  12   0   0   0   0   0   1   0   2   0   0   1   0   0   0   0
    0   0   0   0   0   1   1   0   0   0   0   0]
 [  0  56   0   0  10   1   2   0   1   0   2   0   3   0   3   0   0  10
    1   3   0   0   1   0   1   0   0   3   0   0]
 [ 11   1  42   0   0   0   0   0   0   0   1   0   0   1   0   0   0   4
    0   0   0   0   0   1   3   0   0   0   0   0]
 [  0   0   0  60   0   0   0   1   0   0   0   0   0   0   2   0   0   2
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   4   0   0  33   0   0   0   1   0   0   0   0   0   0   0   0   2
    0   3   0   1   0   2   1   0   0   0   1   3]
 [  0   0   0   0   1  27   0   0   0   1   1   0   0   0   1   0   0   5
    0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   1   0   0   0   4  26   9   0   0   3   0   5   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   1   0   0   0   0   5  23   0   2   4   0   8   0   0   0   1   1
    0   0   0   0   0   0   0   0   0   2   0   0]
 [  1   3   2   3   1   0   0   0  22   3   0   1   1   1   1   0   0   5
    0   0   0   0   3   0   2   0   0   0   0   0]
 [  0   1   1   0   1   0   1   0   3  47   0   7   9   2   9   1   0  11
    1   0   2   3   2   0   2   0   0   3   0   1]
 [  2   0   0   0   0   4   1   2   0   1  37   0  38   0   2   0   0   2
    0   3   0   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   0   1   0   6   1  20   7   0   1   0   0   1
    1   0   1   0   3   0   0   0   0   3   0   2]
 [  0   2   1   0   0   2   3  10   0   5  16   1  91   1   0   0   1   0
    0   1   0   0   1   0   0   0   0   0   0   0]
 [  0   0   2   0   1   0   0   0   1   1   0   0   0   2   2   1   0   4
    2   0   0   0   1   0   0   0   0   0   0   0]
 [  0   2   2   0   0   2   0   0   5  10   1   0   2   4 102   0   0  40
    4   1   1   0  11   0   3   0   0   3   0   0]
 [  0   0   1   0   1   0   0   0   0   4   0   0   0   1   0   4   0   3
    2   0   1   1   2   0   0   0   0   1   1   0]
 [  0   0   0   0   1   0   0   2   0   0   2   0   1   0   0   0  57   0
    2   1   0   0   0   0   0   0   0   0   0   0]
 [  0   4   2   0   7   5   0   0   2  10   0   0   1   4  12   1   1 134
    6   1   4   2   5   9   0   1   2   0   1   3]
 [  0   1   0   0   0   0   0   0   0   4   2   0   0   3   5   1   1  11
   27   0   2   0   1   0   1   0   0   1   0   0]
 [  0   4   0   0   1   0   3   0   0   0   1   0   0   0   0   0   0   0
    0   7   0   1   0   0   0   0   0   0   0   0]
 [  0   1   2   0   1   0   0   0   0   1   0   0   1   0   3   0   0   5
    4   0   6   0   0   0   3   0   0   1   0   1]
 [  7   1   0   0   0   0   0   0   0   2   0   0   0   0   1   0   4   0
    0   1   0  25   0   5   0   0   1   3   0   3]
 [  0   1   2   1   1   0   0   0   0   3   0   3   0   1   7   1   0   5
    0   0   0   0  81   0   1   1   8   1   0   0]
 [  0   2   2   0   1   0   0   0   0   2   0   0   0   0   1   0   0   9
    0   0   0   4   0  17   0   0   0   0   0   0]
 [  2   0   1   0   0   0   0   0   0   3   0   1   0   1   1   1   0   6
    0   0   0   0   1   0  88   0   0   7   1   0]
 [  1   1   0   0   1   0   0   0   0   0   0   0   1   0   0   0   0   2
    0   0   0   0   3   0   1  18   1   0   0   2]
 [  0   0   0   1   0   0   0   0   0   2   0   0   0   0   1   0   0   3
    0   0   0   1   2   1   0   0   5   0   1   0]
 [  0   3   1   0   0   0   0   1   2   5   2   4   3   1   3   0   0   4
    1   0   1   0   2   0   9   1   0  11   1   3]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
    0   0   0   0   0   0   0   0   1   0  56   0]
 [  0   2   0   0   1   0   0   0   1   1   1   1   0   0   0   0   0   4
    1   0   0   0   0   0   1   1   0   0   0   5]]
2024-03-18 02:00:35,094 - ***** Evaluation results *****
2024-03-18 02:00:35,094 -   acc = 0.5799
2024-03-18 02:00:35,094 -   f1 = 0.5278
2024-03-18 02:00:35,094 -   prec = 0.5423
2024-03-18 02:00:35,094 -   rec = 0.5249
2024-03-18 02:00:35,094 - Testing is finished...
2024-03-18 02:00:35,094 - Multimodal intent recognition is finished...
2024-03-18 02:00:35,094 - Results are saved in results/mag_bert.csv
