2024-01-06 10:17:16,259 - ============================== Params ==============================
2024-01-06 10:17:16,259 - logger_name: msz_MIntRec_multi-class_seed-1_2024-01-06-10-17-16
2024-01-06 10:17:16,259 - dataset: MIntRec
2024-01-06 10:17:16,259 - data_mode: multi-class
2024-01-06 10:17:16,259 - method: msz
2024-01-06 10:17:16,259 - text_backbone: bert-base-uncased
2024-01-06 10:17:16,259 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-06 10:17:16,259 - seed: 1
2024-01-06 10:17:16,259 - num_workers: 8
2024-01-06 10:17:16,259 - gpu_id: 1
2024-01-06 10:17:16,260 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-06 10:17:16,260 - train: True
2024-01-06 10:17:16,260 - tune: False
2024-01-06 10:17:16,260 - save_model: False
2024-01-06 10:17:16,260 - save_results: True
2024-01-06 10:17:16,260 - log_path: logs
2024-01-06 10:17:16,260 - cache_path: 
2024-01-06 10:17:16,260 - video_data_path: video_data
2024-01-06 10:17:16,260 - audio_data_path: audio_data
2024-01-06 10:17:16,260 - video_feats_path: video_feats.pkl
2024-01-06 10:17:16,260 - audio_feats_path: audio_feats.pkl
2024-01-06 10:17:16,260 - results_path: results
2024-01-06 10:17:16,260 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-06 10:17:16,260 - model_path: models
2024-01-06 10:17:16,260 - config_file_name: msz
2024-01-06 10:17:16,260 - results_file_name: msz.csv
2024-01-06 10:17:16,260 - padding_mode: zero
2024-01-06 10:17:16,260 - padding_loc: end
2024-01-06 10:17:16,260 - need_aligned: False
2024-01-06 10:17:16,260 - eval_monitor: f1
2024-01-06 10:17:16,260 - train_batch_size: 16
2024-01-06 10:17:16,260 - eval_batch_size: 8
2024-01-06 10:17:16,260 - test_batch_size: 8
2024-01-06 10:17:16,260 - wait_patience: 8
2024-01-06 10:17:16,260 - nheads: 2
2024-01-06 10:17:16,260 - encoder_layers: 2
2024-01-06 10:17:16,260 - attn_dropout: 0.1
2024-01-06 10:17:16,260 - relu_dropout: 0.1
2024-01-06 10:17:16,260 - embed_dropout: 0.1
2024-01-06 10:17:16,260 - res_dropout: 0.1
2024-01-06 10:17:16,260 - attn_mask: False
2024-01-06 10:17:16,260 - hidden_size: 768
2024-01-06 10:17:16,260 - num_attention_heads: 12
2024-01-06 10:17:16,260 - attention_probs_dropout_prob: 0.2
2024-01-06 10:17:16,260 - hidden_dropout_prob: 0.2
2024-01-06 10:17:16,260 - intermediate_size: 768
2024-01-06 10:17:16,261 - num_hidden_layers: 3
2024-01-06 10:17:16,261 - max_position_embeddings: 512
2024-01-06 10:17:16,261 - position_embedding_type: absolute
2024-01-06 10:17:16,261 - batch_first: True
2024-01-06 10:17:16,261 - hidden_dims: 768
2024-01-06 10:17:16,261 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-06 10:17:16,261 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-06 10:17:16,261 - ta_loss: 0.1
2024-01-06 10:17:16,261 - tv_loss: 0.1
2024-01-06 10:17:16,261 - av_loss: 0.1
2024-01-06 10:17:16,261 - aligned_method: conv1d
2024-01-06 10:17:16,261 - grad_clip: -1
2024-01-06 10:17:16,261 - num_train_epochs: 100
2024-01-06 10:17:16,261 - warmup_proportion: 0.1
2024-01-06 10:17:16,261 - lr: 1e-05
2024-01-06 10:17:16,261 - weight_decay: 0.01
2024-01-06 10:17:16,261 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-06-10-17-16
2024-01-06 10:17:16,261 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-06-10-17-16/models
2024-01-06 10:17:16,261 - ============================== End Params ==============================
2024-01-06 10:17:16,264 - Generate Text Features Begin...
2024-01-06 10:17:16,767 - Generate Text Features Finished...
2024-01-06 10:17:16,767 - Load Video Features Begin...
2024-01-06 10:17:17,095 - Load Video Features Finished...
2024-01-06 10:17:17,689 - Load Audio Features Begin...
2024-01-06 10:17:19,089 - Load Audio Features Finished...
2024-01-06 10:17:22,688 - method  begins...
2024-01-06 10:17:26,236 - Multimodal intent recognition begins...
2024-01-06 10:17:26,236 - Training begins...
2024-01-06 10:17:45,092 - ***** Epoch: 1: Eval results *****
2024-01-06 10:17:45,092 -   train_loss = 3.0246
2024-01-06 10:17:45,092 -   best_eval_score = 0.0
2024-01-06 10:17:45,092 -   eval_score = 0.0387
2024-01-06 10:18:01,933 - ***** Epoch: 2: Eval results *****
2024-01-06 10:18:01,933 -   train_loss = 2.7898
2024-01-06 10:18:01,933 -   best_eval_score = 0.0387
2024-01-06 10:18:01,933 -   eval_score = 0.1627
2024-01-06 10:18:18,966 - ***** Epoch: 3: Eval results *****
2024-01-06 10:18:18,968 -   train_loss = 2.4359
2024-01-06 10:18:18,968 -   best_eval_score = 0.1627
2024-01-06 10:18:18,968 -   eval_score = 0.1633
2024-01-06 10:18:36,168 - ***** Epoch: 4: Eval results *****
2024-01-06 10:18:36,168 -   train_loss = 2.1913
2024-01-06 10:18:36,168 -   best_eval_score = 0.1633
2024-01-06 10:18:36,168 -   eval_score = 0.2401
2024-01-06 10:18:53,235 - ***** Epoch: 5: Eval results *****
2024-01-06 10:18:53,235 -   train_loss = 1.9066
2024-01-06 10:18:53,235 -   best_eval_score = 0.2401
2024-01-06 10:18:53,235 -   eval_score = 0.2559
2024-01-06 10:19:10,166 - ***** Epoch: 6: Eval results *****
2024-01-06 10:19:10,167 -   train_loss = 1.8952
2024-01-06 10:19:10,167 -   best_eval_score = 0.2559
2024-01-06 10:19:10,167 -   eval_score = 0.2696
2024-01-06 10:19:27,435 - ***** Epoch: 7: Eval results *****
2024-01-06 10:19:27,436 -   train_loss = 1.9206
2024-01-06 10:19:27,436 -   best_eval_score = 0.2696
2024-01-06 10:19:27,436 -   eval_score = 0.3328
2024-01-06 10:19:44,381 - ***** Epoch: 8: Eval results *****
2024-01-06 10:19:44,381 -   train_loss = 1.8539
2024-01-06 10:19:44,381 -   best_eval_score = 0.3328
2024-01-06 10:19:44,381 -   eval_score = 0.3078
2024-01-06 10:19:44,381 - EarlyStopping counter: 1 out of 8
2024-01-06 10:20:01,468 - ***** Epoch: 9: Eval results *****
2024-01-06 10:20:01,470 -   train_loss = 2.0448
2024-01-06 10:20:01,470 -   best_eval_score = 0.3328
2024-01-06 10:20:01,470 -   eval_score = 0.2099
2024-01-06 10:20:01,470 - EarlyStopping counter: 2 out of 8
2024-01-06 10:20:18,475 - ***** Epoch: 10: Eval results *****
2024-01-06 10:20:18,475 -   train_loss = 2.6943
2024-01-06 10:20:18,475 -   best_eval_score = 0.3328
2024-01-06 10:20:18,475 -   eval_score = 0.1077
2024-01-06 10:20:18,475 - EarlyStopping counter: 3 out of 8
2024-01-06 10:20:35,412 - ***** Epoch: 11: Eval results *****
2024-01-06 10:20:35,412 -   train_loss = 2.9423
2024-01-06 10:20:35,412 -   best_eval_score = 0.3328
2024-01-06 10:20:35,412 -   eval_score = 0.0397
2024-01-06 10:20:35,412 - EarlyStopping counter: 4 out of 8
2024-01-06 10:20:52,347 - ***** Epoch: 12: Eval results *****
2024-01-06 10:20:52,349 -   train_loss = 3.4183
2024-01-06 10:20:52,349 -   best_eval_score = 0.3328
2024-01-06 10:20:52,349 -   eval_score = 0.0026
2024-01-06 10:20:52,349 - EarlyStopping counter: 5 out of 8
2024-01-06 10:21:09,320 - ***** Epoch: 13: Eval results *****
2024-01-06 10:21:09,321 -   train_loss = 3.2484
2024-01-06 10:21:09,321 -   best_eval_score = 0.3328
2024-01-06 10:21:09,321 -   eval_score = 0.0114
2024-01-06 10:21:09,321 - EarlyStopping counter: 6 out of 8
2024-01-06 10:21:26,201 - ***** Epoch: 14: Eval results *****
2024-01-06 10:21:26,202 -   train_loss = 2.9514
2024-01-06 10:21:26,202 -   best_eval_score = 0.3328
2024-01-06 10:21:26,202 -   eval_score = 0.0114
2024-01-06 10:21:26,202 - EarlyStopping counter: 7 out of 8
2024-01-06 10:21:43,194 - ***** Epoch: 15: Eval results *****
2024-01-06 10:21:43,195 -   train_loss = 2.8966
2024-01-06 10:21:43,195 -   best_eval_score = 0.3328
2024-01-06 10:21:43,195 -   eval_score = 0.0114
2024-01-06 10:21:43,195 - EarlyStopping counter: 8 out of 8
2024-01-06 10:21:43,195 - EarlyStopping at epoch 15
2024-01-06 10:21:43,196 - Training is finished...
2024-01-06 10:21:43,196 - Testing begins...
2024-01-06 10:21:46,528 - ***** Test: Confusion Matrix *****
2024-01-06 10:21:46,531 - [[40  4  0  0  7  1  0  0  0  0  0  0  0  1  0  0  0  4  0  0]
 [ 1 39  0  0  2  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0]
 [ 0  0 20  0  1  0  0  0  0  0  0  1  0  2  0  0  1  2  0  0]
 [ 0  2  0 22  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0]
 [ 8  3  0  0  7  0  0  0  0  0  0  1  0  1  0  0  1  2  0  0]
 [ 0  0  0  0  1 10  0  0  0  0  0  0  0  1  0  0  0  0  0  0]
 [ 5  1  0  0  0  1  0  0  0  0  0  1  0  1  0  0  1  2  0  0]
 [ 4  3  0  0  2  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0]
 [ 3  3  0  0  0  0  0  0  0  0  0  0  0  4  0  0  0  0  0  0]
 [ 5  1  0  0  2  0  0  0  0  0  0  0  0  0  0  0  0  2  0  0]
 [ 3  0  0  0  5  1  0  0  0  0  0  4  0  0  0  0  0  5  0  0]
 [ 2  1  0  0  1  1  0  0  0  0  0 13  0  0  0  0  1  0  0  0]
 [22  4  0  0  4  2  0  0  0  0  0  4  0 13  0  0  5  1  2  0]
 [ 2  0  0  0  0  0  0  0  0  0  0  1  0 20  0  0  0  2  0  0]
 [ 2  0  0  0  0  0  0  0  0  0  0  1  0 17  0  0  1  1  0  0]
 [17  1  0  1  0  1  0  0  0  0  0  0  0  1  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  0  9  0  0  7  0  0  0]
 [ 1  0  0  0  3  0  0  0  0  0  0  0  0  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  1  0  0  7  0  0  1  1  0  0]]
2024-01-06 10:21:46,531 - ***** Evaluation results *****
2024-01-06 10:21:46,531 -   acc = 0.4449
2024-01-06 10:21:46,531 -   f1 = 0.3242
2024-01-06 10:21:46,531 -   prec = 0.2992
2024-01-06 10:21:46,532 -   rec = 0.3873
2024-01-06 10:21:46,532 - Testing is finished...
2024-01-06 10:21:46,532 - Multimodal intent recognition is finished...
2024-01-06 10:21:46,532 - Results are saved in results/msz.csv
