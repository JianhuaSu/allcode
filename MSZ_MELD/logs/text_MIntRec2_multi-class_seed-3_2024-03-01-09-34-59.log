2024-03-01 09:34:59,864 - ============================== Params ==============================
2024-03-01 09:34:59,864 - logger_name: text_MIntRec2_multi-class_seed-3_2024-03-01-09-34-59
2024-03-01 09:34:59,864 - dataset: MIntRec2
2024-03-01 09:34:59,864 - data_mode: multi-class
2024-03-01 09:34:59,864 - method: text
2024-03-01 09:34:59,864 - text_backbone: bert-base-uncased
2024-03-01 09:34:59,865 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-01 09:34:59,865 - seed: 3
2024-03-01 09:34:59,865 - num_workers: 8
2024-03-01 09:34:59,865 - gpu_id: 2
2024-03-01 09:34:59,865 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-01 09:34:59,865 - train: True
2024-03-01 09:34:59,865 - tune: True
2024-03-01 09:34:59,865 - save_model: False
2024-03-01 09:34:59,865 - save_results: True
2024-03-01 09:34:59,865 - log_path: logs
2024-03-01 09:34:59,865 - cache_path: 
2024-03-01 09:34:59,865 - video_data_path: video_data
2024-03-01 09:34:59,865 - audio_data_path: audio_data
2024-03-01 09:34:59,865 - video_feats_path: video_feats.pkl
2024-03-01 09:34:59,865 - audio_feats_path: audio_feats.pkl
2024-03-01 09:34:59,865 - results_path: results
2024-03-01 09:34:59,865 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-01 09:34:59,865 - model_path: models
2024-03-01 09:34:59,865 - config_file_name: text_bert_MIntRec2
2024-03-01 09:34:59,865 - results_file_name: text_bert.csv
2024-03-01 09:34:59,865 - padding_mode: zero
2024-03-01 09:34:59,865 - padding_loc: end
2024-03-01 09:34:59,865 - eval_monitor: f1
2024-03-01 09:34:59,865 - train_batch_size: 16
2024-03-01 09:34:59,865 - eval_batch_size: 8
2024-03-01 09:34:59,865 - test_batch_size: 8
2024-03-01 09:34:59,865 - wait_patience: 8
2024-03-01 09:34:59,865 - num_train_epochs: 100
2024-03-01 09:34:59,865 - warmup_proportion: 0.1
2024-03-01 09:34:59,865 - lr: 2e-05
2024-03-01 09:34:59,865 - weight_decay: 0.1
2024-03-01 09:34:59,865 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/text_MIntRec2_multi-class_seed-3_2024-03-01-09-34-59
2024-03-01 09:34:59,865 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/text_MIntRec2_multi-class_seed-3_2024-03-01-09-34-59/models
2024-03-01 09:34:59,865 - num_labels: 30
2024-03-01 09:34:59,865 - text_feat_dim: 768
2024-03-01 09:34:59,865 - video_feat_dim: 256
2024-03-01 09:34:59,865 - audio_feat_dim: 768
2024-03-01 09:34:59,865 - text_seq_len: 50
2024-03-01 09:34:59,865 - video_seq_len: 180
2024-03-01 09:34:59,865 - audio_seq_len: 400
2024-03-01 09:34:59,865 - ============================== End Params ==============================
2024-03-01 09:34:59,918 - Generate Text Features Begin...
2024-03-01 09:35:01,553 - Generate Text Features Finished...
2024-03-01 09:35:01,554 - Load Video Features Begin...
2024-03-01 09:35:05,974 - Load Video Features Finished...
2024-03-01 09:35:07,858 - Load Audio Features Begin...
2024-03-01 09:36:35,852 - Load Audio Features Finished...
2024-03-01 09:36:48,768 - method  begins...
2024-03-01 09:36:49,721 - text_data loading complete...
2024-03-01 09:36:49,721 - Multimodal intent recognition begins...
2024-03-01 09:36:49,721 - Training begins...
2024-03-01 09:37:24,606 - ***** Epoch: 1: Eval results *****
2024-03-01 09:37:24,606 -   train_loss = 3.2997
2024-03-01 09:37:24,606 -   best_eval_score = 0.0
2024-03-01 09:37:24,606 -   eval_score = 0.0685
2024-03-01 09:37:59,459 - ***** Epoch: 2: Eval results *****
2024-03-01 09:37:59,459 -   train_loss = 2.8332
2024-03-01 09:37:59,459 -   best_eval_score = 0.0685
2024-03-01 09:37:59,460 -   eval_score = 0.22
2024-03-01 09:38:34,427 - ***** Epoch: 3: Eval results *****
2024-03-01 09:38:34,436 -   train_loss = 2.2768
2024-03-01 09:38:34,436 -   best_eval_score = 0.22
2024-03-01 09:38:34,436 -   eval_score = 0.3083
2024-03-01 09:39:07,236 - ***** Epoch: 4: Eval results *****
2024-03-01 09:39:07,237 -   train_loss = 1.8211
2024-03-01 09:39:07,237 -   best_eval_score = 0.3083
2024-03-01 09:39:07,237 -   eval_score = 0.3607
2024-03-01 09:39:42,760 - ***** Epoch: 5: Eval results *****
2024-03-01 09:39:42,761 -   train_loss = 1.488
2024-03-01 09:39:42,761 -   best_eval_score = 0.3607
2024-03-01 09:39:42,761 -   eval_score = 0.4229
2024-03-01 09:40:16,363 - ***** Epoch: 6: Eval results *****
2024-03-01 09:40:16,364 -   train_loss = 1.2107
2024-03-01 09:40:16,364 -   best_eval_score = 0.4229
2024-03-01 09:40:16,364 -   eval_score = 0.4471
2024-03-01 09:40:50,800 - ***** Epoch: 7: Eval results *****
2024-03-01 09:40:50,800 -   train_loss = 0.9592
2024-03-01 09:40:50,801 -   best_eval_score = 0.4471
2024-03-01 09:40:50,801 -   eval_score = 0.4694
2024-03-01 09:41:25,747 - ***** Epoch: 8: Eval results *****
2024-03-01 09:41:25,748 -   train_loss = 0.7128
2024-03-01 09:41:25,748 -   best_eval_score = 0.4694
2024-03-01 09:41:25,748 -   eval_score = 0.4737
2024-03-01 09:42:00,834 - ***** Epoch: 9: Eval results *****
2024-03-01 09:42:00,834 -   train_loss = 0.5394
2024-03-01 09:42:00,835 -   best_eval_score = 0.4737
2024-03-01 09:42:00,835 -   eval_score = 0.5013
2024-03-01 09:42:34,343 - ***** Epoch: 10: Eval results *****
2024-03-01 09:42:34,343 -   train_loss = 0.3799
2024-03-01 09:42:34,343 -   best_eval_score = 0.5013
2024-03-01 09:42:34,343 -   eval_score = 0.5189
2024-03-01 09:43:09,066 - ***** Epoch: 11: Eval results *****
2024-03-01 09:43:09,066 -   train_loss = 0.2737
2024-03-01 09:43:09,067 -   best_eval_score = 0.5189
2024-03-01 09:43:09,067 -   eval_score = 0.4998
2024-03-01 09:43:09,067 - EarlyStopping counter: 1 out of 8
2024-03-01 09:43:43,525 - ***** Epoch: 12: Eval results *****
2024-03-01 09:43:43,525 -   train_loss = 0.1937
2024-03-01 09:43:43,525 -   best_eval_score = 0.5189
2024-03-01 09:43:43,525 -   eval_score = 0.5085
2024-03-01 09:43:43,525 - EarlyStopping counter: 2 out of 8
2024-03-01 09:44:18,261 - ***** Epoch: 13: Eval results *****
2024-03-01 09:44:18,261 -   train_loss = 0.1532
2024-03-01 09:44:18,261 -   best_eval_score = 0.5189
2024-03-01 09:44:18,262 -   eval_score = 0.4984
2024-03-01 09:44:18,262 - EarlyStopping counter: 3 out of 8
2024-03-01 09:44:51,246 - ***** Epoch: 14: Eval results *****
2024-03-01 09:44:51,246 -   train_loss = 0.1211
2024-03-01 09:44:51,246 -   best_eval_score = 0.5189
2024-03-01 09:44:51,246 -   eval_score = 0.4698
2024-03-01 09:44:51,246 - EarlyStopping counter: 4 out of 8
2024-03-01 09:45:25,826 - ***** Epoch: 15: Eval results *****
2024-03-01 09:45:25,826 -   train_loss = 0.1082
2024-03-01 09:45:25,826 -   best_eval_score = 0.5189
2024-03-01 09:45:25,826 -   eval_score = 0.4879
2024-03-01 09:45:25,827 - EarlyStopping counter: 5 out of 8
2024-03-01 09:45:59,147 - ***** Epoch: 16: Eval results *****
2024-03-01 09:45:59,147 -   train_loss = 0.0884
2024-03-01 09:45:59,147 -   best_eval_score = 0.5189
2024-03-01 09:45:59,147 -   eval_score = 0.4839
2024-03-01 09:45:59,147 - EarlyStopping counter: 6 out of 8
2024-03-01 09:46:33,297 - ***** Epoch: 17: Eval results *****
2024-03-01 09:46:33,297 -   train_loss = 0.0858
2024-03-01 09:46:33,297 -   best_eval_score = 0.5189
2024-03-01 09:46:33,297 -   eval_score = 0.5071
2024-03-01 09:46:33,297 - EarlyStopping counter: 7 out of 8
2024-03-01 09:47:07,711 - ***** Epoch: 18: Eval results *****
2024-03-01 09:47:07,711 -   train_loss = 0.0868
2024-03-01 09:47:07,711 -   best_eval_score = 0.5189
2024-03-01 09:47:07,711 -   eval_score = 0.4876
2024-03-01 09:47:07,712 - EarlyStopping counter: 8 out of 8
2024-03-01 09:47:07,712 - EarlyStopping at epoch 18
2024-03-01 09:47:07,714 - Training is finished...
2024-03-01 09:47:07,714 - Testing begins...
2024-03-01 09:47:14,129 - ***** Test: Confusion Matrix *****
2024-03-01 09:47:14,132 - [[ 53   0   8   0   0   0   0   0   0   1   2   0   0   0   0   1   0   1
    0   0   0   0   0   1   1   0   0   0   0   0]
 [  0  49   0   0  10   2   6   0   1   0   2   0   2   0   3   0   0  10
    2   2   0   1   1   0   2   0   0   4   0   0]
 [ 14   1  34   0   0   0   0   0   0   1   1   0   0   1   0   0   0   4
    1   0   0   2   0   2   3   0   0   0   0   0]
 [  0   0   0  62   0   0   0   1   0   0   0   0   0   0   1   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   1]
 [  0   3   0   0  28   2   0   0   0   0   0   0   0   0   0   0   0   9
    0   0   0   5   0   1   1   0   0   1   0   1]
 [  0   0   0   0   2  21   0   0   0   2   1   0   1   0   1   0   0   6
    0   1   0   0   0   1   0   0   1   0   0   0]
 [  0   0   0   0   0   3  23   9   0   2   3   1   6   0   0   0   0   0
    0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   5  26   0   1   6   0   6   0   0   0   1   0
    0   1   0   0   0   0   0   0   0   1   0   0]
 [  1   3   1   3   1   0   0   0  21   2   0   0   1   0   7   1   0   3
    0   0   0   0   3   0   2   0   0   0   0   0]
 [  0   0   1   0   1   0   0   0   2  50   0   6  10   1  13   1   0   9
    2   0   0   1   2   1   4   1   0   1   0   1]
 [  2   0   0   0   0   3   2   3   0   0  43   0  34   0   2   0   0   2
    0   1   0   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   1   1   1  10   1  17   7   0   1   0   0   1
    1   0   0   0   2   0   1   0   1   1   0   1]
 [  0   0   0   0   0   1   3   9   1   4  24   1  87   0   1   0   1   0
    0   1   0   1   0   0   0   0   0   1   0   0]
 [  0   0   2   0   0   0   0   0   1   1   0   0   0   1   6   0   0   3
    2   0   0   0   0   0   0   0   0   1   0   0]
 [  0   1   0   0   0   1   0   0   5  11   2   1   1   1 123   0   0  31
    1   0   0   0   6   1   6   1   0   1   0   0]
 [  0   0   1   0   1   0   0   0   0   4   0   0   0   1   1   4   0   5
    2   0   0   1   1   0   0   0   0   0   1   0]
 [  0   0   0   0   1   0   0   1   0   0   0   0   1   1   0   0  56   1
    5   0   0   0   0   0   0   0   0   0   0   0]
 [  0   3   1   0   6   4   0   0   2  10   2   2   0   0  20   0   1 128
   12   1   0   3   9   5   2   1   0   3   1   1]
 [  0   1   0   0   0   0   0   0   0   4   2   0   0   1   5   0   1  14
   27   1   1   0   0   0   3   0   0   0   0   0]
 [  0   3   0   0   1   0   2   0   0   0   2   0   0   0   0   0   0   0
    0   7   0   2   0   0   0   0   0   0   0   0]
 [  0   1   2   0   1   0   0   0   1   1   0   1   1   0   7   0   0   5
    5   0   1   0   0   0   1   0   0   1   0   1]
 [  6   0   0   0   1   0   0   0   1   4   0   0   0   0   1   0   4   1
    0   1   0  25   0   6   1   0   0   1   0   1]
 [  0   0   1   0   0   0   0   0   1   5   0   3   0   2  10   0   0   6
    0   0   0   2  76   0   1   5   3   1   0   1]
 [  0   3   1   0   1   0   0   0   0   3   0   0   0   0   1   0   0   8
    0   0   0   3   0  17   0   0   1   0   0   0]
 [  2   0   0   0   0   0   0   0   2   1   1   0   0   0   1   0   0   2
    1   0   0   0   1   0  98   0   0   3   1   0]
 [  1   0   0   0   1   0   0   1   0   1   0   0   0   0   0   0   0   2
    0   0   0   0   3   0   1  20   0   0   0   1]
 [  0   0   0   0   0   0   0   0   0   3   0   0   0   0   1   0   0   3
    0   0   0   2   3   0   0   0   3   0   2   0]
 [  0   2   0   0   0   0   0   0   2   6   2   6   4   1   3   0   0   4
    1   0   0   0   1   0  13   1   1   8   1   2]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0
    0   0   0   0   0   0   0   0   1   0  56   0]
 [  0   0   0   0   0   0   0   0   2   1   1   2   0   0   0   0   0   4
    1   0   0   0   0   0   1   1   0   0   0   6]]
2024-03-01 09:47:14,132 - ***** Evaluation results *****
2024-03-01 09:47:14,132 -   acc = 0.5755
2024-03-01 09:47:14,132 -   f1 = 0.51
2024-03-01 09:47:14,132 -   prec = 0.5415
2024-03-01 09:47:14,132 -   rec = 0.5057
2024-03-01 09:47:14,133 - Testing is finished...
2024-03-01 09:47:14,133 - Multimodal intent recognition is finished...
2024-03-01 09:47:14,133 - Results are saved in results/text_bert.csv
