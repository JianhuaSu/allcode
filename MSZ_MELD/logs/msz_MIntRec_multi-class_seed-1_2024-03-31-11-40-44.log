2024-03-31 11:40:44,765 - ============================== Params ==============================
2024-03-31 11:40:44,765 - logger_name: msz_MIntRec_multi-class_seed-1_2024-03-31-11-40-44
2024-03-31 11:40:44,765 - dataset: MIntRec
2024-03-31 11:40:44,765 - data_mode: multi-class
2024-03-31 11:40:44,765 - method: msz
2024-03-31 11:40:44,765 - text_backbone: bert-base-uncased
2024-03-31 11:40:44,765 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-31 11:40:44,765 - seed: 1
2024-03-31 11:40:44,766 - num_workers: 8
2024-03-31 11:40:44,766 - gpu_id: 3
2024-03-31 11:40:44,766 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-31 11:40:44,766 - train: True
2024-03-31 11:40:44,766 - tune: True
2024-03-31 11:40:44,766 - save_model: False
2024-03-31 11:40:44,766 - save_results: True
2024-03-31 11:40:44,766 - log_path: logs
2024-03-31 11:40:44,766 - cache_path: 
2024-03-31 11:40:44,766 - video_data_path: video_data
2024-03-31 11:40:44,766 - audio_data_path: audio_data
2024-03-31 11:40:44,766 - video_feats_path: video_feats.pkl
2024-03-31 11:40:44,766 - audio_feats_path: audio_feats.pkl
2024-03-31 11:40:44,766 - results_path: results
2024-03-31 11:40:44,766 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-03-31 11:40:44,766 - model_path: models
2024-03-31 11:40:44,766 - config_file_name: msz_MIntRec
2024-03-31 11:40:44,766 - results_file_name: msz.csv
2024-03-31 11:40:44,766 - padding_mode: zero
2024-03-31 11:40:44,766 - padding_loc: end
2024-03-31 11:40:44,766 - need_aligned: False
2024-03-31 11:40:44,766 - eval_monitor: f1
2024-03-31 11:40:44,766 - train_batch_size: 16
2024-03-31 11:40:44,766 - eval_batch_size: 8
2024-03-31 11:40:44,766 - test_batch_size: 8
2024-03-31 11:40:44,766 - wait_patience: 8
2024-03-31 11:40:44,766 - hidden_dims: 768
2024-03-31 11:40:44,766 - num_attention_heads: 8
2024-03-31 11:40:44,766 - attention_probs_dropout_prob: 0.5
2024-03-31 11:40:44,766 - hidden_dropout_prob: 0.2
2024-03-31 11:40:44,766 - intermediate_size: 768
2024-03-31 11:40:44,766 - num_hidden_layers: 6
2024-03-31 11:40:44,766 - max_position_embeddings: 768
2024-03-31 11:40:44,766 - position_embedding_type: absolute
2024-03-31 11:40:44,766 - batch_first: True
2024-03-31 11:40:44,766 - dropout: 0.1
2024-03-31 11:40:44,766 - aligned_method: conv1d
2024-03-31 11:40:44,766 - num_train_epochs: 100
2024-03-31 11:40:44,767 - lr: 8e-06
2024-03-31 11:40:44,767 - lr_mode: max
2024-03-31 11:40:44,767 - patience: 8
2024-03-31 11:40:44,767 - factor: 0.1
2024-03-31 11:40:44,767 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-03-31-11-40-44
2024-03-31 11:40:44,767 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-03-31-11-40-44/models
2024-03-31 11:40:44,767 - num_labels: 20
2024-03-31 11:40:44,767 - text_feat_dim: 768
2024-03-31 11:40:44,767 - video_feat_dim: 256
2024-03-31 11:40:44,767 - audio_feat_dim: 768
2024-03-31 11:40:44,767 - text_seq_len: 30
2024-03-31 11:40:44,767 - video_seq_len: 230
2024-03-31 11:40:44,767 - audio_seq_len: 480
2024-03-31 11:40:44,767 - device: cuda:3
2024-03-31 11:40:44,767 - ============================== End Params ==============================
2024-03-31 11:40:44,821 - Generate Text Features Begin...
2024-03-31 11:40:45,469 - Generate Text Features Finished...
2024-03-31 11:40:45,470 - Load Video Features Begin...
2024-03-31 11:40:46,494 - Load Video Features Finished...
2024-03-31 11:40:48,521 - Load Audio Features Begin...
2024-03-31 11:40:54,114 - Load Audio Features Finished...
2024-03-31 11:40:57,283 - method  begins...
2024-03-31 11:41:00,624 - Multimodal intent recognition begins...
2024-03-31 11:41:00,625 - Training begins...
2024-03-31 11:41:18,352 - ***** Epoch: 1: Eval results *****
2024-03-31 11:41:18,352 -   train_loss = 2.1478
2024-03-31 11:41:18,352 -   best_eval_score = 0.0
2024-03-31 11:41:18,352 -   eval_score = 0.535
2024-03-31 11:41:37,190 - ***** Epoch: 2: Eval results *****
2024-03-31 11:41:37,190 -   train_loss = 0.9337
2024-03-31 11:41:37,190 -   best_eval_score = 0.535
2024-03-31 11:41:37,190 -   eval_score = 0.6408
2024-03-31 11:41:55,742 - ***** Epoch: 3: Eval results *****
2024-03-31 11:41:55,743 -   train_loss = 0.4965
2024-03-31 11:41:55,743 -   best_eval_score = 0.6408
2024-03-31 11:41:55,743 -   eval_score = 0.642
2024-03-31 11:42:13,833 - ***** Epoch: 4: Eval results *****
2024-03-31 11:42:13,833 -   train_loss = 0.2561
2024-03-31 11:42:13,833 -   best_eval_score = 0.642
2024-03-31 11:42:13,833 -   eval_score = 0.6425
2024-03-31 11:42:32,313 - ***** Epoch: 5: Eval results *****
2024-03-31 11:42:32,314 -   train_loss = 0.1133
2024-03-31 11:42:32,314 -   best_eval_score = 0.6425
2024-03-31 11:42:32,314 -   eval_score = 0.631
2024-03-31 11:42:32,314 - EarlyStopping counter: 1 out of 8
2024-03-31 11:42:50,245 - ***** Epoch: 6: Eval results *****
2024-03-31 11:42:50,245 -   train_loss = 0.0527
2024-03-31 11:42:50,246 -   best_eval_score = 0.6425
2024-03-31 11:42:50,246 -   eval_score = 0.6465
2024-03-31 11:43:07,848 - ***** Epoch: 7: Eval results *****
2024-03-31 11:43:07,848 -   train_loss = 0.0335
2024-03-31 11:43:07,848 -   best_eval_score = 0.6465
2024-03-31 11:43:07,848 -   eval_score = 0.6375
2024-03-31 11:43:07,848 - EarlyStopping counter: 1 out of 8
2024-03-31 11:43:26,042 - ***** Epoch: 8: Eval results *****
2024-03-31 11:43:26,042 -   train_loss = 0.0175
2024-03-31 11:43:26,043 -   best_eval_score = 0.6465
2024-03-31 11:43:26,043 -   eval_score = 0.6499
2024-03-31 11:43:43,941 - ***** Epoch: 9: Eval results *****
2024-03-31 11:43:43,941 -   train_loss = 0.0112
2024-03-31 11:43:43,941 -   best_eval_score = 0.6499
2024-03-31 11:43:43,941 -   eval_score = 0.6501
2024-03-31 11:44:01,876 - ***** Epoch: 10: Eval results *****
2024-03-31 11:44:01,876 -   train_loss = 0.008
2024-03-31 11:44:01,876 -   best_eval_score = 0.6501
2024-03-31 11:44:01,876 -   eval_score = 0.6506
2024-03-31 11:44:20,092 - ***** Epoch: 11: Eval results *****
2024-03-31 11:44:20,092 -   train_loss = 0.0071
2024-03-31 11:44:20,093 -   best_eval_score = 0.6506
2024-03-31 11:44:20,093 -   eval_score = 0.6481
2024-03-31 11:44:20,093 - EarlyStopping counter: 1 out of 8
2024-03-31 11:44:37,575 - ***** Epoch: 12: Eval results *****
2024-03-31 11:44:37,575 -   train_loss = 0.0061
2024-03-31 11:44:37,575 -   best_eval_score = 0.6506
2024-03-31 11:44:37,575 -   eval_score = 0.6489
2024-03-31 11:44:37,575 - EarlyStopping counter: 2 out of 8
2024-03-31 11:44:56,283 - ***** Epoch: 13: Eval results *****
2024-03-31 11:44:56,283 -   train_loss = 0.0065
2024-03-31 11:44:56,283 -   best_eval_score = 0.6506
2024-03-31 11:44:56,283 -   eval_score = 0.6552
2024-03-31 11:45:14,300 - ***** Epoch: 14: Eval results *****
2024-03-31 11:45:14,300 -   train_loss = 0.0059
2024-03-31 11:45:14,300 -   best_eval_score = 0.6552
2024-03-31 11:45:14,300 -   eval_score = 0.6484
2024-03-31 11:45:14,300 - EarlyStopping counter: 1 out of 8
2024-03-31 11:45:32,108 - ***** Epoch: 15: Eval results *****
2024-03-31 11:45:32,108 -   train_loss = 0.0052
2024-03-31 11:45:32,108 -   best_eval_score = 0.6552
2024-03-31 11:45:32,108 -   eval_score = 0.6496
2024-03-31 11:45:32,108 - EarlyStopping counter: 2 out of 8
2024-03-31 11:45:49,837 - ***** Epoch: 16: Eval results *****
2024-03-31 11:45:49,838 -   train_loss = 0.0055
2024-03-31 11:45:49,838 -   best_eval_score = 0.6552
2024-03-31 11:45:49,838 -   eval_score = 0.6523
2024-03-31 11:45:49,838 - EarlyStopping counter: 3 out of 8
2024-03-31 11:46:07,942 - ***** Epoch: 17: Eval results *****
2024-03-31 11:46:07,943 -   train_loss = 0.0054
2024-03-31 11:46:07,943 -   best_eval_score = 0.6552
2024-03-31 11:46:07,943 -   eval_score = 0.6523
2024-03-31 11:46:07,943 - EarlyStopping counter: 4 out of 8
2024-03-31 11:46:25,427 - ***** Epoch: 18: Eval results *****
2024-03-31 11:46:25,427 -   train_loss = 0.0053
2024-03-31 11:46:25,427 -   best_eval_score = 0.6552
2024-03-31 11:46:25,427 -   eval_score = 0.6539
2024-03-31 11:46:25,427 - EarlyStopping counter: 5 out of 8
2024-03-31 11:46:43,680 - ***** Epoch: 19: Eval results *****
2024-03-31 11:46:43,680 -   train_loss = 0.0055
2024-03-31 11:46:43,680 -   best_eval_score = 0.6552
2024-03-31 11:46:43,680 -   eval_score = 0.6474
2024-03-31 11:46:43,680 - EarlyStopping counter: 6 out of 8
2024-03-31 11:47:00,847 - ***** Epoch: 20: Eval results *****
2024-03-31 11:47:00,848 -   train_loss = 0.0046
2024-03-31 11:47:00,848 -   best_eval_score = 0.6552
2024-03-31 11:47:00,848 -   eval_score = 0.6474
2024-03-31 11:47:00,848 - EarlyStopping counter: 7 out of 8
2024-03-31 11:47:20,026 - ***** Epoch: 21: Eval results *****
2024-03-31 11:47:20,027 -   train_loss = 0.005
2024-03-31 11:47:20,027 -   best_eval_score = 0.6552
2024-03-31 11:47:20,027 -   eval_score = 0.6442
2024-03-31 11:47:20,027 - EarlyStopping counter: 8 out of 8
2024-03-31 11:47:20,027 - EarlyStopping at epoch 21
2024-03-31 11:47:20,030 - Training is finished...
2024-03-31 11:47:20,030 - Testing begins...
2024-03-31 11:47:24,005 - ***** Test: Confusion Matrix *****
2024-03-31 11:47:24,007 - [[40  3  0  0  7  0  0  0  0  1  1  0  4  1  0  0  0  0  0  0]
 [ 1 33  0  1  0  3  0  0  1  0  1  0  2  0  1  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 5  0  0  0  8  0  3  0  1  1  0  1  1  1  1  0  0  1  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  2  0  5  0  1  0  0  0  1  0  1  0  0  0  0  0]
 [ 4  1  0  0  0  0  0  4  0  1  0  0  0  0  0  0  0  0  0  0]
 [ 2  1  0  0  1  0  0  2  3  0  0  0  0  1  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  1  1  0  3  0  0  0  0  0  3  0  1  0  0]
 [ 1  0  0  0  0  0  1  0  0  1 14  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  1 15  0  0  0  0  0  0  1  1]
 [ 4  3  1  0  0  0  0  0  0  0  0  1 39  2  3  2  1  0  1  0]
 [ 1  0  0  0  0  1  0  0  0  0  1  1  1 18  2  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  1  0  0  0  1  1 16  0  1  0  0  1]
 [ 0  0  0  0  0  0  0  1  1  0  0  0  5  0  0 13  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  1  0 12  0  0  2]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  3  0  0  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0  0  7]]
2024-03-31 11:47:24,007 - ***** Evaluation results *****
2024-03-31 11:47:24,007 -   acc = 0.6989
2024-03-31 11:47:24,007 -   f1 = 0.6666
2024-03-31 11:47:24,007 -   prec = 0.6755
2024-03-31 11:47:24,007 -   rec = 0.6648
2024-03-31 11:47:24,007 - Testing is finished...
2024-03-31 11:47:24,007 - Multimodal intent recognition is finished...
2024-03-31 11:47:24,007 - Results are saved in results/msz.csv
