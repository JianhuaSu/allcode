2024-07-21 18:27:14,589 - ============================== Params ==============================
2024-07-21 18:27:14,589 - logger_name: mmim_MIntRec_multi-class_seed-3
2024-07-21 18:27:14,589 - dataset: MIntRec
2024-07-21 18:27:14,589 - data_mode: multi-class
2024-07-21 18:27:14,589 - method: mmim
2024-07-21 18:27:14,589 - text_backbone: bert-base-uncased
2024-07-21 18:27:14,589 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-07-21 18:27:14,589 - seed: 3
2024-07-21 18:27:14,589 - num_workers: 8
2024-07-21 18:27:14,589 - gpu_id: 0
2024-07-21 18:27:14,589 - data_path: /home/sharing/disk1/zhanghanlei/Datasets/public
2024-07-21 18:27:14,589 - train: True
2024-07-21 18:27:14,589 - tune: True
2024-07-21 18:27:14,589 - save_model: False
2024-07-21 18:27:14,589 - save_results: True
2024-07-21 18:27:14,589 - log_path: logs
2024-07-21 18:27:14,589 - cache_path: 
2024-07-21 18:27:14,589 - video_data_path: video_data
2024-07-21 18:27:14,589 - audio_data_path: audio_data
2024-07-21 18:27:14,589 - video_feats_path: video_feats.pkl
2024-07-21 18:27:14,589 - audio_feats_path: audio_feats.pkl
2024-07-21 18:27:14,589 - results_path: results
2024-07-21 18:27:14,589 - output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ_1/outputs/MIntRec
2024-07-21 18:27:14,589 - model_path: models
2024-07-21 18:27:14,589 - config_file_name: mmim_bert_MIntRec
2024-07-21 18:27:14,589 - results_file_name: mmim_bert_MIntRec.csv
2024-07-21 18:27:14,589 - ablation: none
2024-07-21 18:27:14,589 - padding_mode: zero
2024-07-21 18:27:14,589 - padding_loc: end
2024-07-21 18:27:14,589 - need_aligned: False
2024-07-21 18:27:14,589 - eval_monitor: f1
2024-07-21 18:27:14,589 - train_batch_size: 16
2024-07-21 18:27:14,589 - eval_batch_size: 8
2024-07-21 18:27:14,589 - test_batch_size: 8
2024-07-21 18:27:14,590 - wait_patience: 8
2024-07-21 18:27:14,590 - num_train_epochs: 100
2024-07-21 18:27:14,590 - add_va: False
2024-07-21 18:27:14,590 - cpc_activation: Tanh
2024-07-21 18:27:14,590 - mmilb_mid_activation: ReLU
2024-07-21 18:27:14,590 - mmilb_last_activation: Tanh
2024-07-21 18:27:14,590 - optim: Adam
2024-07-21 18:27:14,590 - contrast: True
2024-07-21 18:27:14,590 - bidirectional: True
2024-07-21 18:27:14,590 - grad_clip: 1.0
2024-07-21 18:27:14,590 - lr_main: 0.0001
2024-07-21 18:27:14,590 - weight_decay_main: 0.0001
2024-07-21 18:27:14,590 - lr_bert: 4e-05
2024-07-21 18:27:14,590 - weight_decay_bert: 8e-05
2024-07-21 18:27:14,590 - lr_mmilb: 0.001
2024-07-21 18:27:14,590 - weight_decay_mmilb: 0.0001
2024-07-21 18:27:14,590 - alpha: 0.1
2024-07-21 18:27:14,590 - dropout_a: 0.1
2024-07-21 18:27:14,590 - dropout_v: 0.1
2024-07-21 18:27:14,590 - dropout_prj: 0.1
2024-07-21 18:27:14,590 - n_layer: 1
2024-07-21 18:27:14,590 - cpc_layers: 1
2024-07-21 18:27:14,590 - d_vh: 32
2024-07-21 18:27:14,590 - d_ah: 32
2024-07-21 18:27:14,590 - d_vout: 16
2024-07-21 18:27:14,590 - d_aout: 16
2024-07-21 18:27:14,590 - d_prjh: 512
2024-07-21 18:27:14,590 - scale: 20
2024-07-21 18:27:14,590 - beta: 0.5
2024-07-21 18:27:14,590 - pred_output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ_1/outputs/MIntRec/mmim_MIntRec_multi-class_seed-3
2024-07-21 18:27:14,590 - model_output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ_1/outputs/MIntRec/mmim_MIntRec_multi-class_seed-3/models
2024-07-21 18:27:14,590 - ============================== End Params ==============================
2024-07-21 18:27:14,593 - Generate Text Features Begin...
2024-07-21 18:27:14,960 - Generate Text Features Finished...
2024-07-21 18:27:14,960 - Load Video Features Begin...
2024-07-21 18:27:15,235 - Load Video Features Finished...
2024-07-21 18:27:15,829 - Load Audio Features Begin...
2024-07-21 18:27:16,742 - Load Audio Features Finished...
2024-07-21 18:27:20,610 - method  begins...
2024-07-21 18:27:24,876 - Multimodal intent recognition begins...
2024-07-21 18:27:24,876 - Training begins...
2024-07-21 18:27:56,405 - ***** Epoch: 1: Eval results *****
2024-07-21 18:27:56,406 -   best_eval_score = 0.0
2024-07-21 18:27:56,406 -   eval_score = 0.5804
2024-07-21 18:27:56,406 -   train_loss_main = 2.6105
2024-07-21 18:27:56,406 -   train_loss_mmilb = 0.3791
2024-07-21 18:28:26,226 - ***** Epoch: 2: Eval results *****
2024-07-21 18:28:26,226 -   best_eval_score = 0.5804
2024-07-21 18:28:26,226 -   eval_score = 0.6531
2024-07-21 18:28:26,227 -   train_loss_main = 1.3973
2024-07-21 18:28:26,227 -   train_loss_mmilb = 0.0047
2024-07-21 18:28:54,770 - ***** Epoch: 3: Eval results *****
2024-07-21 18:28:54,770 -   best_eval_score = 0.6531
2024-07-21 18:28:54,771 -   eval_score = 0.6687
2024-07-21 18:28:54,771 -   train_loss_main = 1.0004
2024-07-21 18:28:54,771 -   train_loss_mmilb = 0.0014
2024-07-21 18:29:23,148 - ***** Epoch: 4: Eval results *****
2024-07-21 18:29:23,148 -   best_eval_score = 0.6687
2024-07-21 18:29:23,148 -   eval_score = 0.6305
2024-07-21 18:29:23,148 -   train_loss_main = 0.8528
2024-07-21 18:29:23,148 -   train_loss_mmilb = 0.0017
2024-07-21 18:29:23,149 - EarlyStopping counter: 1 out of 8
2024-07-21 18:29:51,729 - ***** Epoch: 5: Eval results *****
2024-07-21 18:29:51,729 -   best_eval_score = 0.6687
2024-07-21 18:29:51,729 -   eval_score = 0.6452
2024-07-21 18:29:51,730 -   train_loss_main = 0.7705
2024-07-21 18:29:51,730 -   train_loss_mmilb = 0.0007
2024-07-21 18:29:51,730 - EarlyStopping counter: 2 out of 8
2024-07-21 18:30:20,027 - ***** Epoch: 6: Eval results *****
2024-07-21 18:30:20,029 -   best_eval_score = 0.6687
2024-07-21 18:30:20,029 -   eval_score = 0.6545
2024-07-21 18:30:20,030 -   train_loss_main = 0.7539
2024-07-21 18:30:20,030 -   train_loss_mmilb = 0.0007
2024-07-21 18:30:20,031 - EarlyStopping counter: 3 out of 8
2024-07-21 18:30:48,220 - ***** Epoch: 7: Eval results *****
2024-07-21 18:30:48,221 -   best_eval_score = 0.6687
2024-07-21 18:30:48,221 -   eval_score = 0.667
2024-07-21 18:30:48,221 -   train_loss_main = 0.7221
2024-07-21 18:30:48,222 -   train_loss_mmilb = 0.0005
2024-07-21 18:30:48,222 - EarlyStopping counter: 4 out of 8
2024-07-21 18:31:16,816 - ***** Epoch: 8: Eval results *****
2024-07-21 18:31:16,817 -   best_eval_score = 0.6687
2024-07-21 18:31:16,817 -   eval_score = 0.6743
2024-07-21 18:31:16,817 -   train_loss_main = 0.7061
2024-07-21 18:31:16,817 -   train_loss_mmilb = 0.0005
2024-07-21 18:31:45,377 - ***** Epoch: 9: Eval results *****
2024-07-21 18:31:45,377 -   best_eval_score = 0.6743
2024-07-21 18:31:45,377 -   eval_score = 0.667
2024-07-21 18:31:45,377 -   train_loss_main = 0.6941
2024-07-21 18:31:45,378 -   train_loss_mmilb = 0.0005
2024-07-21 18:31:45,378 - EarlyStopping counter: 1 out of 8
2024-07-21 18:32:14,079 - ***** Epoch: 10: Eval results *****
2024-07-21 18:32:14,080 -   best_eval_score = 0.6743
2024-07-21 18:32:14,080 -   eval_score = 0.6559
2024-07-21 18:32:14,080 -   train_loss_main = 0.6666
2024-07-21 18:32:14,080 -   train_loss_mmilb = 0.0005
2024-07-21 18:32:14,080 - EarlyStopping counter: 2 out of 8
2024-07-21 18:32:42,641 - ***** Epoch: 11: Eval results *****
2024-07-21 18:32:42,642 -   best_eval_score = 0.6743
2024-07-21 18:32:42,642 -   eval_score = 0.6871
2024-07-21 18:32:42,642 -   train_loss_main = 0.6546
2024-07-21 18:32:42,643 -   train_loss_mmilb = 0.0004
2024-07-21 18:33:11,115 - ***** Epoch: 12: Eval results *****
2024-07-21 18:33:11,116 -   best_eval_score = 0.6871
2024-07-21 18:33:11,116 -   eval_score = 0.688
2024-07-21 18:33:11,117 -   train_loss_main = 0.6321
2024-07-21 18:33:11,117 -   train_loss_mmilb = 0.0004
2024-07-21 18:33:39,797 - ***** Epoch: 13: Eval results *****
2024-07-21 18:33:39,798 -   best_eval_score = 0.688
2024-07-21 18:33:39,802 -   eval_score = 0.6682
2024-07-21 18:33:39,802 -   train_loss_main = 0.6282
2024-07-21 18:33:39,802 -   train_loss_mmilb = 0.0004
2024-07-21 18:33:39,802 - EarlyStopping counter: 1 out of 8
2024-07-21 18:34:08,587 - ***** Epoch: 14: Eval results *****
2024-07-21 18:34:08,587 -   best_eval_score = 0.688
2024-07-21 18:34:08,587 -   eval_score = 0.6758
2024-07-21 18:34:08,587 -   train_loss_main = 0.6182
2024-07-21 18:34:08,587 -   train_loss_mmilb = 0.0004
2024-07-21 18:34:08,587 - EarlyStopping counter: 2 out of 8
2024-07-21 18:34:37,203 - ***** Epoch: 15: Eval results *****
2024-07-21 18:34:37,203 -   best_eval_score = 0.688
2024-07-21 18:34:37,203 -   eval_score = 0.6885
2024-07-21 18:34:37,203 -   train_loss_main = 0.6128
2024-07-21 18:34:37,203 -   train_loss_mmilb = 0.0004
2024-07-21 18:35:05,830 - ***** Epoch: 16: Eval results *****
2024-07-21 18:35:05,831 -   best_eval_score = 0.6885
2024-07-21 18:35:05,831 -   eval_score = 0.6828
2024-07-21 18:35:05,832 -   train_loss_main = 0.6112
2024-07-21 18:35:05,832 -   train_loss_mmilb = 0.0004
2024-07-21 18:35:05,833 - EarlyStopping counter: 1 out of 8
2024-07-21 18:35:34,524 - ***** Epoch: 17: Eval results *****
2024-07-21 18:35:34,524 -   best_eval_score = 0.6885
2024-07-21 18:35:34,524 -   eval_score = 0.6744
2024-07-21 18:35:34,524 -   train_loss_main = 0.6081
2024-07-21 18:35:34,524 -   train_loss_mmilb = 0.0003
2024-07-21 18:35:34,524 - EarlyStopping counter: 2 out of 8
2024-07-21 18:36:03,410 - ***** Epoch: 18: Eval results *****
2024-07-21 18:36:03,411 -   best_eval_score = 0.6885
2024-07-21 18:36:03,411 -   eval_score = 0.652
2024-07-21 18:36:03,411 -   train_loss_main = 0.6052
2024-07-21 18:36:03,411 -   train_loss_mmilb = 0.0004
2024-07-21 18:36:03,411 - EarlyStopping counter: 3 out of 8
2024-07-21 18:36:32,144 - ***** Epoch: 19: Eval results *****
2024-07-21 18:36:32,146 -   best_eval_score = 0.6885
2024-07-21 18:36:32,146 -   eval_score = 0.6488
2024-07-21 18:36:32,146 -   train_loss_main = 0.6033
2024-07-21 18:36:32,147 -   train_loss_mmilb = 0.0003
2024-07-21 18:36:32,147 - EarlyStopping counter: 4 out of 8
2024-07-21 18:37:00,819 - ***** Epoch: 20: Eval results *****
2024-07-21 18:37:00,819 -   best_eval_score = 0.6885
2024-07-21 18:37:00,820 -   eval_score = 0.6539
2024-07-21 18:37:00,820 -   train_loss_main = 0.6035
2024-07-21 18:37:00,821 -   train_loss_mmilb = 0.0003
2024-07-21 18:37:00,821 - EarlyStopping counter: 5 out of 8
2024-07-21 18:37:29,100 - ***** Epoch: 21: Eval results *****
2024-07-21 18:37:29,100 -   best_eval_score = 0.6885
2024-07-21 18:37:29,100 -   eval_score = 0.663
2024-07-21 18:37:29,100 -   train_loss_main = 0.6019
2024-07-21 18:37:29,100 -   train_loss_mmilb = 0.0003
2024-07-21 18:37:29,100 - EarlyStopping counter: 6 out of 8
2024-07-21 18:37:57,846 - ***** Epoch: 22: Eval results *****
2024-07-21 18:37:57,846 -   best_eval_score = 0.6885
2024-07-21 18:37:57,846 -   eval_score = 0.6909
2024-07-21 18:37:57,846 -   train_loss_main = 0.6017
2024-07-21 18:37:57,846 -   train_loss_mmilb = 0.0003
2024-07-21 18:38:26,630 - ***** Epoch: 23: Eval results *****
2024-07-21 18:38:26,631 -   best_eval_score = 0.6909
2024-07-21 18:38:26,632 -   eval_score = 0.6443
2024-07-21 18:38:26,632 -   train_loss_main = 0.6007
2024-07-21 18:38:26,633 -   train_loss_mmilb = 0.0003
2024-07-21 18:38:26,633 - EarlyStopping counter: 1 out of 8
2024-07-21 18:38:55,492 - ***** Epoch: 24: Eval results *****
2024-07-21 18:38:55,492 -   best_eval_score = 0.6909
2024-07-21 18:38:55,492 -   eval_score = 0.6701
2024-07-21 18:38:55,492 -   train_loss_main = 0.6041
2024-07-21 18:38:55,492 -   train_loss_mmilb = 0.0004
2024-07-21 18:38:55,492 - EarlyStopping counter: 2 out of 8
2024-07-21 18:39:24,208 - ***** Epoch: 25: Eval results *****
2024-07-21 18:39:24,208 -   best_eval_score = 0.6909
2024-07-21 18:39:24,208 -   eval_score = 0.6451
2024-07-21 18:39:24,208 -   train_loss_main = 0.6024
2024-07-21 18:39:24,208 -   train_loss_mmilb = 0.0003
2024-07-21 18:39:24,208 - EarlyStopping counter: 3 out of 8
2024-07-21 18:39:52,801 - ***** Epoch: 26: Eval results *****
2024-07-21 18:39:52,802 -   best_eval_score = 0.6909
2024-07-21 18:39:52,802 -   eval_score = 0.5892
2024-07-21 18:39:52,802 -   train_loss_main = 0.6953
2024-07-21 18:39:52,802 -   train_loss_mmilb = 0.0003
2024-07-21 18:39:52,802 - EarlyStopping counter: 4 out of 8
2024-07-21 18:40:21,503 - ***** Epoch: 27: Eval results *****
2024-07-21 18:40:21,503 -   best_eval_score = 0.6909
2024-07-21 18:40:21,503 -   eval_score = 0.5433
2024-07-21 18:40:21,503 -   train_loss_main = 0.8258
2024-07-21 18:40:21,503 -   train_loss_mmilb = 0.0003
2024-07-21 18:40:21,503 - EarlyStopping counter: 5 out of 8
2024-07-21 18:40:49,843 - ***** Epoch: 28: Eval results *****
2024-07-21 18:40:49,843 -   best_eval_score = 0.6909
2024-07-21 18:40:49,844 -   eval_score = 0.6257
2024-07-21 18:40:49,844 -   train_loss_main = 0.735
2024-07-21 18:40:49,844 -   train_loss_mmilb = 0.0003
2024-07-21 18:40:49,845 - EarlyStopping counter: 6 out of 8
2024-07-21 18:41:18,521 - ***** Epoch: 29: Eval results *****
2024-07-21 18:41:18,521 -   best_eval_score = 0.6909
2024-07-21 18:41:18,522 -   eval_score = 0.5636
2024-07-21 18:41:18,522 -   train_loss_main = 0.7121
2024-07-21 18:41:18,522 -   train_loss_mmilb = 0.0003
2024-07-21 18:41:18,522 - EarlyStopping counter: 7 out of 8
2024-07-21 18:41:47,125 - ***** Epoch: 30: Eval results *****
2024-07-21 18:41:47,126 -   best_eval_score = 0.6909
2024-07-21 18:41:47,126 -   eval_score = 0.5825
2024-07-21 18:41:47,126 -   train_loss_main = 0.674
2024-07-21 18:41:47,126 -   train_loss_mmilb = 0.0003
2024-07-21 18:41:47,126 - EarlyStopping counter: 8 out of 8
2024-07-21 18:41:47,126 - EarlyStopping at epoch 30
2024-07-21 18:41:47,195 - Training is finished...
2024-07-21 18:41:47,195 - Testing begins...
2024-07-21 18:41:51,126 - ***** Test: Confusion Matrix *****
2024-07-21 18:41:51,129 - [[31  0  0  0  9  0  3  4  0  5  0  0  1  2  0  2  0  0  0  0]
 [ 0 38  1  0  0  0  0  0  1  0  1  0  1  1  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  1 23  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 3  1  0  0 11  0  2  0  1  0  0  1  0  3  0  0  0  1  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  2  0  0  3  0  4  0  1  0  0  0  0  0  0  0  1  0  0  0]
 [ 3  1  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  0  2  4  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  3  1  0  0  0  0  3  0  2  0  0]
 [ 0  2  0  0  0  0  1  0  0  2 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  0  1]
 [ 3  3  0  0  2  0  1  3  0  1  0  1 28  6  2  4  1  1  0  1]
 [ 0  1  0  0  1  0  0  0  0  0  2  1  0 20  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  0  0  0  0  0  4 13  0  1  0  0  3]
 [ 0  1  0  0  1  0  0  0  0  0  0  0  2  0  0 16  0  0  0  1]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  3  0  1  0 12  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  1  0  0  0  0  1  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  1  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  1  1  0  0  0  0  7]]
2024-07-21 18:41:51,131 - ***** Evaluation results *****
2024-07-21 18:41:51,131 -   acc = 0.6831
2024-07-21 18:41:51,131 -   f1 = 0.6685
2024-07-21 18:41:51,131 -   prec = 0.6769
2024-07-21 18:41:51,131 -   rec = 0.6778
2024-07-21 18:41:51,132 - Testing is finished...
2024-07-21 18:41:51,132 - Multimodal intent recognition is finished...
2024-07-21 18:41:51,132 - Results are saved in results/mmim_bert_MIntRec.csv
