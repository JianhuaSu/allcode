2024-01-24 04:39:47,849 - ============================== Params ==============================
2024-01-24 04:39:47,850 - logger_name: msz_MIntRec_multi-class_seed-1_2024-01-24-04-39-47
2024-01-24 04:39:47,850 - dataset: MIntRec
2024-01-24 04:39:47,850 - data_mode: multi-class
2024-01-24 04:39:47,850 - method: msz
2024-01-24 04:39:47,850 - text_backbone: bert-base-uncased
2024-01-24 04:39:47,850 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-24 04:39:47,850 - seed: 1
2024-01-24 04:39:47,850 - num_workers: 8
2024-01-24 04:39:47,850 - gpu_id: 1
2024-01-24 04:39:47,850 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-24 04:39:47,850 - train: True
2024-01-24 04:39:47,850 - tune: False
2024-01-24 04:39:47,850 - save_model: False
2024-01-24 04:39:47,850 - save_results: True
2024-01-24 04:39:47,850 - log_path: logs
2024-01-24 04:39:47,850 - cache_path: 
2024-01-24 04:39:47,850 - video_data_path: video_data
2024-01-24 04:39:47,850 - audio_data_path: audio_data
2024-01-24 04:39:47,850 - video_feats_path: video_feats.pkl
2024-01-24 04:39:47,850 - audio_feats_path: audio_feats.pkl
2024-01-24 04:39:47,850 - results_path: results
2024-01-24 04:39:47,850 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-24 04:39:47,850 - model_path: models
2024-01-24 04:39:47,850 - config_file_name: msz
2024-01-24 04:39:47,850 - results_file_name: msz.csv
2024-01-24 04:39:47,851 - padding_mode: zero
2024-01-24 04:39:47,851 - padding_loc: end
2024-01-24 04:39:47,851 - need_aligned: False
2024-01-24 04:39:47,851 - eval_monitor: f1
2024-01-24 04:39:47,851 - train_batch_size: 16
2024-01-24 04:39:47,851 - eval_batch_size: 8
2024-01-24 04:39:47,851 - test_batch_size: 8
2024-01-24 04:39:47,851 - wait_patience: 8
2024-01-24 04:39:47,851 - hidden_size: 768
2024-01-24 04:39:47,851 - num_attention_heads: 12
2024-01-24 04:39:47,851 - attention_probs_dropout_prob: 0.2
2024-01-24 04:39:47,851 - hidden_dropout_prob: 0.2
2024-01-24 04:39:47,851 - intermediate_size: 768
2024-01-24 04:39:47,851 - num_hidden_layers: 8
2024-01-24 04:39:47,851 - max_position_embeddings: 768
2024-01-24 04:39:47,851 - position_embedding_type: absolute
2024-01-24 04:39:47,851 - batch_first: True
2024-01-24 04:39:47,851 - hidden_dims: 768
2024-01-24 04:39:47,851 - dropout: 0.1
2024-01-24 04:39:47,851 - aligned_method: conv1d
2024-01-24 04:39:47,851 - num_train_epochs: 100
2024-01-24 04:39:47,851 - lr: 8e-06
2024-01-24 04:39:47,851 - scale: 32
2024-01-24 04:39:47,851 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-24-04-39-47
2024-01-24 04:39:47,851 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-24-04-39-47/models
2024-01-24 04:39:47,851 - ============================== End Params ==============================
2024-01-24 04:39:48,120 - Generate Text Features Begin...
2024-01-24 04:39:48,932 - Generate Text Features Finished...
2024-01-24 04:39:48,934 - Load Video Features Begin...
2024-01-24 04:39:59,448 - Load Video Features Finished...
2024-01-24 04:40:00,135 - Load Audio Features Begin...
2024-01-24 04:40:34,326 - Load Audio Features Finished...
2024-01-24 04:40:38,014 - method  begins...
2024-01-24 04:40:49,078 - Multimodal intent recognition begins...
2024-01-24 04:40:49,078 - Training begins...
2024-01-24 04:41:12,837 - ***** Epoch: 1: Eval results *****
2024-01-24 04:41:12,837 -   train_loss = 2.7588
2024-01-24 04:41:12,837 -   best_eval_score = 0.0
2024-01-24 04:41:12,837 -   eval_score = 0.1637
2024-01-24 04:41:35,028 - ***** Epoch: 2: Eval results *****
2024-01-24 04:41:35,028 -   train_loss = 1.7388
2024-01-24 04:41:35,028 -   best_eval_score = 0.1637
2024-01-24 04:41:35,028 -   eval_score = 0.5093
2024-01-24 04:41:57,014 - ***** Epoch: 3: Eval results *****
2024-01-24 04:41:57,015 -   train_loss = 0.9133
2024-01-24 04:41:57,015 -   best_eval_score = 0.5093
2024-01-24 04:41:57,015 -   eval_score = 0.6215
2024-01-24 04:42:18,381 - ***** Epoch: 4: Eval results *****
2024-01-24 04:42:18,381 -   train_loss = 0.5008
2024-01-24 04:42:18,381 -   best_eval_score = 0.6215
2024-01-24 04:42:18,381 -   eval_score = 0.6482
2024-01-24 04:42:39,690 - ***** Epoch: 5: Eval results *****
2024-01-24 04:42:39,691 -   train_loss = 0.2987
2024-01-24 04:42:39,691 -   best_eval_score = 0.6482
2024-01-24 04:42:39,691 -   eval_score = 0.6544
2024-01-24 04:43:00,956 - ***** Epoch: 6: Eval results *****
2024-01-24 04:43:00,956 -   train_loss = 0.1496
2024-01-24 04:43:00,956 -   best_eval_score = 0.6544
2024-01-24 04:43:00,956 -   eval_score = 0.645
2024-01-24 04:43:00,956 - EarlyStopping counter: 1 out of 8
2024-01-24 04:43:22,431 - ***** Epoch: 7: Eval results *****
2024-01-24 04:43:22,432 -   train_loss = 0.1005
2024-01-24 04:43:22,432 -   best_eval_score = 0.6544
2024-01-24 04:43:22,432 -   eval_score = 0.6754
2024-01-24 04:43:43,138 - ***** Epoch: 8: Eval results *****
2024-01-24 04:43:43,138 -   train_loss = 0.0506
2024-01-24 04:43:43,138 -   best_eval_score = 0.6754
2024-01-24 04:43:43,138 -   eval_score = 0.6626
2024-01-24 04:43:43,138 - EarlyStopping counter: 1 out of 8
2024-01-24 04:44:05,058 - ***** Epoch: 9: Eval results *****
2024-01-24 04:44:05,058 -   train_loss = 0.0334
2024-01-24 04:44:05,058 -   best_eval_score = 0.6754
2024-01-24 04:44:05,058 -   eval_score = 0.653
2024-01-24 04:44:05,058 - EarlyStopping counter: 2 out of 8
2024-01-24 04:44:25,788 - ***** Epoch: 10: Eval results *****
2024-01-24 04:44:25,788 -   train_loss = 0.0253
2024-01-24 04:44:25,788 -   best_eval_score = 0.6754
2024-01-24 04:44:25,788 -   eval_score = 0.6579
2024-01-24 04:44:25,788 - EarlyStopping counter: 3 out of 8
2024-01-24 04:44:46,393 - ***** Epoch: 11: Eval results *****
2024-01-24 04:44:46,393 -   train_loss = 0.0245
2024-01-24 04:44:46,393 -   best_eval_score = 0.6754
2024-01-24 04:44:46,393 -   eval_score = 0.6808
2024-01-24 04:45:06,731 - ***** Epoch: 12: Eval results *****
2024-01-24 04:45:06,731 -   train_loss = 0.0144
2024-01-24 04:45:06,731 -   best_eval_score = 0.6808
2024-01-24 04:45:06,732 -   eval_score = 0.6777
2024-01-24 04:45:06,732 - EarlyStopping counter: 1 out of 8
2024-01-24 04:45:27,352 - ***** Epoch: 13: Eval results *****
2024-01-24 04:45:27,353 -   train_loss = 0.0117
2024-01-24 04:45:27,353 -   best_eval_score = 0.6808
2024-01-24 04:45:27,353 -   eval_score = 0.6878
2024-01-24 04:45:47,731 - ***** Epoch: 14: Eval results *****
2024-01-24 04:45:47,731 -   train_loss = 0.0099
2024-01-24 04:45:47,731 -   best_eval_score = 0.6878
2024-01-24 04:45:47,731 -   eval_score = 0.6854
2024-01-24 04:45:47,731 - EarlyStopping counter: 1 out of 8
2024-01-24 04:46:08,191 - ***** Epoch: 15: Eval results *****
2024-01-24 04:46:08,191 -   train_loss = 0.0105
2024-01-24 04:46:08,191 -   best_eval_score = 0.6878
2024-01-24 04:46:08,191 -   eval_score = 0.6841
2024-01-24 04:46:08,191 - EarlyStopping counter: 2 out of 8
2024-01-24 04:46:28,781 - ***** Epoch: 16: Eval results *****
2024-01-24 04:46:28,781 -   train_loss = 0.0109
2024-01-24 04:46:28,781 -   best_eval_score = 0.6878
2024-01-24 04:46:28,781 -   eval_score = 0.6882
2024-01-24 04:46:50,133 - ***** Epoch: 17: Eval results *****
2024-01-24 04:46:50,134 -   train_loss = 0.0097
2024-01-24 04:46:50,134 -   best_eval_score = 0.6882
2024-01-24 04:46:50,134 -   eval_score = 0.6894
2024-01-24 04:47:11,025 - ***** Epoch: 18: Eval results *****
2024-01-24 04:47:11,025 -   train_loss = 0.0089
2024-01-24 04:47:11,025 -   best_eval_score = 0.6894
2024-01-24 04:47:11,025 -   eval_score = 0.6911
2024-01-24 04:47:31,836 - ***** Epoch: 19: Eval results *****
2024-01-24 04:47:31,837 -   train_loss = 0.0086
2024-01-24 04:47:31,837 -   best_eval_score = 0.6911
2024-01-24 04:47:31,837 -   eval_score = 0.6931
2024-01-24 04:47:52,484 - ***** Epoch: 20: Eval results *****
2024-01-24 04:47:52,485 -   train_loss = 0.0072
2024-01-24 04:47:52,485 -   best_eval_score = 0.6931
2024-01-24 04:47:52,485 -   eval_score = 0.6931
2024-01-24 04:47:52,485 - EarlyStopping counter: 1 out of 8
2024-01-24 04:48:13,300 - ***** Epoch: 21: Eval results *****
2024-01-24 04:48:13,300 -   train_loss = 0.0093
2024-01-24 04:48:13,300 -   best_eval_score = 0.6931
2024-01-24 04:48:13,300 -   eval_score = 0.6927
2024-01-24 04:48:13,301 - EarlyStopping counter: 2 out of 8
2024-01-24 04:48:35,194 - ***** Epoch: 22: Eval results *****
2024-01-24 04:48:35,194 -   train_loss = 0.0076
2024-01-24 04:48:35,194 -   best_eval_score = 0.6931
2024-01-24 04:48:35,194 -   eval_score = 0.6921
2024-01-24 04:48:35,194 - EarlyStopping counter: 3 out of 8
2024-01-24 04:48:56,178 - ***** Epoch: 23: Eval results *****
2024-01-24 04:48:56,179 -   train_loss = 0.0076
2024-01-24 04:48:56,179 -   best_eval_score = 0.6931
2024-01-24 04:48:56,179 -   eval_score = 0.6891
2024-01-24 04:48:56,179 - EarlyStopping counter: 4 out of 8
2024-01-24 04:49:16,620 - ***** Epoch: 24: Eval results *****
2024-01-24 04:49:16,620 -   train_loss = 0.0079
2024-01-24 04:49:16,620 -   best_eval_score = 0.6931
2024-01-24 04:49:16,620 -   eval_score = 0.6891
2024-01-24 04:49:16,620 - EarlyStopping counter: 5 out of 8
2024-01-24 04:49:37,991 - ***** Epoch: 25: Eval results *****
2024-01-24 04:49:37,992 -   train_loss = 0.0085
2024-01-24 04:49:37,992 -   best_eval_score = 0.6931
2024-01-24 04:49:37,992 -   eval_score = 0.6879
2024-01-24 04:49:37,992 - EarlyStopping counter: 6 out of 8
2024-01-24 04:49:59,287 - ***** Epoch: 26: Eval results *****
2024-01-24 04:49:59,287 -   train_loss = 0.0079
2024-01-24 04:49:59,287 -   best_eval_score = 0.6931
2024-01-24 04:49:59,287 -   eval_score = 0.6921
2024-01-24 04:49:59,287 - EarlyStopping counter: 7 out of 8
2024-01-24 04:50:20,063 - ***** Epoch: 27: Eval results *****
2024-01-24 04:50:20,063 -   train_loss = 0.0079
2024-01-24 04:50:20,063 -   best_eval_score = 0.6931
2024-01-24 04:50:20,063 -   eval_score = 0.6944
2024-01-24 04:50:40,684 - ***** Epoch: 28: Eval results *****
2024-01-24 04:50:40,684 -   train_loss = 0.0081
2024-01-24 04:50:40,684 -   best_eval_score = 0.6944
2024-01-24 04:50:40,684 -   eval_score = 0.6909
2024-01-24 04:50:40,684 - EarlyStopping counter: 1 out of 8
2024-01-24 04:51:01,570 - ***** Epoch: 29: Eval results *****
2024-01-24 04:51:01,570 -   train_loss = 0.0074
2024-01-24 04:51:01,570 -   best_eval_score = 0.6944
2024-01-24 04:51:01,570 -   eval_score = 0.6939
2024-01-24 04:51:01,570 - EarlyStopping counter: 2 out of 8
2024-01-24 04:51:22,465 - ***** Epoch: 30: Eval results *****
2024-01-24 04:51:22,465 -   train_loss = 0.008
2024-01-24 04:51:22,465 -   best_eval_score = 0.6944
2024-01-24 04:51:22,465 -   eval_score = 0.6939
2024-01-24 04:51:22,465 - EarlyStopping counter: 3 out of 8
2024-01-24 04:51:43,548 - ***** Epoch: 31: Eval results *****
2024-01-24 04:51:43,548 -   train_loss = 0.0078
2024-01-24 04:51:43,548 -   best_eval_score = 0.6944
2024-01-24 04:51:43,548 -   eval_score = 0.6939
2024-01-24 04:51:43,548 - EarlyStopping counter: 4 out of 8
2024-01-24 04:52:03,950 - ***** Epoch: 32: Eval results *****
2024-01-24 04:52:03,950 -   train_loss = 0.0079
2024-01-24 04:52:03,951 -   best_eval_score = 0.6944
2024-01-24 04:52:03,951 -   eval_score = 0.6939
2024-01-24 04:52:03,951 - EarlyStopping counter: 5 out of 8
2024-01-24 04:52:25,288 - ***** Epoch: 33: Eval results *****
2024-01-24 04:52:25,288 -   train_loss = 0.0078
2024-01-24 04:52:25,288 -   best_eval_score = 0.6944
2024-01-24 04:52:25,288 -   eval_score = 0.6939
2024-01-24 04:52:25,288 - EarlyStopping counter: 6 out of 8
2024-01-24 04:52:46,213 - ***** Epoch: 34: Eval results *****
2024-01-24 04:52:46,222 -   train_loss = 0.008
2024-01-24 04:52:46,222 -   best_eval_score = 0.6944
2024-01-24 04:52:46,222 -   eval_score = 0.6939
2024-01-24 04:52:46,222 - EarlyStopping counter: 7 out of 8
2024-01-24 04:53:07,817 - ***** Epoch: 35: Eval results *****
2024-01-24 04:53:07,817 -   train_loss = 0.0074
2024-01-24 04:53:07,817 -   best_eval_score = 0.6944
2024-01-24 04:53:07,817 -   eval_score = 0.6939
2024-01-24 04:53:07,817 - EarlyStopping counter: 8 out of 8
2024-01-24 04:53:07,817 - EarlyStopping at epoch 35
2024-01-24 04:53:07,822 - Training is finished...
2024-01-24 04:53:07,822 - Testing begins...
2024-01-24 04:53:11,623 - ***** Test: Confusion Matrix *****
2024-01-24 04:53:11,624 - [[34  2  0  0  9  0  3  1  0  3  1  0  3  1  0  0  0  0  0  0]
 [ 0 36  0  1  0  2  0  0  0  0  1  0  2  0  1  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 4  0  0  0 10  0  3  0  0  0  1  1  2  1  0  0  0  1  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  1  0  0  3  0  1  0  3  0  0  0  1  0  0  0  0  0  0  1]
 [ 3  0  0  0  0  1  0  4  2  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  1  1  4  0  0  0  0  1  0  2  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  4  1  0  0  0  0  2  0  1  0  0]
 [ 1  0  0  0  0  0  0  0  0  1 14  1  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  0  1]
 [ 4  2  0  0  1  0  0  0  0  0  0  2 37  3  4  2  1  0  0  1]
 [ 0  0  0  0  0  0  2  0  0  0  1  1  1 18  1  1  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  0  2 17  0  1  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  4  1  0 15  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  1  1 14  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  2  0  1  0  1  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  2  0  0  6]]
2024-01-24 04:53:11,624 - ***** Evaluation results *****
2024-01-24 04:53:11,624 -   acc = 0.7011
2024-01-24 04:53:11,624 -   f1 = 0.6681
2024-01-24 04:53:11,624 -   prec = 0.672
2024-01-24 04:53:11,624 -   rec = 0.6722
2024-01-24 04:53:11,624 - Testing is finished...
2024-01-24 04:53:11,624 - Multimodal intent recognition is finished...
2024-01-24 04:53:11,624 - Results are saved in results/msz.csv
