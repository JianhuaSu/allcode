2024-07-21 18:41:55,005 - ============================== Params ==============================
2024-07-21 18:41:55,005 - logger_name: mmim_MIntRec_multi-class_seed-4
2024-07-21 18:41:55,005 - dataset: MIntRec
2024-07-21 18:41:55,005 - data_mode: multi-class
2024-07-21 18:41:55,005 - method: mmim
2024-07-21 18:41:55,005 - text_backbone: bert-base-uncased
2024-07-21 18:41:55,005 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-07-21 18:41:55,006 - seed: 4
2024-07-21 18:41:55,006 - num_workers: 8
2024-07-21 18:41:55,006 - gpu_id: 0
2024-07-21 18:41:55,006 - data_path: /home/sharing/disk1/zhanghanlei/Datasets/public
2024-07-21 18:41:55,006 - train: True
2024-07-21 18:41:55,006 - tune: True
2024-07-21 18:41:55,006 - save_model: False
2024-07-21 18:41:55,006 - save_results: True
2024-07-21 18:41:55,006 - log_path: logs
2024-07-21 18:41:55,006 - cache_path: 
2024-07-21 18:41:55,006 - video_data_path: video_data
2024-07-21 18:41:55,006 - audio_data_path: audio_data
2024-07-21 18:41:55,007 - video_feats_path: video_feats.pkl
2024-07-21 18:41:55,007 - audio_feats_path: audio_feats.pkl
2024-07-21 18:41:55,007 - results_path: results
2024-07-21 18:41:55,007 - output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ_1/outputs/MIntRec
2024-07-21 18:41:55,007 - model_path: models
2024-07-21 18:41:55,007 - config_file_name: mmim_bert_MIntRec
2024-07-21 18:41:55,007 - results_file_name: mmim_bert_MIntRec.csv
2024-07-21 18:41:55,007 - ablation: none
2024-07-21 18:41:55,007 - padding_mode: zero
2024-07-21 18:41:55,007 - padding_loc: end
2024-07-21 18:41:55,007 - need_aligned: False
2024-07-21 18:41:55,007 - eval_monitor: f1
2024-07-21 18:41:55,007 - train_batch_size: 16
2024-07-21 18:41:55,008 - eval_batch_size: 8
2024-07-21 18:41:55,008 - test_batch_size: 8
2024-07-21 18:41:55,008 - wait_patience: 8
2024-07-21 18:41:55,008 - num_train_epochs: 100
2024-07-21 18:41:55,008 - add_va: False
2024-07-21 18:41:55,008 - cpc_activation: Tanh
2024-07-21 18:41:55,008 - mmilb_mid_activation: ReLU
2024-07-21 18:41:55,008 - mmilb_last_activation: Tanh
2024-07-21 18:41:55,008 - optim: Adam
2024-07-21 18:41:55,008 - contrast: True
2024-07-21 18:41:55,008 - bidirectional: True
2024-07-21 18:41:55,008 - grad_clip: 1.0
2024-07-21 18:41:55,009 - lr_main: 0.0001
2024-07-21 18:41:55,009 - weight_decay_main: 0.0001
2024-07-21 18:41:55,009 - lr_bert: 4e-05
2024-07-21 18:41:55,009 - weight_decay_bert: 8e-05
2024-07-21 18:41:55,009 - lr_mmilb: 0.001
2024-07-21 18:41:55,009 - weight_decay_mmilb: 0.0001
2024-07-21 18:41:55,009 - alpha: 0.1
2024-07-21 18:41:55,009 - dropout_a: 0.1
2024-07-21 18:41:55,009 - dropout_v: 0.1
2024-07-21 18:41:55,009 - dropout_prj: 0.1
2024-07-21 18:41:55,009 - n_layer: 1
2024-07-21 18:41:55,009 - cpc_layers: 1
2024-07-21 18:41:55,010 - d_vh: 32
2024-07-21 18:41:55,010 - d_ah: 32
2024-07-21 18:41:55,010 - d_vout: 16
2024-07-21 18:41:55,010 - d_aout: 16
2024-07-21 18:41:55,010 - d_prjh: 512
2024-07-21 18:41:55,010 - scale: 20
2024-07-21 18:41:55,010 - beta: 0.5
2024-07-21 18:41:55,010 - pred_output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ_1/outputs/MIntRec/mmim_MIntRec_multi-class_seed-4
2024-07-21 18:41:55,010 - model_output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ_1/outputs/MIntRec/mmim_MIntRec_multi-class_seed-4/models
2024-07-21 18:41:55,010 - ============================== End Params ==============================
2024-07-21 18:41:55,015 - Generate Text Features Begin...
2024-07-21 18:41:55,684 - Generate Text Features Finished...
2024-07-21 18:41:55,685 - Load Video Features Begin...
2024-07-21 18:41:56,110 - Load Video Features Finished...
2024-07-21 18:41:57,016 - Load Audio Features Begin...
2024-07-21 18:41:58,350 - Load Audio Features Finished...
2024-07-21 18:42:03,791 - method  begins...
2024-07-21 18:42:07,925 - Multimodal intent recognition begins...
2024-07-21 18:42:07,925 - Training begins...
2024-07-21 18:42:36,808 - ***** Epoch: 1: Eval results *****
2024-07-21 18:42:36,808 -   best_eval_score = 0.0
2024-07-21 18:42:36,808 -   eval_score = 0.5855
2024-07-21 18:42:36,808 -   train_loss_main = 2.5537
2024-07-21 18:42:36,808 -   train_loss_mmilb = 0.6307
2024-07-21 18:43:04,893 - ***** Epoch: 2: Eval results *****
2024-07-21 18:43:04,893 -   best_eval_score = 0.5855
2024-07-21 18:43:04,893 -   eval_score = 0.6734
2024-07-21 18:43:04,894 -   train_loss_main = 1.3855
2024-07-21 18:43:04,894 -   train_loss_mmilb = 0.0045
2024-07-21 18:43:32,611 - ***** Epoch: 3: Eval results *****
2024-07-21 18:43:32,611 -   best_eval_score = 0.6734
2024-07-21 18:43:32,611 -   eval_score = 0.6812
2024-07-21 18:43:32,611 -   train_loss_main = 0.9849
2024-07-21 18:43:32,611 -   train_loss_mmilb = 0.002
2024-07-21 18:44:00,867 - ***** Epoch: 4: Eval results *****
2024-07-21 18:44:00,867 -   best_eval_score = 0.6812
2024-07-21 18:44:00,867 -   eval_score = 0.6817
2024-07-21 18:44:00,868 -   train_loss_main = 0.8315
2024-07-21 18:44:00,868 -   train_loss_mmilb = 0.001
2024-07-21 18:44:28,737 - ***** Epoch: 5: Eval results *****
2024-07-21 18:44:28,738 -   best_eval_score = 0.6817
2024-07-21 18:44:28,738 -   eval_score = 0.6624
2024-07-21 18:44:28,739 -   train_loss_main = 0.766
2024-07-21 18:44:28,739 -   train_loss_mmilb = 0.0007
2024-07-21 18:44:28,740 - EarlyStopping counter: 1 out of 8
2024-07-21 18:44:57,038 - ***** Epoch: 6: Eval results *****
2024-07-21 18:44:57,038 -   best_eval_score = 0.6817
2024-07-21 18:44:57,039 -   eval_score = 0.6566
2024-07-21 18:44:57,039 -   train_loss_main = 0.7578
2024-07-21 18:44:57,040 -   train_loss_mmilb = 0.0005
2024-07-21 18:44:57,040 - EarlyStopping counter: 2 out of 8
2024-07-21 18:45:25,526 - ***** Epoch: 7: Eval results *****
2024-07-21 18:45:25,526 -   best_eval_score = 0.6817
2024-07-21 18:45:25,527 -   eval_score = 0.6665
2024-07-21 18:45:25,527 -   train_loss_main = 0.7142
2024-07-21 18:45:25,527 -   train_loss_mmilb = 0.0005
2024-07-21 18:45:25,527 - EarlyStopping counter: 3 out of 8
2024-07-21 18:45:54,136 - ***** Epoch: 8: Eval results *****
2024-07-21 18:45:54,137 -   best_eval_score = 0.6817
2024-07-21 18:45:54,137 -   eval_score = 0.6593
2024-07-21 18:45:54,138 -   train_loss_main = 0.6958
2024-07-21 18:45:54,138 -   train_loss_mmilb = 0.0005
2024-07-21 18:45:54,139 - EarlyStopping counter: 4 out of 8
2024-07-21 18:46:22,604 - ***** Epoch: 9: Eval results *****
2024-07-21 18:46:22,604 -   best_eval_score = 0.6817
2024-07-21 18:46:22,604 -   eval_score = 0.6626
2024-07-21 18:46:22,604 -   train_loss_main = 0.6657
2024-07-21 18:46:22,604 -   train_loss_mmilb = 0.0005
2024-07-21 18:46:22,604 - EarlyStopping counter: 5 out of 8
2024-07-21 18:46:51,184 - ***** Epoch: 10: Eval results *****
2024-07-21 18:46:51,184 -   best_eval_score = 0.6817
2024-07-21 18:46:51,184 -   eval_score = 0.6759
2024-07-21 18:46:51,184 -   train_loss_main = 0.6446
2024-07-21 18:46:51,184 -   train_loss_mmilb = 0.0005
2024-07-21 18:46:51,185 - EarlyStopping counter: 6 out of 8
2024-07-21 18:47:19,801 - ***** Epoch: 11: Eval results *****
2024-07-21 18:47:19,801 -   best_eval_score = 0.6817
2024-07-21 18:47:19,801 -   eval_score = 0.6749
2024-07-21 18:47:19,801 -   train_loss_main = 0.6301
2024-07-21 18:47:19,801 -   train_loss_mmilb = 0.0004
2024-07-21 18:47:19,801 - EarlyStopping counter: 7 out of 8
2024-07-21 18:47:48,597 - ***** Epoch: 12: Eval results *****
2024-07-21 18:47:48,598 -   best_eval_score = 0.6817
2024-07-21 18:47:48,598 -   eval_score = 0.6579
2024-07-21 18:47:48,598 -   train_loss_main = 0.6204
2024-07-21 18:47:48,598 -   train_loss_mmilb = 0.0004
2024-07-21 18:47:48,598 - EarlyStopping counter: 8 out of 8
2024-07-21 18:47:48,598 - EarlyStopping at epoch 12
2024-07-21 18:47:48,668 - Training is finished...
2024-07-21 18:47:48,668 - Testing begins...
2024-07-21 18:47:52,726 - ***** Test: Confusion Matrix *****
2024-07-21 18:47:52,729 - [[33  2  0  0 10  0  2  0  0  3  1  0  5  1  0  0  0  0  0  0]
 [ 0 37  0  0  0  1  2  0  0  0  1  0  2  0  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0 15  0  2  0  0  1  1  1  0  0  1  0  0  1  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  2  0  0  3  0  3  0  0  0  0  0  2  0  0  0  1  0  0  0]
 [ 1  0  0  0  0  0  1  6  0  0  1  0  0  0  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  2  3  0  0  0  0  1  0  1  0  0  0  1]
 [ 1  0  0  0  0  0  0  0  0  5  1  0  0  0  0  1  0  2  0  0]
 [ 2  0  0  0  0  0  1  0  0  1 14  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  1 17  0  0  0  0  0  0  0  0]
 [ 3  2  0  0  1  0  0  0  1  0  1  0 41  0  4  0  3  1  0  0]
 [ 0  1  0  0  0  0  2  0  0  0  1  1  1 17  2  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  2 17  0  1  0  0  2]
 [ 0  0  0  0  1  0  0  1  0  0  0  0  6  0  0 12  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  1  0 14  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0 14  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0 10  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  9]]
2024-07-21 18:47:52,730 - ***** Evaluation results *****
2024-07-21 18:47:52,730 -   acc = 0.7393
2024-07-21 18:47:52,731 -   f1 = 0.721
2024-07-21 18:47:52,731 -   prec = 0.7331
2024-07-21 18:47:52,731 -   rec = 0.7285
2024-07-21 18:47:52,732 - Testing is finished...
2024-07-21 18:47:52,732 - Multimodal intent recognition is finished...
2024-07-21 18:47:52,732 - Results are saved in results/mmim_bert_MIntRec.csv
