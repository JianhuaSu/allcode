2024-05-08 04:17:50,627 - ============================== Params ==============================
2024-05-08 04:17:50,628 - logger_name: msz_MIntRec2_multi-class_seed-4_2024-05-08-04-17-50
2024-05-08 04:17:50,628 - dataset: MIntRec2
2024-05-08 04:17:50,631 - data_mode: multi-class
2024-05-08 04:17:50,631 - method: msz
2024-05-08 04:17:50,631 - text_backbone: bert-base-uncased
2024-05-08 04:17:50,631 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-08 04:17:50,631 - seed: 4
2024-05-08 04:17:50,631 - num_workers: 8
2024-05-08 04:17:50,631 - gpu_id: 0
2024-05-08 04:17:50,631 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-08 04:17:50,631 - train: True
2024-05-08 04:17:50,631 - tune: True
2024-05-08 04:17:50,631 - save_model: False
2024-05-08 04:17:50,631 - save_results: True
2024-05-08 04:17:50,631 - log_path: logs
2024-05-08 04:17:50,631 - cache_path: 
2024-05-08 04:17:50,631 - video_data_path: video_data
2024-05-08 04:17:50,631 - audio_data_path: audio_data
2024-05-08 04:17:50,631 - video_feats_path: video_feats.pkl
2024-05-08 04:17:50,631 - audio_feats_path: audio_feats.pkl
2024-05-08 04:17:50,631 - results_path: results
2024-05-08 04:17:50,631 - output_path: /home/sharing/disk2/sjh/Outputs/ablation_MIntRec2
2024-05-08 04:17:50,631 - model_path: models
2024-05-08 04:17:50,631 - config_file_name: msz_MIntRec2
2024-05-08 04:17:50,631 - results_file_name: ablation_msz.csv
2024-05-08 04:17:50,631 - ablation: no_selfatt
2024-05-08 04:17:50,631 - padding_mode: zero
2024-05-08 04:17:50,631 - padding_loc: end
2024-05-08 04:17:50,631 - need_aligned: False
2024-05-08 04:17:50,631 - eval_monitor: f1
2024-05-08 04:17:50,631 - train_batch_size: 32
2024-05-08 04:17:50,631 - eval_batch_size: 16
2024-05-08 04:17:50,631 - test_batch_size: 16
2024-05-08 04:17:50,631 - wait_patience: 8
2024-05-08 04:17:50,631 - hidden_dims: 768
2024-05-08 04:17:50,631 - num_attention_heads: 6
2024-05-08 04:17:50,631 - attention_probs_dropout_prob: 0.3
2024-05-08 04:17:50,631 - hidden_dropout_prob: 0.5
2024-05-08 04:17:50,631 - intermediate_size: 768
2024-05-08 04:17:50,631 - num_hidden_layers: 6
2024-05-08 04:17:50,632 - max_position_embeddings: 1000
2024-05-08 04:17:50,632 - position_embedding_type: absolute
2024-05-08 04:17:50,632 - batch_first: True
2024-05-08 04:17:50,632 - dropout: 0.2
2024-05-08 04:17:50,632 - aligned_method: conv1d
2024-05-08 04:17:50,632 - num_train_epochs: 100
2024-05-08 04:17:50,632 - lr: 5e-06
2024-05-08 04:17:50,632 - lr_mode: max
2024-05-08 04:17:50,632 - patience: 5
2024-05-08 04:17:50,632 - factor: 0.2
2024-05-08 04:17:50,632 - pred_output_path: /home/sharing/disk2/sjh/Outputs/ablation_MIntRec2/msz_MIntRec2_multi-class_seed-4_2024-05-08-04-17-50
2024-05-08 04:17:50,632 - model_output_path: /home/sharing/disk2/sjh/Outputs/ablation_MIntRec2/msz_MIntRec2_multi-class_seed-4_2024-05-08-04-17-50/models
2024-05-08 04:17:50,632 - num_labels: 30
2024-05-08 04:17:50,632 - text_feat_dim: 768
2024-05-08 04:17:50,632 - video_feat_dim: 256
2024-05-08 04:17:50,632 - audio_feat_dim: 768
2024-05-08 04:17:50,632 - text_seq_len: 50
2024-05-08 04:17:50,632 - video_seq_len: 180
2024-05-08 04:17:50,632 - audio_seq_len: 400
2024-05-08 04:17:50,632 - device: cuda:0
2024-05-08 04:17:50,632 - ============================== End Params ==============================
2024-05-08 04:17:50,645 - Generate Text Features Begin...
2024-05-08 04:17:52,272 - Generate Text Features Finished...
2024-05-08 04:17:52,273 - Load Video Features Begin...
2024-05-08 04:17:53,279 - Load Video Features Finished...
2024-05-08 04:17:54,819 - Load Audio Features Begin...
2024-05-08 04:17:58,618 - Load Audio Features Finished...
2024-05-08 04:18:08,432 - method  begins...
2024-05-08 04:18:09,992 - Multimodal intent recognition begins...
2024-05-08 04:18:09,992 - Training begins...
2024-05-08 04:19:01,840 - ***** Epoch: 1: Eval results *****
2024-05-08 04:19:01,840 -   train_loss = 2.8616
2024-05-08 04:19:01,840 -   best_eval_score = 0.0
2024-05-08 04:19:01,840 -   eval_score = 0.2371
2024-05-08 04:19:53,923 - ***** Epoch: 2: Eval results *****
2024-05-08 04:19:53,923 -   train_loss = 1.8693
2024-05-08 04:19:53,923 -   best_eval_score = 0.2371
2024-05-08 04:19:53,923 -   eval_score = 0.3774
2024-05-08 04:20:46,103 - ***** Epoch: 3: Eval results *****
2024-05-08 04:20:46,103 -   train_loss = 1.4425
2024-05-08 04:20:46,103 -   best_eval_score = 0.3774
2024-05-08 04:20:46,103 -   eval_score = 0.43
2024-05-08 04:21:38,220 - ***** Epoch: 4: Eval results *****
2024-05-08 04:21:38,220 -   train_loss = 1.2108
2024-05-08 04:21:38,220 -   best_eval_score = 0.43
2024-05-08 04:21:38,220 -   eval_score = 0.4675
2024-05-08 04:22:31,114 - ***** Epoch: 5: Eval results *****
2024-05-08 04:22:31,114 -   train_loss = 1.0447
2024-05-08 04:22:31,114 -   best_eval_score = 0.4675
2024-05-08 04:22:31,114 -   eval_score = 0.4723
2024-05-08 04:23:24,330 - ***** Epoch: 6: Eval results *****
2024-05-08 04:23:24,330 -   train_loss = 0.8979
2024-05-08 04:23:24,330 -   best_eval_score = 0.4723
2024-05-08 04:23:24,330 -   eval_score = 0.5002
2024-05-08 04:24:16,619 - ***** Epoch: 7: Eval results *****
2024-05-08 04:24:16,619 -   train_loss = 0.7665
2024-05-08 04:24:16,620 -   best_eval_score = 0.5002
2024-05-08 04:24:16,620 -   eval_score = 0.4996
2024-05-08 04:24:16,620 - EarlyStopping counter: 1 out of 8
2024-05-08 04:25:09,047 - ***** Epoch: 8: Eval results *****
2024-05-08 04:25:09,047 -   train_loss = 0.6341
2024-05-08 04:25:09,048 -   best_eval_score = 0.5002
2024-05-08 04:25:09,048 -   eval_score = 0.5221
2024-05-08 04:26:01,712 - ***** Epoch: 9: Eval results *****
2024-05-08 04:26:01,713 -   train_loss = 0.5998
2024-05-08 04:26:01,713 -   best_eval_score = 0.5221
2024-05-08 04:26:01,713 -   eval_score = 0.5121
2024-05-08 04:26:01,713 - EarlyStopping counter: 1 out of 8
2024-05-08 04:26:54,306 - ***** Epoch: 10: Eval results *****
2024-05-08 04:26:54,306 -   train_loss = 0.5791
2024-05-08 04:26:54,306 -   best_eval_score = 0.5221
2024-05-08 04:26:54,306 -   eval_score = 0.5201
2024-05-08 04:26:54,306 - EarlyStopping counter: 2 out of 8
2024-05-08 04:27:47,350 - ***** Epoch: 11: Eval results *****
2024-05-08 04:27:47,350 -   train_loss = 0.5516
2024-05-08 04:27:47,350 -   best_eval_score = 0.5221
2024-05-08 04:27:47,350 -   eval_score = 0.5209
2024-05-08 04:27:47,350 - EarlyStopping counter: 3 out of 8
2024-05-08 04:28:41,562 - ***** Epoch: 12: Eval results *****
2024-05-08 04:28:41,562 -   train_loss = 0.5311
2024-05-08 04:28:41,562 -   best_eval_score = 0.5221
2024-05-08 04:28:41,562 -   eval_score = 0.5195
2024-05-08 04:28:41,562 - EarlyStopping counter: 4 out of 8
2024-05-08 04:29:37,289 - ***** Epoch: 13: Eval results *****
2024-05-08 04:29:37,290 -   train_loss = 0.512
2024-05-08 04:29:37,290 -   best_eval_score = 0.5221
2024-05-08 04:29:37,290 -   eval_score = 0.5198
2024-05-08 04:29:37,290 - EarlyStopping counter: 5 out of 8
2024-05-08 04:30:33,057 - ***** Epoch: 14: Eval results *****
2024-05-08 04:30:33,058 -   train_loss = 0.4797
2024-05-08 04:30:33,058 -   best_eval_score = 0.5221
2024-05-08 04:30:33,058 -   eval_score = 0.5184
2024-05-08 04:30:33,058 - EarlyStopping counter: 6 out of 8
2024-05-08 04:31:28,519 - ***** Epoch: 15: Eval results *****
2024-05-08 04:31:28,519 -   train_loss = 0.4797
2024-05-08 04:31:28,519 -   best_eval_score = 0.5221
2024-05-08 04:31:28,519 -   eval_score = 0.5193
2024-05-08 04:31:28,519 - EarlyStopping counter: 7 out of 8
2024-05-08 04:32:23,220 - ***** Epoch: 16: Eval results *****
2024-05-08 04:32:23,220 -   train_loss = 0.4786
2024-05-08 04:32:23,220 -   best_eval_score = 0.5221
2024-05-08 04:32:23,220 -   eval_score = 0.5195
2024-05-08 04:32:23,221 - EarlyStopping counter: 8 out of 8
2024-05-08 04:32:23,221 - EarlyStopping at epoch 16
2024-05-08 04:32:23,226 - Training is finished...
2024-05-08 04:32:23,227 - Testing begins...
2024-05-08 04:32:33,024 - ***** Test: Confusion Matrix *****
2024-05-08 04:32:33,027 - [[ 47   0  14   0   0   0   0   0   0   0   2   0   0   0   0   0   0   1
    0   0   0   1   1   0   2   0   0   0   0   0]
 [  0  55   0   0   8   1   2   0   3   0   4   1   2   0   2   0   0   8
    0   2   0   2   2   1   1   0   0   3   0   0]
 [  7   0  45   0   1   0   0   0   0   0   1   0   0   0   2   0   0   3
    0   0   0   0   0   2   3   0   0   0   0   0]
 [  0   0   0  62   0   0   0   1   0   1   0   0   0   0   0   0   0   1
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   6   0   0  36   0   0   0   1   0   0   0   0   0   0   0   0   2
    0   0   0   2   0   1   1   1   0   0   1   0]
 [  0   1   0   0   2  23   0   0   0   1   0   0   1   0   2   0   0   6
    0   0   0   0   0   0   0   1   0   0   0   0]
 [  0   1   0   0   0   2  28  10   0   2   1   1   3   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   5  31   0   0   4   1   4   0   0   0   1   0
    0   0   0   0   1   0   0   0   0   0   0   0]
 [  1   2   1   3   1   0   0   0  21   1   0   1   1   0   5   0   0   3
    0   0   0   1   6   0   2   0   0   0   0   0]
 [  0   1   1   1   1   0   0   0   1  56   0   6   6   0  12   0   0   6
    1   0   1   1   3   0   4   2   1   3   0   0]
 [  2   0   0   0   0   4   5   2   0   2  44   0  27   0   1   0   0   2
    0   3   0   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   1   0   0   7   1  19   8   0   1   0   0   1
    2   0   0   0   3   0   1   0   0   1   0   2]
 [  0   3   0   0   0   0   4   7   0   6  25   2  84   0   1   0   1   0
    0   1   0   0   1   0   0   0   0   0   0   0]
 [  0   0   2   0   1   0   0   0   0   3   0   0   0   0   3   1   0   3
    3   0   0   0   1   0   0   0   0   0   0   0]
 [  0   3   1   0   0   2   1   0   2   9   1   1   1   0 117   0   0  26
    5   0   0   0  15   1   4   0   0   4   0   0]
 [  0   0   1   0   1   0   0   0   0   5   0   0   0   0   1   4   0   4
    2   0   0   1   2   0   0   0   0   0   1   0]
 [  0   0   0   0   1   0   0   3   0   0   2   0   1   0   0   0  55   0
    3   0   0   0   0   0   0   0   0   1   0   0]
 [  0   4   1   0   5   2   0   0   1  12   2   1   0   0  14   1   2 131
   13   3   0   4   6   7   0   1   1   3   2   1]
 [  0   2   1   0   0   0   1   0   0   4   1   0   0   0   7   1   3   8
   29   0   0   0   2   0   1   0   0   0   0   0]
 [  0   5   0   0   0   0   2   0   0   0   1   0   0   0   0   0   0   1
    0   5   0   3   0   0   0   0   0   0   0   0]
 [  0   2   2   0   2   0   0   0   0   2   1   1   0   0   5   0   0   3
    6   0   1   0   1   0   1   0   0   2   0   0]
 [  6   1   0   0   1   0   0   0   0   6   0   0   0   0   0   0   5   1
    0   0   0  26   0   5   1   1   0   0   0   0]
 [  0   0   1   1   0   1   0   0   1   5   0   2   0   0  11   1   0   1
    1   0   0   0  84   0   1   6   1   0   0   0]
 [  0   3   1   0   1   0   0   0   0   2   0   0   0   0   0   0   0   7
    0   0   0   4   0  20   0   0   0   0   0   0]
 [  2   0   3   0   0   0   0   0   0   1   0   2   0   0   1   0   0   3
    1   0   0   0   1   1  88   0   0   8   2   0]
 [  1   1   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   2
    0   0   0   0   3   0   1  21   0   0   0   1]
 [  0   0   0   1   0   0   0   0   0   2   0   0   0   0   1   0   0   5
    0   0   0   2   2   0   0   0   3   0   1   0]
 [  0   2   3   0   1   0   0   1   1   8   2   5   3   0   2   0   0   5
    1   0   1   0   1   0  10   1   0   9   1   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   1   0
    0   0   0   0   0   0   0   0   0   0  56   0]
 [  0   1   0   0   2   0   0   0   3   2   1   1   0   0   0   0   0   4
    1   0   0   0   0   0   1   1   0   0   0   2]]
2024-05-08 04:32:33,027 - ***** Evaluation results *****
2024-05-08 04:32:33,027 -   acc = 0.5912
2024-05-08 04:32:33,027 -   f1 = 0.5166
2024-05-08 04:32:33,028 -   prec = 0.5404
2024-05-08 04:32:33,028 -   rec = 0.5189
2024-05-08 04:32:33,028 - Testing is finished...
2024-05-08 04:32:33,028 - Multimodal intent recognition is finished...
2024-05-08 04:32:33,028 - Results are saved in results/ablation_msz.csv
