2024-01-07 12:49:32,161 - ============================== Params ==============================
2024-01-07 12:49:32,161 - logger_name: msz_MIntRec_multi-class_seed-4_2024-01-07-12-49-32
2024-01-07 12:49:32,161 - dataset: MIntRec
2024-01-07 12:49:32,161 - data_mode: multi-class
2024-01-07 12:49:32,161 - method: msz
2024-01-07 12:49:32,161 - text_backbone: bert-base-uncased
2024-01-07 12:49:32,161 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-07 12:49:32,161 - seed: 4
2024-01-07 12:49:32,161 - num_workers: 8
2024-01-07 12:49:32,161 - gpu_id: 1
2024-01-07 12:49:32,162 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-07 12:49:32,162 - train: True
2024-01-07 12:49:32,162 - tune: False
2024-01-07 12:49:32,162 - save_model: False
2024-01-07 12:49:32,162 - save_results: True
2024-01-07 12:49:32,162 - log_path: logs
2024-01-07 12:49:32,162 - cache_path: 
2024-01-07 12:49:32,162 - video_data_path: video_data
2024-01-07 12:49:32,162 - audio_data_path: audio_data
2024-01-07 12:49:32,162 - video_feats_path: video_feats.pkl
2024-01-07 12:49:32,162 - audio_feats_path: audio_feats.pkl
2024-01-07 12:49:32,162 - results_path: results
2024-01-07 12:49:32,162 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-07 12:49:32,162 - model_path: models
2024-01-07 12:49:32,162 - config_file_name: msz
2024-01-07 12:49:32,162 - results_file_name: msz.csv
2024-01-07 12:49:32,162 - padding_mode: zero
2024-01-07 12:49:32,162 - padding_loc: end
2024-01-07 12:49:32,162 - need_aligned: False
2024-01-07 12:49:32,162 - eval_monitor: f1
2024-01-07 12:49:32,162 - train_batch_size: 16
2024-01-07 12:49:32,162 - eval_batch_size: 8
2024-01-07 12:49:32,162 - test_batch_size: 8
2024-01-07 12:49:32,162 - wait_patience: 8
2024-01-07 12:49:32,162 - nheads: 2
2024-01-07 12:49:32,162 - encoder_layers: 2
2024-01-07 12:49:32,162 - attn_dropout: 0.1
2024-01-07 12:49:32,162 - relu_dropout: 0.1
2024-01-07 12:49:32,162 - embed_dropout: 0.1
2024-01-07 12:49:32,162 - res_dropout: 0.1
2024-01-07 12:49:32,162 - attn_mask: False
2024-01-07 12:49:32,162 - hidden_size: 768
2024-01-07 12:49:32,162 - num_attention_heads: 12
2024-01-07 12:49:32,162 - attention_probs_dropout_prob: 0.2
2024-01-07 12:49:32,162 - hidden_dropout_prob: 0.2
2024-01-07 12:49:32,162 - intermediate_size: 768
2024-01-07 12:49:32,162 - num_hidden_layers: 3
2024-01-07 12:49:32,162 - max_position_embeddings: 512
2024-01-07 12:49:32,163 - position_embedding_type: absolute
2024-01-07 12:49:32,163 - batch_first: True
2024-01-07 12:49:32,163 - hidden_dims: 768
2024-01-07 12:49:32,163 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-07 12:49:32,163 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-07 12:49:32,163 - ta_loss: 0.1
2024-01-07 12:49:32,163 - tv_loss: 0.1
2024-01-07 12:49:32,163 - av_loss: 0.1
2024-01-07 12:49:32,163 - aligned_method: conv1d
2024-01-07 12:49:32,163 - grad_clip: -1
2024-01-07 12:49:32,163 - num_train_epochs: 100
2024-01-07 12:49:32,163 - warmup_proportion: 0.1
2024-01-07 12:49:32,163 - lr: 1e-06
2024-01-07 12:49:32,163 - weight_decay: 0.01
2024-01-07 12:49:32,163 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-07-12-49-32
2024-01-07 12:49:32,163 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-07-12-49-32/models
2024-01-07 12:49:32,163 - ============================== End Params ==============================
2024-01-07 12:49:32,166 - Generate Text Features Begin...
2024-01-07 12:49:32,678 - Generate Text Features Finished...
2024-01-07 12:49:32,679 - Load Video Features Begin...
2024-01-07 12:49:33,023 - Load Video Features Finished...
2024-01-07 12:49:33,747 - Load Audio Features Begin...
2024-01-07 12:49:35,203 - Load Audio Features Finished...
2024-01-07 12:49:39,242 - method  begins...
2024-01-07 12:49:44,645 - Multimodal intent recognition begins...
2024-01-07 12:49:44,646 - Training begins...
2024-01-07 12:50:04,174 - ***** Epoch: 1: Eval results *****
2024-01-07 12:50:04,174 -   train_loss = 2.9908
2024-01-07 12:50:04,174 -   best_eval_score = 0.0
2024-01-07 12:50:04,174 -   eval_score = 0.0114
2024-01-07 12:50:23,250 - ***** Epoch: 2: Eval results *****
2024-01-07 12:50:23,250 -   train_loss = 2.9408
2024-01-07 12:50:23,250 -   best_eval_score = 0.0114
2024-01-07 12:50:23,250 -   eval_score = 0.0199
2024-01-07 12:50:41,275 - ***** Epoch: 3: Eval results *****
2024-01-07 12:50:41,276 -   train_loss = 2.8635
2024-01-07 12:50:41,276 -   best_eval_score = 0.0199
2024-01-07 12:50:41,276 -   eval_score = 0.0338
2024-01-07 12:50:58,739 - ***** Epoch: 4: Eval results *****
2024-01-07 12:50:58,739 -   train_loss = 2.7614
2024-01-07 12:50:58,739 -   best_eval_score = 0.0338
2024-01-07 12:50:58,739 -   eval_score = 0.0362
2024-01-07 12:51:17,283 - ***** Epoch: 5: Eval results *****
2024-01-07 12:51:17,283 -   train_loss = 2.6188
2024-01-07 12:51:17,283 -   best_eval_score = 0.0362
2024-01-07 12:51:17,283 -   eval_score = 0.0574
2024-01-07 12:51:32,366 - ***** Epoch: 6: Eval results *****
2024-01-07 12:51:32,366 -   train_loss = 2.3946
2024-01-07 12:51:32,366 -   best_eval_score = 0.0574
2024-01-07 12:51:32,367 -   eval_score = 0.2069
2024-01-07 12:51:50,271 - ***** Epoch: 7: Eval results *****
2024-01-07 12:51:50,271 -   train_loss = 2.0773
2024-01-07 12:51:50,271 -   best_eval_score = 0.2069
2024-01-07 12:51:50,271 -   eval_score = 0.2834
2024-01-07 12:52:07,997 - ***** Epoch: 8: Eval results *****
2024-01-07 12:52:07,997 -   train_loss = 1.7296
2024-01-07 12:52:07,998 -   best_eval_score = 0.2834
2024-01-07 12:52:07,998 -   eval_score = 0.4162
2024-01-07 12:52:26,394 - ***** Epoch: 9: Eval results *****
2024-01-07 12:52:26,394 -   train_loss = 1.3811
2024-01-07 12:52:26,394 -   best_eval_score = 0.4162
2024-01-07 12:52:26,395 -   eval_score = 0.503
2024-01-07 12:52:44,286 - ***** Epoch: 10: Eval results *****
2024-01-07 12:52:44,287 -   train_loss = 1.1108
2024-01-07 12:52:44,287 -   best_eval_score = 0.503
2024-01-07 12:52:44,287 -   eval_score = 0.5218
2024-01-07 12:53:00,991 - ***** Epoch: 11: Eval results *****
2024-01-07 12:53:00,991 -   train_loss = 0.8504
2024-01-07 12:53:00,991 -   best_eval_score = 0.5218
2024-01-07 12:53:00,991 -   eval_score = 0.5439
2024-01-07 12:53:19,523 - ***** Epoch: 12: Eval results *****
2024-01-07 12:53:19,523 -   train_loss = 0.6417
2024-01-07 12:53:19,523 -   best_eval_score = 0.5439
2024-01-07 12:53:19,523 -   eval_score = 0.5913
2024-01-07 12:53:36,183 - ***** Epoch: 13: Eval results *****
2024-01-07 12:53:36,183 -   train_loss = 0.4534
2024-01-07 12:53:36,183 -   best_eval_score = 0.5913
2024-01-07 12:53:36,183 -   eval_score = 0.6321
2024-01-07 12:53:54,080 - ***** Epoch: 14: Eval results *****
2024-01-07 12:53:54,080 -   train_loss = 0.3733
2024-01-07 12:53:54,080 -   best_eval_score = 0.6321
2024-01-07 12:53:54,080 -   eval_score = 0.6278
2024-01-07 12:53:54,080 - EarlyStopping counter: 1 out of 8
2024-01-07 12:54:12,623 - ***** Epoch: 15: Eval results *****
2024-01-07 12:54:12,623 -   train_loss = 0.2272
2024-01-07 12:54:12,623 -   best_eval_score = 0.6321
2024-01-07 12:54:12,623 -   eval_score = 0.6537
2024-01-07 12:54:29,013 - ***** Epoch: 16: Eval results *****
2024-01-07 12:54:29,013 -   train_loss = 0.1918
2024-01-07 12:54:29,014 -   best_eval_score = 0.6537
2024-01-07 12:54:29,014 -   eval_score = 0.6399
2024-01-07 12:54:29,014 - EarlyStopping counter: 1 out of 8
2024-01-07 12:54:48,396 - ***** Epoch: 17: Eval results *****
2024-01-07 12:54:48,397 -   train_loss = 0.1168
2024-01-07 12:54:48,397 -   best_eval_score = 0.6537
2024-01-07 12:54:48,397 -   eval_score = 0.6235
2024-01-07 12:54:48,397 - EarlyStopping counter: 2 out of 8
2024-01-07 12:55:06,942 - ***** Epoch: 18: Eval results *****
2024-01-07 12:55:06,942 -   train_loss = 0.0958
2024-01-07 12:55:06,942 -   best_eval_score = 0.6537
2024-01-07 12:55:06,942 -   eval_score = 0.6152
2024-01-07 12:55:06,942 - EarlyStopping counter: 3 out of 8
2024-01-07 12:55:25,708 - ***** Epoch: 19: Eval results *****
2024-01-07 12:55:25,708 -   train_loss = 0.0581
2024-01-07 12:55:25,708 -   best_eval_score = 0.6537
2024-01-07 12:55:25,708 -   eval_score = 0.6201
2024-01-07 12:55:25,708 - EarlyStopping counter: 4 out of 8
2024-01-07 12:55:46,157 - ***** Epoch: 20: Eval results *****
2024-01-07 12:55:46,158 -   train_loss = 0.0407
2024-01-07 12:55:46,158 -   best_eval_score = 0.6537
2024-01-07 12:55:46,158 -   eval_score = 0.6188
2024-01-07 12:55:46,158 - EarlyStopping counter: 5 out of 8
2024-01-07 12:56:05,068 - ***** Epoch: 21: Eval results *****
2024-01-07 12:56:05,069 -   train_loss = 0.0335
2024-01-07 12:56:05,069 -   best_eval_score = 0.6537
2024-01-07 12:56:05,069 -   eval_score = 0.6196
2024-01-07 12:56:05,069 - EarlyStopping counter: 6 out of 8
2024-01-07 12:56:23,926 - ***** Epoch: 22: Eval results *****
2024-01-07 12:56:23,927 -   train_loss = 0.0242
2024-01-07 12:56:23,927 -   best_eval_score = 0.6537
2024-01-07 12:56:23,927 -   eval_score = 0.6334
2024-01-07 12:56:23,927 - EarlyStopping counter: 7 out of 8
2024-01-07 12:56:43,452 - ***** Epoch: 23: Eval results *****
2024-01-07 12:56:43,453 -   train_loss = 0.0224
2024-01-07 12:56:43,453 -   best_eval_score = 0.6537
2024-01-07 12:56:43,453 -   eval_score = 0.628
2024-01-07 12:56:43,453 - EarlyStopping counter: 8 out of 8
2024-01-07 12:56:43,453 - EarlyStopping at epoch 23
2024-01-07 12:56:43,454 - Training is finished...
2024-01-07 12:56:43,455 - Testing begins...
2024-01-07 12:56:47,506 - ***** Test: Confusion Matrix *****
2024-01-07 12:56:47,507 - [[25  1  0  0 16  0  1  1  0  5  0  1  6  1  0  0  0  0  0  0]
 [ 0 40  0  1  0  0  1  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 0  0 27  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0 20  0  0  0  0  1  0  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0  0  6  0  1  2  0  0  0  0  0  0  0  1  0  0  0  1]
 [ 3  0  0  0  0  0  0  5  0  1  0  0  0  0  0  0  1  0  0  0]
 [ 0  0  0  0  1  0  0  5  1  0  0  0  0  2  0  1  0  0  0  0]
 [ 1  0  0  0  2  0  0  0  0  3  1  0  0  0  0  3  0  0  0  0]
 [ 0  1  0  0  0  0  2  1  0  4  9  0  0  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  2  0  0  0  0 16  0  0  0  0  0  0  1  0]
 [ 3  3  1  0  2  0  0  1  3  0  0  1 29  3  0  5  0  1  3  2]
 [ 0  1  0  0  1  0  2  0  0  0  0  1  2 18  0  0  0  0  0  0]
 [ 0  0  0  0  2  0  0  0  1  0  0  0  0  4 10  0  1  0  0  4]
 [ 0  0  0  0  0  0  0  1  2  0  0  0  3  0  0 14  0  0  0  1]
 [ 0  0  0  0  0  0  0  3  0  0  0  0  0  0  0  0 14  0  0  0]
 [ 0  0  0  0  2  0  0  0  0  2  0  0  1  0  0  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0 11  0]
 [ 0  0  0  0  0  0  1  0  0  0  0  2  0  0  0  0  0  0  0  7]]
2024-01-07 12:56:47,507 - ***** Evaluation results *****
2024-01-07 12:56:47,507 -   acc = 0.6674
2024-01-07 12:56:47,507 -   f1 = 0.6309
2024-01-07 12:56:47,507 -   prec = 0.6527
2024-01-07 12:56:47,507 -   rec = 0.651
2024-01-07 12:56:47,508 - Testing is finished...
2024-01-07 12:56:47,508 - Multimodal intent recognition is finished...
2024-01-07 12:56:47,508 - Results are saved in results/msz.csv
