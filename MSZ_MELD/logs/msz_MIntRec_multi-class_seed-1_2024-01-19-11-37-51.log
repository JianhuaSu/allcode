2024-01-19 11:37:51,105 - ============================== Params ==============================
2024-01-19 11:37:51,105 - logger_name: msz_MIntRec_multi-class_seed-1_2024-01-19-11-37-51
2024-01-19 11:37:51,105 - dataset: MIntRec
2024-01-19 11:37:51,105 - data_mode: multi-class
2024-01-19 11:37:51,105 - method: msz
2024-01-19 11:37:51,105 - text_backbone: bert-base-uncased
2024-01-19 11:37:51,105 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-19 11:37:51,105 - seed: 1
2024-01-19 11:37:51,105 - num_workers: 8
2024-01-19 11:37:51,105 - gpu_id: 1
2024-01-19 11:37:51,105 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-19 11:37:51,105 - train: True
2024-01-19 11:37:51,105 - tune: False
2024-01-19 11:37:51,105 - save_model: False
2024-01-19 11:37:51,106 - save_results: True
2024-01-19 11:37:51,106 - log_path: logs
2024-01-19 11:37:51,106 - cache_path: 
2024-01-19 11:37:51,106 - video_data_path: video_data
2024-01-19 11:37:51,106 - audio_data_path: audio_data
2024-01-19 11:37:51,106 - video_feats_path: video_feats.pkl
2024-01-19 11:37:51,106 - audio_feats_path: audio_feats.pkl
2024-01-19 11:37:51,106 - results_path: results
2024-01-19 11:37:51,106 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-19 11:37:51,106 - model_path: models
2024-01-19 11:37:51,106 - config_file_name: msz
2024-01-19 11:37:51,106 - results_file_name: msz.csv
2024-01-19 11:37:51,106 - padding_mode: zero
2024-01-19 11:37:51,106 - padding_loc: end
2024-01-19 11:37:51,106 - need_aligned: False
2024-01-19 11:37:51,106 - eval_monitor: f1
2024-01-19 11:37:51,106 - train_batch_size: 16
2024-01-19 11:37:51,106 - eval_batch_size: 8
2024-01-19 11:37:51,106 - test_batch_size: 8
2024-01-19 11:37:51,106 - wait_patience: 8
2024-01-19 11:37:51,106 - hidden_size: 768
2024-01-19 11:37:51,106 - num_attention_heads: 8
2024-01-19 11:37:51,106 - attention_probs_dropout_prob: 0.2
2024-01-19 11:37:51,106 - hidden_dropout_prob: 0.2
2024-01-19 11:37:51,106 - intermediate_size: 768
2024-01-19 11:37:51,106 - num_hidden_layers: 6
2024-01-19 11:37:51,106 - max_position_embeddings: 768
2024-01-19 11:37:51,106 - position_embedding_type: absolute
2024-01-19 11:37:51,106 - batch_first: True
2024-01-19 11:37:51,106 - hidden_dims: 768
2024-01-19 11:37:51,106 - dropout: 0.2
2024-01-19 11:37:51,107 - aligned_method: conv1d
2024-01-19 11:37:51,107 - num_train_epochs: 100
2024-01-19 11:37:51,107 - lr: 8e-06
2024-01-19 11:37:51,107 - scale: 16
2024-01-19 11:37:51,107 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-19-11-37-51
2024-01-19 11:37:51,107 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-19-11-37-51/models
2024-01-19 11:37:51,107 - ============================== End Params ==============================
2024-01-19 11:37:51,110 - Generate Text Features Begin...
2024-01-19 11:37:51,593 - Generate Text Features Finished...
2024-01-19 11:37:51,593 - Load Video Features Begin...
2024-01-19 11:37:51,868 - Load Video Features Finished...
2024-01-19 11:37:52,408 - Load Audio Features Begin...
2024-01-19 11:38:19,459 - Load Audio Features Finished...
2024-01-19 11:38:23,852 - method  begins...
2024-01-19 11:38:29,423 - Multimodal intent recognition begins...
2024-01-19 11:38:29,424 - Training begins...
2024-01-19 11:38:51,292 - ***** Epoch: 1: Eval results *****
2024-01-19 11:38:51,293 -   train_loss = 2.5812
2024-01-19 11:38:51,293 -   best_eval_score = 0.0
2024-01-19 11:38:51,293 -   eval_score = 0.3384
2024-01-19 11:39:11,602 - ***** Epoch: 2: Eval results *****
2024-01-19 11:39:11,603 -   train_loss = 1.6861
2024-01-19 11:39:11,603 -   best_eval_score = 0.3384
2024-01-19 11:39:11,603 -   eval_score = 0.5338
2024-01-19 11:39:30,308 - ***** Epoch: 3: Eval results *****
2024-01-19 11:39:30,309 -   train_loss = 1.0215
2024-01-19 11:39:30,309 -   best_eval_score = 0.5338
2024-01-19 11:39:30,309 -   eval_score = 0.5855
2024-01-19 11:39:49,549 - ***** Epoch: 4: Eval results *****
2024-01-19 11:39:49,558 -   train_loss = 0.5918
2024-01-19 11:39:49,558 -   best_eval_score = 0.5855
2024-01-19 11:39:49,558 -   eval_score = 0.6519
2024-01-19 11:40:11,063 - ***** Epoch: 5: Eval results *****
2024-01-19 11:40:11,064 -   train_loss = 0.312
2024-01-19 11:40:11,064 -   best_eval_score = 0.6519
2024-01-19 11:40:11,064 -   eval_score = 0.6888
2024-01-19 11:40:31,404 - ***** Epoch: 6: Eval results *****
2024-01-19 11:40:31,404 -   train_loss = 0.182
2024-01-19 11:40:31,404 -   best_eval_score = 0.6888
2024-01-19 11:40:31,405 -   eval_score = 0.708
2024-01-19 11:40:49,897 - ***** Epoch: 7: Eval results *****
2024-01-19 11:40:49,897 -   train_loss = 0.1021
2024-01-19 11:40:49,897 -   best_eval_score = 0.708
2024-01-19 11:40:49,897 -   eval_score = 0.716
2024-01-19 11:41:09,633 - ***** Epoch: 8: Eval results *****
2024-01-19 11:41:09,642 -   train_loss = 0.0538
2024-01-19 11:41:09,642 -   best_eval_score = 0.716
2024-01-19 11:41:09,642 -   eval_score = 0.6816
2024-01-19 11:41:09,642 - EarlyStopping counter: 1 out of 8
2024-01-19 11:41:27,122 - ***** Epoch: 9: Eval results *****
2024-01-19 11:41:27,122 -   train_loss = 0.0388
2024-01-19 11:41:27,122 -   best_eval_score = 0.716
2024-01-19 11:41:27,122 -   eval_score = 0.705
2024-01-19 11:41:27,122 - EarlyStopping counter: 2 out of 8
2024-01-19 11:41:46,286 - ***** Epoch: 10: Eval results *****
2024-01-19 11:41:46,286 -   train_loss = 0.0292
2024-01-19 11:41:46,287 -   best_eval_score = 0.716
2024-01-19 11:41:46,287 -   eval_score = 0.6902
2024-01-19 11:41:46,287 - EarlyStopping counter: 3 out of 8
2024-01-19 11:42:04,791 - ***** Epoch: 11: Eval results *****
2024-01-19 11:42:04,791 -   train_loss = 0.0196
2024-01-19 11:42:04,791 -   best_eval_score = 0.716
2024-01-19 11:42:04,791 -   eval_score = 0.6948
2024-01-19 11:42:04,791 - EarlyStopping counter: 4 out of 8
2024-01-19 11:42:21,831 - ***** Epoch: 12: Eval results *****
2024-01-19 11:42:21,840 -   train_loss = 0.0181
2024-01-19 11:42:21,840 -   best_eval_score = 0.716
2024-01-19 11:42:21,841 -   eval_score = 0.6889
2024-01-19 11:42:21,841 - EarlyStopping counter: 5 out of 8
2024-01-19 11:42:39,814 - ***** Epoch: 13: Eval results *****
2024-01-19 11:42:39,814 -   train_loss = 0.0182
2024-01-19 11:42:39,815 -   best_eval_score = 0.716
2024-01-19 11:42:39,815 -   eval_score = 0.6875
2024-01-19 11:42:39,815 - EarlyStopping counter: 6 out of 8
2024-01-19 11:43:00,206 - ***** Epoch: 14: Eval results *****
2024-01-19 11:43:00,215 -   train_loss = 0.0166
2024-01-19 11:43:00,215 -   best_eval_score = 0.716
2024-01-19 11:43:00,215 -   eval_score = 0.6889
2024-01-19 11:43:00,215 - EarlyStopping counter: 7 out of 8
2024-01-19 11:43:18,235 - ***** Epoch: 15: Eval results *****
2024-01-19 11:43:18,235 -   train_loss = 0.0161
2024-01-19 11:43:18,235 -   best_eval_score = 0.716
2024-01-19 11:43:18,235 -   eval_score = 0.6908
2024-01-19 11:43:18,235 - EarlyStopping counter: 8 out of 8
2024-01-19 11:43:18,235 - EarlyStopping at epoch 15
2024-01-19 11:43:18,238 - Training is finished...
2024-01-19 11:43:18,238 - Testing begins...
2024-01-19 11:43:21,771 - ***** Test: Confusion Matrix *****
2024-01-19 11:43:21,772 - [[39  2  0  0  8  0  1  0  0  2  1  0  3  1  0  0  0  0  0  0]
 [ 0 32  0  1  0  4  0  2  1  0  1  0  2  0  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 5  0  0  0 14  0  0  0  0  0  0  1  1  1  0  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 1  1  0  0  4  0  1  0  2  0  0  0  1  0  1  1  0  0  0  0]
 [ 3  0  0  0  0  1  0  4  1  0  1  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  3  3  0  0  0  0  2  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  3  0  0  0  0  0  3  1  1  0  0]
 [ 1  0  0  0  0  0  1  0  0  2 13  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 18  0  0  0  0  0  0  0  0]
 [ 3  2  0  0  0  0  0  0  0  0  0  1 41  0  5  0  4  0  0  1]
 [ 1  1  0  0  0  0  1  0  0  0  1  1  0 18  2  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  1  0  0  0  0  2 16  0  2  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  2  0  0 17  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  2  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  1  0  0  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  2  0  0  6]]
2024-01-19 11:43:21,772 - ***** Evaluation results *****
2024-01-19 11:43:21,772 -   acc = 0.7191
2024-01-19 11:43:21,772 -   f1 = 0.6715
2024-01-19 11:43:21,772 -   prec = 0.6777
2024-01-19 11:43:21,772 -   rec = 0.676
2024-01-19 11:43:21,772 - Testing is finished...
2024-01-19 11:43:21,772 - Multimodal intent recognition is finished...
2024-01-19 11:43:21,772 - Results are saved in results/msz.csv
