2024-01-08 02:48:51,488 - ============================== Params ==============================
2024-01-08 02:48:51,488 - logger_name: msz_MIntRec_multi-class_seed-2_2024-01-08-02-48-51
2024-01-08 02:48:51,488 - dataset: MIntRec
2024-01-08 02:48:51,488 - data_mode: multi-class
2024-01-08 02:48:51,488 - method: msz
2024-01-08 02:48:51,488 - text_backbone: bert-base-uncased
2024-01-08 02:48:51,488 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-08 02:48:51,488 - seed: 2
2024-01-08 02:48:51,488 - num_workers: 8
2024-01-08 02:48:51,488 - gpu_id: 1
2024-01-08 02:48:51,488 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-08 02:48:51,488 - train: True
2024-01-08 02:48:51,488 - tune: False
2024-01-08 02:48:51,488 - save_model: False
2024-01-08 02:48:51,489 - save_results: True
2024-01-08 02:48:51,489 - log_path: logs
2024-01-08 02:48:51,489 - cache_path: 
2024-01-08 02:48:51,489 - video_data_path: video_data
2024-01-08 02:48:51,489 - audio_data_path: audio_data
2024-01-08 02:48:51,489 - video_feats_path: video_feats.pkl
2024-01-08 02:48:51,489 - audio_feats_path: audio_feats.pkl
2024-01-08 02:48:51,489 - results_path: results
2024-01-08 02:48:51,489 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-08 02:48:51,489 - model_path: models
2024-01-08 02:48:51,489 - config_file_name: msz
2024-01-08 02:48:51,489 - results_file_name: msz.csv
2024-01-08 02:48:51,489 - padding_mode: zero
2024-01-08 02:48:51,489 - padding_loc: end
2024-01-08 02:48:51,489 - need_aligned: False
2024-01-08 02:48:51,489 - eval_monitor: f1
2024-01-08 02:48:51,489 - train_batch_size: 16
2024-01-08 02:48:51,489 - eval_batch_size: 8
2024-01-08 02:48:51,489 - test_batch_size: 8
2024-01-08 02:48:51,489 - wait_patience: 8
2024-01-08 02:48:51,489 - nheads: 2
2024-01-08 02:48:51,489 - encoder_layers: 2
2024-01-08 02:48:51,489 - attn_dropout: 0.1
2024-01-08 02:48:51,489 - relu_dropout: 0.1
2024-01-08 02:48:51,489 - embed_dropout: 0.1
2024-01-08 02:48:51,489 - res_dropout: 0.1
2024-01-08 02:48:51,489 - attn_mask: False
2024-01-08 02:48:51,489 - hidden_size: 768
2024-01-08 02:48:51,489 - num_attention_heads: 12
2024-01-08 02:48:51,489 - attention_probs_dropout_prob: 0.2
2024-01-08 02:48:51,489 - hidden_dropout_prob: 0.2
2024-01-08 02:48:51,489 - intermediate_size: 768
2024-01-08 02:48:51,489 - num_hidden_layers: 3
2024-01-08 02:48:51,489 - max_position_embeddings: 512
2024-01-08 02:48:51,489 - position_embedding_type: absolute
2024-01-08 02:48:51,489 - batch_first: True
2024-01-08 02:48:51,489 - hidden_dims: 768
2024-01-08 02:48:51,489 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-08 02:48:51,490 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-08 02:48:51,490 - ta_loss: 0.1
2024-01-08 02:48:51,490 - tv_loss: 0.1
2024-01-08 02:48:51,490 - av_loss: 0.1
2024-01-08 02:48:51,490 - aligned_method: conv1d
2024-01-08 02:48:51,490 - grad_clip: -1
2024-01-08 02:48:51,490 - num_train_epochs: 100
2024-01-08 02:48:51,490 - warmup_proportion: 0.1
2024-01-08 02:48:51,490 - lr: 1e-06
2024-01-08 02:48:51,490 - weight_decay: 0.01
2024-01-08 02:48:51,490 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-01-08-02-48-51
2024-01-08 02:48:51,490 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-2_2024-01-08-02-48-51/models
2024-01-08 02:48:51,490 - ============================== End Params ==============================
2024-01-08 02:48:51,492 - Generate Text Features Begin...
2024-01-08 02:48:51,992 - Generate Text Features Finished...
2024-01-08 02:48:51,993 - Load Video Features Begin...
2024-01-08 02:48:52,273 - Load Video Features Finished...
2024-01-08 02:48:52,814 - Load Audio Features Begin...
2024-01-08 02:48:53,818 - Load Audio Features Finished...
2024-01-08 02:48:57,233 - method  begins...
2024-01-08 02:49:00,656 - Multimodal intent recognition begins...
2024-01-08 02:49:00,656 - Training begins...
2024-01-08 02:49:14,686 - ***** Epoch: 1: Eval results *****
2024-01-08 02:49:14,687 -   train_loss = 2.992
2024-01-08 02:49:14,687 -   best_eval_score = 0.0
2024-01-08 02:49:14,687 -   eval_score = 0.0204
2024-01-08 02:49:27,649 - ***** Epoch: 2: Eval results *****
2024-01-08 02:49:27,649 -   train_loss = 2.9706
2024-01-08 02:49:27,649 -   best_eval_score = 0.0204
2024-01-08 02:49:27,649 -   eval_score = 0.0364
2024-01-08 02:49:40,392 - ***** Epoch: 3: Eval results *****
2024-01-08 02:49:40,393 -   train_loss = 2.9255
2024-01-08 02:49:40,393 -   best_eval_score = 0.0364
2024-01-08 02:49:40,393 -   eval_score = 0.0487
2024-01-08 02:49:52,212 - ***** Epoch: 4: Eval results *****
2024-01-08 02:49:52,212 -   train_loss = 2.8594
2024-01-08 02:49:52,212 -   best_eval_score = 0.0487
2024-01-08 02:49:52,212 -   eval_score = 0.078
2024-01-08 02:50:04,119 - ***** Epoch: 5: Eval results *****
2024-01-08 02:50:04,119 -   train_loss = 2.759
2024-01-08 02:50:04,119 -   best_eval_score = 0.078
2024-01-08 02:50:04,119 -   eval_score = 0.1216
2024-01-08 02:50:15,827 - ***** Epoch: 6: Eval results *****
2024-01-08 02:50:15,827 -   train_loss = 2.6022
2024-01-08 02:50:15,827 -   best_eval_score = 0.1216
2024-01-08 02:50:15,827 -   eval_score = 0.157
2024-01-08 02:50:28,269 - ***** Epoch: 7: Eval results *****
2024-01-08 02:50:28,270 -   train_loss = 2.3715
2024-01-08 02:50:28,270 -   best_eval_score = 0.157
2024-01-08 02:50:28,270 -   eval_score = 0.216
2024-01-08 02:50:41,170 - ***** Epoch: 8: Eval results *****
2024-01-08 02:50:41,171 -   train_loss = 2.0535
2024-01-08 02:50:41,171 -   best_eval_score = 0.216
2024-01-08 02:50:41,171 -   eval_score = 0.2742
2024-01-08 02:50:54,556 - ***** Epoch: 9: Eval results *****
2024-01-08 02:50:54,557 -   train_loss = 1.6539
2024-01-08 02:50:54,557 -   best_eval_score = 0.2742
2024-01-08 02:50:54,557 -   eval_score = 0.3481
2024-01-08 02:51:07,443 - ***** Epoch: 10: Eval results *****
2024-01-08 02:51:07,444 -   train_loss = 1.3176
2024-01-08 02:51:07,444 -   best_eval_score = 0.3481
2024-01-08 02:51:07,444 -   eval_score = 0.523
2024-01-08 02:51:19,430 - ***** Epoch: 11: Eval results *****
2024-01-08 02:51:19,430 -   train_loss = 1.1079
2024-01-08 02:51:19,430 -   best_eval_score = 0.523
2024-01-08 02:51:19,430 -   eval_score = 0.5064
2024-01-08 02:51:19,430 - EarlyStopping counter: 1 out of 8
2024-01-08 02:51:32,067 - ***** Epoch: 12: Eval results *****
2024-01-08 02:51:32,067 -   train_loss = 0.9062
2024-01-08 02:51:32,067 -   best_eval_score = 0.523
2024-01-08 02:51:32,067 -   eval_score = 0.5693
2024-01-08 02:51:44,575 - ***** Epoch: 13: Eval results *****
2024-01-08 02:51:44,575 -   train_loss = 0.7836
2024-01-08 02:51:44,575 -   best_eval_score = 0.5693
2024-01-08 02:51:44,575 -   eval_score = 0.5521
2024-01-08 02:51:44,575 - EarlyStopping counter: 1 out of 8
2024-01-08 02:51:56,823 - ***** Epoch: 14: Eval results *****
2024-01-08 02:51:56,823 -   train_loss = 0.5824
2024-01-08 02:51:56,823 -   best_eval_score = 0.5693
2024-01-08 02:51:56,823 -   eval_score = 0.6066
2024-01-08 02:52:08,593 - ***** Epoch: 15: Eval results *****
2024-01-08 02:52:08,593 -   train_loss = 0.5485
2024-01-08 02:52:08,593 -   best_eval_score = 0.6066
2024-01-08 02:52:08,593 -   eval_score = 0.5913
2024-01-08 02:52:08,593 - EarlyStopping counter: 1 out of 8
2024-01-08 02:52:21,028 - ***** Epoch: 16: Eval results *****
2024-01-08 02:52:21,028 -   train_loss = 0.3914
2024-01-08 02:52:21,028 -   best_eval_score = 0.6066
2024-01-08 02:52:21,028 -   eval_score = 0.5997
2024-01-08 02:52:21,028 - EarlyStopping counter: 2 out of 8
2024-01-08 02:52:32,794 - ***** Epoch: 17: Eval results *****
2024-01-08 02:52:32,794 -   train_loss = 0.3285
2024-01-08 02:52:32,794 -   best_eval_score = 0.6066
2024-01-08 02:52:32,794 -   eval_score = 0.6176
2024-01-08 02:52:45,616 - ***** Epoch: 18: Eval results *****
2024-01-08 02:52:45,616 -   train_loss = 0.2529
2024-01-08 02:52:45,616 -   best_eval_score = 0.6176
2024-01-08 02:52:45,616 -   eval_score = 0.6263
2024-01-08 02:52:58,455 - ***** Epoch: 19: Eval results *****
2024-01-08 02:52:58,455 -   train_loss = 0.2033
2024-01-08 02:52:58,456 -   best_eval_score = 0.6263
2024-01-08 02:52:58,456 -   eval_score = 0.6313
2024-01-08 02:53:10,855 - ***** Epoch: 20: Eval results *****
2024-01-08 02:53:10,855 -   train_loss = 0.1784
2024-01-08 02:53:10,855 -   best_eval_score = 0.6313
2024-01-08 02:53:10,856 -   eval_score = 0.6507
2024-01-08 02:53:23,376 - ***** Epoch: 21: Eval results *****
2024-01-08 02:53:23,377 -   train_loss = 0.1471
2024-01-08 02:53:23,377 -   best_eval_score = 0.6507
2024-01-08 02:53:23,377 -   eval_score = 0.6388
2024-01-08 02:53:23,377 - EarlyStopping counter: 1 out of 8
2024-01-08 02:53:36,131 - ***** Epoch: 22: Eval results *****
2024-01-08 02:53:36,131 -   train_loss = 0.1219
2024-01-08 02:53:36,131 -   best_eval_score = 0.6507
2024-01-08 02:53:36,131 -   eval_score = 0.6433
2024-01-08 02:53:36,131 - EarlyStopping counter: 2 out of 8
2024-01-08 02:53:48,829 - ***** Epoch: 23: Eval results *****
2024-01-08 02:53:48,829 -   train_loss = 0.1097
2024-01-08 02:53:48,829 -   best_eval_score = 0.6507
2024-01-08 02:53:48,829 -   eval_score = 0.6459
2024-01-08 02:53:48,829 - EarlyStopping counter: 3 out of 8
2024-01-08 02:54:01,343 - ***** Epoch: 24: Eval results *****
2024-01-08 02:54:01,343 -   train_loss = 0.0918
2024-01-08 02:54:01,343 -   best_eval_score = 0.6507
2024-01-08 02:54:01,343 -   eval_score = 0.652
2024-01-08 02:54:14,113 - ***** Epoch: 25: Eval results *****
2024-01-08 02:54:14,113 -   train_loss = 0.0784
2024-01-08 02:54:14,113 -   best_eval_score = 0.652
2024-01-08 02:54:14,113 -   eval_score = 0.6609
2024-01-08 02:54:26,638 - ***** Epoch: 26: Eval results *****
2024-01-08 02:54:26,638 -   train_loss = 0.0682
2024-01-08 02:54:26,638 -   best_eval_score = 0.6609
2024-01-08 02:54:26,638 -   eval_score = 0.6588
2024-01-08 02:54:26,638 - EarlyStopping counter: 1 out of 8
2024-01-08 02:54:39,636 - ***** Epoch: 27: Eval results *****
2024-01-08 02:54:39,637 -   train_loss = 0.0617
2024-01-08 02:54:39,637 -   best_eval_score = 0.6609
2024-01-08 02:54:39,637 -   eval_score = 0.6599
2024-01-08 02:54:39,637 - EarlyStopping counter: 2 out of 8
2024-01-08 02:54:51,991 - ***** Epoch: 28: Eval results *****
2024-01-08 02:54:51,991 -   train_loss = 0.0562
2024-01-08 02:54:51,991 -   best_eval_score = 0.6609
2024-01-08 02:54:51,991 -   eval_score = 0.6711
2024-01-08 02:55:04,653 - ***** Epoch: 29: Eval results *****
2024-01-08 02:55:04,653 -   train_loss = 0.0442
2024-01-08 02:55:04,653 -   best_eval_score = 0.6711
2024-01-08 02:55:04,653 -   eval_score = 0.6552
2024-01-08 02:55:04,653 - EarlyStopping counter: 1 out of 8
2024-01-08 02:55:17,093 - ***** Epoch: 30: Eval results *****
2024-01-08 02:55:17,093 -   train_loss = 0.04
2024-01-08 02:55:17,093 -   best_eval_score = 0.6711
2024-01-08 02:55:17,093 -   eval_score = 0.6531
2024-01-08 02:55:17,093 - EarlyStopping counter: 2 out of 8
2024-01-08 02:55:29,649 - ***** Epoch: 31: Eval results *****
2024-01-08 02:55:29,650 -   train_loss = 0.0345
2024-01-08 02:55:29,650 -   best_eval_score = 0.6711
2024-01-08 02:55:29,650 -   eval_score = 0.671
2024-01-08 02:55:29,650 - EarlyStopping counter: 3 out of 8
2024-01-08 02:55:42,112 - ***** Epoch: 32: Eval results *****
2024-01-08 02:55:42,113 -   train_loss = 0.0316
2024-01-08 02:55:42,113 -   best_eval_score = 0.6711
2024-01-08 02:55:42,113 -   eval_score = 0.646
2024-01-08 02:55:42,113 - EarlyStopping counter: 4 out of 8
2024-01-08 02:55:54,472 - ***** Epoch: 33: Eval results *****
2024-01-08 02:55:54,473 -   train_loss = 0.0261
2024-01-08 02:55:54,473 -   best_eval_score = 0.6711
2024-01-08 02:55:54,473 -   eval_score = 0.6438
2024-01-08 02:55:54,473 - EarlyStopping counter: 5 out of 8
2024-01-08 02:56:07,188 - ***** Epoch: 34: Eval results *****
2024-01-08 02:56:07,188 -   train_loss = 0.0208
2024-01-08 02:56:07,188 -   best_eval_score = 0.6711
2024-01-08 02:56:07,188 -   eval_score = 0.6468
2024-01-08 02:56:07,188 - EarlyStopping counter: 6 out of 8
2024-01-08 02:56:19,669 - ***** Epoch: 35: Eval results *****
2024-01-08 02:56:19,669 -   train_loss = 0.0197
2024-01-08 02:56:19,670 -   best_eval_score = 0.6711
2024-01-08 02:56:19,670 -   eval_score = 0.6248
2024-01-08 02:56:19,670 - EarlyStopping counter: 7 out of 8
2024-01-08 02:56:32,067 - ***** Epoch: 36: Eval results *****
2024-01-08 02:56:32,068 -   train_loss = 0.0163
2024-01-08 02:56:32,068 -   best_eval_score = 0.6711
2024-01-08 02:56:32,068 -   eval_score = 0.6192
2024-01-08 02:56:32,068 - EarlyStopping counter: 8 out of 8
2024-01-08 02:56:32,068 - EarlyStopping at epoch 36
2024-01-08 02:56:32,069 - Training is finished...
2024-01-08 02:56:32,069 - Testing begins...
2024-01-08 02:56:34,637 - ***** Test: Confusion Matrix *****
2024-01-08 02:56:34,638 - [[25  2  0  0 11  0  2  5  0  5  0  0  6  1  0  0  0  0  0  0]
 [ 0 38  0  0  0  0  0  1  1  0  0  0  1  1  0  0  0  1  0  0]
 [ 1  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0]
 [ 0  0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0]
 [ 2  0  0  0 15  0  2  0  0  0  0  1  0  2  1  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  1  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  4  0  1  1  0  0  3  0  0  0  1  0  0  0]
 [ 2  0  0  0  0  0  0  5  1  1  0  0  1  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  4  1  0  0  0  1  1  0  1  0  0  0  1]
 [ 1  0  0  0  0  0  0  1  0  6  0  0  0  0  0  0  0  2  0  0]
 [ 0  1  0  0  0  0  1  0  0  3 12  0  1  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0  1]
 [ 2  1  0  1  0  0  1  3  0  1  0  0 45  1  1  1  0  0  0  0]
 [ 0  0  0  0  1  0  1  0  0  0  2  1  2 17  1  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  0  0  0  0  3  2 11  1  1  0  0  3]
 [ 0  1  0  0  1  0  1  3  0  0  0  0  5  0  1  9  0  0  0  0]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  4  1  2  0  9  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0 12  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  2  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  1  0  0  0  0  0  8]]
2024-01-08 02:56:34,639 - ***** Evaluation results *****
2024-01-08 02:56:34,639 -   acc = 0.6809
2024-01-08 02:56:34,639 -   f1 = 0.6497
2024-01-08 02:56:34,639 -   prec = 0.6738
2024-01-08 02:56:34,639 -   rec = 0.6559
2024-01-08 02:56:34,639 - Testing is finished...
2024-01-08 02:56:34,639 - Multimodal intent recognition is finished...
2024-01-08 02:56:34,639 - Results are saved in results/msz.csv
