2024-04-01 02:26:27,955 - ============================== Params ==============================
2024-04-01 02:26:27,955 - logger_name: msz_MIntRec_multi-class_seed-4_2024-04-01-02-26-27
2024-04-01 02:26:27,955 - dataset: MIntRec
2024-04-01 02:26:27,955 - data_mode: multi-class
2024-04-01 02:26:27,955 - method: msz
2024-04-01 02:26:27,955 - text_backbone: bert-base-uncased
2024-04-01 02:26:27,955 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-01 02:26:27,955 - seed: 4
2024-04-01 02:26:27,955 - num_workers: 8
2024-04-01 02:26:27,955 - gpu_id: 3
2024-04-01 02:26:27,955 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-01 02:26:27,955 - train: True
2024-04-01 02:26:27,955 - tune: True
2024-04-01 02:26:27,956 - save_model: False
2024-04-01 02:26:27,956 - save_results: True
2024-04-01 02:26:27,956 - log_path: logs
2024-04-01 02:26:27,956 - cache_path: 
2024-04-01 02:26:27,956 - video_data_path: video_data
2024-04-01 02:26:27,956 - audio_data_path: audio_data
2024-04-01 02:26:27,956 - video_feats_path: video_feats.pkl
2024-04-01 02:26:27,956 - audio_feats_path: audio_feats.pkl
2024-04-01 02:26:27,956 - results_path: results
2024-04-01 02:26:27,956 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-04-01 02:26:27,956 - model_path: models
2024-04-01 02:26:27,956 - config_file_name: msz_MIntRec
2024-04-01 02:26:27,956 - results_file_name: msz.csv
2024-04-01 02:26:27,956 - padding_mode: zero
2024-04-01 02:26:27,956 - padding_loc: end
2024-04-01 02:26:27,956 - need_aligned: False
2024-04-01 02:26:27,956 - eval_monitor: f1
2024-04-01 02:26:27,956 - train_batch_size: 16
2024-04-01 02:26:27,956 - eval_batch_size: 8
2024-04-01 02:26:27,956 - test_batch_size: 8
2024-04-01 02:26:27,956 - wait_patience: 8
2024-04-01 02:26:27,956 - hidden_dims: 768
2024-04-01 02:26:27,956 - num_attention_heads: 8
2024-04-01 02:26:27,956 - attention_probs_dropout_prob: 0.5
2024-04-01 02:26:27,956 - hidden_dropout_prob: 0.2
2024-04-01 02:26:27,956 - intermediate_size: 768
2024-04-01 02:26:27,956 - num_hidden_layers: 6
2024-04-01 02:26:27,956 - max_position_embeddings: 768
2024-04-01 02:26:27,956 - position_embedding_type: absolute
2024-04-01 02:26:27,956 - batch_first: True
2024-04-01 02:26:27,956 - dropout: 0.3
2024-04-01 02:26:27,956 - aligned_method: conv1d
2024-04-01 02:26:27,956 - num_train_epochs: 100
2024-04-01 02:26:27,956 - lr: 5e-05
2024-04-01 02:26:27,956 - lr_mode: max
2024-04-01 02:26:27,956 - patience: 8
2024-04-01 02:26:27,956 - factor: 0.1
2024-04-01 02:26:27,956 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-04-01-02-26-27
2024-04-01 02:26:27,956 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-04-01-02-26-27/models
2024-04-01 02:26:27,956 - ============================== End Params ==============================
2024-04-01 02:26:28,077 - Generate Text Features Begin...
2024-04-01 02:26:28,585 - Generate Text Features Finished...
2024-04-01 02:26:28,586 - Load Video Features Begin...
2024-04-01 02:26:32,884 - Load Video Features Finished...
2024-04-01 02:26:33,547 - Load Audio Features Begin...
2024-04-01 02:26:50,043 - Load Audio Features Finished...
2024-04-01 02:26:55,162 - method  begins...
2024-04-01 02:27:05,712 - Multimodal intent recognition begins...
2024-04-01 02:27:05,712 - Training begins...
2024-04-01 02:27:24,489 - ***** Epoch: 1: Eval results *****
2024-04-01 02:27:24,490 -   train_loss = 2.0983
2024-04-01 02:27:24,490 -   best_eval_score = 0.0
2024-04-01 02:27:24,490 -   eval_score = 0.5538
2024-04-01 02:27:41,620 - ***** Epoch: 2: Eval results *****
2024-04-01 02:27:41,629 -   train_loss = 0.9868
2024-04-01 02:27:41,629 -   best_eval_score = 0.5538
2024-04-01 02:27:41,629 -   eval_score = 0.6013
2024-04-01 02:27:58,636 - ***** Epoch: 3: Eval results *****
2024-04-01 02:27:58,636 -   train_loss = 0.5135
2024-04-01 02:27:58,636 -   best_eval_score = 0.6013
2024-04-01 02:27:58,636 -   eval_score = 0.6269
2024-04-01 02:28:15,373 - ***** Epoch: 4: Eval results *****
2024-04-01 02:28:15,382 -   train_loss = 0.3401
2024-04-01 02:28:15,382 -   best_eval_score = 0.6269
2024-04-01 02:28:15,382 -   eval_score = 0.6442
2024-04-01 02:28:32,772 - ***** Epoch: 5: Eval results *****
2024-04-01 02:28:32,773 -   train_loss = 0.2182
2024-04-01 02:28:32,773 -   best_eval_score = 0.6442
2024-04-01 02:28:32,773 -   eval_score = 0.6451
2024-04-01 02:28:49,838 - ***** Epoch: 6: Eval results *****
2024-04-01 02:28:49,839 -   train_loss = 0.2241
2024-04-01 02:28:49,839 -   best_eval_score = 0.6451
2024-04-01 02:28:49,839 -   eval_score = 0.6452
2024-04-01 02:29:07,421 - ***** Epoch: 7: Eval results *****
2024-04-01 02:29:07,421 -   train_loss = 0.1684
2024-04-01 02:29:07,422 -   best_eval_score = 0.6452
2024-04-01 02:29:07,422 -   eval_score = 0.6686
2024-04-01 02:29:25,122 - ***** Epoch: 8: Eval results *****
2024-04-01 02:29:25,123 -   train_loss = 0.126
2024-04-01 02:29:25,123 -   best_eval_score = 0.6686
2024-04-01 02:29:25,123 -   eval_score = 0.6047
2024-04-01 02:29:25,123 - EarlyStopping counter: 1 out of 8
2024-04-01 02:29:42,469 - ***** Epoch: 9: Eval results *****
2024-04-01 02:29:42,470 -   train_loss = 0.0625
2024-04-01 02:29:42,470 -   best_eval_score = 0.6686
2024-04-01 02:29:42,470 -   eval_score = 0.6727
2024-04-01 02:29:59,105 - ***** Epoch: 10: Eval results *****
2024-04-01 02:29:59,105 -   train_loss = 0.1418
2024-04-01 02:29:59,105 -   best_eval_score = 0.6727
2024-04-01 02:29:59,105 -   eval_score = 0.632
2024-04-01 02:29:59,105 - EarlyStopping counter: 1 out of 8
2024-04-01 02:30:17,621 - ***** Epoch: 11: Eval results *****
2024-04-01 02:30:17,621 -   train_loss = 0.0547
2024-04-01 02:30:17,621 -   best_eval_score = 0.6727
2024-04-01 02:30:17,621 -   eval_score = 0.6748
2024-04-01 02:30:37,796 - ***** Epoch: 12: Eval results *****
2024-04-01 02:30:37,797 -   train_loss = 0.021
2024-04-01 02:30:37,797 -   best_eval_score = 0.6748
2024-04-01 02:30:37,797 -   eval_score = 0.6693
2024-04-01 02:30:37,797 - EarlyStopping counter: 1 out of 8
2024-04-01 02:30:54,798 - ***** Epoch: 13: Eval results *****
2024-04-01 02:30:54,799 -   train_loss = 0.012
2024-04-01 02:30:54,799 -   best_eval_score = 0.6748
2024-04-01 02:30:54,799 -   eval_score = 0.6711
2024-04-01 02:30:54,799 - EarlyStopping counter: 2 out of 8
2024-04-01 02:31:12,890 - ***** Epoch: 14: Eval results *****
2024-04-01 02:31:12,891 -   train_loss = 0.0117
2024-04-01 02:31:12,891 -   best_eval_score = 0.6748
2024-04-01 02:31:12,891 -   eval_score = 0.68
2024-04-01 02:31:29,643 - ***** Epoch: 15: Eval results *****
2024-04-01 02:31:29,643 -   train_loss = 0.0081
2024-04-01 02:31:29,643 -   best_eval_score = 0.68
2024-04-01 02:31:29,643 -   eval_score = 0.6784
2024-04-01 02:31:29,643 - EarlyStopping counter: 1 out of 8
2024-04-01 02:31:46,254 - ***** Epoch: 16: Eval results *****
2024-04-01 02:31:46,254 -   train_loss = 0.0078
2024-04-01 02:31:46,254 -   best_eval_score = 0.68
2024-04-01 02:31:46,254 -   eval_score = 0.6816
2024-04-01 02:32:03,464 - ***** Epoch: 17: Eval results *****
2024-04-01 02:32:03,473 -   train_loss = 0.0065
2024-04-01 02:32:03,473 -   best_eval_score = 0.6816
2024-04-01 02:32:03,473 -   eval_score = 0.6778
2024-04-01 02:32:03,473 - EarlyStopping counter: 1 out of 8
2024-04-01 02:32:21,515 - ***** Epoch: 18: Eval results *****
2024-04-01 02:32:21,515 -   train_loss = 0.006
2024-04-01 02:32:21,515 -   best_eval_score = 0.6816
2024-04-01 02:32:21,515 -   eval_score = 0.6778
2024-04-01 02:32:21,515 - EarlyStopping counter: 2 out of 8
2024-04-01 02:32:39,302 - ***** Epoch: 19: Eval results *****
2024-04-01 02:32:39,303 -   train_loss = 0.0045
2024-04-01 02:32:39,303 -   best_eval_score = 0.6816
2024-04-01 02:32:39,303 -   eval_score = 0.6809
2024-04-01 02:32:39,303 - EarlyStopping counter: 3 out of 8
2024-04-01 02:32:55,766 - ***** Epoch: 20: Eval results *****
2024-04-01 02:32:55,766 -   train_loss = 0.0039
2024-04-01 02:32:55,766 -   best_eval_score = 0.6816
2024-04-01 02:32:55,766 -   eval_score = 0.6809
2024-04-01 02:32:55,766 - EarlyStopping counter: 4 out of 8
2024-04-01 02:33:13,242 - ***** Epoch: 21: Eval results *****
2024-04-01 02:33:13,242 -   train_loss = 0.0042
2024-04-01 02:33:13,243 -   best_eval_score = 0.6816
2024-04-01 02:33:13,243 -   eval_score = 0.6809
2024-04-01 02:33:13,243 - EarlyStopping counter: 5 out of 8
2024-04-01 02:33:31,966 - ***** Epoch: 22: Eval results *****
2024-04-01 02:33:31,966 -   train_loss = 0.0059
2024-04-01 02:33:31,966 -   best_eval_score = 0.6816
2024-04-01 02:33:31,966 -   eval_score = 0.6809
2024-04-01 02:33:31,966 - EarlyStopping counter: 6 out of 8
2024-04-01 02:33:49,567 - ***** Epoch: 23: Eval results *****
2024-04-01 02:33:49,568 -   train_loss = 0.0041
2024-04-01 02:33:49,568 -   best_eval_score = 0.6816
2024-04-01 02:33:49,568 -   eval_score = 0.6828
2024-04-01 02:34:06,421 - ***** Epoch: 24: Eval results *****
2024-04-01 02:34:06,422 -   train_loss = 0.0032
2024-04-01 02:34:06,422 -   best_eval_score = 0.6828
2024-04-01 02:34:06,422 -   eval_score = 0.6828
2024-04-01 02:34:06,422 - EarlyStopping counter: 1 out of 8
2024-04-01 02:34:23,202 - ***** Epoch: 25: Eval results *****
2024-04-01 02:34:23,202 -   train_loss = 0.0042
2024-04-01 02:34:23,202 -   best_eval_score = 0.6828
2024-04-01 02:34:23,202 -   eval_score = 0.6828
2024-04-01 02:34:23,202 - EarlyStopping counter: 2 out of 8
2024-04-01 02:34:42,644 - ***** Epoch: 26: Eval results *****
2024-04-01 02:34:42,645 -   train_loss = 0.0045
2024-04-01 02:34:42,645 -   best_eval_score = 0.6828
2024-04-01 02:34:42,645 -   eval_score = 0.6833
2024-04-01 02:35:03,384 - ***** Epoch: 27: Eval results *****
2024-04-01 02:35:03,384 -   train_loss = 0.0037
2024-04-01 02:35:03,385 -   best_eval_score = 0.6833
2024-04-01 02:35:03,385 -   eval_score = 0.6828
2024-04-01 02:35:03,385 - EarlyStopping counter: 1 out of 8
2024-04-01 02:35:20,609 - ***** Epoch: 28: Eval results *****
2024-04-01 02:35:20,610 -   train_loss = 0.0046
2024-04-01 02:35:20,610 -   best_eval_score = 0.6833
2024-04-01 02:35:20,610 -   eval_score = 0.6828
2024-04-01 02:35:20,610 - EarlyStopping counter: 2 out of 8
2024-04-01 02:35:37,352 - ***** Epoch: 29: Eval results *****
2024-04-01 02:35:37,353 -   train_loss = 0.0044
2024-04-01 02:35:37,353 -   best_eval_score = 0.6833
2024-04-01 02:35:37,353 -   eval_score = 0.6828
2024-04-01 02:35:37,353 - EarlyStopping counter: 3 out of 8
2024-04-01 02:35:54,065 - ***** Epoch: 30: Eval results *****
2024-04-01 02:35:54,065 -   train_loss = 0.0035
2024-04-01 02:35:54,065 -   best_eval_score = 0.6833
2024-04-01 02:35:54,065 -   eval_score = 0.6828
2024-04-01 02:35:54,065 - EarlyStopping counter: 4 out of 8
2024-04-01 02:36:10,644 - ***** Epoch: 31: Eval results *****
2024-04-01 02:36:10,644 -   train_loss = 0.0039
2024-04-01 02:36:10,644 -   best_eval_score = 0.6833
2024-04-01 02:36:10,644 -   eval_score = 0.6828
2024-04-01 02:36:10,644 - EarlyStopping counter: 5 out of 8
2024-04-01 02:36:26,733 - ***** Epoch: 32: Eval results *****
2024-04-01 02:36:26,733 -   train_loss = 0.0038
2024-04-01 02:36:26,733 -   best_eval_score = 0.6833
2024-04-01 02:36:26,733 -   eval_score = 0.6828
2024-04-01 02:36:26,733 - EarlyStopping counter: 6 out of 8
2024-04-01 02:36:43,116 - ***** Epoch: 33: Eval results *****
2024-04-01 02:36:43,125 -   train_loss = 0.0042
2024-04-01 02:36:43,125 -   best_eval_score = 0.6833
2024-04-01 02:36:43,125 -   eval_score = 0.6828
2024-04-01 02:36:43,125 - EarlyStopping counter: 7 out of 8
2024-04-01 02:36:59,807 - ***** Epoch: 34: Eval results *****
2024-04-01 02:36:59,808 -   train_loss = 0.0037
2024-04-01 02:36:59,808 -   best_eval_score = 0.6833
2024-04-01 02:36:59,808 -   eval_score = 0.6828
2024-04-01 02:36:59,808 - EarlyStopping counter: 8 out of 8
2024-04-01 02:36:59,808 - EarlyStopping at epoch 34
2024-04-01 02:36:59,810 - Training is finished...
2024-04-01 02:36:59,811 - Testing begins...
2024-04-01 02:37:02,667 - ***** Test: Confusion Matrix *****
2024-04-01 02:37:02,668 - [[31  4  0  0  8  0  1  0  2  3  1  0  5  1  0  1  0  0  0  0]
 [ 0 41  0  0  0  0  0  0  1  0  0  0  0  1  0  0  0  0  0  0]
 [ 0  0 27  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 2  1  0  0 13  0  3  0  0  0  0  1  1  1  1  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  0  0  0  0  1  0]
 [ 0  0  0  0  4  0  3  0  2  1  0  0  0  0  1  0  0  1  0  0]
 [ 1  0  0  0  0  1  0  5  2  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  3  6  0  0  0  0  1  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  3  1  0  0  0  0  3  0  1  0  0]
 [ 1  0  0  0  0  0  0  0  0  1 14  0  1  0  0  0  0  1  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 17  0  0  0  0  0  0  1  1]
 [ 3  2  0  1  0  1  0  2  3  0  0  0 35  2  5  0  1  1  1  0]
 [ 0  0  0  0  0  1  2  0  0  0  2  1  0 18  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  1  2 15  0  1  1  0  1]
 [ 0  1  0  1  0  0  0  1  1  0  0  0  5  0  1 11  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  1  0 14  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  0  0  1  0  0  0  0 13  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  0 10  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  0  0  1  7]]
2024-04-01 02:37:02,669 - ***** Evaluation results *****
2024-04-01 02:37:02,669 -   acc = 0.7146
2024-04-01 02:37:02,669 -   f1 = 0.6845
2024-04-01 02:37:02,669 -   prec = 0.6788
2024-04-01 02:37:02,669 -   rec = 0.7012
2024-04-01 02:37:02,669 - Testing is finished...
2024-04-01 02:37:02,669 - Multimodal intent recognition is finished...
2024-04-01 02:37:02,669 - Results are saved in results/msz.csv
