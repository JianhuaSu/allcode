2023-12-28 11:35:06,556 - ============================== Params ==============================
2023-12-28 11:35:06,557 - logger_name: msz_MIntRec_multi-class_seed-0_2023-12-28-11-35-06
2023-12-28 11:35:06,557 - dataset: MIntRec
2023-12-28 11:35:06,557 - data_mode: multi-class
2023-12-28 11:35:06,557 - method: msz
2023-12-28 11:35:06,557 - text_backbone: bert-base-uncased
2023-12-28 11:35:06,557 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-28 11:35:06,557 - seed: 0
2023-12-28 11:35:06,557 - num_workers: 8
2023-12-28 11:35:06,557 - gpu_id: 3
2023-12-28 11:35:06,557 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-28 11:35:06,557 - train: True
2023-12-28 11:35:06,557 - tune: False
2023-12-28 11:35:06,557 - save_model: False
2023-12-28 11:35:06,557 - save_results: True
2023-12-28 11:35:06,557 - log_path: logs
2023-12-28 11:35:06,557 - cache_path: 
2023-12-28 11:35:06,557 - video_data_path: video_data
2023-12-28 11:35:06,557 - audio_data_path: audio_data
2023-12-28 11:35:06,557 - video_feats_path: video_feats.pkl
2023-12-28 11:35:06,557 - audio_feats_path: audio_feats.pkl
2023-12-28 11:35:06,557 - results_path: results
2023-12-28 11:35:06,557 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-28 11:35:06,557 - model_path: models
2023-12-28 11:35:06,557 - config_file_name: msz
2023-12-28 11:35:06,557 - results_file_name: msz.csv
2023-12-28 11:35:06,557 - padding_mode: zero
2023-12-28 11:35:06,557 - padding_loc: end
2023-12-28 11:35:06,557 - need_aligned: False
2023-12-28 11:35:06,557 - eval_monitor: f1
2023-12-28 11:35:06,557 - train_batch_size: 16
2023-12-28 11:35:06,557 - eval_batch_size: 8
2023-12-28 11:35:06,557 - test_batch_size: 8
2023-12-28 11:35:06,557 - wait_patience: 8
2023-12-28 11:35:06,557 - nheads: 2
2023-12-28 11:35:06,557 - encoder_layers: 2
2023-12-28 11:35:06,557 - attn_dropout: 0.1
2023-12-28 11:35:06,558 - relu_dropout: 0.1
2023-12-28 11:35:06,558 - embed_dropout: 0.1
2023-12-28 11:35:06,558 - res_dropout: 0.1
2023-12-28 11:35:06,558 - attn_mask: False
2023-12-28 11:35:06,558 - hidden_size: 768
2023-12-28 11:35:06,558 - num_attention_heads: 12
2023-12-28 11:35:06,558 - attention_probs_dropout_prob: 0.2
2023-12-28 11:35:06,558 - hidden_dropout_prob: 0.2
2023-12-28 11:35:06,558 - intermediate_size: 768
2023-12-28 11:35:06,558 - num_hidden_layers: 3
2023-12-28 11:35:06,558 - max_position_embeddings: 512
2023-12-28 11:35:06,558 - position_embedding_type: absolute
2023-12-28 11:35:06,558 - batch_first: True
2023-12-28 11:35:06,558 - hidden_dims: 768
2023-12-28 11:35:06,558 - att_dropouts: [0.2, 0.2, 0.2]
2023-12-28 11:35:06,558 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-28 11:35:06,558 - ta_loss: 0.01
2023-12-28 11:35:06,558 - tv_loss: 0.01
2023-12-28 11:35:06,558 - av_loss: 0.01
2023-12-28 11:35:06,558 - aligned_method: conv1d
2023-12-28 11:35:06,558 - grad_clip: 2
2023-12-28 11:35:06,558 - num_train_epochs: 100
2023-12-28 11:35:06,558 - warmup_proportion: 0.1
2023-12-28 11:35:06,558 - lr: 1e-06
2023-12-28 11:35:06,558 - weight_decay: 0.02
2023-12-28 11:35:06,558 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-0_2023-12-28-11-35-06
2023-12-28 11:35:06,558 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-0_2023-12-28-11-35-06/models
2023-12-28 11:35:06,558 - ============================== End Params ==============================
2023-12-28 11:35:06,628 - Generate Text Features Begin...
2023-12-28 11:35:07,269 - Generate Text Features Finished...
2023-12-28 11:35:07,270 - Load Video Features Begin...
2023-12-28 11:35:17,638 - Load Video Features Finished...
2023-12-28 11:35:18,280 - Load Audio Features Begin...
2023-12-28 11:35:55,869 - Load Audio Features Finished...
2023-12-28 11:36:00,680 - method  begins...
2023-12-28 11:36:12,316 - Multimodal intent recognition begins...
2023-12-28 11:36:12,316 - Training begins...
2023-12-28 11:36:39,397 - ***** Epoch: 1: Eval results *****
2023-12-28 11:36:39,397 -   train_loss = 3.3655
2023-12-28 11:36:39,397 -   best_eval_score = 0.0
2023-12-28 11:36:39,397 -   eval_score = 0.0113
2023-12-28 11:37:04,154 - ***** Epoch: 2: Eval results *****
2023-12-28 11:37:04,154 -   train_loss = 3.1623
2023-12-28 11:37:04,154 -   best_eval_score = 0.0113
2023-12-28 11:37:04,154 -   eval_score = 0.0241
2023-12-28 11:37:29,782 - ***** Epoch: 3: Eval results *****
2023-12-28 11:37:29,783 -   train_loss = 3.0427
2023-12-28 11:37:29,783 -   best_eval_score = 0.0241
2023-12-28 11:37:29,783 -   eval_score = 0.0243
2023-12-28 11:37:56,030 - ***** Epoch: 4: Eval results *****
2023-12-28 11:37:56,030 -   train_loss = 2.9829
2023-12-28 11:37:56,030 -   best_eval_score = 0.0243
2023-12-28 11:37:56,030 -   eval_score = 0.024
2023-12-28 11:37:56,030 - EarlyStopping counter: 1 out of 8
2023-12-28 11:38:23,083 - ***** Epoch: 5: Eval results *****
2023-12-28 11:38:23,084 -   train_loss = 2.9392
2023-12-28 11:38:23,084 -   best_eval_score = 0.0243
2023-12-28 11:38:23,084 -   eval_score = 0.0184
2023-12-28 11:38:23,084 - EarlyStopping counter: 2 out of 8
2023-12-28 11:38:49,255 - ***** Epoch: 6: Eval results *****
2023-12-28 11:38:49,255 -   train_loss = 2.9053
2023-12-28 11:38:49,255 -   best_eval_score = 0.0243
2023-12-28 11:38:49,255 -   eval_score = 0.0252
2023-12-28 11:39:14,604 - ***** Epoch: 7: Eval results *****
2023-12-28 11:39:14,604 -   train_loss = 2.8882
2023-12-28 11:39:14,604 -   best_eval_score = 0.0252
2023-12-28 11:39:14,604 -   eval_score = 0.0237
2023-12-28 11:39:14,605 - EarlyStopping counter: 1 out of 8
2023-12-28 11:39:46,925 - ***** Epoch: 8: Eval results *****
2023-12-28 11:39:46,925 -   train_loss = 2.8708
2023-12-28 11:39:46,925 -   best_eval_score = 0.0252
2023-12-28 11:39:46,925 -   eval_score = 0.0112
2023-12-28 11:39:46,925 - EarlyStopping counter: 2 out of 8
2023-12-28 11:40:12,149 - ***** Epoch: 9: Eval results *****
2023-12-28 11:40:12,149 -   train_loss = 2.8527
2023-12-28 11:40:12,149 -   best_eval_score = 0.0252
2023-12-28 11:40:12,149 -   eval_score = 0.0114
2023-12-28 11:40:12,150 - EarlyStopping counter: 3 out of 8
2023-12-28 11:40:37,467 - ***** Epoch: 10: Eval results *****
2023-12-28 11:40:37,467 -   train_loss = 2.8215
2023-12-28 11:40:37,467 -   best_eval_score = 0.0252
2023-12-28 11:40:37,467 -   eval_score = 0.0417
2023-12-28 11:41:04,663 - ***** Epoch: 11: Eval results *****
2023-12-28 11:41:04,663 -   train_loss = 2.7987
2023-12-28 11:41:04,663 -   best_eval_score = 0.0417
2023-12-28 11:41:04,663 -   eval_score = 0.0282
2023-12-28 11:41:04,663 - EarlyStopping counter: 1 out of 8
2023-12-28 11:41:30,388 - ***** Epoch: 12: Eval results *****
2023-12-28 11:41:30,388 -   train_loss = 2.7603
2023-12-28 11:41:30,388 -   best_eval_score = 0.0417
2023-12-28 11:41:30,388 -   eval_score = 0.0475
2023-12-28 11:41:55,276 - ***** Epoch: 13: Eval results *****
2023-12-28 11:41:55,276 -   train_loss = 2.7553
2023-12-28 11:41:55,276 -   best_eval_score = 0.0475
2023-12-28 11:41:55,276 -   eval_score = 0.0686
2023-12-28 11:42:19,939 - ***** Epoch: 14: Eval results *****
2023-12-28 11:42:19,939 -   train_loss = 2.7276
2023-12-28 11:42:19,939 -   best_eval_score = 0.0686
2023-12-28 11:42:19,940 -   eval_score = 0.0384
2023-12-28 11:42:19,940 - EarlyStopping counter: 1 out of 8
2023-12-28 11:42:50,430 - ***** Epoch: 15: Eval results *****
2023-12-28 11:42:50,431 -   train_loss = 2.6726
2023-12-28 11:42:50,431 -   best_eval_score = 0.0686
2023-12-28 11:42:50,431 -   eval_score = 0.0553
2023-12-28 11:42:50,431 - EarlyStopping counter: 2 out of 8
2023-12-28 11:43:15,347 - ***** Epoch: 16: Eval results *****
2023-12-28 11:43:15,349 -   train_loss = 2.5861
2023-12-28 11:43:15,349 -   best_eval_score = 0.0686
2023-12-28 11:43:15,349 -   eval_score = 0.0783
2023-12-28 11:43:40,205 - ***** Epoch: 17: Eval results *****
2023-12-28 11:43:40,214 -   train_loss = 2.4991
2023-12-28 11:43:40,214 -   best_eval_score = 0.0783
2023-12-28 11:43:40,214 -   eval_score = 0.1115
2023-12-28 11:44:05,344 - ***** Epoch: 18: Eval results *****
2023-12-28 11:44:05,344 -   train_loss = 2.3433
2023-12-28 11:44:05,345 -   best_eval_score = 0.1115
2023-12-28 11:44:05,345 -   eval_score = 0.1298
2023-12-28 11:44:33,625 - ***** Epoch: 19: Eval results *****
2023-12-28 11:44:33,625 -   train_loss = 2.1745
2023-12-28 11:44:33,625 -   best_eval_score = 0.1298
2023-12-28 11:44:33,625 -   eval_score = 0.183
2023-12-28 11:44:58,574 - ***** Epoch: 20: Eval results *****
2023-12-28 11:44:58,574 -   train_loss = 1.9519
2023-12-28 11:44:58,574 -   best_eval_score = 0.183
2023-12-28 11:44:58,574 -   eval_score = 0.2592
2023-12-28 11:45:24,313 - ***** Epoch: 21: Eval results *****
2023-12-28 11:45:24,313 -   train_loss = 1.7652
2023-12-28 11:45:24,313 -   best_eval_score = 0.2592
2023-12-28 11:45:24,313 -   eval_score = 0.3057
2023-12-28 11:45:50,383 - ***** Epoch: 22: Eval results *****
2023-12-28 11:45:50,383 -   train_loss = 1.5618
2023-12-28 11:45:50,383 -   best_eval_score = 0.3057
2023-12-28 11:45:50,383 -   eval_score = 0.387
2023-12-28 11:46:15,272 - ***** Epoch: 23: Eval results *****
2023-12-28 11:46:15,273 -   train_loss = 1.4284
2023-12-28 11:46:15,273 -   best_eval_score = 0.387
2023-12-28 11:46:15,273 -   eval_score = 0.4017
2023-12-28 11:46:40,384 - ***** Epoch: 24: Eval results *****
2023-12-28 11:46:40,384 -   train_loss = 1.2862
2023-12-28 11:46:40,384 -   best_eval_score = 0.4017
2023-12-28 11:46:40,384 -   eval_score = 0.417
2023-12-28 11:47:04,782 - ***** Epoch: 25: Eval results *****
2023-12-28 11:47:04,783 -   train_loss = 1.1241
2023-12-28 11:47:04,783 -   best_eval_score = 0.417
2023-12-28 11:47:04,783 -   eval_score = 0.4755
2023-12-28 11:47:29,992 - ***** Epoch: 26: Eval results *****
2023-12-28 11:47:29,993 -   train_loss = 1.0104
2023-12-28 11:47:29,993 -   best_eval_score = 0.4755
2023-12-28 11:47:29,993 -   eval_score = 0.4439
2023-12-28 11:47:29,993 - EarlyStopping counter: 1 out of 8
2023-12-28 11:47:55,537 - ***** Epoch: 27: Eval results *****
2023-12-28 11:47:55,537 -   train_loss = 0.906
2023-12-28 11:47:55,537 -   best_eval_score = 0.4755
2023-12-28 11:47:55,537 -   eval_score = 0.4902
2023-12-28 11:48:20,152 - ***** Epoch: 28: Eval results *****
2023-12-28 11:48:20,153 -   train_loss = 0.8046
2023-12-28 11:48:20,153 -   best_eval_score = 0.4902
2023-12-28 11:48:20,153 -   eval_score = 0.5513
2023-12-28 11:48:44,824 - ***** Epoch: 29: Eval results *****
2023-12-28 11:48:44,824 -   train_loss = 0.729
2023-12-28 11:48:44,824 -   best_eval_score = 0.5513
2023-12-28 11:48:44,824 -   eval_score = 0.5423
2023-12-28 11:48:44,824 - EarlyStopping counter: 1 out of 8
2023-12-28 11:49:08,987 - ***** Epoch: 30: Eval results *****
2023-12-28 11:49:08,987 -   train_loss = 0.6193
2023-12-28 11:49:08,988 -   best_eval_score = 0.5513
2023-12-28 11:49:08,988 -   eval_score = 0.5244
2023-12-28 11:49:08,988 - EarlyStopping counter: 2 out of 8
2023-12-28 11:49:34,069 - ***** Epoch: 31: Eval results *****
2023-12-28 11:49:34,069 -   train_loss = 0.5303
2023-12-28 11:49:34,069 -   best_eval_score = 0.5513
2023-12-28 11:49:34,070 -   eval_score = 0.5298
2023-12-28 11:49:34,070 - EarlyStopping counter: 3 out of 8
2023-12-28 11:49:58,866 - ***** Epoch: 32: Eval results *****
2023-12-28 11:49:58,866 -   train_loss = 0.4634
2023-12-28 11:49:58,866 -   best_eval_score = 0.5513
2023-12-28 11:49:58,866 -   eval_score = 0.555
2023-12-28 11:50:24,980 - ***** Epoch: 33: Eval results *****
2023-12-28 11:50:24,981 -   train_loss = 0.4114
2023-12-28 11:50:24,981 -   best_eval_score = 0.555
2023-12-28 11:50:24,981 -   eval_score = 0.5784
2023-12-28 11:50:51,613 - ***** Epoch: 34: Eval results *****
2023-12-28 11:50:51,613 -   train_loss = 0.3624
2023-12-28 11:50:51,613 -   best_eval_score = 0.5784
2023-12-28 11:50:51,614 -   eval_score = 0.6
2023-12-28 11:51:15,736 - ***** Epoch: 35: Eval results *****
2023-12-28 11:51:15,736 -   train_loss = 0.3068
2023-12-28 11:51:15,736 -   best_eval_score = 0.6
2023-12-28 11:51:15,736 -   eval_score = 0.6275
2023-12-28 11:51:40,649 - ***** Epoch: 36: Eval results *****
2023-12-28 11:51:40,649 -   train_loss = 0.2629
2023-12-28 11:51:40,649 -   best_eval_score = 0.6275
2023-12-28 11:51:40,649 -   eval_score = 0.6208
2023-12-28 11:51:40,649 - EarlyStopping counter: 1 out of 8
2023-12-28 11:52:05,544 - ***** Epoch: 37: Eval results *****
2023-12-28 11:52:05,545 -   train_loss = 0.2275
2023-12-28 11:52:05,545 -   best_eval_score = 0.6275
2023-12-28 11:52:05,545 -   eval_score = 0.6015
2023-12-28 11:52:05,545 - EarlyStopping counter: 2 out of 8
2023-12-28 11:52:42,834 - ***** Epoch: 38: Eval results *****
2023-12-28 11:52:42,835 -   train_loss = 0.201
2023-12-28 11:52:42,835 -   best_eval_score = 0.6275
2023-12-28 11:52:42,835 -   eval_score = 0.5972
2023-12-28 11:52:42,835 - EarlyStopping counter: 3 out of 8
2023-12-28 11:53:07,588 - ***** Epoch: 39: Eval results *****
2023-12-28 11:53:07,588 -   train_loss = 0.1765
2023-12-28 11:53:07,588 -   best_eval_score = 0.6275
2023-12-28 11:53:07,588 -   eval_score = 0.6174
2023-12-28 11:53:07,588 - EarlyStopping counter: 4 out of 8
2023-12-28 11:53:31,966 - ***** Epoch: 40: Eval results *****
2023-12-28 11:53:31,966 -   train_loss = 0.1555
2023-12-28 11:53:31,966 -   best_eval_score = 0.6275
2023-12-28 11:53:31,966 -   eval_score = 0.6202
2023-12-28 11:53:31,966 - EarlyStopping counter: 5 out of 8
2023-12-28 11:53:56,684 - ***** Epoch: 41: Eval results *****
2023-12-28 11:53:56,684 -   train_loss = 0.1281
2023-12-28 11:53:56,685 -   best_eval_score = 0.6275
2023-12-28 11:53:56,685 -   eval_score = 0.6364
2023-12-28 11:54:21,540 - ***** Epoch: 42: Eval results *****
2023-12-28 11:54:21,541 -   train_loss = 0.1159
2023-12-28 11:54:21,541 -   best_eval_score = 0.6364
2023-12-28 11:54:21,541 -   eval_score = 0.6283
2023-12-28 11:54:21,541 - EarlyStopping counter: 1 out of 8
2023-12-28 11:54:45,857 - ***** Epoch: 43: Eval results *****
2023-12-28 11:54:45,858 -   train_loss = 0.1062
2023-12-28 11:54:45,858 -   best_eval_score = 0.6364
2023-12-28 11:54:45,858 -   eval_score = 0.6196
2023-12-28 11:54:45,858 - EarlyStopping counter: 2 out of 8
2023-12-28 11:55:10,564 - ***** Epoch: 44: Eval results *****
2023-12-28 11:55:10,565 -   train_loss = 0.0922
2023-12-28 11:55:10,565 -   best_eval_score = 0.6364
2023-12-28 11:55:10,565 -   eval_score = 0.626
2023-12-28 11:55:10,565 - EarlyStopping counter: 3 out of 8
2023-12-28 11:55:35,270 - ***** Epoch: 45: Eval results *****
2023-12-28 11:55:35,270 -   train_loss = 0.0753
2023-12-28 11:55:35,270 -   best_eval_score = 0.6364
2023-12-28 11:55:35,270 -   eval_score = 0.6268
2023-12-28 11:55:35,270 - EarlyStopping counter: 4 out of 8
2023-12-28 11:56:01,218 - ***** Epoch: 46: Eval results *****
2023-12-28 11:56:01,227 -   train_loss = 0.0642
2023-12-28 11:56:01,227 -   best_eval_score = 0.6364
2023-12-28 11:56:01,227 -   eval_score = 0.6243
2023-12-28 11:56:01,227 - EarlyStopping counter: 5 out of 8
2023-12-28 11:56:28,109 - ***** Epoch: 47: Eval results *****
2023-12-28 11:56:28,109 -   train_loss = 0.0588
2023-12-28 11:56:28,109 -   best_eval_score = 0.6364
2023-12-28 11:56:28,109 -   eval_score = 0.6245
2023-12-28 11:56:28,109 - EarlyStopping counter: 6 out of 8
2023-12-28 11:56:52,541 - ***** Epoch: 48: Eval results *****
2023-12-28 11:56:52,541 -   train_loss = 0.0532
2023-12-28 11:56:52,542 -   best_eval_score = 0.6364
2023-12-28 11:56:52,542 -   eval_score = 0.6246
2023-12-28 11:56:52,542 - EarlyStopping counter: 7 out of 8
2023-12-28 11:57:17,604 - ***** Epoch: 49: Eval results *****
2023-12-28 11:57:17,604 -   train_loss = 0.0469
2023-12-28 11:57:17,604 -   best_eval_score = 0.6364
2023-12-28 11:57:17,604 -   eval_score = 0.6355
2023-12-28 11:57:17,604 - EarlyStopping counter: 8 out of 8
2023-12-28 11:57:17,604 - EarlyStopping at epoch 49
2023-12-28 11:57:17,607 - Training is finished...
2023-12-28 11:57:17,607 - Testing begins...
2023-12-28 11:57:23,550 - ***** Test: Confusion Matrix *****
2023-12-28 11:57:23,554 - [[23  1  0  0  6  0  9  5  2  4  0  0  2  2  0  3  0  0  0  0]
 [ 0 34  0  1  0  1  0  3  1  0  0  0  1  1  0  0  0  0  1  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 24  0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  0]
 [ 2  0  0  0 10  0  6  0  0  1  0  1  0  2  1  0  0  0  0  0]
 [ 0  0  0  0  0 10  0  1  0  0  0  0  0  0  0  0  0  1  0  0]
 [ 2  0  0  0  1  0  4  0  1  1  0  0  0  0  0  1  1  1  0  0]
 [ 2  0  0  0  0  0  0  6  1  1  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  5  1  0  0  0  0  1  0  1  0  0  0  1]
 [ 1  0  0  0  0  0  0  0  0  4  1  0  0  0  0  2  0  2  0  0]
 [ 1  0  0  0  0  0  0  1  0  3 11  0  0  2  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0 17  0  0  0  0  0  0  0  1]
 [ 2  1  0  1  1  0  3  3  1  1  0  1 25  1  6  6  2  0  1  2]
 [ 0  0  0  0  0  1  1  1  0  0  1  1  0 17  2  0  0  0  0  1]
 [ 0  0  1  0  1  0  0  0  1  0  0  0  0  2 14  0  0  0  0  3]
 [ 0  1  0  0  1  0  0  0  1  0  0  0  1  0  1 15  0  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  1  0  3  0 12  0  0  0]
 [ 0  0  0  1  0  0  0  0  0  2  0  0  0  1  1  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  2  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  3  0  1  2  0  1  0  0  3]]
2023-12-28 11:57:23,554 - ***** Evaluation results *****
2023-12-28 11:57:23,554 -   acc = 0.6157
2023-12-28 11:57:23,554 -   f1 = 0.5857
2023-12-28 11:57:23,554 -   prec = 0.5942
2023-12-28 11:57:23,554 -   rec = 0.6066
2023-12-28 11:57:23,554 - Testing is finished...
2023-12-28 11:57:23,554 - Multimodal intent recognition is finished...
2023-12-28 11:57:23,554 - Results are saved in results/msz.csv
