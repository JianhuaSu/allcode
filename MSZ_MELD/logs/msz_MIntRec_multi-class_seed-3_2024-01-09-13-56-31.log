2024-01-09 13:56:31,560 - ============================== Params ==============================
2024-01-09 13:56:31,560 - logger_name: msz_MIntRec_multi-class_seed-3_2024-01-09-13-56-31
2024-01-09 13:56:31,560 - dataset: MIntRec
2024-01-09 13:56:31,560 - data_mode: multi-class
2024-01-09 13:56:31,560 - method: msz
2024-01-09 13:56:31,560 - text_backbone: bert-base-uncased
2024-01-09 13:56:31,560 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-09 13:56:31,560 - seed: 3
2024-01-09 13:56:31,560 - num_workers: 8
2024-01-09 13:56:31,560 - gpu_id: 1
2024-01-09 13:56:31,560 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-09 13:56:31,560 - train: True
2024-01-09 13:56:31,560 - tune: False
2024-01-09 13:56:31,561 - save_model: False
2024-01-09 13:56:31,561 - save_results: True
2024-01-09 13:56:31,561 - log_path: logs
2024-01-09 13:56:31,561 - cache_path: 
2024-01-09 13:56:31,561 - video_data_path: video_data
2024-01-09 13:56:31,561 - audio_data_path: audio_data
2024-01-09 13:56:31,561 - video_feats_path: video_feats.pkl
2024-01-09 13:56:31,561 - audio_feats_path: audio_feats.pkl
2024-01-09 13:56:31,561 - results_path: results
2024-01-09 13:56:31,561 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-09 13:56:31,561 - model_path: models
2024-01-09 13:56:31,561 - config_file_name: msz
2024-01-09 13:56:31,561 - results_file_name: msz.csv
2024-01-09 13:56:31,561 - padding_mode: zero
2024-01-09 13:56:31,561 - padding_loc: end
2024-01-09 13:56:31,561 - need_aligned: False
2024-01-09 13:56:31,561 - eval_monitor: f1
2024-01-09 13:56:31,561 - train_batch_size: 16
2024-01-09 13:56:31,561 - eval_batch_size: 8
2024-01-09 13:56:31,561 - test_batch_size: 8
2024-01-09 13:56:31,561 - wait_patience: 8
2024-01-09 13:56:31,561 - nheads: 12
2024-01-09 13:56:31,561 - encoder_layers: 6
2024-01-09 13:56:31,561 - attn_dropout: 0.1
2024-01-09 13:56:31,561 - relu_dropout: 0.1
2024-01-09 13:56:31,561 - embed_dropout: 0.1
2024-01-09 13:56:31,561 - res_dropout: 0.1
2024-01-09 13:56:31,561 - attn_mask: False
2024-01-09 13:56:31,561 - hidden_size: 768
2024-01-09 13:56:31,561 - num_attention_heads: 12
2024-01-09 13:56:31,561 - attention_probs_dropout_prob: 0.1
2024-01-09 13:56:31,561 - hidden_dropout_prob: 0.1
2024-01-09 13:56:31,561 - intermediate_size: 768
2024-01-09 13:56:31,561 - num_hidden_layers: 6
2024-01-09 13:56:31,561 - max_position_embeddings: 768
2024-01-09 13:56:31,562 - position_embedding_type: absolute
2024-01-09 13:56:31,562 - batch_first: True
2024-01-09 13:56:31,562 - hidden_dims: 768
2024-01-09 13:56:31,562 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-09 13:56:31,562 - spe_dropouts: [0.2, 0.1, 0.1]
2024-01-09 13:56:31,562 - aligned_method: conv1d
2024-01-09 13:56:31,562 - grad_clip: 2
2024-01-09 13:56:31,562 - num_train_epochs: 100
2024-01-09 13:56:31,562 - warmup_proportion: 0.1
2024-01-09 13:56:31,562 - lr: 3e-06
2024-01-09 13:56:31,562 - weight_decay: 0.01
2024-01-09 13:56:31,562 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2024-01-09-13-56-31
2024-01-09 13:56:31,562 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2024-01-09-13-56-31/models
2024-01-09 13:56:31,562 - ============================== End Params ==============================
2024-01-09 13:56:31,565 - Generate Text Features Begin...
2024-01-09 13:56:32,074 - Generate Text Features Finished...
2024-01-09 13:56:32,075 - Load Video Features Begin...
2024-01-09 13:56:32,418 - Load Video Features Finished...
2024-01-09 13:56:33,112 - Load Audio Features Begin...
2024-01-09 13:56:34,264 - Load Audio Features Finished...
2024-01-09 13:56:38,315 - method  begins...
2024-01-09 13:56:44,217 - Multimodal intent recognition begins...
2024-01-09 13:56:44,217 - Training begins...
2024-01-09 13:57:31,745 - ***** Epoch: 1: Eval results *****
2024-01-09 13:57:31,746 -   train_loss = 2.9139
2024-01-09 13:57:31,746 -   best_eval_score = 0.0
2024-01-09 13:57:31,746 -   eval_score = 0.0293
2024-01-09 13:58:17,263 - ***** Epoch: 2: Eval results *****
2024-01-09 13:58:17,263 -   train_loss = 2.7462
2024-01-09 13:58:17,263 -   best_eval_score = 0.0293
2024-01-09 13:58:17,263 -   eval_score = 0.071
2024-01-09 13:59:03,161 - ***** Epoch: 3: Eval results *****
2024-01-09 13:59:03,163 -   train_loss = 2.3784
2024-01-09 13:59:03,163 -   best_eval_score = 0.071
2024-01-09 13:59:03,163 -   eval_score = 0.2123
2024-01-09 13:59:48,642 - ***** Epoch: 4: Eval results *****
2024-01-09 13:59:48,642 -   train_loss = 1.8281
2024-01-09 13:59:48,642 -   best_eval_score = 0.2123
2024-01-09 13:59:48,642 -   eval_score = 0.4376
2024-01-09 14:00:34,035 - ***** Epoch: 5: Eval results *****
2024-01-09 14:00:34,036 -   train_loss = 1.3603
2024-01-09 14:00:34,036 -   best_eval_score = 0.4376
2024-01-09 14:00:34,036 -   eval_score = 0.5249
2024-01-09 14:01:19,933 - ***** Epoch: 6: Eval results *****
2024-01-09 14:01:19,933 -   train_loss = 0.992
2024-01-09 14:01:19,933 -   best_eval_score = 0.5249
2024-01-09 14:01:19,933 -   eval_score = 0.5818
2024-01-09 14:02:05,323 - ***** Epoch: 7: Eval results *****
2024-01-09 14:02:05,323 -   train_loss = 0.7324
2024-01-09 14:02:05,323 -   best_eval_score = 0.5818
2024-01-09 14:02:05,323 -   eval_score = 0.5936
2024-01-09 14:02:51,425 - ***** Epoch: 8: Eval results *****
2024-01-09 14:02:51,425 -   train_loss = 0.5499
2024-01-09 14:02:51,425 -   best_eval_score = 0.5936
2024-01-09 14:02:51,425 -   eval_score = 0.6188
2024-01-09 14:03:37,346 - ***** Epoch: 9: Eval results *****
2024-01-09 14:03:37,346 -   train_loss = 0.3734
2024-01-09 14:03:37,346 -   best_eval_score = 0.6188
2024-01-09 14:03:37,346 -   eval_score = 0.6568
2024-01-09 14:04:23,285 - ***** Epoch: 10: Eval results *****
2024-01-09 14:04:23,285 -   train_loss = 0.2758
2024-01-09 14:04:23,285 -   best_eval_score = 0.6568
2024-01-09 14:04:23,285 -   eval_score = 0.6558
2024-01-09 14:04:23,286 - EarlyStopping counter: 1 out of 8
2024-01-09 14:05:09,114 - ***** Epoch: 11: Eval results *****
2024-01-09 14:05:09,114 -   train_loss = 0.1755
2024-01-09 14:05:09,114 -   best_eval_score = 0.6568
2024-01-09 14:05:09,114 -   eval_score = 0.6819
2024-01-09 14:05:54,889 - ***** Epoch: 12: Eval results *****
2024-01-09 14:05:54,889 -   train_loss = 0.1215
2024-01-09 14:05:54,889 -   best_eval_score = 0.6819
2024-01-09 14:05:54,889 -   eval_score = 0.671
2024-01-09 14:05:54,889 - EarlyStopping counter: 1 out of 8
2024-01-09 14:06:41,016 - ***** Epoch: 13: Eval results *****
2024-01-09 14:06:41,016 -   train_loss = 0.0818
2024-01-09 14:06:41,016 -   best_eval_score = 0.6819
2024-01-09 14:06:41,016 -   eval_score = 0.6753
2024-01-09 14:06:41,016 - EarlyStopping counter: 2 out of 8
2024-01-09 14:07:26,732 - ***** Epoch: 14: Eval results *****
2024-01-09 14:07:26,732 -   train_loss = 0.0628
2024-01-09 14:07:26,732 -   best_eval_score = 0.6819
2024-01-09 14:07:26,732 -   eval_score = 0.6648
2024-01-09 14:07:26,732 - EarlyStopping counter: 3 out of 8
2024-01-09 14:08:12,711 - ***** Epoch: 15: Eval results *****
2024-01-09 14:08:12,711 -   train_loss = 0.0484
2024-01-09 14:08:12,711 -   best_eval_score = 0.6819
2024-01-09 14:08:12,711 -   eval_score = 0.6805
2024-01-09 14:08:12,712 - EarlyStopping counter: 4 out of 8
2024-01-09 14:08:58,155 - ***** Epoch: 16: Eval results *****
2024-01-09 14:08:58,155 -   train_loss = 0.0331
2024-01-09 14:08:58,155 -   best_eval_score = 0.6819
2024-01-09 14:08:58,155 -   eval_score = 0.6779
2024-01-09 14:08:58,155 - EarlyStopping counter: 5 out of 8
2024-01-09 14:09:43,760 - ***** Epoch: 17: Eval results *****
2024-01-09 14:09:43,761 -   train_loss = 0.027
2024-01-09 14:09:43,761 -   best_eval_score = 0.6819
2024-01-09 14:09:43,761 -   eval_score = 0.6746
2024-01-09 14:09:43,761 - EarlyStopping counter: 6 out of 8
2024-01-09 14:10:29,885 - ***** Epoch: 18: Eval results *****
2024-01-09 14:10:29,885 -   train_loss = 0.0246
2024-01-09 14:10:29,885 -   best_eval_score = 0.6819
2024-01-09 14:10:29,885 -   eval_score = 0.6767
2024-01-09 14:10:29,885 - EarlyStopping counter: 7 out of 8
2024-01-09 14:11:15,451 - ***** Epoch: 19: Eval results *****
2024-01-09 14:11:15,451 -   train_loss = 0.0215
2024-01-09 14:11:15,451 -   best_eval_score = 0.6819
2024-01-09 14:11:15,451 -   eval_score = 0.6736
2024-01-09 14:11:15,451 - EarlyStopping counter: 8 out of 8
2024-01-09 14:11:15,451 - EarlyStopping at epoch 19
2024-01-09 14:11:15,457 - Training is finished...
2024-01-09 14:11:15,457 - Testing begins...
2024-01-09 14:11:22,139 - ***** Test: Confusion Matrix *****
2024-01-09 14:11:22,140 - [[38  2  0  0  7  0  0  1  0  2  1  0  5  1  0  0  0  0  0  0]
 [ 0 33  0  1  0  3  0  1  1  0  1  0  2  0  1  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 6  0  0  0 10  0  0  0  0  1  0  1  2  2  0  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 1  1  0  0  5  0  0  0  3  0  0  0  1  0  0  0  1  0  0  0]
 [ 3  0  0  0  0  0  0  6  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  1  0  0  3  2  0  0  0  0  2  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  3  0  0  0  0  0  3  1  1  0  0]
 [ 0  0  0  0  0  0  0  1  0  1 14  0  0  0  1  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  1 16  0  0  0  0  0  0  0  1]
 [ 3  2  0  0  1  0  0  1  0  1  0  1 39  3  4  1  1  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  0  1  1  0 20  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  3 14  0  2  0  0  2]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  3  1  0 16  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  2  0 13  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  2  0  0  0  0 11  0  0]
 [ 0  0  1  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  2  0  2  0  0  4]]
2024-01-09 14:11:22,140 - ***** Evaluation results *****
2024-01-09 14:11:22,140 -   acc = 0.6921
2024-01-09 14:11:22,140 -   f1 = 0.6364
2024-01-09 14:11:22,140 -   prec = 0.6395
2024-01-09 14:11:22,140 -   rec = 0.6438
2024-01-09 14:11:22,140 - Testing is finished...
2024-01-09 14:11:22,140 - Multimodal intent recognition is finished...
2024-01-09 14:11:22,140 - Results are saved in results/msz.csv
