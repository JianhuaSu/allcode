2024-01-04 11:26:33,186 - ============================== Params ==============================
2024-01-04 11:26:33,187 - logger_name: msz_MIntRec_multi-class_seed-0_2024-01-04-11-26-33
2024-01-04 11:26:33,187 - dataset: MIntRec
2024-01-04 11:26:33,187 - data_mode: multi-class
2024-01-04 11:26:33,187 - method: msz
2024-01-04 11:26:33,187 - text_backbone: bert-base-uncased
2024-01-04 11:26:33,187 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-04 11:26:33,187 - seed: 0
2024-01-04 11:26:33,187 - num_workers: 8
2024-01-04 11:26:33,187 - gpu_id: 1
2024-01-04 11:26:33,187 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-04 11:26:33,187 - train: True
2024-01-04 11:26:33,187 - tune: False
2024-01-04 11:26:33,187 - save_model: False
2024-01-04 11:26:33,187 - save_results: True
2024-01-04 11:26:33,187 - log_path: logs
2024-01-04 11:26:33,187 - cache_path: 
2024-01-04 11:26:33,187 - video_data_path: video_data
2024-01-04 11:26:33,187 - audio_data_path: audio_data
2024-01-04 11:26:33,187 - video_feats_path: video_feats.pkl
2024-01-04 11:26:33,187 - audio_feats_path: audio_feats.pkl
2024-01-04 11:26:33,187 - results_path: results
2024-01-04 11:26:33,187 - output_path: /home/sujianhua/Outputs/MIntRec
2024-01-04 11:26:33,187 - model_path: models
2024-01-04 11:26:33,187 - config_file_name: msz
2024-01-04 11:26:33,187 - results_file_name: msz.csv
2024-01-04 11:26:33,187 - padding_mode: zero
2024-01-04 11:26:33,187 - padding_loc: end
2024-01-04 11:26:33,187 - need_aligned: False
2024-01-04 11:26:33,187 - eval_monitor: f1
2024-01-04 11:26:33,187 - train_batch_size: 16
2024-01-04 11:26:33,187 - eval_batch_size: 8
2024-01-04 11:26:33,187 - test_batch_size: 8
2024-01-04 11:26:33,187 - wait_patience: 8
2024-01-04 11:26:33,187 - nheads: 2
2024-01-04 11:26:33,187 - encoder_layers: 2
2024-01-04 11:26:33,188 - attn_dropout: 0.1
2024-01-04 11:26:33,188 - relu_dropout: 0.1
2024-01-04 11:26:33,188 - embed_dropout: 0.1
2024-01-04 11:26:33,188 - res_dropout: 0.1
2024-01-04 11:26:33,188 - attn_mask: False
2024-01-04 11:26:33,188 - hidden_size: 768
2024-01-04 11:26:33,188 - num_attention_heads: 12
2024-01-04 11:26:33,188 - attention_probs_dropout_prob: 0.2
2024-01-04 11:26:33,188 - hidden_dropout_prob: 0.2
2024-01-04 11:26:33,188 - intermediate_size: 768
2024-01-04 11:26:33,188 - num_hidden_layers: 3
2024-01-04 11:26:33,188 - max_position_embeddings: 512
2024-01-04 11:26:33,188 - position_embedding_type: absolute
2024-01-04 11:26:33,188 - batch_first: True
2024-01-04 11:26:33,188 - hidden_dims: 768
2024-01-04 11:26:33,188 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-04 11:26:33,188 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-04 11:26:33,188 - ta_loss: 0.1
2024-01-04 11:26:33,188 - tv_loss: 0.1
2024-01-04 11:26:33,188 - av_loss: 0.1
2024-01-04 11:26:33,188 - aligned_method: conv1d
2024-01-04 11:26:33,188 - grad_clip: -1
2024-01-04 11:26:33,188 - num_train_epochs: 100
2024-01-04 11:26:33,188 - warmup_proportion: 0.1
2024-01-04 11:26:33,188 - lr: 1e-06
2024-01-04 11:26:33,188 - weight_decay: 0.01
2024-01-04 11:26:33,188 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-0_2024-01-04-11-26-33
2024-01-04 11:26:33,188 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-0_2024-01-04-11-26-33/models
2024-01-04 11:26:33,188 - ============================== End Params ==============================
2024-01-04 11:26:33,757 - Generate Text Features Begin...
2024-01-04 11:26:34,314 - Generate Text Features Finished...
2024-01-04 11:26:34,315 - Load Video Features Begin...
2024-01-04 11:28:49,122 - Load Video Features Finished...
2024-01-04 11:28:49,738 - Load Audio Features Begin...
2024-01-04 11:33:14,946 - Load Audio Features Finished...
2024-01-04 11:33:18,726 - method  begins...
2024-01-04 11:33:28,234 - Multimodal intent recognition begins...
2024-01-04 11:33:28,234 - Training begins...
2024-01-04 11:33:51,618 - ***** Epoch: 1: Eval results *****
2024-01-04 11:33:51,618 -   train_loss = 2.993
2024-01-04 11:33:51,618 -   best_eval_score = 0.0
2024-01-04 11:33:51,619 -   eval_score = 0.0494
2024-01-04 11:34:13,019 - ***** Epoch: 2: Eval results *****
2024-01-04 11:34:13,019 -   train_loss = 2.9596
2024-01-04 11:34:13,020 -   best_eval_score = 0.0494
2024-01-04 11:34:13,020 -   eval_score = 0.0577
2024-01-04 11:34:34,433 - ***** Epoch: 3: Eval results *****
2024-01-04 11:34:34,433 -   train_loss = 2.9022
2024-01-04 11:34:34,433 -   best_eval_score = 0.0577
2024-01-04 11:34:34,433 -   eval_score = 0.0455
2024-01-04 11:34:34,433 - EarlyStopping counter: 1 out of 8
2024-01-04 11:34:55,682 - ***** Epoch: 4: Eval results *****
2024-01-04 11:34:55,682 -   train_loss = 2.8025
2024-01-04 11:34:55,682 -   best_eval_score = 0.0577
2024-01-04 11:34:55,682 -   eval_score = 0.1105
2024-01-04 11:35:17,155 - ***** Epoch: 5: Eval results *****
2024-01-04 11:35:17,155 -   train_loss = 2.6268
2024-01-04 11:35:17,155 -   best_eval_score = 0.1105
2024-01-04 11:35:17,155 -   eval_score = 0.186
2024-01-04 11:35:38,282 - ***** Epoch: 6: Eval results *****
2024-01-04 11:35:38,282 -   train_loss = 2.3488
2024-01-04 11:35:38,282 -   best_eval_score = 0.186
2024-01-04 11:35:38,283 -   eval_score = 0.2163
2024-01-04 11:35:59,702 - ***** Epoch: 7: Eval results *****
2024-01-04 11:35:59,702 -   train_loss = 1.9748
2024-01-04 11:35:59,702 -   best_eval_score = 0.2163
2024-01-04 11:35:59,702 -   eval_score = 0.2929
2024-01-04 11:36:20,807 - ***** Epoch: 8: Eval results *****
2024-01-04 11:36:20,807 -   train_loss = 1.5846
2024-01-04 11:36:20,807 -   best_eval_score = 0.2929
2024-01-04 11:36:20,807 -   eval_score = 0.4105
2024-01-04 11:36:42,301 - ***** Epoch: 9: Eval results *****
2024-01-04 11:36:42,301 -   train_loss = 1.227
2024-01-04 11:36:42,302 -   best_eval_score = 0.4105
2024-01-04 11:36:42,302 -   eval_score = 0.4803
2024-01-04 11:37:03,536 - ***** Epoch: 10: Eval results *****
2024-01-04 11:37:03,536 -   train_loss = 0.9251
2024-01-04 11:37:03,536 -   best_eval_score = 0.4803
2024-01-04 11:37:03,536 -   eval_score = 0.5093
2024-01-04 11:37:24,632 - ***** Epoch: 11: Eval results *****
2024-01-04 11:37:24,633 -   train_loss = 0.7364
2024-01-04 11:37:24,633 -   best_eval_score = 0.5093
2024-01-04 11:37:24,633 -   eval_score = 0.55
2024-01-04 11:37:46,065 - ***** Epoch: 12: Eval results *****
2024-01-04 11:37:46,065 -   train_loss = 0.5289
2024-01-04 11:37:46,065 -   best_eval_score = 0.55
2024-01-04 11:37:46,065 -   eval_score = 0.5374
2024-01-04 11:37:46,065 - EarlyStopping counter: 1 out of 8
2024-01-04 11:38:07,325 - ***** Epoch: 13: Eval results *****
2024-01-04 11:38:07,326 -   train_loss = 0.4409
2024-01-04 11:38:07,326 -   best_eval_score = 0.55
2024-01-04 11:38:07,326 -   eval_score = 0.5866
2024-01-04 11:38:28,408 - ***** Epoch: 14: Eval results *****
2024-01-04 11:38:28,408 -   train_loss = 0.3021
2024-01-04 11:38:28,408 -   best_eval_score = 0.5866
2024-01-04 11:38:28,408 -   eval_score = 0.5886
2024-01-04 11:38:49,449 - ***** Epoch: 15: Eval results *****
2024-01-04 11:38:49,449 -   train_loss = 0.2445
2024-01-04 11:38:49,449 -   best_eval_score = 0.5886
2024-01-04 11:38:49,449 -   eval_score = 0.5909
2024-01-04 11:39:10,393 - ***** Epoch: 16: Eval results *****
2024-01-04 11:39:10,393 -   train_loss = 0.2011
2024-01-04 11:39:10,393 -   best_eval_score = 0.5909
2024-01-04 11:39:10,393 -   eval_score = 0.6167
2024-01-04 11:39:31,654 - ***** Epoch: 17: Eval results *****
2024-01-04 11:39:31,654 -   train_loss = 0.1366
2024-01-04 11:39:31,654 -   best_eval_score = 0.6167
2024-01-04 11:39:31,654 -   eval_score = 0.648
2024-01-04 11:39:52,883 - ***** Epoch: 18: Eval results *****
2024-01-04 11:39:52,883 -   train_loss = 0.1035
2024-01-04 11:39:52,883 -   best_eval_score = 0.648
2024-01-04 11:39:52,883 -   eval_score = 0.6484
2024-01-04 11:40:14,391 - ***** Epoch: 19: Eval results *****
2024-01-04 11:40:14,391 -   train_loss = 0.0802
2024-01-04 11:40:14,391 -   best_eval_score = 0.6484
2024-01-04 11:40:14,391 -   eval_score = 0.6371
2024-01-04 11:40:14,391 - EarlyStopping counter: 1 out of 8
2024-01-04 11:40:35,634 - ***** Epoch: 20: Eval results *****
2024-01-04 11:40:35,634 -   train_loss = 0.0569
2024-01-04 11:40:35,634 -   best_eval_score = 0.6484
2024-01-04 11:40:35,634 -   eval_score = 0.6208
2024-01-04 11:40:35,634 - EarlyStopping counter: 2 out of 8
2024-01-04 11:40:56,874 - ***** Epoch: 21: Eval results *****
2024-01-04 11:40:56,874 -   train_loss = 0.0293
2024-01-04 11:40:56,874 -   best_eval_score = 0.6484
2024-01-04 11:40:56,874 -   eval_score = 0.6608
2024-01-04 11:41:18,344 - ***** Epoch: 22: Eval results *****
2024-01-04 11:41:18,344 -   train_loss = 0.0252
2024-01-04 11:41:18,344 -   best_eval_score = 0.6608
2024-01-04 11:41:18,344 -   eval_score = 0.6587
2024-01-04 11:41:18,344 - EarlyStopping counter: 1 out of 8
2024-01-04 11:41:39,323 - ***** Epoch: 23: Eval results *****
2024-01-04 11:41:39,323 -   train_loss = 0.0192
2024-01-04 11:41:39,323 -   best_eval_score = 0.6608
2024-01-04 11:41:39,323 -   eval_score = 0.6477
2024-01-04 11:41:39,323 - EarlyStopping counter: 2 out of 8
2024-01-04 11:42:00,569 - ***** Epoch: 24: Eval results *****
2024-01-04 11:42:00,569 -   train_loss = 0.0192
2024-01-04 11:42:00,569 -   best_eval_score = 0.6608
2024-01-04 11:42:00,570 -   eval_score = 0.6446
2024-01-04 11:42:00,570 - EarlyStopping counter: 3 out of 8
2024-01-04 11:42:21,758 - ***** Epoch: 25: Eval results *****
2024-01-04 11:42:21,758 -   train_loss = 0.0127
2024-01-04 11:42:21,758 -   best_eval_score = 0.6608
2024-01-04 11:42:21,758 -   eval_score = 0.6173
2024-01-04 11:42:21,758 - EarlyStopping counter: 4 out of 8
2024-01-04 11:42:43,277 - ***** Epoch: 26: Eval results *****
2024-01-04 11:42:43,277 -   train_loss = 0.0093
2024-01-04 11:42:43,277 -   best_eval_score = 0.6608
2024-01-04 11:42:43,277 -   eval_score = 0.6237
2024-01-04 11:42:43,277 - EarlyStopping counter: 5 out of 8
2024-01-04 11:43:04,298 - ***** Epoch: 27: Eval results *****
2024-01-04 11:43:04,298 -   train_loss = 0.0054
2024-01-04 11:43:04,299 -   best_eval_score = 0.6608
2024-01-04 11:43:04,299 -   eval_score = 0.6251
2024-01-04 11:43:04,299 - EarlyStopping counter: 6 out of 8
2024-01-04 11:43:25,551 - ***** Epoch: 28: Eval results *****
2024-01-04 11:43:25,551 -   train_loss = 0.0082
2024-01-04 11:43:25,551 -   best_eval_score = 0.6608
2024-01-04 11:43:25,551 -   eval_score = 0.6157
2024-01-04 11:43:25,551 - EarlyStopping counter: 7 out of 8
2024-01-04 11:43:46,787 - ***** Epoch: 29: Eval results *****
2024-01-04 11:43:46,787 -   train_loss = 0.0061
2024-01-04 11:43:46,788 -   best_eval_score = 0.6608
2024-01-04 11:43:46,788 -   eval_score = 0.5944
2024-01-04 11:43:46,788 - EarlyStopping counter: 8 out of 8
2024-01-04 11:43:46,788 - EarlyStopping at epoch 29
2024-01-04 11:43:46,790 - Training is finished...
2024-01-04 11:43:46,790 - Testing begins...
2024-01-04 11:43:50,576 - ***** Test: Confusion Matrix *****
2024-01-04 11:43:50,576 - [[27  3  0  0  8  0  2  2  2  4  1  0  7  1  0  0  0  0  0  0]
 [ 0 38  0  1  0  1  2  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 1  0 25  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 3  0  0  0 13  0  1  0  0  0  0  1  2  2  1  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  1  0  0  0  0  0]
 [ 2  1  0  0  2  0  2  0  1  0  0  1  1  0  0  2  0  0  0  0]
 [ 3  0  0  0  0  0  0  5  0  1  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  3  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  1  2  1  0  0  0  0  3  0  2  0  0]
 [ 0  0  0  0  0  0  1  1  0  3 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 16  1  0  0  0  0  0  1  1]
 [ 3  0  1  1  1  0  1  1  0  0  1  0 42  0  3  2  1  0  0  0]
 [ 1  1  0  0  0  0  3  0  0  0  0  1  2 14  3  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  1  2 16  0  1  0  0  1]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  3  0  1 15  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  4  0  2  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  1  0  1  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0 10  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  2  1  2  0  0  0  0  4]]
2024-01-04 11:43:50,577 - ***** Evaluation results *****
2024-01-04 11:43:50,577 -   acc = 0.6787
2024-01-04 11:43:50,577 -   f1 = 0.6419
2024-01-04 11:43:50,577 -   prec = 0.6526
2024-01-04 11:43:50,577 -   rec = 0.6404
2024-01-04 11:43:50,577 - Testing is finished...
2024-01-04 11:43:50,577 - Multimodal intent recognition is finished...
2024-01-04 11:43:50,577 - Results are saved in results/msz.csv
