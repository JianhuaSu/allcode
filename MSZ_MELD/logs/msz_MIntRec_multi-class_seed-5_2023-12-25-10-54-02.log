2023-12-25 10:54:02,846 - ============================== Params ==============================
2023-12-25 10:54:02,846 - logger_name: msz_MIntRec_multi-class_seed-5_2023-12-25-10-54-02
2023-12-25 10:54:02,846 - dataset: MIntRec
2023-12-25 10:54:02,846 - data_mode: multi-class
2023-12-25 10:54:02,846 - method: msz
2023-12-25 10:54:02,846 - text_backbone: bert-base-uncased
2023-12-25 10:54:02,846 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2023-12-25 10:54:02,846 - seed: 5
2023-12-25 10:54:02,846 - num_workers: 8
2023-12-25 10:54:02,846 - gpu_id: 0
2023-12-25 10:54:02,846 - data_path: /home/sharing/disk2/sjh/intentDataset
2023-12-25 10:54:02,846 - train: True
2023-12-25 10:54:02,846 - tune: False
2023-12-25 10:54:02,846 - save_model: False
2023-12-25 10:54:02,846 - save_results: True
2023-12-25 10:54:02,846 - log_path: logs
2023-12-25 10:54:02,846 - cache_path: 
2023-12-25 10:54:02,846 - video_data_path: video_data
2023-12-25 10:54:02,846 - audio_data_path: audio_data
2023-12-25 10:54:02,846 - video_feats_path: video_feats.pkl
2023-12-25 10:54:02,846 - audio_feats_path: audio_feats.pkl
2023-12-25 10:54:02,846 - results_path: results
2023-12-25 10:54:02,846 - output_path: /home/sujianhua/Outputs/MIntRec
2023-12-25 10:54:02,846 - model_path: models
2023-12-25 10:54:02,847 - config_file_name: msz
2023-12-25 10:54:02,847 - results_file_name: msz.csv
2023-12-25 10:54:02,847 - padding_mode: zero
2023-12-25 10:54:02,847 - padding_loc: end
2023-12-25 10:54:02,847 - need_aligned: False
2023-12-25 10:54:02,847 - eval_monitor: f1
2023-12-25 10:54:02,847 - train_batch_size: 16
2023-12-25 10:54:02,847 - eval_batch_size: 8
2023-12-25 10:54:02,847 - test_batch_size: 8
2023-12-25 10:54:02,847 - wait_patience: 8
2023-12-25 10:54:02,847 - nheads: 2
2023-12-25 10:54:02,847 - encoder_layers: 2
2023-12-25 10:54:02,847 - attn_dropout: 0.1
2023-12-25 10:54:02,847 - relu_dropout: 0.1
2023-12-25 10:54:02,847 - embed_dropout: 0.1
2023-12-25 10:54:02,847 - res_dropout: 0.1
2023-12-25 10:54:02,847 - attn_mask: False
2023-12-25 10:54:02,847 - hidden_size: 768
2023-12-25 10:54:02,847 - num_attention_heads: 12
2023-12-25 10:54:02,847 - attention_probs_dropout_prob: 0.2
2023-12-25 10:54:02,847 - hidden_dropout_prob: 0.2
2023-12-25 10:54:02,847 - intermediate_size: 768
2023-12-25 10:54:02,847 - num_hidden_layers: 3
2023-12-25 10:54:02,847 - max_position_embeddings: 512
2023-12-25 10:54:02,847 - position_embedding_type: absolute
2023-12-25 10:54:02,847 - add_cross_attention: False
2023-12-25 10:54:02,847 - batch_first: True
2023-12-25 10:54:02,847 - hidden_dims: 768
2023-12-25 10:54:02,847 - att_dropouts: [0.1, 0.1, 0.1]
2023-12-25 10:54:02,847 - spe_dropouts: [0.1, 0.1, 0.1]
2023-12-25 10:54:02,847 - sl: 0.1
2023-12-25 10:54:02,847 - cl: 0.1
2023-12-25 10:54:02,847 - num_train_epochs: 100
2023-12-25 10:54:02,848 - warmup_proportion: 0.1
2023-12-25 10:54:02,848 - lr: 5e-06
2023-12-25 10:54:02,848 - weight_decay: 0.01
2023-12-25 10:54:02,848 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-5_2023-12-25-10-54-02
2023-12-25 10:54:02,848 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-5_2023-12-25-10-54-02/models
2023-12-25 10:54:02,848 - ============================== End Params ==============================
2023-12-25 10:54:02,958 - Generate Text Features Begin...
2023-12-25 10:54:03,906 - Generate Text Features Finished...
2023-12-25 10:54:03,910 - Load Video Features Begin...
2023-12-25 10:54:24,325 - Load Video Features Finished...
2023-12-25 10:54:25,252 - Load Audio Features Begin...
2023-12-25 10:55:14,495 - Load Audio Features Finished...
2023-12-25 10:55:24,419 - method  begins...
2023-12-25 10:55:36,465 - Multimodal intent recognition begins...
2023-12-25 10:55:36,465 - Training begins...
2023-12-25 10:56:07,001 - ***** Epoch: 1: Eval results *****
2023-12-25 10:56:07,034 -   train_loss = 2.9332
2023-12-25 10:56:07,034 -   best_eval_score = 0.0
2023-12-25 10:56:07,034 -   eval_score = 0.0131
2023-12-25 10:56:32,419 - ***** Epoch: 2: Eval results *****
2023-12-25 10:56:32,420 -   train_loss = 2.7872
2023-12-25 10:56:32,420 -   best_eval_score = 0.0131
2023-12-25 10:56:32,420 -   eval_score = 0.0381
2023-12-25 10:56:57,258 - ***** Epoch: 3: Eval results *****
2023-12-25 10:56:57,259 -   train_loss = 2.5692
2023-12-25 10:56:57,259 -   best_eval_score = 0.0381
2023-12-25 10:56:57,259 -   eval_score = 0.1772
2023-12-25 10:57:24,514 - ***** Epoch: 4: Eval results *****
2023-12-25 10:57:24,515 -   train_loss = 2.2152
2023-12-25 10:57:24,516 -   best_eval_score = 0.1772
2023-12-25 10:57:24,517 -   eval_score = 0.2417
2023-12-25 10:57:53,143 - ***** Epoch: 5: Eval results *****
2023-12-25 10:57:53,143 -   train_loss = 1.9033
2023-12-25 10:57:53,144 -   best_eval_score = 0.2417
2023-12-25 10:57:53,144 -   eval_score = 0.3034
2023-12-25 10:58:18,766 - ***** Epoch: 6: Eval results *****
2023-12-25 10:58:18,768 -   train_loss = 1.6816
2023-12-25 10:58:18,769 -   best_eval_score = 0.3034
2023-12-25 10:58:18,769 -   eval_score = 0.4128
2023-12-25 10:58:41,152 - ***** Epoch: 7: Eval results *****
2023-12-25 10:58:41,153 -   train_loss = 1.3918
2023-12-25 10:58:41,153 -   best_eval_score = 0.4128
2023-12-25 10:58:41,154 -   eval_score = 0.3981
2023-12-25 10:58:41,154 - EarlyStopping counter: 1 out of 8
2023-12-25 10:59:04,677 - ***** Epoch: 8: Eval results *****
2023-12-25 10:59:04,684 -   train_loss = 1.2966
2023-12-25 10:59:04,685 -   best_eval_score = 0.4128
2023-12-25 10:59:04,685 -   eval_score = 0.4335
2023-12-25 10:59:26,635 - ***** Epoch: 9: Eval results *****
2023-12-25 10:59:26,636 -   train_loss = 0.9246
2023-12-25 10:59:26,636 -   best_eval_score = 0.4335
2023-12-25 10:59:26,636 -   eval_score = 0.5253
2023-12-25 10:59:48,645 - ***** Epoch: 10: Eval results *****
2023-12-25 10:59:48,646 -   train_loss = 0.9318
2023-12-25 10:59:48,657 -   best_eval_score = 0.5253
2023-12-25 10:59:48,657 -   eval_score = 0.5089
2023-12-25 10:59:48,658 - EarlyStopping counter: 1 out of 8
2023-12-25 11:00:10,391 - ***** Epoch: 11: Eval results *****
2023-12-25 11:00:10,392 -   train_loss = 1.1321
2023-12-25 11:00:10,392 -   best_eval_score = 0.5253
2023-12-25 11:00:10,392 -   eval_score = 0.4854
2023-12-25 11:00:10,392 - EarlyStopping counter: 2 out of 8
2023-12-25 11:00:31,637 - ***** Epoch: 12: Eval results *****
2023-12-25 11:00:31,637 -   train_loss = 1.5392
2023-12-25 11:00:31,637 -   best_eval_score = 0.5253
2023-12-25 11:00:31,637 -   eval_score = 0.3849
2023-12-25 11:00:31,637 - EarlyStopping counter: 3 out of 8
2023-12-25 11:00:50,563 - ***** Epoch: 13: Eval results *****
2023-12-25 11:00:50,564 -   train_loss = 1.5472
2023-12-25 11:00:50,564 -   best_eval_score = 0.5253
2023-12-25 11:00:50,564 -   eval_score = 0.4549
2023-12-25 11:00:50,564 - EarlyStopping counter: 4 out of 8
2023-12-25 11:01:10,415 - ***** Epoch: 14: Eval results *****
2023-12-25 11:01:10,416 -   train_loss = 1.3664
2023-12-25 11:01:10,416 -   best_eval_score = 0.5253
2023-12-25 11:01:10,416 -   eval_score = 0.4127
2023-12-25 11:01:10,416 - EarlyStopping counter: 5 out of 8
2023-12-25 11:01:29,384 - ***** Epoch: 15: Eval results *****
2023-12-25 11:01:29,385 -   train_loss = 1.3613
2023-12-25 11:01:29,386 -   best_eval_score = 0.5253
2023-12-25 11:01:29,387 -   eval_score = 0.4139
2023-12-25 11:01:29,387 - EarlyStopping counter: 6 out of 8
2023-12-25 11:01:48,353 - ***** Epoch: 16: Eval results *****
2023-12-25 11:01:48,354 -   train_loss = 1.3938
2023-12-25 11:01:48,354 -   best_eval_score = 0.5253
2023-12-25 11:01:48,354 -   eval_score = 0.4153
2023-12-25 11:01:48,354 - EarlyStopping counter: 7 out of 8
2023-12-25 11:02:08,451 - ***** Epoch: 17: Eval results *****
2023-12-25 11:02:08,451 -   train_loss = 1.4446
2023-12-25 11:02:08,451 -   best_eval_score = 0.5253
2023-12-25 11:02:08,451 -   eval_score = 0.412
2023-12-25 11:02:08,451 - EarlyStopping counter: 8 out of 8
2023-12-25 11:02:08,451 - EarlyStopping at epoch 17
2023-12-25 11:02:08,453 - Training is finished...
2023-12-25 11:02:08,453 - Testing begins...
2023-12-25 11:02:11,704 - ***** Test: Confusion Matrix *****
2023-12-25 11:02:11,707 - [[24  0  0  0 17  0  0  0  0  6  0  1  7  2  0  0  0  0  0  0]
 [ 1 38  0  0  0  0  0  0  0  0  1  0  2  0  1  0  0  0  0  0]
 [ 0  0 26  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0 18  0  0  0  0  2  0  0  0  2  0  0  0  0  0  0]
 [ 1  0  0  0  1  7  0  0  0  1  1  0  0  0  0  0  0  1  0  0]
 [ 1  0  0  0  5  0  1  0  0  2  2  1  0  0  0  0  0  0  0  0]
 [ 1  3  0  0  2  0  0  0  0  2  0  0  1  0  1  0  0  0  0  0]
 [ 1  2  0  0  1  0  0  0  0  0  0  0  2  2  0  1  1  0  0  0]
 [ 1  1  0  0  1  0  0  0  0  3  0  0  1  0  0  0  0  3  0  0]
 [ 1  0  0  0  0  0  0  0  0  3  9  0  0  0  2  0  0  3  0  0]
 [ 0  0  0  0  3  0  0  0  0  0  0 14  1  0  0  0  0  0  1  0]
 [ 1  3  0  1  8  0  0  0  0  1  1  0 26  1 13  0  0  2  0  0]
 [ 1  1  0  0  1  0  1  0  0  0  1  1  0 13  5  0  1  0  0  0]
 [ 0  0  0  0  2  0  0  0  0  0  0  0  0  2 15  0  2  0  0  1]
 [ 0  2  0  1  4  0  0  0  0  0  0  0  7  0  3  4  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  4  2  1  0 10  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  3  0  0  0  1  0  0 10  0  0]
 [ 0  0  0  0  1  0  0  0  0  0  0  0  2  0  1  1  0  0  7  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  2  1  2  0  0  0  0  4]]
2023-12-25 11:02:11,709 - ***** Evaluation results *****
2023-12-25 11:02:11,711 -   acc = 0.5708
2023-12-25 11:02:11,711 -   f1 = 0.5111
2023-12-25 11:02:11,712 -   prec = 0.5749
2023-12-25 11:02:11,712 -   rec = 0.517
2023-12-25 11:02:11,713 - Testing is finished...
2023-12-25 11:02:11,714 - Multimodal intent recognition is finished...
2023-12-25 11:02:11,714 - Results are saved in results/msz.csv
