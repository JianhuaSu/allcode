2024-01-05 07:06:25,013 - ============================== Params ==============================
2024-01-05 07:06:25,013 - logger_name: msz_MIntRec_multi-class_seed-1_2024-01-05-07-06-25
2024-01-05 07:06:25,013 - dataset: MIntRec
2024-01-05 07:06:25,013 - data_mode: multi-class
2024-01-05 07:06:25,013 - method: msz
2024-01-05 07:06:25,013 - text_backbone: bert-base-uncased
2024-01-05 07:06:25,013 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-05 07:06:25,013 - seed: 1
2024-01-05 07:06:25,013 - num_workers: 8
2024-01-05 07:06:25,013 - gpu_id: 1
2024-01-05 07:06:25,013 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-05 07:06:25,013 - train: True
2024-01-05 07:06:25,013 - tune: False
2024-01-05 07:06:25,013 - save_model: False
2024-01-05 07:06:25,013 - save_results: True
2024-01-05 07:06:25,013 - log_path: logs
2024-01-05 07:06:25,013 - cache_path: 
2024-01-05 07:06:25,013 - video_data_path: video_data
2024-01-05 07:06:25,013 - audio_data_path: audio_data
2024-01-05 07:06:25,013 - video_feats_path: video_feats.pkl
2024-01-05 07:06:25,013 - audio_feats_path: audio_feats.pkl
2024-01-05 07:06:25,013 - results_path: results
2024-01-05 07:06:25,013 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-05 07:06:25,013 - model_path: models
2024-01-05 07:06:25,013 - config_file_name: msz
2024-01-05 07:06:25,013 - results_file_name: msz.csv
2024-01-05 07:06:25,013 - padding_mode: zero
2024-01-05 07:06:25,013 - padding_loc: end
2024-01-05 07:06:25,013 - need_aligned: False
2024-01-05 07:06:25,014 - eval_monitor: f1
2024-01-05 07:06:25,014 - train_batch_size: 16
2024-01-05 07:06:25,014 - eval_batch_size: 8
2024-01-05 07:06:25,014 - test_batch_size: 8
2024-01-05 07:06:25,014 - wait_patience: 8
2024-01-05 07:06:25,014 - nheads: 2
2024-01-05 07:06:25,014 - encoder_layers: 2
2024-01-05 07:06:25,014 - attn_dropout: 0.1
2024-01-05 07:06:25,014 - relu_dropout: 0.1
2024-01-05 07:06:25,014 - embed_dropout: 0.1
2024-01-05 07:06:25,014 - res_dropout: 0.1
2024-01-05 07:06:25,014 - attn_mask: False
2024-01-05 07:06:25,014 - hidden_size: 768
2024-01-05 07:06:25,014 - num_attention_heads: 12
2024-01-05 07:06:25,014 - attention_probs_dropout_prob: 0.2
2024-01-05 07:06:25,014 - hidden_dropout_prob: 0.2
2024-01-05 07:06:25,014 - intermediate_size: 768
2024-01-05 07:06:25,014 - num_hidden_layers: 3
2024-01-05 07:06:25,014 - max_position_embeddings: 512
2024-01-05 07:06:25,014 - position_embedding_type: absolute
2024-01-05 07:06:25,014 - batch_first: True
2024-01-05 07:06:25,014 - hidden_dims: 768
2024-01-05 07:06:25,014 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-05 07:06:25,014 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-05 07:06:25,014 - ta_loss: 0.1
2024-01-05 07:06:25,014 - tv_loss: 0.1
2024-01-05 07:06:25,014 - av_loss: 0.1
2024-01-05 07:06:25,014 - aligned_method: conv1d
2024-01-05 07:06:25,014 - grad_clip: -1
2024-01-05 07:06:25,014 - num_train_epochs: 100
2024-01-05 07:06:25,014 - warmup_proportion: 0.1
2024-01-05 07:06:25,014 - lr: 1e-06
2024-01-05 07:06:25,014 - weight_decay: 0.01
2024-01-05 07:06:25,014 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-05-07-06-25
2024-01-05 07:06:25,014 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-05-07-06-25/models
2024-01-05 07:06:25,014 - ============================== End Params ==============================
2024-01-05 07:06:25,017 - Generate Text Features Begin...
2024-01-05 07:06:25,540 - Generate Text Features Finished...
2024-01-05 07:06:25,541 - Load Video Features Begin...
2024-01-05 07:06:25,910 - Load Video Features Finished...
2024-01-05 07:06:26,642 - Load Audio Features Begin...
2024-01-05 07:06:28,012 - Load Audio Features Finished...
2024-01-05 07:06:32,374 - method  begins...
2024-01-05 07:06:36,984 - Multimodal intent recognition begins...
2024-01-05 07:06:36,984 - Training begins...
2024-01-05 07:07:04,355 - ***** Epoch: 1: Eval results *****
2024-01-05 07:07:04,355 -   train_loss = 2.9871
2024-01-05 07:07:04,355 -   best_eval_score = 0.0
2024-01-05 07:07:04,355 -   eval_score = 0.0231
2024-01-05 07:07:28,593 - ***** Epoch: 2: Eval results *****
2024-01-05 07:07:28,593 -   train_loss = 2.9538
2024-01-05 07:07:28,593 -   best_eval_score = 0.0231
2024-01-05 07:07:28,593 -   eval_score = 0.0435
2024-01-05 07:07:53,738 - ***** Epoch: 3: Eval results *****
2024-01-05 07:07:53,738 -   train_loss = 2.897
2024-01-05 07:07:53,738 -   best_eval_score = 0.0435
2024-01-05 07:07:53,738 -   eval_score = 0.0227
2024-01-05 07:07:53,738 - EarlyStopping counter: 1 out of 8
2024-01-05 07:08:18,301 - ***** Epoch: 4: Eval results *****
2024-01-05 07:08:18,303 -   train_loss = 2.8012
2024-01-05 07:08:18,303 -   best_eval_score = 0.0435
2024-01-05 07:08:18,303 -   eval_score = 0.107
2024-01-05 07:08:42,635 - ***** Epoch: 5: Eval results *****
2024-01-05 07:08:42,635 -   train_loss = 2.6602
2024-01-05 07:08:42,635 -   best_eval_score = 0.107
2024-01-05 07:08:42,635 -   eval_score = 0.1635
2024-01-05 07:09:06,801 - ***** Epoch: 6: Eval results *****
2024-01-05 07:09:06,801 -   train_loss = 2.4468
2024-01-05 07:09:06,801 -   best_eval_score = 0.1635
2024-01-05 07:09:06,801 -   eval_score = 0.1742
2024-01-05 07:09:31,395 - ***** Epoch: 7: Eval results *****
2024-01-05 07:09:31,395 -   train_loss = 2.1372
2024-01-05 07:09:31,395 -   best_eval_score = 0.1742
2024-01-05 07:09:31,395 -   eval_score = 0.2235
2024-01-05 07:09:56,840 - ***** Epoch: 8: Eval results *****
2024-01-05 07:09:56,840 -   train_loss = 1.7767
2024-01-05 07:09:56,840 -   best_eval_score = 0.2235
2024-01-05 07:09:56,840 -   eval_score = 0.2725
2024-01-05 07:10:21,413 - ***** Epoch: 9: Eval results *****
2024-01-05 07:10:21,414 -   train_loss = 1.4561
2024-01-05 07:10:21,414 -   best_eval_score = 0.2725
2024-01-05 07:10:21,414 -   eval_score = 0.5173
2024-01-05 07:10:46,067 - ***** Epoch: 10: Eval results *****
2024-01-05 07:10:46,067 -   train_loss = 1.1642
2024-01-05 07:10:46,067 -   best_eval_score = 0.5173
2024-01-05 07:10:46,067 -   eval_score = 0.4949
2024-01-05 07:10:46,067 - EarlyStopping counter: 1 out of 8
2024-01-05 07:11:10,885 - ***** Epoch: 11: Eval results *****
2024-01-05 07:11:10,886 -   train_loss = 0.9931
2024-01-05 07:11:10,886 -   best_eval_score = 0.5173
2024-01-05 07:11:10,886 -   eval_score = 0.5438
2024-01-05 07:11:35,914 - ***** Epoch: 12: Eval results *****
2024-01-05 07:11:35,915 -   train_loss = 0.6824
2024-01-05 07:11:35,915 -   best_eval_score = 0.5438
2024-01-05 07:11:35,915 -   eval_score = 0.5509
2024-01-05 07:12:00,728 - ***** Epoch: 13: Eval results *****
2024-01-05 07:12:00,728 -   train_loss = 0.5217
2024-01-05 07:12:00,728 -   best_eval_score = 0.5509
2024-01-05 07:12:00,728 -   eval_score = 0.5906
2024-01-05 07:12:26,402 - ***** Epoch: 14: Eval results *****
2024-01-05 07:12:26,402 -   train_loss = 0.3906
2024-01-05 07:12:26,402 -   best_eval_score = 0.5906
2024-01-05 07:12:26,402 -   eval_score = 0.6046
2024-01-05 07:12:51,428 - ***** Epoch: 15: Eval results *****
2024-01-05 07:12:51,428 -   train_loss = 0.2845
2024-01-05 07:12:51,428 -   best_eval_score = 0.6046
2024-01-05 07:12:51,428 -   eval_score = 0.6152
2024-01-05 07:13:15,813 - ***** Epoch: 16: Eval results *****
2024-01-05 07:13:15,813 -   train_loss = 0.2097
2024-01-05 07:13:15,813 -   best_eval_score = 0.6152
2024-01-05 07:13:15,813 -   eval_score = 0.6289
2024-01-05 07:13:41,404 - ***** Epoch: 17: Eval results *****
2024-01-05 07:13:41,404 -   train_loss = 0.1318
2024-01-05 07:13:41,404 -   best_eval_score = 0.6289
2024-01-05 07:13:41,404 -   eval_score = 0.6235
2024-01-05 07:13:41,404 - EarlyStopping counter: 1 out of 8
2024-01-05 07:14:06,878 - ***** Epoch: 18: Eval results *****
2024-01-05 07:14:06,879 -   train_loss = 0.0976
2024-01-05 07:14:06,879 -   best_eval_score = 0.6289
2024-01-05 07:14:06,879 -   eval_score = 0.6407
2024-01-05 07:14:31,928 - ***** Epoch: 19: Eval results *****
2024-01-05 07:14:31,928 -   train_loss = 0.0654
2024-01-05 07:14:31,928 -   best_eval_score = 0.6407
2024-01-05 07:14:31,928 -   eval_score = 0.617
2024-01-05 07:14:31,928 - EarlyStopping counter: 1 out of 8
2024-01-05 07:14:56,626 - ***** Epoch: 20: Eval results *****
2024-01-05 07:14:56,626 -   train_loss = 0.0579
2024-01-05 07:14:56,626 -   best_eval_score = 0.6407
2024-01-05 07:14:56,626 -   eval_score = 0.6343
2024-01-05 07:14:56,626 - EarlyStopping counter: 2 out of 8
2024-01-05 07:15:21,454 - ***** Epoch: 21: Eval results *****
2024-01-05 07:15:21,454 -   train_loss = 0.0348
2024-01-05 07:15:21,454 -   best_eval_score = 0.6407
2024-01-05 07:15:21,454 -   eval_score = 0.6374
2024-01-05 07:15:21,454 - EarlyStopping counter: 3 out of 8
2024-01-05 07:15:46,442 - ***** Epoch: 22: Eval results *****
2024-01-05 07:15:46,443 -   train_loss = 0.0298
2024-01-05 07:15:46,443 -   best_eval_score = 0.6407
2024-01-05 07:15:46,443 -   eval_score = 0.6448
2024-01-05 07:16:11,493 - ***** Epoch: 23: Eval results *****
2024-01-05 07:16:11,493 -   train_loss = 0.0252
2024-01-05 07:16:11,493 -   best_eval_score = 0.6448
2024-01-05 07:16:11,493 -   eval_score = 0.6319
2024-01-05 07:16:11,493 - EarlyStopping counter: 1 out of 8
2024-01-05 07:16:36,185 - ***** Epoch: 24: Eval results *****
2024-01-05 07:16:36,185 -   train_loss = 0.0213
2024-01-05 07:16:36,185 -   best_eval_score = 0.6448
2024-01-05 07:16:36,186 -   eval_score = 0.641
2024-01-05 07:16:36,186 - EarlyStopping counter: 2 out of 8
2024-01-05 07:17:01,166 - ***** Epoch: 25: Eval results *****
2024-01-05 07:17:01,166 -   train_loss = 0.0122
2024-01-05 07:17:01,166 -   best_eval_score = 0.6448
2024-01-05 07:17:01,166 -   eval_score = 0.6426
2024-01-05 07:17:01,166 - EarlyStopping counter: 3 out of 8
2024-01-05 07:17:25,901 - ***** Epoch: 26: Eval results *****
2024-01-05 07:17:25,902 -   train_loss = 0.0091
2024-01-05 07:17:25,902 -   best_eval_score = 0.6448
2024-01-05 07:17:25,902 -   eval_score = 0.6448
2024-01-05 07:17:50,544 - ***** Epoch: 27: Eval results *****
2024-01-05 07:17:50,544 -   train_loss = 0.0083
2024-01-05 07:17:50,544 -   best_eval_score = 0.6448
2024-01-05 07:17:50,545 -   eval_score = 0.645
2024-01-05 07:18:15,261 - ***** Epoch: 28: Eval results *****
2024-01-05 07:18:15,262 -   train_loss = 0.0078
2024-01-05 07:18:15,262 -   best_eval_score = 0.645
2024-01-05 07:18:15,262 -   eval_score = 0.6484
2024-01-05 07:18:40,784 - ***** Epoch: 29: Eval results *****
2024-01-05 07:18:40,785 -   train_loss = 0.007
2024-01-05 07:18:40,785 -   best_eval_score = 0.6484
2024-01-05 07:18:40,785 -   eval_score = 0.6533
2024-01-05 07:19:05,854 - ***** Epoch: 30: Eval results *****
2024-01-05 07:19:05,855 -   train_loss = 0.0046
2024-01-05 07:19:05,855 -   best_eval_score = 0.6533
2024-01-05 07:19:05,855 -   eval_score = 0.6503
2024-01-05 07:19:05,855 - EarlyStopping counter: 1 out of 8
2024-01-05 07:19:30,923 - ***** Epoch: 31: Eval results *****
2024-01-05 07:19:30,924 -   train_loss = 0.0079
2024-01-05 07:19:30,924 -   best_eval_score = 0.6533
2024-01-05 07:19:30,924 -   eval_score = 0.6417
2024-01-05 07:19:30,924 - EarlyStopping counter: 2 out of 8
2024-01-05 07:19:57,215 - ***** Epoch: 32: Eval results *****
2024-01-05 07:19:57,216 -   train_loss = 0.0111
2024-01-05 07:19:57,216 -   best_eval_score = 0.6533
2024-01-05 07:19:57,216 -   eval_score = 0.6482
2024-01-05 07:19:57,216 - EarlyStopping counter: 3 out of 8
2024-01-05 07:20:23,963 - ***** Epoch: 33: Eval results *****
2024-01-05 07:20:23,964 -   train_loss = 0.0042
2024-01-05 07:20:23,964 -   best_eval_score = 0.6533
2024-01-05 07:20:23,964 -   eval_score = 0.6423
2024-01-05 07:20:23,964 - EarlyStopping counter: 4 out of 8
2024-01-05 07:20:48,938 - ***** Epoch: 34: Eval results *****
2024-01-05 07:20:48,939 -   train_loss = 0.0148
2024-01-05 07:20:48,939 -   best_eval_score = 0.6533
2024-01-05 07:20:48,939 -   eval_score = 0.6189
2024-01-05 07:20:48,939 - EarlyStopping counter: 5 out of 8
2024-01-05 07:21:14,573 - ***** Epoch: 35: Eval results *****
2024-01-05 07:21:14,573 -   train_loss = 0.0091
2024-01-05 07:21:14,573 -   best_eval_score = 0.6533
2024-01-05 07:21:14,573 -   eval_score = 0.6178
2024-01-05 07:21:14,573 - EarlyStopping counter: 6 out of 8
2024-01-05 07:21:39,360 - ***** Epoch: 36: Eval results *****
2024-01-05 07:21:39,361 -   train_loss = 0.0047
2024-01-05 07:21:39,361 -   best_eval_score = 0.6533
2024-01-05 07:21:39,361 -   eval_score = 0.6524
2024-01-05 07:21:39,361 - EarlyStopping counter: 7 out of 8
2024-01-05 07:22:04,081 - ***** Epoch: 37: Eval results *****
2024-01-05 07:22:04,081 -   train_loss = 0.0049
2024-01-05 07:22:04,082 -   best_eval_score = 0.6533
2024-01-05 07:22:04,082 -   eval_score = 0.6425
2024-01-05 07:22:04,082 - EarlyStopping counter: 8 out of 8
2024-01-05 07:22:04,082 - EarlyStopping at epoch 37
2024-01-05 07:22:04,085 - Training is finished...
2024-01-05 07:22:04,085 - Testing begins...
2024-01-05 07:22:08,760 - ***** Test: Confusion Matrix *****
2024-01-05 07:22:08,762 - [[36  0  0  0  2  0  7  2  2  2  0  0  5  1  0  0  0  0  0  0]
 [ 0 38  0  1  0  0  1  1  0  0  0  0  2  0  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 3  0  0  0 12  0  6  0  0  0  0  0  0  1  1  0  0  0  0  0]
 [ 1  0  0  0  0 10  0  0  0  0  0  0  0  0  0  0  0  1  0  0]
 [ 1  0  0  0  0  0  6  0  2  0  0  0  2  0  0  0  0  0  0  1]
 [ 4  0  0  0  0  0  0  5  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  4  4  0  0  0  0  1  0  0  0  0  0  0]
 [ 3  0  0  0  0  0  1  0  0  1  1  0  0  0  0  3  0  1  0  0]
 [ 1  0  0  0  0  0  2  0  0  0 14  0  1  0  0  0  0  0  0  0]
 [ 0  1  0  0  1  0  0  0  1  0  0 14  1  0  0  0  0  0  0  1]
 [ 4  0  0  0  0  0  0  3  1  0  0  0 43  2  2  0  2  0  0  0]
 [ 2  1  0  0  0  0  2  0  0  0  1  1  1 15  2  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  3 16  0  0  0  0  2]
 [ 0  0  0  0  0  0  1  1  1  0  0  0  4  1  0 13  0  0  0  0]
 [ 0  0  0  0  0  0  0  2  0  0  0  0  3  0  1  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  1  0  0  0  0 12  0  0]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  1  1  0  0  0  0  7]]
2024-01-05 07:22:08,762 - ***** Evaluation results *****
2024-01-05 07:22:08,762 -   acc = 0.7101
2024-01-05 07:22:08,762 -   f1 = 0.6769
2024-01-05 07:22:08,762 -   prec = 0.7082
2024-01-05 07:22:08,762 -   rec = 0.6681
2024-01-05 07:22:08,762 - Testing is finished...
2024-01-05 07:22:08,762 - Multimodal intent recognition is finished...
2024-01-05 07:22:08,762 - Results are saved in results/msz.csv
