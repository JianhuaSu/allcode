2024-03-16 12:49:33,964 - ============================== Params ==============================
2024-03-16 12:49:33,964 - logger_name: mag_bert_MIntRec2_multi-class_seed-4_2024-03-16-12-49-33
2024-03-16 12:49:33,964 - dataset: MIntRec2
2024-03-16 12:49:33,964 - data_mode: multi-class
2024-03-16 12:49:33,964 - method: mag_bert
2024-03-16 12:49:33,964 - text_backbone: bert-base-uncased
2024-03-16 12:49:33,964 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-16 12:49:33,965 - seed: 4
2024-03-16 12:49:33,965 - num_workers: 8
2024-03-16 12:49:33,965 - gpu_id: 2
2024-03-16 12:49:33,965 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-16 12:49:33,965 - train: True
2024-03-16 12:49:33,965 - tune: True
2024-03-16 12:49:33,965 - save_model: False
2024-03-16 12:49:33,965 - save_results: True
2024-03-16 12:49:33,965 - log_path: logs
2024-03-16 12:49:33,965 - cache_path: 
2024-03-16 12:49:33,965 - video_data_path: video_data
2024-03-16 12:49:33,965 - audio_data_path: audio_data
2024-03-16 12:49:33,965 - video_feats_path: video_feats.pkl
2024-03-16 12:49:33,965 - audio_feats_path: audio_feats.pkl
2024-03-16 12:49:33,965 - results_path: results
2024-03-16 12:49:33,965 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-16 12:49:33,965 - model_path: models
2024-03-16 12:49:33,965 - config_file_name: mag_bert_MIntRec2
2024-03-16 12:49:33,965 - results_file_name: mag_bert.csv
2024-03-16 12:49:33,965 - padding_mode: zero
2024-03-16 12:49:33,965 - padding_loc: end
2024-03-16 12:49:33,965 - need_aligned: True
2024-03-16 12:49:33,965 - eval_monitor: f1
2024-03-16 12:49:33,965 - train_batch_size: 32
2024-03-16 12:49:33,965 - eval_batch_size: 16
2024-03-16 12:49:33,965 - test_batch_size: 16
2024-03-16 12:49:33,965 - wait_patience: 8
2024-03-16 12:49:33,965 - num_train_epochs: 100
2024-03-16 12:49:33,965 - beta_shift: 0.01
2024-03-16 12:49:33,965 - dropout_prob: 0.5
2024-03-16 12:49:33,965 - warmup_proportion: 0.1
2024-03-16 12:49:33,965 - lr: 9e-06
2024-03-16 12:49:33,965 - aligned_method: conv1d
2024-03-16 12:49:33,965 - weight_decay: 0.03
2024-03-16 12:49:33,965 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-16-12-49-33
2024-03-16 12:49:33,965 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-4_2024-03-16-12-49-33/models
2024-03-16 12:49:33,965 - num_labels: 30
2024-03-16 12:49:33,965 - text_feat_dim: 768
2024-03-16 12:49:33,965 - video_feat_dim: 256
2024-03-16 12:49:33,965 - audio_feat_dim: 768
2024-03-16 12:49:33,966 - text_seq_len: 50
2024-03-16 12:49:33,966 - video_seq_len: 180
2024-03-16 12:49:33,966 - audio_seq_len: 400
2024-03-16 12:49:33,966 - device: cuda:2
2024-03-16 12:49:33,966 - ============================== End Params ==============================
2024-03-16 12:49:33,981 - Generate Text Features Begin...
2024-03-16 12:49:35,906 - Generate Text Features Finished...
2024-03-16 12:49:35,907 - Load Video Features Begin...
2024-03-16 12:49:36,927 - Load Video Features Finished...
2024-03-16 12:49:38,473 - Load Audio Features Begin...
2024-03-16 12:49:42,245 - Load Audio Features Finished...
2024-03-16 12:49:52,105 - method  begins...
2024-03-16 12:49:53,039 - Multimodal intent recognition begins...
2024-03-16 12:49:53,040 - Training begins...
2024-03-16 12:50:26,456 - ***** Epoch: 1: Eval results *****
2024-03-16 12:50:26,457 -   train_loss = 3.404
2024-03-16 12:50:26,457 -   best_eval_score = 0.0
2024-03-16 12:50:26,457 -   eval_score = 0.0264
2024-03-16 12:51:02,043 - ***** Epoch: 2: Eval results *****
2024-03-16 12:51:02,043 -   train_loss = 3.2084
2024-03-16 12:51:02,043 -   best_eval_score = 0.0264
2024-03-16 12:51:02,043 -   eval_score = 0.0857
2024-03-16 12:51:34,579 - ***** Epoch: 3: Eval results *****
2024-03-16 12:51:34,579 -   train_loss = 2.8577
2024-03-16 12:51:34,580 -   best_eval_score = 0.0857
2024-03-16 12:51:34,580 -   eval_score = 0.1579
2024-03-16 12:52:10,428 - ***** Epoch: 4: Eval results *****
2024-03-16 12:52:10,429 -   train_loss = 2.4977
2024-03-16 12:52:10,429 -   best_eval_score = 0.1579
2024-03-16 12:52:10,429 -   eval_score = 0.2385
2024-03-16 12:52:43,866 - ***** Epoch: 5: Eval results *****
2024-03-16 12:52:43,866 -   train_loss = 2.1952
2024-03-16 12:52:43,866 -   best_eval_score = 0.2385
2024-03-16 12:52:43,866 -   eval_score = 0.3035
2024-03-16 12:53:18,598 - ***** Epoch: 6: Eval results *****
2024-03-16 12:53:18,599 -   train_loss = 1.9549
2024-03-16 12:53:18,599 -   best_eval_score = 0.3035
2024-03-16 12:53:18,599 -   eval_score = 0.3414
2024-03-16 12:53:53,878 - ***** Epoch: 7: Eval results *****
2024-03-16 12:53:53,878 -   train_loss = 1.7556
2024-03-16 12:53:53,879 -   best_eval_score = 0.3414
2024-03-16 12:53:53,879 -   eval_score = 0.3717
2024-03-16 12:54:27,183 - ***** Epoch: 8: Eval results *****
2024-03-16 12:54:27,184 -   train_loss = 1.6051
2024-03-16 12:54:27,184 -   best_eval_score = 0.3717
2024-03-16 12:54:27,184 -   eval_score = 0.3958
2024-03-16 12:55:02,889 - ***** Epoch: 9: Eval results *****
2024-03-16 12:55:02,890 -   train_loss = 1.4741
2024-03-16 12:55:02,891 -   best_eval_score = 0.3958
2024-03-16 12:55:02,891 -   eval_score = 0.4174
2024-03-16 12:55:36,103 - ***** Epoch: 10: Eval results *****
2024-03-16 12:55:36,104 -   train_loss = 1.3593
2024-03-16 12:55:36,104 -   best_eval_score = 0.4174
2024-03-16 12:55:36,104 -   eval_score = 0.4218
2024-03-16 12:56:12,390 - ***** Epoch: 11: Eval results *****
2024-03-16 12:56:12,390 -   train_loss = 1.2524
2024-03-16 12:56:12,390 -   best_eval_score = 0.4218
2024-03-16 12:56:12,390 -   eval_score = 0.4424
2024-03-16 12:56:46,659 - ***** Epoch: 12: Eval results *****
2024-03-16 12:56:46,660 -   train_loss = 1.1324
2024-03-16 12:56:46,660 -   best_eval_score = 0.4424
2024-03-16 12:56:46,660 -   eval_score = 0.4487
2024-03-16 12:57:20,077 - ***** Epoch: 13: Eval results *****
2024-03-16 12:57:20,078 -   train_loss = 1.0389
2024-03-16 12:57:20,079 -   best_eval_score = 0.4487
2024-03-16 12:57:20,079 -   eval_score = 0.4685
2024-03-16 12:57:55,965 - ***** Epoch: 14: Eval results *****
2024-03-16 12:57:55,965 -   train_loss = 0.9393
2024-03-16 12:57:55,965 -   best_eval_score = 0.4685
2024-03-16 12:57:55,965 -   eval_score = 0.4757
2024-03-16 12:58:29,043 - ***** Epoch: 15: Eval results *****
2024-03-16 12:58:29,044 -   train_loss = 0.8637
2024-03-16 12:58:29,044 -   best_eval_score = 0.4757
2024-03-16 12:58:29,044 -   eval_score = 0.4793
2024-03-16 12:59:03,614 - ***** Epoch: 16: Eval results *****
2024-03-16 12:59:03,616 -   train_loss = 0.7805
2024-03-16 12:59:03,616 -   best_eval_score = 0.4793
2024-03-16 12:59:03,616 -   eval_score = 0.4813
2024-03-16 12:59:38,222 - ***** Epoch: 17: Eval results *****
2024-03-16 12:59:38,222 -   train_loss = 0.7074
2024-03-16 12:59:38,222 -   best_eval_score = 0.4813
2024-03-16 12:59:38,222 -   eval_score = 0.4854
2024-03-16 13:00:11,513 - ***** Epoch: 18: Eval results *****
2024-03-16 13:00:11,513 -   train_loss = 0.6432
2024-03-16 13:00:11,513 -   best_eval_score = 0.4854
2024-03-16 13:00:11,513 -   eval_score = 0.4874
2024-03-16 13:00:47,258 - ***** Epoch: 19: Eval results *****
2024-03-16 13:00:47,259 -   train_loss = 0.5691
2024-03-16 13:00:47,260 -   best_eval_score = 0.4874
2024-03-16 13:00:47,260 -   eval_score = 0.4825
2024-03-16 13:00:47,260 - EarlyStopping counter: 1 out of 8
2024-03-16 13:01:20,340 - ***** Epoch: 20: Eval results *****
2024-03-16 13:01:20,340 -   train_loss = 0.5245
2024-03-16 13:01:20,340 -   best_eval_score = 0.4874
2024-03-16 13:01:20,340 -   eval_score = 0.4891
2024-03-16 13:01:55,648 - ***** Epoch: 21: Eval results *****
2024-03-16 13:01:55,648 -   train_loss = 0.4738
2024-03-16 13:01:55,648 -   best_eval_score = 0.4891
2024-03-16 13:01:55,648 -   eval_score = 0.514
2024-03-16 13:02:30,691 - ***** Epoch: 22: Eval results *****
2024-03-16 13:02:30,691 -   train_loss = 0.4246
2024-03-16 13:02:30,691 -   best_eval_score = 0.514
2024-03-16 13:02:30,691 -   eval_score = 0.4872
2024-03-16 13:02:30,691 - EarlyStopping counter: 1 out of 8
2024-03-16 13:03:03,163 - ***** Epoch: 23: Eval results *****
2024-03-16 13:03:03,163 -   train_loss = 0.3874
2024-03-16 13:03:03,164 -   best_eval_score = 0.514
2024-03-16 13:03:03,164 -   eval_score = 0.5093
2024-03-16 13:03:03,164 - EarlyStopping counter: 2 out of 8
2024-03-16 13:03:39,790 - ***** Epoch: 24: Eval results *****
2024-03-16 13:03:39,790 -   train_loss = 0.3559
2024-03-16 13:03:39,791 -   best_eval_score = 0.514
2024-03-16 13:03:39,791 -   eval_score = 0.4995
2024-03-16 13:03:39,791 - EarlyStopping counter: 3 out of 8
2024-03-16 13:04:13,608 - ***** Epoch: 25: Eval results *****
2024-03-16 13:04:13,608 -   train_loss = 0.3211
2024-03-16 13:04:13,608 -   best_eval_score = 0.514
2024-03-16 13:04:13,609 -   eval_score = 0.4949
2024-03-16 13:04:13,609 - EarlyStopping counter: 4 out of 8
2024-03-16 13:04:49,291 - ***** Epoch: 26: Eval results *****
2024-03-16 13:04:49,291 -   train_loss = 0.2839
2024-03-16 13:04:49,291 -   best_eval_score = 0.514
2024-03-16 13:04:49,291 -   eval_score = 0.4942
2024-03-16 13:04:49,292 - EarlyStopping counter: 5 out of 8
2024-03-16 13:05:25,013 - ***** Epoch: 27: Eval results *****
2024-03-16 13:05:25,013 -   train_loss = 0.2591
2024-03-16 13:05:25,013 -   best_eval_score = 0.514
2024-03-16 13:05:25,013 -   eval_score = 0.4866
2024-03-16 13:05:25,013 - EarlyStopping counter: 6 out of 8
2024-03-16 13:05:59,117 - ***** Epoch: 28: Eval results *****
2024-03-16 13:05:59,117 -   train_loss = 0.2405
2024-03-16 13:05:59,117 -   best_eval_score = 0.514
2024-03-16 13:05:59,117 -   eval_score = 0.4971
2024-03-16 13:05:59,117 - EarlyStopping counter: 7 out of 8
2024-03-16 13:06:34,495 - ***** Epoch: 29: Eval results *****
2024-03-16 13:06:34,495 -   train_loss = 0.2195
2024-03-16 13:06:34,495 -   best_eval_score = 0.514
2024-03-16 13:06:34,495 -   eval_score = 0.4994
2024-03-16 13:06:34,495 - EarlyStopping counter: 8 out of 8
2024-03-16 13:06:34,495 - EarlyStopping at epoch 29
2024-03-16 13:06:34,497 - Training is finished...
2024-03-16 13:06:34,497 - Testing begins...
2024-03-16 13:06:40,446 - ***** Test: Confusion Matrix *****
2024-03-16 13:06:40,450 - [[ 49   0  11   0   0   0   0   0   0   1   2   0   0   0   0   0   0   1
    0   0   0   0   1   1   2   0   0   0   0   0]
 [  0  49   0   0  13   3   5   0   2   0   1   0   2   0   3   0   0  10
    1   2   0   0   1   0   3   0   0   2   0   0]
 [  8   0  41   0   2   0   0   0   0   0   1   0   0   0   1   1   0   4
    0   0   0   2   0   1   3   0   0   0   0   0]
 [  0   0   0  62   0   0   0   1   0   0   0   0   0   0   2   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   2   0   0  30   1   0   0   1   0   0   0   0   0   0   0   0   8
    0   3   0   2   1   1   1   0   0   0   1   0]
 [  0   0   0   0   1  25   0   0   0   3   1   0   0   0   1   0   0   4
    0   0   0   0   0   1   0   1   0   0   0   0]
 [  0   1   0   0   0   2  27   8   0   1   4   0   5   0   0   0   0   0
    0   0   0   0   0   0   0   0   0   0   0   0]
 [  0   0   0   0   0   0   4  28   0   0   7   0   5   0   0   0   0   0
    0   0   0   0   0   0   0   1   0   2   0   0]
 [  2   1   1   3   1   0   0   0  24   1   0   2   0   0   2   0   0   5
    0   1   0   0   3   0   2   1   0   0   0   0]
 [  0   1   1   2   1   0   0   0   2  37   0  10   9   0  16   0   0   9
    2   0   0   3   3   2   2   1   0   5   0   1]
 [  0   0   0   0   0   3   0   2   2   1  56   0  21   0   2   0   0   2
    0   3   0   0   0   0   1   0   0   0   0   0]
 [  0   0   0   0   0   0   0   0   2   3   1  21   9   0   1   0   0   3
    0   0   0   0   3   0   1   0   0   2   0   1]
 [  0   0   0   0   0   1   2   6   1   4  36   2  78   0   0   0   3   0
    0   1   0   0   1   0   0   0   0   0   0   0]
 [  0   0   2   0   1   0   0   0   1   1   0   0   0   0   5   1   0   3
    3   0   0   0   0   0   0   0   0   0   0   0]
 [  0   2   2   1   0   2   0   0   5   8   2   0   1   0 107   2   0  36
    6   0   0   0  11   0   4   0   0   4   0   0]
 [  0   0   0   0   0   0   0   0   0   5   0   0   0   1   2   5   0   3
    3   0   0   1   1   0   0   0   0   0   1   0]
 [  0   0   0   0   1   0   0   1   0   0   3   0   1   0   0   1  56   0
    3   0   0   0   0   0   0   0   0   0   0   0]
 [  1   3   2   0   7   4   0   0   6   7   2   0   0   0  16   0   4 128
    9   1   0   3   7   9   1   0   1   2   2   2]
 [  0   1   0   0   0   0   1   0   0   3   1   0   0   0   8   2   1   7
   35   0   0   0   0   0   0   0   0   1   0   0]
 [  0   4   0   0   1   0   2   0   0   0   1   0   0   0   0   0   0   0
    0   8   0   1   0   0   0   0   0   0   0   0]
 [  0   1   2   0   1   0   0   0   0   1   0   1   1   0   6   0   0   4
    4   1   1   0   0   1   3   0   0   2   0   0]
 [  6   0   0   0   1   0   0   0   0   2   0   2   0   0   3   0   5   0
    0   0   0  25   0   6   1   1   0   0   0   1]
 [  0   0   0   1   0   0   0   0   1   3   0   5   0   0   7   1   0   7
    0   0   0   0  83   0   1   5   3   0   0   0]
 [  0   1   1   0   1   0   0   0   0   2   0   0   0   0   1   0   0   8
    1   0   0   4   0  19   0   0   0   0   0   0]
 [  2   0   2   0   0   0   0   0   2   1   1   2   0   0   1   0   0   3
    2   0   0   0   1   1  87   0   0   6   2   0]
 [  1   0   0   0   0   0   0   0   1   1   0   0   0   0   0   0   0   1
    0   0   0   0   2   0   1  23   0   0   0   1]
 [  0   0   0   1   0   0   0   0   0   1   0   0   0   0   2   0   0   2
    0   0   0   2   3   0   0   0   4   0   2   0]
 [  0   3   0   0   0   0   0   0   3   3   3   6   3   0   5   0   0   3
    4   0   0   0   2   0  11   2   0   8   1   1]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   1   0
    0   0   0   0   0   0   0   0   0   0  56   0]
 [  0   1   0   0   0   0   0   0   4   1   1   1   0   0   0   0   0   4
    1   0   0   0   0   0   1   2   0   0   0   3]]
2024-03-16 13:06:40,450 - ***** Evaluation results *****
2024-03-16 13:06:40,451 -   acc = 0.578
2024-03-16 13:06:40,451 -   f1 = 0.5175
2024-03-16 13:06:40,451 -   prec = 0.5535
2024-03-16 13:06:40,451 -   rec = 0.5234
2024-03-16 13:06:40,451 - Testing is finished...
2024-03-16 13:06:40,451 - Multimodal intent recognition is finished...
2024-03-16 13:06:40,451 - Results are saved in results/mag_bert.csv
