2024-07-16 11:41:12,703 - ============================== Params ==============================
2024-07-16 11:41:12,703 - logger_name: misa_MELD-DA_multi-class_seed-3
2024-07-16 11:41:12,703 - dataset: MELD-DA
2024-07-16 11:41:12,703 - data_mode: multi-class
2024-07-16 11:41:12,703 - method: misa
2024-07-16 11:41:12,703 - text_backbone: bert-base-uncased
2024-07-16 11:41:12,703 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-07-16 11:41:12,703 - seed: 3
2024-07-16 11:41:12,703 - num_workers: 8
2024-07-16 11:41:12,703 - gpu_id: 1
2024-07-16 11:41:12,703 - data_path: /home/sharing/disk1/zhanghanlei/Datasets/public
2024-07-16 11:41:12,703 - train: True
2024-07-16 11:41:12,703 - tune: True
2024-07-16 11:41:12,703 - save_model: False
2024-07-16 11:41:12,703 - save_results: True
2024-07-16 11:41:12,703 - log_path: logs
2024-07-16 11:41:12,703 - cache_path: 
2024-07-16 11:41:12,703 - video_data_path: video_data
2024-07-16 11:41:12,703 - audio_data_path: audio_data
2024-07-16 11:41:12,703 - video_feats_path: video_feats.pkl
2024-07-16 11:41:12,703 - audio_feats_path: audio_feats.pkl
2024-07-16 11:41:12,703 - results_path: results
2024-07-16 11:41:12,703 - output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ/outputs/MELD-DA
2024-07-16 11:41:12,703 - model_path: models
2024-07-16 11:41:12,703 - config_file_name: misa_bert_MELD-DA
2024-07-16 11:41:12,704 - results_file_name: misa_bert_MELD-DA.csv
2024-07-16 11:41:12,704 - ablation: none
2024-07-16 11:41:12,704 - padding_mode: zero
2024-07-16 11:41:12,704 - padding_loc: end
2024-07-16 11:41:12,704 - need_aligned: False
2024-07-16 11:41:12,704 - eval_monitor: f1
2024-07-16 11:41:12,704 - train_batch_size: 16
2024-07-16 11:41:12,704 - eval_batch_size: 8
2024-07-16 11:41:12,704 - test_batch_size: 8
2024-07-16 11:41:12,704 - wait_patience: 8
2024-07-16 11:41:12,704 - num_train_epochs: 100
2024-07-16 11:41:12,704 - rnncell: lstm
2024-07-16 11:41:12,704 - use_cmd_sim: False
2024-07-16 11:41:12,704 - reverse_grad_weight: 0.8
2024-07-16 11:41:12,704 - hidden_size: 256
2024-07-16 11:41:12,704 - dropout_rate: 0.2
2024-07-16 11:41:12,704 - diff_weight: 0.7
2024-07-16 11:41:12,704 - sim_weight: 0.5
2024-07-16 11:41:12,704 - recon_weight: 0.6
2024-07-16 11:41:12,704 - lr: 3e-05
2024-07-16 11:41:12,704 - grad_clip: -1.0
2024-07-16 11:41:12,704 - gamma: 0.5
2024-07-16 11:41:12,704 - pred_output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ/outputs/MELD-DA/misa_MELD-DA_multi-class_seed-3
2024-07-16 11:41:12,704 - model_output_path: /home/sharing/disk3/wangyifan/sujianhua/MSZ/outputs/MELD-DA/misa_MELD-DA_multi-class_seed-3/models
2024-07-16 11:41:12,704 - ============================== End Params ==============================
2024-07-16 11:41:12,716 - Generate Text Features Begin...
2024-07-16 11:41:14,312 - Generate Text Features Finished...
2024-07-16 11:41:14,314 - Load Video Features Begin...
2024-07-16 11:41:15,559 - Load Video Features Finished...
2024-07-16 11:41:18,310 - Load Audio Features Begin...
2024-07-16 11:41:23,260 - Load Audio Features Finished...
2024-07-16 11:41:42,267 - method  begins...
2024-07-16 11:41:46,215 - Multimodal intent recognition begins...
2024-07-16 11:41:46,215 - Training begins...
2024-07-16 11:42:45,152 - ***** Epoch: 1: Eval results *****
2024-07-16 11:42:45,152 -   best_eval_score = 0.0
2024-07-16 11:42:45,152 -   eval_score = 0.3759
2024-07-16 11:42:45,152 -   train_loss = 2.1518
2024-07-16 11:43:44,534 - ***** Epoch: 2: Eval results *****
2024-07-16 11:43:44,534 -   best_eval_score = 0.3759
2024-07-16 11:43:44,535 -   eval_score = 0.4409
2024-07-16 11:43:44,535 -   train_loss = 1.6709
2024-07-16 11:44:42,659 - ***** Epoch: 3: Eval results *****
2024-07-16 11:44:42,659 -   best_eval_score = 0.4409
2024-07-16 11:44:42,659 -   eval_score = 0.4548
2024-07-16 11:44:42,659 -   train_loss = 1.4212
2024-07-16 11:45:41,455 - ***** Epoch: 4: Eval results *****
2024-07-16 11:45:41,455 -   best_eval_score = 0.4548
2024-07-16 11:45:41,455 -   eval_score = 0.4563
2024-07-16 11:45:41,455 -   train_loss = 1.1448
2024-07-16 11:46:39,443 - ***** Epoch: 5: Eval results *****
2024-07-16 11:46:39,444 -   best_eval_score = 0.4563
2024-07-16 11:46:39,444 -   eval_score = 0.4761
2024-07-16 11:46:39,444 -   train_loss = 0.9578
2024-07-16 11:47:38,318 - ***** Epoch: 6: Eval results *****
2024-07-16 11:47:38,319 -   best_eval_score = 0.4761
2024-07-16 11:47:38,319 -   eval_score = 0.4375
2024-07-16 11:47:38,319 -   train_loss = 0.8533
2024-07-16 11:47:38,319 - EarlyStopping counter: 1 out of 8
2024-07-16 11:48:36,776 - ***** Epoch: 7: Eval results *****
2024-07-16 11:48:36,776 -   best_eval_score = 0.4761
2024-07-16 11:48:36,777 -   eval_score = 0.4916
2024-07-16 11:48:36,777 -   train_loss = 0.7549
2024-07-16 11:49:35,775 - ***** Epoch: 8: Eval results *****
2024-07-16 11:49:35,776 -   best_eval_score = 0.4916
2024-07-16 11:49:35,776 -   eval_score = 0.4684
2024-07-16 11:49:35,776 -   train_loss = 0.7208
2024-07-16 11:49:35,776 - EarlyStopping counter: 1 out of 8
2024-07-16 11:50:34,538 - ***** Epoch: 9: Eval results *****
2024-07-16 11:50:34,539 -   best_eval_score = 0.4916
2024-07-16 11:50:34,539 -   eval_score = 0.4566
2024-07-16 11:50:34,539 -   train_loss = 0.6828
2024-07-16 11:50:34,539 - EarlyStopping counter: 2 out of 8
2024-07-16 11:51:33,955 - ***** Epoch: 10: Eval results *****
2024-07-16 11:51:33,955 -   best_eval_score = 0.4916
2024-07-16 11:51:33,955 -   eval_score = 0.4765
2024-07-16 11:51:33,956 -   train_loss = 0.6613
2024-07-16 11:51:33,956 - EarlyStopping counter: 3 out of 8
2024-07-16 11:52:32,742 - ***** Epoch: 11: Eval results *****
2024-07-16 11:52:32,743 -   best_eval_score = 0.4916
2024-07-16 11:52:32,743 -   eval_score = 0.4642
2024-07-16 11:52:32,743 -   train_loss = 0.6497
2024-07-16 11:52:32,743 - EarlyStopping counter: 4 out of 8
2024-07-16 11:53:32,110 - ***** Epoch: 12: Eval results *****
2024-07-16 11:53:32,110 -   best_eval_score = 0.4916
2024-07-16 11:53:32,110 -   eval_score = 0.4713
2024-07-16 11:53:32,111 -   train_loss = 0.6479
2024-07-16 11:53:32,111 - EarlyStopping counter: 5 out of 8
2024-07-16 11:54:30,715 - ***** Epoch: 13: Eval results *****
2024-07-16 11:54:30,715 -   best_eval_score = 0.4916
2024-07-16 11:54:30,715 -   eval_score = 0.4686
2024-07-16 11:54:30,715 -   train_loss = 0.6459
2024-07-16 11:54:30,715 - EarlyStopping counter: 6 out of 8
2024-07-16 11:55:30,345 - ***** Epoch: 14: Eval results *****
2024-07-16 11:55:30,345 -   best_eval_score = 0.4916
2024-07-16 11:55:30,345 -   eval_score = 0.471
2024-07-16 11:55:30,345 -   train_loss = 0.6429
2024-07-16 11:55:30,345 - EarlyStopping counter: 7 out of 8
2024-07-16 11:56:28,640 - ***** Epoch: 15: Eval results *****
2024-07-16 11:56:28,641 -   best_eval_score = 0.4916
2024-07-16 11:56:28,641 -   eval_score = 0.471
2024-07-16 11:56:28,641 -   train_loss = 0.6415
2024-07-16 11:56:28,641 - EarlyStopping counter: 8 out of 8
2024-07-16 11:56:28,641 - EarlyStopping at epoch 15
2024-07-16 11:56:28,643 - Training is finished...
2024-07-16 11:56:28,643 - Testing begins...
2024-07-16 11:56:38,669 - ***** Test: Confusion Matrix *****
2024-07-16 11:56:38,670 - [[  1   4   2   0   0   0   0   5   1   0   5   2]
 [  0  37  11   0   0   2   2   0   6   1  22   4]
 [  0  17  76   3   2   3  14   2  21   7  91  13]
 [  0   1   0  24   0   1   0   0   2   4   2   0]
 [  0   5   3   1  14   0   0   1   0   1   0   7]
 [  0   1   0   0   0  27   2   0   4   1  15   3]
 [  0   0   9   1   0   1  23   0   4   1  16   1]
 [  3   0   0   0   0   0   0  70   0   3   5   4]
 [  1   6   9   5   1   4   8   1  78   7  96   1]
 [  0   2   5   0   1   0   1   3   1 370   9   2]
 [  0  14  58   1   1  13   7  10  57  27 375  17]
 [  0   5   6   1   6   7   1   5  10   5  25  41]]
2024-07-16 11:56:38,670 - ***** Evaluation results *****
2024-07-16 11:56:38,670 -   acc = 0.5926
2024-07-16 11:56:38,670 -   f1 = 0.4984
2024-07-16 11:56:38,670 -   prec = 0.5105
2024-07-16 11:56:38,670 -   rec = 0.4991
2024-07-16 11:56:38,670 - Testing is finished...
2024-07-16 11:56:38,670 - Multimodal intent recognition is finished...
2024-07-16 11:56:38,670 - Results are saved in results/misa_bert_MELD-DA.csv
