2024-01-12 02:20:25,007 - ============================== Params ==============================
2024-01-12 02:20:25,007 - logger_name: msz_MIntRec_multi-class_seed-4_2024-01-12-02-20-24
2024-01-12 02:20:25,007 - dataset: MIntRec
2024-01-12 02:20:25,007 - data_mode: multi-class
2024-01-12 02:20:25,007 - method: msz
2024-01-12 02:20:25,007 - text_backbone: bert-base-uncased
2024-01-12 02:20:25,007 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-12 02:20:25,007 - seed: 4
2024-01-12 02:20:25,007 - num_workers: 8
2024-01-12 02:20:25,007 - gpu_id: 1
2024-01-12 02:20:25,007 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-12 02:20:25,007 - train: True
2024-01-12 02:20:25,007 - tune: False
2024-01-12 02:20:25,007 - save_model: False
2024-01-12 02:20:25,007 - save_results: True
2024-01-12 02:20:25,007 - log_path: logs
2024-01-12 02:20:25,007 - cache_path: 
2024-01-12 02:20:25,007 - video_data_path: video_data
2024-01-12 02:20:25,007 - audio_data_path: audio_data
2024-01-12 02:20:25,007 - video_feats_path: video_feats.pkl
2024-01-12 02:20:25,007 - audio_feats_path: audio_feats.pkl
2024-01-12 02:20:25,007 - results_path: results
2024-01-12 02:20:25,007 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-12 02:20:25,008 - model_path: models
2024-01-12 02:20:25,008 - config_file_name: msz
2024-01-12 02:20:25,008 - results_file_name: msz.csv
2024-01-12 02:20:25,008 - padding_mode: zero
2024-01-12 02:20:25,008 - padding_loc: end
2024-01-12 02:20:25,008 - need_aligned: False
2024-01-12 02:20:25,008 - eval_monitor: f1
2024-01-12 02:20:25,008 - train_batch_size: 16
2024-01-12 02:20:25,008 - eval_batch_size: 8
2024-01-12 02:20:25,008 - test_batch_size: 8
2024-01-12 02:20:25,008 - wait_patience: 8
2024-01-12 02:20:25,008 - nheads: 12
2024-01-12 02:20:25,008 - encoder_layers: 6
2024-01-12 02:20:25,008 - attn_dropout: 0.1
2024-01-12 02:20:25,008 - relu_dropout: 0.3
2024-01-12 02:20:25,008 - embed_dropout: 0.2
2024-01-12 02:20:25,008 - res_dropout: 0.1
2024-01-12 02:20:25,008 - attn_mask: False
2024-01-12 02:20:25,008 - hidden_size: 768
2024-01-12 02:20:25,008 - num_attention_heads: 12
2024-01-12 02:20:25,008 - attention_probs_dropout_prob: 0.2
2024-01-12 02:20:25,008 - hidden_dropout_prob: 0.2
2024-01-12 02:20:25,008 - intermediate_size: 768
2024-01-12 02:20:25,008 - num_hidden_layers: 6
2024-01-12 02:20:25,008 - max_position_embeddings: 768
2024-01-12 02:20:25,008 - position_embedding_type: absolute
2024-01-12 02:20:25,008 - batch_first: True
2024-01-12 02:20:25,008 - hidden_dims: 768
2024-01-12 02:20:25,008 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-12 02:20:25,008 - spe_dropouts: [0.2, 0.1, 0.1]
2024-01-12 02:20:25,008 - aligned_method: conv1d
2024-01-12 02:20:25,008 - grad_clip: 2
2024-01-12 02:20:25,008 - num_train_epochs: 100
2024-01-12 02:20:25,008 - warmup_proportion: 0.1
2024-01-12 02:20:25,008 - lr: 3e-06
2024-01-12 02:20:25,008 - weight_decay: 0.01
2024-01-12 02:20:25,008 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-12-02-20-24
2024-01-12 02:20:25,008 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-12-02-20-24/models
2024-01-12 02:20:25,009 - ============================== End Params ==============================
2024-01-12 02:20:25,011 - Generate Text Features Begin...
2024-01-12 02:20:25,458 - Generate Text Features Finished...
2024-01-12 02:20:25,459 - Load Video Features Begin...
2024-01-12 02:20:25,788 - Load Video Features Finished...
2024-01-12 02:20:26,560 - Load Audio Features Begin...
2024-01-12 02:20:27,806 - Load Audio Features Finished...
2024-01-12 02:20:32,584 - method  begins...
2024-01-12 02:20:39,613 - Multimodal intent recognition begins...
2024-01-12 02:20:39,613 - Training begins...
2024-01-12 02:21:03,392 - ***** Epoch: 1: Eval results *****
2024-01-12 02:21:03,393 -   train_loss = 2.966
2024-01-12 02:21:03,393 -   best_eval_score = 0.0
2024-01-12 02:21:03,393 -   eval_score = 0.0227
2024-01-12 02:21:24,733 - ***** Epoch: 2: Eval results *****
2024-01-12 02:21:24,733 -   train_loss = 2.8477
2024-01-12 02:21:24,733 -   best_eval_score = 0.0227
2024-01-12 02:21:24,733 -   eval_score = 0.0234
2024-01-12 02:21:48,916 - ***** Epoch: 3: Eval results *****
2024-01-12 02:21:48,916 -   train_loss = 2.7275
2024-01-12 02:21:48,916 -   best_eval_score = 0.0234
2024-01-12 02:21:48,916 -   eval_score = 0.1158
2024-01-12 02:22:11,018 - ***** Epoch: 4: Eval results *****
2024-01-12 02:22:11,019 -   train_loss = 2.5144
2024-01-12 02:22:11,019 -   best_eval_score = 0.1158
2024-01-12 02:22:11,019 -   eval_score = 0.1507
2024-01-12 02:22:33,802 - ***** Epoch: 5: Eval results *****
2024-01-12 02:22:33,804 -   train_loss = 2.1526
2024-01-12 02:22:33,804 -   best_eval_score = 0.1507
2024-01-12 02:22:33,804 -   eval_score = 0.3147
2024-01-12 02:22:55,949 - ***** Epoch: 6: Eval results *****
2024-01-12 02:22:55,949 -   train_loss = 1.746
2024-01-12 02:22:55,950 -   best_eval_score = 0.3147
2024-01-12 02:22:55,950 -   eval_score = 0.4672
2024-01-12 02:23:17,999 - ***** Epoch: 7: Eval results *****
2024-01-12 02:23:17,999 -   train_loss = 1.3674
2024-01-12 02:23:17,999 -   best_eval_score = 0.4672
2024-01-12 02:23:17,999 -   eval_score = 0.5423
2024-01-12 02:23:40,002 - ***** Epoch: 8: Eval results *****
2024-01-12 02:23:40,003 -   train_loss = 1.0504
2024-01-12 02:23:40,003 -   best_eval_score = 0.5423
2024-01-12 02:23:40,003 -   eval_score = 0.5861
2024-01-12 02:24:01,931 - ***** Epoch: 9: Eval results *****
2024-01-12 02:24:01,931 -   train_loss = 0.788
2024-01-12 02:24:01,931 -   best_eval_score = 0.5861
2024-01-12 02:24:01,931 -   eval_score = 0.5945
2024-01-12 02:24:25,275 - ***** Epoch: 10: Eval results *****
2024-01-12 02:24:25,276 -   train_loss = 0.5744
2024-01-12 02:24:25,276 -   best_eval_score = 0.5945
2024-01-12 02:24:25,276 -   eval_score = 0.6161
2024-01-12 02:24:49,126 - ***** Epoch: 11: Eval results *****
2024-01-12 02:24:49,127 -   train_loss = 0.4079
2024-01-12 02:24:49,127 -   best_eval_score = 0.6161
2024-01-12 02:24:49,127 -   eval_score = 0.6644
2024-01-12 02:25:11,129 - ***** Epoch: 12: Eval results *****
2024-01-12 02:25:11,129 -   train_loss = 0.2988
2024-01-12 02:25:11,129 -   best_eval_score = 0.6644
2024-01-12 02:25:11,129 -   eval_score = 0.6719
2024-01-12 02:25:33,687 - ***** Epoch: 13: Eval results *****
2024-01-12 02:25:33,688 -   train_loss = 0.2083
2024-01-12 02:25:33,688 -   best_eval_score = 0.6719
2024-01-12 02:25:33,688 -   eval_score = 0.6709
2024-01-12 02:25:33,688 - EarlyStopping counter: 1 out of 8
2024-01-12 02:25:55,894 - ***** Epoch: 14: Eval results *****
2024-01-12 02:25:55,894 -   train_loss = 0.1478
2024-01-12 02:25:55,894 -   best_eval_score = 0.6719
2024-01-12 02:25:55,894 -   eval_score = 0.6584
2024-01-12 02:25:55,894 - EarlyStopping counter: 2 out of 8
2024-01-12 02:26:18,032 - ***** Epoch: 15: Eval results *****
2024-01-12 02:26:18,032 -   train_loss = 0.1128
2024-01-12 02:26:18,032 -   best_eval_score = 0.6719
2024-01-12 02:26:18,032 -   eval_score = 0.6781
2024-01-12 02:26:40,272 - ***** Epoch: 16: Eval results *****
2024-01-12 02:26:40,272 -   train_loss = 0.0871
2024-01-12 02:26:40,272 -   best_eval_score = 0.6781
2024-01-12 02:26:40,272 -   eval_score = 0.6779
2024-01-12 02:26:40,272 - EarlyStopping counter: 1 out of 8
2024-01-12 02:27:02,790 - ***** Epoch: 17: Eval results *****
2024-01-12 02:27:02,790 -   train_loss = 0.064
2024-01-12 02:27:02,790 -   best_eval_score = 0.6781
2024-01-12 02:27:02,790 -   eval_score = 0.6712
2024-01-12 02:27:02,790 - EarlyStopping counter: 2 out of 8
2024-01-12 02:27:25,496 - ***** Epoch: 18: Eval results *****
2024-01-12 02:27:25,497 -   train_loss = 0.0537
2024-01-12 02:27:25,497 -   best_eval_score = 0.6781
2024-01-12 02:27:25,497 -   eval_score = 0.673
2024-01-12 02:27:25,497 - EarlyStopping counter: 3 out of 8
2024-01-12 02:27:47,536 - ***** Epoch: 19: Eval results *****
2024-01-12 02:27:47,536 -   train_loss = 0.0422
2024-01-12 02:27:47,536 -   best_eval_score = 0.6781
2024-01-12 02:27:47,536 -   eval_score = 0.6818
2024-01-12 02:28:09,965 - ***** Epoch: 20: Eval results *****
2024-01-12 02:28:09,966 -   train_loss = 0.0389
2024-01-12 02:28:09,966 -   best_eval_score = 0.6818
2024-01-12 02:28:09,966 -   eval_score = 0.6803
2024-01-12 02:28:09,966 - EarlyStopping counter: 1 out of 8
2024-01-12 02:28:33,058 - ***** Epoch: 21: Eval results *****
2024-01-12 02:28:33,059 -   train_loss = 0.0324
2024-01-12 02:28:33,059 -   best_eval_score = 0.6818
2024-01-12 02:28:33,059 -   eval_score = 0.67
2024-01-12 02:28:33,059 - EarlyStopping counter: 2 out of 8
2024-01-12 02:28:58,659 - ***** Epoch: 22: Eval results *****
2024-01-12 02:28:58,660 -   train_loss = 0.0268
2024-01-12 02:28:58,660 -   best_eval_score = 0.6818
2024-01-12 02:28:58,660 -   eval_score = 0.6714
2024-01-12 02:28:58,660 - EarlyStopping counter: 3 out of 8
2024-01-12 02:29:21,922 - ***** Epoch: 23: Eval results *****
2024-01-12 02:29:21,923 -   train_loss = 0.0235
2024-01-12 02:29:21,923 -   best_eval_score = 0.6818
2024-01-12 02:29:21,923 -   eval_score = 0.6783
2024-01-12 02:29:21,923 - EarlyStopping counter: 4 out of 8
2024-01-12 02:29:45,010 - ***** Epoch: 24: Eval results *****
2024-01-12 02:29:45,011 -   train_loss = 0.0229
2024-01-12 02:29:45,011 -   best_eval_score = 0.6818
2024-01-12 02:29:45,011 -   eval_score = 0.6958
2024-01-12 02:30:07,716 - ***** Epoch: 25: Eval results *****
2024-01-12 02:30:07,717 -   train_loss = 0.0191
2024-01-12 02:30:07,717 -   best_eval_score = 0.6958
2024-01-12 02:30:07,717 -   eval_score = 0.6862
2024-01-12 02:30:07,717 - EarlyStopping counter: 1 out of 8
2024-01-12 02:30:29,650 - ***** Epoch: 26: Eval results *****
2024-01-12 02:30:29,651 -   train_loss = 0.017
2024-01-12 02:30:29,651 -   best_eval_score = 0.6958
2024-01-12 02:30:29,651 -   eval_score = 0.6781
2024-01-12 02:30:29,651 - EarlyStopping counter: 2 out of 8
2024-01-12 02:30:51,123 - ***** Epoch: 27: Eval results *****
2024-01-12 02:30:51,123 -   train_loss = 0.015
2024-01-12 02:30:51,124 -   best_eval_score = 0.6958
2024-01-12 02:30:51,124 -   eval_score = 0.6733
2024-01-12 02:30:51,124 - EarlyStopping counter: 3 out of 8
2024-01-12 02:31:14,324 - ***** Epoch: 28: Eval results *****
2024-01-12 02:31:14,325 -   train_loss = 0.0135
2024-01-12 02:31:14,325 -   best_eval_score = 0.6958
2024-01-12 02:31:14,325 -   eval_score = 0.6752
2024-01-12 02:31:14,325 - EarlyStopping counter: 4 out of 8
2024-01-12 02:31:37,129 - ***** Epoch: 29: Eval results *****
2024-01-12 02:31:37,129 -   train_loss = 0.0115
2024-01-12 02:31:37,129 -   best_eval_score = 0.6958
2024-01-12 02:31:37,130 -   eval_score = 0.6782
2024-01-12 02:31:37,130 - EarlyStopping counter: 5 out of 8
2024-01-12 02:31:59,339 - ***** Epoch: 30: Eval results *****
2024-01-12 02:31:59,339 -   train_loss = 0.0103
2024-01-12 02:31:59,339 -   best_eval_score = 0.6958
2024-01-12 02:31:59,339 -   eval_score = 0.6836
2024-01-12 02:31:59,339 - EarlyStopping counter: 6 out of 8
2024-01-12 02:32:22,579 - ***** Epoch: 31: Eval results *****
2024-01-12 02:32:22,579 -   train_loss = 0.0091
2024-01-12 02:32:22,580 -   best_eval_score = 0.6958
2024-01-12 02:32:22,580 -   eval_score = 0.6836
2024-01-12 02:32:22,580 - EarlyStopping counter: 7 out of 8
2024-01-12 02:32:45,379 - ***** Epoch: 32: Eval results *****
2024-01-12 02:32:45,379 -   train_loss = 0.0088
2024-01-12 02:32:45,379 -   best_eval_score = 0.6958
2024-01-12 02:32:45,379 -   eval_score = 0.6821
2024-01-12 02:32:45,379 - EarlyStopping counter: 8 out of 8
2024-01-12 02:32:45,379 - EarlyStopping at epoch 32
2024-01-12 02:32:45,384 - Training is finished...
2024-01-12 02:32:45,384 - Testing begins...
2024-01-12 02:32:50,661 - ***** Test: Confusion Matrix *****
2024-01-12 02:32:50,663 - [[37  1  0  0  7  0  3  1  0  2  1  0  4  1  0  0  0  0  0  0]
 [ 0 36  0  1  0  2  0  0  0  0  1  0  2  0  1  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 5  0  0  0  9  0  3  0  0  0  0  1  2  1  0  0  0  2  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 1  1  0  0  2  0  3  0  3  0  0  0  1  0  1  0  0  0  0  0]
 [ 3  0  0  0  0  1  0  5  1  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  3  4  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  3  0  0  0  0  0  3  0  1  0  1]
 [ 1  0  0  0  0  0  1  0  0  1 13  0  0  0  1  0  1  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  0  1]
 [ 3  3  0  0  0  0  0  0  0  0  0  1 38  4  5  1  2  0  0  0]
 [ 0  1  0  0  0  0  2  0  0  0  1  1  0 18  2  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  2 16  0  1  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  3  0  0 16  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  2  0 12  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  1  0  0  0  0 12  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  2  0  1  0  0  5]]
2024-01-12 02:32:50,663 - ***** Evaluation results *****
2024-01-12 02:32:50,663 -   acc = 0.7056
2024-01-12 02:32:50,663 -   f1 = 0.6728
2024-01-12 02:32:50,663 -   prec = 0.6814
2024-01-12 02:32:50,664 -   rec = 0.6708
2024-01-12 02:32:50,664 - Testing is finished...
2024-01-12 02:32:50,664 - Multimodal intent recognition is finished...
2024-01-12 02:32:50,664 - Results are saved in results/msz.csv
