2024-03-10 01:18:07,328 - ============================== Params ==============================
2024-03-10 01:18:07,328 - logger_name: msz_MIntRec_multi-class_seed-1_2024-03-10-01-18-07
2024-03-10 01:18:07,328 - dataset: MIntRec
2024-03-10 01:18:07,328 - data_mode: multi-class
2024-03-10 01:18:07,329 - method: msz
2024-03-10 01:18:07,329 - text_backbone: bert-base-uncased
2024-03-10 01:18:07,329 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-10 01:18:07,329 - seed: 1
2024-03-10 01:18:07,329 - num_workers: 8
2024-03-10 01:18:07,329 - gpu_id: 2
2024-03-10 01:18:07,329 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-10 01:18:07,329 - train: True
2024-03-10 01:18:07,329 - tune: True
2024-03-10 01:18:07,329 - save_model: False
2024-03-10 01:18:07,329 - save_results: True
2024-03-10 01:18:07,329 - log_path: logs
2024-03-10 01:18:07,329 - cache_path: 
2024-03-10 01:18:07,329 - video_data_path: video_data
2024-03-10 01:18:07,329 - audio_data_path: audio_data
2024-03-10 01:18:07,329 - video_feats_path: video_feats.pkl
2024-03-10 01:18:07,329 - audio_feats_path: audio_feats.pkl
2024-03-10 01:18:07,329 - results_path: results
2024-03-10 01:18:07,329 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-03-10 01:18:07,329 - model_path: models
2024-03-10 01:18:07,329 - config_file_name: msz_MIntRec
2024-03-10 01:18:07,329 - results_file_name: msz.csv
2024-03-10 01:18:07,329 - padding_mode: zero
2024-03-10 01:18:07,329 - padding_loc: end
2024-03-10 01:18:07,329 - need_aligned: False
2024-03-10 01:18:07,329 - eval_monitor: f1
2024-03-10 01:18:07,329 - train_batch_size: 16
2024-03-10 01:18:07,329 - eval_batch_size: 8
2024-03-10 01:18:07,329 - test_batch_size: 8
2024-03-10 01:18:07,329 - wait_patience: 8
2024-03-10 01:18:07,329 - hidden_dims: 768
2024-03-10 01:18:07,329 - intermediate_size: 768
2024-03-10 01:18:07,329 - position_embedding_type: absolute
2024-03-10 01:18:07,329 - batch_first: True
2024-03-10 01:18:07,329 - d_num_attention_heads: 8
2024-03-10 01:18:07,329 - d_attention_probs_dropout_prob: 0.2
2024-03-10 01:18:07,329 - d_hidden_dropout_prob: 0.2
2024-03-10 01:18:07,329 - d_num_hidden_layers: 10
2024-03-10 01:18:07,329 - d_max_position_embeddings: 768
2024-03-10 01:18:07,330 - m_num_attention_heads: 12
2024-03-10 01:18:07,330 - m_attention_probs_dropout_prob: 0.2
2024-03-10 01:18:07,330 - m_hidden_dropout_prob: 0.3
2024-03-10 01:18:07,330 - m_num_hidden_layers: 10
2024-03-10 01:18:07,330 - m_max_position_embeddings: 768
2024-03-10 01:18:07,330 - dropout: 0.2
2024-03-10 01:18:07,330 - aligned_method: conv1d
2024-03-10 01:18:07,330 - num_train_epochs: 100
2024-03-10 01:18:07,330 - lr: 3e-06
2024-03-10 01:18:07,330 - lr_mode: min
2024-03-10 01:18:07,330 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-03-10-01-18-07
2024-03-10 01:18:07,330 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-03-10-01-18-07/models
2024-03-10 01:18:07,330 - num_labels: 20
2024-03-10 01:18:07,330 - text_feat_dim: 768
2024-03-10 01:18:07,330 - video_feat_dim: 256
2024-03-10 01:18:07,330 - audio_feat_dim: 768
2024-03-10 01:18:07,330 - text_seq_len: 30
2024-03-10 01:18:07,330 - video_seq_len: 230
2024-03-10 01:18:07,330 - audio_seq_len: 480
2024-03-10 01:18:07,330 - device: cuda:2
2024-03-10 01:18:07,330 - ============================== End Params ==============================
2024-03-10 01:18:07,333 - Generate Text Features Begin...
2024-03-10 01:18:07,785 - Generate Text Features Finished...
2024-03-10 01:18:07,785 - Load Video Features Begin...
2024-03-10 01:18:08,084 - Load Video Features Finished...
2024-03-10 01:18:08,551 - Load Audio Features Begin...
2024-03-10 01:18:09,441 - Load Audio Features Finished...
2024-03-10 01:18:12,018 - method  begins...
2024-03-10 01:18:13,988 - Multimodal intent recognition begins...
2024-03-10 01:18:13,988 - Training begins...
2024-03-10 01:18:37,276 - ***** Epoch: 1: Eval results *****
2024-03-10 01:18:37,276 -   train_loss = 2.7976
2024-03-10 01:18:37,276 -   best_eval_score = 0.0
2024-03-10 01:18:37,276 -   eval_score = 0.1021
2024-03-10 01:19:00,012 - ***** Epoch: 2: Eval results *****
2024-03-10 01:19:00,012 -   train_loss = 2.3026
2024-03-10 01:19:00,012 -   best_eval_score = 0.1021
2024-03-10 01:19:00,012 -   eval_score = 0.323
2024-03-10 01:19:23,699 - ***** Epoch: 3: Eval results *****
2024-03-10 01:19:23,699 -   train_loss = 1.7189
2024-03-10 01:19:23,699 -   best_eval_score = 0.323
2024-03-10 01:19:23,699 -   eval_score = 0.4471
2024-03-10 01:19:46,884 - ***** Epoch: 4: Eval results *****
2024-03-10 01:19:46,884 -   train_loss = 1.2757
2024-03-10 01:19:46,884 -   best_eval_score = 0.4471
2024-03-10 01:19:46,884 -   eval_score = 0.5389
2024-03-10 01:20:10,726 - ***** Epoch: 5: Eval results *****
2024-03-10 01:20:10,726 -   train_loss = 0.9479
2024-03-10 01:20:10,726 -   best_eval_score = 0.5389
2024-03-10 01:20:10,726 -   eval_score = 0.5844
2024-03-10 01:20:35,705 - ***** Epoch: 6: Eval results *****
2024-03-10 01:20:35,705 -   train_loss = 0.6957
2024-03-10 01:20:35,706 -   best_eval_score = 0.5844
2024-03-10 01:20:35,706 -   eval_score = 0.609
2024-03-10 01:20:58,818 - ***** Epoch: 7: Eval results *****
2024-03-10 01:20:58,818 -   train_loss = 0.4919
2024-03-10 01:20:58,819 -   best_eval_score = 0.609
2024-03-10 01:20:58,819 -   eval_score = 0.643
2024-03-10 01:21:22,134 - ***** Epoch: 8: Eval results *****
2024-03-10 01:21:22,134 -   train_loss = 0.3601
2024-03-10 01:21:22,134 -   best_eval_score = 0.643
2024-03-10 01:21:22,134 -   eval_score = 0.6664
2024-03-10 01:21:45,103 - ***** Epoch: 9: Eval results *****
2024-03-10 01:21:45,103 -   train_loss = 0.2622
2024-03-10 01:21:45,103 -   best_eval_score = 0.6664
2024-03-10 01:21:45,103 -   eval_score = 0.6754
2024-03-10 01:22:08,306 - ***** Epoch: 10: Eval results *****
2024-03-10 01:22:08,306 -   train_loss = 0.1879
2024-03-10 01:22:08,306 -   best_eval_score = 0.6754
2024-03-10 01:22:08,306 -   eval_score = 0.675
2024-03-10 01:22:08,306 - EarlyStopping counter: 1 out of 8
2024-03-10 01:22:31,430 - ***** Epoch: 11: Eval results *****
2024-03-10 01:22:31,430 -   train_loss = 0.1419
2024-03-10 01:22:31,430 -   best_eval_score = 0.6754
2024-03-10 01:22:31,431 -   eval_score = 0.6827
2024-03-10 01:22:54,498 - ***** Epoch: 12: Eval results *****
2024-03-10 01:22:54,498 -   train_loss = 0.1293
2024-03-10 01:22:54,498 -   best_eval_score = 0.6827
2024-03-10 01:22:54,498 -   eval_score = 0.6869
2024-03-10 01:23:18,005 - ***** Epoch: 13: Eval results *****
2024-03-10 01:23:18,005 -   train_loss = 0.125
2024-03-10 01:23:18,005 -   best_eval_score = 0.6869
2024-03-10 01:23:18,005 -   eval_score = 0.6943
2024-03-10 01:23:42,203 - ***** Epoch: 14: Eval results *****
2024-03-10 01:23:42,203 -   train_loss = 0.1214
2024-03-10 01:23:42,204 -   best_eval_score = 0.6943
2024-03-10 01:23:42,204 -   eval_score = 0.6858
2024-03-10 01:23:42,204 - EarlyStopping counter: 1 out of 8
2024-03-10 01:24:05,254 - ***** Epoch: 15: Eval results *****
2024-03-10 01:24:05,254 -   train_loss = 0.1157
2024-03-10 01:24:05,254 -   best_eval_score = 0.6943
2024-03-10 01:24:05,254 -   eval_score = 0.6844
2024-03-10 01:24:05,254 - EarlyStopping counter: 2 out of 8
2024-03-10 01:24:28,616 - ***** Epoch: 16: Eval results *****
2024-03-10 01:24:28,617 -   train_loss = 0.1116
2024-03-10 01:24:28,617 -   best_eval_score = 0.6943
2024-03-10 01:24:28,617 -   eval_score = 0.6896
2024-03-10 01:24:28,617 - EarlyStopping counter: 3 out of 8
2024-03-10 01:24:51,472 - ***** Epoch: 17: Eval results *****
2024-03-10 01:24:51,472 -   train_loss = 0.105
2024-03-10 01:24:51,473 -   best_eval_score = 0.6943
2024-03-10 01:24:51,473 -   eval_score = 0.6917
2024-03-10 01:24:51,473 - EarlyStopping counter: 4 out of 8
2024-03-10 01:25:15,070 - ***** Epoch: 18: Eval results *****
2024-03-10 01:25:15,071 -   train_loss = 0.1038
2024-03-10 01:25:15,071 -   best_eval_score = 0.6943
2024-03-10 01:25:15,071 -   eval_score = 0.6927
2024-03-10 01:25:15,071 - EarlyStopping counter: 5 out of 8
2024-03-10 01:25:39,573 - ***** Epoch: 19: Eval results *****
2024-03-10 01:25:39,574 -   train_loss = 0.0981
2024-03-10 01:25:39,574 -   best_eval_score = 0.6943
2024-03-10 01:25:39,574 -   eval_score = 0.6861
2024-03-10 01:25:39,574 - EarlyStopping counter: 6 out of 8
2024-03-10 01:26:03,142 - ***** Epoch: 20: Eval results *****
2024-03-10 01:26:03,142 -   train_loss = 0.0992
2024-03-10 01:26:03,142 -   best_eval_score = 0.6943
2024-03-10 01:26:03,142 -   eval_score = 0.6853
2024-03-10 01:26:03,143 - EarlyStopping counter: 7 out of 8
2024-03-10 01:26:26,457 - ***** Epoch: 21: Eval results *****
2024-03-10 01:26:26,457 -   train_loss = 0.0992
2024-03-10 01:26:26,457 -   best_eval_score = 0.6943
2024-03-10 01:26:26,457 -   eval_score = 0.6856
2024-03-10 01:26:26,457 - EarlyStopping counter: 8 out of 8
2024-03-10 01:26:26,457 - EarlyStopping at epoch 21
2024-03-10 01:26:26,460 - Training is finished...
2024-03-10 01:26:26,461 - Testing begins...
2024-03-10 01:26:30,212 - ***** Test: Confusion Matrix *****
2024-03-10 01:26:30,213 - [[37  2  0  0 11  0  0  0  0  1  1  0  4  1  0  0  0  0  0  0]
 [ 1 34  0  1  0  3  0  0  0  0  1  0  2  1  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 6  0  0  0  9  0  1  0  0  1  0  1  2  1  0  0  0  2  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 2  1  0  0  3  0  1  1  2  0  0  0  1  0  0  0  1  0  0  0]
 [ 3  0  0  0  0  0  0  5  1  1  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  4  3  0  0  0  0  2  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  1  0  0  4  0  0  0  0  0  2  1  1  0  0]
 [ 1  0  0  0  0  0  1  0  0  2 13  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  2  0  0  0  0 16  0  0  0  0  0  0  0  1]
 [ 4  2  0  0  0  0  0  2  0  0  0  2 38  2  3  1  3  0  0  0]
 [ 0  0  0  0  0  0  2  0  0  0  1  1  0 20  1  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  0  0  0  0  2  1 15  0  1  0  0  2]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  4  0  0 15  0  0  0  1]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  3  0  2  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  2  0  0  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  1  0  0  9  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  0  2  0  1  0  0  7]]
2024-03-10 01:26:30,213 - ***** Evaluation results *****
2024-03-10 01:26:30,213 -   acc = 0.6944
2024-03-10 01:26:30,213 -   f1 = 0.6609
2024-03-10 01:26:30,213 -   prec = 0.6684
2024-03-10 01:26:30,213 -   rec = 0.6606
2024-03-10 01:26:30,213 - Testing is finished...
2024-03-10 01:26:30,213 - Multimodal intent recognition is finished...
2024-03-10 01:26:30,213 - Results are saved in results/msz.csv
