2024-03-18 04:02:00,919 - ============================== Params ==============================
2024-03-18 04:02:00,919 - logger_name: mag_bert_MIntRec2_multi-class_seed-3_2024-03-18-04-02-00
2024-03-18 04:02:00,919 - dataset: MIntRec2
2024-03-18 04:02:00,919 - data_mode: multi-class
2024-03-18 04:02:00,919 - method: mag_bert
2024-03-18 04:02:00,919 - text_backbone: bert-base-uncased
2024-03-18 04:02:00,919 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-03-18 04:02:00,919 - seed: 3
2024-03-18 04:02:00,919 - num_workers: 8
2024-03-18 04:02:00,919 - gpu_id: 2
2024-03-18 04:02:00,919 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-03-18 04:02:00,919 - train: True
2024-03-18 04:02:00,919 - tune: True
2024-03-18 04:02:00,919 - save_model: False
2024-03-18 04:02:00,919 - save_results: True
2024-03-18 04:02:00,919 - log_path: logs
2024-03-18 04:02:00,919 - cache_path: 
2024-03-18 04:02:00,919 - video_data_path: video_data
2024-03-18 04:02:00,919 - audio_data_path: audio_data
2024-03-18 04:02:00,919 - video_feats_path: video_feats.pkl
2024-03-18 04:02:00,920 - audio_feats_path: audio_feats.pkl
2024-03-18 04:02:00,920 - results_path: results
2024-03-18 04:02:00,920 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2
2024-03-18 04:02:00,920 - model_path: models
2024-03-18 04:02:00,920 - config_file_name: mag_bert_MIntRec2
2024-03-18 04:02:00,920 - results_file_name: mag_bert.csv
2024-03-18 04:02:00,920 - padding_mode: zero
2024-03-18 04:02:00,920 - padding_loc: end
2024-03-18 04:02:00,920 - need_aligned: True
2024-03-18 04:02:00,920 - eval_monitor: f1
2024-03-18 04:02:00,920 - train_batch_size: 32
2024-03-18 04:02:00,920 - eval_batch_size: 16
2024-03-18 04:02:00,920 - test_batch_size: 16
2024-03-18 04:02:00,920 - wait_patience: 8
2024-03-18 04:02:00,920 - num_train_epochs: 100
2024-03-18 04:02:00,920 - beta_shift: 0.01
2024-03-18 04:02:00,920 - dropout_prob: 0.3
2024-03-18 04:02:00,920 - warmup_proportion: 0.01
2024-03-18 04:02:00,920 - lr: 2e-05
2024-03-18 04:02:00,920 - aligned_method: conv1d
2024-03-18 04:02:00,920 - weight_decay: 0.03
2024-03-18 04:02:00,920 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-3_2024-03-18-04-02-00
2024-03-18 04:02:00,920 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec2/mag_bert_MIntRec2_multi-class_seed-3_2024-03-18-04-02-00/models
2024-03-18 04:02:00,920 - ============================== End Params ==============================
2024-03-18 04:02:01,710 - Generate Text Features Begin...
2024-03-18 04:02:03,586 - Generate Text Features Finished...
2024-03-18 04:02:03,640 - Load Video Features Begin...
2024-03-18 04:04:22,204 - Load Video Features Finished...
2024-03-18 04:04:24,156 - Load Audio Features Begin...
2024-03-18 04:11:24,683 - Load Audio Features Finished...
2024-03-18 04:11:38,697 - method  begins...
2024-03-18 04:11:41,363 - Multimodal intent recognition begins...
2024-03-18 04:11:41,363 - Training begins...
2024-03-18 04:12:17,714 - ***** Epoch: 1: Eval results *****
2024-03-18 04:12:17,714 -   train_loss = 2.7562
2024-03-18 04:12:17,714 -   best_eval_score = 0.0
2024-03-18 04:12:17,715 -   eval_score = 0.2957
2024-03-18 04:12:50,410 - ***** Epoch: 2: Eval results *****
2024-03-18 04:12:50,410 -   train_loss = 1.6751
2024-03-18 04:12:50,410 -   best_eval_score = 0.2957
2024-03-18 04:12:50,410 -   eval_score = 0.4274
2024-03-18 04:13:20,789 - ***** Epoch: 3: Eval results *****
2024-03-18 04:13:20,789 -   train_loss = 1.2197
2024-03-18 04:13:20,789 -   best_eval_score = 0.4274
2024-03-18 04:13:20,789 -   eval_score = 0.4479
2024-03-18 04:13:52,828 - ***** Epoch: 4: Eval results *****
2024-03-18 04:13:52,828 -   train_loss = 0.9169
2024-03-18 04:13:52,828 -   best_eval_score = 0.4479
2024-03-18 04:13:52,828 -   eval_score = 0.4871
2024-03-18 04:14:24,748 - ***** Epoch: 5: Eval results *****
2024-03-18 04:14:24,748 -   train_loss = 0.6813
2024-03-18 04:14:24,749 -   best_eval_score = 0.4871
2024-03-18 04:14:24,749 -   eval_score = 0.4806
2024-03-18 04:14:24,749 - EarlyStopping counter: 1 out of 8
2024-03-18 04:14:55,772 - ***** Epoch: 6: Eval results *****
2024-03-18 04:14:55,772 -   train_loss = 0.4968
2024-03-18 04:14:55,772 -   best_eval_score = 0.4871
2024-03-18 04:14:55,772 -   eval_score = 0.4903
2024-03-18 04:15:27,278 - ***** Epoch: 7: Eval results *****
2024-03-18 04:15:27,279 -   train_loss = 0.373
2024-03-18 04:15:27,279 -   best_eval_score = 0.4903
2024-03-18 04:15:27,279 -   eval_score = 0.481
2024-03-18 04:15:27,279 - EarlyStopping counter: 1 out of 8
2024-03-18 04:15:58,727 - ***** Epoch: 8: Eval results *****
2024-03-18 04:15:58,727 -   train_loss = 0.2739
2024-03-18 04:15:58,727 -   best_eval_score = 0.4903
2024-03-18 04:15:58,727 -   eval_score = 0.501
2024-03-18 04:16:29,320 - ***** Epoch: 9: Eval results *****
2024-03-18 04:16:29,320 -   train_loss = 0.2073
2024-03-18 04:16:29,320 -   best_eval_score = 0.501
2024-03-18 04:16:29,320 -   eval_score = 0.5096
2024-03-18 04:17:00,117 - ***** Epoch: 10: Eval results *****
2024-03-18 04:17:00,117 -   train_loss = 0.1597
2024-03-18 04:17:00,117 -   best_eval_score = 0.5096
2024-03-18 04:17:00,117 -   eval_score = 0.4933
2024-03-18 04:17:00,117 - EarlyStopping counter: 1 out of 8
2024-03-18 04:17:31,440 - ***** Epoch: 11: Eval results *****
2024-03-18 04:17:31,440 -   train_loss = 0.1273
2024-03-18 04:17:31,441 -   best_eval_score = 0.5096
2024-03-18 04:17:31,441 -   eval_score = 0.5026
2024-03-18 04:17:31,441 - EarlyStopping counter: 2 out of 8
2024-03-18 04:18:02,508 - ***** Epoch: 12: Eval results *****
2024-03-18 04:18:02,508 -   train_loss = 0.1152
2024-03-18 04:18:02,508 -   best_eval_score = 0.5096
2024-03-18 04:18:02,508 -   eval_score = 0.5078
2024-03-18 04:18:02,508 - EarlyStopping counter: 3 out of 8
2024-03-18 04:18:36,160 - ***** Epoch: 13: Eval results *****
2024-03-18 04:18:36,161 -   train_loss = 0.0967
2024-03-18 04:18:36,161 -   best_eval_score = 0.5096
2024-03-18 04:18:36,161 -   eval_score = 0.4993
2024-03-18 04:18:36,161 - EarlyStopping counter: 4 out of 8
2024-03-18 04:19:09,932 - ***** Epoch: 14: Eval results *****
2024-03-18 04:19:09,933 -   train_loss = 0.0882
2024-03-18 04:19:09,933 -   best_eval_score = 0.5096
2024-03-18 04:19:09,933 -   eval_score = 0.509
2024-03-18 04:19:09,933 - EarlyStopping counter: 5 out of 8
2024-03-18 04:19:43,218 - ***** Epoch: 15: Eval results *****
2024-03-18 04:19:43,218 -   train_loss = 0.0799
2024-03-18 04:19:43,218 -   best_eval_score = 0.5096
2024-03-18 04:19:43,218 -   eval_score = 0.4956
2024-03-18 04:19:43,218 - EarlyStopping counter: 6 out of 8
2024-03-18 04:20:16,881 - ***** Epoch: 16: Eval results *****
2024-03-18 04:20:16,881 -   train_loss = 0.0733
2024-03-18 04:20:16,881 -   best_eval_score = 0.5096
2024-03-18 04:20:16,881 -   eval_score = 0.4956
2024-03-18 04:20:16,881 - EarlyStopping counter: 7 out of 8
2024-03-18 04:20:49,352 - ***** Epoch: 17: Eval results *****
2024-03-18 04:20:49,353 -   train_loss = 0.0745
2024-03-18 04:20:49,353 -   best_eval_score = 0.5096
2024-03-18 04:20:49,353 -   eval_score = 0.5022
2024-03-18 04:20:49,353 - EarlyStopping counter: 8 out of 8
2024-03-18 04:20:49,353 - EarlyStopping at epoch 17
2024-03-18 04:20:49,354 - Training is finished...
2024-03-18 04:20:49,355 - Testing begins...
2024-03-18 04:20:55,463 - ***** Test: Confusion Matrix *****
2024-03-18 04:20:55,464 - [[ 45   1  16   0   0   0   0   0   1   0   2   0   0   1   0   0   0   0
    0   0   0   0   1   0   1   0   0   0   0   0]
 [  0  57   0   0   9   2   4   0   3   0   2   0   3   0   4   1   0   4
    0   1   0   0   2   0   1   1   0   3   0   0]
 [  8   0  45   0   1   0   0   0   0   0   1   0   0   1   1   0   0   2
    0   0   0   1   0   1   1   0   0   2   0   0]
 [  0   0   0  62   0   0   0   1   0   0   0   0   0   0   1   0   0   0
    0   0   0   0   0   0   1   0   0   0   0   0]
 [  0   6   0   0  30   1   0   0   0   0   0   0   0   0   0   0   0   4
    0   2   0   1   1   2   1   0   0   0   1   2]
 [  0   1   0   0   1  22   1   0   0   2   2   0   0   0   1   0   0   3
    0   0   0   0   0   1   0   1   1   0   1   0]
 [  0   1   0   0   0   4  27   4   0   1   6   1   3   0   0   0   0   0
    0   1   0   0   0   0   0   0   0   0   0   0]
 [  0   2   0   0   0   0   3  25   0   0   7   1   5   0   0   0   2   0
    0   1   0   0   0   0   0   0   0   1   0   0]
 [  1   2   1   2   2   0   0   1  22   1   0   1   0   1   4   0   0   3
    1   0   0   1   4   0   2   0   0   0   0   0]
 [  0   1   1   1   0   0   1   0   2  48   0   4   9   2  10   0   0  11
    1   0   0   2   3   1   2   1   0   5   0   2]
 [  0   0   0   0   0   2   2   0   2   0  50   0  28   0   2   0   0   2
    0   2   0   0   0   0   1   0   0   2   0   0]
 [  0   0   0   0   0   0   0   1   0  11   0  12   9   0   2   0   0   1
    1   0   0   0   2   0   0   0   0   7   0   1]
 [  0   2   1   0   0   1   3   6   0   5  29   2  79   0   1   0   1   0
    0   2   0   0   1   0   0   0   0   2   0   0]
 [  0   0   2   0   1   0   0   0   0   2   0   0   0   1   4   1   0   2
    3   0   0   0   0   0   0   0   0   1   0   0]
 [  0   2   2   1   0   3   0   1   3   8   3   0   1   9 101   3   0  22
    6   0   2   0  14   1   3   0   1   7   0   0]
 [  0   0   2   0   0   0   0   0   0   3   0   0   0   1   2   6   0   1
    2   0   1   1   0   0   0   0   0   2   1   0]
 [  0   0   0   0   1   0   0   1   0   0   1   0   2   0   0   0  56   0
    4   0   0   0   0   0   1   0   0   0   0   0]
 [  1   7   3   0   6   2   0   0   4  10   3   1   0   3  15   3   2 110
    8   3   2   4   8  15   0   2   0   3   1   1]
 [  0   2   0   0   0   0   1   0   0   3   1   0   0   1   8   0   3   5
   30   1   1   0   1   0   3   0   0   0   0   0]
 [  0   6   0   0   0   0   2   0   0   0   2   0   0   0   0   0   0   0
    0   6   0   1   0   0   0   0   0   0   0   0]
 [  0   1   2   0   1   0   0   0   0   0   0   0   1   0   5   3   0   1
    4   0   5   0   0   2   0   0   0   3   0   1]
 [  7   1   0   0   0   0   0   0   1   3   0   0   0   0   1   0   4   0
    0   1   0  22   2   7   0   1   1   0   0   2]
 [  0   0   1   0   0   0   0   0   0   3   1   1   1   5   7   0   0   1
    0   0   0   2  80   0   2   4   7   2   0   0]
 [  0   3   2   0   1   0   0   0   0   0   0   0   0   0   0   0   0   2
    0   0   0   2   0  28   0   0   0   0   0   0]
 [  1   0   0   0   0   0   0   0   0   2   3   1   0   1   2   2   0   2
    0   0   0   0   1   1  90   0   0   5   2   0]
 [  1   0   0   0   1   0   0   0   0   0   0   0   0   0   0   0   0   1
    0   0   0   0   2   1   1  22   2   0   0   0]
 [  0   0   0   0   0   0   0   0   0   1   0   0   0   0   2   0   0   3
    0   0   0   0   3   0   0   0   6   0   2   0]
 [  0   3   0   0   1   0   0   0   1   5   2   1   4   2   3   1   0   2
    3   0   0   0   2   0   8   1   0  18   1   0]
 [  0   0   0   0   0   0   0   0   0   0   0   0   0   0   1   0   1   0
    0   0   0   0   0   0   0   0   0   0  56   0]
 [  0   1   0   0   0   0   0   0   3   0   1   1   0   0   0   0   0   3
    1   0   0   1   0   0   1   2   0   1   0   4]]
2024-03-18 04:20:55,464 - ***** Evaluation results *****
2024-03-18 04:20:55,465 -   acc = 0.573
2024-03-18 04:20:55,465 -   f1 = 0.5244
2024-03-18 04:20:55,465 -   prec = 0.532
2024-03-18 04:20:55,465 -   rec = 0.5292
2024-03-18 04:20:55,465 - Testing is finished...
2024-03-18 04:20:55,465 - Multimodal intent recognition is finished...
2024-03-18 04:20:55,465 - Results are saved in results/mag_bert.csv
