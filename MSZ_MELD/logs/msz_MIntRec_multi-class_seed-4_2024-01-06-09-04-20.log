2024-01-06 09:04:20,223 - ============================== Params ==============================
2024-01-06 09:04:20,223 - logger_name: msz_MIntRec_multi-class_seed-4_2024-01-06-09-04-20
2024-01-06 09:04:20,223 - dataset: MIntRec
2024-01-06 09:04:20,223 - data_mode: multi-class
2024-01-06 09:04:20,223 - method: msz
2024-01-06 09:04:20,223 - text_backbone: bert-base-uncased
2024-01-06 09:04:20,223 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-06 09:04:20,223 - seed: 4
2024-01-06 09:04:20,224 - num_workers: 8
2024-01-06 09:04:20,224 - gpu_id: 1
2024-01-06 09:04:20,224 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-06 09:04:20,224 - train: True
2024-01-06 09:04:20,224 - tune: False
2024-01-06 09:04:20,224 - save_model: False
2024-01-06 09:04:20,224 - save_results: True
2024-01-06 09:04:20,224 - log_path: logs
2024-01-06 09:04:20,224 - cache_path: 
2024-01-06 09:04:20,224 - video_data_path: video_data
2024-01-06 09:04:20,224 - audio_data_path: audio_data
2024-01-06 09:04:20,224 - video_feats_path: video_feats.pkl
2024-01-06 09:04:20,224 - audio_feats_path: audio_feats.pkl
2024-01-06 09:04:20,224 - results_path: results
2024-01-06 09:04:20,224 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-06 09:04:20,224 - model_path: models
2024-01-06 09:04:20,224 - config_file_name: msz
2024-01-06 09:04:20,224 - results_file_name: msz.csv
2024-01-06 09:04:20,224 - padding_mode: zero
2024-01-06 09:04:20,224 - padding_loc: end
2024-01-06 09:04:20,224 - need_aligned: False
2024-01-06 09:04:20,224 - eval_monitor: f1
2024-01-06 09:04:20,224 - train_batch_size: 16
2024-01-06 09:04:20,224 - eval_batch_size: 8
2024-01-06 09:04:20,224 - test_batch_size: 8
2024-01-06 09:04:20,224 - wait_patience: 8
2024-01-06 09:04:20,224 - nheads: 2
2024-01-06 09:04:20,224 - encoder_layers: 2
2024-01-06 09:04:20,224 - attn_dropout: 0.1
2024-01-06 09:04:20,224 - relu_dropout: 0.1
2024-01-06 09:04:20,224 - embed_dropout: 0.1
2024-01-06 09:04:20,224 - res_dropout: 0.1
2024-01-06 09:04:20,224 - attn_mask: False
2024-01-06 09:04:20,224 - hidden_size: 768
2024-01-06 09:04:20,224 - num_attention_heads: 12
2024-01-06 09:04:20,224 - attention_probs_dropout_prob: 0.2
2024-01-06 09:04:20,225 - hidden_dropout_prob: 0.2
2024-01-06 09:04:20,225 - intermediate_size: 768
2024-01-06 09:04:20,225 - num_hidden_layers: 3
2024-01-06 09:04:20,225 - max_position_embeddings: 512
2024-01-06 09:04:20,225 - position_embedding_type: absolute
2024-01-06 09:04:20,225 - batch_first: True
2024-01-06 09:04:20,225 - hidden_dims: 768
2024-01-06 09:04:20,225 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-06 09:04:20,225 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-06 09:04:20,225 - ta_loss: 0.1
2024-01-06 09:04:20,225 - tv_loss: 0.1
2024-01-06 09:04:20,225 - av_loss: 0.1
2024-01-06 09:04:20,225 - aligned_method: conv1d
2024-01-06 09:04:20,225 - grad_clip: -1
2024-01-06 09:04:20,225 - num_train_epochs: 100
2024-01-06 09:04:20,225 - warmup_proportion: 0.1
2024-01-06 09:04:20,225 - lr: 1e-05
2024-01-06 09:04:20,225 - weight_decay: 0.01
2024-01-06 09:04:20,225 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-06-09-04-20
2024-01-06 09:04:20,225 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-4_2024-01-06-09-04-20/models
2024-01-06 09:04:20,225 - ============================== End Params ==============================
2024-01-06 09:04:20,228 - Generate Text Features Begin...
2024-01-06 09:04:20,728 - Generate Text Features Finished...
2024-01-06 09:04:20,728 - Load Video Features Begin...
2024-01-06 09:04:21,410 - Load Video Features Finished...
2024-01-06 09:04:22,029 - Load Audio Features Begin...
2024-01-06 09:04:25,135 - Load Audio Features Finished...
2024-01-06 09:04:29,280 - method  begins...
2024-01-06 09:04:33,859 - Multimodal intent recognition begins...
2024-01-06 09:04:33,859 - Training begins...
2024-01-06 09:04:47,851 - ***** Epoch: 1: Eval results *****
2024-01-06 09:04:47,852 -   train_loss = 2.9875
2024-01-06 09:04:47,852 -   best_eval_score = 0.0
2024-01-06 09:04:47,852 -   eval_score = 0.0114
2024-01-06 09:04:59,964 - ***** Epoch: 2: Eval results *****
2024-01-06 09:04:59,965 -   train_loss = 2.9451
2024-01-06 09:04:59,965 -   best_eval_score = 0.0114
2024-01-06 09:04:59,965 -   eval_score = 0.0213
2024-01-06 09:05:11,664 - ***** Epoch: 3: Eval results *****
2024-01-06 09:05:11,664 -   train_loss = 2.8625
2024-01-06 09:05:11,664 -   best_eval_score = 0.0213
2024-01-06 09:05:11,664 -   eval_score = 0.0166
2024-01-06 09:05:11,664 - EarlyStopping counter: 1 out of 8
2024-01-06 09:05:23,540 - ***** Epoch: 4: Eval results *****
2024-01-06 09:05:23,540 -   train_loss = 2.8476
2024-01-06 09:05:23,540 -   best_eval_score = 0.0213
2024-01-06 09:05:23,540 -   eval_score = 0.0228
2024-01-06 09:05:36,073 - ***** Epoch: 5: Eval results *****
2024-01-06 09:05:36,073 -   train_loss = 2.8423
2024-01-06 09:05:36,074 -   best_eval_score = 0.0228
2024-01-06 09:05:36,074 -   eval_score = 0.0228
2024-01-06 09:05:36,074 - EarlyStopping counter: 1 out of 8
2024-01-06 09:05:48,933 - ***** Epoch: 6: Eval results *****
2024-01-06 09:05:48,935 -   train_loss = 2.8307
2024-01-06 09:05:48,935 -   best_eval_score = 0.0228
2024-01-06 09:05:48,935 -   eval_score = 0.0202
2024-01-06 09:05:48,936 - EarlyStopping counter: 2 out of 8
2024-01-06 09:06:00,899 - ***** Epoch: 7: Eval results *****
2024-01-06 09:06:00,900 -   train_loss = 2.8407
2024-01-06 09:06:00,900 -   best_eval_score = 0.0228
2024-01-06 09:06:00,900 -   eval_score = 0.0254
2024-01-06 09:06:13,375 - ***** Epoch: 8: Eval results *****
2024-01-06 09:06:13,375 -   train_loss = 2.8236
2024-01-06 09:06:13,376 -   best_eval_score = 0.0254
2024-01-06 09:06:13,376 -   eval_score = 0.0353
2024-01-06 09:06:25,143 - ***** Epoch: 9: Eval results *****
2024-01-06 09:06:25,143 -   train_loss = 2.7967
2024-01-06 09:06:25,143 -   best_eval_score = 0.0353
2024-01-06 09:06:25,143 -   eval_score = 0.03
2024-01-06 09:06:25,143 - EarlyStopping counter: 1 out of 8
2024-01-06 09:06:36,878 - ***** Epoch: 10: Eval results *****
2024-01-06 09:06:36,878 -   train_loss = 2.7906
2024-01-06 09:06:36,878 -   best_eval_score = 0.0353
2024-01-06 09:06:36,878 -   eval_score = 0.024
2024-01-06 09:06:36,878 - EarlyStopping counter: 2 out of 8
2024-01-06 09:06:50,535 - ***** Epoch: 11: Eval results *****
2024-01-06 09:06:50,535 -   train_loss = 2.7656
2024-01-06 09:06:50,535 -   best_eval_score = 0.0353
2024-01-06 09:06:50,535 -   eval_score = 0.0377
2024-01-06 09:07:04,063 - ***** Epoch: 12: Eval results *****
2024-01-06 09:07:04,063 -   train_loss = 2.7595
2024-01-06 09:07:04,063 -   best_eval_score = 0.0377
2024-01-06 09:07:04,063 -   eval_score = 0.0448
2024-01-06 09:07:16,821 - ***** Epoch: 13: Eval results *****
2024-01-06 09:07:16,821 -   train_loss = 2.7231
2024-01-06 09:07:16,821 -   best_eval_score = 0.0448
2024-01-06 09:07:16,821 -   eval_score = 0.0446
2024-01-06 09:07:16,821 - EarlyStopping counter: 1 out of 8
2024-01-06 09:07:30,234 - ***** Epoch: 14: Eval results *****
2024-01-06 09:07:30,235 -   train_loss = 2.7221
2024-01-06 09:07:30,235 -   best_eval_score = 0.0448
2024-01-06 09:07:30,235 -   eval_score = 0.0473
2024-01-06 09:07:43,869 - ***** Epoch: 15: Eval results *****
2024-01-06 09:07:43,869 -   train_loss = 2.7179
2024-01-06 09:07:43,869 -   best_eval_score = 0.0473
2024-01-06 09:07:43,869 -   eval_score = 0.0515
2024-01-06 09:07:55,861 - ***** Epoch: 16: Eval results *****
2024-01-06 09:07:55,861 -   train_loss = 2.6949
2024-01-06 09:07:55,861 -   best_eval_score = 0.0515
2024-01-06 09:07:55,861 -   eval_score = 0.0441
2024-01-06 09:07:55,861 - EarlyStopping counter: 1 out of 8
2024-01-06 09:08:07,714 - ***** Epoch: 17: Eval results *****
2024-01-06 09:08:07,715 -   train_loss = 2.6587
2024-01-06 09:08:07,715 -   best_eval_score = 0.0515
2024-01-06 09:08:07,715 -   eval_score = 0.0431
2024-01-06 09:08:07,715 - EarlyStopping counter: 2 out of 8
2024-01-06 09:08:20,059 - ***** Epoch: 18: Eval results *****
2024-01-06 09:08:20,060 -   train_loss = 2.6454
2024-01-06 09:08:20,060 -   best_eval_score = 0.0515
2024-01-06 09:08:20,060 -   eval_score = 0.0414
2024-01-06 09:08:20,060 - EarlyStopping counter: 3 out of 8
2024-01-06 09:08:32,244 - ***** Epoch: 19: Eval results *****
2024-01-06 09:08:32,244 -   train_loss = 2.6454
2024-01-06 09:08:32,244 -   best_eval_score = 0.0515
2024-01-06 09:08:32,244 -   eval_score = 0.043
2024-01-06 09:08:32,244 - EarlyStopping counter: 4 out of 8
2024-01-06 09:08:45,441 - ***** Epoch: 20: Eval results *****
2024-01-06 09:08:45,441 -   train_loss = 2.666
2024-01-06 09:08:45,441 -   best_eval_score = 0.0515
2024-01-06 09:08:45,441 -   eval_score = 0.0553
2024-01-06 09:08:59,643 - ***** Epoch: 21: Eval results *****
2024-01-06 09:08:59,643 -   train_loss = 2.6364
2024-01-06 09:08:59,643 -   best_eval_score = 0.0553
2024-01-06 09:08:59,644 -   eval_score = 0.0574
2024-01-06 09:09:14,153 - ***** Epoch: 22: Eval results *****
2024-01-06 09:09:14,153 -   train_loss = 2.5942
2024-01-06 09:09:14,153 -   best_eval_score = 0.0574
2024-01-06 09:09:14,153 -   eval_score = 0.0682
2024-01-06 09:09:28,526 - ***** Epoch: 23: Eval results *****
2024-01-06 09:09:28,527 -   train_loss = 2.5713
2024-01-06 09:09:28,527 -   best_eval_score = 0.0682
2024-01-06 09:09:28,527 -   eval_score = 0.058
2024-01-06 09:09:28,527 - EarlyStopping counter: 1 out of 8
2024-01-06 09:09:40,660 - ***** Epoch: 24: Eval results *****
2024-01-06 09:09:40,660 -   train_loss = 2.5501
2024-01-06 09:09:40,660 -   best_eval_score = 0.0682
2024-01-06 09:09:40,660 -   eval_score = 0.0593
2024-01-06 09:09:40,660 - EarlyStopping counter: 2 out of 8
2024-01-06 09:09:52,795 - ***** Epoch: 25: Eval results *****
2024-01-06 09:09:52,796 -   train_loss = 2.534
2024-01-06 09:09:52,796 -   best_eval_score = 0.0682
2024-01-06 09:09:52,796 -   eval_score = 0.0544
2024-01-06 09:09:52,796 - EarlyStopping counter: 3 out of 8
2024-01-06 09:10:05,836 - ***** Epoch: 26: Eval results *****
2024-01-06 09:10:05,836 -   train_loss = 2.4906
2024-01-06 09:10:05,836 -   best_eval_score = 0.0682
2024-01-06 09:10:05,836 -   eval_score = 0.0616
2024-01-06 09:10:05,836 - EarlyStopping counter: 4 out of 8
2024-01-06 09:10:17,946 - ***** Epoch: 27: Eval results *****
2024-01-06 09:10:17,946 -   train_loss = 2.4355
2024-01-06 09:10:17,946 -   best_eval_score = 0.0682
2024-01-06 09:10:17,946 -   eval_score = 0.056
2024-01-06 09:10:17,946 - EarlyStopping counter: 5 out of 8
2024-01-06 09:10:30,013 - ***** Epoch: 28: Eval results *****
2024-01-06 09:10:30,014 -   train_loss = 2.4448
2024-01-06 09:10:30,014 -   best_eval_score = 0.0682
2024-01-06 09:10:30,014 -   eval_score = 0.0613
2024-01-06 09:10:30,014 - EarlyStopping counter: 6 out of 8
2024-01-06 09:10:43,153 - ***** Epoch: 29: Eval results *****
2024-01-06 09:10:43,153 -   train_loss = 2.3632
2024-01-06 09:10:43,153 -   best_eval_score = 0.0682
2024-01-06 09:10:43,153 -   eval_score = 0.0468
2024-01-06 09:10:43,154 - EarlyStopping counter: 7 out of 8
2024-01-06 09:10:55,571 - ***** Epoch: 30: Eval results *****
2024-01-06 09:10:55,571 -   train_loss = 2.3798
2024-01-06 09:10:55,571 -   best_eval_score = 0.0682
2024-01-06 09:10:55,571 -   eval_score = 0.0599
2024-01-06 09:10:55,571 - EarlyStopping counter: 8 out of 8
2024-01-06 09:10:55,571 - EarlyStopping at epoch 30
2024-01-06 09:10:55,571 - Training is finished...
2024-01-06 09:10:55,572 - Testing begins...
2024-01-06 09:10:58,967 - ***** Test: Confusion Matrix *****
2024-01-06 09:10:58,968 - [[23 11  0  0  2  1  0  0  0  0  0  1 18  0  0  0  1  0  0  0]
 [21  2  0  0  0  0  0  0  0  0  0  0 18  0  0  0  2  0  0  0]
 [10  2  0  0  0  1  0  0  0  0  0  0 14  0  0  0  0  0  0  0]
 [13  2  0  0  1  0  0  0  0  0  0  0  6  0  0  2  1  0  0  0]
 [ 6  2  0  0  0  0  0  0  0  0  0  1 11  0  1  0  1  0  0  1]
 [ 6  2  0  0  0  0  0  0  0  0  0  0  4  0  0  0  0  0  0  0]
 [ 8  1  0  0  0  0  0  0  0  0  0  0  2  0  0  0  1  0  0  0]
 [ 3  1  0  0  0  0  0  0  0  0  0  0  5  0  0  0  1  0  0  0]
 [ 5  0  0  0  0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0]
 [ 5  0  0  0  0  0  0  0  0  0  0  0  5  0  0  0  0  0  0  0]
 [11  1  0  0  0  0  0  0  0  0  0  0  5  0  0  1  0  0  0  0]
 [ 4  1  0  0  0  0  0  0  0  0  0  0 12  0  1  1  0  0  0  0]
 [16  4  0  0  2  0  0  0  0  0  0  0 28  0  3  0  4  0  0  0]
 [11  4  0  0  0  0  0  0  0  0  0  0  9  0  0  0  1  0  0  0]
 [ 8  3  0  0  0  0  0  0  0  0  0  1  9  0  0  0  1  0  0  0]
 [ 8  3  0  1  1  0  0  0  0  0  0  1  5  0  0  1  1  0  0  0]
 [11  1  0  0  1  0  0  0  0  0  0  0  2  0  0  1  0  0  0  1]
 [ 4  3  0  0  0  0  0  0  0  0  0  0  5  0  0  2  0  0  0  1]
 [ 2  1  0  0  0  0  0  0  0  0  0  0  7  1  0  0  0  0  1  0]
 [ 2  2  0  0  0  0  0  0  0  0  0  0  6  0  0  0  0  0  0  0]]
2024-01-06 09:10:58,968 - ***** Evaluation results *****
2024-01-06 09:10:58,968 -   acc = 0.1236
2024-01-06 09:10:58,968 -   f1 = 0.0352
2024-01-06 09:10:58,968 -   prec = 0.0729
2024-01-06 09:10:58,968 -   rec = 0.0536
2024-01-06 09:10:58,968 - Testing is finished...
2024-01-06 09:10:58,968 - Multimodal intent recognition is finished...
2024-01-06 09:10:58,969 - Results are saved in results/msz.csv
