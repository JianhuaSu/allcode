2024-01-02 08:06:28,128 - ============================== Params ==============================
2024-01-02 08:06:28,128 - logger_name: msz_MIntRec_multi-class_seed-0_2024-01-02-08-06-28
2024-01-02 08:06:28,128 - dataset: MIntRec
2024-01-02 08:06:28,128 - data_mode: multi-class
2024-01-02 08:06:28,128 - method: msz
2024-01-02 08:06:28,128 - text_backbone: bert-base-uncased
2024-01-02 08:06:28,129 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-02 08:06:28,129 - seed: 0
2024-01-02 08:06:28,129 - num_workers: 8
2024-01-02 08:06:28,129 - gpu_id: 1
2024-01-02 08:06:28,129 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-02 08:06:28,129 - train: True
2024-01-02 08:06:28,129 - tune: False
2024-01-02 08:06:28,129 - save_model: False
2024-01-02 08:06:28,129 - save_results: True
2024-01-02 08:06:28,129 - log_path: logs
2024-01-02 08:06:28,129 - cache_path: 
2024-01-02 08:06:28,129 - video_data_path: video_data
2024-01-02 08:06:28,129 - audio_data_path: audio_data
2024-01-02 08:06:28,129 - video_feats_path: video_feats.pkl
2024-01-02 08:06:28,129 - audio_feats_path: audio_feats.pkl
2024-01-02 08:06:28,129 - results_path: results
2024-01-02 08:06:28,129 - output_path: /home/sujianhua/Outputs/MIntRec
2024-01-02 08:06:28,129 - model_path: models
2024-01-02 08:06:28,129 - config_file_name: msz
2024-01-02 08:06:28,129 - results_file_name: msz.csv
2024-01-02 08:06:28,129 - padding_mode: zero
2024-01-02 08:06:28,129 - padding_loc: end
2024-01-02 08:06:28,129 - need_aligned: False
2024-01-02 08:06:28,129 - eval_monitor: f1
2024-01-02 08:06:28,129 - train_batch_size: 16
2024-01-02 08:06:28,129 - eval_batch_size: 8
2024-01-02 08:06:28,129 - test_batch_size: 8
2024-01-02 08:06:28,129 - wait_patience: 8
2024-01-02 08:06:28,129 - nheads: 2
2024-01-02 08:06:28,129 - encoder_layers: 2
2024-01-02 08:06:28,129 - attn_dropout: 0.1
2024-01-02 08:06:28,129 - relu_dropout: 0.1
2024-01-02 08:06:28,129 - embed_dropout: 0.1
2024-01-02 08:06:28,129 - res_dropout: 0.1
2024-01-02 08:06:28,129 - attn_mask: False
2024-01-02 08:06:28,129 - hidden_size: 768
2024-01-02 08:06:28,129 - num_attention_heads: 12
2024-01-02 08:06:28,130 - attention_probs_dropout_prob: 0.2
2024-01-02 08:06:28,130 - hidden_dropout_prob: 0.2
2024-01-02 08:06:28,130 - intermediate_size: 768
2024-01-02 08:06:28,130 - num_hidden_layers: 3
2024-01-02 08:06:28,130 - max_position_embeddings: 512
2024-01-02 08:06:28,130 - position_embedding_type: absolute
2024-01-02 08:06:28,130 - batch_first: True
2024-01-02 08:06:28,130 - hidden_dims: 768
2024-01-02 08:06:28,130 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-02 08:06:28,130 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-02 08:06:28,130 - ta_loss: 0.01
2024-01-02 08:06:28,130 - tv_loss: 0.01
2024-01-02 08:06:28,130 - av_loss: 0.01
2024-01-02 08:06:28,130 - aligned_method: conv1d
2024-01-02 08:06:28,130 - grad_clip: 2
2024-01-02 08:06:28,130 - num_train_epochs: 100
2024-01-02 08:06:28,130 - warmup_proportion: 0.1
2024-01-02 08:06:28,130 - lr: 1e-06
2024-01-02 08:06:28,130 - weight_decay: 0.02
2024-01-02 08:06:28,130 - pred_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-0_2024-01-02-08-06-28
2024-01-02 08:06:28,130 - model_output_path: /home/sujianhua/Outputs/MIntRec/msz_MIntRec_multi-class_seed-0_2024-01-02-08-06-28/models
2024-01-02 08:06:28,130 - ============================== End Params ==============================
2024-01-02 08:06:28,133 - Generate Text Features Begin...
2024-01-02 08:06:28,628 - Generate Text Features Finished...
2024-01-02 08:06:28,629 - Load Video Features Begin...
2024-01-02 08:06:28,937 - Load Video Features Finished...
2024-01-02 08:06:29,518 - Load Audio Features Begin...
2024-01-02 08:06:30,451 - Load Audio Features Finished...
2024-01-02 08:06:33,842 - method  begins...
2024-01-02 08:06:36,352 - Multimodal intent recognition begins...
2024-01-02 08:06:36,352 - Training begins...
2024-01-02 08:07:01,416 - ***** Epoch: 1: Eval results *****
2024-01-02 08:07:01,417 -   train_loss = 3.1921
2024-01-02 08:07:01,417 -   best_eval_score = 0.0
2024-01-02 08:07:01,417 -   eval_score = 0.0382
2024-01-02 08:07:26,230 - ***** Epoch: 2: Eval results *****
2024-01-02 08:07:26,230 -   train_loss = 2.9873
2024-01-02 08:07:26,230 -   best_eval_score = 0.0382
2024-01-02 08:07:26,230 -   eval_score = 0.0506
2024-01-02 08:07:49,745 - ***** Epoch: 3: Eval results *****
2024-01-02 08:07:49,745 -   train_loss = 2.8083
2024-01-02 08:07:49,745 -   best_eval_score = 0.0506
2024-01-02 08:07:49,745 -   eval_score = 0.0926
2024-01-02 08:08:12,681 - ***** Epoch: 4: Eval results *****
2024-01-02 08:08:12,682 -   train_loss = 2.6189
2024-01-02 08:08:12,682 -   best_eval_score = 0.0926
2024-01-02 08:08:12,682 -   eval_score = 0.2284
2024-01-02 08:08:35,494 - ***** Epoch: 5: Eval results *****
2024-01-02 08:08:35,495 -   train_loss = 2.3365
2024-01-02 08:08:35,495 -   best_eval_score = 0.2284
2024-01-02 08:08:35,495 -   eval_score = 0.2958
2024-01-02 08:08:58,262 - ***** Epoch: 6: Eval results *****
2024-01-02 08:08:58,262 -   train_loss = 2.0208
2024-01-02 08:08:58,262 -   best_eval_score = 0.2958
2024-01-02 08:08:58,262 -   eval_score = 0.4001
2024-01-02 08:09:21,290 - ***** Epoch: 7: Eval results *****
2024-01-02 08:09:21,290 -   train_loss = 1.6946
2024-01-02 08:09:21,290 -   best_eval_score = 0.4001
2024-01-02 08:09:21,290 -   eval_score = 0.4672
2024-01-02 08:09:44,306 - ***** Epoch: 8: Eval results *****
2024-01-02 08:09:44,306 -   train_loss = 1.3965
2024-01-02 08:09:44,306 -   best_eval_score = 0.4672
2024-01-02 08:09:44,306 -   eval_score = 0.5302
2024-01-02 08:10:07,080 - ***** Epoch: 9: Eval results *****
2024-01-02 08:10:07,080 -   train_loss = 1.1406
2024-01-02 08:10:07,080 -   best_eval_score = 0.5302
2024-01-02 08:10:07,080 -   eval_score = 0.539
2024-01-02 08:10:29,956 - ***** Epoch: 10: Eval results *****
2024-01-02 08:10:29,956 -   train_loss = 0.8954
2024-01-02 08:10:29,956 -   best_eval_score = 0.539
2024-01-02 08:10:29,956 -   eval_score = 0.5737
2024-01-02 08:10:52,645 - ***** Epoch: 11: Eval results *****
2024-01-02 08:10:52,645 -   train_loss = 0.7371
2024-01-02 08:10:52,645 -   best_eval_score = 0.5737
2024-01-02 08:10:52,645 -   eval_score = 0.5972
2024-01-02 08:11:15,735 - ***** Epoch: 12: Eval results *****
2024-01-02 08:11:15,736 -   train_loss = 0.5949
2024-01-02 08:11:15,736 -   best_eval_score = 0.5972
2024-01-02 08:11:15,736 -   eval_score = 0.6102
2024-01-02 08:11:38,437 - ***** Epoch: 13: Eval results *****
2024-01-02 08:11:38,438 -   train_loss = 0.4967
2024-01-02 08:11:38,438 -   best_eval_score = 0.6102
2024-01-02 08:11:38,438 -   eval_score = 0.6357
2024-01-02 08:12:01,212 - ***** Epoch: 14: Eval results *****
2024-01-02 08:12:01,213 -   train_loss = 0.4188
2024-01-02 08:12:01,213 -   best_eval_score = 0.6357
2024-01-02 08:12:01,213 -   eval_score = 0.6198
2024-01-02 08:12:01,213 - EarlyStopping counter: 1 out of 8
2024-01-02 08:12:23,889 - ***** Epoch: 15: Eval results *****
2024-01-02 08:12:23,890 -   train_loss = 0.3196
2024-01-02 08:12:23,890 -   best_eval_score = 0.6357
2024-01-02 08:12:23,890 -   eval_score = 0.6542
2024-01-02 08:12:46,798 - ***** Epoch: 16: Eval results *****
2024-01-02 08:12:46,798 -   train_loss = 0.2462
2024-01-02 08:12:46,798 -   best_eval_score = 0.6542
2024-01-02 08:12:46,798 -   eval_score = 0.6551
2024-01-02 08:13:10,044 - ***** Epoch: 17: Eval results *****
2024-01-02 08:13:10,044 -   train_loss = 0.234
2024-01-02 08:13:10,045 -   best_eval_score = 0.6551
2024-01-02 08:13:10,045 -   eval_score = 0.6575
2024-01-02 08:13:33,039 - ***** Epoch: 18: Eval results *****
2024-01-02 08:13:33,039 -   train_loss = 0.1724
2024-01-02 08:13:33,039 -   best_eval_score = 0.6575
2024-01-02 08:13:33,039 -   eval_score = 0.6537
2024-01-02 08:13:33,039 - EarlyStopping counter: 1 out of 8
2024-01-02 08:13:55,935 - ***** Epoch: 19: Eval results *****
2024-01-02 08:13:55,936 -   train_loss = 0.1415
2024-01-02 08:13:55,936 -   best_eval_score = 0.6575
2024-01-02 08:13:55,936 -   eval_score = 0.6743
2024-01-02 08:14:19,044 - ***** Epoch: 20: Eval results *****
2024-01-02 08:14:19,044 -   train_loss = 0.1111
2024-01-02 08:14:19,044 -   best_eval_score = 0.6743
2024-01-02 08:14:19,044 -   eval_score = 0.6623
2024-01-02 08:14:19,044 - EarlyStopping counter: 1 out of 8
2024-01-02 08:14:41,882 - ***** Epoch: 21: Eval results *****
2024-01-02 08:14:41,882 -   train_loss = 0.093
2024-01-02 08:14:41,882 -   best_eval_score = 0.6743
2024-01-02 08:14:41,882 -   eval_score = 0.6621
2024-01-02 08:14:41,883 - EarlyStopping counter: 2 out of 8
2024-01-02 08:15:04,482 - ***** Epoch: 22: Eval results *****
2024-01-02 08:15:04,482 -   train_loss = 0.0839
2024-01-02 08:15:04,482 -   best_eval_score = 0.6743
2024-01-02 08:15:04,482 -   eval_score = 0.6379
2024-01-02 08:15:04,482 - EarlyStopping counter: 3 out of 8
2024-01-02 08:15:27,503 - ***** Epoch: 23: Eval results *****
2024-01-02 08:15:27,503 -   train_loss = 0.068
2024-01-02 08:15:27,503 -   best_eval_score = 0.6743
2024-01-02 08:15:27,503 -   eval_score = 0.62
2024-01-02 08:15:27,503 - EarlyStopping counter: 4 out of 8
2024-01-02 08:15:50,531 - ***** Epoch: 24: Eval results *****
2024-01-02 08:15:50,531 -   train_loss = 0.0561
2024-01-02 08:15:50,531 -   best_eval_score = 0.6743
2024-01-02 08:15:50,531 -   eval_score = 0.6288
2024-01-02 08:15:50,531 - EarlyStopping counter: 5 out of 8
2024-01-02 08:16:13,519 - ***** Epoch: 25: Eval results *****
2024-01-02 08:16:13,519 -   train_loss = 0.0437
2024-01-02 08:16:13,519 -   best_eval_score = 0.6743
2024-01-02 08:16:13,519 -   eval_score = 0.6291
2024-01-02 08:16:13,519 - EarlyStopping counter: 6 out of 8
2024-01-02 08:16:36,942 - ***** Epoch: 26: Eval results *****
2024-01-02 08:16:36,942 -   train_loss = 0.0379
2024-01-02 08:16:36,942 -   best_eval_score = 0.6743
2024-01-02 08:16:36,942 -   eval_score = 0.6356
2024-01-02 08:16:36,942 - EarlyStopping counter: 7 out of 8
2024-01-02 08:17:00,137 - ***** Epoch: 27: Eval results *****
2024-01-02 08:17:00,137 -   train_loss = 0.0335
2024-01-02 08:17:00,137 -   best_eval_score = 0.6743
2024-01-02 08:17:00,137 -   eval_score = 0.6419
2024-01-02 08:17:00,137 - EarlyStopping counter: 8 out of 8
2024-01-02 08:17:00,137 - EarlyStopping at epoch 27
2024-01-02 08:17:00,139 - Training is finished...
2024-01-02 08:17:00,139 - Testing begins...
2024-01-02 08:17:04,285 - ***** Test: Confusion Matrix *****
2024-01-02 08:17:04,286 - [[28  1  0  0 12  0  2  2  0  3  1  0  7  1  0  0  0  0  0  0]
 [ 0 39  0  0  0  0  0  0  1  0  1  0  1  0  1  0  0  0  0  0]
 [ 1  1 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0 16  0  1  0  0  0  0  1  1  2  1  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  1  0  0  0  0  0]
 [ 0  2  0  0  3  0  3  0  1  0  0  0  2  0  0  0  1  0  0  0]
 [ 3  1  0  0  0  0  0  4  0  0  2  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  4  3  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  0  3  1  0  0  0  0  3  0  2  0  0]
 [ 1  1  0  0  0  0  0  0  0  0 15  0  0  1  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0  1]
 [ 3  2  0  0  1  0  0  0  0  0  0  0 42  1  6  0  2  0  0  0]
 [ 0  1  0  0  1  0  0  0  0  0  1  1  1 16  4  0  0  0  0  0]
 [ 0  0  0  0  1  0  0  0  0  0  0  0  1  1 18  0  0  0  0  1]
 [ 0  1  0  0  1  0  0  0  0  0  0  0  7  0  1 10  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  4  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  1  0  2  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  1  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  1  0  1  1  0  0  0  0  7]]
2024-01-02 08:17:04,286 - ***** Evaluation results *****
2024-01-02 08:17:04,286 -   acc = 0.7011
2024-01-02 08:17:04,286 -   f1 = 0.6728
2024-01-02 08:17:04,286 -   prec = 0.7088
2024-01-02 08:17:04,286 -   rec = 0.6659
2024-01-02 08:17:04,286 - Testing is finished...
2024-01-02 08:17:04,286 - Multimodal intent recognition is finished...
2024-01-02 08:17:04,286 - Results are saved in results/msz.csv
