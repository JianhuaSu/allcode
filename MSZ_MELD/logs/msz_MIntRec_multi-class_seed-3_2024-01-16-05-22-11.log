2024-01-16 05:22:11,831 - ============================== Params ==============================
2024-01-16 05:22:11,831 - logger_name: msz_MIntRec_multi-class_seed-3_2024-01-16-05-22-11
2024-01-16 05:22:11,831 - dataset: MIntRec
2024-01-16 05:22:11,831 - data_mode: multi-class
2024-01-16 05:22:11,831 - method: msz
2024-01-16 05:22:11,831 - text_backbone: bert-base-uncased
2024-01-16 05:22:11,831 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-16 05:22:11,831 - seed: 3
2024-01-16 05:22:11,831 - num_workers: 8
2024-01-16 05:22:11,831 - gpu_id: 1
2024-01-16 05:22:11,831 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-16 05:22:11,831 - train: True
2024-01-16 05:22:11,831 - tune: False
2024-01-16 05:22:11,831 - save_model: False
2024-01-16 05:22:11,831 - save_results: True
2024-01-16 05:22:11,831 - log_path: logs
2024-01-16 05:22:11,831 - cache_path: 
2024-01-16 05:22:11,831 - video_data_path: video_data
2024-01-16 05:22:11,831 - audio_data_path: audio_data
2024-01-16 05:22:11,831 - video_feats_path: video_feats.pkl
2024-01-16 05:22:11,832 - audio_feats_path: audio_feats.pkl
2024-01-16 05:22:11,832 - results_path: results
2024-01-16 05:22:11,832 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-16 05:22:11,832 - model_path: models
2024-01-16 05:22:11,832 - config_file_name: msz
2024-01-16 05:22:11,832 - results_file_name: msz.csv
2024-01-16 05:22:11,832 - padding_mode: zero
2024-01-16 05:22:11,832 - padding_loc: end
2024-01-16 05:22:11,832 - need_aligned: False
2024-01-16 05:22:11,832 - eval_monitor: f1
2024-01-16 05:22:11,832 - train_batch_size: 16
2024-01-16 05:22:11,832 - eval_batch_size: 8
2024-01-16 05:22:11,832 - test_batch_size: 8
2024-01-16 05:22:11,832 - wait_patience: 8
2024-01-16 05:22:11,832 - hidden_size: 768
2024-01-16 05:22:11,832 - num_attention_heads: 12
2024-01-16 05:22:11,832 - attention_probs_dropout_prob: 0.2
2024-01-16 05:22:11,832 - hidden_dropout_prob: 0.2
2024-01-16 05:22:11,832 - intermediate_size: 768
2024-01-16 05:22:11,832 - num_hidden_layers: 8
2024-01-16 05:22:11,832 - max_position_embeddings: 768
2024-01-16 05:22:11,832 - position_embedding_type: absolute
2024-01-16 05:22:11,832 - batch_first: True
2024-01-16 05:22:11,832 - hidden_dims: 768
2024-01-16 05:22:11,832 - dropout: 0.1
2024-01-16 05:22:11,832 - aligned_method: conv1d
2024-01-16 05:22:11,832 - num_train_epochs: 100
2024-01-16 05:22:11,832 - lr: 5e-06
2024-01-16 05:22:11,832 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2024-01-16-05-22-11
2024-01-16 05:22:11,832 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-3_2024-01-16-05-22-11/models
2024-01-16 05:22:11,832 - ============================== End Params ==============================
2024-01-16 05:22:11,835 - Generate Text Features Begin...
2024-01-16 05:22:12,333 - Generate Text Features Finished...
2024-01-16 05:22:12,334 - Load Video Features Begin...
2024-01-16 05:22:12,653 - Load Video Features Finished...
2024-01-16 05:22:13,237 - Load Audio Features Begin...
2024-01-16 05:22:14,226 - Load Audio Features Finished...
2024-01-16 05:22:17,701 - method  begins...
2024-01-16 05:22:21,698 - Multimodal intent recognition begins...
2024-01-16 05:22:21,699 - Training begins...
2024-01-16 05:22:44,168 - ***** Epoch: 1: Eval results *****
2024-01-16 05:22:44,168 -   train_loss = 2.6328
2024-01-16 05:22:44,168 -   best_eval_score = 0.0
2024-01-16 05:22:44,169 -   eval_score = 0.2868
2024-01-16 05:23:04,374 - ***** Epoch: 2: Eval results *****
2024-01-16 05:23:04,375 -   train_loss = 1.7622
2024-01-16 05:23:04,375 -   best_eval_score = 0.2868
2024-01-16 05:23:04,375 -   eval_score = 0.4759
2024-01-16 05:23:25,102 - ***** Epoch: 3: Eval results *****
2024-01-16 05:23:25,102 -   train_loss = 1.1438
2024-01-16 05:23:25,102 -   best_eval_score = 0.4759
2024-01-16 05:23:25,102 -   eval_score = 0.5839
2024-01-16 05:23:45,642 - ***** Epoch: 4: Eval results *****
2024-01-16 05:23:45,643 -   train_loss = 0.746
2024-01-16 05:23:45,643 -   best_eval_score = 0.5839
2024-01-16 05:23:45,643 -   eval_score = 0.6224
2024-01-16 05:24:06,333 - ***** Epoch: 5: Eval results *****
2024-01-16 05:24:06,333 -   train_loss = 0.4702
2024-01-16 05:24:06,334 -   best_eval_score = 0.6224
2024-01-16 05:24:06,334 -   eval_score = 0.6646
2024-01-16 05:24:27,118 - ***** Epoch: 6: Eval results *****
2024-01-16 05:24:27,118 -   train_loss = 0.2902
2024-01-16 05:24:27,118 -   best_eval_score = 0.6646
2024-01-16 05:24:27,118 -   eval_score = 0.6834
2024-01-16 05:24:47,120 - ***** Epoch: 7: Eval results *****
2024-01-16 05:24:47,121 -   train_loss = 0.1747
2024-01-16 05:24:47,121 -   best_eval_score = 0.6834
2024-01-16 05:24:47,121 -   eval_score = 0.6896
2024-01-16 05:25:07,291 - ***** Epoch: 8: Eval results *****
2024-01-16 05:25:07,291 -   train_loss = 0.1172
2024-01-16 05:25:07,292 -   best_eval_score = 0.6896
2024-01-16 05:25:07,292 -   eval_score = 0.6783
2024-01-16 05:25:07,292 - EarlyStopping counter: 1 out of 8
2024-01-16 05:25:27,113 - ***** Epoch: 9: Eval results *****
2024-01-16 05:25:27,113 -   train_loss = 0.0661
2024-01-16 05:25:27,113 -   best_eval_score = 0.6896
2024-01-16 05:25:27,113 -   eval_score = 0.6761
2024-01-16 05:25:27,113 - EarlyStopping counter: 2 out of 8
2024-01-16 05:25:47,947 - ***** Epoch: 10: Eval results *****
2024-01-16 05:25:47,948 -   train_loss = 0.0504
2024-01-16 05:25:47,948 -   best_eval_score = 0.6896
2024-01-16 05:25:47,948 -   eval_score = 0.6944
2024-01-16 05:26:08,259 - ***** Epoch: 11: Eval results *****
2024-01-16 05:26:08,259 -   train_loss = 0.0338
2024-01-16 05:26:08,259 -   best_eval_score = 0.6944
2024-01-16 05:26:08,259 -   eval_score = 0.6771
2024-01-16 05:26:08,259 - EarlyStopping counter: 1 out of 8
2024-01-16 05:26:28,296 - ***** Epoch: 12: Eval results *****
2024-01-16 05:26:28,296 -   train_loss = 0.031
2024-01-16 05:26:28,296 -   best_eval_score = 0.6944
2024-01-16 05:26:28,296 -   eval_score = 0.6856
2024-01-16 05:26:28,296 - EarlyStopping counter: 2 out of 8
2024-01-16 05:26:48,651 - ***** Epoch: 13: Eval results *****
2024-01-16 05:26:48,651 -   train_loss = 0.0271
2024-01-16 05:26:48,651 -   best_eval_score = 0.6944
2024-01-16 05:26:48,651 -   eval_score = 0.6792
2024-01-16 05:26:48,651 - EarlyStopping counter: 3 out of 8
2024-01-16 05:27:09,063 - ***** Epoch: 14: Eval results *****
2024-01-16 05:27:09,063 -   train_loss = 0.025
2024-01-16 05:27:09,063 -   best_eval_score = 0.6944
2024-01-16 05:27:09,063 -   eval_score = 0.6693
2024-01-16 05:27:09,063 - EarlyStopping counter: 4 out of 8
2024-01-16 05:27:29,526 - ***** Epoch: 15: Eval results *****
2024-01-16 05:27:29,526 -   train_loss = 0.0223
2024-01-16 05:27:29,526 -   best_eval_score = 0.6944
2024-01-16 05:27:29,526 -   eval_score = 0.6742
2024-01-16 05:27:29,526 - EarlyStopping counter: 5 out of 8
2024-01-16 05:27:50,160 - ***** Epoch: 16: Eval results *****
2024-01-16 05:27:50,160 -   train_loss = 0.0204
2024-01-16 05:27:50,160 -   best_eval_score = 0.6944
2024-01-16 05:27:50,160 -   eval_score = 0.6796
2024-01-16 05:27:50,160 - EarlyStopping counter: 6 out of 8
2024-01-16 05:28:10,176 - ***** Epoch: 17: Eval results *****
2024-01-16 05:28:10,176 -   train_loss = 0.0195
2024-01-16 05:28:10,176 -   best_eval_score = 0.6944
2024-01-16 05:28:10,176 -   eval_score = 0.6898
2024-01-16 05:28:10,176 - EarlyStopping counter: 7 out of 8
2024-01-16 05:28:30,693 - ***** Epoch: 18: Eval results *****
2024-01-16 05:28:30,694 -   train_loss = 0.0185
2024-01-16 05:28:30,694 -   best_eval_score = 0.6944
2024-01-16 05:28:30,694 -   eval_score = 0.6758
2024-01-16 05:28:30,694 - EarlyStopping counter: 8 out of 8
2024-01-16 05:28:30,694 - EarlyStopping at epoch 18
2024-01-16 05:28:30,697 - Training is finished...
2024-01-16 05:28:30,697 - Testing begins...
2024-01-16 05:28:34,390 - ***** Test: Confusion Matrix *****
2024-01-16 05:28:34,391 - [[39  1  0  0  9  0  0  0  1  3  1  0  2  1  0  0  0  0  0  0]
 [ 0 36  0  1  0  2  1  0  0  0  0  0  2  1  0  0  0  0  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 5  0  0  0 12  0  1  0  0  0  0  1  2  1  0  0  0  1  0  0]
 [ 0  0  0  0  0 12  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  2  0  3  0  3  0  0  0  1  0  1  0  0  0  0  0]
 [ 3  1  0  0  0  0  0  6  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  0  3  4  0  0  0  0  2  0  0  0  0  0  0]
 [ 1  0  0  0  0  0  1  0  0  3  0  0  0  0  0  3  0  1  0  1]
 [ 1  0  0  0  0  0  1  0  0  1 14  0  0  0  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0 17  0  0  0  0  0  0  0  1]
 [ 4  2  0  0  0  0  0  1  0  0  0  2 35  4  3  3  2  0  1  0]
 [ 1  0  0  0  0  0  1  0  0  0  1  1  0 20  1  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  1  2 15  0  2  0  0  1]
 [ 0  0  0  0  0  0  0  1  0  0  0  0  3  0  0 16  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  1  1 14  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  2  0  2  0  0  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0 10  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  0  1  1  0  2  0  0  6]]
2024-01-16 05:28:34,391 - ***** Evaluation results *****
2024-01-16 05:28:34,391 -   acc = 0.7236
2024-01-16 05:28:34,391 -   f1 = 0.6934
2024-01-16 05:28:34,391 -   prec = 0.6934
2024-01-16 05:28:34,391 -   rec = 0.6985
2024-01-16 05:28:34,391 - Testing is finished...
2024-01-16 05:28:34,391 - Multimodal intent recognition is finished...
2024-01-16 05:28:34,391 - Results are saved in results/msz.csv
