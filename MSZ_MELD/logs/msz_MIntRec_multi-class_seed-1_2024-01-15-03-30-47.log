2024-01-15 03:30:47,586 - ============================== Params ==============================
2024-01-15 03:30:47,586 - logger_name: msz_MIntRec_multi-class_seed-1_2024-01-15-03-30-47
2024-01-15 03:30:47,587 - dataset: MIntRec
2024-01-15 03:30:47,587 - data_mode: multi-class
2024-01-15 03:30:47,587 - method: msz
2024-01-15 03:30:47,587 - text_backbone: bert-base-uncased
2024-01-15 03:30:47,587 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-15 03:30:47,587 - seed: 1
2024-01-15 03:30:47,587 - num_workers: 8
2024-01-15 03:30:47,587 - gpu_id: 1
2024-01-15 03:30:47,587 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-15 03:30:47,587 - train: True
2024-01-15 03:30:47,587 - tune: False
2024-01-15 03:30:47,587 - save_model: False
2024-01-15 03:30:47,587 - save_results: True
2024-01-15 03:30:47,587 - log_path: logs
2024-01-15 03:30:47,587 - cache_path: 
2024-01-15 03:30:47,587 - video_data_path: video_data
2024-01-15 03:30:47,587 - audio_data_path: audio_data
2024-01-15 03:30:47,587 - video_feats_path: video_feats.pkl
2024-01-15 03:30:47,587 - audio_feats_path: audio_feats.pkl
2024-01-15 03:30:47,587 - results_path: results
2024-01-15 03:30:47,587 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-15 03:30:47,587 - model_path: models
2024-01-15 03:30:47,587 - config_file_name: msz
2024-01-15 03:30:47,587 - results_file_name: msz.csv
2024-01-15 03:30:47,587 - padding_mode: zero
2024-01-15 03:30:47,587 - padding_loc: end
2024-01-15 03:30:47,587 - need_aligned: False
2024-01-15 03:30:47,587 - eval_monitor: f1
2024-01-15 03:30:47,587 - train_batch_size: 16
2024-01-15 03:30:47,587 - eval_batch_size: 8
2024-01-15 03:30:47,587 - test_batch_size: 8
2024-01-15 03:30:47,587 - wait_patience: 8
2024-01-15 03:30:47,587 - nheads: 12
2024-01-15 03:30:47,588 - encoder_layers: 8
2024-01-15 03:30:47,588 - attn_dropout: 0.2
2024-01-15 03:30:47,588 - relu_dropout: 0.3
2024-01-15 03:30:47,588 - embed_dropout: 0.2
2024-01-15 03:30:47,588 - res_dropout: 0.2
2024-01-15 03:30:47,588 - attn_mask: False
2024-01-15 03:30:47,588 - hidden_size: 768
2024-01-15 03:30:47,588 - num_attention_heads: 12
2024-01-15 03:30:47,588 - attention_probs_dropout_prob: 0.2
2024-01-15 03:30:47,588 - hidden_dropout_prob: 0.2
2024-01-15 03:30:47,588 - intermediate_size: 768
2024-01-15 03:30:47,588 - num_hidden_layers: 8
2024-01-15 03:30:47,588 - max_position_embeddings: 768
2024-01-15 03:30:47,588 - position_embedding_type: absolute
2024-01-15 03:30:47,588 - batch_first: True
2024-01-15 03:30:47,588 - hidden_dims: 768
2024-01-15 03:30:47,588 - dropout: 0.3
2024-01-15 03:30:47,588 - aligned_method: conv1d
2024-01-15 03:30:47,588 - grad_clip: 2
2024-01-15 03:30:47,588 - num_train_epochs: 100
2024-01-15 03:30:47,588 - warmup_proportion: 0.1
2024-01-15 03:30:47,588 - lr: 3e-06
2024-01-15 03:30:47,588 - weight_decay: 0.01
2024-01-15 03:30:47,588 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-15-03-30-47
2024-01-15 03:30:47,588 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-1_2024-01-15-03-30-47/models
2024-01-15 03:30:47,588 - ============================== End Params ==============================
2024-01-15 03:30:47,591 - Generate Text Features Begin...
2024-01-15 03:30:48,084 - Generate Text Features Finished...
2024-01-15 03:30:48,084 - Load Video Features Begin...
2024-01-15 03:30:48,389 - Load Video Features Finished...
2024-01-15 03:30:48,887 - Load Audio Features Begin...
2024-01-15 03:30:49,761 - Load Audio Features Finished...
2024-01-15 03:30:53,769 - method  begins...
2024-01-15 03:30:59,043 - Multimodal intent recognition begins...
2024-01-15 03:30:59,044 - Training begins...
2024-01-15 03:31:17,993 - ***** Epoch: 1: Eval results *****
2024-01-15 03:31:17,993 -   train_loss = 3.0008
2024-01-15 03:31:17,993 -   best_eval_score = 0.0
2024-01-15 03:31:17,993 -   eval_score = 0.0185
2024-01-15 03:31:35,751 - ***** Epoch: 2: Eval results *****
2024-01-15 03:31:35,751 -   train_loss = 2.9897
2024-01-15 03:31:35,751 -   best_eval_score = 0.0185
2024-01-15 03:31:35,751 -   eval_score = 0.0367
2024-01-15 03:31:53,222 - ***** Epoch: 3: Eval results *****
2024-01-15 03:31:53,222 -   train_loss = 2.9667
2024-01-15 03:31:53,222 -   best_eval_score = 0.0367
2024-01-15 03:31:53,222 -   eval_score = 0.0942
2024-01-15 03:32:11,016 - ***** Epoch: 4: Eval results *****
2024-01-15 03:32:11,016 -   train_loss = 2.9241
2024-01-15 03:32:11,016 -   best_eval_score = 0.0942
2024-01-15 03:32:11,016 -   eval_score = 0.097
2024-01-15 03:32:28,358 - ***** Epoch: 5: Eval results *****
2024-01-15 03:32:28,358 -   train_loss = 2.8615
2024-01-15 03:32:28,358 -   best_eval_score = 0.097
2024-01-15 03:32:28,358 -   eval_score = 0.1029
2024-01-15 03:32:46,198 - ***** Epoch: 6: Eval results *****
2024-01-15 03:32:46,199 -   train_loss = 2.7628
2024-01-15 03:32:46,199 -   best_eval_score = 0.1029
2024-01-15 03:32:46,199 -   eval_score = 0.1504
2024-01-15 03:33:03,571 - ***** Epoch: 7: Eval results *****
2024-01-15 03:33:03,571 -   train_loss = 2.5969
2024-01-15 03:33:03,571 -   best_eval_score = 0.1504
2024-01-15 03:33:03,571 -   eval_score = 0.2168
2024-01-15 03:33:21,486 - ***** Epoch: 8: Eval results *****
2024-01-15 03:33:21,486 -   train_loss = 2.306
2024-01-15 03:33:21,486 -   best_eval_score = 0.2168
2024-01-15 03:33:21,487 -   eval_score = 0.266
2024-01-15 03:33:38,907 - ***** Epoch: 9: Eval results *****
2024-01-15 03:33:38,907 -   train_loss = 1.9093
2024-01-15 03:33:38,907 -   best_eval_score = 0.266
2024-01-15 03:33:38,907 -   eval_score = 0.3248
2024-01-15 03:33:56,579 - ***** Epoch: 10: Eval results *****
2024-01-15 03:33:56,580 -   train_loss = 1.5355
2024-01-15 03:33:56,580 -   best_eval_score = 0.3248
2024-01-15 03:33:56,580 -   eval_score = 0.4552
2024-01-15 03:34:14,344 - ***** Epoch: 11: Eval results *****
2024-01-15 03:34:14,344 -   train_loss = 1.2063
2024-01-15 03:34:14,344 -   best_eval_score = 0.4552
2024-01-15 03:34:14,344 -   eval_score = 0.5251
2024-01-15 03:34:32,102 - ***** Epoch: 12: Eval results *****
2024-01-15 03:34:32,102 -   train_loss = 0.9628
2024-01-15 03:34:32,102 -   best_eval_score = 0.5251
2024-01-15 03:34:32,102 -   eval_score = 0.5394
2024-01-15 03:34:49,316 - ***** Epoch: 13: Eval results *****
2024-01-15 03:34:49,316 -   train_loss = 0.7754
2024-01-15 03:34:49,316 -   best_eval_score = 0.5394
2024-01-15 03:34:49,316 -   eval_score = 0.5931
2024-01-15 03:35:07,689 - ***** Epoch: 14: Eval results *****
2024-01-15 03:35:07,689 -   train_loss = 0.628
2024-01-15 03:35:07,689 -   best_eval_score = 0.5931
2024-01-15 03:35:07,689 -   eval_score = 0.6104
2024-01-15 03:35:25,392 - ***** Epoch: 15: Eval results *****
2024-01-15 03:35:25,392 -   train_loss = 0.5087
2024-01-15 03:35:25,392 -   best_eval_score = 0.6104
2024-01-15 03:35:25,392 -   eval_score = 0.61
2024-01-15 03:35:25,392 - EarlyStopping counter: 1 out of 8
2024-01-15 03:35:43,520 - ***** Epoch: 16: Eval results *****
2024-01-15 03:35:43,520 -   train_loss = 0.4273
2024-01-15 03:35:43,520 -   best_eval_score = 0.6104
2024-01-15 03:35:43,520 -   eval_score = 0.6287
2024-01-15 03:36:00,958 - ***** Epoch: 17: Eval results *****
2024-01-15 03:36:00,958 -   train_loss = 0.3572
2024-01-15 03:36:00,958 -   best_eval_score = 0.6287
2024-01-15 03:36:00,958 -   eval_score = 0.6256
2024-01-15 03:36:00,958 - EarlyStopping counter: 1 out of 8
2024-01-15 03:36:18,618 - ***** Epoch: 18: Eval results *****
2024-01-15 03:36:18,618 -   train_loss = 0.2938
2024-01-15 03:36:18,618 -   best_eval_score = 0.6287
2024-01-15 03:36:18,618 -   eval_score = 0.623
2024-01-15 03:36:18,618 - EarlyStopping counter: 2 out of 8
2024-01-15 03:36:36,038 - ***** Epoch: 19: Eval results *****
2024-01-15 03:36:36,038 -   train_loss = 0.2415
2024-01-15 03:36:36,038 -   best_eval_score = 0.6287
2024-01-15 03:36:36,038 -   eval_score = 0.6352
2024-01-15 03:36:53,648 - ***** Epoch: 20: Eval results *****
2024-01-15 03:36:53,648 -   train_loss = 0.2034
2024-01-15 03:36:53,648 -   best_eval_score = 0.6352
2024-01-15 03:36:53,648 -   eval_score = 0.6467
2024-01-15 03:37:11,213 - ***** Epoch: 21: Eval results *****
2024-01-15 03:37:11,213 -   train_loss = 0.1815
2024-01-15 03:37:11,213 -   best_eval_score = 0.6467
2024-01-15 03:37:11,213 -   eval_score = 0.6472
2024-01-15 03:37:29,109 - ***** Epoch: 22: Eval results *****
2024-01-15 03:37:29,110 -   train_loss = 0.151
2024-01-15 03:37:29,110 -   best_eval_score = 0.6472
2024-01-15 03:37:29,110 -   eval_score = 0.6531
2024-01-15 03:37:46,462 - ***** Epoch: 23: Eval results *****
2024-01-15 03:37:46,462 -   train_loss = 0.1309
2024-01-15 03:37:46,462 -   best_eval_score = 0.6531
2024-01-15 03:37:46,462 -   eval_score = 0.647
2024-01-15 03:37:46,462 - EarlyStopping counter: 1 out of 8
2024-01-15 03:38:04,328 - ***** Epoch: 24: Eval results *****
2024-01-15 03:38:04,328 -   train_loss = 0.1139
2024-01-15 03:38:04,328 -   best_eval_score = 0.6531
2024-01-15 03:38:04,328 -   eval_score = 0.6613
2024-01-15 03:38:21,836 - ***** Epoch: 25: Eval results *****
2024-01-15 03:38:21,837 -   train_loss = 0.0961
2024-01-15 03:38:21,837 -   best_eval_score = 0.6613
2024-01-15 03:38:21,837 -   eval_score = 0.6475
2024-01-15 03:38:21,837 - EarlyStopping counter: 1 out of 8
2024-01-15 03:38:39,459 - ***** Epoch: 26: Eval results *****
2024-01-15 03:38:39,459 -   train_loss = 0.0937
2024-01-15 03:38:39,460 -   best_eval_score = 0.6613
2024-01-15 03:38:39,460 -   eval_score = 0.6528
2024-01-15 03:38:39,460 - EarlyStopping counter: 2 out of 8
2024-01-15 03:38:56,820 - ***** Epoch: 27: Eval results *****
2024-01-15 03:38:56,821 -   train_loss = 0.0775
2024-01-15 03:38:56,821 -   best_eval_score = 0.6613
2024-01-15 03:38:56,821 -   eval_score = 0.6538
2024-01-15 03:38:56,821 - EarlyStopping counter: 3 out of 8
2024-01-15 03:39:14,641 - ***** Epoch: 28: Eval results *****
2024-01-15 03:39:14,642 -   train_loss = 0.0763
2024-01-15 03:39:14,642 -   best_eval_score = 0.6613
2024-01-15 03:39:14,642 -   eval_score = 0.6486
2024-01-15 03:39:14,642 - EarlyStopping counter: 4 out of 8
2024-01-15 03:39:31,875 - ***** Epoch: 29: Eval results *****
2024-01-15 03:39:31,875 -   train_loss = 0.0693
2024-01-15 03:39:31,875 -   best_eval_score = 0.6613
2024-01-15 03:39:31,875 -   eval_score = 0.6583
2024-01-15 03:39:31,875 - EarlyStopping counter: 5 out of 8
2024-01-15 03:39:50,039 - ***** Epoch: 30: Eval results *****
2024-01-15 03:39:50,039 -   train_loss = 0.059
2024-01-15 03:39:50,039 -   best_eval_score = 0.6613
2024-01-15 03:39:50,039 -   eval_score = 0.6512
2024-01-15 03:39:50,039 - EarlyStopping counter: 6 out of 8
2024-01-15 03:40:07,259 - ***** Epoch: 31: Eval results *****
2024-01-15 03:40:07,259 -   train_loss = 0.0496
2024-01-15 03:40:07,259 -   best_eval_score = 0.6613
2024-01-15 03:40:07,259 -   eval_score = 0.6529
2024-01-15 03:40:07,259 - EarlyStopping counter: 7 out of 8
2024-01-15 03:40:24,965 - ***** Epoch: 32: Eval results *****
2024-01-15 03:40:24,965 -   train_loss = 0.0486
2024-01-15 03:40:24,965 -   best_eval_score = 0.6613
2024-01-15 03:40:24,966 -   eval_score = 0.6578
2024-01-15 03:40:24,966 - EarlyStopping counter: 8 out of 8
2024-01-15 03:40:24,966 - EarlyStopping at epoch 32
2024-01-15 03:40:24,968 - Training is finished...
2024-01-15 03:40:24,968 - Testing begins...
2024-01-15 03:40:27,742 - ***** Test: Confusion Matrix *****
2024-01-15 03:40:27,743 - [[36  2  0  0 10  0  0  1  0  2  1  0  3  2  0  0  0  0  0  0]
 [ 0 37  0  1  0  1  0  0  0  0  0  0  2  1  0  0  0  1  0  0]
 [ 1  0 26  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 0  0  0 25  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 5  0  0  0 12  0  2  0  0  0  0  1  1  1  0  0  0  1  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 1  1  0  0  4  0  0  0  3  0  0  0  1  0  1  1  0  0  0  0]
 [ 2  0  0  0  0  1  0  3  1  0  1  0  0  0  0  2  0  0  0  0]
 [ 1  0  0  0  0  0  2  3  2  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  0  0  0  1  0  0  0  0  3  1  0  0  0  0  3  0  1  0  0]
 [ 1  0  0  0  0  0  0  0  0  1 14  0  0  0  1  0  1  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 18  0  0  0  0  0  0  0  1]
 [ 2  2  0  0  0  1  0  1  0  0  0  1 40  2  3  3  2  0  0  0]
 [ 0  1  0  0  0  0  2  0  0  0  1  1  0 18  2  0  0  0  0  0]
 [ 0  0  0  0  0  0  1  0  0  0  0  0  3  1 14  0  1  0  0  2]
 [ 0  0  0  0  0  0  0  1  1  0  0  0  4  0  0 14  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  2  0  0  0 15  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  0  1  2  0  0 10  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  3  0  0  1  0  0  8  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  1  2  0  2  0  0  4]]
2024-01-15 03:40:27,743 - ***** Evaluation results *****
2024-01-15 03:40:27,743 -   acc = 0.6966
2024-01-15 03:40:27,743 -   f1 = 0.6339
2024-01-15 03:40:27,743 -   prec = 0.6395
2024-01-15 03:40:27,743 -   rec = 0.638
2024-01-15 03:40:27,743 - Testing is finished...
2024-01-15 03:40:27,743 - Multimodal intent recognition is finished...
2024-01-15 03:40:27,743 - Results are saved in results/msz.csv
