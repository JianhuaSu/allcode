2024-01-04 13:32:28,383 - ============================== Params ==============================
2024-01-04 13:32:28,383 - logger_name: msz_MIntRec_multi-class_seed-0_2024-01-04-13-32-28
2024-01-04 13:32:28,383 - dataset: MIntRec
2024-01-04 13:32:28,383 - data_mode: multi-class
2024-01-04 13:32:28,383 - method: msz
2024-01-04 13:32:28,383 - text_backbone: bert-base-uncased
2024-01-04 13:32:28,383 - text_backbone_path: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-01-04 13:32:28,383 - seed: 0
2024-01-04 13:32:28,383 - num_workers: 8
2024-01-04 13:32:28,383 - gpu_id: 1
2024-01-04 13:32:28,384 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-01-04 13:32:28,384 - train: True
2024-01-04 13:32:28,384 - tune: False
2024-01-04 13:32:28,384 - save_model: False
2024-01-04 13:32:28,384 - save_results: True
2024-01-04 13:32:28,384 - log_path: logs
2024-01-04 13:32:28,384 - cache_path: 
2024-01-04 13:32:28,384 - video_data_path: video_data
2024-01-04 13:32:28,384 - audio_data_path: audio_data
2024-01-04 13:32:28,384 - video_feats_path: video_feats.pkl
2024-01-04 13:32:28,384 - audio_feats_path: audio_feats.pkl
2024-01-04 13:32:28,384 - results_path: results
2024-01-04 13:32:28,384 - output_path: /home/sharing/disk2/sjh/Outputs/MIntRec
2024-01-04 13:32:28,384 - model_path: models
2024-01-04 13:32:28,384 - config_file_name: msz
2024-01-04 13:32:28,384 - results_file_name: msz.csv
2024-01-04 13:32:28,384 - padding_mode: zero
2024-01-04 13:32:28,384 - padding_loc: end
2024-01-04 13:32:28,384 - need_aligned: False
2024-01-04 13:32:28,384 - eval_monitor: f1
2024-01-04 13:32:28,384 - train_batch_size: 16
2024-01-04 13:32:28,384 - eval_batch_size: 8
2024-01-04 13:32:28,384 - test_batch_size: 8
2024-01-04 13:32:28,385 - wait_patience: 8
2024-01-04 13:32:28,385 - nheads: 2
2024-01-04 13:32:28,385 - encoder_layers: 2
2024-01-04 13:32:28,385 - attn_dropout: 0.1
2024-01-04 13:32:28,385 - relu_dropout: 0.1
2024-01-04 13:32:28,385 - embed_dropout: 0.1
2024-01-04 13:32:28,385 - res_dropout: 0.1
2024-01-04 13:32:28,385 - attn_mask: False
2024-01-04 13:32:28,385 - hidden_size: 768
2024-01-04 13:32:28,385 - num_attention_heads: 12
2024-01-04 13:32:28,385 - attention_probs_dropout_prob: 0.2
2024-01-04 13:32:28,385 - hidden_dropout_prob: 0.2
2024-01-04 13:32:28,385 - intermediate_size: 768
2024-01-04 13:32:28,385 - num_hidden_layers: 3
2024-01-04 13:32:28,385 - max_position_embeddings: 512
2024-01-04 13:32:28,385 - position_embedding_type: absolute
2024-01-04 13:32:28,385 - batch_first: True
2024-01-04 13:32:28,385 - hidden_dims: 768
2024-01-04 13:32:28,385 - att_dropouts: [0.2, 0.2, 0.2]
2024-01-04 13:32:28,385 - spe_dropouts: [0.1, 0.1, 0.1]
2024-01-04 13:32:28,385 - ta_loss: 0.1
2024-01-04 13:32:28,385 - tv_loss: 0.1
2024-01-04 13:32:28,386 - av_loss: 0.1
2024-01-04 13:32:28,386 - aligned_method: conv1d
2024-01-04 13:32:28,386 - grad_clip: -1
2024-01-04 13:32:28,386 - num_train_epochs: 100
2024-01-04 13:32:28,386 - warmup_proportion: 0.1
2024-01-04 13:32:28,386 - lr: 1e-06
2024-01-04 13:32:28,386 - weight_decay: 0.01
2024-01-04 13:32:28,386 - pred_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-0_2024-01-04-13-32-28
2024-01-04 13:32:28,386 - model_output_path: /home/sharing/disk2/sjh/Outputs/MIntRec/msz_MIntRec_multi-class_seed-0_2024-01-04-13-32-28/models
2024-01-04 13:32:28,386 - ============================== End Params ==============================
2024-01-04 13:32:28,833 - Generate Text Features Begin...
2024-01-04 13:32:29,770 - Generate Text Features Finished...
2024-01-04 13:32:29,770 - Load Video Features Begin...
2024-01-04 13:33:24,592 - Load Video Features Finished...
2024-01-04 13:33:25,317 - Load Audio Features Begin...
2024-01-04 13:36:49,133 - Load Audio Features Finished...
2024-01-04 13:36:53,815 - method  begins...
2024-01-04 13:37:04,614 - Multimodal intent recognition begins...
2024-01-04 13:37:04,614 - Training begins...
2024-01-04 13:37:29,978 - ***** Epoch: 1: Eval results *****
2024-01-04 13:37:29,978 -   train_loss = 2.993
2024-01-04 13:37:29,978 -   best_eval_score = 0.0
2024-01-04 13:37:29,978 -   eval_score = 0.0494
2024-01-04 13:37:52,210 - ***** Epoch: 2: Eval results *****
2024-01-04 13:37:52,210 -   train_loss = 2.9596
2024-01-04 13:37:52,210 -   best_eval_score = 0.0494
2024-01-04 13:37:52,210 -   eval_score = 0.0577
2024-01-04 13:38:14,967 - ***** Epoch: 3: Eval results *****
2024-01-04 13:38:14,968 -   train_loss = 2.9022
2024-01-04 13:38:14,968 -   best_eval_score = 0.0577
2024-01-04 13:38:14,968 -   eval_score = 0.0455
2024-01-04 13:38:14,968 - EarlyStopping counter: 1 out of 8
2024-01-04 13:38:37,303 - ***** Epoch: 4: Eval results *****
2024-01-04 13:38:37,303 -   train_loss = 2.8025
2024-01-04 13:38:37,303 -   best_eval_score = 0.0577
2024-01-04 13:38:37,303 -   eval_score = 0.1105
2024-01-04 13:38:59,773 - ***** Epoch: 5: Eval results *****
2024-01-04 13:38:59,773 -   train_loss = 2.6268
2024-01-04 13:38:59,773 -   best_eval_score = 0.1105
2024-01-04 13:38:59,773 -   eval_score = 0.186
2024-01-04 13:39:22,362 - ***** Epoch: 6: Eval results *****
2024-01-04 13:39:22,363 -   train_loss = 2.3488
2024-01-04 13:39:22,363 -   best_eval_score = 0.186
2024-01-04 13:39:22,363 -   eval_score = 0.2163
2024-01-04 13:39:45,009 - ***** Epoch: 7: Eval results *****
2024-01-04 13:39:45,009 -   train_loss = 1.9748
2024-01-04 13:39:45,010 -   best_eval_score = 0.2163
2024-01-04 13:39:45,010 -   eval_score = 0.2929
2024-01-04 13:40:07,351 - ***** Epoch: 8: Eval results *****
2024-01-04 13:40:07,351 -   train_loss = 1.5846
2024-01-04 13:40:07,352 -   best_eval_score = 0.2929
2024-01-04 13:40:07,352 -   eval_score = 0.4105
2024-01-04 13:40:29,895 - ***** Epoch: 9: Eval results *****
2024-01-04 13:40:29,895 -   train_loss = 1.227
2024-01-04 13:40:29,896 -   best_eval_score = 0.4105
2024-01-04 13:40:29,896 -   eval_score = 0.4803
2024-01-04 13:40:52,929 - ***** Epoch: 10: Eval results *****
2024-01-04 13:40:52,929 -   train_loss = 0.9251
2024-01-04 13:40:52,929 -   best_eval_score = 0.4803
2024-01-04 13:40:52,929 -   eval_score = 0.5093
2024-01-04 13:41:15,571 - ***** Epoch: 11: Eval results *****
2024-01-04 13:41:15,571 -   train_loss = 0.7364
2024-01-04 13:41:15,571 -   best_eval_score = 0.5093
2024-01-04 13:41:15,571 -   eval_score = 0.55
2024-01-04 13:41:38,081 - ***** Epoch: 12: Eval results *****
2024-01-04 13:41:38,081 -   train_loss = 0.5289
2024-01-04 13:41:38,081 -   best_eval_score = 0.55
2024-01-04 13:41:38,081 -   eval_score = 0.5374
2024-01-04 13:41:38,081 - EarlyStopping counter: 1 out of 8
2024-01-04 13:42:00,599 - ***** Epoch: 13: Eval results *****
2024-01-04 13:42:00,599 -   train_loss = 0.4409
2024-01-04 13:42:00,600 -   best_eval_score = 0.55
2024-01-04 13:42:00,600 -   eval_score = 0.5866
2024-01-04 13:42:23,050 - ***** Epoch: 14: Eval results *****
2024-01-04 13:42:23,050 -   train_loss = 0.3021
2024-01-04 13:42:23,050 -   best_eval_score = 0.5866
2024-01-04 13:42:23,050 -   eval_score = 0.5886
2024-01-04 13:42:45,222 - ***** Epoch: 15: Eval results *****
2024-01-04 13:42:45,222 -   train_loss = 0.2445
2024-01-04 13:42:45,222 -   best_eval_score = 0.5886
2024-01-04 13:42:45,222 -   eval_score = 0.5909
2024-01-04 13:43:07,871 - ***** Epoch: 16: Eval results *****
2024-01-04 13:43:07,872 -   train_loss = 0.2011
2024-01-04 13:43:07,872 -   best_eval_score = 0.5909
2024-01-04 13:43:07,872 -   eval_score = 0.6167
2024-01-04 13:43:30,314 - ***** Epoch: 17: Eval results *****
2024-01-04 13:43:30,314 -   train_loss = 0.1366
2024-01-04 13:43:30,314 -   best_eval_score = 0.6167
2024-01-04 13:43:30,314 -   eval_score = 0.648
2024-01-04 13:43:53,047 - ***** Epoch: 18: Eval results *****
2024-01-04 13:43:53,048 -   train_loss = 0.1035
2024-01-04 13:43:53,048 -   best_eval_score = 0.648
2024-01-04 13:43:53,048 -   eval_score = 0.6484
2024-01-04 13:44:15,750 - ***** Epoch: 19: Eval results *****
2024-01-04 13:44:15,750 -   train_loss = 0.0802
2024-01-04 13:44:15,750 -   best_eval_score = 0.6484
2024-01-04 13:44:15,750 -   eval_score = 0.6371
2024-01-04 13:44:15,750 - EarlyStopping counter: 1 out of 8
2024-01-04 13:44:37,759 - ***** Epoch: 20: Eval results *****
2024-01-04 13:44:37,760 -   train_loss = 0.0569
2024-01-04 13:44:37,760 -   best_eval_score = 0.6484
2024-01-04 13:44:37,760 -   eval_score = 0.6208
2024-01-04 13:44:37,760 - EarlyStopping counter: 2 out of 8
2024-01-04 13:45:01,156 - ***** Epoch: 21: Eval results *****
2024-01-04 13:45:01,156 -   train_loss = 0.0293
2024-01-04 13:45:01,156 -   best_eval_score = 0.6484
2024-01-04 13:45:01,156 -   eval_score = 0.6608
2024-01-04 13:45:24,573 - ***** Epoch: 22: Eval results *****
2024-01-04 13:45:24,573 -   train_loss = 0.0252
2024-01-04 13:45:24,573 -   best_eval_score = 0.6608
2024-01-04 13:45:24,573 -   eval_score = 0.6587
2024-01-04 13:45:24,573 - EarlyStopping counter: 1 out of 8
2024-01-04 13:45:48,588 - ***** Epoch: 23: Eval results *****
2024-01-04 13:45:48,588 -   train_loss = 0.0192
2024-01-04 13:45:48,588 -   best_eval_score = 0.6608
2024-01-04 13:45:48,588 -   eval_score = 0.6477
2024-01-04 13:45:48,588 - EarlyStopping counter: 2 out of 8
2024-01-04 13:46:12,291 - ***** Epoch: 24: Eval results *****
2024-01-04 13:46:12,292 -   train_loss = 0.0192
2024-01-04 13:46:12,292 -   best_eval_score = 0.6608
2024-01-04 13:46:12,292 -   eval_score = 0.6446
2024-01-04 13:46:12,292 - EarlyStopping counter: 3 out of 8
2024-01-04 13:46:36,135 - ***** Epoch: 25: Eval results *****
2024-01-04 13:46:36,135 -   train_loss = 0.0127
2024-01-04 13:46:36,136 -   best_eval_score = 0.6608
2024-01-04 13:46:36,136 -   eval_score = 0.6173
2024-01-04 13:46:36,136 - EarlyStopping counter: 4 out of 8
2024-01-04 13:46:58,869 - ***** Epoch: 26: Eval results *****
2024-01-04 13:46:58,869 -   train_loss = 0.0093
2024-01-04 13:46:58,869 -   best_eval_score = 0.6608
2024-01-04 13:46:58,869 -   eval_score = 0.6237
2024-01-04 13:46:58,869 - EarlyStopping counter: 5 out of 8
2024-01-04 13:47:21,219 - ***** Epoch: 27: Eval results *****
2024-01-04 13:47:21,219 -   train_loss = 0.0054
2024-01-04 13:47:21,219 -   best_eval_score = 0.6608
2024-01-04 13:47:21,219 -   eval_score = 0.6251
2024-01-04 13:47:21,219 - EarlyStopping counter: 6 out of 8
2024-01-04 13:47:43,852 - ***** Epoch: 28: Eval results *****
2024-01-04 13:47:43,852 -   train_loss = 0.0082
2024-01-04 13:47:43,852 -   best_eval_score = 0.6608
2024-01-04 13:47:43,852 -   eval_score = 0.6157
2024-01-04 13:47:43,852 - EarlyStopping counter: 7 out of 8
2024-01-04 13:48:06,340 - ***** Epoch: 29: Eval results *****
2024-01-04 13:48:06,341 -   train_loss = 0.0061
2024-01-04 13:48:06,341 -   best_eval_score = 0.6608
2024-01-04 13:48:06,341 -   eval_score = 0.5944
2024-01-04 13:48:06,341 - EarlyStopping counter: 8 out of 8
2024-01-04 13:48:06,341 - EarlyStopping at epoch 29
2024-01-04 13:48:06,343 - Training is finished...
2024-01-04 13:48:06,344 - Testing begins...
2024-01-04 13:48:10,781 - ***** Test: Confusion Matrix *****
2024-01-04 13:48:10,782 - [[27  3  0  0  8  0  2  2  2  4  1  0  7  1  0  0  0  0  0  0]
 [ 0 38  0  1  0  1  2  0  0  0  0  0  1  0  0  0  0  0  0  0]
 [ 1  0 25  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0]
 [ 0  1  0 24  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0]
 [ 3  0  0  0 13  0  1  0  0  0  0  1  2  2  1  0  0  0  0  0]
 [ 0  0  0  0  0 11  0  0  0  0  0  0  0  0  1  0  0  0  0  0]
 [ 2  1  0  0  2  0  2  0  1  0  0  1  1  0  0  2  0  0  0  0]
 [ 3  0  0  0  0  0  0  5  0  1  1  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  5  3  0  0  0  0  1  0  1  0  0  0  0]
 [ 1  0  0  0  0  0  0  0  1  2  1  0  0  0  0  3  0  2  0  0]
 [ 0  0  0  0  0  0  1  1  0  3 13  0  0  0  0  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0 16  1  0  0  0  0  0  1  1]
 [ 3  0  1  1  1  0  1  1  0  0  1  0 42  0  3  2  1  0  0  0]
 [ 1  1  0  0  0  0  3  0  0  0  0  1  2 14  3  0  0  0  0  0]
 [ 0  0  0  0  0  0  0  0  1  0  0  0  1  2 16  0  1  0  0  1]
 [ 0  1  0  0  0  0  0  0  0  0  0  0  3  0  1 15  0  0  0  1]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  4  0  2  0 11  0  0  0]
 [ 0  0  0  0  0  0  0  0  0  1  1  0  1  0  1  0  0 11  0  0]
 [ 0  0  0  0  0  0  0  0  0  0  0  0  1  0  0  1  0  0 10  0]
 [ 1  0  0  0  0  0  0  0  0  0  0  0  2  1  2  0  0  0  0  4]]
2024-01-04 13:48:10,782 - ***** Evaluation results *****
2024-01-04 13:48:10,782 -   acc = 0.6787
2024-01-04 13:48:10,782 -   f1 = 0.6419
2024-01-04 13:48:10,782 -   prec = 0.6526
2024-01-04 13:48:10,782 -   rec = 0.6404
2024-01-04 13:48:10,782 - Testing is finished...
2024-01-04 13:48:10,782 - Multimodal intent recognition is finished...
2024-01-04 13:48:10,782 - Results are saved in results/msz.csv
