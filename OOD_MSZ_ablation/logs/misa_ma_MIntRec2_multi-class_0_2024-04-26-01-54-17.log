2024-04-26 01:54:17,655 - Lists of intent labels are: ['Acknowledge', 'Advise', 'Agree', 'Apologise', 'Arrange', 'Ask for help', 'Asking for opinions', 'Care', 'Comfort', 'Complain', 'Confirm', 'Criticize', 'Doubt', 'Emphasize', 'Explain', 'Flaunt', 'Greet', 'Inform', 'Introduce', 'Invite', 'Joke', 'Leave', 'Oppose', 'Plan', 'Praise', 'Prevent', 'Refuse', 'Taunt', 'Thank', 'Warn']
2024-04-26 01:54:17,656 - ID Data preparation...
2024-04-26 01:54:38,029 - OOD Data preparation...
2024-04-26 01:54:42,707 - ============================== Params ==============================
2024-04-26 01:54:42,708 - logger_name: misa_ma_MIntRec2_multi-class_0
2024-04-26 01:54:42,708 - dataset: MIntRec2
2024-04-26 01:54:42,708 - ood_dataset: MIntRec2-OOD
2024-04-26 01:54:42,708 - data_mode: multi-class
2024-04-26 01:54:42,708 - multimodal_method: misa
2024-04-26 01:54:42,708 - method: misa
2024-04-26 01:54:42,708 - ood_detection_method: ma
2024-04-26 01:54:42,708 - text_backbone: bert-base-uncased
2024-04-26 01:54:42,708 - seed: 0
2024-04-26 01:54:42,708 - num_workers: 8
2024-04-26 01:54:42,708 - log_id: misa_ma_MIntRec2_multi-class_0_2024-04-26-01-54-17
2024-04-26 01:54:42,708 - gpu_id: 3
2024-04-26 01:54:42,708 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-26 01:54:42,708 - train: True
2024-04-26 01:54:42,708 - tune: True
2024-04-26 01:54:42,708 - ood: True
2024-04-26 01:54:42,708 - save_model: False
2024-04-26 01:54:42,708 - save_results: True
2024-04-26 01:54:42,708 - log_path: logs
2024-04-26 01:54:42,708 - cache_path: cache
2024-04-26 01:54:42,708 - video_data_path: video_data
2024-04-26 01:54:42,708 - audio_data_path: audio_data
2024-04-26 01:54:42,708 - video_feats_path: swin_feats.pkl
2024-04-26 01:54:42,708 - ood_video_feats_path: swin_feats.pkl
2024-04-26 01:54:42,708 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-26 01:54:42,708 - audio_feats_path: wavlm_feats.pkl
2024-04-26 01:54:42,708 - results_path: results
2024-04-26 01:54:42,708 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/misa
2024-04-26 01:54:42,708 - model_path: models
2024-04-26 01:54:42,708 - config_file_name: misa_MIntRec2
2024-04-26 01:54:42,708 - results_file_name: results_misa_MIntRec2.csv
2024-04-26 01:54:42,708 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-26 01:54:42,708 - text_seq_len: 50
2024-04-26 01:54:42,708 - video_seq_len: 180
2024-04-26 01:54:42,708 - audio_seq_len: 400
2024-04-26 01:54:42,708 - text_feat_dim: 768
2024-04-26 01:54:42,708 - video_feat_dim: 256
2024-04-26 01:54:42,708 - audio_feat_dim: 768
2024-04-26 01:54:42,708 - ood_label_id: 30
2024-04-26 01:54:42,708 - num_labels: 30
2024-04-26 01:54:42,708 - num_train_examples: 6165
2024-04-26 01:54:42,708 - padding_mode: zero
2024-04-26 01:54:42,708 - padding_loc: end
2024-04-26 01:54:42,708 - need_aligned: False
2024-04-26 01:54:42,708 - eval_monitor: acc
2024-04-26 01:54:42,709 - train_batch_size: 32
2024-04-26 01:54:42,709 - eval_batch_size: 16
2024-04-26 01:54:42,709 - test_batch_size: 16
2024-04-26 01:54:42,709 - wait_patience: 5
2024-04-26 01:54:42,709 - num_train_epochs: 100
2024-04-26 01:54:42,709 - rnncell: lstm
2024-04-26 01:54:42,709 - use_cmd_sim: False
2024-04-26 01:54:42,709 - reverse_grad_weight: [0.8]
2024-04-26 01:54:42,709 - hidden_size: [768, 256]
2024-04-26 01:54:42,709 - dropout_rate: [0.2, 0.1]
2024-04-26 01:54:42,709 - diff_weight: [0.5, 0.7]
2024-04-26 01:54:42,709 - sim_weight: [0.3, 0.7]
2024-04-26 01:54:42,709 - recon_weight: [0.3, 0.6]
2024-04-26 01:54:42,709 - lr: [2e-05, 3e-05]
2024-04-26 01:54:42,709 - grad_clip: -1.0
2024-04-26 01:54:42,709 - gamma: 0.5
2024-04-26 01:54:42,709 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/misa/misa_MIntRec2_bert-base-uncased_multi-class_0
2024-04-26 01:54:42,709 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/misa/misa_MIntRec2_bert-base-uncased_multi-class_0/models
2024-04-26 01:54:42,709 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/misa/binary_misa_MIntRec2_bert-base-uncased_0
2024-04-26 01:54:42,709 - ============================== End Params ==============================
2024-04-26 01:54:46,696 - Multimodal Intent Recognition begins...
2024-04-26 01:54:46,696 - Training begins...
2024-04-26 01:55:49,042 - ***** Epoch: 1: Eval results *****
2024-04-26 01:55:49,043 -   best_eval_score = 0.0
2024-04-26 01:55:49,043 -   eval_score = 0.5244
2024-04-26 01:55:49,043 -   train_loss = 2.7531
2024-04-26 01:56:41,730 - ***** Epoch: 2: Eval results *****
2024-04-26 01:56:41,731 -   best_eval_score = 0.5244
2024-04-26 01:56:41,731 -   eval_score = 0.5579
2024-04-26 01:56:41,731 -   train_loss = 1.6781
2024-04-26 01:57:42,405 - ***** Epoch: 3: Eval results *****
2024-04-26 01:57:42,405 -   best_eval_score = 0.5579
2024-04-26 01:57:42,405 -   eval_score = 0.5633
2024-04-26 01:57:42,405 -   train_loss = 1.3552
2024-04-26 01:58:42,740 - ***** Epoch: 4: Eval results *****
2024-04-26 01:58:42,741 -   best_eval_score = 0.5633
2024-04-26 01:58:42,741 -   eval_score = 0.5633
2024-04-26 01:58:42,741 -   train_loss = 1.0149
2024-04-26 01:58:42,741 - EarlyStopping counter: 1 out of 5
2024-04-26 01:59:43,314 - ***** Epoch: 5: Eval results *****
2024-04-26 01:59:43,314 -   best_eval_score = 0.5633
2024-04-26 01:59:43,314 -   eval_score = 0.5859
2024-04-26 01:59:43,314 -   train_loss = 0.6987
2024-04-26 02:00:44,165 - ***** Epoch: 6: Eval results *****
2024-04-26 02:00:44,165 -   best_eval_score = 0.5859
2024-04-26 02:00:44,165 -   eval_score = 0.6022
2024-04-26 02:00:44,165 -   train_loss = 0.6002
2024-04-26 02:01:45,459 - ***** Epoch: 7: Eval results *****
2024-04-26 02:01:45,460 -   best_eval_score = 0.6022
2024-04-26 02:01:45,460 -   eval_score = 0.5778
2024-04-26 02:01:45,460 -   train_loss = 0.5344
2024-04-26 02:01:45,460 - EarlyStopping counter: 1 out of 5
2024-04-26 02:02:46,324 - ***** Epoch: 8: Eval results *****
2024-04-26 02:02:46,324 -   best_eval_score = 0.6022
2024-04-26 02:02:46,324 -   eval_score = 0.5886
2024-04-26 02:02:46,324 -   train_loss = 0.4819
2024-04-26 02:02:46,324 - EarlyStopping counter: 2 out of 5
2024-04-26 02:03:46,339 - ***** Epoch: 9: Eval results *****
2024-04-26 02:03:46,339 -   best_eval_score = 0.6022
2024-04-26 02:03:46,339 -   eval_score = 0.5832
2024-04-26 02:03:46,339 -   train_loss = 0.4578
2024-04-26 02:03:46,339 - EarlyStopping counter: 3 out of 5
2024-04-26 02:04:47,351 - ***** Epoch: 10: Eval results *****
2024-04-26 02:04:47,352 -   best_eval_score = 0.6022
2024-04-26 02:04:47,352 -   eval_score = 0.5832
2024-04-26 02:04:47,352 -   train_loss = 0.446
2024-04-26 02:04:47,352 - EarlyStopping counter: 4 out of 5
2024-04-26 02:05:48,675 - ***** Epoch: 11: Eval results *****
2024-04-26 02:05:48,675 -   best_eval_score = 0.6022
2024-04-26 02:05:48,675 -   eval_score = 0.5841
2024-04-26 02:05:48,675 -   train_loss = 0.444
2024-04-26 02:05:48,675 - EarlyStopping counter: 5 out of 5
2024-04-26 02:05:48,675 - EarlyStopping at epoch 11
2024-04-26 02:05:48,676 - Training is finished...
2024-04-26 02:05:48,676 - Testing begins...
2024-04-26 02:06:43,996 - ***** Out-of-domain Evaluation results *****
2024-04-26 02:06:43,997 -   aupr_in = 0.5858
2024-04-26 02:06:43,997 -   aupr_out = 0.4563
2024-04-26 02:06:43,997 -   auroc = 0.5263
2024-04-26 02:06:43,997 -   der = 0.5542
2024-04-26 02:06:43,997 -   eer = 0.4798
2024-04-26 02:06:43,997 -   fpr95 = 0.9424
2024-04-26 02:06:44,002 - Testing is finished...
2024-04-26 02:06:44,002 - Multimodal intent recognition is finished...
2024-04-26 02:06:44,002 - Results are saved in results/results_misa_MIntRec2.csv
2024-04-26 02:06:45,338 - Multimodal Intent Recognition begins...
2024-04-26 02:06:45,338 - Training begins...
2024-04-26 02:07:43,750 - ***** Epoch: 1: Eval results *****
2024-04-26 02:07:43,751 -   best_eval_score = 0.0
2024-04-26 02:07:43,751 -   eval_score = 0.5307
2024-04-26 02:07:43,751 -   train_loss = 2.6076
2024-04-26 02:08:41,431 - ***** Epoch: 2: Eval results *****
2024-04-26 02:08:41,432 -   best_eval_score = 0.5307
2024-04-26 02:08:41,432 -   eval_score = 0.5479
2024-04-26 02:08:41,432 -   train_loss = 1.6907
2024-04-26 02:09:39,820 - ***** Epoch: 3: Eval results *****
2024-04-26 02:09:39,820 -   best_eval_score = 0.5479
2024-04-26 02:09:39,820 -   eval_score = 0.5542
2024-04-26 02:09:39,820 -   train_loss = 1.2438
2024-04-26 02:10:41,355 - ***** Epoch: 4: Eval results *****
2024-04-26 02:10:41,355 -   best_eval_score = 0.5542
2024-04-26 02:10:41,355 -   eval_score = 0.5732
2024-04-26 02:10:41,355 -   train_loss = 0.8817
2024-04-26 02:11:42,800 - ***** Epoch: 5: Eval results *****
2024-04-26 02:11:42,800 -   best_eval_score = 0.5732
2024-04-26 02:11:42,800 -   eval_score = 0.5642
2024-04-26 02:11:42,800 -   train_loss = 0.6673
2024-04-26 02:11:42,800 - EarlyStopping counter: 1 out of 5
2024-04-26 02:12:43,416 - ***** Epoch: 6: Eval results *****
2024-04-26 02:12:43,416 -   best_eval_score = 0.5732
2024-04-26 02:12:43,416 -   eval_score = 0.5769
2024-04-26 02:12:43,416 -   train_loss = 0.519
2024-04-26 02:13:43,484 - ***** Epoch: 7: Eval results *****
2024-04-26 02:13:43,485 -   best_eval_score = 0.5769
2024-04-26 02:13:43,485 -   eval_score = 0.5778
2024-04-26 02:13:43,485 -   train_loss = 0.4537
2024-04-26 02:14:44,186 - ***** Epoch: 8: Eval results *****
2024-04-26 02:14:44,186 -   best_eval_score = 0.5778
2024-04-26 02:14:44,186 -   eval_score = 0.5732
2024-04-26 02:14:44,186 -   train_loss = 0.4318
2024-04-26 02:14:44,187 - EarlyStopping counter: 1 out of 5
2024-04-26 02:15:45,293 - ***** Epoch: 9: Eval results *****
2024-04-26 02:15:45,293 -   best_eval_score = 0.5778
2024-04-26 02:15:45,293 -   eval_score = 0.5823
2024-04-26 02:15:45,293 -   train_loss = 0.4083
2024-04-26 02:16:45,214 - ***** Epoch: 10: Eval results *****
2024-04-26 02:16:45,214 -   best_eval_score = 0.5823
2024-04-26 02:16:45,214 -   eval_score = 0.5859
2024-04-26 02:16:45,214 -   train_loss = 0.3912
2024-04-26 02:17:46,279 - ***** Epoch: 11: Eval results *****
2024-04-26 02:17:46,279 -   best_eval_score = 0.5859
2024-04-26 02:17:46,279 -   eval_score = 0.5895
2024-04-26 02:17:46,279 -   train_loss = 0.3936
2024-04-26 02:18:45,467 - ***** Epoch: 12: Eval results *****
2024-04-26 02:18:45,467 -   best_eval_score = 0.5895
2024-04-26 02:18:45,467 -   eval_score = 0.5814
2024-04-26 02:18:45,467 -   train_loss = 0.3899
2024-04-26 02:18:45,467 - EarlyStopping counter: 1 out of 5
2024-04-26 02:19:40,599 - ***** Epoch: 13: Eval results *****
2024-04-26 02:19:40,599 -   best_eval_score = 0.5895
2024-04-26 02:19:40,599 -   eval_score = 0.5841
2024-04-26 02:19:40,600 -   train_loss = 0.3754
2024-04-26 02:19:40,600 - EarlyStopping counter: 2 out of 5
2024-04-26 02:20:40,340 - ***** Epoch: 14: Eval results *****
2024-04-26 02:20:40,340 -   best_eval_score = 0.5895
2024-04-26 02:20:40,340 -   eval_score = 0.5796
2024-04-26 02:20:40,340 -   train_loss = 0.3723
2024-04-26 02:20:40,340 - EarlyStopping counter: 3 out of 5
2024-04-26 02:21:40,873 - ***** Epoch: 15: Eval results *****
2024-04-26 02:21:40,873 -   best_eval_score = 0.5895
2024-04-26 02:21:40,873 -   eval_score = 0.585
2024-04-26 02:21:40,873 -   train_loss = 0.3694
2024-04-26 02:21:40,873 - EarlyStopping counter: 4 out of 5
2024-04-26 02:22:41,265 - ***** Epoch: 16: Eval results *****
2024-04-26 02:22:41,265 -   best_eval_score = 0.5895
2024-04-26 02:22:41,265 -   eval_score = 0.5805
2024-04-26 02:22:41,265 -   train_loss = 0.3684
2024-04-26 02:22:41,265 - EarlyStopping counter: 5 out of 5
2024-04-26 02:22:41,265 - EarlyStopping at epoch 16
2024-04-26 02:22:41,266 - Training is finished...
2024-04-26 02:22:41,267 - Testing begins...
2024-04-26 02:23:37,636 - ***** Out-of-domain Evaluation results *****
2024-04-26 02:23:37,637 -   aupr_in = 0.5798
2024-04-26 02:23:37,637 -   aupr_out = 0.4533
2024-04-26 02:23:37,637 -   auroc = 0.5209
2024-04-26 02:23:37,637 -   der = 0.5522
2024-04-26 02:23:37,637 -   eer = 0.4824
2024-04-26 02:23:37,637 -   fpr95 = 0.9386
2024-04-26 02:23:37,637 - Testing is finished...
2024-04-26 02:23:37,637 - Multimodal intent recognition is finished...
2024-04-26 02:23:37,637 - Results are saved in results/results_misa_MIntRec2.csv
2024-04-26 02:23:39,190 - Multimodal Intent Recognition begins...
2024-04-26 02:23:39,190 - Training begins...
2024-04-26 02:24:40,106 - ***** Epoch: 1: Eval results *****
2024-04-26 02:24:40,106 -   best_eval_score = 0.0
2024-04-26 02:24:40,106 -   eval_score = 0.5172
2024-04-26 02:24:40,106 -   train_loss = 2.8781
2024-04-26 02:25:40,741 - ***** Epoch: 2: Eval results *****
2024-04-26 02:25:40,741 -   best_eval_score = 0.5172
2024-04-26 02:25:40,741 -   eval_score = 0.5506
2024-04-26 02:25:40,741 -   train_loss = 1.731
2024-04-26 02:26:39,461 - ***** Epoch: 3: Eval results *****
2024-04-26 02:26:39,461 -   best_eval_score = 0.5506
2024-04-26 02:26:39,461 -   eval_score = 0.5515
2024-04-26 02:26:39,461 -   train_loss = 1.4161
2024-04-26 02:27:41,759 - ***** Epoch: 4: Eval results *****
2024-04-26 02:27:41,759 -   best_eval_score = 0.5515
2024-04-26 02:27:41,759 -   eval_score = 0.5814
2024-04-26 02:27:41,759 -   train_loss = 1.0664
2024-04-26 02:28:39,292 - ***** Epoch: 5: Eval results *****
2024-04-26 02:28:39,292 -   best_eval_score = 0.5814
2024-04-26 02:28:39,292 -   eval_score = 0.5696
2024-04-26 02:28:39,292 -   train_loss = 0.7941
2024-04-26 02:28:39,292 - EarlyStopping counter: 1 out of 5
2024-04-26 02:29:39,023 - ***** Epoch: 6: Eval results *****
2024-04-26 02:29:39,023 -   best_eval_score = 0.5814
2024-04-26 02:29:39,023 -   eval_score = 0.5931
2024-04-26 02:29:39,023 -   train_loss = 0.5998
