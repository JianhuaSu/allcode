2024-05-19 13:49:30,216 - Lists of intent labels are: ['Acknowledge', 'Advise', 'Agree', 'Apologise', 'Arrange', 'Ask for help', 'Asking for opinions', 'Care', 'Comfort', 'Complain', 'Confirm', 'Criticize', 'Doubt', 'Emphasize', 'Explain', 'Flaunt', 'Greet', 'Inform', 'Introduce', 'Invite', 'Joke', 'Leave', 'Oppose', 'Plan', 'Praise', 'Prevent', 'Refuse', 'Taunt', 'Thank', 'Warn']
2024-05-19 13:49:30,216 - ID Data preparation...
2024-05-19 13:49:50,465 - OOD Data preparation...
2024-05-19 13:49:53,940 - ============================== Params ==============================
2024-05-19 13:49:53,940 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-05-19 13:49:53,940 - dataset: MIntRec2
2024-05-19 13:49:53,940 - ood_dataset: MIntRec2-OOD
2024-05-19 13:49:53,940 - data_mode: multi-class
2024-05-19 13:49:53,940 - multimodal_method: msz
2024-05-19 13:49:53,940 - method: msz
2024-05-19 13:49:53,941 - ood_detection_method: ma
2024-05-19 13:49:53,941 - text_backbone: bert-base-uncased
2024-05-19 13:49:53,941 - seed: 0
2024-05-19 13:49:53,941 - num_workers: 8
2024-05-19 13:49:53,941 - log_id: msz_ma_MIntRec2_multi-class_0_2024-05-19-13-49-30
2024-05-19 13:49:53,941 - gpu_id: 2
2024-05-19 13:49:53,941 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-19 13:49:53,941 - train: True
2024-05-19 13:49:53,941 - tune: True
2024-05-19 13:49:53,941 - ood: True
2024-05-19 13:49:53,941 - save_model: True
2024-05-19 13:49:53,941 - save_results: True
2024-05-19 13:49:53,941 - log_path: logs
2024-05-19 13:49:53,941 - cache_path: cache
2024-05-19 13:49:53,941 - video_data_path: video_data
2024-05-19 13:49:53,941 - audio_data_path: audio_data
2024-05-19 13:49:53,941 - video_feats_path: swin_feats.pkl
2024-05-19 13:49:53,941 - ood_video_feats_path: swin_feats.pkl
2024-05-19 13:49:53,941 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-19 13:49:53,941 - audio_feats_path: wavlm_feats.pkl
2024-05-19 13:49:53,941 - results_path: results
2024-05-19 13:49:53,941 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz
2024-05-19 13:49:53,941 - model_path: models
2024-05-19 13:49:53,941 - config_file_name: msz_MIntRec22
2024-05-19 13:49:53,941 - results_file_name: results_msz_ablation_MIntRec2.csv
2024-05-19 13:49:53,941 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-19 13:49:53,941 - text_seq_len: 50
2024-05-19 13:49:53,941 - video_seq_len: 180
2024-05-19 13:49:53,941 - audio_seq_len: 400
2024-05-19 13:49:53,941 - text_feat_dim: 768
2024-05-19 13:49:53,941 - video_feat_dim: 256
2024-05-19 13:49:53,941 - audio_feat_dim: 768
2024-05-19 13:49:53,941 - ood_label_id: 30
2024-05-19 13:49:53,941 - num_labels: 30
2024-05-19 13:49:53,941 - num_train_examples: 6165
2024-05-19 13:49:53,941 - need_aligned: True
2024-05-19 13:49:53,941 - freeze_parameters: False
2024-05-19 13:49:53,941 - eval_monitor: acc
2024-05-19 13:49:53,941 - train_batch_size: 32
2024-05-19 13:49:53,941 - eval_batch_size: 16
2024-05-19 13:49:53,941 - num_train_epochs: 100
2024-05-19 13:49:53,941 - lr: [1e-05]
2024-05-19 13:49:53,941 - weight_decay: [0.1]
2024-05-19 13:49:53,941 - wait_patience: 3
2024-05-19 13:49:53,941 - warmup_proportion: [0.01]
2024-05-19 13:49:53,941 - hidden_dims: [768]
2024-05-19 13:49:53,942 - num_attention_heads: [4]
2024-05-19 13:49:53,942 - attention_probs_dropout_prob: [0.3]
2024-05-19 13:49:53,942 - hidden_dropout_prob: [0.3]
2024-05-19 13:49:53,942 - intermediate_size: [768]
2024-05-19 13:49:53,942 - num_hidden_layers: [6]
2024-05-19 13:49:53,942 - max_position_embeddings: [768]
2024-05-19 13:49:53,942 - position_embedding_type: absolute
2024-05-19 13:49:53,942 - batch_first: True
2024-05-19 13:49:53,942 - aligned_method: ['ctc']
2024-05-19 13:49:53,942 - sampler: ['dir']
2024-05-19 13:49:53,942 - multiple_ood: [1]
2024-05-19 13:49:53,942 - select_number_min: [2]
2024-05-19 13:49:53,942 - select_number_max: [3]
2024-05-19 13:49:53,942 - alpha: [2]
2024-05-19 13:49:53,942 - mlp_hidden_size: [256]
2024-05-19 13:49:53,942 - mlp_dropout: [0.3]
2024-05-19 13:49:53,942 - scale: [8]
2024-05-19 13:49:53,942 - ablation: ['no_CosClass']
2024-05-19 13:49:53,942 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/msz_MIntRec2_bert-base-uncased_multi-class_0
2024-05-19 13:49:53,942 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/msz_MIntRec2_bert-base-uncased_multi-class_0/models
2024-05-19 13:49:53,942 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/binary_msz_MIntRec2_bert-base-uncased_0
2024-05-19 13:49:53,942 - ============================== End Params ==============================
2024-05-19 13:49:57,026 - Multimodal Intent Recognition begins...
2024-05-19 13:49:57,026 - Training begins...
2024-05-19 13:53:19,338 - ***** Epoch: 1: Eval results *****
2024-05-19 13:53:19,347 -   binary_train_loss = 0.5449
2024-05-19 13:53:19,347 -   binary_eval_score = 0.9042
2024-05-19 13:53:19,347 -   train_loss = 3.5444
2024-05-19 13:53:19,347 -   eval_score = 0.0542
2024-05-19 13:53:19,347 -   best_eval_score = 0.0
2024-05-19 13:56:42,454 - ***** Epoch: 2: Eval results *****
2024-05-19 13:56:42,455 -   binary_train_loss = 0.3705
2024-05-19 13:56:42,455 -   binary_eval_score = 0.9354
2024-05-19 13:56:42,455 -   train_loss = 10.2528
2024-05-19 13:56:42,455 -   eval_score = 0.4033
2024-05-19 13:56:42,455 -   best_eval_score = 0.0542
2024-05-19 14:01:12,852 - ***** Epoch: 3: Eval results *****
2024-05-19 14:01:12,852 -   binary_train_loss = 0.7914
2024-05-19 14:01:12,852 -   binary_eval_score = 0.5267
2024-05-19 14:01:12,852 -   train_loss = 3.181
2024-05-19 14:01:12,852 -   eval_score = 0.2948
2024-05-19 14:01:12,852 -   best_eval_score = 0.4033
2024-05-19 14:01:12,853 - EarlyStopping counter: 1 out of 3
2024-05-19 14:05:34,140 - ***** Epoch: 4: Eval results *****
2024-05-19 14:05:34,150 -   binary_train_loss = 0.6983
2024-05-19 14:05:34,150 -   binary_eval_score = 0.5434
2024-05-19 14:05:34,150 -   train_loss = 2.7966
2024-05-19 14:05:34,150 -   eval_score = 0.3056
2024-05-19 14:05:34,150 -   best_eval_score = 0.4033
2024-05-19 14:05:34,150 - EarlyStopping counter: 2 out of 3
2024-05-19 14:09:09,243 - ***** Epoch: 5: Eval results *****
2024-05-19 14:09:09,243 -   binary_train_loss = 0.6949
2024-05-19 14:09:09,243 -   binary_eval_score = 0.5592
2024-05-19 14:09:09,243 -   train_loss = 2.2847
2024-05-19 14:09:09,243 -   eval_score = 0.4711
2024-05-19 14:09:09,243 -   best_eval_score = 0.4033
2024-05-19 14:12:31,406 - ***** Epoch: 6: Eval results *****
2024-05-19 14:12:31,406 -   binary_train_loss = 0.6648
2024-05-19 14:12:31,406 -   binary_eval_score = 0.741
2024-05-19 14:12:31,406 -   train_loss = 1.7327
2024-05-19 14:12:31,406 -   eval_score = 0.5217
2024-05-19 14:12:31,406 -   best_eval_score = 0.4711
2024-05-19 14:15:53,150 - ***** Epoch: 7: Eval results *****
2024-05-19 14:15:53,151 -   binary_train_loss = 0.3164
2024-05-19 14:15:53,151 -   binary_eval_score = 0.9191
2024-05-19 14:15:53,151 -   train_loss = 1.7135
2024-05-19 14:15:53,151 -   eval_score = 0.5651
2024-05-19 14:15:53,151 -   best_eval_score = 0.5217
2024-05-19 14:19:15,821 - ***** Epoch: 8: Eval results *****
2024-05-19 14:19:15,821 -   binary_train_loss = 0.7334
2024-05-19 14:19:15,821 -   binary_eval_score = 0.5167
2024-05-19 14:19:15,821 -   train_loss = 1.8161
2024-05-19 14:19:15,821 -   eval_score = 0.5371
2024-05-19 14:19:15,821 -   best_eval_score = 0.5651
2024-05-19 14:19:15,822 - EarlyStopping counter: 1 out of 3
2024-05-19 14:22:37,757 - ***** Epoch: 9: Eval results *****
2024-05-19 14:22:37,758 -   binary_train_loss = 0.3919
2024-05-19 14:22:37,758 -   binary_eval_score = 0.9308
2024-05-19 14:22:37,758 -   train_loss = 1.1233
2024-05-19 14:22:37,758 -   eval_score = 0.5506
2024-05-19 14:22:37,758 -   best_eval_score = 0.5651
2024-05-19 14:22:37,758 - EarlyStopping counter: 2 out of 3
2024-05-19 14:25:59,844 - ***** Epoch: 10: Eval results *****
2024-05-19 14:25:59,844 -   binary_train_loss = 0.7124
2024-05-19 14:25:59,844 -   binary_eval_score = 0.641
2024-05-19 14:25:59,844 -   train_loss = 1.0992
2024-05-19 14:25:59,844 -   eval_score = 0.566
2024-05-19 14:25:59,844 -   best_eval_score = 0.5651
2024-05-19 14:29:21,758 - ***** Epoch: 11: Eval results *****
2024-05-19 14:29:21,759 -   binary_train_loss = 0.2284
2024-05-19 14:29:21,759 -   binary_eval_score = 0.9476
2024-05-19 14:29:21,759 -   train_loss = 1.4875
2024-05-19 14:29:21,759 -   eval_score = 0.538
2024-05-19 14:29:21,759 -   best_eval_score = 0.566
2024-05-19 14:29:21,759 - EarlyStopping counter: 1 out of 3
2024-05-19 14:32:44,290 - ***** Epoch: 12: Eval results *****
2024-05-19 14:32:44,291 -   binary_train_loss = 0.7456
2024-05-19 14:32:44,291 -   binary_eval_score = 0.5868
2024-05-19 14:32:44,291 -   train_loss = 1.2041
2024-05-19 14:32:44,291 -   eval_score = 0.5678
2024-05-19 14:32:44,291 -   best_eval_score = 0.566
2024-05-19 14:36:05,999 - ***** Epoch: 13: Eval results *****
2024-05-19 14:36:05,999 -   binary_train_loss = 0.2567
2024-05-19 14:36:05,999 -   binary_eval_score = 0.9105
2024-05-19 14:36:05,999 -   train_loss = 0.8404
2024-05-19 14:36:06,000 -   eval_score = 0.5669
2024-05-19 14:36:06,000 -   best_eval_score = 0.5678
2024-05-19 14:36:06,000 - EarlyStopping counter: 1 out of 3
2024-05-19 14:39:27,213 - ***** Epoch: 14: Eval results *****
2024-05-19 14:39:27,213 -   binary_train_loss = 0.168
2024-05-19 14:39:27,213 -   binary_eval_score = 0.9354
2024-05-19 14:39:27,213 -   train_loss = 0.7668
2024-05-19 14:39:27,213 -   eval_score = 0.5443
2024-05-19 14:39:27,213 -   best_eval_score = 0.5678
2024-05-19 14:39:27,214 - EarlyStopping counter: 2 out of 3
2024-05-19 14:42:47,988 - ***** Epoch: 15: Eval results *****
2024-05-19 14:42:47,988 -   binary_train_loss = 0.1648
2024-05-19 14:42:47,988 -   binary_eval_score = 0.9245
2024-05-19 14:42:47,988 -   train_loss = 0.5872
2024-05-19 14:42:47,988 -   eval_score = 0.5443
2024-05-19 14:42:47,988 -   best_eval_score = 0.5678
2024-05-19 14:42:47,989 - EarlyStopping counter: 3 out of 3
2024-05-19 14:42:47,989 - EarlyStopping at epoch 15
2024-05-19 14:42:47,992 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/msz_MIntRec2_bert-base-uncased_multi-class_0/models
2024-05-19 14:42:54,475 - Training is finished...
2024-05-19 14:42:54,476 - Testing begins...
2024-05-19 14:43:44,279 - ***** Out-of-domain Evaluation results *****
2024-05-19 14:43:44,279 -   aupr_in = 0.8095
2024-05-19 14:43:44,280 -   aupr_out = 0.6129
2024-05-19 14:43:44,280 -   auroc = 0.7333
2024-05-19 14:43:44,280 -   der = 0.4959
2024-05-19 14:43:44,280 -   eer = 0.3292
2024-05-19 14:43:44,280 -   fpr95 = 0.7586
2024-05-19 14:43:44,280 - Testing is finished...
2024-05-19 14:43:44,280 - Multimodal intent recognition is finished...
2024-05-19 14:43:44,280 - Results are saved in results/results_msz_ablation_MIntRec2.csv
2024-05-19 14:43:44,360 - ============================== Params ==============================
2024-05-19 14:43:44,360 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-05-19 14:43:44,360 - dataset: MIntRec2
2024-05-19 14:43:44,360 - ood_dataset: MIntRec2-OOD
2024-05-19 14:43:44,360 - data_mode: multi-class
2024-05-19 14:43:44,360 - multimodal_method: msz
2024-05-19 14:43:44,360 - method: msz
2024-05-19 14:43:44,360 - ood_detection_method: ma
2024-05-19 14:43:44,360 - text_backbone: bert-base-uncased
2024-05-19 14:43:44,360 - seed: 1
2024-05-19 14:43:44,360 - num_workers: 8
2024-05-19 14:43:44,360 - log_id: msz_ma_MIntRec2_multi-class_0_2024-05-19-13-49-30
2024-05-19 14:43:44,360 - gpu_id: 2
2024-05-19 14:43:44,360 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-19 14:43:44,360 - train: True
2024-05-19 14:43:44,360 - tune: True
2024-05-19 14:43:44,360 - ood: True
2024-05-19 14:43:44,360 - save_model: True
2024-05-19 14:43:44,360 - save_results: True
2024-05-19 14:43:44,360 - log_path: logs
2024-05-19 14:43:44,360 - cache_path: cache
2024-05-19 14:43:44,360 - video_data_path: video_data
2024-05-19 14:43:44,360 - audio_data_path: audio_data
2024-05-19 14:43:44,360 - video_feats_path: swin_feats.pkl
2024-05-19 14:43:44,360 - ood_video_feats_path: swin_feats.pkl
2024-05-19 14:43:44,360 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-19 14:43:44,360 - audio_feats_path: wavlm_feats.pkl
2024-05-19 14:43:44,360 - results_path: results
2024-05-19 14:43:44,360 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz
2024-05-19 14:43:44,360 - model_path: models
2024-05-19 14:43:44,360 - config_file_name: msz_MIntRec22
2024-05-19 14:43:44,360 - results_file_name: results_msz_ablation_MIntRec2.csv
2024-05-19 14:43:44,360 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-19 14:43:44,360 - text_seq_len: 50
2024-05-19 14:43:44,360 - video_seq_len: 180
2024-05-19 14:43:44,360 - audio_seq_len: 400
2024-05-19 14:43:44,360 - text_feat_dim: 768
2024-05-19 14:43:44,361 - video_feat_dim: 256
2024-05-19 14:43:44,361 - audio_feat_dim: 768
2024-05-19 14:43:44,361 - ood_label_id: 30
2024-05-19 14:43:44,361 - num_labels: 30
2024-05-19 14:43:44,361 - num_train_examples: 6165
2024-05-19 14:43:44,361 - need_aligned: True
2024-05-19 14:43:44,361 - freeze_parameters: False
2024-05-19 14:43:44,361 - eval_monitor: acc
2024-05-19 14:43:44,361 - train_batch_size: 32
2024-05-19 14:43:44,361 - eval_batch_size: 16
2024-05-19 14:43:44,361 - num_train_epochs: 100
2024-05-19 14:43:44,361 - lr: [1e-05]
2024-05-19 14:43:44,361 - weight_decay: [0.1]
2024-05-19 14:43:44,361 - wait_patience: 3
2024-05-19 14:43:44,361 - warmup_proportion: [0.01]
2024-05-19 14:43:44,361 - hidden_dims: [768]
2024-05-19 14:43:44,361 - num_attention_heads: [4]
2024-05-19 14:43:44,361 - attention_probs_dropout_prob: [0.3]
2024-05-19 14:43:44,361 - hidden_dropout_prob: [0.3]
2024-05-19 14:43:44,361 - intermediate_size: [768]
2024-05-19 14:43:44,361 - num_hidden_layers: [6]
2024-05-19 14:43:44,361 - max_position_embeddings: [768]
2024-05-19 14:43:44,361 - position_embedding_type: absolute
2024-05-19 14:43:44,361 - batch_first: True
2024-05-19 14:43:44,361 - aligned_method: ['ctc']
2024-05-19 14:43:44,361 - sampler: ['dir']
2024-05-19 14:43:44,361 - multiple_ood: [1]
2024-05-19 14:43:44,361 - select_number_min: [2]
2024-05-19 14:43:44,361 - select_number_max: [3]
2024-05-19 14:43:44,361 - alpha: [2]
2024-05-19 14:43:44,361 - mlp_hidden_size: [256]
2024-05-19 14:43:44,361 - mlp_dropout: [0.3]
2024-05-19 14:43:44,361 - scale: [8]
2024-05-19 14:43:44,361 - ablation: ['no_CosClass']
2024-05-19 14:43:44,361 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/msz_MIntRec2_bert-base-uncased_multi-class_1
2024-05-19 14:43:44,361 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/msz_MIntRec2_bert-base-uncased_multi-class_1/models
2024-05-19 14:43:44,361 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/binary_msz_MIntRec2_bert-base-uncased_1
2024-05-19 14:43:44,361 - device: cuda
2024-05-19 14:43:44,361 - ============================== End Params ==============================
2024-05-19 14:43:46,127 - Multimodal Intent Recognition begins...
2024-05-19 14:43:46,127 - Training begins...
2024-05-19 14:47:06,353 - ***** Epoch: 1: Eval results *****
2024-05-19 14:47:06,353 -   binary_train_loss = 0.5443
2024-05-19 14:47:06,353 -   binary_eval_score = 0.9417
2024-05-19 14:47:06,353 -   train_loss = 3.6027
2024-05-19 14:47:06,353 -   eval_score = 0.0986
2024-05-19 14:47:06,353 -   best_eval_score = 0.0
2024-05-19 14:50:26,406 - ***** Epoch: 2: Eval results *****
2024-05-19 14:50:26,406 -   binary_train_loss = 0.4685
2024-05-19 14:50:26,406 -   binary_eval_score = 0.9566
2024-05-19 14:50:26,406 -   train_loss = 4.8132
2024-05-19 14:50:26,406 -   eval_score = 0.5
2024-05-19 14:50:26,406 -   best_eval_score = 0.0986
2024-05-19 14:53:46,909 - ***** Epoch: 3: Eval results *****
2024-05-19 14:53:46,909 -   binary_train_loss = 0.5367
2024-05-19 14:53:46,909 -   binary_eval_score = 0.9064
2024-05-19 14:53:46,909 -   train_loss = 1.707
2024-05-19 14:53:46,909 -   eval_score = 0.5597
2024-05-19 14:53:46,909 -   best_eval_score = 0.5
2024-05-19 14:57:06,776 - ***** Epoch: 4: Eval results *****
2024-05-19 14:57:06,776 -   binary_train_loss = 0.3231
2024-05-19 14:57:06,776 -   binary_eval_score = 0.9589
2024-05-19 14:57:06,776 -   train_loss = 1.6997
2024-05-19 14:57:06,776 -   eval_score = 0.5398
2024-05-19 14:57:06,776 -   best_eval_score = 0.5597
2024-05-19 14:57:06,776 - EarlyStopping counter: 1 out of 3
2024-05-19 15:00:26,601 - ***** Epoch: 5: Eval results *****
2024-05-19 15:00:26,602 -   binary_train_loss = 0.4422
2024-05-19 15:00:26,602 -   binary_eval_score = 0.9611
2024-05-19 15:00:26,602 -   train_loss = 1.9875
2024-05-19 15:00:26,602 -   eval_score = 0.3553
2024-05-19 15:00:26,602 -   best_eval_score = 0.5597
2024-05-19 15:00:26,602 - EarlyStopping counter: 2 out of 3
2024-05-19 15:03:48,053 - ***** Epoch: 6: Eval results *****
2024-05-19 15:03:48,053 -   binary_train_loss = 0.2251
2024-05-19 15:03:48,053 -   binary_eval_score = 0.9738
2024-05-19 15:03:48,054 -   train_loss = 0.9426
2024-05-19 15:03:48,054 -   eval_score = 0.5579
2024-05-19 15:03:48,054 -   best_eval_score = 0.5597
2024-05-19 15:03:48,054 - EarlyStopping counter: 3 out of 3
2024-05-19 15:03:48,054 - EarlyStopping at epoch 6
2024-05-19 15:03:48,058 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/msz_MIntRec2_bert-base-uncased_multi-class_1/models
2024-05-19 15:03:55,109 - Training is finished...
2024-05-19 15:03:55,110 - Testing begins...
2024-05-19 15:04:47,762 - ***** Out-of-domain Evaluation results *****
2024-05-19 15:04:47,763 -   aupr_in = 0.7754
2024-05-19 15:04:47,763 -   aupr_out = 0.5397
2024-05-19 15:04:47,763 -   auroc = 0.6821
2024-05-19 15:04:47,763 -   der = 0.5574
2024-05-19 15:04:47,763 -   eer = 0.3676
2024-05-19 15:04:47,763 -   fpr95 = 0.8571
2024-05-19 15:04:47,763 - Testing is finished...
2024-05-19 15:04:47,763 - Multimodal intent recognition is finished...
2024-05-19 15:04:47,763 - Results are saved in results/results_msz_ablation_MIntRec2.csv
2024-05-19 15:04:47,843 - ============================== Params ==============================
2024-05-19 15:04:47,843 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-05-19 15:04:47,844 - dataset: MIntRec2
2024-05-19 15:04:47,844 - ood_dataset: MIntRec2-OOD
2024-05-19 15:04:47,844 - data_mode: multi-class
2024-05-19 15:04:47,844 - multimodal_method: msz
2024-05-19 15:04:47,844 - method: msz
2024-05-19 15:04:47,844 - ood_detection_method: ma
2024-05-19 15:04:47,844 - text_backbone: bert-base-uncased
2024-05-19 15:04:47,844 - seed: 2
2024-05-19 15:04:47,844 - num_workers: 8
2024-05-19 15:04:47,844 - log_id: msz_ma_MIntRec2_multi-class_0_2024-05-19-13-49-30
2024-05-19 15:04:47,844 - gpu_id: 2
2024-05-19 15:04:47,844 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-19 15:04:47,844 - train: True
2024-05-19 15:04:47,844 - tune: True
2024-05-19 15:04:47,844 - ood: True
2024-05-19 15:04:47,844 - save_model: True
2024-05-19 15:04:47,844 - save_results: True
2024-05-19 15:04:47,844 - log_path: logs
2024-05-19 15:04:47,844 - cache_path: cache
2024-05-19 15:04:47,844 - video_data_path: video_data
2024-05-19 15:04:47,845 - audio_data_path: audio_data
2024-05-19 15:04:47,845 - video_feats_path: swin_feats.pkl
2024-05-19 15:04:47,845 - ood_video_feats_path: swin_feats.pkl
2024-05-19 15:04:47,845 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-19 15:04:47,845 - audio_feats_path: wavlm_feats.pkl
2024-05-19 15:04:47,845 - results_path: results
2024-05-19 15:04:47,845 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz
2024-05-19 15:04:47,845 - model_path: models
2024-05-19 15:04:47,845 - config_file_name: msz_MIntRec22
2024-05-19 15:04:47,845 - results_file_name: results_msz_ablation_MIntRec2.csv
2024-05-19 15:04:47,845 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-19 15:04:47,845 - text_seq_len: 50
2024-05-19 15:04:47,845 - video_seq_len: 180
2024-05-19 15:04:47,845 - audio_seq_len: 400
2024-05-19 15:04:47,845 - text_feat_dim: 768
2024-05-19 15:04:47,845 - video_feat_dim: 256
2024-05-19 15:04:47,845 - audio_feat_dim: 768
2024-05-19 15:04:47,845 - ood_label_id: 30
2024-05-19 15:04:47,845 - num_labels: 30
2024-05-19 15:04:47,845 - num_train_examples: 6165
2024-05-19 15:04:47,845 - need_aligned: True
2024-05-19 15:04:47,845 - freeze_parameters: False
2024-05-19 15:04:47,845 - eval_monitor: acc
2024-05-19 15:04:47,845 - train_batch_size: 32
2024-05-19 15:04:47,845 - eval_batch_size: 16
2024-05-19 15:04:47,845 - num_train_epochs: 100
2024-05-19 15:04:47,846 - lr: [1e-05]
2024-05-19 15:04:47,846 - weight_decay: [0.1]
2024-05-19 15:04:47,846 - wait_patience: 3
2024-05-19 15:04:47,846 - warmup_proportion: [0.01]
2024-05-19 15:04:47,846 - hidden_dims: [768]
2024-05-19 15:04:47,846 - num_attention_heads: [4]
2024-05-19 15:04:47,846 - attention_probs_dropout_prob: [0.3]
2024-05-19 15:04:47,846 - hidden_dropout_prob: [0.3]
2024-05-19 15:04:47,846 - intermediate_size: [768]
2024-05-19 15:04:47,846 - num_hidden_layers: [6]
2024-05-19 15:04:47,846 - max_position_embeddings: [768]
2024-05-19 15:04:47,846 - position_embedding_type: absolute
2024-05-19 15:04:47,846 - batch_first: True
2024-05-19 15:04:47,846 - aligned_method: ['ctc']
2024-05-19 15:04:47,846 - sampler: ['dir']
2024-05-19 15:04:47,846 - multiple_ood: [1]
2024-05-19 15:04:47,846 - select_number_min: [2]
2024-05-19 15:04:47,846 - select_number_max: [3]
2024-05-19 15:04:47,846 - alpha: [2]
2024-05-19 15:04:47,846 - mlp_hidden_size: [256]
2024-05-19 15:04:47,846 - mlp_dropout: [0.3]
2024-05-19 15:04:47,846 - scale: [8]
2024-05-19 15:04:47,846 - ablation: ['no_CosClass']
2024-05-19 15:04:47,846 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/msz_MIntRec2_bert-base-uncased_multi-class_2
2024-05-19 15:04:47,846 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/msz_MIntRec2_bert-base-uncased_multi-class_2/models
2024-05-19 15:04:47,846 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/binary_msz_MIntRec2_bert-base-uncased_2
2024-05-19 15:04:47,847 - device: cuda
2024-05-19 15:04:47,847 - ============================== End Params ==============================
2024-05-19 15:04:49,595 - Multimodal Intent Recognition begins...
2024-05-19 15:04:49,595 - Training begins...
2024-05-19 15:08:10,309 - ***** Epoch: 1: Eval results *****
2024-05-19 15:08:10,309 -   binary_train_loss = 0.5452
2024-05-19 15:08:10,310 -   binary_eval_score = 0.9656
2024-05-19 15:08:10,310 -   train_loss = 3.5674
2024-05-19 15:08:10,310 -   eval_score = 0.0714
2024-05-19 15:08:10,310 -   best_eval_score = 0.0
2024-05-19 15:11:32,716 - ***** Epoch: 2: Eval results *****
2024-05-19 15:11:32,717 -   binary_train_loss = 0.506
2024-05-19 15:11:32,717 -   binary_eval_score = 0.9684
2024-05-19 15:11:32,717 -   train_loss = 13.1313
2024-05-19 15:11:32,717 -   eval_score = 0.4186
2024-05-19 15:11:32,717 -   best_eval_score = 0.0714
2024-05-19 15:14:53,443 - ***** Epoch: 3: Eval results *****
2024-05-19 15:14:53,443 -   binary_train_loss = 0.8204
2024-05-19 15:14:53,443 -   binary_eval_score = 0.5244
2024-05-19 15:14:53,443 -   train_loss = 3.2436
2024-05-19 15:14:53,443 -   eval_score = 0.3074
2024-05-19 15:14:53,443 -   best_eval_score = 0.4186
2024-05-19 15:14:53,444 - EarlyStopping counter: 1 out of 3
2024-05-19 15:18:13,736 - ***** Epoch: 4: Eval results *****
2024-05-19 15:18:13,736 -   binary_train_loss = 0.6972
2024-05-19 15:18:13,736 -   binary_eval_score = 0.5827
2024-05-19 15:18:13,736 -   train_loss = 3.0586
2024-05-19 15:18:13,736 -   eval_score = 0.2541
2024-05-19 15:18:13,736 -   best_eval_score = 0.4186
2024-05-19 15:18:13,736 - EarlyStopping counter: 2 out of 3
2024-05-19 15:21:33,625 - ***** Epoch: 5: Eval results *****
2024-05-19 15:21:33,625 -   binary_train_loss = 0.6915
2024-05-19 15:21:33,625 -   binary_eval_score = 0.5791
2024-05-19 15:21:33,625 -   train_loss = 2.7218
2024-05-19 15:21:33,625 -   eval_score = 0.4069
2024-05-19 15:21:33,625 -   best_eval_score = 0.4186
2024-05-19 15:21:33,625 - EarlyStopping counter: 3 out of 3
2024-05-19 15:21:33,625 - EarlyStopping at epoch 5
2024-05-19 15:21:33,628 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/msz_MIntRec2_bert-base-uncased_multi-class_2/models
2024-05-19 15:21:40,842 - Training is finished...
2024-05-19 15:21:40,843 - Testing begins...
2024-05-19 15:22:31,180 - ***** Out-of-domain Evaluation results *****
2024-05-19 15:22:31,181 -   aupr_in = 0.6949
2024-05-19 15:22:31,181 -   aupr_out = 0.4435
2024-05-19 15:22:31,181 -   auroc = 0.5795
2024-05-19 15:22:31,181 -   der = 0.5905
2024-05-19 15:22:31,181 -   eer = 0.4428
2024-05-19 15:22:31,181 -   fpr95 = 0.9089
2024-05-19 15:22:31,181 - Testing is finished...
2024-05-19 15:22:31,181 - Multimodal intent recognition is finished...
2024-05-19 15:22:31,181 - Results are saved in results/results_msz_ablation_MIntRec2.csv
2024-05-19 15:22:31,250 - ============================== Params ==============================
2024-05-19 15:22:31,250 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-05-19 15:22:31,250 - dataset: MIntRec2
2024-05-19 15:22:31,251 - ood_dataset: MIntRec2-OOD
2024-05-19 15:22:31,251 - data_mode: multi-class
2024-05-19 15:22:31,251 - multimodal_method: msz
2024-05-19 15:22:31,251 - method: msz
2024-05-19 15:22:31,251 - ood_detection_method: ma
2024-05-19 15:22:31,251 - text_backbone: bert-base-uncased
2024-05-19 15:22:31,251 - seed: 3
2024-05-19 15:22:31,251 - num_workers: 8
2024-05-19 15:22:31,251 - log_id: msz_ma_MIntRec2_multi-class_0_2024-05-19-13-49-30
2024-05-19 15:22:31,251 - gpu_id: 2
2024-05-19 15:22:31,251 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-19 15:22:31,251 - train: True
2024-05-19 15:22:31,251 - tune: True
2024-05-19 15:22:31,251 - ood: True
2024-05-19 15:22:31,251 - save_model: True
2024-05-19 15:22:31,252 - save_results: True
2024-05-19 15:22:31,252 - log_path: logs
2024-05-19 15:22:31,252 - cache_path: cache
2024-05-19 15:22:31,252 - video_data_path: video_data
2024-05-19 15:22:31,252 - audio_data_path: audio_data
2024-05-19 15:22:31,252 - video_feats_path: swin_feats.pkl
2024-05-19 15:22:31,252 - ood_video_feats_path: swin_feats.pkl
2024-05-19 15:22:31,252 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-19 15:22:31,252 - audio_feats_path: wavlm_feats.pkl
2024-05-19 15:22:31,252 - results_path: results
2024-05-19 15:22:31,252 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz
2024-05-19 15:22:31,252 - model_path: models
2024-05-19 15:22:31,252 - config_file_name: msz_MIntRec22
2024-05-19 15:22:31,252 - results_file_name: results_msz_ablation_MIntRec2.csv
2024-05-19 15:22:31,252 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-19 15:22:31,252 - text_seq_len: 50
2024-05-19 15:22:31,252 - video_seq_len: 180
2024-05-19 15:22:31,253 - audio_seq_len: 400
2024-05-19 15:22:31,253 - text_feat_dim: 768
2024-05-19 15:22:31,253 - video_feat_dim: 256
2024-05-19 15:22:31,253 - audio_feat_dim: 768
2024-05-19 15:22:31,253 - ood_label_id: 30
2024-05-19 15:22:31,253 - num_labels: 30
2024-05-19 15:22:31,253 - num_train_examples: 6165
2024-05-19 15:22:31,253 - need_aligned: True
2024-05-19 15:22:31,253 - freeze_parameters: False
2024-05-19 15:22:31,253 - eval_monitor: acc
2024-05-19 15:22:31,253 - train_batch_size: 32
2024-05-19 15:22:31,253 - eval_batch_size: 16
2024-05-19 15:22:31,253 - num_train_epochs: 100
2024-05-19 15:22:31,253 - lr: [1e-05]
2024-05-19 15:22:31,253 - weight_decay: [0.1]
2024-05-19 15:22:31,253 - wait_patience: 3
2024-05-19 15:22:31,253 - warmup_proportion: [0.01]
2024-05-19 15:22:31,253 - hidden_dims: [768]
2024-05-19 15:22:31,253 - num_attention_heads: [4]
2024-05-19 15:22:31,253 - attention_probs_dropout_prob: [0.3]
2024-05-19 15:22:31,253 - hidden_dropout_prob: [0.3]
2024-05-19 15:22:31,253 - intermediate_size: [768]
2024-05-19 15:22:31,253 - num_hidden_layers: [6]
2024-05-19 15:22:31,253 - max_position_embeddings: [768]
2024-05-19 15:22:31,253 - position_embedding_type: absolute
2024-05-19 15:22:31,254 - batch_first: True
2024-05-19 15:22:31,254 - aligned_method: ['ctc']
2024-05-19 15:22:31,254 - sampler: ['dir']
2024-05-19 15:22:31,254 - multiple_ood: [1]
2024-05-19 15:22:31,254 - select_number_min: [2]
2024-05-19 15:22:31,254 - select_number_max: [3]
2024-05-19 15:22:31,254 - alpha: [2]
2024-05-19 15:22:31,254 - mlp_hidden_size: [256]
2024-05-19 15:22:31,254 - mlp_dropout: [0.3]
2024-05-19 15:22:31,254 - scale: [8]
2024-05-19 15:22:31,254 - ablation: ['no_CosClass']
2024-05-19 15:22:31,254 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/msz_MIntRec2_bert-base-uncased_multi-class_3
2024-05-19 15:22:31,254 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/msz_MIntRec2_bert-base-uncased_multi-class_3/models
2024-05-19 15:22:31,254 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/binary_msz_MIntRec2_bert-base-uncased_3
2024-05-19 15:22:31,254 - device: cuda
2024-05-19 15:22:31,254 - ============================== End Params ==============================
2024-05-19 15:22:32,931 - Multimodal Intent Recognition begins...
2024-05-19 15:22:32,931 - Training begins...
2024-05-19 15:25:52,097 - ***** Epoch: 1: Eval results *****
2024-05-19 15:25:52,097 -   binary_train_loss = 0.5685
2024-05-19 15:25:52,097 -   binary_eval_score = 0.9679
2024-05-19 15:25:52,097 -   train_loss = 2.7975
2024-05-19 15:25:52,097 -   eval_score = 0.5127
2024-05-19 15:25:52,097 -   best_eval_score = 0.0
2024-05-19 15:29:13,552 - ***** Epoch: 2: Eval results *****
2024-05-19 15:29:13,553 -   binary_train_loss = 0.7491
2024-05-19 15:29:13,553 -   binary_eval_score = 0.7848
2024-05-19 15:29:13,553 -   train_loss = 2.9075
2024-05-19 15:29:13,553 -   eval_score = 0.3409
2024-05-19 15:29:13,553 -   best_eval_score = 0.5127
2024-05-19 15:29:13,553 - EarlyStopping counter: 1 out of 3
2024-05-19 15:32:33,738 - ***** Epoch: 3: Eval results *****
2024-05-19 15:32:33,738 -   binary_train_loss = 0.2332
2024-05-19 15:32:33,738 -   binary_eval_score = 0.9769
2024-05-19 15:32:33,738 -   train_loss = 1.7712
2024-05-19 15:32:33,738 -   eval_score = 0.5714
2024-05-19 15:32:33,738 -   best_eval_score = 0.5127
2024-05-19 15:35:55,073 - ***** Epoch: 4: Eval results *****
2024-05-19 15:35:55,074 -   binary_train_loss = 0.416
2024-05-19 15:35:55,074 -   binary_eval_score = 0.8843
2024-05-19 15:35:55,074 -   train_loss = 1.0198
2024-05-19 15:35:55,074 -   eval_score = 0.5696
2024-05-19 15:35:55,074 -   best_eval_score = 0.5714
2024-05-19 15:35:55,074 - EarlyStopping counter: 1 out of 3
2024-05-19 15:39:15,876 - ***** Epoch: 5: Eval results *****
2024-05-19 15:39:15,877 -   binary_train_loss = 0.1458
2024-05-19 15:39:15,877 -   binary_eval_score = 0.9331
2024-05-19 15:39:15,877 -   train_loss = 1.0008
2024-05-19 15:39:15,877 -   eval_score = 0.5533
2024-05-19 15:39:15,877 -   best_eval_score = 0.5714
2024-05-19 15:39:15,877 - EarlyStopping counter: 2 out of 3
2024-05-19 15:42:38,007 - ***** Epoch: 6: Eval results *****
2024-05-19 15:42:38,008 -   binary_train_loss = 0.7761
2024-05-19 15:42:38,008 -   binary_eval_score = 0.6858
2024-05-19 15:42:38,008 -   train_loss = 3.0319
2024-05-19 15:42:38,008 -   eval_score = 0.2242
2024-05-19 15:42:38,008 -   best_eval_score = 0.5714
2024-05-19 15:42:38,008 - EarlyStopping counter: 3 out of 3
2024-05-19 15:42:38,008 - EarlyStopping at epoch 6
2024-05-19 15:42:38,011 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/msz_MIntRec2_bert-base-uncased_multi-class_3/models
2024-05-19 15:42:44,854 - Training is finished...
2024-05-19 15:42:44,855 - Testing begins...
2024-05-19 15:43:37,527 - ***** Out-of-domain Evaluation results *****
2024-05-19 15:43:37,527 -   aupr_in = 0.7353
2024-05-19 15:43:37,527 -   aupr_out = 0.5
2024-05-19 15:43:37,527 -   auroc = 0.6315
2024-05-19 15:43:37,527 -   der = 0.5626
2024-05-19 15:43:37,527 -   eer = 0.4094
2024-05-19 15:43:37,527 -   fpr95 = 0.8647
2024-05-19 15:43:37,527 - Testing is finished...
2024-05-19 15:43:37,527 - Multimodal intent recognition is finished...
2024-05-19 15:43:37,527 - Results are saved in results/results_msz_ablation_MIntRec2.csv
2024-05-19 15:43:37,619 - ============================== Params ==============================
2024-05-19 15:43:37,619 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-05-19 15:43:37,619 - dataset: MIntRec2
2024-05-19 15:43:37,619 - ood_dataset: MIntRec2-OOD
2024-05-19 15:43:37,619 - data_mode: multi-class
2024-05-19 15:43:37,619 - multimodal_method: msz
2024-05-19 15:43:37,619 - method: msz
2024-05-19 15:43:37,619 - ood_detection_method: ma
2024-05-19 15:43:37,619 - text_backbone: bert-base-uncased
2024-05-19 15:43:37,619 - seed: 4
2024-05-19 15:43:37,619 - num_workers: 8
2024-05-19 15:43:37,619 - log_id: msz_ma_MIntRec2_multi-class_0_2024-05-19-13-49-30
2024-05-19 15:43:37,619 - gpu_id: 2
2024-05-19 15:43:37,619 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-19 15:43:37,619 - train: True
2024-05-19 15:43:37,619 - tune: True
2024-05-19 15:43:37,619 - ood: True
2024-05-19 15:43:37,620 - save_model: True
2024-05-19 15:43:37,620 - save_results: True
2024-05-19 15:43:37,620 - log_path: logs
2024-05-19 15:43:37,620 - cache_path: cache
2024-05-19 15:43:37,620 - video_data_path: video_data
2024-05-19 15:43:37,620 - audio_data_path: audio_data
2024-05-19 15:43:37,620 - video_feats_path: swin_feats.pkl
2024-05-19 15:43:37,620 - ood_video_feats_path: swin_feats.pkl
2024-05-19 15:43:37,620 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-19 15:43:37,620 - audio_feats_path: wavlm_feats.pkl
2024-05-19 15:43:37,620 - results_path: results
2024-05-19 15:43:37,620 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz
2024-05-19 15:43:37,620 - model_path: models
2024-05-19 15:43:37,620 - config_file_name: msz_MIntRec22
2024-05-19 15:43:37,620 - results_file_name: results_msz_ablation_MIntRec2.csv
2024-05-19 15:43:37,620 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-19 15:43:37,620 - text_seq_len: 50
2024-05-19 15:43:37,620 - video_seq_len: 180
2024-05-19 15:43:37,620 - audio_seq_len: 400
2024-05-19 15:43:37,620 - text_feat_dim: 768
2024-05-19 15:43:37,620 - video_feat_dim: 256
2024-05-19 15:43:37,620 - audio_feat_dim: 768
2024-05-19 15:43:37,620 - ood_label_id: 30
2024-05-19 15:43:37,620 - num_labels: 30
2024-05-19 15:43:37,620 - num_train_examples: 6165
2024-05-19 15:43:37,620 - need_aligned: True
2024-05-19 15:43:37,620 - freeze_parameters: False
2024-05-19 15:43:37,620 - eval_monitor: acc
2024-05-19 15:43:37,620 - train_batch_size: 32
2024-05-19 15:43:37,620 - eval_batch_size: 16
2024-05-19 15:43:37,620 - num_train_epochs: 100
2024-05-19 15:43:37,620 - lr: [1e-05]
2024-05-19 15:43:37,620 - weight_decay: [0.1]
2024-05-19 15:43:37,620 - wait_patience: 3
2024-05-19 15:43:37,620 - warmup_proportion: [0.01]
2024-05-19 15:43:37,620 - hidden_dims: [768]
2024-05-19 15:43:37,620 - num_attention_heads: [4]
2024-05-19 15:43:37,620 - attention_probs_dropout_prob: [0.3]
2024-05-19 15:43:37,620 - hidden_dropout_prob: [0.3]
2024-05-19 15:43:37,620 - intermediate_size: [768]
2024-05-19 15:43:37,620 - num_hidden_layers: [6]
2024-05-19 15:43:37,620 - max_position_embeddings: [768]
2024-05-19 15:43:37,620 - position_embedding_type: absolute
2024-05-19 15:43:37,620 - batch_first: True
2024-05-19 15:43:37,620 - aligned_method: ['ctc']
2024-05-19 15:43:37,620 - sampler: ['dir']
2024-05-19 15:43:37,620 - multiple_ood: [1]
2024-05-19 15:43:37,620 - select_number_min: [2]
2024-05-19 15:43:37,621 - select_number_max: [3]
2024-05-19 15:43:37,621 - alpha: [2]
2024-05-19 15:43:37,621 - mlp_hidden_size: [256]
2024-05-19 15:43:37,621 - mlp_dropout: [0.3]
2024-05-19 15:43:37,621 - scale: [8]
2024-05-19 15:43:37,621 - ablation: ['no_CosClass']
2024-05-19 15:43:37,621 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/msz_MIntRec2_bert-base-uncased_multi-class_4
2024-05-19 15:43:37,621 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/msz_MIntRec2_bert-base-uncased_multi-class_4/models
2024-05-19 15:43:37,621 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/binary_msz_MIntRec2_bert-base-uncased_4
2024-05-19 15:43:37,621 - device: cuda
2024-05-19 15:43:37,621 - ============================== End Params ==============================
2024-05-19 15:43:39,353 - Multimodal Intent Recognition begins...
2024-05-19 15:43:39,353 - Training begins...
2024-05-19 15:47:00,533 - ***** Epoch: 1: Eval results *****
2024-05-19 15:47:00,534 -   binary_train_loss = 0.5465
2024-05-19 15:47:00,534 -   binary_eval_score = 0.925
2024-05-19 15:47:00,534 -   train_loss = 3.4706
2024-05-19 15:47:00,534 -   eval_score = 0.0958
2024-05-19 15:47:00,534 -   best_eval_score = 0.0
2024-05-19 15:50:21,035 - ***** Epoch: 2: Eval results *****
2024-05-19 15:50:21,035 -   binary_train_loss = 0.2796
2024-05-19 15:50:21,036 -   binary_eval_score = 0.9842
2024-05-19 15:50:21,036 -   train_loss = 9.8969
2024-05-19 15:50:21,036 -   eval_score = 0.4439
2024-05-19 15:50:21,036 -   best_eval_score = 0.0958
2024-05-19 15:53:41,574 - ***** Epoch: 3: Eval results *****
2024-05-19 15:53:41,574 -   binary_train_loss = 0.7888
2024-05-19 15:53:41,575 -   binary_eval_score = 0.6071
2024-05-19 15:53:41,575 -   train_loss = 3.1682
2024-05-19 15:53:41,575 -   eval_score = 0.2025
2024-05-19 15:53:41,575 -   best_eval_score = 0.4439
2024-05-19 15:53:41,575 - EarlyStopping counter: 1 out of 3
2024-05-19 15:57:01,124 - ***** Epoch: 4: Eval results *****
2024-05-19 15:57:01,124 -   binary_train_loss = 0.6967
2024-05-19 15:57:01,124 -   binary_eval_score = 0.5683
2024-05-19 15:57:01,124 -   train_loss = 2.8726
2024-05-19 15:57:01,124 -   eval_score = 0.3363
2024-05-19 15:57:01,124 -   best_eval_score = 0.4439
2024-05-19 15:57:01,124 - EarlyStopping counter: 2 out of 3
2024-05-19 16:00:21,907 - ***** Epoch: 5: Eval results *****
2024-05-19 16:00:21,908 -   binary_train_loss = 0.6952
2024-05-19 16:00:21,908 -   binary_eval_score = 0.5746
2024-05-19 16:00:21,908 -   train_loss = 2.3642
2024-05-19 16:00:21,908 -   eval_score = 0.4539
2024-05-19 16:00:21,908 -   best_eval_score = 0.4439
2024-05-19 16:03:42,707 - ***** Epoch: 6: Eval results *****
2024-05-19 16:03:42,707 -   binary_train_loss = 0.6828
2024-05-19 16:03:42,707 -   binary_eval_score = 0.6582
2024-05-19 16:03:42,707 -   train_loss = 1.7919
2024-05-19 16:03:42,707 -   eval_score = 0.5154
2024-05-19 16:03:42,708 -   best_eval_score = 0.4539
2024-05-19 16:07:05,889 - ***** Epoch: 7: Eval results *****
2024-05-19 16:07:05,889 -   binary_train_loss = 0.3411
2024-05-19 16:07:05,889 -   binary_eval_score = 0.8445
2024-05-19 16:07:05,889 -   train_loss = 2.013
2024-05-19 16:07:05,889 -   eval_score = 0.5615
2024-05-19 16:07:05,889 -   best_eval_score = 0.5154
2024-05-19 16:10:25,726 - ***** Epoch: 8: Eval results *****
2024-05-19 16:10:25,726 -   binary_train_loss = 0.7365
2024-05-19 16:10:25,726 -   binary_eval_score = 0.5393
2024-05-19 16:10:25,726 -   train_loss = 1.8959
2024-05-19 16:10:25,726 -   eval_score = 0.5615
2024-05-19 16:10:25,726 -   best_eval_score = 0.5615
2024-05-19 16:10:25,726 - EarlyStopping counter: 1 out of 3
2024-05-19 16:13:46,251 - ***** Epoch: 9: Eval results *****
2024-05-19 16:13:46,251 -   binary_train_loss = 0.6673
2024-05-19 16:13:46,251 -   binary_eval_score = 0.7292
2024-05-19 16:13:46,251 -   train_loss = 1.1556
2024-05-19 16:13:46,251 -   eval_score = 0.5687
2024-05-19 16:13:46,251 -   best_eval_score = 0.5615
2024-05-19 16:17:08,119 - ***** Epoch: 10: Eval results *****
2024-05-19 16:17:08,119 -   binary_train_loss = 0.2978
2024-05-19 16:17:08,119 -   binary_eval_score = 0.9186
2024-05-19 16:17:08,119 -   train_loss = 1.5025
2024-05-19 16:17:08,119 -   eval_score = 0.5506
2024-05-19 16:17:08,119 -   best_eval_score = 0.5687
2024-05-19 16:17:08,120 - EarlyStopping counter: 1 out of 3
2024-05-19 16:20:28,974 - ***** Epoch: 11: Eval results *****
2024-05-19 16:20:28,975 -   binary_train_loss = 0.7356
2024-05-19 16:20:28,975 -   binary_eval_score = 0.5633
2024-05-19 16:20:28,975 -   train_loss = 1.2447
2024-05-19 16:20:28,975 -   eval_score = 0.5705
2024-05-19 16:20:28,975 -   best_eval_score = 0.5687
2024-05-19 16:23:49,907 - ***** Epoch: 12: Eval results *****
2024-05-19 16:23:49,907 -   binary_train_loss = 0.2455
2024-05-19 16:23:49,907 -   binary_eval_score = 0.9317
2024-05-19 16:23:49,907 -   train_loss = 1.1737
2024-05-19 16:23:49,907 -   eval_score = 0.5597
2024-05-19 16:23:49,908 -   best_eval_score = 0.5705
2024-05-19 16:23:49,908 - EarlyStopping counter: 1 out of 3
2024-05-19 16:27:12,492 - ***** Epoch: 13: Eval results *****
2024-05-19 16:27:12,493 -   binary_train_loss = 0.7184
2024-05-19 16:27:12,493 -   binary_eval_score = 0.6207
2024-05-19 16:27:12,493 -   train_loss = 0.8922
2024-05-19 16:27:12,493 -   eval_score = 0.5814
2024-05-19 16:27:12,493 -   best_eval_score = 0.5705
2024-05-19 16:30:34,659 - ***** Epoch: 14: Eval results *****
2024-05-19 16:30:34,660 -   binary_train_loss = 0.2197
2024-05-19 16:30:34,660 -   binary_eval_score = 0.9616
2024-05-19 16:30:34,660 -   train_loss = 0.8942
2024-05-19 16:30:34,660 -   eval_score = 0.5506
2024-05-19 16:30:34,660 -   best_eval_score = 0.5814
2024-05-19 16:30:34,660 - EarlyStopping counter: 1 out of 3
2024-05-19 16:33:55,582 - ***** Epoch: 15: Eval results *****
2024-05-19 16:33:55,583 -   binary_train_loss = 0.7076
2024-05-19 16:33:55,583 -   binary_eval_score = 0.7767
2024-05-19 16:33:55,583 -   train_loss = 0.6331
2024-05-19 16:33:55,583 -   eval_score = 0.5823
2024-05-19 16:33:55,583 -   best_eval_score = 0.5814
2024-05-19 16:37:16,695 - ***** Epoch: 16: Eval results *****
2024-05-19 16:37:16,696 -   binary_train_loss = 0.2252
2024-05-19 16:37:16,696 -   binary_eval_score = 0.9525
2024-05-19 16:37:16,696 -   train_loss = 1.0248
2024-05-19 16:37:16,696 -   eval_score = 0.5533
2024-05-19 16:37:16,696 -   best_eval_score = 0.5823
2024-05-19 16:37:16,696 - EarlyStopping counter: 1 out of 3
2024-05-19 16:40:37,118 - ***** Epoch: 17: Eval results *****
2024-05-19 16:40:37,118 -   binary_train_loss = 0.1341
2024-05-19 16:40:37,118 -   binary_eval_score = 0.9675
2024-05-19 16:40:37,118 -   train_loss = 2.0189
2024-05-19 16:40:37,118 -   eval_score = 0.4295
2024-05-19 16:40:37,118 -   best_eval_score = 0.5823
2024-05-19 16:40:37,118 - EarlyStopping counter: 2 out of 3
2024-05-19 16:43:58,965 - ***** Epoch: 18: Eval results *****
2024-05-19 16:43:58,965 -   binary_train_loss = 0.1391
2024-05-19 16:43:58,965 -   binary_eval_score = 0.9711
2024-05-19 16:43:58,965 -   train_loss = 0.7396
2024-05-19 16:43:58,965 -   eval_score = 0.5371
2024-05-19 16:43:58,965 -   best_eval_score = 0.5823
2024-05-19 16:43:58,965 - EarlyStopping counter: 3 out of 3
2024-05-19 16:43:58,965 - EarlyStopping at epoch 18
2024-05-19 16:43:58,967 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_CosClass_msz/msz_MIntRec2_bert-base-uncased_multi-class_4/models
2024-05-19 16:44:05,394 - Training is finished...
2024-05-19 16:44:05,395 - Testing begins...
2024-05-19 16:44:56,649 - ***** Out-of-domain Evaluation results *****
2024-05-19 16:44:56,649 -   aupr_in = 0.7977
2024-05-19 16:44:56,649 -   aupr_out = 0.5741
2024-05-19 16:44:56,649 -   auroc = 0.7114
2024-05-19 16:44:56,649 -   der = 0.5395
2024-05-19 16:44:56,649 -   eer = 0.3509
2024-05-19 16:44:56,649 -   fpr95 = 0.8279
2024-05-19 16:44:56,650 - Testing is finished...
2024-05-19 16:44:56,650 - Multimodal intent recognition is finished...
2024-05-19 16:44:56,650 - Results are saved in results/results_msz_ablation_MIntRec2.csv
