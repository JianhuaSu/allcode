2024-05-15 09:32:18,355 - Lists of intent labels are: ['Complain', 'Praise', 'Apologise', 'Thank', 'Criticize', 'Agree', 'Taunt', 'Flaunt', 'Joke', 'Oppose', 'Comfort', 'Care', 'Inform', 'Advise', 'Arrange', 'Introduce', 'Leave', 'Prevent', 'Greet', 'Ask for help']
2024-05-15 09:32:18,356 - ID Data preparation...
2024-05-15 09:32:34,142 - OOD Data preparation...
2024-05-15 09:32:40,494 - ============================== Params ==============================
2024-05-15 09:32:40,494 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-15 09:32:40,494 - dataset: MIntRec
2024-05-15 09:32:40,494 - ood_dataset: MIntRec-OOD
2024-05-15 09:32:40,494 - data_mode: multi-class
2024-05-15 09:32:40,494 - multimodal_method: msz
2024-05-15 09:32:40,494 - method: msz
2024-05-15 09:32:40,495 - ood_detection_method: ma
2024-05-15 09:32:40,495 - text_backbone: bert-base-uncased
2024-05-15 09:32:40,495 - seed: 0
2024-05-15 09:32:40,495 - num_workers: 8
2024-05-15 09:32:40,495 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-15-09-32-18
2024-05-15 09:32:40,495 - gpu_id: 0
2024-05-15 09:32:40,495 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-15 09:32:40,495 - train: True
2024-05-15 09:32:40,495 - tune: True
2024-05-15 09:32:40,495 - ood: True
2024-05-15 09:32:40,495 - save_model: True
2024-05-15 09:32:40,495 - save_results: True
2024-05-15 09:32:40,495 - log_path: logs
2024-05-15 09:32:40,495 - cache_path: cache
2024-05-15 09:32:40,495 - video_data_path: video_data
2024-05-15 09:32:40,495 - audio_data_path: audio_data
2024-05-15 09:32:40,495 - video_feats_path: swin_feats.pkl
2024-05-15 09:32:40,495 - ood_video_feats_path: swin_feats.pkl
2024-05-15 09:32:40,495 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-15 09:32:40,495 - audio_feats_path: wavlm_feats.pkl
2024-05-15 09:32:40,495 - results_path: results
2024-05-15 09:32:40,495 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz
2024-05-15 09:32:40,495 - model_path: models
2024-05-15 09:32:40,495 - config_file_name: msz_MIntRec
2024-05-15 09:32:40,495 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-15 09:32:40,495 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-15 09:32:40,495 - text_seq_len: 30
2024-05-15 09:32:40,495 - video_seq_len: 230
2024-05-15 09:32:40,495 - audio_seq_len: 480
2024-05-15 09:32:40,495 - text_feat_dim: 768
2024-05-15 09:32:40,495 - video_feat_dim: 1024
2024-05-15 09:32:40,495 - audio_feat_dim: 768
2024-05-15 09:32:40,495 - ood_label_id: 20
2024-05-15 09:32:40,495 - num_labels: 20
2024-05-15 09:32:40,495 - num_train_examples: 1334
2024-05-15 09:32:40,495 - need_aligned: True
2024-05-15 09:32:40,495 - freeze_parameters: False
2024-05-15 09:32:40,496 - eval_monitor: acc
2024-05-15 09:32:40,496 - train_batch_size: 32
2024-05-15 09:32:40,496 - eval_batch_size: 16
2024-05-15 09:32:40,496 - num_train_epochs: 100
2024-05-15 09:32:40,496 - lr: [2e-05]
2024-05-15 09:32:40,496 - weight_decay: [0.1]
2024-05-15 09:32:40,496 - wait_patience: 5
2024-05-15 09:32:40,496 - warmup_proportion: [0.01]
2024-05-15 09:32:40,496 - hidden_dims: [768]
2024-05-15 09:32:40,496 - num_attention_heads: [8]
2024-05-15 09:32:40,496 - attention_probs_dropout_prob: [0.3]
2024-05-15 09:32:40,496 - hidden_dropout_prob: [0.2]
2024-05-15 09:32:40,496 - intermediate_size: [768]
2024-05-15 09:32:40,496 - num_hidden_layers: [4]
2024-05-15 09:32:40,496 - max_position_embeddings: [900]
2024-05-15 09:32:40,496 - position_embedding_type: absolute
2024-05-15 09:32:40,496 - batch_first: True
2024-05-15 09:32:40,496 - aligned_method: ['ctc']
2024-05-15 09:32:40,496 - sampler: beta
2024-05-15 09:32:40,496 - multiple_ood: [1]
2024-05-15 09:32:40,496 - select_number_min: [2]
2024-05-15 09:32:40,496 - select_number_max: [3]
2024-05-15 09:32:40,496 - alpha: [4]
2024-05-15 09:32:40,496 - mlp_hidden_size: [256]
2024-05-15 09:32:40,496 - mlp_dropout: [0.3]
2024-05-15 09:32:40,496 - scale: [8]
2024-05-15 09:32:40,496 - ablation: no_fusion_cat
2024-05-15 09:32:40,496 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/msz_MIntRec_bert-base-uncased_multi-class_0
2024-05-15 09:32:40,496 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/msz_MIntRec_bert-base-uncased_multi-class_0/models
2024-05-15 09:32:40,496 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/binary_msz_MIntRec_bert-base-uncased_0
2024-05-15 09:32:40,496 - ============================== End Params ==============================
2024-05-15 09:32:46,077 - Multimodal Intent Recognition begins...
2024-05-15 09:32:46,077 - Training begins...
2024-05-15 09:33:05,128 - ***** Epoch: 1: Eval results *****
2024-05-15 09:33:05,128 -   binary_train_loss = 0.693
2024-05-15 09:33:05,128 -   binary_eval_score = 0.5101
2024-05-15 09:33:05,128 -   train_loss = 2.7973
2024-05-15 09:33:05,128 -   eval_score = 0.4067
2024-05-15 09:33:05,129 -   best_eval_score = 0.0
2024-05-15 09:33:23,270 - ***** Epoch: 2: Eval results *****
2024-05-15 09:33:23,270 -   binary_train_loss = 0.6949
2024-05-15 09:33:23,270 -   binary_eval_score = 0.5112
2024-05-15 09:33:23,270 -   train_loss = 1.8495
2024-05-15 09:33:23,270 -   eval_score = 0.6584
2024-05-15 09:33:23,270 -   best_eval_score = 0.4067
2024-05-15 09:33:40,856 - ***** Epoch: 3: Eval results *****
2024-05-15 09:33:40,857 -   binary_train_loss = 0.6883
2024-05-15 09:33:40,857 -   binary_eval_score = 0.6449
2024-05-15 09:33:40,857 -   train_loss = 0.8939
2024-05-15 09:33:40,857 -   eval_score = 0.6876
2024-05-15 09:33:40,857 -   best_eval_score = 0.6584
2024-05-15 09:33:58,193 - ***** Epoch: 4: Eval results *****
2024-05-15 09:33:58,193 -   binary_train_loss = 0.6856
2024-05-15 09:33:58,193 -   binary_eval_score = 0.709
2024-05-15 09:33:58,193 -   train_loss = 0.404
2024-05-15 09:33:58,193 -   eval_score = 0.7101
2024-05-15 09:33:58,194 -   best_eval_score = 0.6876
2024-05-15 09:34:16,184 - ***** Epoch: 5: Eval results *****
2024-05-15 09:34:16,184 -   binary_train_loss = 0.6821
2024-05-15 09:34:16,185 -   binary_eval_score = 0.7225
2024-05-15 09:34:16,185 -   train_loss = 0.2112
2024-05-15 09:34:16,185 -   eval_score = 0.7101
2024-05-15 09:34:16,185 -   best_eval_score = 0.7101
2024-05-15 09:34:16,185 - EarlyStopping counter: 1 out of 5
2024-05-15 09:34:34,650 - ***** Epoch: 6: Eval results *****
2024-05-15 09:34:34,650 -   binary_train_loss = 0.6773
2024-05-15 09:34:34,650 -   binary_eval_score = 0.7258
2024-05-15 09:34:34,650 -   train_loss = 0.1202
2024-05-15 09:34:34,650 -   eval_score = 0.7303
2024-05-15 09:34:34,650 -   best_eval_score = 0.7101
2024-05-15 09:34:52,079 - ***** Epoch: 7: Eval results *****
2024-05-15 09:34:52,079 -   binary_train_loss = 0.6733
2024-05-15 09:34:52,079 -   binary_eval_score = 0.7551
2024-05-15 09:34:52,079 -   train_loss = 0.0758
2024-05-15 09:34:52,079 -   eval_score = 0.7034
2024-05-15 09:34:52,079 -   best_eval_score = 0.7303
2024-05-15 09:34:52,079 - EarlyStopping counter: 1 out of 5
2024-05-15 09:35:11,353 - ***** Epoch: 8: Eval results *****
2024-05-15 09:35:11,353 -   binary_train_loss = 0.6689
2024-05-15 09:35:11,353 -   binary_eval_score = 0.7562
2024-05-15 09:35:11,353 -   train_loss = 0.0491
2024-05-15 09:35:11,353 -   eval_score = 0.7191
2024-05-15 09:35:11,353 -   best_eval_score = 0.7303
2024-05-15 09:35:11,353 - EarlyStopping counter: 2 out of 5
2024-05-15 09:35:29,214 - ***** Epoch: 9: Eval results *****
2024-05-15 09:35:29,214 -   binary_train_loss = 0.6624
2024-05-15 09:35:29,214 -   binary_eval_score = 0.773
2024-05-15 09:35:29,214 -   train_loss = 0.0389
2024-05-15 09:35:29,215 -   eval_score = 0.7213
2024-05-15 09:35:29,215 -   best_eval_score = 0.7303
2024-05-15 09:35:29,215 - EarlyStopping counter: 3 out of 5
2024-05-15 09:35:46,928 - ***** Epoch: 10: Eval results *****
2024-05-15 09:35:46,929 -   binary_train_loss = 0.655
2024-05-15 09:35:46,929 -   binary_eval_score = 0.7584
2024-05-15 09:35:46,929 -   train_loss = 0.0371
2024-05-15 09:35:46,929 -   eval_score = 0.7258
2024-05-15 09:35:46,929 -   best_eval_score = 0.7303
2024-05-15 09:35:46,929 - EarlyStopping counter: 4 out of 5
2024-05-15 09:36:05,360 - ***** Epoch: 11: Eval results *****
2024-05-15 09:36:05,360 -   binary_train_loss = 0.6465
2024-05-15 09:36:05,360 -   binary_eval_score = 0.7708
2024-05-15 09:36:05,360 -   train_loss = 0.0307
2024-05-15 09:36:05,360 -   eval_score = 0.7258
2024-05-15 09:36:05,360 -   best_eval_score = 0.7303
2024-05-15 09:36:05,360 - EarlyStopping counter: 5 out of 5
2024-05-15 09:36:05,360 - EarlyStopping at epoch 11
2024-05-15 09:36:05,362 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/msz_MIntRec_bert-base-uncased_multi-class_0/models
2024-05-15 09:36:11,223 - Training is finished...
2024-05-15 09:36:11,224 - Testing begins...
2024-05-15 09:36:22,785 - ***** Out-of-domain Evaluation results *****
2024-05-15 09:36:22,785 -   aupr_in = 0.7282
2024-05-15 09:36:22,785 -   aupr_out = 0.6951
2024-05-15 09:36:22,785 -   auroc = 0.7326
2024-05-15 09:36:22,785 -   der = 0.417
2024-05-15 09:36:22,785 -   eer = 0.3311
2024-05-15 09:36:22,785 -   fpr95 = 0.7911
2024-05-15 09:36:22,785 - Testing is finished...
2024-05-15 09:36:22,785 - Multimodal intent recognition is finished...
2024-05-15 09:36:22,786 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-15 09:36:22,908 - ============================== Params ==============================
2024-05-15 09:36:22,908 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-15 09:36:22,908 - dataset: MIntRec
2024-05-15 09:36:22,908 - ood_dataset: MIntRec-OOD
2024-05-15 09:36:22,908 - data_mode: multi-class
2024-05-15 09:36:22,908 - multimodal_method: msz
2024-05-15 09:36:22,908 - method: msz
2024-05-15 09:36:22,908 - ood_detection_method: ma
2024-05-15 09:36:22,908 - text_backbone: bert-base-uncased
2024-05-15 09:36:22,908 - seed: 1
2024-05-15 09:36:22,908 - num_workers: 8
2024-05-15 09:36:22,908 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-15-09-32-18
2024-05-15 09:36:22,908 - gpu_id: 0
2024-05-15 09:36:22,909 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-15 09:36:22,909 - train: True
2024-05-15 09:36:22,909 - tune: True
2024-05-15 09:36:22,909 - ood: True
2024-05-15 09:36:22,909 - save_model: True
2024-05-15 09:36:22,909 - save_results: True
2024-05-15 09:36:22,909 - log_path: logs
2024-05-15 09:36:22,909 - cache_path: cache
2024-05-15 09:36:22,909 - video_data_path: video_data
2024-05-15 09:36:22,909 - audio_data_path: audio_data
2024-05-15 09:36:22,909 - video_feats_path: swin_feats.pkl
2024-05-15 09:36:22,909 - ood_video_feats_path: swin_feats.pkl
2024-05-15 09:36:22,909 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-15 09:36:22,909 - audio_feats_path: wavlm_feats.pkl
2024-05-15 09:36:22,909 - results_path: results
2024-05-15 09:36:22,909 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz
2024-05-15 09:36:22,909 - model_path: models
2024-05-15 09:36:22,909 - config_file_name: msz_MIntRec
2024-05-15 09:36:22,909 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-15 09:36:22,909 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-15 09:36:22,909 - text_seq_len: 30
2024-05-15 09:36:22,909 - video_seq_len: 230
2024-05-15 09:36:22,909 - audio_seq_len: 480
2024-05-15 09:36:22,909 - text_feat_dim: 768
2024-05-15 09:36:22,909 - video_feat_dim: 1024
2024-05-15 09:36:22,909 - audio_feat_dim: 768
2024-05-15 09:36:22,909 - ood_label_id: 20
2024-05-15 09:36:22,909 - num_labels: 20
2024-05-15 09:36:22,909 - num_train_examples: 1334
2024-05-15 09:36:22,909 - need_aligned: True
2024-05-15 09:36:22,909 - freeze_parameters: False
2024-05-15 09:36:22,909 - eval_monitor: acc
2024-05-15 09:36:22,909 - train_batch_size: 32
2024-05-15 09:36:22,909 - eval_batch_size: 16
2024-05-15 09:36:22,909 - num_train_epochs: 100
2024-05-15 09:36:22,909 - lr: [2e-05]
2024-05-15 09:36:22,909 - weight_decay: [0.1]
2024-05-15 09:36:22,909 - wait_patience: 5
2024-05-15 09:36:22,910 - warmup_proportion: [0.01]
2024-05-15 09:36:22,910 - hidden_dims: [768]
2024-05-15 09:36:22,910 - num_attention_heads: [8]
2024-05-15 09:36:22,910 - attention_probs_dropout_prob: [0.3]
2024-05-15 09:36:22,910 - hidden_dropout_prob: [0.2]
2024-05-15 09:36:22,910 - intermediate_size: [768]
2024-05-15 09:36:22,910 - num_hidden_layers: [4]
2024-05-15 09:36:22,910 - max_position_embeddings: [900]
2024-05-15 09:36:22,910 - position_embedding_type: absolute
2024-05-15 09:36:22,910 - batch_first: True
2024-05-15 09:36:22,910 - aligned_method: ['ctc']
2024-05-15 09:36:22,910 - sampler: beta
2024-05-15 09:36:22,910 - multiple_ood: [1]
2024-05-15 09:36:22,910 - select_number_min: [2]
2024-05-15 09:36:22,910 - select_number_max: [3]
2024-05-15 09:36:22,910 - alpha: [4]
2024-05-15 09:36:22,910 - mlp_hidden_size: [256]
2024-05-15 09:36:22,910 - mlp_dropout: [0.3]
2024-05-15 09:36:22,910 - scale: [8]
2024-05-15 09:36:22,910 - ablation: no_fusion_cat
2024-05-15 09:36:22,910 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/msz_MIntRec_bert-base-uncased_multi-class_1
2024-05-15 09:36:22,910 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-15 09:36:22,910 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/binary_msz_MIntRec_bert-base-uncased_1
2024-05-15 09:36:22,910 - device: cuda
2024-05-15 09:36:22,910 - ============================== End Params ==============================
2024-05-15 09:36:24,574 - Multimodal Intent Recognition begins...
2024-05-15 09:36:24,574 - Training begins...
2024-05-15 09:36:42,550 - ***** Epoch: 1: Eval results *****
2024-05-15 09:36:42,551 -   binary_train_loss = 0.6946
2024-05-15 09:36:42,551 -   binary_eval_score = 0.5539
2024-05-15 09:36:42,551 -   train_loss = 2.7927
2024-05-15 09:36:42,551 -   eval_score = 0.2989
2024-05-15 09:36:42,551 -   best_eval_score = 0.0
2024-05-15 09:37:00,372 - ***** Epoch: 2: Eval results *****
2024-05-15 09:37:00,373 -   binary_train_loss = 0.697
2024-05-15 09:37:00,373 -   binary_eval_score = 0.5596
2024-05-15 09:37:00,373 -   train_loss = 1.8289
2024-05-15 09:37:00,373 -   eval_score = 0.6382
2024-05-15 09:37:00,373 -   best_eval_score = 0.2989
2024-05-15 09:37:19,005 - ***** Epoch: 3: Eval results *****
2024-05-15 09:37:19,005 -   binary_train_loss = 0.687
2024-05-15 09:37:19,005 -   binary_eval_score = 0.7045
2024-05-15 09:37:19,005 -   train_loss = 0.9265
2024-05-15 09:37:19,005 -   eval_score = 0.7034
2024-05-15 09:37:19,005 -   best_eval_score = 0.6382
2024-05-15 09:37:36,642 - ***** Epoch: 4: Eval results *****
2024-05-15 09:37:36,642 -   binary_train_loss = 0.6833
2024-05-15 09:37:36,642 -   binary_eval_score = 0.7371
2024-05-15 09:37:36,642 -   train_loss = 0.4361
2024-05-15 09:37:36,642 -   eval_score = 0.7258
2024-05-15 09:37:36,642 -   best_eval_score = 0.7034
2024-05-15 09:37:54,606 - ***** Epoch: 5: Eval results *****
2024-05-15 09:37:54,607 -   binary_train_loss = 0.6771
2024-05-15 09:37:54,607 -   binary_eval_score = 0.7719
2024-05-15 09:37:54,607 -   train_loss = 0.2486
2024-05-15 09:37:54,607 -   eval_score = 0.7213
2024-05-15 09:37:54,607 -   best_eval_score = 0.7258
2024-05-15 09:37:54,607 - EarlyStopping counter: 1 out of 5
2024-05-15 09:38:12,690 - ***** Epoch: 6: Eval results *****
2024-05-15 09:38:12,690 -   binary_train_loss = 0.6753
2024-05-15 09:38:12,690 -   binary_eval_score = 0.7573
2024-05-15 09:38:12,690 -   train_loss = 0.1184
2024-05-15 09:38:12,691 -   eval_score = 0.7213
2024-05-15 09:38:12,691 -   best_eval_score = 0.7258
2024-05-15 09:38:12,691 - EarlyStopping counter: 2 out of 5
2024-05-15 09:38:31,516 - ***** Epoch: 7: Eval results *****
2024-05-15 09:38:31,516 -   binary_train_loss = 0.6704
2024-05-15 09:38:31,516 -   binary_eval_score = 0.7809
2024-05-15 09:38:31,516 -   train_loss = 0.0782
2024-05-15 09:38:31,517 -   eval_score = 0.7191
2024-05-15 09:38:31,517 -   best_eval_score = 0.7258
2024-05-15 09:38:31,517 - EarlyStopping counter: 3 out of 5
2024-05-15 09:38:49,977 - ***** Epoch: 8: Eval results *****
2024-05-15 09:38:49,977 -   binary_train_loss = 0.6638
2024-05-15 09:38:49,977 -   binary_eval_score = 0.8146
2024-05-15 09:38:49,977 -   train_loss = 0.0554
2024-05-15 09:38:49,977 -   eval_score = 0.7258
2024-05-15 09:38:49,977 -   best_eval_score = 0.7258
2024-05-15 09:38:49,978 - EarlyStopping counter: 4 out of 5
2024-05-15 09:39:07,793 - ***** Epoch: 9: Eval results *****
2024-05-15 09:39:07,793 -   binary_train_loss = 0.6552
2024-05-15 09:39:07,793 -   binary_eval_score = 0.7742
2024-05-15 09:39:07,793 -   train_loss = 0.0439
2024-05-15 09:39:07,793 -   eval_score = 0.7303
2024-05-15 09:39:07,793 -   best_eval_score = 0.7258
2024-05-15 09:39:26,908 - ***** Epoch: 10: Eval results *****
2024-05-15 09:39:26,909 -   binary_train_loss = 0.6494
2024-05-15 09:39:26,909 -   binary_eval_score = 0.8124
2024-05-15 09:39:26,909 -   train_loss = 0.0347
2024-05-15 09:39:26,909 -   eval_score = 0.7281
2024-05-15 09:39:26,909 -   best_eval_score = 0.7303
2024-05-15 09:39:26,909 - EarlyStopping counter: 1 out of 5
2024-05-15 09:39:45,729 - ***** Epoch: 11: Eval results *****
2024-05-15 09:39:45,729 -   binary_train_loss = 0.6419
2024-05-15 09:39:45,729 -   binary_eval_score = 0.8011
2024-05-15 09:39:45,729 -   train_loss = 0.0334
2024-05-15 09:39:45,729 -   eval_score = 0.7236
2024-05-15 09:39:45,729 -   best_eval_score = 0.7303
2024-05-15 09:39:45,729 - EarlyStopping counter: 2 out of 5
2024-05-15 09:40:04,326 - ***** Epoch: 12: Eval results *****
2024-05-15 09:40:04,326 -   binary_train_loss = 0.6328
2024-05-15 09:40:04,326 -   binary_eval_score = 0.8315
2024-05-15 09:40:04,326 -   train_loss = 0.0296
2024-05-15 09:40:04,326 -   eval_score = 0.7236
2024-05-15 09:40:04,326 -   best_eval_score = 0.7303
2024-05-15 09:40:04,327 - EarlyStopping counter: 3 out of 5
2024-05-15 09:40:22,891 - ***** Epoch: 13: Eval results *****
2024-05-15 09:40:22,891 -   binary_train_loss = 0.6273
2024-05-15 09:40:22,891 -   binary_eval_score = 0.8416
2024-05-15 09:40:22,891 -   train_loss = 0.0289
2024-05-15 09:40:22,891 -   eval_score = 0.7236
2024-05-15 09:40:22,891 -   best_eval_score = 0.7303
2024-05-15 09:40:22,891 - EarlyStopping counter: 4 out of 5
2024-05-15 09:40:41,452 - ***** Epoch: 14: Eval results *****
2024-05-15 09:40:41,453 -   binary_train_loss = 0.6178
2024-05-15 09:40:41,453 -   binary_eval_score = 0.8191
2024-05-15 09:40:41,453 -   train_loss = 0.0314
2024-05-15 09:40:41,453 -   eval_score = 0.7146
2024-05-15 09:40:41,453 -   best_eval_score = 0.7303
2024-05-15 09:40:41,453 - EarlyStopping counter: 5 out of 5
2024-05-15 09:40:41,453 - EarlyStopping at epoch 14
2024-05-15 09:40:41,456 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-15 09:40:42,824 - Training is finished...
2024-05-15 09:40:42,825 - Testing begins...
2024-05-15 09:40:55,240 - ***** Out-of-domain Evaluation results *****
2024-05-15 09:40:55,240 -   aupr_in = 0.7348
2024-05-15 09:40:55,240 -   aupr_out = 0.7249
2024-05-15 09:40:55,240 -   auroc = 0.7519
2024-05-15 09:40:55,240 -   der = 0.4016
2024-05-15 09:40:55,240 -   eer = 0.3222
2024-05-15 09:40:55,240 -   fpr95 = 0.7578
2024-05-15 09:40:55,240 - Testing is finished...
2024-05-15 09:40:55,240 - Multimodal intent recognition is finished...
2024-05-15 09:40:55,240 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-15 09:40:55,887 - ============================== Params ==============================
2024-05-15 09:40:55,887 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-15 09:40:55,887 - dataset: MIntRec
2024-05-15 09:40:55,887 - ood_dataset: MIntRec-OOD
2024-05-15 09:40:55,887 - data_mode: multi-class
2024-05-15 09:40:55,888 - multimodal_method: msz
2024-05-15 09:40:55,888 - method: msz
2024-05-15 09:40:55,888 - ood_detection_method: ma
2024-05-15 09:40:55,888 - text_backbone: bert-base-uncased
2024-05-15 09:40:55,888 - seed: 2
2024-05-15 09:40:55,888 - num_workers: 8
2024-05-15 09:40:55,888 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-15-09-32-18
2024-05-15 09:40:55,888 - gpu_id: 0
2024-05-15 09:40:55,888 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-15 09:40:55,888 - train: True
2024-05-15 09:40:55,888 - tune: True
2024-05-15 09:40:55,888 - ood: True
2024-05-15 09:40:55,888 - save_model: True
2024-05-15 09:40:55,888 - save_results: True
2024-05-15 09:40:55,888 - log_path: logs
2024-05-15 09:40:55,888 - cache_path: cache
2024-05-15 09:40:55,888 - video_data_path: video_data
2024-05-15 09:40:55,888 - audio_data_path: audio_data
2024-05-15 09:40:55,888 - video_feats_path: swin_feats.pkl
2024-05-15 09:40:55,888 - ood_video_feats_path: swin_feats.pkl
2024-05-15 09:40:55,888 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-15 09:40:55,888 - audio_feats_path: wavlm_feats.pkl
2024-05-15 09:40:55,888 - results_path: results
2024-05-15 09:40:55,888 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz
2024-05-15 09:40:55,888 - model_path: models
2024-05-15 09:40:55,888 - config_file_name: msz_MIntRec
2024-05-15 09:40:55,888 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-15 09:40:55,889 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-15 09:40:55,889 - text_seq_len: 30
2024-05-15 09:40:55,889 - video_seq_len: 230
2024-05-15 09:40:55,889 - audio_seq_len: 480
2024-05-15 09:40:55,889 - text_feat_dim: 768
2024-05-15 09:40:55,889 - video_feat_dim: 1024
2024-05-15 09:40:55,889 - audio_feat_dim: 768
2024-05-15 09:40:55,889 - ood_label_id: 20
2024-05-15 09:40:55,889 - num_labels: 20
2024-05-15 09:40:55,889 - num_train_examples: 1334
2024-05-15 09:40:55,889 - need_aligned: True
2024-05-15 09:40:55,889 - freeze_parameters: False
2024-05-15 09:40:55,889 - eval_monitor: acc
2024-05-15 09:40:55,889 - train_batch_size: 32
2024-05-15 09:40:55,889 - eval_batch_size: 16
2024-05-15 09:40:55,889 - num_train_epochs: 100
2024-05-15 09:40:55,889 - lr: [2e-05]
2024-05-15 09:40:55,889 - weight_decay: [0.1]
2024-05-15 09:40:55,889 - wait_patience: 5
2024-05-15 09:40:55,889 - warmup_proportion: [0.01]
2024-05-15 09:40:55,889 - hidden_dims: [768]
2024-05-15 09:40:55,889 - num_attention_heads: [8]
2024-05-15 09:40:55,889 - attention_probs_dropout_prob: [0.3]
2024-05-15 09:40:55,889 - hidden_dropout_prob: [0.2]
2024-05-15 09:40:55,889 - intermediate_size: [768]
2024-05-15 09:40:55,889 - num_hidden_layers: [4]
2024-05-15 09:40:55,889 - max_position_embeddings: [900]
2024-05-15 09:40:55,890 - position_embedding_type: absolute
2024-05-15 09:40:55,890 - batch_first: True
2024-05-15 09:40:55,890 - aligned_method: ['ctc']
2024-05-15 09:40:55,890 - sampler: beta
2024-05-15 09:40:55,890 - multiple_ood: [1]
2024-05-15 09:40:55,890 - select_number_min: [2]
2024-05-15 09:40:55,890 - select_number_max: [3]
2024-05-15 09:40:55,890 - alpha: [4]
2024-05-15 09:40:55,890 - mlp_hidden_size: [256]
2024-05-15 09:40:55,890 - mlp_dropout: [0.3]
2024-05-15 09:40:55,890 - scale: [8]
2024-05-15 09:40:55,890 - ablation: no_fusion_cat
2024-05-15 09:40:55,890 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/msz_MIntRec_bert-base-uncased_multi-class_2
2024-05-15 09:40:55,890 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-15 09:40:55,890 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/binary_msz_MIntRec_bert-base-uncased_2
2024-05-15 09:40:55,890 - device: cuda
2024-05-15 09:40:55,890 - ============================== End Params ==============================
2024-05-15 09:40:57,806 - Multimodal Intent Recognition begins...
2024-05-15 09:40:57,806 - Training begins...
2024-05-15 09:41:17,090 - ***** Epoch: 1: Eval results *****
2024-05-15 09:41:17,090 -   binary_train_loss = 0.6952
2024-05-15 09:41:17,090 -   binary_eval_score = 0.4865
2024-05-15 09:41:17,090 -   train_loss = 2.8098
2024-05-15 09:41:17,090 -   eval_score = 0.3551
2024-05-15 09:41:17,090 -   best_eval_score = 0.0
2024-05-15 09:41:36,466 - ***** Epoch: 2: Eval results *****
2024-05-15 09:41:36,466 -   binary_train_loss = 0.6964
2024-05-15 09:41:36,467 -   binary_eval_score = 0.509
2024-05-15 09:41:36,467 -   train_loss = 1.8668
2024-05-15 09:41:36,467 -   eval_score = 0.609
2024-05-15 09:41:36,467 -   best_eval_score = 0.3551
2024-05-15 09:41:55,273 - ***** Epoch: 3: Eval results *****
2024-05-15 09:41:55,273 -   binary_train_loss = 0.689
2024-05-15 09:41:55,273 -   binary_eval_score = 0.7202
2024-05-15 09:41:55,273 -   train_loss = 0.9513
2024-05-15 09:41:55,273 -   eval_score = 0.6899
2024-05-15 09:41:55,273 -   best_eval_score = 0.609
2024-05-15 09:42:13,729 - ***** Epoch: 4: Eval results *****
2024-05-15 09:42:13,729 -   binary_train_loss = 0.6841
2024-05-15 09:42:13,729 -   binary_eval_score = 0.6326
2024-05-15 09:42:13,729 -   train_loss = 0.6484
2024-05-15 09:42:13,729 -   eval_score = 0.7281
2024-05-15 09:42:13,729 -   best_eval_score = 0.6899
2024-05-15 09:42:31,725 - ***** Epoch: 5: Eval results *****
2024-05-15 09:42:31,725 -   binary_train_loss = 0.6817
2024-05-15 09:42:31,725 -   binary_eval_score = 0.6955
2024-05-15 09:42:31,725 -   train_loss = 0.2568
2024-05-15 09:42:31,725 -   eval_score = 0.7393
2024-05-15 09:42:31,725 -   best_eval_score = 0.7281
2024-05-15 09:42:50,072 - ***** Epoch: 6: Eval results *****
2024-05-15 09:42:50,072 -   binary_train_loss = 0.6755
2024-05-15 09:42:50,072 -   binary_eval_score = 0.7652
2024-05-15 09:42:50,072 -   train_loss = 0.1366
2024-05-15 09:42:50,073 -   eval_score = 0.7416
2024-05-15 09:42:50,073 -   best_eval_score = 0.7393
2024-05-15 09:43:08,498 - ***** Epoch: 7: Eval results *****
2024-05-15 09:43:08,498 -   binary_train_loss = 0.6696
2024-05-15 09:43:08,498 -   binary_eval_score = 0.7382
2024-05-15 09:43:08,498 -   train_loss = 0.0882
2024-05-15 09:43:08,498 -   eval_score = 0.7438
2024-05-15 09:43:08,499 -   best_eval_score = 0.7416
2024-05-15 09:43:26,874 - ***** Epoch: 8: Eval results *****
2024-05-15 09:43:26,874 -   binary_train_loss = 0.6646
2024-05-15 09:43:26,874 -   binary_eval_score = 0.7326
2024-05-15 09:43:26,874 -   train_loss = 0.0674
2024-05-15 09:43:26,874 -   eval_score = 0.7393
2024-05-15 09:43:26,875 -   best_eval_score = 0.7438
2024-05-15 09:43:26,875 - EarlyStopping counter: 1 out of 5
2024-05-15 09:43:46,241 - ***** Epoch: 9: Eval results *****
2024-05-15 09:43:46,242 -   binary_train_loss = 0.6582
2024-05-15 09:43:46,242 -   binary_eval_score = 0.7573
2024-05-15 09:43:46,242 -   train_loss = 0.0604
2024-05-15 09:43:46,242 -   eval_score = 0.7371
2024-05-15 09:43:46,242 -   best_eval_score = 0.7438
2024-05-15 09:43:46,242 - EarlyStopping counter: 2 out of 5
2024-05-15 09:44:05,662 - ***** Epoch: 10: Eval results *****
2024-05-15 09:44:05,662 -   binary_train_loss = 0.6536
2024-05-15 09:44:05,662 -   binary_eval_score = 0.7708
2024-05-15 09:44:05,662 -   train_loss = 0.0378
2024-05-15 09:44:05,662 -   eval_score = 0.7461
2024-05-15 09:44:05,662 -   best_eval_score = 0.7438
2024-05-15 09:44:25,464 - ***** Epoch: 11: Eval results *****
2024-05-15 09:44:25,465 -   binary_train_loss = 0.6469
2024-05-15 09:44:25,465 -   binary_eval_score = 0.8247
2024-05-15 09:44:25,465 -   train_loss = 0.0334
2024-05-15 09:44:25,465 -   eval_score = 0.7393
2024-05-15 09:44:25,465 -   best_eval_score = 0.7461
2024-05-15 09:44:25,465 - EarlyStopping counter: 1 out of 5
2024-05-15 09:44:44,764 - ***** Epoch: 12: Eval results *****
2024-05-15 09:44:44,764 -   binary_train_loss = 0.6372
2024-05-15 09:44:44,764 -   binary_eval_score = 0.7944
2024-05-15 09:44:44,764 -   train_loss = 0.0303
2024-05-15 09:44:44,764 -   eval_score = 0.7506
2024-05-15 09:44:44,764 -   best_eval_score = 0.7461
2024-05-15 09:45:03,706 - ***** Epoch: 13: Eval results *****
2024-05-15 09:45:03,707 -   binary_train_loss = 0.6288
2024-05-15 09:45:03,707 -   binary_eval_score = 0.8056
2024-05-15 09:45:03,707 -   train_loss = 0.0292
2024-05-15 09:45:03,707 -   eval_score = 0.7438
2024-05-15 09:45:03,707 -   best_eval_score = 0.7506
2024-05-15 09:45:03,707 - EarlyStopping counter: 1 out of 5
2024-05-15 09:45:22,200 - ***** Epoch: 14: Eval results *****
2024-05-15 09:45:22,200 -   binary_train_loss = 0.6244
2024-05-15 09:45:22,201 -   binary_eval_score = 0.8247
2024-05-15 09:45:22,201 -   train_loss = 0.0288
2024-05-15 09:45:22,201 -   eval_score = 0.7393
2024-05-15 09:45:22,201 -   best_eval_score = 0.7506
2024-05-15 09:45:22,201 - EarlyStopping counter: 2 out of 5
2024-05-15 09:45:40,936 - ***** Epoch: 15: Eval results *****
2024-05-15 09:45:40,937 -   binary_train_loss = 0.6113
2024-05-15 09:45:40,937 -   binary_eval_score = 0.8225
2024-05-15 09:45:40,937 -   train_loss = 0.0311
2024-05-15 09:45:40,937 -   eval_score = 0.7416
2024-05-15 09:45:40,937 -   best_eval_score = 0.7506
2024-05-15 09:45:40,937 - EarlyStopping counter: 3 out of 5
2024-05-15 09:45:59,807 - ***** Epoch: 16: Eval results *****
2024-05-15 09:45:59,807 -   binary_train_loss = 0.6113
2024-05-15 09:45:59,807 -   binary_eval_score = 0.8135
2024-05-15 09:45:59,807 -   train_loss = 0.0317
2024-05-15 09:45:59,807 -   eval_score = 0.7438
2024-05-15 09:45:59,807 -   best_eval_score = 0.7506
2024-05-15 09:45:59,807 - EarlyStopping counter: 4 out of 5
2024-05-15 09:46:17,904 - ***** Epoch: 17: Eval results *****
2024-05-15 09:46:17,905 -   binary_train_loss = 0.6064
2024-05-15 09:46:17,905 -   binary_eval_score = 0.8315
2024-05-15 09:46:17,905 -   train_loss = 0.0373
2024-05-15 09:46:17,905 -   eval_score = 0.7393
2024-05-15 09:46:17,905 -   best_eval_score = 0.7506
2024-05-15 09:46:17,905 - EarlyStopping counter: 5 out of 5
2024-05-15 09:46:17,906 - EarlyStopping at epoch 17
2024-05-15 09:46:17,910 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-15 09:46:18,877 - Training is finished...
2024-05-15 09:46:18,877 - Testing begins...
2024-05-15 09:46:31,106 - ***** Out-of-domain Evaluation results *****
2024-05-15 09:46:31,106 -   aupr_in = 0.725
2024-05-15 09:46:31,107 -   aupr_out = 0.7138
2024-05-15 09:46:31,107 -   auroc = 0.7405
2024-05-15 09:46:31,107 -   der = 0.4116
2024-05-15 09:46:31,107 -   eer = 0.3267
2024-05-15 09:46:31,107 -   fpr95 = 0.7778
2024-05-15 09:46:31,107 - Testing is finished...
2024-05-15 09:46:31,107 - Multimodal intent recognition is finished...
2024-05-15 09:46:31,107 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-15 09:46:31,807 - ============================== Params ==============================
2024-05-15 09:46:31,807 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-15 09:46:31,807 - dataset: MIntRec
2024-05-15 09:46:31,807 - ood_dataset: MIntRec-OOD
2024-05-15 09:46:31,807 - data_mode: multi-class
2024-05-15 09:46:31,807 - multimodal_method: msz
2024-05-15 09:46:31,807 - method: msz
2024-05-15 09:46:31,807 - ood_detection_method: ma
2024-05-15 09:46:31,807 - text_backbone: bert-base-uncased
2024-05-15 09:46:31,807 - seed: 3
2024-05-15 09:46:31,807 - num_workers: 8
2024-05-15 09:46:31,807 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-15-09-32-18
2024-05-15 09:46:31,807 - gpu_id: 0
2024-05-15 09:46:31,807 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-15 09:46:31,808 - train: True
2024-05-15 09:46:31,808 - tune: True
2024-05-15 09:46:31,808 - ood: True
2024-05-15 09:46:31,808 - save_model: True
2024-05-15 09:46:31,808 - save_results: True
2024-05-15 09:46:31,808 - log_path: logs
2024-05-15 09:46:31,808 - cache_path: cache
2024-05-15 09:46:31,808 - video_data_path: video_data
2024-05-15 09:46:31,808 - audio_data_path: audio_data
2024-05-15 09:46:31,808 - video_feats_path: swin_feats.pkl
2024-05-15 09:46:31,808 - ood_video_feats_path: swin_feats.pkl
2024-05-15 09:46:31,808 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-15 09:46:31,808 - audio_feats_path: wavlm_feats.pkl
2024-05-15 09:46:31,808 - results_path: results
2024-05-15 09:46:31,808 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz
2024-05-15 09:46:31,808 - model_path: models
2024-05-15 09:46:31,808 - config_file_name: msz_MIntRec
2024-05-15 09:46:31,808 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-15 09:46:31,808 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-15 09:46:31,808 - text_seq_len: 30
2024-05-15 09:46:31,808 - video_seq_len: 230
2024-05-15 09:46:31,808 - audio_seq_len: 480
2024-05-15 09:46:31,808 - text_feat_dim: 768
2024-05-15 09:46:31,808 - video_feat_dim: 1024
2024-05-15 09:46:31,808 - audio_feat_dim: 768
2024-05-15 09:46:31,808 - ood_label_id: 20
2024-05-15 09:46:31,808 - num_labels: 20
2024-05-15 09:46:31,808 - num_train_examples: 1334
2024-05-15 09:46:31,808 - need_aligned: True
2024-05-15 09:46:31,809 - freeze_parameters: False
2024-05-15 09:46:31,809 - eval_monitor: acc
2024-05-15 09:46:31,809 - train_batch_size: 32
2024-05-15 09:46:31,809 - eval_batch_size: 16
2024-05-15 09:46:31,809 - num_train_epochs: 100
2024-05-15 09:46:31,809 - lr: [2e-05]
2024-05-15 09:46:31,809 - weight_decay: [0.1]
2024-05-15 09:46:31,809 - wait_patience: 5
2024-05-15 09:46:31,809 - warmup_proportion: [0.01]
2024-05-15 09:46:31,809 - hidden_dims: [768]
2024-05-15 09:46:31,809 - num_attention_heads: [8]
2024-05-15 09:46:31,809 - attention_probs_dropout_prob: [0.3]
2024-05-15 09:46:31,809 - hidden_dropout_prob: [0.2]
2024-05-15 09:46:31,809 - intermediate_size: [768]
2024-05-15 09:46:31,809 - num_hidden_layers: [4]
2024-05-15 09:46:31,809 - max_position_embeddings: [900]
2024-05-15 09:46:31,809 - position_embedding_type: absolute
2024-05-15 09:46:31,809 - batch_first: True
2024-05-15 09:46:31,809 - aligned_method: ['ctc']
2024-05-15 09:46:31,809 - sampler: beta
2024-05-15 09:46:31,809 - multiple_ood: [1]
2024-05-15 09:46:31,809 - select_number_min: [2]
2024-05-15 09:46:31,809 - select_number_max: [3]
2024-05-15 09:46:31,809 - alpha: [4]
2024-05-15 09:46:31,809 - mlp_hidden_size: [256]
2024-05-15 09:46:31,809 - mlp_dropout: [0.3]
2024-05-15 09:46:31,809 - scale: [8]
2024-05-15 09:46:31,809 - ablation: no_fusion_cat
2024-05-15 09:46:31,809 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/msz_MIntRec_bert-base-uncased_multi-class_3
2024-05-15 09:46:31,810 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-15 09:46:31,810 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/binary_msz_MIntRec_bert-base-uncased_3
2024-05-15 09:46:31,810 - device: cuda
2024-05-15 09:46:31,810 - ============================== End Params ==============================
2024-05-15 09:46:33,798 - Multimodal Intent Recognition begins...
2024-05-15 09:46:33,798 - Training begins...
2024-05-15 09:46:53,484 - ***** Epoch: 1: Eval results *****
2024-05-15 09:46:53,485 -   binary_train_loss = 0.6936
2024-05-15 09:46:53,485 -   binary_eval_score = 0.4876
2024-05-15 09:46:53,485 -   train_loss = 2.8154
2024-05-15 09:46:53,485 -   eval_score = 0.2517
2024-05-15 09:46:53,485 -   best_eval_score = 0.0
2024-05-15 09:47:12,020 - ***** Epoch: 2: Eval results *****
2024-05-15 09:47:12,020 -   binary_train_loss = 0.694
2024-05-15 09:47:12,020 -   binary_eval_score = 0.5236
2024-05-15 09:47:12,020 -   train_loss = 1.8508
2024-05-15 09:47:12,020 -   eval_score = 0.6517
2024-05-15 09:47:12,020 -   best_eval_score = 0.2517
2024-05-15 09:47:31,280 - ***** Epoch: 3: Eval results *****
2024-05-15 09:47:31,280 -   binary_train_loss = 0.6895
2024-05-15 09:47:31,280 -   binary_eval_score = 0.6944
2024-05-15 09:47:31,280 -   train_loss = 0.9651
2024-05-15 09:47:31,280 -   eval_score = 0.6944
2024-05-15 09:47:31,280 -   best_eval_score = 0.6517
2024-05-15 09:47:50,020 - ***** Epoch: 4: Eval results *****
2024-05-15 09:47:50,021 -   binary_train_loss = 0.6855
2024-05-15 09:47:50,021 -   binary_eval_score = 0.6888
2024-05-15 09:47:50,021 -   train_loss = 0.4849
2024-05-15 09:47:50,021 -   eval_score = 0.7079
2024-05-15 09:47:50,021 -   best_eval_score = 0.6944
2024-05-15 09:48:09,466 - ***** Epoch: 5: Eval results *****
2024-05-15 09:48:09,466 -   binary_train_loss = 0.6834
2024-05-15 09:48:09,466 -   binary_eval_score = 0.6685
2024-05-15 09:48:09,466 -   train_loss = 0.2752
2024-05-15 09:48:09,466 -   eval_score = 0.7124
2024-05-15 09:48:09,467 -   best_eval_score = 0.7079
2024-05-15 09:48:28,281 - ***** Epoch: 6: Eval results *****
2024-05-15 09:48:28,282 -   binary_train_loss = 0.6794
2024-05-15 09:48:28,282 -   binary_eval_score = 0.7056
2024-05-15 09:48:28,282 -   train_loss = 0.1359
2024-05-15 09:48:28,282 -   eval_score = 0.7326
2024-05-15 09:48:28,282 -   best_eval_score = 0.7124
2024-05-15 09:48:48,208 - ***** Epoch: 7: Eval results *****
2024-05-15 09:48:48,208 -   binary_train_loss = 0.6751
2024-05-15 09:48:48,209 -   binary_eval_score = 0.736
2024-05-15 09:48:48,209 -   train_loss = 0.0731
2024-05-15 09:48:48,209 -   eval_score = 0.7236
2024-05-15 09:48:48,209 -   best_eval_score = 0.7326
2024-05-15 09:48:48,209 - EarlyStopping counter: 1 out of 5
2024-05-15 09:49:07,910 - ***** Epoch: 8: Eval results *****
2024-05-15 09:49:07,911 -   binary_train_loss = 0.6704
2024-05-15 09:49:07,911 -   binary_eval_score = 0.691
2024-05-15 09:49:07,911 -   train_loss = 0.059
2024-05-15 09:49:07,911 -   eval_score = 0.7281
2024-05-15 09:49:07,911 -   best_eval_score = 0.7326
2024-05-15 09:49:07,911 - EarlyStopping counter: 2 out of 5
2024-05-15 09:49:26,501 - ***** Epoch: 9: Eval results *****
2024-05-15 09:49:26,501 -   binary_train_loss = 0.6669
2024-05-15 09:49:26,501 -   binary_eval_score = 0.7124
2024-05-15 09:49:26,501 -   train_loss = 0.0419
2024-05-15 09:49:26,501 -   eval_score = 0.7169
2024-05-15 09:49:26,501 -   best_eval_score = 0.7326
2024-05-15 09:49:26,501 - EarlyStopping counter: 3 out of 5
2024-05-15 09:49:44,669 - ***** Epoch: 10: Eval results *****
2024-05-15 09:49:44,670 -   binary_train_loss = 0.6638
2024-05-15 09:49:44,670 -   binary_eval_score = 0.7056
2024-05-15 09:49:44,670 -   train_loss = 0.0368
2024-05-15 09:49:44,670 -   eval_score = 0.7258
2024-05-15 09:49:44,670 -   best_eval_score = 0.7326
2024-05-15 09:49:44,670 - EarlyStopping counter: 4 out of 5
2024-05-15 09:50:02,782 - ***** Epoch: 11: Eval results *****
2024-05-15 09:50:02,783 -   binary_train_loss = 0.6583
2024-05-15 09:50:02,783 -   binary_eval_score = 0.7539
2024-05-15 09:50:02,783 -   train_loss = 0.033
2024-05-15 09:50:02,783 -   eval_score = 0.7236
2024-05-15 09:50:02,783 -   best_eval_score = 0.7326
2024-05-15 09:50:02,783 - EarlyStopping counter: 5 out of 5
2024-05-15 09:50:02,783 - EarlyStopping at epoch 11
2024-05-15 09:50:02,786 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-15 09:50:03,828 - Training is finished...
2024-05-15 09:50:03,828 - Testing begins...
2024-05-15 09:50:16,036 - ***** Out-of-domain Evaluation results *****
2024-05-15 09:50:16,036 -   aupr_in = 0.729
2024-05-15 09:50:16,036 -   aupr_out = 0.6944
2024-05-15 09:50:16,036 -   auroc = 0.736
2024-05-15 09:50:16,036 -   der = 0.4293
2024-05-15 09:50:16,036 -   eer = 0.3222
2024-05-15 09:50:16,036 -   fpr95 = 0.8133
2024-05-15 09:50:16,036 - Testing is finished...
2024-05-15 09:50:16,036 - Multimodal intent recognition is finished...
2024-05-15 09:50:16,036 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-15 09:50:16,532 - ============================== Params ==============================
2024-05-15 09:50:16,533 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-15 09:50:16,533 - dataset: MIntRec
2024-05-15 09:50:16,533 - ood_dataset: MIntRec-OOD
2024-05-15 09:50:16,533 - data_mode: multi-class
2024-05-15 09:50:16,533 - multimodal_method: msz
2024-05-15 09:50:16,533 - method: msz
2024-05-15 09:50:16,533 - ood_detection_method: ma
2024-05-15 09:50:16,533 - text_backbone: bert-base-uncased
2024-05-15 09:50:16,533 - seed: 4
2024-05-15 09:50:16,533 - num_workers: 8
2024-05-15 09:50:16,533 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-15-09-32-18
2024-05-15 09:50:16,533 - gpu_id: 0
2024-05-15 09:50:16,533 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-15 09:50:16,533 - train: True
2024-05-15 09:50:16,533 - tune: True
2024-05-15 09:50:16,533 - ood: True
2024-05-15 09:50:16,533 - save_model: True
2024-05-15 09:50:16,533 - save_results: True
2024-05-15 09:50:16,533 - log_path: logs
2024-05-15 09:50:16,533 - cache_path: cache
2024-05-15 09:50:16,533 - video_data_path: video_data
2024-05-15 09:50:16,533 - audio_data_path: audio_data
2024-05-15 09:50:16,533 - video_feats_path: swin_feats.pkl
2024-05-15 09:50:16,533 - ood_video_feats_path: swin_feats.pkl
2024-05-15 09:50:16,533 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-15 09:50:16,533 - audio_feats_path: wavlm_feats.pkl
2024-05-15 09:50:16,533 - results_path: results
2024-05-15 09:50:16,533 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz
2024-05-15 09:50:16,533 - model_path: models
2024-05-15 09:50:16,533 - config_file_name: msz_MIntRec
2024-05-15 09:50:16,533 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-15 09:50:16,533 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-15 09:50:16,533 - text_seq_len: 30
2024-05-15 09:50:16,533 - video_seq_len: 230
2024-05-15 09:50:16,533 - audio_seq_len: 480
2024-05-15 09:50:16,533 - text_feat_dim: 768
2024-05-15 09:50:16,534 - video_feat_dim: 1024
2024-05-15 09:50:16,534 - audio_feat_dim: 768
2024-05-15 09:50:16,534 - ood_label_id: 20
2024-05-15 09:50:16,534 - num_labels: 20
2024-05-15 09:50:16,534 - num_train_examples: 1334
2024-05-15 09:50:16,534 - need_aligned: True
2024-05-15 09:50:16,534 - freeze_parameters: False
2024-05-15 09:50:16,534 - eval_monitor: acc
2024-05-15 09:50:16,534 - train_batch_size: 32
2024-05-15 09:50:16,534 - eval_batch_size: 16
2024-05-15 09:50:16,534 - num_train_epochs: 100
2024-05-15 09:50:16,534 - lr: [2e-05]
2024-05-15 09:50:16,534 - weight_decay: [0.1]
2024-05-15 09:50:16,534 - wait_patience: 5
2024-05-15 09:50:16,534 - warmup_proportion: [0.01]
2024-05-15 09:50:16,534 - hidden_dims: [768]
2024-05-15 09:50:16,534 - num_attention_heads: [8]
2024-05-15 09:50:16,534 - attention_probs_dropout_prob: [0.3]
2024-05-15 09:50:16,534 - hidden_dropout_prob: [0.2]
2024-05-15 09:50:16,534 - intermediate_size: [768]
2024-05-15 09:50:16,534 - num_hidden_layers: [4]
2024-05-15 09:50:16,534 - max_position_embeddings: [900]
2024-05-15 09:50:16,534 - position_embedding_type: absolute
2024-05-15 09:50:16,534 - batch_first: True
2024-05-15 09:50:16,534 - aligned_method: ['ctc']
2024-05-15 09:50:16,534 - sampler: beta
2024-05-15 09:50:16,534 - multiple_ood: [1]
2024-05-15 09:50:16,534 - select_number_min: [2]
2024-05-15 09:50:16,534 - select_number_max: [3]
2024-05-15 09:50:16,534 - alpha: [4]
2024-05-15 09:50:16,534 - mlp_hidden_size: [256]
2024-05-15 09:50:16,534 - mlp_dropout: [0.3]
2024-05-15 09:50:16,534 - scale: [8]
2024-05-15 09:50:16,534 - ablation: no_fusion_cat
2024-05-15 09:50:16,534 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/msz_MIntRec_bert-base-uncased_multi-class_4
2024-05-15 09:50:16,534 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/msz_MIntRec_bert-base-uncased_multi-class_4/models
2024-05-15 09:50:16,535 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/binary_msz_MIntRec_bert-base-uncased_4
2024-05-15 09:50:16,535 - device: cuda
2024-05-15 09:50:16,535 - ============================== End Params ==============================
2024-05-15 09:50:18,264 - Multimodal Intent Recognition begins...
2024-05-15 09:50:18,264 - Training begins...
2024-05-15 09:50:36,188 - ***** Epoch: 1: Eval results *****
2024-05-15 09:50:36,188 -   binary_train_loss = 0.6985
2024-05-15 09:50:36,188 -   binary_eval_score = 0.5112
2024-05-15 09:50:36,188 -   train_loss = 2.83
2024-05-15 09:50:36,188 -   eval_score = 0.2899
2024-05-15 09:50:36,188 -   best_eval_score = 0.0
2024-05-15 09:50:55,434 - ***** Epoch: 2: Eval results *****
2024-05-15 09:50:55,434 -   binary_train_loss = 0.6965
2024-05-15 09:50:55,434 -   binary_eval_score = 0.4989
2024-05-15 09:50:55,435 -   train_loss = 1.9215
2024-05-15 09:50:55,435 -   eval_score = 0.6292
2024-05-15 09:50:55,435 -   best_eval_score = 0.2899
2024-05-15 09:51:14,072 - ***** Epoch: 3: Eval results *****
2024-05-15 09:51:14,072 -   binary_train_loss = 0.6911
2024-05-15 09:51:14,072 -   binary_eval_score = 0.6124
2024-05-15 09:51:14,072 -   train_loss = 1.1017
2024-05-15 09:51:14,073 -   eval_score = 0.6876
2024-05-15 09:51:14,073 -   best_eval_score = 0.6292
2024-05-15 09:51:33,961 - ***** Epoch: 4: Eval results *****
2024-05-15 09:51:33,962 -   binary_train_loss = 0.6863
2024-05-15 09:51:33,962 -   binary_eval_score = 0.6921
2024-05-15 09:51:33,962 -   train_loss = 0.4368
2024-05-15 09:51:33,962 -   eval_score = 0.6899
2024-05-15 09:51:33,962 -   best_eval_score = 0.6876
2024-05-15 09:51:53,466 - ***** Epoch: 5: Eval results *****
2024-05-15 09:51:53,467 -   binary_train_loss = 0.6813
2024-05-15 09:51:53,467 -   binary_eval_score = 0.7337
2024-05-15 09:51:53,467 -   train_loss = 0.2606
2024-05-15 09:51:53,467 -   eval_score = 0.7056
2024-05-15 09:51:53,467 -   best_eval_score = 0.6899
2024-05-15 09:52:11,618 - ***** Epoch: 6: Eval results *****
2024-05-15 09:52:11,618 -   binary_train_loss = 0.6757
2024-05-15 09:52:11,618 -   binary_eval_score = 0.7404
2024-05-15 09:52:11,618 -   train_loss = 0.1211
2024-05-15 09:52:11,619 -   eval_score = 0.7034
2024-05-15 09:52:11,619 -   best_eval_score = 0.7056
2024-05-15 09:52:11,619 - EarlyStopping counter: 1 out of 5
2024-05-15 09:52:29,917 - ***** Epoch: 7: Eval results *****
2024-05-15 09:52:29,917 -   binary_train_loss = 0.6721
2024-05-15 09:52:29,917 -   binary_eval_score = 0.7449
2024-05-15 09:52:29,917 -   train_loss = 0.0789
2024-05-15 09:52:29,917 -   eval_score = 0.7169
2024-05-15 09:52:29,917 -   best_eval_score = 0.7056
2024-05-15 09:52:48,770 - ***** Epoch: 8: Eval results *****
2024-05-15 09:52:48,771 -   binary_train_loss = 0.6632
2024-05-15 09:52:48,771 -   binary_eval_score = 0.7719
2024-05-15 09:52:48,771 -   train_loss = 0.0514
2024-05-15 09:52:48,771 -   eval_score = 0.7146
2024-05-15 09:52:48,771 -   best_eval_score = 0.7169
2024-05-15 09:52:48,772 - EarlyStopping counter: 1 out of 5
2024-05-15 09:53:06,594 - ***** Epoch: 9: Eval results *****
2024-05-15 09:53:06,595 -   binary_train_loss = 0.6588
2024-05-15 09:53:06,595 -   binary_eval_score = 0.7888
2024-05-15 09:53:06,595 -   train_loss = 0.0449
2024-05-15 09:53:06,595 -   eval_score = 0.7146
2024-05-15 09:53:06,595 -   best_eval_score = 0.7169
2024-05-15 09:53:06,595 - EarlyStopping counter: 2 out of 5
2024-05-15 09:53:24,573 - ***** Epoch: 10: Eval results *****
2024-05-15 09:53:24,573 -   binary_train_loss = 0.6499
2024-05-15 09:53:24,573 -   binary_eval_score = 0.8101
2024-05-15 09:53:24,573 -   train_loss = 0.0395
2024-05-15 09:53:24,573 -   eval_score = 0.7191
2024-05-15 09:53:24,573 -   best_eval_score = 0.7169
2024-05-15 09:53:43,162 - ***** Epoch: 11: Eval results *****
2024-05-15 09:53:43,162 -   binary_train_loss = 0.64
2024-05-15 09:53:43,163 -   binary_eval_score = 0.791
2024-05-15 09:53:43,163 -   train_loss = 0.0316
2024-05-15 09:53:43,163 -   eval_score = 0.7034
2024-05-15 09:53:43,163 -   best_eval_score = 0.7191
2024-05-15 09:53:43,163 - EarlyStopping counter: 1 out of 5
2024-05-15 09:54:01,269 - ***** Epoch: 12: Eval results *****
2024-05-15 09:54:01,270 -   binary_train_loss = 0.6344
2024-05-15 09:54:01,270 -   binary_eval_score = 0.7888
2024-05-15 09:54:01,270 -   train_loss = 0.0294
2024-05-15 09:54:01,270 -   eval_score = 0.7124
2024-05-15 09:54:01,270 -   best_eval_score = 0.7191
2024-05-15 09:54:01,270 - EarlyStopping counter: 2 out of 5
2024-05-15 09:54:20,333 - ***** Epoch: 13: Eval results *****
2024-05-15 09:54:20,333 -   binary_train_loss = 0.6271
2024-05-15 09:54:20,334 -   binary_eval_score = 0.7955
2024-05-15 09:54:20,334 -   train_loss = 0.0304
2024-05-15 09:54:20,334 -   eval_score = 0.7079
2024-05-15 09:54:20,334 -   best_eval_score = 0.7191
2024-05-15 09:54:20,334 - EarlyStopping counter: 3 out of 5
2024-05-15 09:54:39,292 - ***** Epoch: 14: Eval results *****
2024-05-15 09:54:39,292 -   binary_train_loss = 0.6203
2024-05-15 09:54:39,292 -   binary_eval_score = 0.836
2024-05-15 09:54:39,292 -   train_loss = 0.0306
2024-05-15 09:54:39,292 -   eval_score = 0.7079
2024-05-15 09:54:39,293 -   best_eval_score = 0.7191
2024-05-15 09:54:39,293 - EarlyStopping counter: 4 out of 5
2024-05-15 09:54:58,081 - ***** Epoch: 15: Eval results *****
2024-05-15 09:54:58,082 -   binary_train_loss = 0.6067
2024-05-15 09:54:58,082 -   binary_eval_score = 0.836
2024-05-15 09:54:58,082 -   train_loss = 0.032
2024-05-15 09:54:58,082 -   eval_score = 0.7079
2024-05-15 09:54:58,082 -   best_eval_score = 0.7191
2024-05-15 09:54:58,082 - EarlyStopping counter: 5 out of 5
2024-05-15 09:54:58,082 - EarlyStopping at epoch 15
2024-05-15 09:54:58,087 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_cat_msz/msz_MIntRec_bert-base-uncased_multi-class_4/models
2024-05-15 09:54:59,092 - Training is finished...
2024-05-15 09:54:59,092 - Testing begins...
2024-05-15 09:55:11,060 - ***** Out-of-domain Evaluation results *****
2024-05-15 09:55:11,061 -   aupr_in = 0.7238
2024-05-15 09:55:11,061 -   aupr_out = 0.7316
2024-05-15 09:55:11,061 -   auroc = 0.747
2024-05-15 09:55:11,061 -   der = 0.385
2024-05-15 09:55:11,061 -   eer = 0.3178
2024-05-15 09:55:11,061 -   fpr95 = 0.7244
2024-05-15 09:55:11,061 - Testing is finished...
2024-05-15 09:55:11,061 - Multimodal intent recognition is finished...
2024-05-15 09:55:11,061 - Results are saved in results/results_msz_ablation_MIntRec.csv
