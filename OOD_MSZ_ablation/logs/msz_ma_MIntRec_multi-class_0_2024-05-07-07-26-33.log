2024-05-07 07:26:33,988 - Lists of intent labels are: ['Complain', 'Praise', 'Apologise', 'Thank', 'Criticize', 'Agree', 'Taunt', 'Flaunt', 'Joke', 'Oppose', 'Comfort', 'Care', 'Inform', 'Advise', 'Arrange', 'Introduce', 'Leave', 'Prevent', 'Greet', 'Ask for help']
2024-05-07 07:26:33,988 - ID Data preparation...
2024-05-07 07:26:48,222 - OOD Data preparation...
2024-05-07 07:26:54,515 - ============================== Params ==============================
2024-05-07 07:26:54,515 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-07 07:26:54,515 - dataset: MIntRec
2024-05-07 07:26:54,515 - ood_dataset: MIntRec-OOD
2024-05-07 07:26:54,515 - data_mode: multi-class
2024-05-07 07:26:54,516 - multimodal_method: msz
2024-05-07 07:26:54,516 - method: msz
2024-05-07 07:26:54,516 - ood_detection_method: ma
2024-05-07 07:26:54,516 - text_backbone: bert-base-uncased
2024-05-07 07:26:54,516 - seed: 1
2024-05-07 07:26:54,516 - num_workers: 8
2024-05-07 07:26:54,516 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-07-07-26-33
2024-05-07 07:26:54,516 - gpu_id: 0
2024-05-07 07:26:54,516 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-07 07:26:54,516 - train: True
2024-05-07 07:26:54,516 - tune: True
2024-05-07 07:26:54,516 - ood: True
2024-05-07 07:26:54,516 - save_model: True
2024-05-07 07:26:54,516 - save_results: True
2024-05-07 07:26:54,516 - log_path: logs
2024-05-07 07:26:54,516 - cache_path: cache
2024-05-07 07:26:54,516 - video_data_path: video_data
2024-05-07 07:26:54,516 - audio_data_path: audio_data
2024-05-07 07:26:54,516 - video_feats_path: swin_feats.pkl
2024-05-07 07:26:54,516 - ood_video_feats_path: swin_feats.pkl
2024-05-07 07:26:54,516 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-07 07:26:54,516 - audio_feats_path: wavlm_feats.pkl
2024-05-07 07:26:54,516 - results_path: results
2024-05-07 07:26:54,516 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-07 07:26:54,516 - model_path: models
2024-05-07 07:26:54,516 - config_file_name: msz_MIntRec
2024-05-07 07:26:54,516 - results_file_name: results_msz_MIntRec.csv
2024-05-07 07:26:54,516 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-07 07:26:54,516 - text_seq_len: 30
2024-05-07 07:26:54,516 - video_seq_len: 230
2024-05-07 07:26:54,516 - audio_seq_len: 480
2024-05-07 07:26:54,516 - text_feat_dim: 768
2024-05-07 07:26:54,516 - video_feat_dim: 1024
2024-05-07 07:26:54,516 - audio_feat_dim: 768
2024-05-07 07:26:54,516 - ood_label_id: 20
2024-05-07 07:26:54,516 - num_labels: 20
2024-05-07 07:26:54,516 - num_train_examples: 1334
2024-05-07 07:26:54,517 - need_aligned: True
2024-05-07 07:26:54,517 - freeze_parameters: False
2024-05-07 07:26:54,517 - eval_monitor: acc
2024-05-07 07:26:54,517 - train_batch_size: 32
2024-05-07 07:26:54,517 - eval_batch_size: 16
2024-05-07 07:26:54,517 - num_train_epochs: 100
2024-05-07 07:26:54,517 - lr: [2e-05]
2024-05-07 07:26:54,517 - weight_decay: [0.1]
2024-05-07 07:26:54,517 - wait_patience: 5
2024-05-07 07:26:54,517 - warmup_proportion: [0.01]
2024-05-07 07:26:54,517 - hidden_dims: [768]
2024-05-07 07:26:54,517 - num_attention_heads: [4]
2024-05-07 07:26:54,517 - attention_probs_dropout_prob: [0.3]
2024-05-07 07:26:54,517 - hidden_dropout_prob: [0.1]
2024-05-07 07:26:54,517 - intermediate_size: [768]
2024-05-07 07:26:54,517 - num_hidden_layers: [5]
2024-05-07 07:26:54,517 - max_position_embeddings: [768]
2024-05-07 07:26:54,517 - position_embedding_type: absolute
2024-05-07 07:26:54,517 - batch_first: True
2024-05-07 07:26:54,517 - aligned_method: ['ctc']
2024-05-07 07:26:54,517 - sampler: beta
2024-05-07 07:26:54,517 - multiple_ood: [1]
2024-05-07 07:26:54,517 - select_number_min: [2]
2024-05-07 07:26:54,517 - select_number_max: [3]
2024-05-07 07:26:54,517 - alpha: [3]
2024-05-07 07:26:54,517 - mlp_hidden_size: [256]
2024-05-07 07:26:54,517 - mlp_dropout: [0.3]
2024-05-07 07:26:54,517 - scale: [8]
2024-05-07 07:26:54,517 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_1
2024-05-07 07:26:54,517 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-07 07:26:54,517 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_1
2024-05-07 07:26:54,517 - ============================== End Params ==============================
2024-05-07 07:26:58,239 - Multimodal Intent Recognition begins...
2024-05-07 07:26:58,239 - Training begins...
2024-05-07 07:27:33,629 - ***** Epoch: 1: Eval results *****
2024-05-07 07:27:33,630 -   binary_train_loss = 0.6827
2024-05-07 07:27:33,630 -   binary_eval_score = 0.8438
2024-05-07 07:27:33,630 -   train_loss = 2.0436
2024-05-07 07:27:33,630 -   eval_score = 0.6472
2024-05-07 07:27:33,630 -   best_eval_score = 0.0
2024-05-07 07:28:07,208 - ***** Epoch: 2: Eval results *****
2024-05-07 07:28:07,208 -   binary_train_loss = 0.6731
2024-05-07 07:28:07,208 -   binary_eval_score = 0.7045
2024-05-07 07:28:07,208 -   train_loss = 0.8779
2024-05-07 07:28:07,208 -   eval_score = 0.6921
2024-05-07 07:28:07,208 -   best_eval_score = 0.6472
2024-05-07 07:28:41,423 - ***** Epoch: 3: Eval results *****
2024-05-07 07:28:41,423 -   binary_train_loss = 0.6476
2024-05-07 07:28:41,423 -   binary_eval_score = 0.7652
2024-05-07 07:28:41,423 -   train_loss = 0.3675
2024-05-07 07:28:41,423 -   eval_score = 0.7124
2024-05-07 07:28:41,423 -   best_eval_score = 0.6921
2024-05-07 07:29:15,642 - ***** Epoch: 4: Eval results *****
2024-05-07 07:29:15,642 -   binary_train_loss = 0.496
2024-05-07 07:29:15,642 -   binary_eval_score = 0.8921
2024-05-07 07:29:15,642 -   train_loss = 0.1986
2024-05-07 07:29:15,642 -   eval_score = 0.7303
2024-05-07 07:29:15,642 -   best_eval_score = 0.7124
2024-05-07 07:29:49,330 - ***** Epoch: 5: Eval results *****
2024-05-07 07:29:49,330 -   binary_train_loss = 0.2972
2024-05-07 07:29:49,331 -   binary_eval_score = 0.7539
2024-05-07 07:29:49,331 -   train_loss = 0.1376
2024-05-07 07:29:49,331 -   eval_score = 0.7326
2024-05-07 07:29:49,331 -   best_eval_score = 0.7303
2024-05-07 07:30:22,977 - ***** Epoch: 6: Eval results *****
2024-05-07 07:30:22,977 -   binary_train_loss = 0.2733
2024-05-07 07:30:22,977 -   binary_eval_score = 0.864
2024-05-07 07:30:22,977 -   train_loss = 0.0781
2024-05-07 07:30:22,977 -   eval_score = 0.7281
2024-05-07 07:30:22,977 -   best_eval_score = 0.7326
2024-05-07 07:30:22,978 - EarlyStopping counter: 1 out of 5
2024-05-07 07:30:56,596 - ***** Epoch: 7: Eval results *****
2024-05-07 07:30:56,596 -   binary_train_loss = 0.1881
2024-05-07 07:30:56,596 -   binary_eval_score = 0.9079
2024-05-07 07:30:56,596 -   train_loss = 0.0642
2024-05-07 07:30:56,597 -   eval_score = 0.7191
2024-05-07 07:30:56,597 -   best_eval_score = 0.7326
2024-05-07 07:30:56,597 - EarlyStopping counter: 2 out of 5
2024-05-07 07:31:30,742 - ***** Epoch: 8: Eval results *****
2024-05-07 07:31:30,742 -   binary_train_loss = 0.1621
2024-05-07 07:31:30,742 -   binary_eval_score = 0.9427
2024-05-07 07:31:30,742 -   train_loss = 0.0543
2024-05-07 07:31:30,742 -   eval_score = 0.7326
2024-05-07 07:31:30,742 -   best_eval_score = 0.7326
2024-05-07 07:31:30,742 - EarlyStopping counter: 3 out of 5
2024-05-07 07:32:04,561 - ***** Epoch: 9: Eval results *****
2024-05-07 07:32:04,561 -   binary_train_loss = 0.1644
2024-05-07 07:32:04,561 -   binary_eval_score = 0.8888
2024-05-07 07:32:04,561 -   train_loss = 0.0455
2024-05-07 07:32:04,562 -   eval_score = 0.7371
2024-05-07 07:32:04,562 -   best_eval_score = 0.7326
2024-05-07 07:32:39,407 - ***** Epoch: 10: Eval results *****
2024-05-07 07:32:39,407 -   binary_train_loss = 0.155
2024-05-07 07:32:39,407 -   binary_eval_score = 0.9382
2024-05-07 07:32:39,407 -   train_loss = 0.0385
2024-05-07 07:32:39,407 -   eval_score = 0.7326
2024-05-07 07:32:39,407 -   best_eval_score = 0.7371
2024-05-07 07:32:39,407 - EarlyStopping counter: 1 out of 5
2024-05-07 07:33:13,136 - ***** Epoch: 11: Eval results *****
2024-05-07 07:33:13,136 -   binary_train_loss = 0.1497
2024-05-07 07:33:13,136 -   binary_eval_score = 0.9539
2024-05-07 07:33:13,136 -   train_loss = 0.0344
2024-05-07 07:33:13,136 -   eval_score = 0.7303
2024-05-07 07:33:13,136 -   best_eval_score = 0.7371
2024-05-07 07:33:13,136 - EarlyStopping counter: 2 out of 5
2024-05-07 07:33:46,642 - ***** Epoch: 12: Eval results *****
2024-05-07 07:33:46,642 -   binary_train_loss = 0.131
2024-05-07 07:33:46,642 -   binary_eval_score = 0.9461
2024-05-07 07:33:46,643 -   train_loss = 0.0298
2024-05-07 07:33:46,643 -   eval_score = 0.7326
2024-05-07 07:33:46,643 -   best_eval_score = 0.7371
2024-05-07 07:33:46,643 - EarlyStopping counter: 3 out of 5
2024-05-07 07:34:20,754 - ***** Epoch: 13: Eval results *****
2024-05-07 07:34:20,754 -   binary_train_loss = 0.1138
2024-05-07 07:34:20,754 -   binary_eval_score = 0.9708
2024-05-07 07:34:20,754 -   train_loss = 0.0304
2024-05-07 07:34:20,754 -   eval_score = 0.7461
2024-05-07 07:34:20,754 -   best_eval_score = 0.7371
2024-05-07 07:34:55,051 - ***** Epoch: 14: Eval results *****
2024-05-07 07:34:55,051 -   binary_train_loss = 0.1115
2024-05-07 07:34:55,051 -   binary_eval_score = 0.9528
2024-05-07 07:34:55,051 -   train_loss = 0.0281
2024-05-07 07:34:55,051 -   eval_score = 0.7213
2024-05-07 07:34:55,051 -   best_eval_score = 0.7461
2024-05-07 07:34:55,051 - EarlyStopping counter: 1 out of 5
2024-05-07 07:35:28,488 - ***** Epoch: 15: Eval results *****
2024-05-07 07:35:28,489 -   binary_train_loss = 0.1069
2024-05-07 07:35:28,489 -   binary_eval_score = 0.9854
2024-05-07 07:35:28,489 -   train_loss = 0.0235
2024-05-07 07:35:28,489 -   eval_score = 0.7371
2024-05-07 07:35:28,489 -   best_eval_score = 0.7461
2024-05-07 07:35:28,489 - EarlyStopping counter: 2 out of 5
2024-05-07 07:36:02,124 - ***** Epoch: 16: Eval results *****
2024-05-07 07:36:02,124 -   binary_train_loss = 0.0768
2024-05-07 07:36:02,124 -   binary_eval_score = 0.9854
2024-05-07 07:36:02,124 -   train_loss = 0.0239
2024-05-07 07:36:02,124 -   eval_score = 0.7213
2024-05-07 07:36:02,124 -   best_eval_score = 0.7461
2024-05-07 07:36:02,124 - EarlyStopping counter: 3 out of 5
2024-05-07 07:36:36,189 - ***** Epoch: 17: Eval results *****
2024-05-07 07:36:36,189 -   binary_train_loss = 0.0677
2024-05-07 07:36:36,189 -   binary_eval_score = 0.9798
2024-05-07 07:36:36,189 -   train_loss = 0.0204
2024-05-07 07:36:36,189 -   eval_score = 0.7169
2024-05-07 07:36:36,189 -   best_eval_score = 0.7461
2024-05-07 07:36:36,189 - EarlyStopping counter: 4 out of 5
2024-05-07 07:37:09,893 - ***** Epoch: 18: Eval results *****
2024-05-07 07:37:09,893 -   binary_train_loss = 0.0646
2024-05-07 07:37:09,894 -   binary_eval_score = 0.9955
2024-05-07 07:37:09,894 -   train_loss = 0.0197
2024-05-07 07:37:09,894 -   eval_score = 0.7236
2024-05-07 07:37:09,894 -   best_eval_score = 0.7461
2024-05-07 07:37:09,894 - EarlyStopping counter: 5 out of 5
2024-05-07 07:37:09,894 - EarlyStopping at epoch 18
2024-05-07 07:37:09,898 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-07 07:37:15,843 - Training is finished...
2024-05-07 07:37:15,844 - Testing begins...
2024-05-07 07:37:29,476 - ***** Out-of-domain Evaluation results *****
2024-05-07 07:37:29,477 -   aupr_in = 0.7794
2024-05-07 07:37:29,477 -   aupr_out = 0.7924
2024-05-07 07:37:29,477 -   auroc = 0.7958
2024-05-07 07:37:29,477 -   der = 0.3596
2024-05-07 07:37:29,477 -   eer = 0.2667
2024-05-07 07:37:29,477 -   fpr95 = 0.68
2024-05-07 07:37:29,477 - Testing is finished...
2024-05-07 07:37:29,477 - Multimodal intent recognition is finished...
2024-05-07 07:37:29,477 - Results are saved in results/results_msz_MIntRec.csv
2024-05-07 07:37:29,597 - ============================== Params ==============================
2024-05-07 07:37:29,597 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-07 07:37:29,597 - dataset: MIntRec
2024-05-07 07:37:29,597 - ood_dataset: MIntRec-OOD
2024-05-07 07:37:29,597 - data_mode: multi-class
2024-05-07 07:37:29,597 - multimodal_method: msz
2024-05-07 07:37:29,597 - method: msz
2024-05-07 07:37:29,597 - ood_detection_method: ma
2024-05-07 07:37:29,597 - text_backbone: bert-base-uncased
2024-05-07 07:37:29,597 - seed: 2
2024-05-07 07:37:29,597 - num_workers: 8
2024-05-07 07:37:29,597 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-07-07-26-33
2024-05-07 07:37:29,597 - gpu_id: 0
2024-05-07 07:37:29,597 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-07 07:37:29,597 - train: True
2024-05-07 07:37:29,598 - tune: True
2024-05-07 07:37:29,598 - ood: True
2024-05-07 07:37:29,598 - save_model: True
2024-05-07 07:37:29,598 - save_results: True
2024-05-07 07:37:29,598 - log_path: logs
2024-05-07 07:37:29,598 - cache_path: cache
2024-05-07 07:37:29,598 - video_data_path: video_data
2024-05-07 07:37:29,598 - audio_data_path: audio_data
2024-05-07 07:37:29,598 - video_feats_path: swin_feats.pkl
2024-05-07 07:37:29,598 - ood_video_feats_path: swin_feats.pkl
2024-05-07 07:37:29,598 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-07 07:37:29,598 - audio_feats_path: wavlm_feats.pkl
2024-05-07 07:37:29,598 - results_path: results
2024-05-07 07:37:29,598 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-07 07:37:29,598 - model_path: models
2024-05-07 07:37:29,598 - config_file_name: msz_MIntRec
2024-05-07 07:37:29,598 - results_file_name: results_msz_MIntRec.csv
2024-05-07 07:37:29,598 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-07 07:37:29,598 - text_seq_len: 30
2024-05-07 07:37:29,598 - video_seq_len: 230
2024-05-07 07:37:29,598 - audio_seq_len: 480
2024-05-07 07:37:29,598 - text_feat_dim: 768
2024-05-07 07:37:29,598 - video_feat_dim: 1024
2024-05-07 07:37:29,598 - audio_feat_dim: 768
2024-05-07 07:37:29,598 - ood_label_id: 20
2024-05-07 07:37:29,598 - num_labels: 20
2024-05-07 07:37:29,598 - num_train_examples: 1334
2024-05-07 07:37:29,598 - need_aligned: True
2024-05-07 07:37:29,598 - freeze_parameters: False
2024-05-07 07:37:29,598 - eval_monitor: acc
2024-05-07 07:37:29,598 - train_batch_size: 32
2024-05-07 07:37:29,598 - eval_batch_size: 16
2024-05-07 07:37:29,598 - num_train_epochs: 100
2024-05-07 07:37:29,598 - lr: [2e-05]
2024-05-07 07:37:29,598 - weight_decay: [0.1]
2024-05-07 07:37:29,598 - wait_patience: 5
2024-05-07 07:37:29,598 - warmup_proportion: [0.01]
2024-05-07 07:37:29,598 - hidden_dims: [768]
2024-05-07 07:37:29,599 - num_attention_heads: [4]
2024-05-07 07:37:29,599 - attention_probs_dropout_prob: [0.3]
2024-05-07 07:37:29,599 - hidden_dropout_prob: [0.1]
2024-05-07 07:37:29,599 - intermediate_size: [768]
2024-05-07 07:37:29,599 - num_hidden_layers: [5]
2024-05-07 07:37:29,599 - max_position_embeddings: [768]
2024-05-07 07:37:29,599 - position_embedding_type: absolute
2024-05-07 07:37:29,599 - batch_first: True
2024-05-07 07:37:29,599 - aligned_method: ['ctc']
2024-05-07 07:37:29,599 - sampler: beta
2024-05-07 07:37:29,599 - multiple_ood: [1]
2024-05-07 07:37:29,599 - select_number_min: [2]
2024-05-07 07:37:29,599 - select_number_max: [3]
2024-05-07 07:37:29,599 - alpha: [3]
2024-05-07 07:37:29,599 - mlp_hidden_size: [256]
2024-05-07 07:37:29,599 - mlp_dropout: [0.3]
2024-05-07 07:37:29,599 - scale: [8]
2024-05-07 07:37:29,599 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_2
2024-05-07 07:37:29,599 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-07 07:37:29,599 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_2
2024-05-07 07:37:29,599 - device: cuda
2024-05-07 07:37:29,599 - ============================== End Params ==============================
2024-05-07 07:37:31,499 - Multimodal Intent Recognition begins...
2024-05-07 07:37:31,499 - Training begins...
2024-05-07 07:38:05,961 - ***** Epoch: 1: Eval results *****
2024-05-07 07:38:05,961 -   binary_train_loss = 0.6835
2024-05-07 07:38:05,961 -   binary_eval_score = 0.8551
2024-05-07 07:38:05,961 -   train_loss = 2.0249
2024-05-07 07:38:05,961 -   eval_score = 0.6787
2024-05-07 07:38:05,961 -   best_eval_score = 0.0
2024-05-07 07:38:40,161 - ***** Epoch: 2: Eval results *****
2024-05-07 07:38:40,162 -   binary_train_loss = 0.6772
2024-05-07 07:38:40,162 -   binary_eval_score = 0.6562
2024-05-07 07:38:40,162 -   train_loss = 0.8486
2024-05-07 07:38:40,162 -   eval_score = 0.7416
2024-05-07 07:38:40,162 -   best_eval_score = 0.6787
2024-05-07 07:39:14,477 - ***** Epoch: 3: Eval results *****
2024-05-07 07:39:14,477 -   binary_train_loss = 0.6428
2024-05-07 07:39:14,477 -   binary_eval_score = 0.7831
2024-05-07 07:39:14,477 -   train_loss = 0.3883
2024-05-07 07:39:14,477 -   eval_score = 0.6989
2024-05-07 07:39:14,477 -   best_eval_score = 0.7416
2024-05-07 07:39:14,477 - EarlyStopping counter: 1 out of 5
2024-05-07 07:39:48,946 - ***** Epoch: 4: Eval results *****
2024-05-07 07:39:48,947 -   binary_train_loss = 0.497
2024-05-07 07:39:48,947 -   binary_eval_score = 0.8831
2024-05-07 07:39:48,947 -   train_loss = 0.206
2024-05-07 07:39:48,947 -   eval_score = 0.7393
2024-05-07 07:39:48,947 -   best_eval_score = 0.7416
2024-05-07 07:39:48,947 - EarlyStopping counter: 2 out of 5
2024-05-07 07:40:23,111 - ***** Epoch: 5: Eval results *****
2024-05-07 07:40:23,111 -   binary_train_loss = 0.2707
2024-05-07 07:40:23,111 -   binary_eval_score = 0.8067
2024-05-07 07:40:23,111 -   train_loss = 0.153
2024-05-07 07:40:23,112 -   eval_score = 0.7213
2024-05-07 07:40:23,112 -   best_eval_score = 0.7416
2024-05-07 07:40:23,112 - EarlyStopping counter: 3 out of 5
2024-05-07 07:40:57,340 - ***** Epoch: 6: Eval results *****
2024-05-07 07:40:57,341 -   binary_train_loss = 0.2413
2024-05-07 07:40:57,341 -   binary_eval_score = 0.9315
2024-05-07 07:40:57,341 -   train_loss = 0.0971
2024-05-07 07:40:57,341 -   eval_score = 0.7438
2024-05-07 07:40:57,341 -   best_eval_score = 0.7416
2024-05-07 07:41:31,625 - ***** Epoch: 7: Eval results *****
2024-05-07 07:41:31,625 -   binary_train_loss = 0.1809
2024-05-07 07:41:31,625 -   binary_eval_score = 0.8607
2024-05-07 07:41:31,625 -   train_loss = 0.0593
2024-05-07 07:41:31,626 -   eval_score = 0.7348
2024-05-07 07:41:31,626 -   best_eval_score = 0.7438
2024-05-07 07:41:31,626 - EarlyStopping counter: 1 out of 5
2024-05-07 07:42:06,020 - ***** Epoch: 8: Eval results *****
2024-05-07 07:42:06,020 -   binary_train_loss = 0.1533
2024-05-07 07:42:06,020 -   binary_eval_score = 0.9011
2024-05-07 07:42:06,020 -   train_loss = 0.0543
2024-05-07 07:42:06,020 -   eval_score = 0.7213
2024-05-07 07:42:06,020 -   best_eval_score = 0.7438
2024-05-07 07:42:06,020 - EarlyStopping counter: 2 out of 5
2024-05-07 07:42:40,533 - ***** Epoch: 9: Eval results *****
2024-05-07 07:42:40,533 -   binary_train_loss = 0.1432
2024-05-07 07:42:40,533 -   binary_eval_score = 0.9438
2024-05-07 07:42:40,533 -   train_loss = 0.0408
2024-05-07 07:42:40,533 -   eval_score = 0.7258
2024-05-07 07:42:40,534 -   best_eval_score = 0.7438
2024-05-07 07:42:40,534 - EarlyStopping counter: 3 out of 5
2024-05-07 07:43:14,812 - ***** Epoch: 10: Eval results *****
2024-05-07 07:43:14,812 -   binary_train_loss = 0.1177
2024-05-07 07:43:14,812 -   binary_eval_score = 0.9685
2024-05-07 07:43:14,812 -   train_loss = 0.0363
2024-05-07 07:43:14,812 -   eval_score = 0.7191
2024-05-07 07:43:14,812 -   best_eval_score = 0.7438
2024-05-07 07:43:14,812 - EarlyStopping counter: 4 out of 5
2024-05-07 07:43:49,078 - ***** Epoch: 11: Eval results *****
2024-05-07 07:43:49,078 -   binary_train_loss = 0.1229
2024-05-07 07:43:49,078 -   binary_eval_score = 0.9404
2024-05-07 07:43:49,078 -   train_loss = 0.0298
2024-05-07 07:43:49,078 -   eval_score = 0.7236
2024-05-07 07:43:49,078 -   best_eval_score = 0.7438
2024-05-07 07:43:49,078 - EarlyStopping counter: 5 out of 5
2024-05-07 07:43:49,078 - EarlyStopping at epoch 11
2024-05-07 07:43:49,080 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-07 07:43:54,529 - Training is finished...
2024-05-07 07:43:54,530 - Testing begins...
2024-05-07 07:44:07,707 - ***** Out-of-domain Evaluation results *****
2024-05-07 07:44:07,707 -   aupr_in = 0.7838
2024-05-07 07:44:07,707 -   aupr_out = 0.81
2024-05-07 07:44:07,707 -   auroc = 0.8026
2024-05-07 07:44:07,707 -   der = 0.3585
2024-05-07 07:44:07,707 -   eer = 0.2644
2024-05-07 07:44:07,707 -   fpr95 = 0.6711
2024-05-07 07:44:07,707 - Testing is finished...
2024-05-07 07:44:07,707 - Multimodal intent recognition is finished...
2024-05-07 07:44:07,708 - Results are saved in results/results_msz_MIntRec.csv
2024-05-07 07:44:07,830 - ============================== Params ==============================
2024-05-07 07:44:07,830 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-07 07:44:07,831 - dataset: MIntRec
2024-05-07 07:44:07,831 - ood_dataset: MIntRec-OOD
2024-05-07 07:44:07,831 - data_mode: multi-class
2024-05-07 07:44:07,831 - multimodal_method: msz
2024-05-07 07:44:07,831 - method: msz
2024-05-07 07:44:07,831 - ood_detection_method: ma
2024-05-07 07:44:07,831 - text_backbone: bert-base-uncased
2024-05-07 07:44:07,831 - seed: 3
2024-05-07 07:44:07,831 - num_workers: 8
2024-05-07 07:44:07,831 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-07-07-26-33
2024-05-07 07:44:07,831 - gpu_id: 0
2024-05-07 07:44:07,831 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-07 07:44:07,831 - train: True
2024-05-07 07:44:07,831 - tune: True
2024-05-07 07:44:07,831 - ood: True
2024-05-07 07:44:07,831 - save_model: True
2024-05-07 07:44:07,831 - save_results: True
2024-05-07 07:44:07,831 - log_path: logs
2024-05-07 07:44:07,831 - cache_path: cache
2024-05-07 07:44:07,831 - video_data_path: video_data
2024-05-07 07:44:07,831 - audio_data_path: audio_data
2024-05-07 07:44:07,831 - video_feats_path: swin_feats.pkl
2024-05-07 07:44:07,831 - ood_video_feats_path: swin_feats.pkl
2024-05-07 07:44:07,831 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-07 07:44:07,831 - audio_feats_path: wavlm_feats.pkl
2024-05-07 07:44:07,831 - results_path: results
2024-05-07 07:44:07,831 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-07 07:44:07,831 - model_path: models
2024-05-07 07:44:07,831 - config_file_name: msz_MIntRec
2024-05-07 07:44:07,831 - results_file_name: results_msz_MIntRec.csv
2024-05-07 07:44:07,831 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-07 07:44:07,832 - text_seq_len: 30
2024-05-07 07:44:07,832 - video_seq_len: 230
2024-05-07 07:44:07,832 - audio_seq_len: 480
2024-05-07 07:44:07,832 - text_feat_dim: 768
2024-05-07 07:44:07,832 - video_feat_dim: 1024
2024-05-07 07:44:07,832 - audio_feat_dim: 768
2024-05-07 07:44:07,832 - ood_label_id: 20
2024-05-07 07:44:07,832 - num_labels: 20
2024-05-07 07:44:07,832 - num_train_examples: 1334
2024-05-07 07:44:07,832 - need_aligned: True
2024-05-07 07:44:07,832 - freeze_parameters: False
2024-05-07 07:44:07,832 - eval_monitor: acc
2024-05-07 07:44:07,832 - train_batch_size: 32
2024-05-07 07:44:07,832 - eval_batch_size: 16
2024-05-07 07:44:07,832 - num_train_epochs: 100
2024-05-07 07:44:07,832 - lr: [2e-05]
2024-05-07 07:44:07,832 - weight_decay: [0.1]
2024-05-07 07:44:07,832 - wait_patience: 5
2024-05-07 07:44:07,832 - warmup_proportion: [0.01]
2024-05-07 07:44:07,832 - hidden_dims: [768]
2024-05-07 07:44:07,832 - num_attention_heads: [4]
2024-05-07 07:44:07,832 - attention_probs_dropout_prob: [0.3]
2024-05-07 07:44:07,832 - hidden_dropout_prob: [0.1]
2024-05-07 07:44:07,832 - intermediate_size: [768]
2024-05-07 07:44:07,832 - num_hidden_layers: [5]
2024-05-07 07:44:07,832 - max_position_embeddings: [768]
2024-05-07 07:44:07,832 - position_embedding_type: absolute
2024-05-07 07:44:07,832 - batch_first: True
2024-05-07 07:44:07,832 - aligned_method: ['ctc']
2024-05-07 07:44:07,832 - sampler: beta
2024-05-07 07:44:07,832 - multiple_ood: [1]
2024-05-07 07:44:07,833 - select_number_min: [2]
2024-05-07 07:44:07,833 - select_number_max: [3]
2024-05-07 07:44:07,833 - alpha: [3]
2024-05-07 07:44:07,833 - mlp_hidden_size: [256]
2024-05-07 07:44:07,833 - mlp_dropout: [0.3]
2024-05-07 07:44:07,833 - scale: [8]
2024-05-07 07:44:07,833 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_3
2024-05-07 07:44:07,833 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-07 07:44:07,833 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_3
2024-05-07 07:44:07,833 - device: cuda
2024-05-07 07:44:07,833 - ============================== End Params ==============================
2024-05-07 07:44:09,614 - Multimodal Intent Recognition begins...
2024-05-07 07:44:09,614 - Training begins...
2024-05-07 07:44:44,927 - ***** Epoch: 1: Eval results *****
2024-05-07 07:44:44,927 -   binary_train_loss = 0.6859
2024-05-07 07:44:44,927 -   binary_eval_score = 0.8506
2024-05-07 07:44:44,927 -   train_loss = 2.0766
2024-05-07 07:44:44,927 -   eval_score = 0.6539
2024-05-07 07:44:44,927 -   best_eval_score = 0.0
2024-05-07 07:45:19,337 - ***** Epoch: 2: Eval results *****
2024-05-07 07:45:19,337 -   binary_train_loss = 0.679
2024-05-07 07:45:19,337 -   binary_eval_score = 0.6854
2024-05-07 07:45:19,337 -   train_loss = 0.8405
2024-05-07 07:45:19,337 -   eval_score = 0.6989
2024-05-07 07:45:19,337 -   best_eval_score = 0.6539
2024-05-07 07:45:53,540 - ***** Epoch: 3: Eval results *****
2024-05-07 07:45:53,540 -   binary_train_loss = 0.6574
2024-05-07 07:45:53,540 -   binary_eval_score = 0.7438
2024-05-07 07:45:53,540 -   train_loss = 0.3635
2024-05-07 07:45:53,540 -   eval_score = 0.7169
2024-05-07 07:45:53,540 -   best_eval_score = 0.6989
2024-05-07 07:46:27,809 - ***** Epoch: 4: Eval results *****
2024-05-07 07:46:27,809 -   binary_train_loss = 0.5599
2024-05-07 07:46:27,809 -   binary_eval_score = 0.8674
2024-05-07 07:46:27,809 -   train_loss = 0.1875
2024-05-07 07:46:27,809 -   eval_score = 0.7101
2024-05-07 07:46:27,809 -   best_eval_score = 0.7169
2024-05-07 07:46:27,809 - EarlyStopping counter: 1 out of 5
2024-05-07 07:47:02,352 - ***** Epoch: 5: Eval results *****
2024-05-07 07:47:02,352 -   binary_train_loss = 0.3439
2024-05-07 07:47:02,352 -   binary_eval_score = 0.8584
2024-05-07 07:47:02,352 -   train_loss = 0.1441
2024-05-07 07:47:02,352 -   eval_score = 0.7326
2024-05-07 07:47:02,353 -   best_eval_score = 0.7169
2024-05-07 07:47:37,162 - ***** Epoch: 6: Eval results *****
2024-05-07 07:47:37,163 -   binary_train_loss = 0.2846
2024-05-07 07:47:37,163 -   binary_eval_score = 0.8933
2024-05-07 07:47:37,163 -   train_loss = 0.0904
2024-05-07 07:47:37,163 -   eval_score = 0.7191
2024-05-07 07:47:37,163 -   best_eval_score = 0.7326
2024-05-07 07:47:37,163 - EarlyStopping counter: 1 out of 5
2024-05-07 07:48:11,570 - ***** Epoch: 7: Eval results *****
2024-05-07 07:48:11,570 -   binary_train_loss = 0.1993
2024-05-07 07:48:11,570 -   binary_eval_score = 0.8865
2024-05-07 07:48:11,570 -   train_loss = 0.0644
2024-05-07 07:48:11,570 -   eval_score = 0.7258
2024-05-07 07:48:11,570 -   best_eval_score = 0.7326
2024-05-07 07:48:11,570 - EarlyStopping counter: 2 out of 5
2024-05-07 07:48:47,086 - ***** Epoch: 8: Eval results *****
2024-05-07 07:48:47,086 -   binary_train_loss = 0.1699
2024-05-07 07:48:47,086 -   binary_eval_score = 0.882
2024-05-07 07:48:47,086 -   train_loss = 0.0489
2024-05-07 07:48:47,086 -   eval_score = 0.7348
2024-05-07 07:48:47,086 -   best_eval_score = 0.7326
2024-05-07 07:49:22,090 - ***** Epoch: 9: Eval results *****
2024-05-07 07:49:22,091 -   binary_train_loss = 0.1834
2024-05-07 07:49:22,091 -   binary_eval_score = 0.8843
2024-05-07 07:49:22,091 -   train_loss = 0.0558
2024-05-07 07:49:22,091 -   eval_score = 0.7056
2024-05-07 07:49:22,091 -   best_eval_score = 0.7348
2024-05-07 07:49:22,091 - EarlyStopping counter: 1 out of 5
2024-05-07 07:49:56,196 - ***** Epoch: 10: Eval results *****
2024-05-07 07:49:56,196 -   binary_train_loss = 0.1767
2024-05-07 07:49:56,196 -   binary_eval_score = 0.9303
2024-05-07 07:49:56,196 -   train_loss = 0.0401
2024-05-07 07:49:56,196 -   eval_score = 0.7191
2024-05-07 07:49:56,196 -   best_eval_score = 0.7348
2024-05-07 07:49:56,196 - EarlyStopping counter: 2 out of 5
2024-05-07 07:50:32,908 - ***** Epoch: 11: Eval results *****
2024-05-07 07:50:32,908 -   binary_train_loss = 0.1083
2024-05-07 07:50:32,909 -   binary_eval_score = 0.9663
2024-05-07 07:50:32,909 -   train_loss = 0.0354
2024-05-07 07:50:32,909 -   eval_score = 0.7281
2024-05-07 07:50:32,909 -   best_eval_score = 0.7348
2024-05-07 07:50:32,909 - EarlyStopping counter: 3 out of 5
2024-05-07 07:51:09,228 - ***** Epoch: 12: Eval results *****
2024-05-07 07:51:09,228 -   binary_train_loss = 0.1246
2024-05-07 07:51:09,228 -   binary_eval_score = 0.9449
2024-05-07 07:51:09,229 -   train_loss = 0.0306
2024-05-07 07:51:09,229 -   eval_score = 0.7326
2024-05-07 07:51:09,229 -   best_eval_score = 0.7348
2024-05-07 07:51:09,229 - EarlyStopping counter: 4 out of 5
2024-05-07 07:51:44,148 - ***** Epoch: 13: Eval results *****
2024-05-07 07:51:44,149 -   binary_train_loss = 0.1089
2024-05-07 07:51:44,149 -   binary_eval_score = 0.9607
2024-05-07 07:51:44,149 -   train_loss = 0.0319
2024-05-07 07:51:44,149 -   eval_score = 0.7438
2024-05-07 07:51:44,149 -   best_eval_score = 0.7348
2024-05-07 07:52:20,315 - ***** Epoch: 14: Eval results *****
2024-05-07 07:52:20,315 -   binary_train_loss = 0.0987
2024-05-07 07:52:20,315 -   binary_eval_score = 0.9584
2024-05-07 07:52:20,315 -   train_loss = 0.0255
2024-05-07 07:52:20,315 -   eval_score = 0.7281
2024-05-07 07:52:20,315 -   best_eval_score = 0.7438
2024-05-07 07:52:20,315 - EarlyStopping counter: 1 out of 5
2024-05-07 07:52:55,498 - ***** Epoch: 15: Eval results *****
2024-05-07 07:52:55,498 -   binary_train_loss = 0.0941
2024-05-07 07:52:55,498 -   binary_eval_score = 0.9652
2024-05-07 07:52:55,498 -   train_loss = 0.0288
2024-05-07 07:52:55,498 -   eval_score = 0.7326
2024-05-07 07:52:55,499 -   best_eval_score = 0.7438
2024-05-07 07:52:55,499 - EarlyStopping counter: 2 out of 5
2024-05-07 07:53:29,735 - ***** Epoch: 16: Eval results *****
2024-05-07 07:53:29,735 -   binary_train_loss = 0.1037
2024-05-07 07:53:29,735 -   binary_eval_score = 0.9764
2024-05-07 07:53:29,735 -   train_loss = 0.0228
2024-05-07 07:53:29,735 -   eval_score = 0.7303
2024-05-07 07:53:29,735 -   best_eval_score = 0.7438
2024-05-07 07:53:29,735 - EarlyStopping counter: 3 out of 5
2024-05-07 07:54:04,125 - ***** Epoch: 17: Eval results *****
2024-05-07 07:54:04,125 -   binary_train_loss = 0.0781
2024-05-07 07:54:04,125 -   binary_eval_score = 0.9652
2024-05-07 07:54:04,125 -   train_loss = 0.0307
2024-05-07 07:54:04,125 -   eval_score = 0.7416
2024-05-07 07:54:04,126 -   best_eval_score = 0.7438
2024-05-07 07:54:04,126 - EarlyStopping counter: 4 out of 5
2024-05-07 07:54:38,730 - ***** Epoch: 18: Eval results *****
2024-05-07 07:54:38,730 -   binary_train_loss = 0.0913
2024-05-07 07:54:38,730 -   binary_eval_score = 0.9753
2024-05-07 07:54:38,730 -   train_loss = 0.0205
2024-05-07 07:54:38,730 -   eval_score = 0.7596
2024-05-07 07:54:38,730 -   best_eval_score = 0.7438
2024-05-07 07:55:14,032 - ***** Epoch: 19: Eval results *****
2024-05-07 07:55:14,032 -   binary_train_loss = 0.1049
2024-05-07 07:55:14,032 -   binary_eval_score = 0.9708
2024-05-07 07:55:14,032 -   train_loss = 0.019
2024-05-07 07:55:14,032 -   eval_score = 0.7573
2024-05-07 07:55:14,032 -   best_eval_score = 0.7596
2024-05-07 07:55:14,032 - EarlyStopping counter: 1 out of 5
2024-05-07 07:55:49,044 - ***** Epoch: 20: Eval results *****
2024-05-07 07:55:49,044 -   binary_train_loss = 0.1149
2024-05-07 07:55:49,044 -   binary_eval_score = 0.9831
2024-05-07 07:55:49,044 -   train_loss = 0.0174
2024-05-07 07:55:49,044 -   eval_score = 0.7573
2024-05-07 07:55:49,044 -   best_eval_score = 0.7596
2024-05-07 07:55:49,044 - EarlyStopping counter: 2 out of 5
2024-05-07 07:56:23,831 - ***** Epoch: 21: Eval results *****
2024-05-07 07:56:23,831 -   binary_train_loss = 0.0832
2024-05-07 07:56:23,831 -   binary_eval_score = 0.9663
2024-05-07 07:56:23,831 -   train_loss = 0.015
2024-05-07 07:56:23,831 -   eval_score = 0.7393
2024-05-07 07:56:23,831 -   best_eval_score = 0.7596
2024-05-07 07:56:23,831 - EarlyStopping counter: 3 out of 5
2024-05-07 07:56:58,852 - ***** Epoch: 22: Eval results *****
2024-05-07 07:56:58,852 -   binary_train_loss = 0.0782
2024-05-07 07:56:58,852 -   binary_eval_score = 0.9854
2024-05-07 07:56:58,852 -   train_loss = 0.0299
2024-05-07 07:56:58,852 -   eval_score = 0.7461
2024-05-07 07:56:58,852 -   best_eval_score = 0.7596
2024-05-07 07:56:58,852 - EarlyStopping counter: 4 out of 5
2024-05-07 07:57:35,612 - ***** Epoch: 23: Eval results *****
2024-05-07 07:57:35,612 -   binary_train_loss = 0.1048
2024-05-07 07:57:35,612 -   binary_eval_score = 0.9742
2024-05-07 07:57:35,612 -   train_loss = 0.018
2024-05-07 07:57:35,612 -   eval_score = 0.7281
2024-05-07 07:57:35,612 -   best_eval_score = 0.7596
2024-05-07 07:57:35,612 - EarlyStopping counter: 5 out of 5
2024-05-07 07:57:35,612 - EarlyStopping at epoch 23
2024-05-07 07:57:35,614 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-07 07:57:40,772 - Training is finished...
2024-05-07 07:57:40,773 - Testing begins...
2024-05-07 07:57:54,464 - ***** Out-of-domain Evaluation results *****
2024-05-07 07:57:54,464 -   aupr_in = 0.7964
2024-05-07 07:57:54,465 -   aupr_out = 0.8074
2024-05-07 07:57:54,465 -   auroc = 0.8033
2024-05-07 07:57:54,465 -   der = 0.3585
2024-05-07 07:57:54,465 -   eer = 0.28
2024-05-07 07:57:54,465 -   fpr95 = 0.6711
2024-05-07 07:57:54,466 - Testing is finished...
2024-05-07 07:57:54,466 - Multimodal intent recognition is finished...
2024-05-07 07:57:54,466 - Results are saved in results/results_msz_MIntRec.csv
2024-05-07 07:57:54,597 - ============================== Params ==============================
2024-05-07 07:57:54,598 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-07 07:57:54,598 - dataset: MIntRec
2024-05-07 07:57:54,598 - ood_dataset: MIntRec-OOD
2024-05-07 07:57:54,598 - data_mode: multi-class
2024-05-07 07:57:54,598 - multimodal_method: msz
2024-05-07 07:57:54,598 - method: msz
2024-05-07 07:57:54,598 - ood_detection_method: ma
2024-05-07 07:57:54,598 - text_backbone: bert-base-uncased
2024-05-07 07:57:54,598 - seed: 4
2024-05-07 07:57:54,598 - num_workers: 8
2024-05-07 07:57:54,598 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-07-07-26-33
2024-05-07 07:57:54,598 - gpu_id: 0
2024-05-07 07:57:54,598 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-07 07:57:54,598 - train: True
2024-05-07 07:57:54,598 - tune: True
2024-05-07 07:57:54,598 - ood: True
2024-05-07 07:57:54,598 - save_model: True
2024-05-07 07:57:54,599 - save_results: True
2024-05-07 07:57:54,599 - log_path: logs
2024-05-07 07:57:54,599 - cache_path: cache
2024-05-07 07:57:54,599 - video_data_path: video_data
2024-05-07 07:57:54,599 - audio_data_path: audio_data
2024-05-07 07:57:54,599 - video_feats_path: swin_feats.pkl
2024-05-07 07:57:54,599 - ood_video_feats_path: swin_feats.pkl
2024-05-07 07:57:54,599 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-07 07:57:54,599 - audio_feats_path: wavlm_feats.pkl
2024-05-07 07:57:54,599 - results_path: results
2024-05-07 07:57:54,599 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-07 07:57:54,599 - model_path: models
2024-05-07 07:57:54,599 - config_file_name: msz_MIntRec
2024-05-07 07:57:54,599 - results_file_name: results_msz_MIntRec.csv
2024-05-07 07:57:54,599 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-07 07:57:54,599 - text_seq_len: 30
2024-05-07 07:57:54,599 - video_seq_len: 230
2024-05-07 07:57:54,599 - audio_seq_len: 480
2024-05-07 07:57:54,599 - text_feat_dim: 768
2024-05-07 07:57:54,599 - video_feat_dim: 1024
2024-05-07 07:57:54,599 - audio_feat_dim: 768
2024-05-07 07:57:54,599 - ood_label_id: 20
2024-05-07 07:57:54,599 - num_labels: 20
2024-05-07 07:57:54,599 - num_train_examples: 1334
2024-05-07 07:57:54,600 - need_aligned: True
2024-05-07 07:57:54,600 - freeze_parameters: False
2024-05-07 07:57:54,600 - eval_monitor: acc
2024-05-07 07:57:54,600 - train_batch_size: 32
2024-05-07 07:57:54,600 - eval_batch_size: 16
2024-05-07 07:57:54,600 - num_train_epochs: 100
2024-05-07 07:57:54,600 - lr: [2e-05]
2024-05-07 07:57:54,600 - weight_decay: [0.1]
2024-05-07 07:57:54,600 - wait_patience: 5
2024-05-07 07:57:54,600 - warmup_proportion: [0.01]
2024-05-07 07:57:54,600 - hidden_dims: [768]
2024-05-07 07:57:54,600 - num_attention_heads: [4]
2024-05-07 07:57:54,600 - attention_probs_dropout_prob: [0.3]
2024-05-07 07:57:54,600 - hidden_dropout_prob: [0.1]
2024-05-07 07:57:54,600 - intermediate_size: [768]
2024-05-07 07:57:54,600 - num_hidden_layers: [5]
2024-05-07 07:57:54,600 - max_position_embeddings: [768]
2024-05-07 07:57:54,600 - position_embedding_type: absolute
2024-05-07 07:57:54,600 - batch_first: True
2024-05-07 07:57:54,600 - aligned_method: ['ctc']
2024-05-07 07:57:54,600 - sampler: beta
2024-05-07 07:57:54,600 - multiple_ood: [1]
2024-05-07 07:57:54,601 - select_number_min: [2]
2024-05-07 07:57:54,601 - select_number_max: [3]
2024-05-07 07:57:54,601 - alpha: [3]
2024-05-07 07:57:54,601 - mlp_hidden_size: [256]
2024-05-07 07:57:54,601 - mlp_dropout: [0.3]
2024-05-07 07:57:54,601 - scale: [8]
2024-05-07 07:57:54,601 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_4
2024-05-07 07:57:54,601 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_4/models
2024-05-07 07:57:54,601 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_4
2024-05-07 07:57:54,601 - device: cuda
2024-05-07 07:57:54,601 - ============================== End Params ==============================
2024-05-07 07:57:56,314 - Multimodal Intent Recognition begins...
2024-05-07 07:57:56,314 - Training begins...
2024-05-07 07:58:30,909 - ***** Epoch: 1: Eval results *****
2024-05-07 07:58:30,909 -   binary_train_loss = 0.6815
2024-05-07 07:58:30,909 -   binary_eval_score = 0.9292
2024-05-07 07:58:30,909 -   train_loss = 2.0585
2024-05-07 07:58:30,909 -   eval_score = 0.6315
2024-05-07 07:58:30,909 -   best_eval_score = 0.0
2024-05-07 07:59:05,383 - ***** Epoch: 2: Eval results *****
2024-05-07 07:59:05,384 -   binary_train_loss = 0.67
2024-05-07 07:59:05,384 -   binary_eval_score = 0.7427
2024-05-07 07:59:05,384 -   train_loss = 0.8361
2024-05-07 07:59:05,384 -   eval_score = 0.6719
2024-05-07 07:59:05,384 -   best_eval_score = 0.6315
2024-05-07 07:59:39,877 - ***** Epoch: 3: Eval results *****
2024-05-07 07:59:39,877 -   binary_train_loss = 0.6372
2024-05-07 07:59:39,877 -   binary_eval_score = 0.7955
2024-05-07 07:59:39,877 -   train_loss = 0.4012
2024-05-07 07:59:39,877 -   eval_score = 0.7258
2024-05-07 07:59:39,877 -   best_eval_score = 0.6719
2024-05-07 08:00:14,932 - ***** Epoch: 4: Eval results *****
2024-05-07 08:00:14,932 -   binary_train_loss = 0.4905
2024-05-07 08:00:14,932 -   binary_eval_score = 0.8989
2024-05-07 08:00:14,933 -   train_loss = 0.2005
2024-05-07 08:00:14,933 -   eval_score = 0.7169
2024-05-07 08:00:14,933 -   best_eval_score = 0.7258
2024-05-07 08:00:14,933 - EarlyStopping counter: 1 out of 5
2024-05-07 08:00:50,966 - ***** Epoch: 5: Eval results *****
2024-05-07 08:00:50,966 -   binary_train_loss = 0.2712
2024-05-07 08:00:50,966 -   binary_eval_score = 0.8888
2024-05-07 08:00:50,966 -   train_loss = 0.1267
2024-05-07 08:00:50,966 -   eval_score = 0.7146
2024-05-07 08:00:50,966 -   best_eval_score = 0.7258
2024-05-07 08:00:50,966 - EarlyStopping counter: 2 out of 5
2024-05-07 08:01:25,856 - ***** Epoch: 6: Eval results *****
2024-05-07 08:01:25,856 -   binary_train_loss = 0.2128
2024-05-07 08:01:25,856 -   binary_eval_score = 0.8854
2024-05-07 08:01:25,856 -   train_loss = 0.0978
2024-05-07 08:01:25,856 -   eval_score = 0.7438
2024-05-07 08:01:25,856 -   best_eval_score = 0.7258
2024-05-07 08:02:01,347 - ***** Epoch: 7: Eval results *****
2024-05-07 08:02:01,347 -   binary_train_loss = 0.1632
2024-05-07 08:02:01,347 -   binary_eval_score = 0.918
2024-05-07 08:02:01,347 -   train_loss = 0.0799
2024-05-07 08:02:01,348 -   eval_score = 0.7393
2024-05-07 08:02:01,348 -   best_eval_score = 0.7438
2024-05-07 08:02:01,348 - EarlyStopping counter: 1 out of 5
2024-05-07 08:02:36,339 - ***** Epoch: 8: Eval results *****
2024-05-07 08:02:36,339 -   binary_train_loss = 0.1524
2024-05-07 08:02:36,339 -   binary_eval_score = 0.9404
2024-05-07 08:02:36,339 -   train_loss = 0.0463
2024-05-07 08:02:36,339 -   eval_score = 0.7326
2024-05-07 08:02:36,339 -   best_eval_score = 0.7438
2024-05-07 08:02:36,339 - EarlyStopping counter: 2 out of 5
2024-05-07 08:03:10,875 - ***** Epoch: 9: Eval results *****
2024-05-07 08:03:10,875 -   binary_train_loss = 0.1187
2024-05-07 08:03:10,875 -   binary_eval_score = 0.9663
2024-05-07 08:03:10,875 -   train_loss = 0.0425
2024-05-07 08:03:10,875 -   eval_score = 0.7371
2024-05-07 08:03:10,875 -   best_eval_score = 0.7438
2024-05-07 08:03:10,875 - EarlyStopping counter: 3 out of 5
2024-05-07 08:03:45,605 - ***** Epoch: 10: Eval results *****
2024-05-07 08:03:45,605 -   binary_train_loss = 0.1004
2024-05-07 08:03:45,605 -   binary_eval_score = 0.9652
2024-05-07 08:03:45,605 -   train_loss = 0.0371
2024-05-07 08:03:45,605 -   eval_score = 0.7281
2024-05-07 08:03:45,605 -   best_eval_score = 0.7438
2024-05-07 08:03:45,606 - EarlyStopping counter: 4 out of 5
2024-05-07 08:04:21,241 - ***** Epoch: 11: Eval results *****
2024-05-07 08:04:21,242 -   binary_train_loss = 0.0852
2024-05-07 08:04:21,242 -   binary_eval_score = 0.9674
2024-05-07 08:04:21,242 -   train_loss = 0.0323
2024-05-07 08:04:21,242 -   eval_score = 0.7169
2024-05-07 08:04:21,242 -   best_eval_score = 0.7438
2024-05-07 08:04:21,242 - EarlyStopping counter: 5 out of 5
2024-05-07 08:04:21,242 - EarlyStopping at epoch 11
2024-05-07 08:04:21,243 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_4/models
2024-05-07 08:04:26,596 - Training is finished...
2024-05-07 08:04:26,596 - Testing begins...
2024-05-07 08:04:40,053 - ***** Out-of-domain Evaluation results *****
2024-05-07 08:04:40,054 -   aupr_in = 0.7881
2024-05-07 08:04:40,054 -   aupr_out = 0.7985
2024-05-07 08:04:40,054 -   auroc = 0.7973
2024-05-07 08:04:40,054 -   der = 0.365
2024-05-07 08:04:40,054 -   eer = 0.28
2024-05-07 08:04:40,055 -   fpr95 = 0.6956
2024-05-07 08:04:40,055 - Testing is finished...
2024-05-07 08:04:40,055 - Multimodal intent recognition is finished...
2024-05-07 08:04:40,055 - Results are saved in results/results_msz_MIntRec.csv
