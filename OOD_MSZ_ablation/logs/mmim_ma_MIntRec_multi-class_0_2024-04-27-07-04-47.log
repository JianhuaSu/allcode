2024-04-27 07:04:47,681 - Lists of intent labels are: ['Complain', 'Praise', 'Apologise', 'Thank', 'Criticize', 'Agree', 'Taunt', 'Flaunt', 'Joke', 'Oppose', 'Comfort', 'Care', 'Inform', 'Advise', 'Arrange', 'Introduce', 'Leave', 'Prevent', 'Greet', 'Ask for help']
2024-04-27 07:04:47,681 - ID Data preparation...
2024-04-27 07:04:54,639 - OOD Data preparation...
2024-04-27 07:04:56,114 - ============================== Params ==============================
2024-04-27 07:04:56,114 - logger_name: mmim_ma_MIntRec_multi-class_0
2024-04-27 07:04:56,114 - dataset: MIntRec
2024-04-27 07:04:56,114 - ood_dataset: MIntRec-OOD
2024-04-27 07:04:56,114 - data_mode: multi-class
2024-04-27 07:04:56,114 - multimodal_method: mmim
2024-04-27 07:04:56,114 - method: mmim
2024-04-27 07:04:56,114 - ood_detection_method: ma
2024-04-27 07:04:56,114 - text_backbone: bert-base-uncased
2024-04-27 07:04:56,114 - seed: 0
2024-04-27 07:04:56,114 - num_workers: 8
2024-04-27 07:04:56,114 - log_id: mmim_ma_MIntRec_multi-class_0_2024-04-27-07-04-47
2024-04-27 07:04:56,114 - gpu_id: 3
2024-04-27 07:04:56,114 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-27 07:04:56,114 - train: True
2024-04-27 07:04:56,114 - tune: True
2024-04-27 07:04:56,114 - ood: True
2024-04-27 07:04:56,114 - save_model: True
2024-04-27 07:04:56,114 - save_results: True
2024-04-27 07:04:56,114 - log_path: logs
2024-04-27 07:04:56,114 - cache_path: cache
2024-04-27 07:04:56,114 - video_data_path: video_data
2024-04-27 07:04:56,114 - audio_data_path: audio_data
2024-04-27 07:04:56,114 - video_feats_path: swin_feats.pkl
2024-04-27 07:04:56,114 - ood_video_feats_path: swin_feats.pkl
2024-04-27 07:04:56,114 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-27 07:04:56,114 - audio_feats_path: wavlm_feats.pkl
2024-04-27 07:04:56,114 - results_path: results
2024-04-27 07:04:56,115 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/mmim
2024-04-27 07:04:56,115 - model_path: models
2024-04-27 07:04:56,115 - config_file_name: mmim_MIntRec
2024-04-27 07:04:56,115 - results_file_name: results_mmim_MIntRec.csv
2024-04-27 07:04:56,115 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-27 07:04:56,115 - text_seq_len: 30
2024-04-27 07:04:56,115 - video_seq_len: 230
2024-04-27 07:04:56,115 - audio_seq_len: 480
2024-04-27 07:04:56,115 - text_feat_dim: 768
2024-04-27 07:04:56,115 - video_feat_dim: 1024
2024-04-27 07:04:56,115 - audio_feat_dim: 768
2024-04-27 07:04:56,115 - ood_label_id: 20
2024-04-27 07:04:56,115 - num_labels: 20
2024-04-27 07:04:56,115 - num_train_examples: 1334
2024-04-27 07:04:56,115 - need_aligned: False
2024-04-27 07:04:56,115 - eval_monitor: f1
2024-04-27 07:04:56,115 - train_batch_size: 32
2024-04-27 07:04:56,115 - eval_batch_size: 16
2024-04-27 07:04:56,115 - test_batch_size: 16
2024-04-27 07:04:56,115 - wait_patience: 5
2024-04-27 07:04:56,115 - num_train_epochs: 100
2024-04-27 07:04:56,115 - add_va: False
2024-04-27 07:04:56,115 - cpc_activation: Tanh
2024-04-27 07:04:56,115 - mmilb_mid_activation: ReLU
2024-04-27 07:04:56,115 - mmilb_last_activation: Tanh
2024-04-27 07:04:56,115 - optim: Adam
2024-04-27 07:04:56,115 - contrast: True
2024-04-27 07:04:56,115 - bidirectional: True
2024-04-27 07:04:56,115 - grad_clip: 1.0
2024-04-27 07:04:56,115 - lr_main: [0.0002]
2024-04-27 07:04:56,115 - weight_decay_main: [0.0003]
2024-04-27 07:04:56,115 - lr_bert: [4e-05]
2024-04-27 07:04:56,115 - weight_decay_bert: [8e-05]
2024-04-27 07:04:56,115 - lr_mmilb: [0.003]
2024-04-27 07:04:56,115 - weight_decay_mmilb: [0.0001]
2024-04-27 07:04:56,115 - alpha: [0.1]
2024-04-27 07:04:56,115 - dropout_a: [0.1]
2024-04-27 07:04:56,115 - dropout_v: [0.1]
2024-04-27 07:04:56,115 - dropout_prj: [0.1]
2024-04-27 07:04:56,115 - n_layer: [1]
2024-04-27 07:04:56,115 - cpc_layers: [1]
2024-04-27 07:04:56,115 - d_vh: [32]
2024-04-27 07:04:56,115 - d_ah: [16]
2024-04-27 07:04:56,115 - d_vout: [8]
2024-04-27 07:04:56,116 - d_aout: [8]
2024-04-27 07:04:56,116 - d_prjh: [512]
2024-04-27 07:04:56,116 - scale: [20]
2024-04-27 07:04:56,116 - beta: [0.5]
2024-04-27 07:04:56,116 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/mmim/mmim_MIntRec_bert-base-uncased_multi-class_0
2024-04-27 07:04:56,116 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/mmim/mmim_MIntRec_bert-base-uncased_multi-class_0/models
2024-04-27 07:04:56,116 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/mmim/binary_mmim_MIntRec_bert-base-uncased_0
2024-04-27 07:04:56,116 - ============================== End Params ==============================
2024-04-27 07:04:59,218 - Multimodal Intent Recognition begins...
2024-04-27 07:04:59,218 - Training begins...
2024-04-27 07:05:18,839 - ***** Epoch: 1: Eval results *****
2024-04-27 07:05:18,840 -   best_eval_score = 0.0
2024-04-27 07:05:18,840 -   eval_score = 0.6269
2024-04-27 07:05:18,840 -   train_loss_main = 2.896
2024-04-27 07:05:18,840 -   train_loss_mmilb = 0.2435
2024-04-27 07:05:35,733 - ***** Epoch: 2: Eval results *****
2024-04-27 07:05:35,733 -   best_eval_score = 0.6269
2024-04-27 07:05:35,734 -   eval_score = 0.6765
2024-04-27 07:05:35,734 -   train_loss_main = 1.6681
2024-04-27 07:05:35,734 -   train_loss_mmilb = 0.0039
2024-04-27 07:05:53,809 - ***** Epoch: 3: Eval results *****
2024-04-27 07:05:53,809 -   best_eval_score = 0.6765
2024-04-27 07:05:53,809 -   eval_score = 0.643
2024-04-27 07:05:53,810 -   train_loss_main = 1.2447
2024-04-27 07:05:53,810 -   train_loss_mmilb = 0.0011
2024-04-27 07:05:53,810 - EarlyStopping counter: 1 out of 5
2024-04-27 07:06:11,385 - ***** Epoch: 4: Eval results *****
2024-04-27 07:06:11,386 -   best_eval_score = 0.6765
2024-04-27 07:06:11,386 -   eval_score = 0.6772
2024-04-27 07:06:11,386 -   train_loss_main = 1.0462
2024-04-27 07:06:11,386 -   train_loss_mmilb = 0.0007
2024-04-27 07:06:29,485 - ***** Epoch: 5: Eval results *****
2024-04-27 07:06:29,486 -   best_eval_score = 0.6772
2024-04-27 07:06:29,486 -   eval_score = 0.6994
2024-04-27 07:06:29,486 -   train_loss_main = 0.9748
2024-04-27 07:06:29,486 -   train_loss_mmilb = 0.0008
2024-04-27 07:06:47,846 - ***** Epoch: 6: Eval results *****
2024-04-27 07:06:47,847 -   best_eval_score = 0.6994
2024-04-27 07:06:47,847 -   eval_score = 0.6942
2024-04-27 07:06:47,847 -   train_loss_main = 0.9159
2024-04-27 07:06:47,847 -   train_loss_mmilb = 0.0008
2024-04-27 07:06:47,847 - EarlyStopping counter: 1 out of 5
2024-04-27 07:07:05,064 - ***** Epoch: 7: Eval results *****
2024-04-27 07:07:05,064 -   best_eval_score = 0.6994
2024-04-27 07:07:05,064 -   eval_score = 0.6921
2024-04-27 07:07:05,064 -   train_loss_main = 0.8752
2024-04-27 07:07:05,064 -   train_loss_mmilb = 0.0007
2024-04-27 07:07:05,064 - EarlyStopping counter: 2 out of 5
2024-04-27 07:07:22,820 - ***** Epoch: 8: Eval results *****
2024-04-27 07:07:22,820 -   best_eval_score = 0.6994
2024-04-27 07:07:22,820 -   eval_score = 0.7104
2024-04-27 07:07:22,821 -   train_loss_main = 0.855
2024-04-27 07:07:22,821 -   train_loss_mmilb = 0.0008
2024-04-27 07:07:40,195 - ***** Epoch: 9: Eval results *****
2024-04-27 07:07:40,195 -   best_eval_score = 0.7104
2024-04-27 07:07:40,195 -   eval_score = 0.6877
2024-04-27 07:07:40,195 -   train_loss_main = 0.8377
2024-04-27 07:07:40,196 -   train_loss_mmilb = 0.0007
2024-04-27 07:07:40,196 - EarlyStopping counter: 1 out of 5
2024-04-27 07:07:57,748 - ***** Epoch: 10: Eval results *****
2024-04-27 07:07:57,748 -   best_eval_score = 0.7104
2024-04-27 07:07:57,748 -   eval_score = 0.6998
2024-04-27 07:07:57,748 -   train_loss_main = 0.8286
2024-04-27 07:07:57,748 -   train_loss_mmilb = 0.0005
2024-04-27 07:07:57,748 - EarlyStopping counter: 2 out of 5
2024-04-27 07:08:15,070 - ***** Epoch: 11: Eval results *****
2024-04-27 07:08:15,070 -   best_eval_score = 0.7104
2024-04-27 07:08:15,071 -   eval_score = 0.7127
2024-04-27 07:08:15,071 -   train_loss_main = 0.8206
2024-04-27 07:08:15,071 -   train_loss_mmilb = 0.0006
2024-04-27 07:08:32,573 - ***** Epoch: 12: Eval results *****
2024-04-27 07:08:32,573 -   best_eval_score = 0.7127
2024-04-27 07:08:32,574 -   eval_score = 0.7186
2024-04-27 07:08:32,574 -   train_loss_main = 0.8135
2024-04-27 07:08:32,574 -   train_loss_mmilb = 0.0006
2024-04-27 07:08:49,739 - ***** Epoch: 13: Eval results *****
2024-04-27 07:08:49,739 -   best_eval_score = 0.7186
2024-04-27 07:08:49,739 -   eval_score = 0.7005
2024-04-27 07:08:49,739 -   train_loss_main = 0.8091
2024-04-27 07:08:49,739 -   train_loss_mmilb = 0.0006
2024-04-27 07:08:49,739 - EarlyStopping counter: 1 out of 5
2024-04-27 07:09:06,718 - ***** Epoch: 14: Eval results *****
2024-04-27 07:09:06,718 -   best_eval_score = 0.7186
2024-04-27 07:09:06,718 -   eval_score = 0.707
2024-04-27 07:09:06,718 -   train_loss_main = 0.8066
2024-04-27 07:09:06,718 -   train_loss_mmilb = 0.0005
2024-04-27 07:09:06,718 - EarlyStopping counter: 2 out of 5
2024-04-27 07:09:23,711 - ***** Epoch: 15: Eval results *****
2024-04-27 07:09:23,712 -   best_eval_score = 0.7186
2024-04-27 07:09:23,712 -   eval_score = 0.7085
2024-04-27 07:09:23,712 -   train_loss_main = 0.8046
2024-04-27 07:09:23,712 -   train_loss_mmilb = 0.0005
2024-04-27 07:09:23,712 - EarlyStopping counter: 3 out of 5
2024-04-27 07:09:40,283 - ***** Epoch: 16: Eval results *****
2024-04-27 07:09:40,283 -   best_eval_score = 0.7186
2024-04-27 07:09:40,284 -   eval_score = 0.7183
2024-04-27 07:09:40,284 -   train_loss_main = 0.8007
2024-04-27 07:09:40,284 -   train_loss_mmilb = 0.0005
2024-04-27 07:09:40,284 - EarlyStopping counter: 4 out of 5
2024-04-27 07:09:57,278 - ***** Epoch: 17: Eval results *****
2024-04-27 07:09:57,278 -   best_eval_score = 0.7186
2024-04-27 07:09:57,279 -   eval_score = 0.6981
2024-04-27 07:09:57,279 -   train_loss_main = 0.8001
2024-04-27 07:09:57,279 -   train_loss_mmilb = 0.0005
2024-04-27 07:09:57,279 - EarlyStopping counter: 5 out of 5
2024-04-27 07:09:57,279 - EarlyStopping at epoch 17
2024-04-27 07:09:57,279 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/mmim/mmim_MIntRec_bert-base-uncased_multi-class_0/models
2024-04-27 07:10:01,548 - Training is finished...
2024-04-27 07:10:01,548 - Testing begins...
2024-04-27 07:10:13,992 - ***** Out-of-domain Evaluation results *****
2024-04-27 07:10:13,992 -   aupr_in = 0.7609
2024-04-27 07:10:13,992 -   aupr_out = 0.7519
2024-04-27 07:10:13,992 -   auroc = 0.7633
2024-04-27 07:10:13,992 -   der = 0.3972
2024-04-27 07:10:13,992 -   eer = 0.3044
2024-04-27 07:10:13,992 -   fpr95 = 0.7489
2024-04-27 07:10:13,992 - Testing is finished...
2024-04-27 07:10:13,992 - Multimodal intent recognition is finished...
2024-04-27 07:10:13,992 - Results are saved in results/results_mmim_MIntRec.csv
2024-04-27 07:10:14,097 - ============================== Params ==============================
2024-04-27 07:10:14,097 - logger_name: mmim_ma_MIntRec_multi-class_0
2024-04-27 07:10:14,097 - dataset: MIntRec
2024-04-27 07:10:14,097 - ood_dataset: MIntRec-OOD
2024-04-27 07:10:14,097 - data_mode: multi-class
2024-04-27 07:10:14,097 - multimodal_method: mmim
2024-04-27 07:10:14,097 - method: mmim
2024-04-27 07:10:14,097 - ood_detection_method: ma
2024-04-27 07:10:14,097 - text_backbone: bert-base-uncased
2024-04-27 07:10:14,097 - seed: 1
2024-04-27 07:10:14,097 - num_workers: 8
2024-04-27 07:10:14,097 - log_id: mmim_ma_MIntRec_multi-class_0_2024-04-27-07-04-47
2024-04-27 07:10:14,097 - gpu_id: 3
2024-04-27 07:10:14,097 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-27 07:10:14,097 - train: True
2024-04-27 07:10:14,097 - tune: True
2024-04-27 07:10:14,097 - ood: True
2024-04-27 07:10:14,097 - save_model: True
2024-04-27 07:10:14,097 - save_results: True
2024-04-27 07:10:14,097 - log_path: logs
2024-04-27 07:10:14,097 - cache_path: cache
2024-04-27 07:10:14,097 - video_data_path: video_data
2024-04-27 07:10:14,097 - audio_data_path: audio_data
2024-04-27 07:10:14,097 - video_feats_path: swin_feats.pkl
2024-04-27 07:10:14,097 - ood_video_feats_path: swin_feats.pkl
2024-04-27 07:10:14,097 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-27 07:10:14,098 - audio_feats_path: wavlm_feats.pkl
2024-04-27 07:10:14,098 - results_path: results
2024-04-27 07:10:14,098 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/mmim
2024-04-27 07:10:14,098 - model_path: models
2024-04-27 07:10:14,098 - config_file_name: mmim_MIntRec
2024-04-27 07:10:14,098 - results_file_name: results_mmim_MIntRec.csv
2024-04-27 07:10:14,098 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-27 07:10:14,098 - text_seq_len: 30
2024-04-27 07:10:14,098 - video_seq_len: 230
2024-04-27 07:10:14,098 - audio_seq_len: 480
2024-04-27 07:10:14,098 - text_feat_dim: 768
2024-04-27 07:10:14,098 - video_feat_dim: 1024
2024-04-27 07:10:14,098 - audio_feat_dim: 768
2024-04-27 07:10:14,098 - ood_label_id: 20
2024-04-27 07:10:14,098 - num_labels: 20
2024-04-27 07:10:14,098 - num_train_examples: 1334
2024-04-27 07:10:14,098 - need_aligned: False
2024-04-27 07:10:14,098 - eval_monitor: f1
2024-04-27 07:10:14,098 - train_batch_size: 32
2024-04-27 07:10:14,098 - eval_batch_size: 16
2024-04-27 07:10:14,098 - test_batch_size: 16
2024-04-27 07:10:14,098 - wait_patience: 5
2024-04-27 07:10:14,098 - num_train_epochs: 100
2024-04-27 07:10:14,098 - add_va: False
2024-04-27 07:10:14,098 - cpc_activation: Tanh
2024-04-27 07:10:14,098 - mmilb_mid_activation: ReLU
2024-04-27 07:10:14,098 - mmilb_last_activation: Tanh
2024-04-27 07:10:14,098 - optim: Adam
2024-04-27 07:10:14,098 - contrast: True
2024-04-27 07:10:14,098 - bidirectional: True
2024-04-27 07:10:14,098 - grad_clip: 1.0
2024-04-27 07:10:14,098 - lr_main: [0.0002]
2024-04-27 07:10:14,098 - weight_decay_main: [0.0003]
2024-04-27 07:10:14,098 - lr_bert: [4e-05]
2024-04-27 07:10:14,098 - weight_decay_bert: [8e-05]
2024-04-27 07:10:14,098 - lr_mmilb: [0.003]
2024-04-27 07:10:14,098 - weight_decay_mmilb: [0.0001]
2024-04-27 07:10:14,099 - alpha: [0.1]
2024-04-27 07:10:14,099 - dropout_a: [0.1]
2024-04-27 07:10:14,099 - dropout_v: [0.1]
2024-04-27 07:10:14,099 - dropout_prj: [0.1]
2024-04-27 07:10:14,099 - n_layer: [1]
2024-04-27 07:10:14,099 - cpc_layers: [1]
2024-04-27 07:10:14,099 - d_vh: [32]
2024-04-27 07:10:14,099 - d_ah: [16]
2024-04-27 07:10:14,099 - d_vout: [8]
2024-04-27 07:10:14,099 - d_aout: [8]
2024-04-27 07:10:14,099 - d_prjh: [512]
2024-04-27 07:10:14,099 - scale: [20]
2024-04-27 07:10:14,099 - beta: [0.5]
2024-04-27 07:10:14,099 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/mmim/mmim_MIntRec_bert-base-uncased_multi-class_1
2024-04-27 07:10:14,099 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/mmim/mmim_MIntRec_bert-base-uncased_multi-class_1/models
2024-04-27 07:10:14,099 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/mmim/binary_mmim_MIntRec_bert-base-uncased_1
2024-04-27 07:10:14,099 - device: cuda
2024-04-27 07:10:14,099 - d_tout: 768
2024-04-27 07:10:14,099 - feat_size: 512
2024-04-27 07:10:14,099 - ============================== End Params ==============================
2024-04-27 07:10:15,345 - Multimodal Intent Recognition begins...
2024-04-27 07:10:15,345 - Training begins...
