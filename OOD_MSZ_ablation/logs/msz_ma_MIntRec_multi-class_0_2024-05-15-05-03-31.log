2024-05-15 05:03:31,171 - Lists of intent labels are: ['Complain', 'Praise', 'Apologise', 'Thank', 'Criticize', 'Agree', 'Taunt', 'Flaunt', 'Joke', 'Oppose', 'Comfort', 'Care', 'Inform', 'Advise', 'Arrange', 'Introduce', 'Leave', 'Prevent', 'Greet', 'Ask for help']
2024-05-15 05:03:31,171 - ID Data preparation...
2024-05-15 05:03:46,327 - OOD Data preparation...
2024-05-15 05:03:52,764 - ============================== Params ==============================
2024-05-15 05:03:52,764 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-15 05:03:52,764 - dataset: MIntRec
2024-05-15 05:03:52,765 - ood_dataset: MIntRec-OOD
2024-05-15 05:03:52,765 - data_mode: multi-class
2024-05-15 05:03:52,765 - multimodal_method: msz
2024-05-15 05:03:52,765 - method: msz
2024-05-15 05:03:52,765 - ood_detection_method: ma
2024-05-15 05:03:52,765 - text_backbone: bert-base-uncased
2024-05-15 05:03:52,765 - seed: 0
2024-05-15 05:03:52,765 - num_workers: 8
2024-05-15 05:03:52,765 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-15-05-03-31
2024-05-15 05:03:52,765 - gpu_id: 0
2024-05-15 05:03:52,765 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-15 05:03:52,765 - train: True
2024-05-15 05:03:52,765 - tune: True
2024-05-15 05:03:52,765 - ood: True
2024-05-15 05:03:52,765 - save_model: True
2024-05-15 05:03:52,765 - save_results: True
2024-05-15 05:03:52,765 - log_path: logs
2024-05-15 05:03:52,765 - cache_path: cache
2024-05-15 05:03:52,765 - video_data_path: video_data
2024-05-15 05:03:52,765 - audio_data_path: audio_data
2024-05-15 05:03:52,765 - video_feats_path: swin_feats.pkl
2024-05-15 05:03:52,765 - ood_video_feats_path: swin_feats.pkl
2024-05-15 05:03:52,765 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-15 05:03:52,765 - audio_feats_path: wavlm_feats.pkl
2024-05-15 05:03:52,765 - results_path: results
2024-05-15 05:03:52,765 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz
2024-05-15 05:03:52,765 - model_path: models
2024-05-15 05:03:52,765 - config_file_name: msz_MIntRec
2024-05-15 05:03:52,765 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-15 05:03:52,765 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-15 05:03:52,765 - text_seq_len: 30
2024-05-15 05:03:52,765 - video_seq_len: 230
2024-05-15 05:03:52,765 - audio_seq_len: 480
2024-05-15 05:03:52,765 - text_feat_dim: 768
2024-05-15 05:03:52,765 - video_feat_dim: 1024
2024-05-15 05:03:52,765 - audio_feat_dim: 768
2024-05-15 05:03:52,765 - ood_label_id: 20
2024-05-15 05:03:52,766 - num_labels: 20
2024-05-15 05:03:52,766 - num_train_examples: 1334
2024-05-15 05:03:52,766 - need_aligned: True
2024-05-15 05:03:52,766 - freeze_parameters: False
2024-05-15 05:03:52,766 - eval_monitor: acc
2024-05-15 05:03:52,766 - train_batch_size: 32
2024-05-15 05:03:52,766 - eval_batch_size: 16
2024-05-15 05:03:52,766 - num_train_epochs: 100
2024-05-15 05:03:52,766 - lr: [1e-05]
2024-05-15 05:03:52,766 - weight_decay: [0.1]
2024-05-15 05:03:52,766 - wait_patience: 5
2024-05-15 05:03:52,766 - warmup_proportion: [0.01]
2024-05-15 05:03:52,766 - hidden_dims: [768]
2024-05-15 05:03:52,766 - num_attention_heads: [4]
2024-05-15 05:03:52,766 - attention_probs_dropout_prob: [0.3]
2024-05-15 05:03:52,766 - hidden_dropout_prob: [0.2]
2024-05-15 05:03:52,766 - intermediate_size: [768]
2024-05-15 05:03:52,766 - num_hidden_layers: [6]
2024-05-15 05:03:52,766 - max_position_embeddings: [768]
2024-05-15 05:03:52,766 - position_embedding_type: absolute
2024-05-15 05:03:52,766 - batch_first: True
2024-05-15 05:03:52,766 - aligned_method: ['ctc']
2024-05-15 05:03:52,766 - sampler: beta
2024-05-15 05:03:52,766 - multiple_ood: [1]
2024-05-15 05:03:52,766 - select_number_min: [2]
2024-05-15 05:03:52,766 - select_number_max: [3]
2024-05-15 05:03:52,766 - alpha: [3]
2024-05-15 05:03:52,766 - mlp_hidden_size: [256]
2024-05-15 05:03:52,766 - mlp_dropout: [0.3]
2024-05-15 05:03:52,766 - scale: [16]
2024-05-15 05:03:52,766 - ablation: no_CosClass
2024-05-15 05:03:52,766 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_0
2024-05-15 05:03:52,766 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_0/models
2024-05-15 05:03:52,766 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/binary_msz_MIntRec_bert-base-uncased_0
2024-05-15 05:03:52,766 - ============================== End Params ==============================
2024-05-15 05:03:58,464 - Multimodal Intent Recognition begins...
2024-05-15 05:03:58,464 - Training begins...
2024-05-15 05:04:35,596 - ***** Epoch: 1: Eval results *****
2024-05-15 05:04:35,597 -   binary_train_loss = 0.6894
2024-05-15 05:04:35,597 -   binary_eval_score = 0.5775
2024-05-15 05:04:35,597 -   train_loss = 2.4139
2024-05-15 05:04:35,597 -   eval_score = 0.5438
2024-05-15 05:04:35,597 -   best_eval_score = 0.0
2024-05-15 05:05:11,060 - ***** Epoch: 2: Eval results *****
2024-05-15 05:05:11,060 -   binary_train_loss = 0.6791
2024-05-15 05:05:11,060 -   binary_eval_score = 0.6494
2024-05-15 05:05:11,060 -   train_loss = 1.1022
2024-05-15 05:05:11,060 -   eval_score = 0.6899
2024-05-15 05:05:11,060 -   best_eval_score = 0.5438
2024-05-15 05:05:46,635 - ***** Epoch: 3: Eval results *****
2024-05-15 05:05:46,635 -   binary_train_loss = 0.6626
2024-05-15 05:05:46,635 -   binary_eval_score = 0.6787
2024-05-15 05:05:46,635 -   train_loss = 0.5185
2024-05-15 05:05:46,635 -   eval_score = 0.6652
2024-05-15 05:05:46,635 -   best_eval_score = 0.6899
2024-05-15 05:05:46,636 - EarlyStopping counter: 1 out of 5
2024-05-15 05:06:22,210 - ***** Epoch: 4: Eval results *****
2024-05-15 05:06:22,211 -   binary_train_loss = 0.6283
2024-05-15 05:06:22,211 -   binary_eval_score = 0.7584
2024-05-15 05:06:22,211 -   train_loss = 0.2606
2024-05-15 05:06:22,211 -   eval_score = 0.7146
2024-05-15 05:06:22,211 -   best_eval_score = 0.6899
2024-05-15 05:06:58,233 - ***** Epoch: 5: Eval results *****
2024-05-15 05:06:58,234 -   binary_train_loss = 0.5258
2024-05-15 05:06:58,234 -   binary_eval_score = 0.8472
2024-05-15 05:06:58,234 -   train_loss = 0.2399
2024-05-15 05:06:58,234 -   eval_score = 0.6876
2024-05-15 05:06:58,234 -   best_eval_score = 0.7146
2024-05-15 05:06:58,234 - EarlyStopping counter: 1 out of 5
2024-05-15 05:07:33,620 - ***** Epoch: 6: Eval results *****
2024-05-15 05:07:33,621 -   binary_train_loss = 0.6017
2024-05-15 05:07:33,621 -   binary_eval_score = 0.7989
2024-05-15 05:07:33,621 -   train_loss = 0.2113
2024-05-15 05:07:33,621 -   eval_score = 0.7191
2024-05-15 05:07:33,621 -   best_eval_score = 0.7146
2024-05-15 05:08:09,502 - ***** Epoch: 7: Eval results *****
2024-05-15 05:08:09,503 -   binary_train_loss = 0.3194
2024-05-15 05:08:09,503 -   binary_eval_score = 0.8921
2024-05-15 05:08:09,503 -   train_loss = 0.079
2024-05-15 05:08:09,503 -   eval_score = 0.6921
2024-05-15 05:08:09,503 -   best_eval_score = 0.7191
2024-05-15 05:08:09,503 - EarlyStopping counter: 1 out of 5
2024-05-15 05:08:45,303 - ***** Epoch: 8: Eval results *****
2024-05-15 05:08:45,303 -   binary_train_loss = 0.2185
2024-05-15 05:08:45,303 -   binary_eval_score = 0.9056
2024-05-15 05:08:45,303 -   train_loss = 1.211
2024-05-15 05:08:45,303 -   eval_score = 0.6854
2024-05-15 05:08:45,303 -   best_eval_score = 0.7191
2024-05-15 05:08:45,303 - EarlyStopping counter: 2 out of 5
2024-05-15 05:09:20,731 - ***** Epoch: 9: Eval results *****
2024-05-15 05:09:20,731 -   binary_train_loss = 0.697
2024-05-15 05:09:20,731 -   binary_eval_score = 0.8652
2024-05-15 05:09:20,731 -   train_loss = 0.9238
2024-05-15 05:09:20,731 -   eval_score = 0.7213
2024-05-15 05:09:20,732 -   best_eval_score = 0.7191
2024-05-15 05:09:56,733 - ***** Epoch: 10: Eval results *****
2024-05-15 05:09:56,734 -   binary_train_loss = 0.3125
2024-05-15 05:09:56,734 -   binary_eval_score = 0.8719
2024-05-15 05:09:56,734 -   train_loss = 0.0461
2024-05-15 05:09:56,734 -   eval_score = 0.7146
2024-05-15 05:09:56,734 -   best_eval_score = 0.7213
2024-05-15 05:09:56,734 - EarlyStopping counter: 1 out of 5
2024-05-15 05:10:32,284 - ***** Epoch: 11: Eval results *****
2024-05-15 05:10:32,284 -   binary_train_loss = 0.1913
2024-05-15 05:10:32,284 -   binary_eval_score = 0.8674
2024-05-15 05:10:32,284 -   train_loss = 0.037
2024-05-15 05:10:32,284 -   eval_score = 0.6966
2024-05-15 05:10:32,284 -   best_eval_score = 0.7213
2024-05-15 05:10:32,284 - EarlyStopping counter: 2 out of 5
2024-05-15 05:11:08,181 - ***** Epoch: 12: Eval results *****
2024-05-15 05:11:08,182 -   binary_train_loss = 0.1639
2024-05-15 05:11:08,182 -   binary_eval_score = 0.8944
2024-05-15 05:11:08,182 -   train_loss = 0.0312
2024-05-15 05:11:08,182 -   eval_score = 0.6944
2024-05-15 05:11:08,182 -   best_eval_score = 0.7213
2024-05-15 05:11:08,182 - EarlyStopping counter: 3 out of 5
2024-05-15 05:11:43,899 - ***** Epoch: 13: Eval results *****
2024-05-15 05:11:43,899 -   binary_train_loss = 0.1282
2024-05-15 05:11:43,899 -   binary_eval_score = 0.9045
2024-05-15 05:11:43,899 -   train_loss = 0.1525
2024-05-15 05:11:43,899 -   eval_score = 0.6876
2024-05-15 05:11:43,899 -   best_eval_score = 0.7213
2024-05-15 05:11:43,899 - EarlyStopping counter: 4 out of 5
2024-05-15 05:12:19,918 - ***** Epoch: 14: Eval results *****
2024-05-15 05:12:19,918 -   binary_train_loss = 0.2564
2024-05-15 05:12:19,918 -   binary_eval_score = 0.8921
2024-05-15 05:12:19,918 -   train_loss = 0.0387
2024-05-15 05:12:19,919 -   eval_score = 0.7169
2024-05-15 05:12:19,919 -   best_eval_score = 0.7213
2024-05-15 05:12:19,919 - EarlyStopping counter: 5 out of 5
2024-05-15 05:12:19,919 - EarlyStopping at epoch 14
2024-05-15 05:12:19,921 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_0/models
2024-05-15 05:12:21,501 - Training is finished...
2024-05-15 05:12:21,502 - Testing begins...
2024-05-15 05:12:34,206 - ***** Out-of-domain Evaluation results *****
2024-05-15 05:12:34,206 -   aupr_in = 0.7706
2024-05-15 05:12:34,206 -   aupr_out = 0.7959
2024-05-15 05:12:34,206 -   auroc = 0.7952
2024-05-15 05:12:34,207 -   der = 0.363
2024-05-15 05:12:34,207 -   eer = 0.2667
2024-05-15 05:12:34,207 -   fpr95 = 0.68
2024-05-15 05:12:34,207 - Testing is finished...
2024-05-15 05:12:34,207 - Multimodal intent recognition is finished...
2024-05-15 05:12:34,207 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-15 05:12:34,697 - ============================== Params ==============================
2024-05-15 05:12:34,698 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-15 05:12:34,698 - dataset: MIntRec
2024-05-15 05:12:34,698 - ood_dataset: MIntRec-OOD
2024-05-15 05:12:34,698 - data_mode: multi-class
2024-05-15 05:12:34,698 - multimodal_method: msz
2024-05-15 05:12:34,698 - method: msz
2024-05-15 05:12:34,698 - ood_detection_method: ma
2024-05-15 05:12:34,698 - text_backbone: bert-base-uncased
2024-05-15 05:12:34,698 - seed: 1
2024-05-15 05:12:34,698 - num_workers: 8
2024-05-15 05:12:34,698 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-15-05-03-31
2024-05-15 05:12:34,698 - gpu_id: 0
2024-05-15 05:12:34,698 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-15 05:12:34,698 - train: True
2024-05-15 05:12:34,698 - tune: True
2024-05-15 05:12:34,698 - ood: True
2024-05-15 05:12:34,698 - save_model: True
2024-05-15 05:12:34,698 - save_results: True
2024-05-15 05:12:34,698 - log_path: logs
2024-05-15 05:12:34,698 - cache_path: cache
2024-05-15 05:12:34,698 - video_data_path: video_data
2024-05-15 05:12:34,698 - audio_data_path: audio_data
2024-05-15 05:12:34,699 - video_feats_path: swin_feats.pkl
2024-05-15 05:12:34,699 - ood_video_feats_path: swin_feats.pkl
2024-05-15 05:12:34,699 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-15 05:12:34,699 - audio_feats_path: wavlm_feats.pkl
2024-05-15 05:12:34,699 - results_path: results
2024-05-15 05:12:34,699 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz
2024-05-15 05:12:34,699 - model_path: models
2024-05-15 05:12:34,699 - config_file_name: msz_MIntRec
2024-05-15 05:12:34,699 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-15 05:12:34,699 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-15 05:12:34,699 - text_seq_len: 30
2024-05-15 05:12:34,699 - video_seq_len: 230
2024-05-15 05:12:34,699 - audio_seq_len: 480
2024-05-15 05:12:34,699 - text_feat_dim: 768
2024-05-15 05:12:34,699 - video_feat_dim: 1024
2024-05-15 05:12:34,699 - audio_feat_dim: 768
2024-05-15 05:12:34,699 - ood_label_id: 20
2024-05-15 05:12:34,699 - num_labels: 20
2024-05-15 05:12:34,699 - num_train_examples: 1334
2024-05-15 05:12:34,699 - need_aligned: True
2024-05-15 05:12:34,699 - freeze_parameters: False
2024-05-15 05:12:34,699 - eval_monitor: acc
2024-05-15 05:12:34,699 - train_batch_size: 32
2024-05-15 05:12:34,699 - eval_batch_size: 16
2024-05-15 05:12:34,699 - num_train_epochs: 100
2024-05-15 05:12:34,699 - lr: [1e-05]
2024-05-15 05:12:34,699 - weight_decay: [0.1]
2024-05-15 05:12:34,699 - wait_patience: 5
2024-05-15 05:12:34,699 - warmup_proportion: [0.01]
2024-05-15 05:12:34,699 - hidden_dims: [768]
2024-05-15 05:12:34,699 - num_attention_heads: [4]
2024-05-15 05:12:34,700 - attention_probs_dropout_prob: [0.3]
2024-05-15 05:12:34,700 - hidden_dropout_prob: [0.2]
2024-05-15 05:12:34,700 - intermediate_size: [768]
2024-05-15 05:12:34,700 - num_hidden_layers: [6]
2024-05-15 05:12:34,700 - max_position_embeddings: [768]
2024-05-15 05:12:34,700 - position_embedding_type: absolute
2024-05-15 05:12:34,700 - batch_first: True
2024-05-15 05:12:34,700 - aligned_method: ['ctc']
2024-05-15 05:12:34,700 - sampler: beta
2024-05-15 05:12:34,700 - multiple_ood: [1]
2024-05-15 05:12:34,700 - select_number_min: [2]
2024-05-15 05:12:34,700 - select_number_max: [3]
2024-05-15 05:12:34,700 - alpha: [3]
2024-05-15 05:12:34,700 - mlp_hidden_size: [256]
2024-05-15 05:12:34,700 - mlp_dropout: [0.3]
2024-05-15 05:12:34,700 - scale: [16]
2024-05-15 05:12:34,700 - ablation: no_CosClass
2024-05-15 05:12:34,700 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_1
2024-05-15 05:12:34,700 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-15 05:12:34,700 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/binary_msz_MIntRec_bert-base-uncased_1
2024-05-15 05:12:34,700 - device: cuda
2024-05-15 05:12:34,700 - ============================== End Params ==============================
2024-05-15 05:12:36,980 - Multimodal Intent Recognition begins...
2024-05-15 05:12:36,980 - Training begins...
2024-05-15 05:13:13,274 - ***** Epoch: 1: Eval results *****
2024-05-15 05:13:13,274 -   binary_train_loss = 0.6889
2024-05-15 05:13:13,274 -   binary_eval_score = 0.5247
2024-05-15 05:13:13,274 -   train_loss = 2.4073
2024-05-15 05:13:13,274 -   eval_score = 0.5213
2024-05-15 05:13:13,274 -   best_eval_score = 0.0
2024-05-15 05:13:49,457 - ***** Epoch: 2: Eval results *****
2024-05-15 05:13:49,457 -   binary_train_loss = 0.6819
2024-05-15 05:13:49,457 -   binary_eval_score = 0.6169
2024-05-15 05:13:49,457 -   train_loss = 1.1574
2024-05-15 05:13:49,457 -   eval_score = 0.6652
2024-05-15 05:13:49,458 -   best_eval_score = 0.5213
2024-05-15 05:14:25,787 - ***** Epoch: 3: Eval results *****
2024-05-15 05:14:25,787 -   binary_train_loss = 0.6693
2024-05-15 05:14:25,787 -   binary_eval_score = 0.7303
2024-05-15 05:14:25,787 -   train_loss = 0.5718
2024-05-15 05:14:25,788 -   eval_score = 0.7079
2024-05-15 05:14:25,788 -   best_eval_score = 0.6652
2024-05-15 05:15:01,892 - ***** Epoch: 4: Eval results *****
2024-05-15 05:15:01,892 -   binary_train_loss = 0.6367
2024-05-15 05:15:01,892 -   binary_eval_score = 0.8067
2024-05-15 05:15:01,892 -   train_loss = 0.2434
2024-05-15 05:15:01,892 -   eval_score = 0.6854
2024-05-15 05:15:01,892 -   best_eval_score = 0.7079
2024-05-15 05:15:01,892 - EarlyStopping counter: 1 out of 5
2024-05-15 05:15:38,619 - ***** Epoch: 5: Eval results *****
2024-05-15 05:15:38,619 -   binary_train_loss = 0.5257
2024-05-15 05:15:38,619 -   binary_eval_score = 0.882
2024-05-15 05:15:38,619 -   train_loss = 0.2723
2024-05-15 05:15:38,619 -   eval_score = 0.6629
2024-05-15 05:15:38,619 -   best_eval_score = 0.7079
2024-05-15 05:15:38,619 - EarlyStopping counter: 2 out of 5
2024-05-15 05:16:14,535 - ***** Epoch: 6: Eval results *****
2024-05-15 05:16:14,535 -   binary_train_loss = 0.4825
2024-05-15 05:16:14,535 -   binary_eval_score = 0.836
2024-05-15 05:16:14,535 -   train_loss = 0.2869
2024-05-15 05:16:14,535 -   eval_score = 0.7213
2024-05-15 05:16:14,535 -   best_eval_score = 0.7079
2024-05-15 05:16:50,335 - ***** Epoch: 7: Eval results *****
2024-05-15 05:16:50,335 -   binary_train_loss = 0.3742
2024-05-15 05:16:50,335 -   binary_eval_score = 0.9112
2024-05-15 05:16:50,335 -   train_loss = 0.2703
2024-05-15 05:16:50,335 -   eval_score = 0.7056
2024-05-15 05:16:50,335 -   best_eval_score = 0.7213
2024-05-15 05:16:50,335 - EarlyStopping counter: 1 out of 5
2024-05-15 05:17:26,845 - ***** Epoch: 8: Eval results *****
2024-05-15 05:17:26,846 -   binary_train_loss = 0.3739
2024-05-15 05:17:26,846 -   binary_eval_score = 0.8596
2024-05-15 05:17:26,846 -   train_loss = 0.2654
2024-05-15 05:17:26,846 -   eval_score = 0.6899
2024-05-15 05:17:26,846 -   best_eval_score = 0.7213
2024-05-15 05:17:26,846 - EarlyStopping counter: 2 out of 5
2024-05-15 05:18:03,195 - ***** Epoch: 9: Eval results *****
2024-05-15 05:18:03,196 -   binary_train_loss = 0.3175
2024-05-15 05:18:03,196 -   binary_eval_score = 0.8022
2024-05-15 05:18:03,196 -   train_loss = 0.1199
2024-05-15 05:18:03,196 -   eval_score = 0.6944
2024-05-15 05:18:03,196 -   best_eval_score = 0.7213
2024-05-15 05:18:03,196 - EarlyStopping counter: 3 out of 5
2024-05-15 05:18:39,327 - ***** Epoch: 10: Eval results *****
2024-05-15 05:18:39,327 -   binary_train_loss = 0.1805
2024-05-15 05:18:39,327 -   binary_eval_score = 0.864
2024-05-15 05:18:39,327 -   train_loss = 0.2599
2024-05-15 05:18:39,327 -   eval_score = 0.6652
2024-05-15 05:18:39,327 -   best_eval_score = 0.7213
2024-05-15 05:18:39,327 - EarlyStopping counter: 4 out of 5
2024-05-15 05:19:15,287 - ***** Epoch: 11: Eval results *****
2024-05-15 05:19:15,287 -   binary_train_loss = 0.1558
2024-05-15 05:19:15,287 -   binary_eval_score = 0.8854
2024-05-15 05:19:15,287 -   train_loss = 0.9046
2024-05-15 05:19:15,287 -   eval_score = 0.6809
2024-05-15 05:19:15,287 -   best_eval_score = 0.7213
2024-05-15 05:19:15,287 - EarlyStopping counter: 5 out of 5
2024-05-15 05:19:15,287 - EarlyStopping at epoch 11
2024-05-15 05:19:15,290 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-15 05:19:16,632 - Training is finished...
2024-05-15 05:19:16,632 - Testing begins...
2024-05-15 05:19:29,207 - ***** Out-of-domain Evaluation results *****
2024-05-15 05:19:29,208 -   aupr_in = 0.7462
2024-05-15 05:19:29,208 -   aupr_out = 0.7207
2024-05-15 05:19:29,208 -   auroc = 0.7463
2024-05-15 05:19:29,208 -   der = 0.4392
2024-05-15 05:19:29,208 -   eer = 0.32
2024-05-15 05:19:29,208 -   fpr95 = 0.8333
2024-05-15 05:19:29,208 - Testing is finished...
2024-05-15 05:19:29,208 - Multimodal intent recognition is finished...
2024-05-15 05:19:29,208 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-15 05:19:29,930 - ============================== Params ==============================
2024-05-15 05:19:29,930 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-15 05:19:29,931 - dataset: MIntRec
2024-05-15 05:19:29,931 - ood_dataset: MIntRec-OOD
2024-05-15 05:19:29,931 - data_mode: multi-class
2024-05-15 05:19:29,931 - multimodal_method: msz
2024-05-15 05:19:29,931 - method: msz
2024-05-15 05:19:29,931 - ood_detection_method: ma
2024-05-15 05:19:29,931 - text_backbone: bert-base-uncased
2024-05-15 05:19:29,931 - seed: 2
2024-05-15 05:19:29,931 - num_workers: 8
2024-05-15 05:19:29,931 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-15-05-03-31
2024-05-15 05:19:29,931 - gpu_id: 0
2024-05-15 05:19:29,931 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-15 05:19:29,931 - train: True
2024-05-15 05:19:29,931 - tune: True
2024-05-15 05:19:29,931 - ood: True
2024-05-15 05:19:29,931 - save_model: True
2024-05-15 05:19:29,931 - save_results: True
2024-05-15 05:19:29,931 - log_path: logs
2024-05-15 05:19:29,931 - cache_path: cache
2024-05-15 05:19:29,931 - video_data_path: video_data
2024-05-15 05:19:29,931 - audio_data_path: audio_data
2024-05-15 05:19:29,932 - video_feats_path: swin_feats.pkl
2024-05-15 05:19:29,932 - ood_video_feats_path: swin_feats.pkl
2024-05-15 05:19:29,932 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-15 05:19:29,932 - audio_feats_path: wavlm_feats.pkl
2024-05-15 05:19:29,932 - results_path: results
2024-05-15 05:19:29,932 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz
2024-05-15 05:19:29,932 - model_path: models
2024-05-15 05:19:29,932 - config_file_name: msz_MIntRec
2024-05-15 05:19:29,932 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-15 05:19:29,932 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-15 05:19:29,932 - text_seq_len: 30
2024-05-15 05:19:29,932 - video_seq_len: 230
2024-05-15 05:19:29,932 - audio_seq_len: 480
2024-05-15 05:19:29,932 - text_feat_dim: 768
2024-05-15 05:19:29,932 - video_feat_dim: 1024
2024-05-15 05:19:29,932 - audio_feat_dim: 768
2024-05-15 05:19:29,932 - ood_label_id: 20
2024-05-15 05:19:29,932 - num_labels: 20
2024-05-15 05:19:29,932 - num_train_examples: 1334
2024-05-15 05:19:29,932 - need_aligned: True
2024-05-15 05:19:29,932 - freeze_parameters: False
2024-05-15 05:19:29,932 - eval_monitor: acc
2024-05-15 05:19:29,932 - train_batch_size: 32
2024-05-15 05:19:29,932 - eval_batch_size: 16
2024-05-15 05:19:29,932 - num_train_epochs: 100
2024-05-15 05:19:29,932 - lr: [1e-05]
2024-05-15 05:19:29,932 - weight_decay: [0.1]
2024-05-15 05:19:29,932 - wait_patience: 5
2024-05-15 05:19:29,932 - warmup_proportion: [0.01]
2024-05-15 05:19:29,932 - hidden_dims: [768]
2024-05-15 05:19:29,932 - num_attention_heads: [4]
2024-05-15 05:19:29,932 - attention_probs_dropout_prob: [0.3]
2024-05-15 05:19:29,932 - hidden_dropout_prob: [0.2]
2024-05-15 05:19:29,932 - intermediate_size: [768]
2024-05-15 05:19:29,932 - num_hidden_layers: [6]
2024-05-15 05:19:29,932 - max_position_embeddings: [768]
2024-05-15 05:19:29,933 - position_embedding_type: absolute
2024-05-15 05:19:29,933 - batch_first: True
2024-05-15 05:19:29,933 - aligned_method: ['ctc']
2024-05-15 05:19:29,933 - sampler: beta
2024-05-15 05:19:29,933 - multiple_ood: [1]
2024-05-15 05:19:29,933 - select_number_min: [2]
2024-05-15 05:19:29,933 - select_number_max: [3]
2024-05-15 05:19:29,933 - alpha: [3]
2024-05-15 05:19:29,933 - mlp_hidden_size: [256]
2024-05-15 05:19:29,933 - mlp_dropout: [0.3]
2024-05-15 05:19:29,933 - scale: [16]
2024-05-15 05:19:29,933 - ablation: no_CosClass
2024-05-15 05:19:29,933 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_2
2024-05-15 05:19:29,933 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-15 05:19:29,933 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/binary_msz_MIntRec_bert-base-uncased_2
2024-05-15 05:19:29,933 - device: cuda
2024-05-15 05:19:29,933 - ============================== End Params ==============================
2024-05-15 05:19:32,034 - Multimodal Intent Recognition begins...
2024-05-15 05:19:32,034 - Training begins...
2024-05-15 05:20:08,640 - ***** Epoch: 1: Eval results *****
2024-05-15 05:20:08,640 -   binary_train_loss = 0.6885
2024-05-15 05:20:08,640 -   binary_eval_score = 0.5888
2024-05-15 05:20:08,640 -   train_loss = 2.4288
2024-05-15 05:20:08,640 -   eval_score = 0.5303
2024-05-15 05:20:08,640 -   best_eval_score = 0.0
2024-05-15 05:20:44,865 - ***** Epoch: 2: Eval results *****
2024-05-15 05:20:44,865 -   binary_train_loss = 0.6785
2024-05-15 05:20:44,865 -   binary_eval_score = 0.7056
2024-05-15 05:20:44,865 -   train_loss = 1.1336
2024-05-15 05:20:44,865 -   eval_score = 0.6876
2024-05-15 05:20:44,865 -   best_eval_score = 0.5303
2024-05-15 05:21:20,898 - ***** Epoch: 3: Eval results *****
2024-05-15 05:21:20,898 -   binary_train_loss = 0.6644
2024-05-15 05:21:20,898 -   binary_eval_score = 0.7292
2024-05-15 05:21:20,898 -   train_loss = 0.5315
2024-05-15 05:21:20,898 -   eval_score = 0.7034
2024-05-15 05:21:20,898 -   best_eval_score = 0.6876
2024-05-15 05:21:56,817 - ***** Epoch: 4: Eval results *****
2024-05-15 05:21:56,817 -   binary_train_loss = 0.6147
2024-05-15 05:21:56,817 -   binary_eval_score = 0.7708
2024-05-15 05:21:56,817 -   train_loss = 0.2303
2024-05-15 05:21:56,817 -   eval_score = 0.7169
2024-05-15 05:21:56,817 -   best_eval_score = 0.7034
2024-05-15 05:22:33,024 - ***** Epoch: 5: Eval results *****
2024-05-15 05:22:33,025 -   binary_train_loss = 0.4805
2024-05-15 05:22:33,025 -   binary_eval_score = 0.8461
2024-05-15 05:22:33,025 -   train_loss = 0.5155
2024-05-15 05:22:33,025 -   eval_score = 0.6562
2024-05-15 05:22:33,025 -   best_eval_score = 0.7169
2024-05-15 05:22:33,025 - EarlyStopping counter: 1 out of 5
2024-05-15 05:23:08,921 - ***** Epoch: 6: Eval results *****
2024-05-15 05:23:08,921 -   binary_train_loss = 0.6679
2024-05-15 05:23:08,921 -   binary_eval_score = 0.8022
2024-05-15 05:23:08,921 -   train_loss = 0.6871
2024-05-15 05:23:08,921 -   eval_score = 0.7281
2024-05-15 05:23:08,921 -   best_eval_score = 0.7169
2024-05-15 05:23:45,635 - ***** Epoch: 7: Eval results *****
2024-05-15 05:23:45,636 -   binary_train_loss = 0.356
2024-05-15 05:23:45,636 -   binary_eval_score = 0.8921
2024-05-15 05:23:45,636 -   train_loss = 0.106
2024-05-15 05:23:45,636 -   eval_score = 0.7169
2024-05-15 05:23:45,636 -   best_eval_score = 0.7281
2024-05-15 05:23:45,636 - EarlyStopping counter: 1 out of 5
2024-05-15 05:24:21,729 - ***** Epoch: 8: Eval results *****
2024-05-15 05:24:21,729 -   binary_train_loss = 0.2271
2024-05-15 05:24:21,729 -   binary_eval_score = 0.8562
2024-05-15 05:24:21,730 -   train_loss = 0.1988
2024-05-15 05:24:21,730 -   eval_score = 0.7034
2024-05-15 05:24:21,730 -   best_eval_score = 0.7281
2024-05-15 05:24:21,730 - EarlyStopping counter: 2 out of 5
2024-05-15 05:24:57,328 - ***** Epoch: 9: Eval results *****
2024-05-15 05:24:57,329 -   binary_train_loss = 0.1867
2024-05-15 05:24:57,329 -   binary_eval_score = 0.873
2024-05-15 05:24:57,329 -   train_loss = 0.7964
2024-05-15 05:24:57,329 -   eval_score = 0.6966
2024-05-15 05:24:57,329 -   best_eval_score = 0.7281
2024-05-15 05:24:57,329 - EarlyStopping counter: 3 out of 5
2024-05-15 05:25:33,713 - ***** Epoch: 10: Eval results *****
2024-05-15 05:25:33,714 -   binary_train_loss = 0.663
2024-05-15 05:25:33,714 -   binary_eval_score = 0.8629
2024-05-15 05:25:33,714 -   train_loss = 0.1404
2024-05-15 05:25:33,714 -   eval_score = 0.6944
2024-05-15 05:25:33,714 -   best_eval_score = 0.7281
2024-05-15 05:25:33,714 - EarlyStopping counter: 4 out of 5
2024-05-15 05:26:10,052 - ***** Epoch: 11: Eval results *****
2024-05-15 05:26:10,052 -   binary_train_loss = 0.2393
2024-05-15 05:26:10,052 -   binary_eval_score = 0.9146
2024-05-15 05:26:10,052 -   train_loss = 0.0173
2024-05-15 05:26:10,052 -   eval_score = 0.7146
2024-05-15 05:26:10,052 -   best_eval_score = 0.7281
2024-05-15 05:26:10,052 - EarlyStopping counter: 5 out of 5
2024-05-15 05:26:10,052 - EarlyStopping at epoch 11
2024-05-15 05:26:10,055 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-15 05:26:11,393 - Training is finished...
2024-05-15 05:26:11,393 - Testing begins...
2024-05-15 05:26:24,130 - ***** Out-of-domain Evaluation results *****
2024-05-15 05:26:24,130 -   aupr_in = 0.778
2024-05-15 05:26:24,130 -   aupr_out = 0.8052
2024-05-15 05:26:24,130 -   auroc = 0.8026
2024-05-15 05:26:24,130 -   der = 0.3441
2024-05-15 05:26:24,130 -   eer = 0.2556
2024-05-15 05:26:24,130 -   fpr95 = 0.6422
2024-05-15 05:26:24,131 - Testing is finished...
2024-05-15 05:26:24,131 - Multimodal intent recognition is finished...
2024-05-15 05:26:24,131 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-15 05:26:24,786 - ============================== Params ==============================
2024-05-15 05:26:24,786 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-15 05:26:24,786 - dataset: MIntRec
2024-05-15 05:26:24,786 - ood_dataset: MIntRec-OOD
2024-05-15 05:26:24,786 - data_mode: multi-class
2024-05-15 05:26:24,786 - multimodal_method: msz
2024-05-15 05:26:24,786 - method: msz
2024-05-15 05:26:24,786 - ood_detection_method: ma
2024-05-15 05:26:24,787 - text_backbone: bert-base-uncased
2024-05-15 05:26:24,787 - seed: 3
2024-05-15 05:26:24,787 - num_workers: 8
2024-05-15 05:26:24,787 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-15-05-03-31
2024-05-15 05:26:24,787 - gpu_id: 0
2024-05-15 05:26:24,787 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-15 05:26:24,787 - train: True
2024-05-15 05:26:24,787 - tune: True
2024-05-15 05:26:24,787 - ood: True
2024-05-15 05:26:24,787 - save_model: True
2024-05-15 05:26:24,787 - save_results: True
2024-05-15 05:26:24,787 - log_path: logs
2024-05-15 05:26:24,787 - cache_path: cache
2024-05-15 05:26:24,787 - video_data_path: video_data
2024-05-15 05:26:24,787 - audio_data_path: audio_data
2024-05-15 05:26:24,787 - video_feats_path: swin_feats.pkl
2024-05-15 05:26:24,787 - ood_video_feats_path: swin_feats.pkl
2024-05-15 05:26:24,787 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-15 05:26:24,787 - audio_feats_path: wavlm_feats.pkl
2024-05-15 05:26:24,787 - results_path: results
2024-05-15 05:26:24,787 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz
2024-05-15 05:26:24,787 - model_path: models
2024-05-15 05:26:24,787 - config_file_name: msz_MIntRec
2024-05-15 05:26:24,787 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-15 05:26:24,787 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-15 05:26:24,787 - text_seq_len: 30
2024-05-15 05:26:24,787 - video_seq_len: 230
2024-05-15 05:26:24,787 - audio_seq_len: 480
2024-05-15 05:26:24,787 - text_feat_dim: 768
2024-05-15 05:26:24,787 - video_feat_dim: 1024
2024-05-15 05:26:24,787 - audio_feat_dim: 768
2024-05-15 05:26:24,787 - ood_label_id: 20
2024-05-15 05:26:24,787 - num_labels: 20
2024-05-15 05:26:24,787 - num_train_examples: 1334
2024-05-15 05:26:24,788 - need_aligned: True
2024-05-15 05:26:24,788 - freeze_parameters: False
2024-05-15 05:26:24,788 - eval_monitor: acc
2024-05-15 05:26:24,788 - train_batch_size: 32
2024-05-15 05:26:24,788 - eval_batch_size: 16
2024-05-15 05:26:24,788 - num_train_epochs: 100
2024-05-15 05:26:24,788 - lr: [1e-05]
2024-05-15 05:26:24,788 - weight_decay: [0.1]
2024-05-15 05:26:24,788 - wait_patience: 5
2024-05-15 05:26:24,788 - warmup_proportion: [0.01]
2024-05-15 05:26:24,788 - hidden_dims: [768]
2024-05-15 05:26:24,788 - num_attention_heads: [4]
2024-05-15 05:26:24,788 - attention_probs_dropout_prob: [0.3]
2024-05-15 05:26:24,788 - hidden_dropout_prob: [0.2]
2024-05-15 05:26:24,788 - intermediate_size: [768]
2024-05-15 05:26:24,788 - num_hidden_layers: [6]
2024-05-15 05:26:24,788 - max_position_embeddings: [768]
2024-05-15 05:26:24,788 - position_embedding_type: absolute
2024-05-15 05:26:24,788 - batch_first: True
2024-05-15 05:26:24,788 - aligned_method: ['ctc']
2024-05-15 05:26:24,788 - sampler: beta
2024-05-15 05:26:24,788 - multiple_ood: [1]
2024-05-15 05:26:24,788 - select_number_min: [2]
2024-05-15 05:26:24,788 - select_number_max: [3]
2024-05-15 05:26:24,788 - alpha: [3]
2024-05-15 05:26:24,788 - mlp_hidden_size: [256]
2024-05-15 05:26:24,788 - mlp_dropout: [0.3]
2024-05-15 05:26:24,788 - scale: [16]
2024-05-15 05:26:24,788 - ablation: no_CosClass
2024-05-15 05:26:24,788 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_3
2024-05-15 05:26:24,788 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-15 05:26:24,788 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/binary_msz_MIntRec_bert-base-uncased_3
2024-05-15 05:26:24,789 - device: cuda
2024-05-15 05:26:24,789 - ============================== End Params ==============================
2024-05-15 05:26:26,805 - Multimodal Intent Recognition begins...
2024-05-15 05:26:26,806 - Training begins...
2024-05-15 05:27:02,890 - ***** Epoch: 1: Eval results *****
2024-05-15 05:27:02,890 -   binary_train_loss = 0.6872
2024-05-15 05:27:02,890 -   binary_eval_score = 0.691
2024-05-15 05:27:02,890 -   train_loss = 2.37
2024-05-15 05:27:02,890 -   eval_score = 0.5663
2024-05-15 05:27:02,890 -   best_eval_score = 0.0
2024-05-15 05:27:39,289 - ***** Epoch: 2: Eval results *****
2024-05-15 05:27:39,289 -   binary_train_loss = 0.674
2024-05-15 05:27:39,289 -   binary_eval_score = 0.6573
2024-05-15 05:27:39,289 -   train_loss = 1.0795
2024-05-15 05:27:39,289 -   eval_score = 0.6719
2024-05-15 05:27:39,289 -   best_eval_score = 0.5663
2024-05-15 05:28:15,674 - ***** Epoch: 3: Eval results *****
2024-05-15 05:28:15,675 -   binary_train_loss = 0.6586
2024-05-15 05:28:15,675 -   binary_eval_score = 0.7449
2024-05-15 05:28:15,675 -   train_loss = 0.5107
2024-05-15 05:28:15,675 -   eval_score = 0.7146
2024-05-15 05:28:15,675 -   best_eval_score = 0.6719
2024-05-15 05:28:52,004 - ***** Epoch: 4: Eval results *****
2024-05-15 05:28:52,005 -   binary_train_loss = 0.617
2024-05-15 05:28:52,005 -   binary_eval_score = 0.7831
2024-05-15 05:28:52,005 -   train_loss = 0.213
2024-05-15 05:28:52,005 -   eval_score = 0.6787
2024-05-15 05:28:52,005 -   best_eval_score = 0.7146
2024-05-15 05:28:52,005 - EarlyStopping counter: 1 out of 5
2024-05-15 05:29:27,834 - ***** Epoch: 5: Eval results *****
2024-05-15 05:29:27,835 -   binary_train_loss = 0.5247
2024-05-15 05:29:27,835 -   binary_eval_score = 0.891
2024-05-15 05:29:27,835 -   train_loss = 0.255
2024-05-15 05:29:27,835 -   eval_score = 0.6831
2024-05-15 05:29:27,835 -   best_eval_score = 0.7146
2024-05-15 05:29:27,835 - EarlyStopping counter: 2 out of 5
2024-05-15 05:30:04,153 - ***** Epoch: 6: Eval results *****
2024-05-15 05:30:04,153 -   binary_train_loss = 0.5734
2024-05-15 05:30:04,153 -   binary_eval_score = 0.8854
2024-05-15 05:30:04,154 -   train_loss = 0.1087
2024-05-15 05:30:04,154 -   eval_score = 0.7236
2024-05-15 05:30:04,154 -   best_eval_score = 0.7146
2024-05-15 05:30:40,234 - ***** Epoch: 7: Eval results *****
2024-05-15 05:30:40,234 -   binary_train_loss = 0.3335
2024-05-15 05:30:40,234 -   binary_eval_score = 0.8843
2024-05-15 05:30:40,234 -   train_loss = 0.1389
2024-05-15 05:30:40,234 -   eval_score = 0.7146
2024-05-15 05:30:40,234 -   best_eval_score = 0.7236
2024-05-15 05:30:40,234 - EarlyStopping counter: 1 out of 5
2024-05-15 05:31:16,499 - ***** Epoch: 8: Eval results *****
2024-05-15 05:31:16,499 -   binary_train_loss = 0.2095
2024-05-15 05:31:16,499 -   binary_eval_score = 0.9034
2024-05-15 05:31:16,499 -   train_loss = 1.029
2024-05-15 05:31:16,499 -   eval_score = 0.6742
2024-05-15 05:31:16,499 -   best_eval_score = 0.7236
2024-05-15 05:31:16,499 - EarlyStopping counter: 2 out of 5
2024-05-15 05:31:53,727 - ***** Epoch: 9: Eval results *****
2024-05-15 05:31:53,728 -   binary_train_loss = 0.846
2024-05-15 05:31:53,728 -   binary_eval_score = 0.7449
2024-05-15 05:31:53,728 -   train_loss = 0.3823
2024-05-15 05:31:53,728 -   eval_score = 0.6899
2024-05-15 05:31:53,728 -   best_eval_score = 0.7236
2024-05-15 05:31:53,728 - EarlyStopping counter: 3 out of 5
2024-05-15 05:32:29,920 - ***** Epoch: 10: Eval results *****
2024-05-15 05:32:29,920 -   binary_train_loss = 0.2965
2024-05-15 05:32:29,920 -   binary_eval_score = 0.8652
2024-05-15 05:32:29,920 -   train_loss = 0.1292
2024-05-15 05:32:29,920 -   eval_score = 0.7124
2024-05-15 05:32:29,920 -   best_eval_score = 0.7236
2024-05-15 05:32:29,920 - EarlyStopping counter: 4 out of 5
2024-05-15 05:33:05,918 - ***** Epoch: 11: Eval results *****
2024-05-15 05:33:05,919 -   binary_train_loss = 0.1981
2024-05-15 05:33:05,919 -   binary_eval_score = 0.9135
2024-05-15 05:33:05,919 -   train_loss = 0.0046
2024-05-15 05:33:05,919 -   eval_score = 0.7056
2024-05-15 05:33:05,919 -   best_eval_score = 0.7236
2024-05-15 05:33:05,919 - EarlyStopping counter: 5 out of 5
2024-05-15 05:33:05,919 - EarlyStopping at epoch 11
2024-05-15 05:33:05,922 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-15 05:33:07,355 - Training is finished...
2024-05-15 05:33:07,355 - Testing begins...
2024-05-15 05:33:20,078 - ***** Out-of-domain Evaluation results *****
2024-05-15 05:33:20,078 -   aupr_in = 0.7621
2024-05-15 05:33:20,078 -   aupr_out = 0.7833
2024-05-15 05:33:20,078 -   auroc = 0.7839
2024-05-15 05:33:20,078 -   der = 0.374
2024-05-15 05:33:20,078 -   eer = 0.2844
2024-05-15 05:33:20,078 -   fpr95 = 0.7022
2024-05-15 05:33:20,078 - Testing is finished...
2024-05-15 05:33:20,078 - Multimodal intent recognition is finished...
2024-05-15 05:33:20,079 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-15 05:33:20,749 - ============================== Params ==============================
2024-05-15 05:33:20,749 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-15 05:33:20,749 - dataset: MIntRec
2024-05-15 05:33:20,749 - ood_dataset: MIntRec-OOD
2024-05-15 05:33:20,749 - data_mode: multi-class
2024-05-15 05:33:20,749 - multimodal_method: msz
2024-05-15 05:33:20,749 - method: msz
2024-05-15 05:33:20,749 - ood_detection_method: ma
2024-05-15 05:33:20,749 - text_backbone: bert-base-uncased
2024-05-15 05:33:20,749 - seed: 4
2024-05-15 05:33:20,749 - num_workers: 8
2024-05-15 05:33:20,750 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-15-05-03-31
2024-05-15 05:33:20,750 - gpu_id: 0
2024-05-15 05:33:20,750 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-15 05:33:20,750 - train: True
2024-05-15 05:33:20,750 - tune: True
2024-05-15 05:33:20,750 - ood: True
2024-05-15 05:33:20,750 - save_model: True
2024-05-15 05:33:20,750 - save_results: True
2024-05-15 05:33:20,750 - log_path: logs
2024-05-15 05:33:20,750 - cache_path: cache
2024-05-15 05:33:20,750 - video_data_path: video_data
2024-05-15 05:33:20,750 - audio_data_path: audio_data
2024-05-15 05:33:20,750 - video_feats_path: swin_feats.pkl
2024-05-15 05:33:20,750 - ood_video_feats_path: swin_feats.pkl
2024-05-15 05:33:20,750 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-15 05:33:20,750 - audio_feats_path: wavlm_feats.pkl
2024-05-15 05:33:20,750 - results_path: results
2024-05-15 05:33:20,750 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz
2024-05-15 05:33:20,750 - model_path: models
2024-05-15 05:33:20,750 - config_file_name: msz_MIntRec
2024-05-15 05:33:20,750 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-15 05:33:20,750 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-15 05:33:20,750 - text_seq_len: 30
2024-05-15 05:33:20,751 - video_seq_len: 230
2024-05-15 05:33:20,751 - audio_seq_len: 480
2024-05-15 05:33:20,751 - text_feat_dim: 768
2024-05-15 05:33:20,751 - video_feat_dim: 1024
2024-05-15 05:33:20,751 - audio_feat_dim: 768
2024-05-15 05:33:20,751 - ood_label_id: 20
2024-05-15 05:33:20,751 - num_labels: 20
2024-05-15 05:33:20,751 - num_train_examples: 1334
2024-05-15 05:33:20,751 - need_aligned: True
2024-05-15 05:33:20,751 - freeze_parameters: False
2024-05-15 05:33:20,751 - eval_monitor: acc
2024-05-15 05:33:20,751 - train_batch_size: 32
2024-05-15 05:33:20,751 - eval_batch_size: 16
2024-05-15 05:33:20,751 - num_train_epochs: 100
2024-05-15 05:33:20,751 - lr: [1e-05]
2024-05-15 05:33:20,751 - weight_decay: [0.1]
2024-05-15 05:33:20,751 - wait_patience: 5
2024-05-15 05:33:20,751 - warmup_proportion: [0.01]
2024-05-15 05:33:20,751 - hidden_dims: [768]
2024-05-15 05:33:20,751 - num_attention_heads: [4]
2024-05-15 05:33:20,751 - attention_probs_dropout_prob: [0.3]
2024-05-15 05:33:20,751 - hidden_dropout_prob: [0.2]
2024-05-15 05:33:20,751 - intermediate_size: [768]
2024-05-15 05:33:20,752 - num_hidden_layers: [6]
2024-05-15 05:33:20,752 - max_position_embeddings: [768]
2024-05-15 05:33:20,752 - position_embedding_type: absolute
2024-05-15 05:33:20,752 - batch_first: True
2024-05-15 05:33:20,752 - aligned_method: ['ctc']
2024-05-15 05:33:20,752 - sampler: beta
2024-05-15 05:33:20,752 - multiple_ood: [1]
2024-05-15 05:33:20,752 - select_number_min: [2]
2024-05-15 05:33:20,752 - select_number_max: [3]
2024-05-15 05:33:20,752 - alpha: [3]
2024-05-15 05:33:20,752 - mlp_hidden_size: [256]
2024-05-15 05:33:20,752 - mlp_dropout: [0.3]
2024-05-15 05:33:20,752 - scale: [16]
2024-05-15 05:33:20,752 - ablation: no_CosClass
2024-05-15 05:33:20,752 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_4
2024-05-15 05:33:20,752 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_4/models
2024-05-15 05:33:20,752 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/binary_msz_MIntRec_bert-base-uncased_4
2024-05-15 05:33:20,752 - device: cuda
2024-05-15 05:33:20,752 - ============================== End Params ==============================
2024-05-15 05:33:22,775 - Multimodal Intent Recognition begins...
2024-05-15 05:33:22,775 - Training begins...
2024-05-15 05:33:59,055 - ***** Epoch: 1: Eval results *****
2024-05-15 05:33:59,055 -   binary_train_loss = 0.6877
2024-05-15 05:33:59,055 -   binary_eval_score = 0.6449
2024-05-15 05:33:59,056 -   train_loss = 2.4441
2024-05-15 05:33:59,056 -   eval_score = 0.5393
2024-05-15 05:33:59,056 -   best_eval_score = 0.0
2024-05-15 05:34:35,619 - ***** Epoch: 2: Eval results *****
2024-05-15 05:34:35,619 -   binary_train_loss = 0.6731
2024-05-15 05:34:35,619 -   binary_eval_score = 0.7326
2024-05-15 05:34:35,619 -   train_loss = 1.1532
2024-05-15 05:34:35,619 -   eval_score = 0.6787
2024-05-15 05:34:35,619 -   best_eval_score = 0.5393
2024-05-15 05:35:12,056 - ***** Epoch: 3: Eval results *****
2024-05-15 05:35:12,056 -   binary_train_loss = 0.6513
2024-05-15 05:35:12,056 -   binary_eval_score = 0.7573
2024-05-15 05:35:12,056 -   train_loss = 0.5183
2024-05-15 05:35:12,056 -   eval_score = 0.6966
2024-05-15 05:35:12,056 -   best_eval_score = 0.6787
2024-05-15 05:35:48,269 - ***** Epoch: 4: Eval results *****
2024-05-15 05:35:48,270 -   binary_train_loss = 0.5884
2024-05-15 05:35:48,270 -   binary_eval_score = 0.8483
2024-05-15 05:35:48,270 -   train_loss = 0.2189
2024-05-15 05:35:48,270 -   eval_score = 0.6764
2024-05-15 05:35:48,270 -   best_eval_score = 0.6966
2024-05-15 05:35:48,270 - EarlyStopping counter: 1 out of 5
2024-05-15 05:36:24,488 - ***** Epoch: 5: Eval results *****
2024-05-15 05:36:24,488 -   binary_train_loss = 0.4731
2024-05-15 05:36:24,488 -   binary_eval_score = 0.8899
2024-05-15 05:36:24,488 -   train_loss = 0.1964
2024-05-15 05:36:24,488 -   eval_score = 0.7079
2024-05-15 05:36:24,488 -   best_eval_score = 0.6966
2024-05-15 05:37:01,123 - ***** Epoch: 6: Eval results *****
2024-05-15 05:37:01,124 -   binary_train_loss = 0.3759
2024-05-15 05:37:01,124 -   binary_eval_score = 0.8607
2024-05-15 05:37:01,124 -   train_loss = 0.3946
2024-05-15 05:37:01,124 -   eval_score = 0.6809
2024-05-15 05:37:01,124 -   best_eval_score = 0.7079
2024-05-15 05:37:01,124 - EarlyStopping counter: 1 out of 5
2024-05-15 05:37:37,549 - ***** Epoch: 7: Eval results *****
2024-05-15 05:37:37,549 -   binary_train_loss = 0.2657
2024-05-15 05:37:37,549 -   binary_eval_score = 0.9034
2024-05-15 05:37:37,549 -   train_loss = 1.3993
2024-05-15 05:37:37,550 -   eval_score = 0.6382
2024-05-15 05:37:37,550 -   best_eval_score = 0.7079
2024-05-15 05:37:37,550 - EarlyStopping counter: 2 out of 5
2024-05-15 05:38:13,622 - ***** Epoch: 8: Eval results *****
2024-05-15 05:38:13,623 -   binary_train_loss = 0.546
2024-05-15 05:38:13,623 -   binary_eval_score = 0.8315
2024-05-15 05:38:13,623 -   train_loss = 0.2363
2024-05-15 05:38:13,623 -   eval_score = 0.6921
2024-05-15 05:38:13,623 -   best_eval_score = 0.7079
2024-05-15 05:38:13,623 - EarlyStopping counter: 3 out of 5
2024-05-15 05:38:49,916 - ***** Epoch: 9: Eval results *****
2024-05-15 05:38:49,917 -   binary_train_loss = 0.235
2024-05-15 05:38:49,917 -   binary_eval_score = 0.9067
2024-05-15 05:38:49,917 -   train_loss = 0.0385
2024-05-15 05:38:49,917 -   eval_score = 0.7034
2024-05-15 05:38:49,917 -   best_eval_score = 0.7079
2024-05-15 05:38:49,917 - EarlyStopping counter: 4 out of 5
2024-05-15 05:39:26,192 - ***** Epoch: 10: Eval results *****
2024-05-15 05:39:26,192 -   binary_train_loss = 0.1831
2024-05-15 05:39:26,192 -   binary_eval_score = 0.9067
2024-05-15 05:39:26,192 -   train_loss = 0.0513
2024-05-15 05:39:26,192 -   eval_score = 0.6944
2024-05-15 05:39:26,192 -   best_eval_score = 0.7079
2024-05-15 05:39:26,192 - EarlyStopping counter: 5 out of 5
2024-05-15 05:39:26,192 - EarlyStopping at epoch 10
2024-05-15 05:39:26,195 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_4/models
2024-05-15 05:39:27,569 - Training is finished...
2024-05-15 05:39:27,570 - Testing begins...
2024-05-15 05:39:40,562 - ***** Out-of-domain Evaluation results *****
2024-05-15 05:39:40,562 -   aupr_in = 0.7591
2024-05-15 05:39:40,562 -   aupr_out = 0.7839
2024-05-15 05:39:40,562 -   auroc = 0.7821
2024-05-15 05:39:40,562 -   der = 0.3618
2024-05-15 05:39:40,563 -   eer = 0.2933
2024-05-15 05:39:40,563 -   fpr95 = 0.68
2024-05-15 05:39:40,563 - Testing is finished...
2024-05-15 05:39:40,563 - Multimodal intent recognition is finished...
2024-05-15 05:39:40,563 - Results are saved in results/results_msz_ablation_MIntRec.csv
