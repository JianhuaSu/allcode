2024-05-04 13:23:07,665 - Lists of intent labels are: ['Complain', 'Praise', 'Apologise', 'Thank', 'Criticize', 'Agree', 'Taunt', 'Flaunt', 'Joke', 'Oppose', 'Comfort', 'Care', 'Inform', 'Advise', 'Arrange', 'Introduce', 'Leave', 'Prevent', 'Greet', 'Ask for help']
2024-05-04 13:23:07,665 - ID Data preparation...
2024-05-04 13:23:13,894 - OOD Data preparation...
2024-05-04 13:23:15,205 - ============================== Params ==============================
2024-05-04 13:23:15,205 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-04 13:23:15,205 - dataset: MIntRec
2024-05-04 13:23:15,205 - ood_dataset: MIntRec-OOD
2024-05-04 13:23:15,205 - data_mode: multi-class
2024-05-04 13:23:15,205 - multimodal_method: msz
2024-05-04 13:23:15,205 - method: msz
2024-05-04 13:23:15,205 - ood_detection_method: ma
2024-05-04 13:23:15,205 - text_backbone: bert-base-uncased
2024-05-04 13:23:15,205 - seed: 1
2024-05-04 13:23:15,205 - num_workers: 8
2024-05-04 13:23:15,205 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-04-13-23-07
2024-05-04 13:23:15,205 - gpu_id: 2
2024-05-04 13:23:15,205 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-04 13:23:15,205 - train: True
2024-05-04 13:23:15,205 - tune: True
2024-05-04 13:23:15,205 - ood: True
2024-05-04 13:23:15,205 - save_model: False
2024-05-04 13:23:15,205 - save_results: True
2024-05-04 13:23:15,205 - log_path: logs
2024-05-04 13:23:15,205 - cache_path: cache
2024-05-04 13:23:15,205 - video_data_path: video_data
2024-05-04 13:23:15,205 - audio_data_path: audio_data
2024-05-04 13:23:15,205 - video_feats_path: swin_feats.pkl
2024-05-04 13:23:15,205 - ood_video_feats_path: swin_feats.pkl
2024-05-04 13:23:15,205 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-04 13:23:15,205 - audio_feats_path: wavlm_feats.pkl
2024-05-04 13:23:15,205 - results_path: results
2024-05-04 13:23:15,205 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-04 13:23:15,205 - model_path: models
2024-05-04 13:23:15,205 - config_file_name: msz_MIntRec
2024-05-04 13:23:15,205 - results_file_name: results_msz_MIntRec.csv
2024-05-04 13:23:15,205 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-04 13:23:15,205 - text_seq_len: 30
2024-05-04 13:23:15,205 - video_seq_len: 230
2024-05-04 13:23:15,205 - audio_seq_len: 480
2024-05-04 13:23:15,206 - text_feat_dim: 768
2024-05-04 13:23:15,206 - video_feat_dim: 1024
2024-05-04 13:23:15,206 - audio_feat_dim: 768
2024-05-04 13:23:15,206 - ood_label_id: 20
2024-05-04 13:23:15,206 - num_labels: 20
2024-05-04 13:23:15,206 - num_train_examples: 1334
2024-05-04 13:23:15,206 - need_aligned: True
2024-05-04 13:23:15,206 - freeze_parameters: False
2024-05-04 13:23:15,206 - eval_monitor: acc
2024-05-04 13:23:15,206 - train_batch_size: 32
2024-05-04 13:23:15,206 - eval_batch_size: 16
2024-05-04 13:23:15,206 - num_train_epochs: 100
2024-05-04 13:23:15,206 - lr: [2e-05]
2024-05-04 13:23:15,206 - weight_decay: [0.1]
2024-05-04 13:23:15,206 - wait_patience: 5
2024-05-04 13:23:15,206 - warmup_proportion: [0.01]
2024-05-04 13:23:15,206 - hidden_dims: [768]
2024-05-04 13:23:15,206 - num_attention_heads: [4]
2024-05-04 13:23:15,206 - attention_probs_dropout_prob: [0.3]
2024-05-04 13:23:15,206 - hidden_dropout_prob: [0.1]
2024-05-04 13:23:15,206 - intermediate_size: [768]
2024-05-04 13:23:15,206 - num_hidden_layers: [5]
2024-05-04 13:23:15,206 - max_position_embeddings: [768]
2024-05-04 13:23:15,206 - position_embedding_type: absolute
2024-05-04 13:23:15,206 - batch_first: True
2024-05-04 13:23:15,206 - aligned_method: ['ctc']
2024-05-04 13:23:15,206 - sampler: beta
2024-05-04 13:23:15,206 - multiple_ood: [1]
2024-05-04 13:23:15,206 - select_number_min: [2]
2024-05-04 13:23:15,206 - select_number_max: [3]
2024-05-04 13:23:15,206 - alpha: [3]
2024-05-04 13:23:15,206 - mlp_hidden_size: [256]
2024-05-04 13:23:15,206 - mlp_dropout: [0.3]
2024-05-04 13:23:15,206 - scale: [8]
2024-05-04 13:23:15,206 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_1
2024-05-04 13:23:15,206 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-04 13:23:15,206 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_1
2024-05-04 13:23:15,206 - ============================== End Params ==============================
2024-05-04 13:23:18,027 - Multimodal Intent Recognition begins...
2024-05-04 13:23:18,028 - Training begins...
2024-05-04 13:23:54,097 - ***** Epoch: 1: Eval results *****
2024-05-04 13:23:54,097 -   binary_train_loss = 0.6827
2024-05-04 13:23:54,097 -   binary_eval_score = 0.8438
2024-05-04 13:23:54,097 -   train_loss = 2.0436
2024-05-04 13:23:54,097 -   eval_score = 0.6472
2024-05-04 13:23:54,097 -   best_eval_score = 0.0
2024-05-04 13:24:28,733 - ***** Epoch: 2: Eval results *****
2024-05-04 13:24:28,734 -   binary_train_loss = 0.6731
2024-05-04 13:24:28,734 -   binary_eval_score = 0.7045
2024-05-04 13:24:28,734 -   train_loss = 0.8779
2024-05-04 13:24:28,734 -   eval_score = 0.6921
2024-05-04 13:24:28,734 -   best_eval_score = 0.6472
2024-05-04 13:25:03,987 - ***** Epoch: 3: Eval results *****
2024-05-04 13:25:03,987 -   binary_train_loss = 0.6476
2024-05-04 13:25:03,987 -   binary_eval_score = 0.7652
2024-05-04 13:25:03,987 -   train_loss = 0.3675
2024-05-04 13:25:03,987 -   eval_score = 0.7124
2024-05-04 13:25:03,987 -   best_eval_score = 0.6921
2024-05-04 13:25:38,184 - ***** Epoch: 4: Eval results *****
2024-05-04 13:25:38,185 -   binary_train_loss = 0.496
2024-05-04 13:25:38,185 -   binary_eval_score = 0.8921
2024-05-04 13:25:38,185 -   train_loss = 0.1986
2024-05-04 13:25:38,185 -   eval_score = 0.7303
2024-05-04 13:25:38,185 -   best_eval_score = 0.7124
2024-05-04 13:26:12,746 - ***** Epoch: 5: Eval results *****
2024-05-04 13:26:12,746 -   binary_train_loss = 0.2972
2024-05-04 13:26:12,746 -   binary_eval_score = 0.7539
2024-05-04 13:26:12,746 -   train_loss = 0.1376
2024-05-04 13:26:12,746 -   eval_score = 0.7326
2024-05-04 13:26:12,746 -   best_eval_score = 0.7303
2024-05-04 13:26:47,592 - ***** Epoch: 6: Eval results *****
2024-05-04 13:26:47,592 -   binary_train_loss = 0.2733
2024-05-04 13:26:47,592 -   binary_eval_score = 0.864
2024-05-04 13:26:47,592 -   train_loss = 0.0781
2024-05-04 13:26:47,592 -   eval_score = 0.7281
2024-05-04 13:26:47,592 -   best_eval_score = 0.7326
2024-05-04 13:26:47,592 - EarlyStopping counter: 1 out of 5
2024-05-04 13:27:21,856 - ***** Epoch: 7: Eval results *****
2024-05-04 13:27:21,856 -   binary_train_loss = 0.1881
2024-05-04 13:27:21,856 -   binary_eval_score = 0.9079
2024-05-04 13:27:21,856 -   train_loss = 0.0642
2024-05-04 13:27:21,856 -   eval_score = 0.7191
2024-05-04 13:27:21,857 -   best_eval_score = 0.7326
2024-05-04 13:27:21,857 - EarlyStopping counter: 2 out of 5
2024-05-04 13:27:56,523 - ***** Epoch: 8: Eval results *****
2024-05-04 13:27:56,523 -   binary_train_loss = 0.1621
2024-05-04 13:27:56,523 -   binary_eval_score = 0.9427
2024-05-04 13:27:56,523 -   train_loss = 0.0543
2024-05-04 13:27:56,523 -   eval_score = 0.7326
2024-05-04 13:27:56,523 -   best_eval_score = 0.7326
2024-05-04 13:27:56,523 - EarlyStopping counter: 3 out of 5
2024-05-04 13:28:30,848 - ***** Epoch: 9: Eval results *****
2024-05-04 13:28:30,849 -   binary_train_loss = 0.1644
2024-05-04 13:28:30,849 -   binary_eval_score = 0.8888
2024-05-04 13:28:30,849 -   train_loss = 0.0455
2024-05-04 13:28:30,849 -   eval_score = 0.7371
2024-05-04 13:28:30,849 -   best_eval_score = 0.7326
2024-05-04 13:29:05,206 - ***** Epoch: 10: Eval results *****
2024-05-04 13:29:05,207 -   binary_train_loss = 0.155
2024-05-04 13:29:05,207 -   binary_eval_score = 0.9382
2024-05-04 13:29:05,207 -   train_loss = 0.0385
2024-05-04 13:29:05,207 -   eval_score = 0.7326
2024-05-04 13:29:05,207 -   best_eval_score = 0.7371
2024-05-04 13:29:05,207 - EarlyStopping counter: 1 out of 5
2024-05-04 13:29:39,860 - ***** Epoch: 11: Eval results *****
2024-05-04 13:29:39,860 -   binary_train_loss = 0.1497
2024-05-04 13:29:39,860 -   binary_eval_score = 0.9539
2024-05-04 13:29:39,860 -   train_loss = 0.0344
2024-05-04 13:29:39,860 -   eval_score = 0.7303
2024-05-04 13:29:39,860 -   best_eval_score = 0.7371
2024-05-04 13:29:39,860 - EarlyStopping counter: 2 out of 5
2024-05-04 13:30:14,280 - ***** Epoch: 12: Eval results *****
2024-05-04 13:30:14,280 -   binary_train_loss = 0.131
2024-05-04 13:30:14,280 -   binary_eval_score = 0.9461
2024-05-04 13:30:14,280 -   train_loss = 0.0298
2024-05-04 13:30:14,280 -   eval_score = 0.7326
2024-05-04 13:30:14,280 -   best_eval_score = 0.7371
2024-05-04 13:30:14,280 - EarlyStopping counter: 3 out of 5
2024-05-04 13:30:48,479 - ***** Epoch: 13: Eval results *****
2024-05-04 13:30:48,479 -   binary_train_loss = 0.1138
2024-05-04 13:30:48,479 -   binary_eval_score = 0.9708
2024-05-04 13:30:48,479 -   train_loss = 0.0304
2024-05-04 13:30:48,479 -   eval_score = 0.7461
2024-05-04 13:30:48,479 -   best_eval_score = 0.7371
2024-05-04 13:31:22,703 - ***** Epoch: 14: Eval results *****
2024-05-04 13:31:22,704 -   binary_train_loss = 0.1115
2024-05-04 13:31:22,704 -   binary_eval_score = 0.9528
2024-05-04 13:31:22,704 -   train_loss = 0.0281
2024-05-04 13:31:22,704 -   eval_score = 0.7213
2024-05-04 13:31:22,704 -   best_eval_score = 0.7461
2024-05-04 13:31:22,704 - EarlyStopping counter: 1 out of 5
2024-05-04 13:31:57,175 - ***** Epoch: 15: Eval results *****
2024-05-04 13:31:57,175 -   binary_train_loss = 0.1069
2024-05-04 13:31:57,175 -   binary_eval_score = 0.9854
2024-05-04 13:31:57,175 -   train_loss = 0.0235
2024-05-04 13:31:57,175 -   eval_score = 0.7371
2024-05-04 13:31:57,175 -   best_eval_score = 0.7461
2024-05-04 13:31:57,175 - EarlyStopping counter: 2 out of 5
2024-05-04 13:32:31,904 - ***** Epoch: 16: Eval results *****
2024-05-04 13:32:31,904 -   binary_train_loss = 0.0768
2024-05-04 13:32:31,904 -   binary_eval_score = 0.9854
2024-05-04 13:32:31,904 -   train_loss = 0.0239
2024-05-04 13:32:31,904 -   eval_score = 0.7213
2024-05-04 13:32:31,905 -   best_eval_score = 0.7461
2024-05-04 13:32:31,905 - EarlyStopping counter: 3 out of 5
2024-05-04 13:33:06,560 - ***** Epoch: 17: Eval results *****
2024-05-04 13:33:06,560 -   binary_train_loss = 0.0677
2024-05-04 13:33:06,560 -   binary_eval_score = 0.9798
2024-05-04 13:33:06,560 -   train_loss = 0.0204
2024-05-04 13:33:06,560 -   eval_score = 0.7169
2024-05-04 13:33:06,560 -   best_eval_score = 0.7461
2024-05-04 13:33:06,560 - EarlyStopping counter: 4 out of 5
2024-05-04 13:33:41,068 - ***** Epoch: 18: Eval results *****
2024-05-04 13:33:41,068 -   binary_train_loss = 0.0646
2024-05-04 13:33:41,068 -   binary_eval_score = 0.9955
2024-05-04 13:33:41,068 -   train_loss = 0.0197
2024-05-04 13:33:41,068 -   eval_score = 0.7236
2024-05-04 13:33:41,068 -   best_eval_score = 0.7461
2024-05-04 13:33:41,068 - EarlyStopping counter: 5 out of 5
2024-05-04 13:33:41,068 - EarlyStopping at epoch 18
2024-05-04 13:33:41,071 - Training is finished...
2024-05-04 13:33:41,072 - Testing begins...
2024-05-04 13:33:54,167 - ***** Out-of-domain Evaluation results *****
2024-05-04 13:33:54,167 -   aupr_in = 0.7794
2024-05-04 13:33:54,167 -   aupr_out = 0.7924
2024-05-04 13:33:54,167 -   auroc = 0.7958
2024-05-04 13:33:54,168 -   der = 0.3596
2024-05-04 13:33:54,168 -   eer = 0.2667
2024-05-04 13:33:54,168 -   fpr95 = 0.68
2024-05-04 13:33:54,168 - Testing is finished...
2024-05-04 13:33:54,168 - Multimodal intent recognition is finished...
2024-05-04 13:33:54,168 - Results are saved in results/results_msz_MIntRec.csv
2024-05-04 13:33:54,498 - ============================== Params ==============================
2024-05-04 13:33:54,498 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-04 13:33:54,498 - dataset: MIntRec
2024-05-04 13:33:54,498 - ood_dataset: MIntRec-OOD
2024-05-04 13:33:54,498 - data_mode: multi-class
2024-05-04 13:33:54,498 - multimodal_method: msz
2024-05-04 13:33:54,498 - method: msz
2024-05-04 13:33:54,498 - ood_detection_method: ma
2024-05-04 13:33:54,498 - text_backbone: bert-base-uncased
2024-05-04 13:33:54,498 - seed: 2
2024-05-04 13:33:54,498 - num_workers: 8
2024-05-04 13:33:54,498 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-04-13-23-07
2024-05-04 13:33:54,498 - gpu_id: 2
2024-05-04 13:33:54,498 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-04 13:33:54,498 - train: True
2024-05-04 13:33:54,498 - tune: True
2024-05-04 13:33:54,499 - ood: True
2024-05-04 13:33:54,499 - save_model: False
2024-05-04 13:33:54,499 - save_results: True
2024-05-04 13:33:54,499 - log_path: logs
2024-05-04 13:33:54,499 - cache_path: cache
2024-05-04 13:33:54,499 - video_data_path: video_data
2024-05-04 13:33:54,499 - audio_data_path: audio_data
2024-05-04 13:33:54,499 - video_feats_path: swin_feats.pkl
2024-05-04 13:33:54,499 - ood_video_feats_path: swin_feats.pkl
2024-05-04 13:33:54,499 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-04 13:33:54,499 - audio_feats_path: wavlm_feats.pkl
2024-05-04 13:33:54,499 - results_path: results
2024-05-04 13:33:54,499 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-04 13:33:54,499 - model_path: models
2024-05-04 13:33:54,499 - config_file_name: msz_MIntRec
2024-05-04 13:33:54,499 - results_file_name: results_msz_MIntRec.csv
2024-05-04 13:33:54,499 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-04 13:33:54,499 - text_seq_len: 30
2024-05-04 13:33:54,499 - video_seq_len: 230
2024-05-04 13:33:54,499 - audio_seq_len: 480
2024-05-04 13:33:54,499 - text_feat_dim: 768
2024-05-04 13:33:54,499 - video_feat_dim: 1024
2024-05-04 13:33:54,499 - audio_feat_dim: 768
2024-05-04 13:33:54,499 - ood_label_id: 20
2024-05-04 13:33:54,499 - num_labels: 20
2024-05-04 13:33:54,499 - num_train_examples: 1334
2024-05-04 13:33:54,499 - need_aligned: True
2024-05-04 13:33:54,499 - freeze_parameters: False
2024-05-04 13:33:54,499 - eval_monitor: acc
2024-05-04 13:33:54,499 - train_batch_size: 32
2024-05-04 13:33:54,499 - eval_batch_size: 16
2024-05-04 13:33:54,499 - num_train_epochs: 100
2024-05-04 13:33:54,499 - lr: [2e-05]
2024-05-04 13:33:54,499 - weight_decay: [0.1]
2024-05-04 13:33:54,499 - wait_patience: 5
2024-05-04 13:33:54,499 - warmup_proportion: [0.01]
2024-05-04 13:33:54,499 - hidden_dims: [768]
2024-05-04 13:33:54,500 - num_attention_heads: [4]
2024-05-04 13:33:54,500 - attention_probs_dropout_prob: [0.3]
2024-05-04 13:33:54,500 - hidden_dropout_prob: [0.1]
2024-05-04 13:33:54,500 - intermediate_size: [768]
2024-05-04 13:33:54,500 - num_hidden_layers: [5]
2024-05-04 13:33:54,500 - max_position_embeddings: [768]
2024-05-04 13:33:54,500 - position_embedding_type: absolute
2024-05-04 13:33:54,500 - batch_first: True
2024-05-04 13:33:54,500 - aligned_method: ['ctc']
2024-05-04 13:33:54,500 - sampler: beta
2024-05-04 13:33:54,500 - multiple_ood: [1]
2024-05-04 13:33:54,500 - select_number_min: [2]
2024-05-04 13:33:54,500 - select_number_max: [3]
2024-05-04 13:33:54,500 - alpha: [3]
2024-05-04 13:33:54,500 - mlp_hidden_size: [256]
2024-05-04 13:33:54,500 - mlp_dropout: [0.3]
2024-05-04 13:33:54,500 - scale: [8]
2024-05-04 13:33:54,500 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_2
2024-05-04 13:33:54,500 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-04 13:33:54,500 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_2
2024-05-04 13:33:54,500 - device: cuda
2024-05-04 13:33:54,500 - ============================== End Params ==============================
2024-05-04 13:33:56,307 - Multimodal Intent Recognition begins...
2024-05-04 13:33:56,307 - Training begins...
2024-05-04 13:34:31,297 - ***** Epoch: 1: Eval results *****
2024-05-04 13:34:31,297 -   binary_train_loss = 0.6835
2024-05-04 13:34:31,297 -   binary_eval_score = 0.8551
2024-05-04 13:34:31,298 -   train_loss = 2.0249
2024-05-04 13:34:31,298 -   eval_score = 0.6787
2024-05-04 13:34:31,298 -   best_eval_score = 0.0
2024-05-04 13:35:06,372 - ***** Epoch: 2: Eval results *****
2024-05-04 13:35:06,372 -   binary_train_loss = 0.6772
2024-05-04 13:35:06,372 -   binary_eval_score = 0.6562
2024-05-04 13:35:06,372 -   train_loss = 0.8486
2024-05-04 13:35:06,372 -   eval_score = 0.7416
2024-05-04 13:35:06,372 -   best_eval_score = 0.6787
2024-05-04 13:35:41,535 - ***** Epoch: 3: Eval results *****
2024-05-04 13:35:41,535 -   binary_train_loss = 0.6428
2024-05-04 13:35:41,535 -   binary_eval_score = 0.7831
2024-05-04 13:35:41,535 -   train_loss = 0.3883
2024-05-04 13:35:41,535 -   eval_score = 0.6989
2024-05-04 13:35:41,535 -   best_eval_score = 0.7416
2024-05-04 13:35:41,535 - EarlyStopping counter: 1 out of 5
2024-05-04 13:36:16,309 - ***** Epoch: 4: Eval results *****
2024-05-04 13:36:16,310 -   binary_train_loss = 0.497
2024-05-04 13:36:16,310 -   binary_eval_score = 0.8831
2024-05-04 13:36:16,310 -   train_loss = 0.206
2024-05-04 13:36:16,310 -   eval_score = 0.7393
2024-05-04 13:36:16,310 -   best_eval_score = 0.7416
2024-05-04 13:36:16,310 - EarlyStopping counter: 2 out of 5
2024-05-04 13:36:51,107 - ***** Epoch: 5: Eval results *****
2024-05-04 13:36:51,107 -   binary_train_loss = 0.2707
2024-05-04 13:36:51,107 -   binary_eval_score = 0.8067
2024-05-04 13:36:51,107 -   train_loss = 0.153
2024-05-04 13:36:51,108 -   eval_score = 0.7213
2024-05-04 13:36:51,108 -   best_eval_score = 0.7416
2024-05-04 13:36:51,108 - EarlyStopping counter: 3 out of 5
2024-05-04 13:37:26,735 - ***** Epoch: 6: Eval results *****
2024-05-04 13:37:26,735 -   binary_train_loss = 0.2413
2024-05-04 13:37:26,735 -   binary_eval_score = 0.9315
2024-05-04 13:37:26,735 -   train_loss = 0.0971
2024-05-04 13:37:26,735 -   eval_score = 0.7438
2024-05-04 13:37:26,735 -   best_eval_score = 0.7416
2024-05-04 13:38:01,400 - ***** Epoch: 7: Eval results *****
2024-05-04 13:38:01,400 -   binary_train_loss = 0.1809
2024-05-04 13:38:01,400 -   binary_eval_score = 0.8607
2024-05-04 13:38:01,400 -   train_loss = 0.0593
2024-05-04 13:38:01,400 -   eval_score = 0.7348
2024-05-04 13:38:01,400 -   best_eval_score = 0.7438
2024-05-04 13:38:01,400 - EarlyStopping counter: 1 out of 5
2024-05-04 13:38:36,096 - ***** Epoch: 8: Eval results *****
2024-05-04 13:38:36,097 -   binary_train_loss = 0.1533
2024-05-04 13:38:36,097 -   binary_eval_score = 0.9011
2024-05-04 13:38:36,097 -   train_loss = 0.0543
2024-05-04 13:38:36,097 -   eval_score = 0.7213
2024-05-04 13:38:36,097 -   best_eval_score = 0.7438
2024-05-04 13:38:36,097 - EarlyStopping counter: 2 out of 5
2024-05-04 13:39:11,362 - ***** Epoch: 9: Eval results *****
2024-05-04 13:39:11,362 -   binary_train_loss = 0.1432
2024-05-04 13:39:11,362 -   binary_eval_score = 0.9438
2024-05-04 13:39:11,363 -   train_loss = 0.0408
2024-05-04 13:39:11,363 -   eval_score = 0.7258
2024-05-04 13:39:11,363 -   best_eval_score = 0.7438
2024-05-04 13:39:11,363 - EarlyStopping counter: 3 out of 5
2024-05-04 13:39:45,973 - ***** Epoch: 10: Eval results *****
2024-05-04 13:39:45,973 -   binary_train_loss = 0.1177
2024-05-04 13:39:45,973 -   binary_eval_score = 0.9685
2024-05-04 13:39:45,973 -   train_loss = 0.0363
2024-05-04 13:39:45,973 -   eval_score = 0.7191
2024-05-04 13:39:45,973 -   best_eval_score = 0.7438
2024-05-04 13:39:45,973 - EarlyStopping counter: 4 out of 5
2024-05-04 13:40:20,559 - ***** Epoch: 11: Eval results *****
2024-05-04 13:40:20,560 -   binary_train_loss = 0.1229
2024-05-04 13:40:20,560 -   binary_eval_score = 0.9404
2024-05-04 13:40:20,560 -   train_loss = 0.0298
2024-05-04 13:40:20,560 -   eval_score = 0.7236
2024-05-04 13:40:20,560 -   best_eval_score = 0.7438
2024-05-04 13:40:20,560 - EarlyStopping counter: 5 out of 5
2024-05-04 13:40:20,560 - EarlyStopping at epoch 11
2024-05-04 13:40:20,564 - Training is finished...
2024-05-04 13:40:20,565 - Testing begins...
2024-05-04 13:40:33,713 - ***** Out-of-domain Evaluation results *****
2024-05-04 13:40:33,714 -   aupr_in = 0.7838
2024-05-04 13:40:33,714 -   aupr_out = 0.81
2024-05-04 13:40:33,714 -   auroc = 0.8026
2024-05-04 13:40:33,714 -   der = 0.3585
2024-05-04 13:40:33,714 -   eer = 0.2644
2024-05-04 13:40:33,714 -   fpr95 = 0.6711
2024-05-04 13:40:33,714 - Testing is finished...
2024-05-04 13:40:33,714 - Multimodal intent recognition is finished...
2024-05-04 13:40:33,714 - Results are saved in results/results_msz_MIntRec.csv
2024-05-04 13:40:34,047 - ============================== Params ==============================
2024-05-04 13:40:34,047 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-04 13:40:34,047 - dataset: MIntRec
2024-05-04 13:40:34,047 - ood_dataset: MIntRec-OOD
2024-05-04 13:40:34,047 - data_mode: multi-class
2024-05-04 13:40:34,047 - multimodal_method: msz
2024-05-04 13:40:34,047 - method: msz
2024-05-04 13:40:34,048 - ood_detection_method: ma
2024-05-04 13:40:34,048 - text_backbone: bert-base-uncased
2024-05-04 13:40:34,048 - seed: 3
2024-05-04 13:40:34,048 - num_workers: 8
2024-05-04 13:40:34,048 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-04-13-23-07
2024-05-04 13:40:34,048 - gpu_id: 2
2024-05-04 13:40:34,048 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-04 13:40:34,048 - train: True
2024-05-04 13:40:34,048 - tune: True
2024-05-04 13:40:34,048 - ood: True
2024-05-04 13:40:34,048 - save_model: False
2024-05-04 13:40:34,048 - save_results: True
2024-05-04 13:40:34,048 - log_path: logs
2024-05-04 13:40:34,048 - cache_path: cache
2024-05-04 13:40:34,048 - video_data_path: video_data
2024-05-04 13:40:34,048 - audio_data_path: audio_data
2024-05-04 13:40:34,048 - video_feats_path: swin_feats.pkl
2024-05-04 13:40:34,048 - ood_video_feats_path: swin_feats.pkl
2024-05-04 13:40:34,048 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-04 13:40:34,048 - audio_feats_path: wavlm_feats.pkl
2024-05-04 13:40:34,048 - results_path: results
2024-05-04 13:40:34,048 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-04 13:40:34,048 - model_path: models
2024-05-04 13:40:34,048 - config_file_name: msz_MIntRec
2024-05-04 13:40:34,048 - results_file_name: results_msz_MIntRec.csv
2024-05-04 13:40:34,048 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-04 13:40:34,048 - text_seq_len: 30
2024-05-04 13:40:34,048 - video_seq_len: 230
2024-05-04 13:40:34,048 - audio_seq_len: 480
2024-05-04 13:40:34,048 - text_feat_dim: 768
2024-05-04 13:40:34,048 - video_feat_dim: 1024
2024-05-04 13:40:34,048 - audio_feat_dim: 768
2024-05-04 13:40:34,048 - ood_label_id: 20
2024-05-04 13:40:34,048 - num_labels: 20
2024-05-04 13:40:34,048 - num_train_examples: 1334
2024-05-04 13:40:34,048 - need_aligned: True
2024-05-04 13:40:34,048 - freeze_parameters: False
2024-05-04 13:40:34,048 - eval_monitor: acc
2024-05-04 13:40:34,048 - train_batch_size: 32
2024-05-04 13:40:34,049 - eval_batch_size: 16
2024-05-04 13:40:34,049 - num_train_epochs: 100
2024-05-04 13:40:34,049 - lr: [2e-05]
2024-05-04 13:40:34,049 - weight_decay: [0.1]
2024-05-04 13:40:34,049 - wait_patience: 5
2024-05-04 13:40:34,049 - warmup_proportion: [0.01]
2024-05-04 13:40:34,049 - hidden_dims: [768]
2024-05-04 13:40:34,049 - num_attention_heads: [4]
2024-05-04 13:40:34,049 - attention_probs_dropout_prob: [0.3]
2024-05-04 13:40:34,049 - hidden_dropout_prob: [0.1]
2024-05-04 13:40:34,049 - intermediate_size: [768]
2024-05-04 13:40:34,049 - num_hidden_layers: [5]
2024-05-04 13:40:34,049 - max_position_embeddings: [768]
2024-05-04 13:40:34,049 - position_embedding_type: absolute
2024-05-04 13:40:34,049 - batch_first: True
2024-05-04 13:40:34,049 - aligned_method: ['ctc']
2024-05-04 13:40:34,049 - sampler: beta
2024-05-04 13:40:34,049 - multiple_ood: [1]
2024-05-04 13:40:34,049 - select_number_min: [2]
2024-05-04 13:40:34,049 - select_number_max: [3]
2024-05-04 13:40:34,049 - alpha: [3]
2024-05-04 13:40:34,049 - mlp_hidden_size: [256]
2024-05-04 13:40:34,049 - mlp_dropout: [0.3]
2024-05-04 13:40:34,049 - scale: [8]
2024-05-04 13:40:34,049 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_3
2024-05-04 13:40:34,049 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-04 13:40:34,049 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_3
2024-05-04 13:40:34,049 - device: cuda
2024-05-04 13:40:34,049 - ============================== End Params ==============================
2024-05-04 13:40:35,781 - Multimodal Intent Recognition begins...
2024-05-04 13:40:35,781 - Training begins...
2024-05-04 13:41:10,703 - ***** Epoch: 1: Eval results *****
2024-05-04 13:41:10,703 -   binary_train_loss = 0.6859
2024-05-04 13:41:10,703 -   binary_eval_score = 0.8506
2024-05-04 13:41:10,703 -   train_loss = 2.0766
2024-05-04 13:41:10,703 -   eval_score = 0.6539
2024-05-04 13:41:10,703 -   best_eval_score = 0.0
2024-05-04 13:41:45,768 - ***** Epoch: 2: Eval results *****
2024-05-04 13:41:45,768 -   binary_train_loss = 0.679
2024-05-04 13:41:45,768 -   binary_eval_score = 0.6854
2024-05-04 13:41:45,768 -   train_loss = 0.8405
2024-05-04 13:41:45,769 -   eval_score = 0.6989
2024-05-04 13:41:45,769 -   best_eval_score = 0.6539
2024-05-04 13:42:20,700 - ***** Epoch: 3: Eval results *****
2024-05-04 13:42:20,700 -   binary_train_loss = 0.6574
2024-05-04 13:42:20,700 -   binary_eval_score = 0.7438
2024-05-04 13:42:20,700 -   train_loss = 0.3635
2024-05-04 13:42:20,700 -   eval_score = 0.7169
2024-05-04 13:42:20,700 -   best_eval_score = 0.6989
2024-05-04 13:42:55,720 - ***** Epoch: 4: Eval results *****
2024-05-04 13:42:55,720 -   binary_train_loss = 0.5599
2024-05-04 13:42:55,720 -   binary_eval_score = 0.8674
2024-05-04 13:42:55,720 -   train_loss = 0.1875
2024-05-04 13:42:55,720 -   eval_score = 0.7101
2024-05-04 13:42:55,720 -   best_eval_score = 0.7169
2024-05-04 13:42:55,720 - EarlyStopping counter: 1 out of 5
2024-05-04 13:43:31,566 - ***** Epoch: 5: Eval results *****
2024-05-04 13:43:31,566 -   binary_train_loss = 0.3439
2024-05-04 13:43:31,567 -   binary_eval_score = 0.8584
2024-05-04 13:43:31,567 -   train_loss = 0.1441
2024-05-04 13:43:31,567 -   eval_score = 0.7326
2024-05-04 13:43:31,567 -   best_eval_score = 0.7169
2024-05-04 13:44:06,571 - ***** Epoch: 6: Eval results *****
2024-05-04 13:44:06,571 -   binary_train_loss = 0.2846
2024-05-04 13:44:06,571 -   binary_eval_score = 0.8933
2024-05-04 13:44:06,571 -   train_loss = 0.0904
2024-05-04 13:44:06,571 -   eval_score = 0.7191
2024-05-04 13:44:06,572 -   best_eval_score = 0.7326
2024-05-04 13:44:06,572 - EarlyStopping counter: 1 out of 5
2024-05-04 13:44:41,730 - ***** Epoch: 7: Eval results *****
2024-05-04 13:44:41,730 -   binary_train_loss = 0.1993
2024-05-04 13:44:41,730 -   binary_eval_score = 0.8865
2024-05-04 13:44:41,730 -   train_loss = 0.0644
2024-05-04 13:44:41,730 -   eval_score = 0.7258
2024-05-04 13:44:41,730 -   best_eval_score = 0.7326
2024-05-04 13:44:41,730 - EarlyStopping counter: 2 out of 5
2024-05-04 13:45:16,828 - ***** Epoch: 8: Eval results *****
2024-05-04 13:45:16,828 -   binary_train_loss = 0.1699
2024-05-04 13:45:16,828 -   binary_eval_score = 0.882
2024-05-04 13:45:16,828 -   train_loss = 0.0489
2024-05-04 13:45:16,828 -   eval_score = 0.7348
2024-05-04 13:45:16,828 -   best_eval_score = 0.7326
2024-05-04 13:45:51,714 - ***** Epoch: 9: Eval results *****
2024-05-04 13:45:51,714 -   binary_train_loss = 0.1834
2024-05-04 13:45:51,714 -   binary_eval_score = 0.8843
2024-05-04 13:45:51,714 -   train_loss = 0.0558
2024-05-04 13:45:51,714 -   eval_score = 0.7056
2024-05-04 13:45:51,714 -   best_eval_score = 0.7348
2024-05-04 13:45:51,714 - EarlyStopping counter: 1 out of 5
2024-05-04 13:46:26,785 - ***** Epoch: 10: Eval results *****
2024-05-04 13:46:26,785 -   binary_train_loss = 0.1767
2024-05-04 13:46:26,785 -   binary_eval_score = 0.9303
2024-05-04 13:46:26,785 -   train_loss = 0.0401
2024-05-04 13:46:26,785 -   eval_score = 0.7191
2024-05-04 13:46:26,786 -   best_eval_score = 0.7348
2024-05-04 13:46:26,786 - EarlyStopping counter: 2 out of 5
2024-05-04 13:47:01,770 - ***** Epoch: 11: Eval results *****
2024-05-04 13:47:01,770 -   binary_train_loss = 0.1083
2024-05-04 13:47:01,771 -   binary_eval_score = 0.9663
2024-05-04 13:47:01,771 -   train_loss = 0.0354
2024-05-04 13:47:01,771 -   eval_score = 0.7281
2024-05-04 13:47:01,771 -   best_eval_score = 0.7348
2024-05-04 13:47:01,771 - EarlyStopping counter: 3 out of 5
2024-05-04 13:47:36,848 - ***** Epoch: 12: Eval results *****
2024-05-04 13:47:36,849 -   binary_train_loss = 0.1246
2024-05-04 13:47:36,849 -   binary_eval_score = 0.9449
2024-05-04 13:47:36,849 -   train_loss = 0.0306
2024-05-04 13:47:36,849 -   eval_score = 0.7326
2024-05-04 13:47:36,849 -   best_eval_score = 0.7348
2024-05-04 13:47:36,849 - EarlyStopping counter: 4 out of 5
2024-05-04 13:48:12,523 - ***** Epoch: 13: Eval results *****
2024-05-04 13:48:12,523 -   binary_train_loss = 0.1089
2024-05-04 13:48:12,523 -   binary_eval_score = 0.9607
2024-05-04 13:48:12,523 -   train_loss = 0.0319
2024-05-04 13:48:12,523 -   eval_score = 0.7438
2024-05-04 13:48:12,523 -   best_eval_score = 0.7348
2024-05-04 13:48:47,237 - ***** Epoch: 14: Eval results *****
2024-05-04 13:48:47,237 -   binary_train_loss = 0.0987
2024-05-04 13:48:47,237 -   binary_eval_score = 0.9584
2024-05-04 13:48:47,237 -   train_loss = 0.0255
2024-05-04 13:48:47,237 -   eval_score = 0.7281
2024-05-04 13:48:47,237 -   best_eval_score = 0.7438
2024-05-04 13:48:47,237 - EarlyStopping counter: 1 out of 5
2024-05-04 13:49:23,100 - ***** Epoch: 15: Eval results *****
2024-05-04 13:49:23,100 -   binary_train_loss = 0.0941
2024-05-04 13:49:23,100 -   binary_eval_score = 0.9652
2024-05-04 13:49:23,100 -   train_loss = 0.0288
2024-05-04 13:49:23,100 -   eval_score = 0.7326
2024-05-04 13:49:23,100 -   best_eval_score = 0.7438
2024-05-04 13:49:23,100 - EarlyStopping counter: 2 out of 5
2024-05-04 13:49:58,005 - ***** Epoch: 16: Eval results *****
2024-05-04 13:49:58,005 -   binary_train_loss = 0.1037
2024-05-04 13:49:58,005 -   binary_eval_score = 0.9764
2024-05-04 13:49:58,005 -   train_loss = 0.0228
2024-05-04 13:49:58,005 -   eval_score = 0.7303
2024-05-04 13:49:58,005 -   best_eval_score = 0.7438
2024-05-04 13:49:58,005 - EarlyStopping counter: 3 out of 5
2024-05-04 13:50:33,095 - ***** Epoch: 17: Eval results *****
2024-05-04 13:50:33,095 -   binary_train_loss = 0.0781
2024-05-04 13:50:33,095 -   binary_eval_score = 0.9652
2024-05-04 13:50:33,095 -   train_loss = 0.0307
2024-05-04 13:50:33,095 -   eval_score = 0.7416
2024-05-04 13:50:33,095 -   best_eval_score = 0.7438
2024-05-04 13:50:33,095 - EarlyStopping counter: 4 out of 5
2024-05-04 13:51:08,162 - ***** Epoch: 18: Eval results *****
2024-05-04 13:51:08,162 -   binary_train_loss = 0.0913
2024-05-04 13:51:08,162 -   binary_eval_score = 0.9753
2024-05-04 13:51:08,162 -   train_loss = 0.0205
2024-05-04 13:51:08,162 -   eval_score = 0.7596
2024-05-04 13:51:08,162 -   best_eval_score = 0.7438
2024-05-04 13:51:43,427 - ***** Epoch: 19: Eval results *****
2024-05-04 13:51:43,427 -   binary_train_loss = 0.1049
2024-05-04 13:51:43,427 -   binary_eval_score = 0.9708
2024-05-04 13:51:43,427 -   train_loss = 0.019
2024-05-04 13:51:43,427 -   eval_score = 0.7573
2024-05-04 13:51:43,427 -   best_eval_score = 0.7596
2024-05-04 13:51:43,427 - EarlyStopping counter: 1 out of 5
2024-05-04 13:52:18,383 - ***** Epoch: 20: Eval results *****
2024-05-04 13:52:18,383 -   binary_train_loss = 0.1149
2024-05-04 13:52:18,383 -   binary_eval_score = 0.9831
2024-05-04 13:52:18,384 -   train_loss = 0.0174
2024-05-04 13:52:18,384 -   eval_score = 0.7573
2024-05-04 13:52:18,384 -   best_eval_score = 0.7596
2024-05-04 13:52:18,384 - EarlyStopping counter: 2 out of 5
2024-05-04 13:52:53,854 - ***** Epoch: 21: Eval results *****
2024-05-04 13:52:53,854 -   binary_train_loss = 0.0832
2024-05-04 13:52:53,854 -   binary_eval_score = 0.9663
2024-05-04 13:52:53,854 -   train_loss = 0.015
2024-05-04 13:52:53,854 -   eval_score = 0.7393
2024-05-04 13:52:53,854 -   best_eval_score = 0.7596
2024-05-04 13:52:53,854 - EarlyStopping counter: 3 out of 5
2024-05-04 13:53:28,888 - ***** Epoch: 22: Eval results *****
2024-05-04 13:53:28,888 -   binary_train_loss = 0.0782
2024-05-04 13:53:28,888 -   binary_eval_score = 0.9854
2024-05-04 13:53:28,888 -   train_loss = 0.0299
2024-05-04 13:53:28,888 -   eval_score = 0.7461
2024-05-04 13:53:28,888 -   best_eval_score = 0.7596
2024-05-04 13:53:28,888 - EarlyStopping counter: 4 out of 5
2024-05-04 13:54:04,818 - ***** Epoch: 23: Eval results *****
2024-05-04 13:54:04,818 -   binary_train_loss = 0.1048
2024-05-04 13:54:04,818 -   binary_eval_score = 0.9742
2024-05-04 13:54:04,818 -   train_loss = 0.018
2024-05-04 13:54:04,818 -   eval_score = 0.7281
2024-05-04 13:54:04,818 -   best_eval_score = 0.7596
2024-05-04 13:54:04,818 - EarlyStopping counter: 5 out of 5
2024-05-04 13:54:04,818 - EarlyStopping at epoch 23
2024-05-04 13:54:04,822 - Training is finished...
2024-05-04 13:54:04,822 - Testing begins...
2024-05-04 13:54:18,157 - ***** Out-of-domain Evaluation results *****
2024-05-04 13:54:18,158 -   aupr_in = 0.7964
2024-05-04 13:54:18,158 -   aupr_out = 0.8074
2024-05-04 13:54:18,158 -   auroc = 0.8033
2024-05-04 13:54:18,158 -   der = 0.3585
2024-05-04 13:54:18,158 -   eer = 0.28
2024-05-04 13:54:18,158 -   fpr95 = 0.6711
2024-05-04 13:54:18,158 - Testing is finished...
2024-05-04 13:54:18,158 - Multimodal intent recognition is finished...
2024-05-04 13:54:18,158 - Results are saved in results/results_msz_MIntRec.csv
2024-05-04 13:54:18,481 - ============================== Params ==============================
2024-05-04 13:54:18,482 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-04 13:54:18,482 - dataset: MIntRec
2024-05-04 13:54:18,482 - ood_dataset: MIntRec-OOD
2024-05-04 13:54:18,482 - data_mode: multi-class
2024-05-04 13:54:18,482 - multimodal_method: msz
2024-05-04 13:54:18,482 - method: msz
2024-05-04 13:54:18,482 - ood_detection_method: ma
2024-05-04 13:54:18,482 - text_backbone: bert-base-uncased
2024-05-04 13:54:18,482 - seed: 4
2024-05-04 13:54:18,482 - num_workers: 8
2024-05-04 13:54:18,482 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-04-13-23-07
2024-05-04 13:54:18,482 - gpu_id: 2
2024-05-04 13:54:18,482 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-04 13:54:18,482 - train: True
2024-05-04 13:54:18,482 - tune: True
2024-05-04 13:54:18,482 - ood: True
2024-05-04 13:54:18,482 - save_model: False
2024-05-04 13:54:18,482 - save_results: True
2024-05-04 13:54:18,482 - log_path: logs
2024-05-04 13:54:18,482 - cache_path: cache
2024-05-04 13:54:18,482 - video_data_path: video_data
2024-05-04 13:54:18,482 - audio_data_path: audio_data
2024-05-04 13:54:18,482 - video_feats_path: swin_feats.pkl
2024-05-04 13:54:18,482 - ood_video_feats_path: swin_feats.pkl
2024-05-04 13:54:18,482 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-04 13:54:18,482 - audio_feats_path: wavlm_feats.pkl
2024-05-04 13:54:18,482 - results_path: results
2024-05-04 13:54:18,482 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-04 13:54:18,482 - model_path: models
2024-05-04 13:54:18,482 - config_file_name: msz_MIntRec
2024-05-04 13:54:18,482 - results_file_name: results_msz_MIntRec.csv
2024-05-04 13:54:18,482 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-04 13:54:18,482 - text_seq_len: 30
2024-05-04 13:54:18,482 - video_seq_len: 230
2024-05-04 13:54:18,482 - audio_seq_len: 480
2024-05-04 13:54:18,482 - text_feat_dim: 768
2024-05-04 13:54:18,482 - video_feat_dim: 1024
2024-05-04 13:54:18,482 - audio_feat_dim: 768
2024-05-04 13:54:18,482 - ood_label_id: 20
2024-05-04 13:54:18,483 - num_labels: 20
2024-05-04 13:54:18,483 - num_train_examples: 1334
2024-05-04 13:54:18,483 - need_aligned: True
2024-05-04 13:54:18,483 - freeze_parameters: False
2024-05-04 13:54:18,483 - eval_monitor: acc
2024-05-04 13:54:18,483 - train_batch_size: 32
2024-05-04 13:54:18,483 - eval_batch_size: 16
2024-05-04 13:54:18,483 - num_train_epochs: 100
2024-05-04 13:54:18,483 - lr: [2e-05]
2024-05-04 13:54:18,483 - weight_decay: [0.1]
2024-05-04 13:54:18,483 - wait_patience: 5
2024-05-04 13:54:18,483 - warmup_proportion: [0.01]
2024-05-04 13:54:18,483 - hidden_dims: [768]
2024-05-04 13:54:18,483 - num_attention_heads: [4]
2024-05-04 13:54:18,483 - attention_probs_dropout_prob: [0.3]
2024-05-04 13:54:18,483 - hidden_dropout_prob: [0.1]
2024-05-04 13:54:18,483 - intermediate_size: [768]
2024-05-04 13:54:18,483 - num_hidden_layers: [5]
2024-05-04 13:54:18,483 - max_position_embeddings: [768]
2024-05-04 13:54:18,483 - position_embedding_type: absolute
2024-05-04 13:54:18,483 - batch_first: True
2024-05-04 13:54:18,483 - aligned_method: ['ctc']
2024-05-04 13:54:18,483 - sampler: beta
2024-05-04 13:54:18,483 - multiple_ood: [1]
2024-05-04 13:54:18,483 - select_number_min: [2]
2024-05-04 13:54:18,483 - select_number_max: [3]
2024-05-04 13:54:18,483 - alpha: [3]
2024-05-04 13:54:18,483 - mlp_hidden_size: [256]
2024-05-04 13:54:18,483 - mlp_dropout: [0.3]
2024-05-04 13:54:18,483 - scale: [8]
2024-05-04 13:54:18,483 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_4
2024-05-04 13:54:18,483 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_4/models
2024-05-04 13:54:18,483 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_4
2024-05-04 13:54:18,483 - device: cuda
2024-05-04 13:54:18,483 - ============================== End Params ==============================
2024-05-04 13:54:20,132 - Multimodal Intent Recognition begins...
2024-05-04 13:54:20,132 - Training begins...
2024-05-04 13:54:55,070 - ***** Epoch: 1: Eval results *****
2024-05-04 13:54:55,070 -   binary_train_loss = 0.6815
2024-05-04 13:54:55,070 -   binary_eval_score = 0.9292
2024-05-04 13:54:55,070 -   train_loss = 2.0585
2024-05-04 13:54:55,070 -   eval_score = 0.6315
2024-05-04 13:54:55,070 -   best_eval_score = 0.0
2024-05-04 13:55:31,018 - ***** Epoch: 2: Eval results *****
2024-05-04 13:55:31,019 -   binary_train_loss = 0.67
2024-05-04 13:55:31,019 -   binary_eval_score = 0.7427
2024-05-04 13:55:31,019 -   train_loss = 0.8361
2024-05-04 13:55:31,019 -   eval_score = 0.6719
2024-05-04 13:55:31,019 -   best_eval_score = 0.6315
2024-05-04 13:56:06,175 - ***** Epoch: 3: Eval results *****
2024-05-04 13:56:06,175 -   binary_train_loss = 0.6372
2024-05-04 13:56:06,175 -   binary_eval_score = 0.7955
2024-05-04 13:56:06,175 -   train_loss = 0.4012
2024-05-04 13:56:06,175 -   eval_score = 0.7258
2024-05-04 13:56:06,175 -   best_eval_score = 0.6719
2024-05-04 13:56:41,180 - ***** Epoch: 4: Eval results *****
2024-05-04 13:56:41,180 -   binary_train_loss = 0.4905
2024-05-04 13:56:41,180 -   binary_eval_score = 0.8989
2024-05-04 13:56:41,180 -   train_loss = 0.2005
2024-05-04 13:56:41,180 -   eval_score = 0.7169
2024-05-04 13:56:41,180 -   best_eval_score = 0.7258
2024-05-04 13:56:41,180 - EarlyStopping counter: 1 out of 5
2024-05-04 13:57:16,179 - ***** Epoch: 5: Eval results *****
2024-05-04 13:57:16,179 -   binary_train_loss = 0.2712
2024-05-04 13:57:16,179 -   binary_eval_score = 0.8888
2024-05-04 13:57:16,179 -   train_loss = 0.1267
2024-05-04 13:57:16,179 -   eval_score = 0.7146
2024-05-04 13:57:16,179 -   best_eval_score = 0.7258
2024-05-04 13:57:16,179 - EarlyStopping counter: 2 out of 5
2024-05-04 13:57:51,224 - ***** Epoch: 6: Eval results *****
2024-05-04 13:57:51,225 -   binary_train_loss = 0.2128
2024-05-04 13:57:51,225 -   binary_eval_score = 0.8854
2024-05-04 13:57:51,225 -   train_loss = 0.0978
2024-05-04 13:57:51,225 -   eval_score = 0.7438
2024-05-04 13:57:51,225 -   best_eval_score = 0.7258
2024-05-04 13:58:26,212 - ***** Epoch: 7: Eval results *****
2024-05-04 13:58:26,212 -   binary_train_loss = 0.1632
2024-05-04 13:58:26,212 -   binary_eval_score = 0.918
2024-05-04 13:58:26,212 -   train_loss = 0.0799
2024-05-04 13:58:26,212 -   eval_score = 0.7393
2024-05-04 13:58:26,212 -   best_eval_score = 0.7438
2024-05-04 13:58:26,212 - EarlyStopping counter: 1 out of 5
2024-05-04 13:59:01,582 - ***** Epoch: 8: Eval results *****
2024-05-04 13:59:01,582 -   binary_train_loss = 0.1524
2024-05-04 13:59:01,582 -   binary_eval_score = 0.9404
2024-05-04 13:59:01,582 -   train_loss = 0.0463
2024-05-04 13:59:01,582 -   eval_score = 0.7326
2024-05-04 13:59:01,582 -   best_eval_score = 0.7438
2024-05-04 13:59:01,582 - EarlyStopping counter: 2 out of 5
2024-05-04 13:59:37,021 - ***** Epoch: 9: Eval results *****
2024-05-04 13:59:37,022 -   binary_train_loss = 0.1187
2024-05-04 13:59:37,022 -   binary_eval_score = 0.9663
2024-05-04 13:59:37,022 -   train_loss = 0.0425
2024-05-04 13:59:37,022 -   eval_score = 0.7371
2024-05-04 13:59:37,022 -   best_eval_score = 0.7438
2024-05-04 13:59:37,022 - EarlyStopping counter: 3 out of 5
2024-05-04 14:00:12,092 - ***** Epoch: 10: Eval results *****
2024-05-04 14:00:12,092 -   binary_train_loss = 0.1004
2024-05-04 14:00:12,092 -   binary_eval_score = 0.9652
2024-05-04 14:00:12,092 -   train_loss = 0.0371
2024-05-04 14:00:12,092 -   eval_score = 0.7281
2024-05-04 14:00:12,092 -   best_eval_score = 0.7438
2024-05-04 14:00:12,092 - EarlyStopping counter: 4 out of 5
2024-05-04 14:00:47,793 - ***** Epoch: 11: Eval results *****
2024-05-04 14:00:47,793 -   binary_train_loss = 0.0852
2024-05-04 14:00:47,793 -   binary_eval_score = 0.9674
2024-05-04 14:00:47,793 -   train_loss = 0.0323
2024-05-04 14:00:47,793 -   eval_score = 0.7169
2024-05-04 14:00:47,793 -   best_eval_score = 0.7438
2024-05-04 14:00:47,793 - EarlyStopping counter: 5 out of 5
2024-05-04 14:00:47,793 - EarlyStopping at epoch 11
2024-05-04 14:00:47,797 - Training is finished...
2024-05-04 14:00:47,797 - Testing begins...
2024-05-04 14:01:01,443 - ***** Out-of-domain Evaluation results *****
2024-05-04 14:01:01,443 -   aupr_in = 0.7881
2024-05-04 14:01:01,443 -   aupr_out = 0.7985
2024-05-04 14:01:01,443 -   auroc = 0.7973
2024-05-04 14:01:01,443 -   der = 0.365
2024-05-04 14:01:01,443 -   eer = 0.28
2024-05-04 14:01:01,444 -   fpr95 = 0.6956
2024-05-04 14:01:01,444 - Testing is finished...
2024-05-04 14:01:01,444 - Multimodal intent recognition is finished...
2024-05-04 14:01:01,444 - Results are saved in results/results_msz_MIntRec.csv
