2024-04-25 07:32:08,011 - Lists of intent labels are: ['a', 'ag', 'ans', 'ap', 'b', 'c', 'dag', 'g', 'o', 'q', 's']
2024-04-25 07:32:08,012 - ID Data preparation...
2024-04-25 07:33:17,257 - OOD Data preparation...
2024-04-25 07:33:54,472 - ============================== Params ==============================
2024-04-25 07:33:54,472 - logger_name: msz_ma_MELD-DA_multi-class_0
2024-04-25 07:33:54,472 - dataset: MELD-DA
2024-04-25 07:33:54,472 - ood_dataset: MELD-DA-OOD
2024-04-25 07:33:54,472 - data_mode: multi-class
2024-04-25 07:33:54,472 - multimodal_method: msz
2024-04-25 07:33:54,472 - method: msz
2024-04-25 07:33:54,472 - ood_detection_method: ma
2024-04-25 07:33:54,472 - text_backbone: bert-base-uncased
2024-04-25 07:33:54,472 - seed: 1
2024-04-25 07:33:54,472 - num_workers: 8
2024-04-25 07:33:54,472 - log_id: msz_ma_MELD-DA_multi-class_0_2024-04-25-07-32-08
2024-04-25 07:33:54,472 - gpu_id: 0
2024-04-25 07:33:54,472 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-25 07:33:54,472 - train: True
2024-04-25 07:33:54,472 - tune: True
2024-04-25 07:33:54,472 - ood: True
2024-04-25 07:33:54,472 - save_model: False
2024-04-25 07:33:54,472 - save_results: True
2024-04-25 07:33:54,472 - log_path: logs
2024-04-25 07:33:54,472 - cache_path: cache
2024-04-25 07:33:54,472 - video_data_path: video_data
2024-04-25 07:33:54,472 - audio_data_path: audio_data
2024-04-25 07:33:54,472 - video_feats_path: swin_feats.pkl
2024-04-25 07:33:54,472 - ood_video_feats_path: swin_feats.pkl
2024-04-25 07:33:54,472 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-25 07:33:54,472 - audio_feats_path: wavlm_feats.pkl
2024-04-25 07:33:54,472 - results_path: results
2024-04-25 07:33:54,472 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MELD-DA/msz
2024-04-25 07:33:54,472 - model_path: models
2024-04-25 07:33:54,472 - config_file_name: msz_MELD-DA
2024-04-25 07:33:54,473 - results_file_name: results_msz_MELD-DA.csv
2024-04-25 07:33:54,473 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-25 07:33:54,473 - text_seq_len: 70
2024-04-25 07:33:54,473 - video_seq_len: 250
2024-04-25 07:33:54,473 - audio_seq_len: 530
2024-04-25 07:33:54,473 - text_feat_dim: 768
2024-04-25 07:33:54,473 - video_feat_dim: 1024
2024-04-25 07:33:54,473 - audio_feat_dim: 768
2024-04-25 07:33:54,473 - ood_label_id: 11
2024-04-25 07:33:54,473 - num_labels: 11
2024-04-25 07:33:54,473 - num_train_examples: 6561
2024-04-25 07:33:54,473 - need_aligned: True
2024-04-25 07:33:54,473 - freeze_parameters: False
2024-04-25 07:33:54,473 - eval_monitor: acc
2024-04-25 07:33:54,473 - train_batch_size: 32
2024-04-25 07:33:54,473 - eval_batch_size: 16
2024-04-25 07:33:54,473 - num_train_epochs: 100
2024-04-25 07:33:54,473 - lr: [8e-06]
2024-04-25 07:33:54,473 - weight_decay: [0.1]
2024-04-25 07:33:54,473 - wait_patience: 5
2024-04-25 07:33:54,473 - warmup_proportion: [0.01]
2024-04-25 07:33:54,473 - hidden_dims: [768]
2024-04-25 07:33:54,473 - num_attention_heads: [6]
2024-04-25 07:33:54,473 - attention_probs_dropout_prob: [0.3]
2024-04-25 07:33:54,473 - hidden_dropout_prob: [0.1]
2024-04-25 07:33:54,473 - intermediate_size: [768]
2024-04-25 07:33:54,473 - num_hidden_layers: [5]
2024-04-25 07:33:54,473 - max_position_embeddings: [768]
2024-04-25 07:33:54,473 - position_embedding_type: absolute
2024-04-25 07:33:54,473 - batch_first: True
2024-04-25 07:33:54,473 - aligned_method: ['ctc']
2024-04-25 07:33:54,473 - sampler: mood
2024-04-25 07:33:54,473 - multiple_ood: [1]
2024-04-25 07:33:54,473 - select_number_min: [2]
2024-04-25 07:33:54,473 - select_number_max: [3]
2024-04-25 07:33:54,473 - mlp_hidden_size: [256]
2024-04-25 07:33:54,474 - mlp_dropout: [0.3]
2024-04-25 07:33:54,474 - alpha: [3]
2024-04-25 07:33:54,474 - scale: [8]
2024-04-25 07:33:54,474 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MELD-DA/msz/msz_MELD-DA_bert-base-uncased_multi-class_1
2024-04-25 07:33:54,474 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MELD-DA/msz/msz_MELD-DA_bert-base-uncased_multi-class_1/models
2024-04-25 07:33:54,474 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MELD-DA/msz/binary_msz_MELD-DA_bert-base-uncased_1
2024-04-25 07:33:54,474 - ============================== End Params ==============================
2024-04-25 07:33:58,036 - Multimodal Intent Recognition begins...
2024-04-25 07:33:58,036 - Training begins...
2024-04-25 07:38:20,927 - ***** Epoch: 1: Eval results *****
2024-04-25 07:38:20,928 -   binary_train_loss = 0.5086
2024-04-25 07:38:20,928 -   binary_eval_score = 0.9792
2024-04-25 07:38:20,928 -   train_loss = 1.4175
2024-04-25 07:38:20,928 -   eval_score = 0.588
2024-04-25 07:38:20,928 -   best_eval_score = 0.0
2024-04-25 07:43:44,220 - ***** Epoch: 2: Eval results *****
2024-04-25 07:43:44,220 -   binary_train_loss = 0.0835
2024-04-25 07:43:44,221 -   binary_eval_score = 0.9872
2024-04-25 07:43:44,221 -   train_loss = 0.9903
2024-04-25 07:43:44,221 -   eval_score = 0.5859
2024-04-25 07:43:44,221 -   best_eval_score = 0.588
2024-04-25 07:43:44,221 - EarlyStopping counter: 1 out of 5
2024-04-25 07:48:09,777 - ***** Epoch: 3: Eval results *****
2024-04-25 07:48:09,777 -   binary_train_loss = 0.0517
2024-04-25 07:48:09,777 -   binary_eval_score = 0.9941
2024-04-25 07:48:09,778 -   train_loss = 0.8407
2024-04-25 07:48:09,778 -   eval_score = 0.603
2024-04-25 07:48:09,778 -   best_eval_score = 0.588
2024-04-25 07:52:34,634 - ***** Epoch: 4: Eval results *****
2024-04-25 07:52:34,634 -   binary_train_loss = 0.0439
2024-04-25 07:52:34,634 -   binary_eval_score = 0.9941
2024-04-25 07:52:34,634 -   train_loss = 0.6852
2024-04-25 07:52:34,635 -   eval_score = 0.6318
2024-04-25 07:52:34,635 -   best_eval_score = 0.603
2024-04-25 07:57:05,391 - ***** Epoch: 5: Eval results *****
2024-04-25 07:57:05,391 -   binary_train_loss = 0.0436
2024-04-25 07:57:05,391 -   binary_eval_score = 0.9968
2024-04-25 07:57:05,391 -   train_loss = 0.5449
2024-04-25 07:57:05,391 -   eval_score = 0.5945
2024-04-25 07:57:05,391 -   best_eval_score = 0.6318
2024-04-25 07:57:05,391 - EarlyStopping counter: 1 out of 5
2024-04-25 08:01:37,402 - ***** Epoch: 6: Eval results *****
2024-04-25 08:01:37,402 -   binary_train_loss = 0.0336
2024-04-25 08:01:37,402 -   binary_eval_score = 0.9915
2024-04-25 08:01:37,402 -   train_loss = 0.3891
2024-04-25 08:01:37,402 -   eval_score = 0.6073
2024-04-25 08:01:37,402 -   best_eval_score = 0.6318
2024-04-25 08:01:37,402 - EarlyStopping counter: 2 out of 5
2024-04-25 08:06:06,000 - ***** Epoch: 7: Eval results *****
2024-04-25 08:06:06,000 -   binary_train_loss = 0.038
2024-04-25 08:06:06,000 -   binary_eval_score = 0.9936
2024-04-25 08:06:06,000 -   train_loss = 0.265
2024-04-25 08:06:06,000 -   eval_score = 0.5678
2024-04-25 08:06:06,000 -   best_eval_score = 0.6318
2024-04-25 08:06:06,000 - EarlyStopping counter: 3 out of 5
2024-04-25 08:10:58,877 - ***** Epoch: 8: Eval results *****
2024-04-25 08:10:58,878 -   binary_train_loss = 0.0333
2024-04-25 08:10:58,878 -   binary_eval_score = 0.9931
2024-04-25 08:10:58,878 -   train_loss = 0.1811
2024-04-25 08:10:58,878 -   eval_score = 0.5912
2024-04-25 08:10:58,878 -   best_eval_score = 0.6318
2024-04-25 08:10:58,878 - EarlyStopping counter: 4 out of 5
2024-04-25 08:15:28,946 - ***** Epoch: 9: Eval results *****
2024-04-25 08:15:28,946 -   binary_train_loss = 0.0334
2024-04-25 08:15:28,946 -   binary_eval_score = 0.9952
2024-04-25 08:15:28,946 -   train_loss = 0.146
2024-04-25 08:15:28,946 -   eval_score = 0.5891
2024-04-25 08:15:28,946 -   best_eval_score = 0.6318
2024-04-25 08:15:28,947 - EarlyStopping counter: 5 out of 5
2024-04-25 08:15:28,947 - EarlyStopping at epoch 9
2024-04-25 08:15:28,951 - Training is finished...
2024-04-25 08:15:28,951 - Testing begins...
2024-04-25 08:16:53,883 - ***** Out-of-domain Evaluation results *****
2024-04-25 08:16:53,883 -   aupr_in = 0.8582
2024-04-25 08:16:53,883 -   aupr_out = 0.5252
2024-04-25 08:16:53,883 -   auroc = 0.7246
2024-04-25 08:16:53,884 -   der = 0.5338
2024-04-25 08:16:53,884 -   eer = 0.3236
2024-04-25 08:16:53,884 -   fpr95 = 0.6927
2024-04-25 08:16:53,884 - Testing is finished...
2024-04-25 08:16:53,884 - Multimodal intent recognition is finished...
2024-04-25 08:16:53,884 - Results are saved in results/results_msz_MELD-DA.csv
2024-04-25 08:16:53,960 - ============================== Params ==============================
2024-04-25 08:16:53,960 - logger_name: msz_ma_MELD-DA_multi-class_0
2024-04-25 08:16:53,960 - dataset: MELD-DA
2024-04-25 08:16:53,960 - ood_dataset: MELD-DA-OOD
2024-04-25 08:16:53,960 - data_mode: multi-class
2024-04-25 08:16:53,960 - multimodal_method: msz
2024-04-25 08:16:53,960 - method: msz
2024-04-25 08:16:53,960 - ood_detection_method: ma
2024-04-25 08:16:53,960 - text_backbone: bert-base-uncased
2024-04-25 08:16:53,960 - seed: 0
2024-04-25 08:16:53,960 - num_workers: 8
2024-04-25 08:16:53,960 - log_id: msz_ma_MELD-DA_multi-class_0_2024-04-25-07-32-08
2024-04-25 08:16:53,961 - gpu_id: 0
2024-04-25 08:16:53,961 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-04-25 08:16:53,961 - train: True
2024-04-25 08:16:53,961 - tune: True
2024-04-25 08:16:53,961 - ood: True
2024-04-25 08:16:53,961 - save_model: False
2024-04-25 08:16:53,961 - save_results: True
2024-04-25 08:16:53,961 - log_path: logs
2024-04-25 08:16:53,961 - cache_path: cache
2024-04-25 08:16:53,961 - video_data_path: video_data
2024-04-25 08:16:53,961 - audio_data_path: audio_data
2024-04-25 08:16:53,961 - video_feats_path: swin_feats.pkl
2024-04-25 08:16:53,961 - ood_video_feats_path: swin_feats.pkl
2024-04-25 08:16:53,961 - ood_audio_feats_path: wavlm_feats.pkl
2024-04-25 08:16:53,961 - audio_feats_path: wavlm_feats.pkl
2024-04-25 08:16:53,961 - results_path: results
2024-04-25 08:16:53,961 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MELD-DA/msz
2024-04-25 08:16:53,961 - model_path: models
2024-04-25 08:16:53,961 - config_file_name: msz_MELD-DA
2024-04-25 08:16:53,961 - results_file_name: results_msz_MELD-DA.csv
2024-04-25 08:16:53,961 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-04-25 08:16:53,961 - text_seq_len: 70
2024-04-25 08:16:53,961 - video_seq_len: 250
2024-04-25 08:16:53,961 - audio_seq_len: 530
2024-04-25 08:16:53,961 - text_feat_dim: 768
2024-04-25 08:16:53,961 - video_feat_dim: 1024
2024-04-25 08:16:53,961 - audio_feat_dim: 768
2024-04-25 08:16:53,961 - ood_label_id: 11
2024-04-25 08:16:53,961 - num_labels: 11
2024-04-25 08:16:53,961 - num_train_examples: 6561
2024-04-25 08:16:53,961 - need_aligned: True
2024-04-25 08:16:53,961 - freeze_parameters: False
2024-04-25 08:16:53,961 - eval_monitor: acc
2024-04-25 08:16:53,961 - train_batch_size: 32
2024-04-25 08:16:53,961 - eval_batch_size: 16
2024-04-25 08:16:53,961 - num_train_epochs: 100
2024-04-25 08:16:53,961 - lr: [8e-06]
2024-04-25 08:16:53,961 - weight_decay: [0.1]
2024-04-25 08:16:53,961 - wait_patience: 5
2024-04-25 08:16:53,961 - warmup_proportion: [0.01]
2024-04-25 08:16:53,961 - hidden_dims: [768]
2024-04-25 08:16:53,961 - num_attention_heads: [6]
2024-04-25 08:16:53,961 - attention_probs_dropout_prob: [0.3]
2024-04-25 08:16:53,961 - hidden_dropout_prob: [0.1]
2024-04-25 08:16:53,961 - intermediate_size: [768]
2024-04-25 08:16:53,961 - num_hidden_layers: [5]
2024-04-25 08:16:53,961 - max_position_embeddings: [768]
2024-04-25 08:16:53,962 - position_embedding_type: absolute
2024-04-25 08:16:53,962 - batch_first: True
2024-04-25 08:16:53,962 - aligned_method: ['ctc']
2024-04-25 08:16:53,962 - sampler: mood
2024-04-25 08:16:53,962 - multiple_ood: [1]
2024-04-25 08:16:53,962 - select_number_min: [2]
2024-04-25 08:16:53,962 - select_number_max: [3]
2024-04-25 08:16:53,962 - mlp_hidden_size: [256]
2024-04-25 08:16:53,962 - mlp_dropout: [0.3]
2024-04-25 08:16:53,962 - alpha: [3]
2024-04-25 08:16:53,962 - scale: [8]
2024-04-25 08:16:53,962 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MELD-DA/msz/msz_MELD-DA_bert-base-uncased_multi-class_0
2024-04-25 08:16:53,962 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MELD-DA/msz/msz_MELD-DA_bert-base-uncased_multi-class_0/models
2024-04-25 08:16:53,962 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MELD-DA/msz/binary_msz_MELD-DA_bert-base-uncased_0
2024-04-25 08:16:53,962 - device: cuda
2024-04-25 08:16:53,962 - ============================== End Params ==============================
2024-04-25 08:16:56,314 - Multimodal Intent Recognition begins...
2024-04-25 08:16:56,314 - Training begins...
