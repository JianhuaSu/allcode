2024-05-08 02:19:10,761 - Lists of intent labels are: ['Complain', 'Praise', 'Apologise', 'Thank', 'Criticize', 'Agree', 'Taunt', 'Flaunt', 'Joke', 'Oppose', 'Comfort', 'Care', 'Inform', 'Advise', 'Arrange', 'Introduce', 'Leave', 'Prevent', 'Greet', 'Ask for help']
2024-05-08 02:19:10,761 - ID Data preparation...
2024-05-08 02:19:22,261 - OOD Data preparation...
2024-05-08 02:19:23,820 - ============================== Params ==============================
2024-05-08 02:19:23,820 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-08 02:19:23,820 - dataset: MIntRec
2024-05-08 02:19:23,820 - ood_dataset: MIntRec-OOD
2024-05-08 02:19:23,820 - data_mode: multi-class
2024-05-08 02:19:23,820 - multimodal_method: msz
2024-05-08 02:19:23,820 - method: msz
2024-05-08 02:19:23,820 - ood_detection_method: ma
2024-05-08 02:19:23,820 - text_backbone: bert-base-uncased
2024-05-08 02:19:23,820 - seed: 1
2024-05-08 02:19:23,820 - num_workers: 8
2024-05-08 02:19:23,820 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-08-02-19-10
2024-05-08 02:19:23,820 - gpu_id: 3
2024-05-08 02:19:23,820 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-08 02:19:23,820 - train: True
2024-05-08 02:19:23,820 - tune: True
2024-05-08 02:19:23,820 - ood: True
2024-05-08 02:19:23,820 - save_model: False
2024-05-08 02:19:23,820 - save_results: True
2024-05-08 02:19:23,820 - log_path: logs
2024-05-08 02:19:23,820 - cache_path: cache
2024-05-08 02:19:23,820 - video_data_path: video_data
2024-05-08 02:19:23,820 - audio_data_path: audio_data
2024-05-08 02:19:23,820 - video_feats_path: swin_feats.pkl
2024-05-08 02:19:23,820 - ood_video_feats_path: swin_feats.pkl
2024-05-08 02:19:23,820 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-08 02:19:23,820 - audio_feats_path: wavlm_feats.pkl
2024-05-08 02:19:23,820 - results_path: results
2024-05-08 02:19:23,820 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-08 02:19:23,820 - model_path: models
2024-05-08 02:19:23,820 - config_file_name: msz_MIntRec
2024-05-08 02:19:23,820 - results_file_name: results_msz_MIntRec.csv
2024-05-08 02:19:23,821 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-08 02:19:23,821 - text_seq_len: 30
2024-05-08 02:19:23,821 - video_seq_len: 230
2024-05-08 02:19:23,821 - audio_seq_len: 480
2024-05-08 02:19:23,821 - text_feat_dim: 768
2024-05-08 02:19:23,821 - video_feat_dim: 1024
2024-05-08 02:19:23,821 - audio_feat_dim: 768
2024-05-08 02:19:23,821 - ood_label_id: 20
2024-05-08 02:19:23,821 - num_labels: 20
2024-05-08 02:19:23,821 - num_train_examples: 1334
2024-05-08 02:19:23,821 - need_aligned: True
2024-05-08 02:19:23,821 - freeze_parameters: False
2024-05-08 02:19:23,821 - eval_monitor: acc
2024-05-08 02:19:23,821 - train_batch_size: 32
2024-05-08 02:19:23,821 - eval_batch_size: 16
2024-05-08 02:19:23,821 - num_train_epochs: 100
2024-05-08 02:19:23,821 - lr: [1e-05]
2024-05-08 02:19:23,821 - weight_decay: [0.1]
2024-05-08 02:19:23,821 - wait_patience: 5
2024-05-08 02:19:23,821 - warmup_proportion: [0.01]
2024-05-08 02:19:23,821 - hidden_dims: [768]
2024-05-08 02:19:23,821 - num_attention_heads: [4]
2024-05-08 02:19:23,821 - attention_probs_dropout_prob: [0.3]
2024-05-08 02:19:23,821 - hidden_dropout_prob: [0.2]
2024-05-08 02:19:23,821 - intermediate_size: [768]
2024-05-08 02:19:23,821 - num_hidden_layers: [6]
2024-05-08 02:19:23,821 - max_position_embeddings: [768]
2024-05-08 02:19:23,821 - position_embedding_type: absolute
2024-05-08 02:19:23,821 - batch_first: True
2024-05-08 02:19:23,821 - aligned_method: ['ctc']
2024-05-08 02:19:23,821 - sampler: beta
2024-05-08 02:19:23,821 - multiple_ood: [1]
2024-05-08 02:19:23,821 - select_number_min: [2]
2024-05-08 02:19:23,821 - select_number_max: [3]
2024-05-08 02:19:23,821 - alpha: [3]
2024-05-08 02:19:23,821 - mlp_hidden_size: [256]
2024-05-08 02:19:23,821 - mlp_dropout: [0.3]
2024-05-08 02:19:23,821 - scale: [16]
2024-05-08 02:19:23,821 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_1
2024-05-08 02:19:23,821 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-08 02:19:23,821 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_1
2024-05-08 02:19:23,821 - ============================== End Params ==============================
2024-05-08 02:19:27,140 - Multimodal Intent Recognition begins...
2024-05-08 02:19:27,140 - Training begins...
2024-05-08 02:20:07,134 - ***** Epoch: 1: Eval results *****
2024-05-08 02:20:07,134 -   binary_train_loss = 0.6879
2024-05-08 02:20:07,134 -   binary_eval_score = 0.7236
2024-05-08 02:20:07,134 -   train_loss = 2.2221
2024-05-08 02:20:07,134 -   eval_score = 0.6022
2024-05-08 02:20:07,134 -   best_eval_score = 0.0
2024-05-08 02:20:45,632 - ***** Epoch: 2: Eval results *****
2024-05-08 02:20:45,634 -   binary_train_loss = 0.6774
2024-05-08 02:20:45,634 -   binary_eval_score = 0.6989
2024-05-08 02:20:45,635 -   train_loss = 0.9209
2024-05-08 02:20:45,635 -   eval_score = 0.7056
2024-05-08 02:20:45,635 -   best_eval_score = 0.6022
2024-05-08 02:21:25,800 - ***** Epoch: 3: Eval results *****
2024-05-08 02:21:25,800 -   binary_train_loss = 0.6737
2024-05-08 02:21:25,800 -   binary_eval_score = 0.7348
2024-05-08 02:21:25,800 -   train_loss = 0.3813
2024-05-08 02:21:25,800 -   eval_score = 0.7169
2024-05-08 02:21:25,800 -   best_eval_score = 0.7056
2024-05-08 02:22:04,656 - ***** Epoch: 4: Eval results *****
2024-05-08 02:22:04,656 -   binary_train_loss = 0.6537
2024-05-08 02:22:04,656 -   binary_eval_score = 0.8506
2024-05-08 02:22:04,656 -   train_loss = 0.1704
2024-05-08 02:22:04,656 -   eval_score = 0.7303
2024-05-08 02:22:04,656 -   best_eval_score = 0.7169
2024-05-08 02:22:43,220 - ***** Epoch: 5: Eval results *****
2024-05-08 02:22:43,220 -   binary_train_loss = 0.6179
2024-05-08 02:22:43,221 -   binary_eval_score = 0.864
2024-05-08 02:22:43,221 -   train_loss = 0.0815
2024-05-08 02:22:43,221 -   eval_score = 0.7236
2024-05-08 02:22:43,221 -   best_eval_score = 0.7303
2024-05-08 02:22:43,221 - EarlyStopping counter: 1 out of 5
2024-05-08 02:23:23,193 - ***** Epoch: 6: Eval results *****
2024-05-08 02:23:23,193 -   binary_train_loss = 0.5211
2024-05-08 02:23:23,193 -   binary_eval_score = 0.8775
2024-05-08 02:23:23,193 -   train_loss = 0.0531
2024-05-08 02:23:23,193 -   eval_score = 0.7146
2024-05-08 02:23:23,193 -   best_eval_score = 0.7303
2024-05-08 02:23:23,193 - EarlyStopping counter: 2 out of 5
2024-05-08 02:24:00,483 - ***** Epoch: 7: Eval results *****
2024-05-08 02:24:00,483 -   binary_train_loss = 0.3435
2024-05-08 02:24:00,483 -   binary_eval_score = 0.9247
2024-05-08 02:24:00,483 -   train_loss = 0.0734
2024-05-08 02:24:00,483 -   eval_score = 0.7213
2024-05-08 02:24:00,483 -   best_eval_score = 0.7303
2024-05-08 02:24:00,483 - EarlyStopping counter: 3 out of 5
2024-05-08 02:24:41,137 - ***** Epoch: 8: Eval results *****
2024-05-08 02:24:41,137 -   binary_train_loss = 0.2222
2024-05-08 02:24:41,137 -   binary_eval_score = 0.8876
2024-05-08 02:24:41,137 -   train_loss = 0.0643
2024-05-08 02:24:41,137 -   eval_score = 0.7124
2024-05-08 02:24:41,137 -   best_eval_score = 0.7303
2024-05-08 02:24:41,138 - EarlyStopping counter: 4 out of 5
2024-05-08 02:25:19,483 - ***** Epoch: 9: Eval results *****
2024-05-08 02:25:19,484 -   binary_train_loss = 0.1533
2024-05-08 02:25:19,484 -   binary_eval_score = 0.8989
2024-05-08 02:25:19,484 -   train_loss = 0.0414
2024-05-08 02:25:19,484 -   eval_score = 0.7281
2024-05-08 02:25:19,484 -   best_eval_score = 0.7303
2024-05-08 02:25:19,484 - EarlyStopping counter: 5 out of 5
2024-05-08 02:25:19,484 - EarlyStopping at epoch 9
2024-05-08 02:25:19,488 - Training is finished...
2024-05-08 02:25:19,489 - Testing begins...
2024-05-08 02:25:33,594 - ***** Out-of-domain Evaluation results *****
2024-05-08 02:25:33,594 -   aupr_in = 0.7881
2024-05-08 02:25:33,594 -   aupr_out = 0.8129
2024-05-08 02:25:33,594 -   auroc = 0.81
2024-05-08 02:25:33,594 -   der = 0.3398
2024-05-08 02:25:33,594 -   eer = 0.2644
2024-05-08 02:25:33,595 -   fpr95 = 0.6333
2024-05-08 02:25:33,595 - Testing is finished...
2024-05-08 02:25:33,595 - Multimodal intent recognition is finished...
2024-05-08 02:25:33,595 - Results are saved in results/results_msz_MIntRec.csv
2024-05-08 02:25:33,708 - ============================== Params ==============================
2024-05-08 02:25:33,708 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-08 02:25:33,708 - dataset: MIntRec
2024-05-08 02:25:33,708 - ood_dataset: MIntRec-OOD
2024-05-08 02:25:33,708 - data_mode: multi-class
2024-05-08 02:25:33,708 - multimodal_method: msz
2024-05-08 02:25:33,708 - method: msz
2024-05-08 02:25:33,709 - ood_detection_method: ma
2024-05-08 02:25:33,709 - text_backbone: bert-base-uncased
2024-05-08 02:25:33,709 - seed: 2
2024-05-08 02:25:33,709 - num_workers: 8
2024-05-08 02:25:33,709 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-08-02-19-10
2024-05-08 02:25:33,709 - gpu_id: 3
2024-05-08 02:25:33,709 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-08 02:25:33,709 - train: True
2024-05-08 02:25:33,709 - tune: True
2024-05-08 02:25:33,709 - ood: True
2024-05-08 02:25:33,709 - save_model: False
2024-05-08 02:25:33,709 - save_results: True
2024-05-08 02:25:33,709 - log_path: logs
2024-05-08 02:25:33,709 - cache_path: cache
2024-05-08 02:25:33,709 - video_data_path: video_data
2024-05-08 02:25:33,709 - audio_data_path: audio_data
2024-05-08 02:25:33,709 - video_feats_path: swin_feats.pkl
2024-05-08 02:25:33,709 - ood_video_feats_path: swin_feats.pkl
2024-05-08 02:25:33,709 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-08 02:25:33,709 - audio_feats_path: wavlm_feats.pkl
2024-05-08 02:25:33,709 - results_path: results
2024-05-08 02:25:33,709 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-08 02:25:33,709 - model_path: models
2024-05-08 02:25:33,709 - config_file_name: msz_MIntRec
2024-05-08 02:25:33,709 - results_file_name: results_msz_MIntRec.csv
2024-05-08 02:25:33,709 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-08 02:25:33,709 - text_seq_len: 30
2024-05-08 02:25:33,709 - video_seq_len: 230
2024-05-08 02:25:33,709 - audio_seq_len: 480
2024-05-08 02:25:33,709 - text_feat_dim: 768
2024-05-08 02:25:33,709 - video_feat_dim: 1024
2024-05-08 02:25:33,709 - audio_feat_dim: 768
2024-05-08 02:25:33,709 - ood_label_id: 20
2024-05-08 02:25:33,709 - num_labels: 20
2024-05-08 02:25:33,709 - num_train_examples: 1334
2024-05-08 02:25:33,709 - need_aligned: True
2024-05-08 02:25:33,709 - freeze_parameters: False
2024-05-08 02:25:33,709 - eval_monitor: acc
2024-05-08 02:25:33,709 - train_batch_size: 32
2024-05-08 02:25:33,709 - eval_batch_size: 16
2024-05-08 02:25:33,709 - num_train_epochs: 100
2024-05-08 02:25:33,709 - lr: [1e-05]
2024-05-08 02:25:33,709 - weight_decay: [0.1]
2024-05-08 02:25:33,709 - wait_patience: 5
2024-05-08 02:25:33,709 - warmup_proportion: [0.01]
2024-05-08 02:25:33,709 - hidden_dims: [768]
2024-05-08 02:25:33,710 - num_attention_heads: [4]
2024-05-08 02:25:33,710 - attention_probs_dropout_prob: [0.3]
2024-05-08 02:25:33,710 - hidden_dropout_prob: [0.2]
2024-05-08 02:25:33,710 - intermediate_size: [768]
2024-05-08 02:25:33,710 - num_hidden_layers: [6]
2024-05-08 02:25:33,710 - max_position_embeddings: [768]
2024-05-08 02:25:33,710 - position_embedding_type: absolute
2024-05-08 02:25:33,710 - batch_first: True
2024-05-08 02:25:33,710 - aligned_method: ['ctc']
2024-05-08 02:25:33,710 - sampler: beta
2024-05-08 02:25:33,710 - multiple_ood: [1]
2024-05-08 02:25:33,710 - select_number_min: [2]
2024-05-08 02:25:33,710 - select_number_max: [3]
2024-05-08 02:25:33,710 - alpha: [3]
2024-05-08 02:25:33,710 - mlp_hidden_size: [256]
2024-05-08 02:25:33,710 - mlp_dropout: [0.3]
2024-05-08 02:25:33,710 - scale: [16]
2024-05-08 02:25:33,710 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_2
2024-05-08 02:25:33,710 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-08 02:25:33,710 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_2
2024-05-08 02:25:33,710 - device: cuda
2024-05-08 02:25:33,710 - ============================== End Params ==============================
2024-05-08 02:25:35,547 - Multimodal Intent Recognition begins...
2024-05-08 02:25:35,547 - Training begins...
2024-05-08 02:26:14,350 - ***** Epoch: 1: Eval results *****
2024-05-08 02:26:14,350 -   binary_train_loss = 0.6883
2024-05-08 02:26:14,350 -   binary_eval_score = 0.618
2024-05-08 02:26:14,350 -   train_loss = 2.168
2024-05-08 02:26:14,350 -   eval_score = 0.6382
2024-05-08 02:26:14,350 -   best_eval_score = 0.0
2024-05-08 02:26:52,389 - ***** Epoch: 2: Eval results *****
2024-05-08 02:26:52,389 -   binary_train_loss = 0.6842
2024-05-08 02:26:52,390 -   binary_eval_score = 0.6562
2024-05-08 02:26:52,390 -   train_loss = 0.8279
2024-05-08 02:26:52,390 -   eval_score = 0.7011
2024-05-08 02:26:52,390 -   best_eval_score = 0.6382
2024-05-08 02:27:30,589 - ***** Epoch: 3: Eval results *****
2024-05-08 02:27:30,589 -   binary_train_loss = 0.6768
2024-05-08 02:27:30,589 -   binary_eval_score = 0.5921
2024-05-08 02:27:30,589 -   train_loss = 0.414
2024-05-08 02:27:30,589 -   eval_score = 0.6944
2024-05-08 02:27:30,589 -   best_eval_score = 0.7011
2024-05-08 02:27:30,589 - EarlyStopping counter: 1 out of 5
2024-05-08 02:28:09,113 - ***** Epoch: 4: Eval results *****
2024-05-08 02:28:09,113 -   binary_train_loss = 0.6683
2024-05-08 02:28:09,113 -   binary_eval_score = 0.618
2024-05-08 02:28:09,113 -   train_loss = 0.1669
2024-05-08 02:28:09,113 -   eval_score = 0.7034
2024-05-08 02:28:09,113 -   best_eval_score = 0.7011
2024-05-08 02:28:48,932 - ***** Epoch: 5: Eval results *****
2024-05-08 02:28:48,932 -   binary_train_loss = 0.6469
2024-05-08 02:28:48,932 -   binary_eval_score = 0.7416
2024-05-08 02:28:48,932 -   train_loss = 0.0782
2024-05-08 02:28:48,932 -   eval_score = 0.7191
2024-05-08 02:28:48,932 -   best_eval_score = 0.7034
2024-05-08 02:29:27,079 - ***** Epoch: 6: Eval results *****
2024-05-08 02:29:27,080 -   binary_train_loss = 0.602
2024-05-08 02:29:27,080 -   binary_eval_score = 0.8247
2024-05-08 02:29:27,080 -   train_loss = 0.0352
2024-05-08 02:29:27,080 -   eval_score = 0.7146
2024-05-08 02:29:27,080 -   best_eval_score = 0.7191
2024-05-08 02:29:27,080 - EarlyStopping counter: 1 out of 5
2024-05-08 02:30:05,298 - ***** Epoch: 7: Eval results *****
2024-05-08 02:30:05,298 -   binary_train_loss = 0.4783
2024-05-08 02:30:05,298 -   binary_eval_score = 0.8764
2024-05-08 02:30:05,299 -   train_loss = 0.035
2024-05-08 02:30:05,299 -   eval_score = 0.7236
2024-05-08 02:30:05,299 -   best_eval_score = 0.7191
2024-05-08 02:30:43,827 - ***** Epoch: 8: Eval results *****
2024-05-08 02:30:43,827 -   binary_train_loss = 0.3016
2024-05-08 02:30:43,827 -   binary_eval_score = 0.9258
2024-05-08 02:30:43,827 -   train_loss = 0.0614
2024-05-08 02:30:43,827 -   eval_score = 0.7191
2024-05-08 02:30:43,827 -   best_eval_score = 0.7236
2024-05-08 02:30:43,827 - EarlyStopping counter: 1 out of 5
2024-05-08 02:31:23,557 - ***** Epoch: 9: Eval results *****
2024-05-08 02:31:23,557 -   binary_train_loss = 0.1997
2024-05-08 02:31:23,557 -   binary_eval_score = 0.8989
2024-05-08 02:31:23,557 -   train_loss = 0.0552
2024-05-08 02:31:23,557 -   eval_score = 0.7191
2024-05-08 02:31:23,557 -   best_eval_score = 0.7236
2024-05-08 02:31:23,557 - EarlyStopping counter: 2 out of 5
2024-05-08 02:32:02,201 - ***** Epoch: 10: Eval results *****
2024-05-08 02:32:02,201 -   binary_train_loss = 0.1604
2024-05-08 02:32:02,201 -   binary_eval_score = 0.936
2024-05-08 02:32:02,201 -   train_loss = 0.0417
2024-05-08 02:32:02,201 -   eval_score = 0.6966
2024-05-08 02:32:02,201 -   best_eval_score = 0.7236
2024-05-08 02:32:02,201 - EarlyStopping counter: 3 out of 5
2024-05-08 02:32:40,915 - ***** Epoch: 11: Eval results *****
2024-05-08 02:32:40,915 -   binary_train_loss = 0.1868
2024-05-08 02:32:40,915 -   binary_eval_score = 0.9416
2024-05-08 02:32:40,915 -   train_loss = 0.0497
2024-05-08 02:32:40,915 -   eval_score = 0.7169
2024-05-08 02:32:40,915 -   best_eval_score = 0.7236
2024-05-08 02:32:40,916 - EarlyStopping counter: 4 out of 5
2024-05-08 02:33:18,961 - ***** Epoch: 12: Eval results *****
2024-05-08 02:33:18,961 -   binary_train_loss = 0.1136
2024-05-08 02:33:18,962 -   binary_eval_score = 0.9348
2024-05-08 02:33:18,962 -   train_loss = 0.0233
2024-05-08 02:33:18,962 -   eval_score = 0.7213
2024-05-08 02:33:18,962 -   best_eval_score = 0.7236
2024-05-08 02:33:18,962 - EarlyStopping counter: 5 out of 5
2024-05-08 02:33:18,962 - EarlyStopping at epoch 12
2024-05-08 02:33:18,969 - Training is finished...
2024-05-08 02:33:18,969 - Testing begins...
2024-05-08 02:33:32,882 - ***** Out-of-domain Evaluation results *****
2024-05-08 02:33:32,882 -   aupr_in = 0.7732
2024-05-08 02:33:32,883 -   aupr_out = 0.8029
2024-05-08 02:33:32,883 -   auroc = 0.7961
2024-05-08 02:33:32,883 -   der = 0.3551
2024-05-08 02:33:32,883 -   eer = 0.2778
2024-05-08 02:33:32,883 -   fpr95 = 0.6689
2024-05-08 02:33:32,883 - Testing is finished...
2024-05-08 02:33:32,883 - Multimodal intent recognition is finished...
2024-05-08 02:33:32,883 - Results are saved in results/results_msz_MIntRec.csv
2024-05-08 02:33:33,001 - ============================== Params ==============================
2024-05-08 02:33:33,001 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-08 02:33:33,001 - dataset: MIntRec
2024-05-08 02:33:33,001 - ood_dataset: MIntRec-OOD
2024-05-08 02:33:33,001 - data_mode: multi-class
2024-05-08 02:33:33,001 - multimodal_method: msz
2024-05-08 02:33:33,001 - method: msz
2024-05-08 02:33:33,001 - ood_detection_method: ma
2024-05-08 02:33:33,001 - text_backbone: bert-base-uncased
2024-05-08 02:33:33,001 - seed: 3
2024-05-08 02:33:33,001 - num_workers: 8
2024-05-08 02:33:33,001 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-08-02-19-10
2024-05-08 02:33:33,001 - gpu_id: 3
2024-05-08 02:33:33,001 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-08 02:33:33,001 - train: True
2024-05-08 02:33:33,001 - tune: True
2024-05-08 02:33:33,001 - ood: True
2024-05-08 02:33:33,001 - save_model: False
2024-05-08 02:33:33,001 - save_results: True
2024-05-08 02:33:33,001 - log_path: logs
2024-05-08 02:33:33,002 - cache_path: cache
2024-05-08 02:33:33,002 - video_data_path: video_data
2024-05-08 02:33:33,002 - audio_data_path: audio_data
2024-05-08 02:33:33,002 - video_feats_path: swin_feats.pkl
2024-05-08 02:33:33,002 - ood_video_feats_path: swin_feats.pkl
2024-05-08 02:33:33,002 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-08 02:33:33,002 - audio_feats_path: wavlm_feats.pkl
2024-05-08 02:33:33,002 - results_path: results
2024-05-08 02:33:33,002 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-08 02:33:33,002 - model_path: models
2024-05-08 02:33:33,002 - config_file_name: msz_MIntRec
2024-05-08 02:33:33,002 - results_file_name: results_msz_MIntRec.csv
2024-05-08 02:33:33,002 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-08 02:33:33,002 - text_seq_len: 30
2024-05-08 02:33:33,002 - video_seq_len: 230
2024-05-08 02:33:33,002 - audio_seq_len: 480
2024-05-08 02:33:33,002 - text_feat_dim: 768
2024-05-08 02:33:33,002 - video_feat_dim: 1024
2024-05-08 02:33:33,002 - audio_feat_dim: 768
2024-05-08 02:33:33,002 - ood_label_id: 20
2024-05-08 02:33:33,002 - num_labels: 20
2024-05-08 02:33:33,002 - num_train_examples: 1334
2024-05-08 02:33:33,002 - need_aligned: True
2024-05-08 02:33:33,002 - freeze_parameters: False
2024-05-08 02:33:33,002 - eval_monitor: acc
2024-05-08 02:33:33,002 - train_batch_size: 32
2024-05-08 02:33:33,002 - eval_batch_size: 16
2024-05-08 02:33:33,002 - num_train_epochs: 100
2024-05-08 02:33:33,002 - lr: [1e-05]
2024-05-08 02:33:33,002 - weight_decay: [0.1]
2024-05-08 02:33:33,002 - wait_patience: 5
2024-05-08 02:33:33,002 - warmup_proportion: [0.01]
2024-05-08 02:33:33,002 - hidden_dims: [768]
2024-05-08 02:33:33,002 - num_attention_heads: [4]
2024-05-08 02:33:33,002 - attention_probs_dropout_prob: [0.3]
2024-05-08 02:33:33,002 - hidden_dropout_prob: [0.2]
2024-05-08 02:33:33,002 - intermediate_size: [768]
2024-05-08 02:33:33,002 - num_hidden_layers: [6]
2024-05-08 02:33:33,002 - max_position_embeddings: [768]
2024-05-08 02:33:33,002 - position_embedding_type: absolute
2024-05-08 02:33:33,002 - batch_first: True
2024-05-08 02:33:33,002 - aligned_method: ['ctc']
2024-05-08 02:33:33,002 - sampler: beta
2024-05-08 02:33:33,002 - multiple_ood: [1]
2024-05-08 02:33:33,002 - select_number_min: [2]
2024-05-08 02:33:33,002 - select_number_max: [3]
2024-05-08 02:33:33,003 - alpha: [3]
2024-05-08 02:33:33,003 - mlp_hidden_size: [256]
2024-05-08 02:33:33,003 - mlp_dropout: [0.3]
2024-05-08 02:33:33,003 - scale: [16]
2024-05-08 02:33:33,003 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_3
2024-05-08 02:33:33,003 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-08 02:33:33,003 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_3
2024-05-08 02:33:33,003 - device: cuda
2024-05-08 02:33:33,003 - ============================== End Params ==============================
2024-05-08 02:33:34,771 - Multimodal Intent Recognition begins...
2024-05-08 02:33:34,771 - Training begins...
2024-05-08 02:34:13,618 - ***** Epoch: 1: Eval results *****
2024-05-08 02:34:13,618 -   binary_train_loss = 0.6869
2024-05-08 02:34:13,618 -   binary_eval_score = 0.8663
2024-05-08 02:34:13,618 -   train_loss = 2.0786
2024-05-08 02:34:13,618 -   eval_score = 0.6427
2024-05-08 02:34:13,618 -   best_eval_score = 0.0
2024-05-08 02:34:53,030 - ***** Epoch: 2: Eval results *****
2024-05-08 02:34:53,030 -   binary_train_loss = 0.6813
2024-05-08 02:34:53,030 -   binary_eval_score = 0.6809
2024-05-08 02:34:53,030 -   train_loss = 0.8458
2024-05-08 02:34:53,030 -   eval_score = 0.6966
2024-05-08 02:34:53,030 -   best_eval_score = 0.6427
2024-05-08 02:35:31,985 - ***** Epoch: 3: Eval results *****
2024-05-08 02:35:31,985 -   binary_train_loss = 0.6725
2024-05-08 02:35:31,985 -   binary_eval_score = 0.6876
2024-05-08 02:35:31,985 -   train_loss = 0.3931
2024-05-08 02:35:31,985 -   eval_score = 0.7056
2024-05-08 02:35:31,985 -   best_eval_score = 0.6966
2024-05-08 02:36:11,277 - ***** Epoch: 4: Eval results *****
2024-05-08 02:36:11,278 -   binary_train_loss = 0.6574
2024-05-08 02:36:11,278 -   binary_eval_score = 0.764
2024-05-08 02:36:11,278 -   train_loss = 0.1714
2024-05-08 02:36:11,278 -   eval_score = 0.7056
2024-05-08 02:36:11,278 -   best_eval_score = 0.7056
2024-05-08 02:36:11,278 - EarlyStopping counter: 1 out of 5
2024-05-08 02:36:49,285 - ***** Epoch: 5: Eval results *****
2024-05-08 02:36:49,285 -   binary_train_loss = 0.626
2024-05-08 02:36:49,285 -   binary_eval_score = 0.8551
2024-05-08 02:36:49,286 -   train_loss = 0.0719
2024-05-08 02:36:49,286 -   eval_score = 0.7213
2024-05-08 02:36:49,286 -   best_eval_score = 0.7056
2024-05-08 02:37:28,175 - ***** Epoch: 6: Eval results *****
2024-05-08 02:37:28,175 -   binary_train_loss = 0.546
2024-05-08 02:37:28,175 -   binary_eval_score = 0.8933
2024-05-08 02:37:28,175 -   train_loss = 0.0502
2024-05-08 02:37:28,175 -   eval_score = 0.7326
2024-05-08 02:37:28,175 -   best_eval_score = 0.7213
2024-05-08 02:38:06,513 - ***** Epoch: 7: Eval results *****
2024-05-08 02:38:06,513 -   binary_train_loss = 0.3734
2024-05-08 02:38:06,513 -   binary_eval_score = 0.8876
2024-05-08 02:38:06,513 -   train_loss = 0.0581
2024-05-08 02:38:06,513 -   eval_score = 0.7236
2024-05-08 02:38:06,513 -   best_eval_score = 0.7326
2024-05-08 02:38:06,513 - EarlyStopping counter: 1 out of 5
2024-05-08 02:38:44,737 - ***** Epoch: 8: Eval results *****
2024-05-08 02:38:44,737 -   binary_train_loss = 0.2054
2024-05-08 02:38:44,738 -   binary_eval_score = 0.9483
2024-05-08 02:38:44,738 -   train_loss = 0.0794
2024-05-08 02:38:44,738 -   eval_score = 0.7079
2024-05-08 02:38:44,738 -   best_eval_score = 0.7326
2024-05-08 02:38:44,738 - EarlyStopping counter: 2 out of 5
2024-05-08 02:39:23,272 - ***** Epoch: 9: Eval results *****
2024-05-08 02:39:23,273 -   binary_train_loss = 0.1731
2024-05-08 02:39:23,273 -   binary_eval_score = 0.8461
2024-05-08 02:39:23,273 -   train_loss = 0.0538
2024-05-08 02:39:23,273 -   eval_score = 0.7191
2024-05-08 02:39:23,273 -   best_eval_score = 0.7326
2024-05-08 02:39:23,273 - EarlyStopping counter: 3 out of 5
2024-05-08 02:40:01,676 - ***** Epoch: 10: Eval results *****
2024-05-08 02:40:01,676 -   binary_train_loss = 0.1385
2024-05-08 02:40:01,676 -   binary_eval_score = 0.8921
2024-05-08 02:40:01,676 -   train_loss = 0.0337
2024-05-08 02:40:01,676 -   eval_score = 0.7303
2024-05-08 02:40:01,676 -   best_eval_score = 0.7326
2024-05-08 02:40:01,676 - EarlyStopping counter: 4 out of 5
2024-05-08 02:40:40,783 - ***** Epoch: 11: Eval results *****
2024-05-08 02:40:40,783 -   binary_train_loss = 0.1493
2024-05-08 02:40:40,783 -   binary_eval_score = 0.8933
2024-05-08 02:40:40,783 -   train_loss = 0.0284
2024-05-08 02:40:40,783 -   eval_score = 0.7191
2024-05-08 02:40:40,783 -   best_eval_score = 0.7326
2024-05-08 02:40:40,783 - EarlyStopping counter: 5 out of 5
2024-05-08 02:40:40,783 - EarlyStopping at epoch 11
2024-05-08 02:40:40,788 - Training is finished...
2024-05-08 02:40:40,789 - Testing begins...
2024-05-08 02:40:55,029 - ***** Out-of-domain Evaluation results *****
2024-05-08 02:40:55,029 -   aupr_in = 0.7718
2024-05-08 02:40:55,029 -   aupr_out = 0.7923
2024-05-08 02:40:55,029 -   auroc = 0.7966
2024-05-08 02:40:55,030 -   der = 0.3817
2024-05-08 02:40:55,030 -   eer = 0.2533
2024-05-08 02:40:55,030 -   fpr95 = 0.7178
2024-05-08 02:40:55,030 - Testing is finished...
2024-05-08 02:40:55,030 - Multimodal intent recognition is finished...
2024-05-08 02:40:55,030 - Results are saved in results/results_msz_MIntRec.csv
2024-05-08 02:40:55,136 - ============================== Params ==============================
2024-05-08 02:40:55,136 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-08 02:40:55,136 - dataset: MIntRec
2024-05-08 02:40:55,136 - ood_dataset: MIntRec-OOD
2024-05-08 02:40:55,136 - data_mode: multi-class
2024-05-08 02:40:55,136 - multimodal_method: msz
2024-05-08 02:40:55,136 - method: msz
2024-05-08 02:40:55,136 - ood_detection_method: ma
2024-05-08 02:40:55,136 - text_backbone: bert-base-uncased
2024-05-08 02:40:55,136 - seed: 4
2024-05-08 02:40:55,136 - num_workers: 8
2024-05-08 02:40:55,136 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-08-02-19-10
2024-05-08 02:40:55,136 - gpu_id: 3
2024-05-08 02:40:55,136 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-08 02:40:55,136 - train: True
2024-05-08 02:40:55,136 - tune: True
2024-05-08 02:40:55,136 - ood: True
2024-05-08 02:40:55,136 - save_model: False
2024-05-08 02:40:55,136 - save_results: True
2024-05-08 02:40:55,136 - log_path: logs
2024-05-08 02:40:55,136 - cache_path: cache
2024-05-08 02:40:55,137 - video_data_path: video_data
2024-05-08 02:40:55,137 - audio_data_path: audio_data
2024-05-08 02:40:55,137 - video_feats_path: swin_feats.pkl
2024-05-08 02:40:55,137 - ood_video_feats_path: swin_feats.pkl
2024-05-08 02:40:55,137 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-08 02:40:55,137 - audio_feats_path: wavlm_feats.pkl
2024-05-08 02:40:55,137 - results_path: results
2024-05-08 02:40:55,137 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz
2024-05-08 02:40:55,137 - model_path: models
2024-05-08 02:40:55,137 - config_file_name: msz_MIntRec
2024-05-08 02:40:55,137 - results_file_name: results_msz_MIntRec.csv
2024-05-08 02:40:55,137 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-08 02:40:55,137 - text_seq_len: 30
2024-05-08 02:40:55,137 - video_seq_len: 230
2024-05-08 02:40:55,137 - audio_seq_len: 480
2024-05-08 02:40:55,137 - text_feat_dim: 768
2024-05-08 02:40:55,137 - video_feat_dim: 1024
2024-05-08 02:40:55,137 - audio_feat_dim: 768
2024-05-08 02:40:55,137 - ood_label_id: 20
2024-05-08 02:40:55,137 - num_labels: 20
2024-05-08 02:40:55,137 - num_train_examples: 1334
2024-05-08 02:40:55,137 - need_aligned: True
2024-05-08 02:40:55,137 - freeze_parameters: False
2024-05-08 02:40:55,137 - eval_monitor: acc
2024-05-08 02:40:55,137 - train_batch_size: 32
2024-05-08 02:40:55,137 - eval_batch_size: 16
2024-05-08 02:40:55,137 - num_train_epochs: 100
2024-05-08 02:40:55,137 - lr: [1e-05]
2024-05-08 02:40:55,137 - weight_decay: [0.1]
2024-05-08 02:40:55,137 - wait_patience: 5
2024-05-08 02:40:55,137 - warmup_proportion: [0.01]
2024-05-08 02:40:55,137 - hidden_dims: [768]
2024-05-08 02:40:55,137 - num_attention_heads: [4]
2024-05-08 02:40:55,137 - attention_probs_dropout_prob: [0.3]
2024-05-08 02:40:55,137 - hidden_dropout_prob: [0.2]
2024-05-08 02:40:55,137 - intermediate_size: [768]
2024-05-08 02:40:55,137 - num_hidden_layers: [6]
2024-05-08 02:40:55,137 - max_position_embeddings: [768]
2024-05-08 02:40:55,137 - position_embedding_type: absolute
2024-05-08 02:40:55,138 - batch_first: True
2024-05-08 02:40:55,138 - aligned_method: ['ctc']
2024-05-08 02:40:55,138 - sampler: beta
2024-05-08 02:40:55,138 - multiple_ood: [1]
2024-05-08 02:40:55,138 - select_number_min: [2]
2024-05-08 02:40:55,138 - select_number_max: [3]
2024-05-08 02:40:55,138 - alpha: [3]
2024-05-08 02:40:55,138 - mlp_hidden_size: [256]
2024-05-08 02:40:55,138 - mlp_dropout: [0.3]
2024-05-08 02:40:55,138 - scale: [16]
2024-05-08 02:40:55,138 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_4
2024-05-08 02:40:55,138 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/msz_MIntRec_bert-base-uncased_multi-class_4/models
2024-05-08 02:40:55,138 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/msz/binary_msz_MIntRec_bert-base-uncased_4
2024-05-08 02:40:55,138 - device: cuda
2024-05-08 02:40:55,138 - ============================== End Params ==============================
2024-05-08 02:40:56,957 - Multimodal Intent Recognition begins...
2024-05-08 02:40:56,957 - Training begins...
