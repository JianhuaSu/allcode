2024-05-19 13:49:00,691 - Lists of intent labels are: ['Acknowledge', 'Advise', 'Agree', 'Apologise', 'Arrange', 'Ask for help', 'Asking for opinions', 'Care', 'Comfort', 'Complain', 'Confirm', 'Criticize', 'Doubt', 'Emphasize', 'Explain', 'Flaunt', 'Greet', 'Inform', 'Introduce', 'Invite', 'Joke', 'Leave', 'Oppose', 'Plan', 'Praise', 'Prevent', 'Refuse', 'Taunt', 'Thank', 'Warn']
2024-05-19 13:49:00,691 - ID Data preparation...
2024-05-19 13:49:20,728 - OOD Data preparation...
2024-05-19 13:49:24,233 - ============================== Params ==============================
2024-05-19 13:49:24,233 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-05-19 13:49:24,233 - dataset: MIntRec2
2024-05-19 13:49:24,233 - ood_dataset: MIntRec2-OOD
2024-05-19 13:49:24,233 - data_mode: multi-class
2024-05-19 13:49:24,233 - multimodal_method: msz
2024-05-19 13:49:24,233 - method: msz
2024-05-19 13:49:24,233 - ood_detection_method: ma
2024-05-19 13:49:24,233 - text_backbone: bert-base-uncased
2024-05-19 13:49:24,233 - seed: 0
2024-05-19 13:49:24,233 - num_workers: 8
2024-05-19 13:49:24,233 - log_id: msz_ma_MIntRec2_multi-class_0_2024-05-19-13-49-00
2024-05-19 13:49:24,233 - gpu_id: 0
2024-05-19 13:49:24,233 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-19 13:49:24,233 - train: True
2024-05-19 13:49:24,233 - tune: True
2024-05-19 13:49:24,233 - ood: True
2024-05-19 13:49:24,233 - save_model: True
2024-05-19 13:49:24,233 - save_results: True
2024-05-19 13:49:24,233 - log_path: logs
2024-05-19 13:49:24,233 - cache_path: cache
2024-05-19 13:49:24,233 - video_data_path: video_data
2024-05-19 13:49:24,233 - audio_data_path: audio_data
2024-05-19 13:49:24,233 - video_feats_path: swin_feats.pkl
2024-05-19 13:49:24,233 - ood_video_feats_path: swin_feats.pkl
2024-05-19 13:49:24,233 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-19 13:49:24,233 - audio_feats_path: wavlm_feats.pkl
2024-05-19 13:49:24,233 - results_path: results
2024-05-19 13:49:24,233 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz
2024-05-19 13:49:24,233 - model_path: models
2024-05-19 13:49:24,233 - config_file_name: msz_MIntRec2
2024-05-19 13:49:24,233 - results_file_name: results_msz_ablation_MIntRec2.csv
2024-05-19 13:49:24,233 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-19 13:49:24,233 - text_seq_len: 50
2024-05-19 13:49:24,233 - video_seq_len: 180
2024-05-19 13:49:24,233 - audio_seq_len: 400
2024-05-19 13:49:24,233 - text_feat_dim: 768
2024-05-19 13:49:24,233 - video_feat_dim: 256
2024-05-19 13:49:24,234 - audio_feat_dim: 768
2024-05-19 13:49:24,234 - ood_label_id: 30
2024-05-19 13:49:24,234 - num_labels: 30
2024-05-19 13:49:24,234 - num_train_examples: 6165
2024-05-19 13:49:24,234 - need_aligned: True
2024-05-19 13:49:24,234 - freeze_parameters: False
2024-05-19 13:49:24,234 - eval_monitor: acc
2024-05-19 13:49:24,234 - train_batch_size: 32
2024-05-19 13:49:24,234 - eval_batch_size: 16
2024-05-19 13:49:24,234 - num_train_epochs: 100
2024-05-19 13:49:24,234 - lr: [1e-05]
2024-05-19 13:49:24,234 - weight_decay: [0.1]
2024-05-19 13:49:24,234 - wait_patience: 3
2024-05-19 13:49:24,234 - warmup_proportion: [0.01]
2024-05-19 13:49:24,234 - hidden_dims: [768]
2024-05-19 13:49:24,234 - num_attention_heads: [4]
2024-05-19 13:49:24,234 - attention_probs_dropout_prob: [0.3]
2024-05-19 13:49:24,234 - hidden_dropout_prob: [0.3]
2024-05-19 13:49:24,234 - intermediate_size: [768]
2024-05-19 13:49:24,234 - num_hidden_layers: [6]
2024-05-19 13:49:24,234 - max_position_embeddings: [768]
2024-05-19 13:49:24,234 - position_embedding_type: absolute
2024-05-19 13:49:24,234 - batch_first: True
2024-05-19 13:49:24,234 - aligned_method: ['ctc']
2024-05-19 13:49:24,234 - sampler: ['dir']
2024-05-19 13:49:24,234 - multiple_ood: [1]
2024-05-19 13:49:24,234 - select_number_min: [2]
2024-05-19 13:49:24,234 - select_number_max: [3]
2024-05-19 13:49:24,234 - alpha: [2]
2024-05-19 13:49:24,234 - mlp_hidden_size: [256]
2024-05-19 13:49:24,234 - mlp_dropout: [0.3]
2024-05-19 13:49:24,234 - scale: [8]
2024-05-19 13:49:24,234 - ablation: ['no_binary']
2024-05-19 13:49:24,234 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/msz_MIntRec2_bert-base-uncased_multi-class_0
2024-05-19 13:49:24,234 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/msz_MIntRec2_bert-base-uncased_multi-class_0/models
2024-05-19 13:49:24,234 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/binary_msz_MIntRec2_bert-base-uncased_0
2024-05-19 13:49:24,234 - ============================== End Params ==============================
2024-05-19 13:49:27,291 - Multimodal Intent Recognition begins...
2024-05-19 13:49:27,291 - Training begins...
2024-05-19 13:51:06,189 - ***** Epoch: 1: Eval results *****
2024-05-19 13:51:06,190 -   train_loss = 2.6612
2024-05-19 13:51:06,190 -   eval_score = 0.5136
2024-05-19 13:51:06,190 -   best_eval_score = 0.0
2024-05-19 13:52:43,554 - ***** Epoch: 2: Eval results *****
2024-05-19 13:52:43,554 -   train_loss = 1.478
2024-05-19 13:52:43,554 -   eval_score = 0.5624
2024-05-19 13:52:43,554 -   best_eval_score = 0.5136
2024-05-19 13:54:21,166 - ***** Epoch: 3: Eval results *****
2024-05-19 13:54:21,166 -   train_loss = 1.1101
2024-05-19 13:54:21,166 -   eval_score = 0.5814
2024-05-19 13:54:21,166 -   best_eval_score = 0.5624
2024-05-19 13:55:58,673 - ***** Epoch: 4: Eval results *****
2024-05-19 13:55:58,673 -   train_loss = 0.861
2024-05-19 13:55:58,673 -   eval_score = 0.5859
2024-05-19 13:55:58,673 -   best_eval_score = 0.5814
2024-05-19 13:57:36,734 - ***** Epoch: 5: Eval results *****
2024-05-19 13:57:36,734 -   train_loss = 0.6372
2024-05-19 13:57:36,734 -   eval_score = 0.5805
2024-05-19 13:57:36,734 -   best_eval_score = 0.5859
2024-05-19 13:57:36,734 - EarlyStopping counter: 1 out of 3
2024-05-19 13:59:15,246 - ***** Epoch: 6: Eval results *****
2024-05-19 13:59:15,246 -   train_loss = 0.4476
2024-05-19 13:59:15,246 -   eval_score = 0.5904
2024-05-19 13:59:15,246 -   best_eval_score = 0.5859
2024-05-19 14:00:55,140 - ***** Epoch: 7: Eval results *****
2024-05-19 14:00:55,140 -   train_loss = 0.311
2024-05-19 14:00:55,140 -   eval_score = 0.5814
2024-05-19 14:00:55,140 -   best_eval_score = 0.5904
2024-05-19 14:00:55,140 - EarlyStopping counter: 1 out of 3
2024-05-19 14:02:34,555 - ***** Epoch: 8: Eval results *****
2024-05-19 14:02:34,555 -   train_loss = 0.2184
2024-05-19 14:02:34,555 -   eval_score = 0.5832
2024-05-19 14:02:34,555 -   best_eval_score = 0.5904
2024-05-19 14:02:34,555 - EarlyStopping counter: 2 out of 3
2024-05-19 14:04:12,727 - ***** Epoch: 9: Eval results *****
2024-05-19 14:04:12,727 -   train_loss = 0.1645
2024-05-19 14:04:12,727 -   eval_score = 0.5823
2024-05-19 14:04:12,727 -   best_eval_score = 0.5904
2024-05-19 14:04:12,727 - EarlyStopping counter: 3 out of 3
2024-05-19 14:04:12,727 - EarlyStopping at epoch 9
2024-05-19 14:04:12,730 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/msz_MIntRec2_bert-base-uncased_multi-class_0/models
2024-05-19 14:04:18,849 - Training is finished...
2024-05-19 14:04:18,850 - Testing begins...
2024-05-19 14:05:08,601 - ***** Out-of-domain Evaluation results *****
2024-05-19 14:05:08,601 -   aupr_in = 0.8086
2024-05-19 14:05:08,601 -   aupr_out = 0.5863
2024-05-19 14:05:08,602 -   auroc = 0.7298
2024-05-19 14:05:08,602 -   der = 0.5335
2024-05-19 14:05:08,602 -   eer = 0.3266
2024-05-19 14:05:08,602 -   fpr95 = 0.8187
2024-05-19 14:05:08,602 - Testing is finished...
2024-05-19 14:05:08,603 - Multimodal intent recognition is finished...
2024-05-19 14:05:08,603 - Results are saved in results/results_msz_ablation_MIntRec2.csv
2024-05-19 14:05:08,667 - ============================== Params ==============================
2024-05-19 14:05:08,667 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-05-19 14:05:08,667 - dataset: MIntRec2
2024-05-19 14:05:08,667 - ood_dataset: MIntRec2-OOD
2024-05-19 14:05:08,667 - data_mode: multi-class
2024-05-19 14:05:08,668 - multimodal_method: msz
2024-05-19 14:05:08,668 - method: msz
2024-05-19 14:05:08,668 - ood_detection_method: ma
2024-05-19 14:05:08,668 - text_backbone: bert-base-uncased
2024-05-19 14:05:08,668 - seed: 1
2024-05-19 14:05:08,668 - num_workers: 8
2024-05-19 14:05:08,668 - log_id: msz_ma_MIntRec2_multi-class_0_2024-05-19-13-49-00
2024-05-19 14:05:08,668 - gpu_id: 0
2024-05-19 14:05:08,668 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-19 14:05:08,668 - train: True
2024-05-19 14:05:08,668 - tune: True
2024-05-19 14:05:08,668 - ood: True
2024-05-19 14:05:08,668 - save_model: True
2024-05-19 14:05:08,668 - save_results: True
2024-05-19 14:05:08,668 - log_path: logs
2024-05-19 14:05:08,668 - cache_path: cache
2024-05-19 14:05:08,668 - video_data_path: video_data
2024-05-19 14:05:08,668 - audio_data_path: audio_data
2024-05-19 14:05:08,668 - video_feats_path: swin_feats.pkl
2024-05-19 14:05:08,668 - ood_video_feats_path: swin_feats.pkl
2024-05-19 14:05:08,668 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-19 14:05:08,668 - audio_feats_path: wavlm_feats.pkl
2024-05-19 14:05:08,668 - results_path: results
2024-05-19 14:05:08,668 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz
2024-05-19 14:05:08,668 - model_path: models
2024-05-19 14:05:08,668 - config_file_name: msz_MIntRec2
2024-05-19 14:05:08,669 - results_file_name: results_msz_ablation_MIntRec2.csv
2024-05-19 14:05:08,669 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-19 14:05:08,669 - text_seq_len: 50
2024-05-19 14:05:08,669 - video_seq_len: 180
2024-05-19 14:05:08,669 - audio_seq_len: 400
2024-05-19 14:05:08,669 - text_feat_dim: 768
2024-05-19 14:05:08,669 - video_feat_dim: 256
2024-05-19 14:05:08,669 - audio_feat_dim: 768
2024-05-19 14:05:08,669 - ood_label_id: 30
2024-05-19 14:05:08,669 - num_labels: 30
2024-05-19 14:05:08,669 - num_train_examples: 6165
2024-05-19 14:05:08,669 - need_aligned: True
2024-05-19 14:05:08,669 - freeze_parameters: False
2024-05-19 14:05:08,669 - eval_monitor: acc
2024-05-19 14:05:08,669 - train_batch_size: 32
2024-05-19 14:05:08,669 - eval_batch_size: 16
2024-05-19 14:05:08,669 - num_train_epochs: 100
2024-05-19 14:05:08,669 - lr: [1e-05]
2024-05-19 14:05:08,669 - weight_decay: [0.1]
2024-05-19 14:05:08,669 - wait_patience: 3
2024-05-19 14:05:08,669 - warmup_proportion: [0.01]
2024-05-19 14:05:08,669 - hidden_dims: [768]
2024-05-19 14:05:08,669 - num_attention_heads: [4]
2024-05-19 14:05:08,669 - attention_probs_dropout_prob: [0.3]
2024-05-19 14:05:08,669 - hidden_dropout_prob: [0.3]
2024-05-19 14:05:08,669 - intermediate_size: [768]
2024-05-19 14:05:08,670 - num_hidden_layers: [6]
2024-05-19 14:05:08,670 - max_position_embeddings: [768]
2024-05-19 14:05:08,670 - position_embedding_type: absolute
2024-05-19 14:05:08,670 - batch_first: True
2024-05-19 14:05:08,670 - aligned_method: ['ctc']
2024-05-19 14:05:08,670 - sampler: ['dir']
2024-05-19 14:05:08,670 - multiple_ood: [1]
2024-05-19 14:05:08,670 - select_number_min: [2]
2024-05-19 14:05:08,670 - select_number_max: [3]
2024-05-19 14:05:08,670 - alpha: [2]
2024-05-19 14:05:08,670 - mlp_hidden_size: [256]
2024-05-19 14:05:08,670 - mlp_dropout: [0.3]
2024-05-19 14:05:08,670 - scale: [8]
2024-05-19 14:05:08,670 - ablation: ['no_binary']
2024-05-19 14:05:08,670 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/msz_MIntRec2_bert-base-uncased_multi-class_1
2024-05-19 14:05:08,670 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/msz_MIntRec2_bert-base-uncased_multi-class_1/models
2024-05-19 14:05:08,670 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/binary_msz_MIntRec2_bert-base-uncased_1
2024-05-19 14:05:08,670 - device: cuda
2024-05-19 14:05:08,670 - ============================== End Params ==============================
2024-05-19 14:05:10,500 - Multimodal Intent Recognition begins...
2024-05-19 14:05:10,500 - Training begins...
2024-05-19 14:06:49,486 - ***** Epoch: 1: Eval results *****
2024-05-19 14:06:49,487 -   train_loss = 2.6561
2024-05-19 14:06:49,487 -   eval_score = 0.5027
2024-05-19 14:06:49,487 -   best_eval_score = 0.0
2024-05-19 14:08:28,176 - ***** Epoch: 2: Eval results *****
2024-05-19 14:08:28,176 -   train_loss = 1.4901
2024-05-19 14:08:28,176 -   eval_score = 0.5769
2024-05-19 14:08:28,176 -   best_eval_score = 0.5027
2024-05-19 14:10:06,732 - ***** Epoch: 3: Eval results *****
2024-05-19 14:10:06,733 -   train_loss = 1.1201
2024-05-19 14:10:06,733 -   eval_score = 0.575
2024-05-19 14:10:06,733 -   best_eval_score = 0.5769
2024-05-19 14:10:06,733 - EarlyStopping counter: 1 out of 3
2024-05-19 14:11:45,135 - ***** Epoch: 4: Eval results *****
2024-05-19 14:11:45,136 -   train_loss = 0.8546
2024-05-19 14:11:45,136 -   eval_score = 0.5723
2024-05-19 14:11:45,136 -   best_eval_score = 0.5769
2024-05-19 14:11:45,136 - EarlyStopping counter: 2 out of 3
2024-05-19 14:13:24,299 - ***** Epoch: 5: Eval results *****
2024-05-19 14:13:24,299 -   train_loss = 0.6324
2024-05-19 14:13:24,299 -   eval_score = 0.5886
2024-05-19 14:13:24,299 -   best_eval_score = 0.5769
2024-05-19 14:15:02,951 - ***** Epoch: 6: Eval results *****
2024-05-19 14:15:02,951 -   train_loss = 0.4461
2024-05-19 14:15:02,951 -   eval_score = 0.575
2024-05-19 14:15:02,951 -   best_eval_score = 0.5886
2024-05-19 14:15:02,951 - EarlyStopping counter: 1 out of 3
2024-05-19 14:16:41,249 - ***** Epoch: 7: Eval results *****
2024-05-19 14:16:41,249 -   train_loss = 0.312
2024-05-19 14:16:41,249 -   eval_score = 0.5805
2024-05-19 14:16:41,249 -   best_eval_score = 0.5886
2024-05-19 14:16:41,249 - EarlyStopping counter: 2 out of 3
2024-05-19 14:18:20,230 - ***** Epoch: 8: Eval results *****
2024-05-19 14:18:20,231 -   train_loss = 0.2213
2024-05-19 14:18:20,231 -   eval_score = 0.5922
2024-05-19 14:18:20,231 -   best_eval_score = 0.5886
2024-05-19 14:19:59,293 - ***** Epoch: 9: Eval results *****
2024-05-19 14:19:59,293 -   train_loss = 0.1656
2024-05-19 14:19:59,294 -   eval_score = 0.5832
2024-05-19 14:19:59,294 -   best_eval_score = 0.5922
2024-05-19 14:19:59,294 - EarlyStopping counter: 1 out of 3
2024-05-19 14:21:38,276 - ***** Epoch: 10: Eval results *****
2024-05-19 14:21:38,276 -   train_loss = 0.1345
2024-05-19 14:21:38,276 -   eval_score = 0.5823
2024-05-19 14:21:38,276 -   best_eval_score = 0.5922
2024-05-19 14:21:38,276 - EarlyStopping counter: 2 out of 3
2024-05-19 14:23:16,875 - ***** Epoch: 11: Eval results *****
2024-05-19 14:23:16,875 -   train_loss = 0.1083
2024-05-19 14:23:16,875 -   eval_score = 0.5868
2024-05-19 14:23:16,875 -   best_eval_score = 0.5922
2024-05-19 14:23:16,876 - EarlyStopping counter: 3 out of 3
2024-05-19 14:23:16,876 - EarlyStopping at epoch 11
2024-05-19 14:23:16,879 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/msz_MIntRec2_bert-base-uncased_multi-class_1/models
2024-05-19 14:23:22,626 - Training is finished...
2024-05-19 14:23:22,627 - Testing begins...
2024-05-19 14:24:12,319 - ***** Out-of-domain Evaluation results *****
2024-05-19 14:24:12,320 -   aupr_in = 0.8064
2024-05-19 14:24:12,320 -   aupr_out = 0.5739
2024-05-19 14:24:12,320 -   auroc = 0.72
2024-05-19 14:24:12,320 -   der = 0.5453
2024-05-19 14:24:12,320 -   eer = 0.3375
2024-05-19 14:24:12,320 -   fpr95 = 0.8371
2024-05-19 14:24:12,320 - Testing is finished...
2024-05-19 14:24:12,320 - Multimodal intent recognition is finished...
2024-05-19 14:24:12,320 - Results are saved in results/results_msz_ablation_MIntRec2.csv
2024-05-19 14:24:12,392 - ============================== Params ==============================
2024-05-19 14:24:12,393 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-05-19 14:24:12,393 - dataset: MIntRec2
2024-05-19 14:24:12,393 - ood_dataset: MIntRec2-OOD
2024-05-19 14:24:12,393 - data_mode: multi-class
2024-05-19 14:24:12,393 - multimodal_method: msz
2024-05-19 14:24:12,393 - method: msz
2024-05-19 14:24:12,393 - ood_detection_method: ma
2024-05-19 14:24:12,393 - text_backbone: bert-base-uncased
2024-05-19 14:24:12,393 - seed: 2
2024-05-19 14:24:12,393 - num_workers: 8
2024-05-19 14:24:12,393 - log_id: msz_ma_MIntRec2_multi-class_0_2024-05-19-13-49-00
2024-05-19 14:24:12,393 - gpu_id: 0
2024-05-19 14:24:12,393 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-19 14:24:12,393 - train: True
2024-05-19 14:24:12,393 - tune: True
2024-05-19 14:24:12,393 - ood: True
2024-05-19 14:24:12,393 - save_model: True
2024-05-19 14:24:12,393 - save_results: True
2024-05-19 14:24:12,393 - log_path: logs
2024-05-19 14:24:12,393 - cache_path: cache
2024-05-19 14:24:12,393 - video_data_path: video_data
2024-05-19 14:24:12,393 - audio_data_path: audio_data
2024-05-19 14:24:12,393 - video_feats_path: swin_feats.pkl
2024-05-19 14:24:12,393 - ood_video_feats_path: swin_feats.pkl
2024-05-19 14:24:12,393 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-19 14:24:12,393 - audio_feats_path: wavlm_feats.pkl
2024-05-19 14:24:12,393 - results_path: results
2024-05-19 14:24:12,393 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz
2024-05-19 14:24:12,393 - model_path: models
2024-05-19 14:24:12,393 - config_file_name: msz_MIntRec2
2024-05-19 14:24:12,393 - results_file_name: results_msz_ablation_MIntRec2.csv
2024-05-19 14:24:12,393 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-19 14:24:12,393 - text_seq_len: 50
2024-05-19 14:24:12,393 - video_seq_len: 180
2024-05-19 14:24:12,394 - audio_seq_len: 400
2024-05-19 14:24:12,394 - text_feat_dim: 768
2024-05-19 14:24:12,394 - video_feat_dim: 256
2024-05-19 14:24:12,394 - audio_feat_dim: 768
2024-05-19 14:24:12,394 - ood_label_id: 30
2024-05-19 14:24:12,394 - num_labels: 30
2024-05-19 14:24:12,394 - num_train_examples: 6165
2024-05-19 14:24:12,394 - need_aligned: True
2024-05-19 14:24:12,394 - freeze_parameters: False
2024-05-19 14:24:12,394 - eval_monitor: acc
2024-05-19 14:24:12,394 - train_batch_size: 32
2024-05-19 14:24:12,394 - eval_batch_size: 16
2024-05-19 14:24:12,394 - num_train_epochs: 100
2024-05-19 14:24:12,394 - lr: [1e-05]
2024-05-19 14:24:12,394 - weight_decay: [0.1]
2024-05-19 14:24:12,394 - wait_patience: 3
2024-05-19 14:24:12,394 - warmup_proportion: [0.01]
2024-05-19 14:24:12,394 - hidden_dims: [768]
2024-05-19 14:24:12,394 - num_attention_heads: [4]
2024-05-19 14:24:12,394 - attention_probs_dropout_prob: [0.3]
2024-05-19 14:24:12,394 - hidden_dropout_prob: [0.3]
2024-05-19 14:24:12,394 - intermediate_size: [768]
2024-05-19 14:24:12,394 - num_hidden_layers: [6]
2024-05-19 14:24:12,394 - max_position_embeddings: [768]
2024-05-19 14:24:12,394 - position_embedding_type: absolute
2024-05-19 14:24:12,394 - batch_first: True
2024-05-19 14:24:12,394 - aligned_method: ['ctc']
2024-05-19 14:24:12,394 - sampler: ['dir']
2024-05-19 14:24:12,394 - multiple_ood: [1]
2024-05-19 14:24:12,394 - select_number_min: [2]
2024-05-19 14:24:12,394 - select_number_max: [3]
2024-05-19 14:24:12,394 - alpha: [2]
2024-05-19 14:24:12,394 - mlp_hidden_size: [256]
2024-05-19 14:24:12,394 - mlp_dropout: [0.3]
2024-05-19 14:24:12,394 - scale: [8]
2024-05-19 14:24:12,394 - ablation: ['no_binary']
2024-05-19 14:24:12,394 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/msz_MIntRec2_bert-base-uncased_multi-class_2
2024-05-19 14:24:12,394 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/msz_MIntRec2_bert-base-uncased_multi-class_2/models
2024-05-19 14:24:12,394 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/binary_msz_MIntRec2_bert-base-uncased_2
2024-05-19 14:24:12,394 - device: cuda
2024-05-19 14:24:12,394 - ============================== End Params ==============================
2024-05-19 14:24:14,078 - Multimodal Intent Recognition begins...
2024-05-19 14:24:14,078 - Training begins...
2024-05-19 14:25:52,990 - ***** Epoch: 1: Eval results *****
2024-05-19 14:25:52,990 -   train_loss = 2.667
2024-05-19 14:25:52,990 -   eval_score = 0.519
2024-05-19 14:25:52,990 -   best_eval_score = 0.0
2024-05-19 14:27:31,747 - ***** Epoch: 2: Eval results *****
2024-05-19 14:27:31,747 -   train_loss = 1.4788
2024-05-19 14:27:31,748 -   eval_score = 0.5696
2024-05-19 14:27:31,748 -   best_eval_score = 0.519
2024-05-19 14:29:10,667 - ***** Epoch: 3: Eval results *****
2024-05-19 14:29:10,668 -   train_loss = 1.1243
2024-05-19 14:29:10,668 -   eval_score = 0.6022
2024-05-19 14:29:10,668 -   best_eval_score = 0.5696
2024-05-19 14:30:49,922 - ***** Epoch: 4: Eval results *****
2024-05-19 14:30:49,923 -   train_loss = 0.8532
2024-05-19 14:30:49,923 -   eval_score = 0.6013
2024-05-19 14:30:49,923 -   best_eval_score = 0.6022
2024-05-19 14:30:49,923 - EarlyStopping counter: 1 out of 3
2024-05-19 14:32:29,024 - ***** Epoch: 5: Eval results *****
2024-05-19 14:32:29,024 -   train_loss = 0.6312
2024-05-19 14:32:29,024 -   eval_score = 0.5913
2024-05-19 14:32:29,024 -   best_eval_score = 0.6022
2024-05-19 14:32:29,024 - EarlyStopping counter: 2 out of 3
2024-05-19 14:34:08,038 - ***** Epoch: 6: Eval results *****
2024-05-19 14:34:08,038 -   train_loss = 0.4534
2024-05-19 14:34:08,038 -   eval_score = 0.585
2024-05-19 14:34:08,038 -   best_eval_score = 0.6022
2024-05-19 14:34:08,038 - EarlyStopping counter: 3 out of 3
2024-05-19 14:34:08,038 - EarlyStopping at epoch 6
2024-05-19 14:34:08,040 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/msz_MIntRec2_bert-base-uncased_multi-class_2/models
2024-05-19 14:34:14,387 - Training is finished...
2024-05-19 14:34:14,388 - Testing begins...
2024-05-19 14:35:04,919 - ***** Out-of-domain Evaluation results *****
2024-05-19 14:35:04,920 -   aupr_in = 0.809
2024-05-19 14:35:04,920 -   aupr_out = 0.5957
2024-05-19 14:35:04,920 -   auroc = 0.7294
2024-05-19 14:35:04,920 -   der = 0.5385
2024-05-19 14:35:04,920 -   eer = 0.3241
2024-05-19 14:35:04,920 -   fpr95 = 0.8262
2024-05-19 14:35:04,920 - Testing is finished...
2024-05-19 14:35:04,920 - Multimodal intent recognition is finished...
2024-05-19 14:35:04,920 - Results are saved in results/results_msz_ablation_MIntRec2.csv
2024-05-19 14:35:04,963 - ============================== Params ==============================
2024-05-19 14:35:04,963 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-05-19 14:35:04,963 - dataset: MIntRec2
2024-05-19 14:35:04,963 - ood_dataset: MIntRec2-OOD
2024-05-19 14:35:04,963 - data_mode: multi-class
2024-05-19 14:35:04,963 - multimodal_method: msz
2024-05-19 14:35:04,963 - method: msz
2024-05-19 14:35:04,964 - ood_detection_method: ma
2024-05-19 14:35:04,964 - text_backbone: bert-base-uncased
2024-05-19 14:35:04,964 - seed: 3
2024-05-19 14:35:04,964 - num_workers: 8
2024-05-19 14:35:04,964 - log_id: msz_ma_MIntRec2_multi-class_0_2024-05-19-13-49-00
2024-05-19 14:35:04,964 - gpu_id: 0
2024-05-19 14:35:04,964 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-19 14:35:04,964 - train: True
2024-05-19 14:35:04,964 - tune: True
2024-05-19 14:35:04,964 - ood: True
2024-05-19 14:35:04,964 - save_model: True
2024-05-19 14:35:04,964 - save_results: True
2024-05-19 14:35:04,964 - log_path: logs
2024-05-19 14:35:04,964 - cache_path: cache
2024-05-19 14:35:04,964 - video_data_path: video_data
2024-05-19 14:35:04,964 - audio_data_path: audio_data
2024-05-19 14:35:04,964 - video_feats_path: swin_feats.pkl
2024-05-19 14:35:04,964 - ood_video_feats_path: swin_feats.pkl
2024-05-19 14:35:04,964 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-19 14:35:04,964 - audio_feats_path: wavlm_feats.pkl
2024-05-19 14:35:04,964 - results_path: results
2024-05-19 14:35:04,964 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz
2024-05-19 14:35:04,964 - model_path: models
2024-05-19 14:35:04,964 - config_file_name: msz_MIntRec2
2024-05-19 14:35:04,964 - results_file_name: results_msz_ablation_MIntRec2.csv
2024-05-19 14:35:04,964 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-19 14:35:04,964 - text_seq_len: 50
2024-05-19 14:35:04,964 - video_seq_len: 180
2024-05-19 14:35:04,964 - audio_seq_len: 400
2024-05-19 14:35:04,964 - text_feat_dim: 768
2024-05-19 14:35:04,964 - video_feat_dim: 256
2024-05-19 14:35:04,964 - audio_feat_dim: 768
2024-05-19 14:35:04,964 - ood_label_id: 30
2024-05-19 14:35:04,964 - num_labels: 30
2024-05-19 14:35:04,964 - num_train_examples: 6165
2024-05-19 14:35:04,964 - need_aligned: True
2024-05-19 14:35:04,964 - freeze_parameters: False
2024-05-19 14:35:04,964 - eval_monitor: acc
2024-05-19 14:35:04,964 - train_batch_size: 32
2024-05-19 14:35:04,965 - eval_batch_size: 16
2024-05-19 14:35:04,965 - num_train_epochs: 100
2024-05-19 14:35:04,965 - lr: [1e-05]
2024-05-19 14:35:04,965 - weight_decay: [0.1]
2024-05-19 14:35:04,965 - wait_patience: 3
2024-05-19 14:35:04,965 - warmup_proportion: [0.01]
2024-05-19 14:35:04,965 - hidden_dims: [768]
2024-05-19 14:35:04,965 - num_attention_heads: [4]
2024-05-19 14:35:04,965 - attention_probs_dropout_prob: [0.3]
2024-05-19 14:35:04,965 - hidden_dropout_prob: [0.3]
2024-05-19 14:35:04,965 - intermediate_size: [768]
2024-05-19 14:35:04,965 - num_hidden_layers: [6]
2024-05-19 14:35:04,965 - max_position_embeddings: [768]
2024-05-19 14:35:04,965 - position_embedding_type: absolute
2024-05-19 14:35:04,965 - batch_first: True
2024-05-19 14:35:04,965 - aligned_method: ['ctc']
2024-05-19 14:35:04,965 - sampler: ['dir']
2024-05-19 14:35:04,965 - multiple_ood: [1]
2024-05-19 14:35:04,965 - select_number_min: [2]
2024-05-19 14:35:04,965 - select_number_max: [3]
2024-05-19 14:35:04,965 - alpha: [2]
2024-05-19 14:35:04,965 - mlp_hidden_size: [256]
2024-05-19 14:35:04,965 - mlp_dropout: [0.3]
2024-05-19 14:35:04,965 - scale: [8]
2024-05-19 14:35:04,965 - ablation: ['no_binary']
2024-05-19 14:35:04,965 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/msz_MIntRec2_bert-base-uncased_multi-class_3
2024-05-19 14:35:04,965 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/msz_MIntRec2_bert-base-uncased_multi-class_3/models
2024-05-19 14:35:04,965 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/binary_msz_MIntRec2_bert-base-uncased_3
2024-05-19 14:35:04,965 - device: cuda
2024-05-19 14:35:04,965 - ============================== End Params ==============================
2024-05-19 14:35:06,624 - Multimodal Intent Recognition begins...
2024-05-19 14:35:06,624 - Training begins...
2024-05-19 14:36:45,402 - ***** Epoch: 1: Eval results *****
2024-05-19 14:36:45,402 -   train_loss = 2.6572
2024-05-19 14:36:45,402 -   eval_score = 0.4901
2024-05-19 14:36:45,402 -   best_eval_score = 0.0
2024-05-19 14:38:24,574 - ***** Epoch: 2: Eval results *****
2024-05-19 14:38:24,574 -   train_loss = 1.4815
2024-05-19 14:38:24,574 -   eval_score = 0.5678
2024-05-19 14:38:24,574 -   best_eval_score = 0.4901
2024-05-19 14:40:03,538 - ***** Epoch: 3: Eval results *****
2024-05-19 14:40:03,538 -   train_loss = 1.1203
2024-05-19 14:40:03,538 -   eval_score = 0.5841
2024-05-19 14:40:03,538 -   best_eval_score = 0.5678
2024-05-19 14:41:42,550 - ***** Epoch: 4: Eval results *****
2024-05-19 14:41:42,551 -   train_loss = 0.8697
2024-05-19 14:41:42,551 -   eval_score = 0.5868
2024-05-19 14:41:42,551 -   best_eval_score = 0.5841
2024-05-19 14:43:20,781 - ***** Epoch: 5: Eval results *****
2024-05-19 14:43:20,781 -   train_loss = 0.6361
2024-05-19 14:43:20,781 -   eval_score = 0.5904
2024-05-19 14:43:20,782 -   best_eval_score = 0.5868
2024-05-19 14:44:59,585 - ***** Epoch: 6: Eval results *****
2024-05-19 14:44:59,586 -   train_loss = 0.4436
2024-05-19 14:44:59,586 -   eval_score = 0.6076
2024-05-19 14:44:59,586 -   best_eval_score = 0.5904
2024-05-19 14:46:38,979 - ***** Epoch: 7: Eval results *****
2024-05-19 14:46:38,979 -   train_loss = 0.3161
2024-05-19 14:46:38,979 -   eval_score = 0.5877
2024-05-19 14:46:38,979 -   best_eval_score = 0.6076
2024-05-19 14:46:38,979 - EarlyStopping counter: 1 out of 3
2024-05-19 14:48:17,194 - ***** Epoch: 8: Eval results *****
2024-05-19 14:48:17,195 -   train_loss = 0.222
2024-05-19 14:48:17,195 -   eval_score = 0.5805
2024-05-19 14:48:17,195 -   best_eval_score = 0.6076
2024-05-19 14:48:17,195 - EarlyStopping counter: 2 out of 3
2024-05-19 14:49:55,210 - ***** Epoch: 9: Eval results *****
2024-05-19 14:49:55,210 -   train_loss = 0.1692
2024-05-19 14:49:55,210 -   eval_score = 0.585
2024-05-19 14:49:55,210 -   best_eval_score = 0.6076
2024-05-19 14:49:55,210 - EarlyStopping counter: 3 out of 3
2024-05-19 14:49:55,210 - EarlyStopping at epoch 9
2024-05-19 14:49:55,212 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/msz_MIntRec2_bert-base-uncased_multi-class_3/models
2024-05-19 14:50:02,247 - Training is finished...
2024-05-19 14:50:02,248 - Testing begins...
2024-05-19 14:50:50,696 - ***** Out-of-domain Evaluation results *****
2024-05-19 14:50:50,696 -   aupr_in = 0.8037
2024-05-19 14:50:50,696 -   aupr_out = 0.5774
2024-05-19 14:50:50,696 -   auroc = 0.7166
2024-05-19 14:50:50,696 -   der = 0.5348
2024-05-19 14:50:50,697 -   eer = 0.345
2024-05-19 14:50:50,697 -   fpr95 = 0.8204
2024-05-19 14:50:50,697 - Testing is finished...
2024-05-19 14:50:50,697 - Multimodal intent recognition is finished...
2024-05-19 14:50:50,697 - Results are saved in results/results_msz_ablation_MIntRec2.csv
2024-05-19 14:50:50,761 - ============================== Params ==============================
2024-05-19 14:50:50,761 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-05-19 14:50:50,762 - dataset: MIntRec2
2024-05-19 14:50:50,762 - ood_dataset: MIntRec2-OOD
2024-05-19 14:50:50,762 - data_mode: multi-class
2024-05-19 14:50:50,762 - multimodal_method: msz
2024-05-19 14:50:50,762 - method: msz
2024-05-19 14:50:50,762 - ood_detection_method: ma
2024-05-19 14:50:50,762 - text_backbone: bert-base-uncased
2024-05-19 14:50:50,762 - seed: 4
2024-05-19 14:50:50,762 - num_workers: 8
2024-05-19 14:50:50,762 - log_id: msz_ma_MIntRec2_multi-class_0_2024-05-19-13-49-00
2024-05-19 14:50:50,762 - gpu_id: 0
2024-05-19 14:50:50,762 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-19 14:50:50,762 - train: True
2024-05-19 14:50:50,762 - tune: True
2024-05-19 14:50:50,762 - ood: True
2024-05-19 14:50:50,762 - save_model: True
2024-05-19 14:50:50,762 - save_results: True
2024-05-19 14:50:50,762 - log_path: logs
2024-05-19 14:50:50,762 - cache_path: cache
2024-05-19 14:50:50,762 - video_data_path: video_data
2024-05-19 14:50:50,762 - audio_data_path: audio_data
2024-05-19 14:50:50,762 - video_feats_path: swin_feats.pkl
2024-05-19 14:50:50,762 - ood_video_feats_path: swin_feats.pkl
2024-05-19 14:50:50,763 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-19 14:50:50,763 - audio_feats_path: wavlm_feats.pkl
2024-05-19 14:50:50,763 - results_path: results
2024-05-19 14:50:50,763 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz
2024-05-19 14:50:50,763 - model_path: models
2024-05-19 14:50:50,763 - config_file_name: msz_MIntRec2
2024-05-19 14:50:50,763 - results_file_name: results_msz_ablation_MIntRec2.csv
2024-05-19 14:50:50,763 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-19 14:50:50,763 - text_seq_len: 50
2024-05-19 14:50:50,763 - video_seq_len: 180
2024-05-19 14:50:50,763 - audio_seq_len: 400
2024-05-19 14:50:50,763 - text_feat_dim: 768
2024-05-19 14:50:50,763 - video_feat_dim: 256
2024-05-19 14:50:50,763 - audio_feat_dim: 768
2024-05-19 14:50:50,763 - ood_label_id: 30
2024-05-19 14:50:50,763 - num_labels: 30
2024-05-19 14:50:50,763 - num_train_examples: 6165
2024-05-19 14:50:50,763 - need_aligned: True
2024-05-19 14:50:50,763 - freeze_parameters: False
2024-05-19 14:50:50,763 - eval_monitor: acc
2024-05-19 14:50:50,763 - train_batch_size: 32
2024-05-19 14:50:50,763 - eval_batch_size: 16
2024-05-19 14:50:50,763 - num_train_epochs: 100
2024-05-19 14:50:50,763 - lr: [1e-05]
2024-05-19 14:50:50,763 - weight_decay: [0.1]
2024-05-19 14:50:50,763 - wait_patience: 3
2024-05-19 14:50:50,763 - warmup_proportion: [0.01]
2024-05-19 14:50:50,763 - hidden_dims: [768]
2024-05-19 14:50:50,763 - num_attention_heads: [4]
2024-05-19 14:50:50,763 - attention_probs_dropout_prob: [0.3]
2024-05-19 14:50:50,764 - hidden_dropout_prob: [0.3]
2024-05-19 14:50:50,764 - intermediate_size: [768]
2024-05-19 14:50:50,764 - num_hidden_layers: [6]
2024-05-19 14:50:50,764 - max_position_embeddings: [768]
2024-05-19 14:50:50,764 - position_embedding_type: absolute
2024-05-19 14:50:50,764 - batch_first: True
2024-05-19 14:50:50,764 - aligned_method: ['ctc']
2024-05-19 14:50:50,764 - sampler: ['dir']
2024-05-19 14:50:50,764 - multiple_ood: [1]
2024-05-19 14:50:50,764 - select_number_min: [2]
2024-05-19 14:50:50,764 - select_number_max: [3]
2024-05-19 14:50:50,764 - alpha: [2]
2024-05-19 14:50:50,764 - mlp_hidden_size: [256]
2024-05-19 14:50:50,764 - mlp_dropout: [0.3]
2024-05-19 14:50:50,764 - scale: [8]
2024-05-19 14:50:50,764 - ablation: ['no_binary']
2024-05-19 14:50:50,764 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/msz_MIntRec2_bert-base-uncased_multi-class_4
2024-05-19 14:50:50,764 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/msz_MIntRec2_bert-base-uncased_multi-class_4/models
2024-05-19 14:50:50,764 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/binary_msz_MIntRec2_bert-base-uncased_4
2024-05-19 14:50:50,764 - device: cuda
2024-05-19 14:50:50,764 - ============================== End Params ==============================
2024-05-19 14:50:52,432 - Multimodal Intent Recognition begins...
2024-05-19 14:50:52,432 - Training begins...
2024-05-19 14:52:30,330 - ***** Epoch: 1: Eval results *****
2024-05-19 14:52:30,330 -   train_loss = 2.6605
2024-05-19 14:52:30,330 -   eval_score = 0.5018
2024-05-19 14:52:30,330 -   best_eval_score = 0.0
2024-05-19 14:54:08,524 - ***** Epoch: 2: Eval results *****
2024-05-19 14:54:08,524 -   train_loss = 1.4881
2024-05-19 14:54:08,524 -   eval_score = 0.5434
2024-05-19 14:54:08,524 -   best_eval_score = 0.5018
2024-05-19 14:55:46,635 - ***** Epoch: 3: Eval results *****
2024-05-19 14:55:46,635 -   train_loss = 1.1291
2024-05-19 14:55:46,635 -   eval_score = 0.5967
2024-05-19 14:55:46,635 -   best_eval_score = 0.5434
2024-05-19 14:57:24,702 - ***** Epoch: 4: Eval results *****
2024-05-19 14:57:24,702 -   train_loss = 0.8661
2024-05-19 14:57:24,702 -   eval_score = 0.5796
2024-05-19 14:57:24,702 -   best_eval_score = 0.5967
2024-05-19 14:57:24,702 - EarlyStopping counter: 1 out of 3
2024-05-19 14:59:02,580 - ***** Epoch: 5: Eval results *****
2024-05-19 14:59:02,580 -   train_loss = 0.6286
2024-05-19 14:59:02,580 -   eval_score = 0.5913
2024-05-19 14:59:02,580 -   best_eval_score = 0.5967
2024-05-19 14:59:02,580 - EarlyStopping counter: 2 out of 3
2024-05-19 15:00:40,334 - ***** Epoch: 6: Eval results *****
2024-05-19 15:00:40,334 -   train_loss = 0.4422
2024-05-19 15:00:40,334 -   eval_score = 0.5931
2024-05-19 15:00:40,334 -   best_eval_score = 0.5967
2024-05-19 15:00:40,334 - EarlyStopping counter: 3 out of 3
2024-05-19 15:00:40,334 - EarlyStopping at epoch 6
2024-05-19 15:00:40,337 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_binary_msz/msz_MIntRec2_bert-base-uncased_multi-class_4/models
2024-05-19 15:00:46,478 - Training is finished...
2024-05-19 15:00:46,478 - Testing begins...
2024-05-19 15:01:34,887 - ***** Out-of-domain Evaluation results *****
2024-05-19 15:01:34,887 -   aupr_in = 0.8049
2024-05-19 15:01:34,887 -   aupr_out = 0.5898
2024-05-19 15:01:34,887 -   auroc = 0.7222
2024-05-19 15:01:34,887 -   der = 0.5295
2024-05-19 15:01:34,887 -   eer = 0.345
2024-05-19 15:01:34,888 -   fpr95 = 0.812
2024-05-19 15:01:34,888 - Testing is finished...
2024-05-19 15:01:34,888 - Multimodal intent recognition is finished...
2024-05-19 15:01:34,888 - Results are saved in results/results_msz_ablation_MIntRec2.csv
