2024-05-15 10:12:26,391 - Lists of intent labels are: ['Complain', 'Praise', 'Apologise', 'Thank', 'Criticize', 'Agree', 'Taunt', 'Flaunt', 'Joke', 'Oppose', 'Comfort', 'Care', 'Inform', 'Advise', 'Arrange', 'Introduce', 'Leave', 'Prevent', 'Greet', 'Ask for help']
2024-05-15 10:12:26,392 - ID Data preparation...
2024-05-15 10:12:32,770 - OOD Data preparation...
2024-05-15 10:12:34,388 - ============================== Params ==============================
2024-05-15 10:12:34,388 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-15 10:12:34,388 - dataset: MIntRec
2024-05-15 10:12:34,388 - ood_dataset: MIntRec-OOD
2024-05-15 10:12:34,388 - data_mode: multi-class
2024-05-15 10:12:34,388 - multimodal_method: msz
2024-05-15 10:12:34,388 - method: msz
2024-05-15 10:12:34,388 - ood_detection_method: ma
2024-05-15 10:12:34,388 - text_backbone: bert-base-uncased
2024-05-15 10:12:34,388 - seed: 0
2024-05-15 10:12:34,388 - num_workers: 8
2024-05-15 10:12:34,388 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-15-10-12-26
2024-05-15 10:12:34,388 - gpu_id: 0
2024-05-15 10:12:34,388 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-15 10:12:34,388 - train: True
2024-05-15 10:12:34,388 - tune: True
2024-05-15 10:12:34,389 - ood: True
2024-05-15 10:12:34,389 - save_model: True
2024-05-15 10:12:34,389 - save_results: True
2024-05-15 10:12:34,389 - log_path: logs
2024-05-15 10:12:34,389 - cache_path: cache
2024-05-15 10:12:34,389 - video_data_path: video_data
2024-05-15 10:12:34,389 - audio_data_path: audio_data
2024-05-15 10:12:34,389 - video_feats_path: swin_feats.pkl
2024-05-15 10:12:34,389 - ood_video_feats_path: swin_feats.pkl
2024-05-15 10:12:34,389 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-15 10:12:34,389 - audio_feats_path: wavlm_feats.pkl
2024-05-15 10:12:34,389 - results_path: results
2024-05-15 10:12:34,389 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz
2024-05-15 10:12:34,389 - model_path: models
2024-05-15 10:12:34,389 - config_file_name: msz_MIntRec
2024-05-15 10:12:34,389 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-15 10:12:34,389 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-15 10:12:34,389 - text_seq_len: 30
2024-05-15 10:12:34,389 - video_seq_len: 230
2024-05-15 10:12:34,389 - audio_seq_len: 480
2024-05-15 10:12:34,389 - text_feat_dim: 768
2024-05-15 10:12:34,389 - video_feat_dim: 1024
2024-05-15 10:12:34,389 - audio_feat_dim: 768
2024-05-15 10:12:34,389 - ood_label_id: 20
2024-05-15 10:12:34,389 - num_labels: 20
2024-05-15 10:12:34,389 - num_train_examples: 1334
2024-05-15 10:12:34,390 - need_aligned: True
2024-05-15 10:12:34,390 - freeze_parameters: False
2024-05-15 10:12:34,390 - eval_monitor: acc
2024-05-15 10:12:34,390 - train_batch_size: 32
2024-05-15 10:12:34,390 - eval_batch_size: 16
2024-05-15 10:12:34,390 - num_train_epochs: 100
2024-05-15 10:12:34,390 - lr: [2e-05]
2024-05-15 10:12:34,390 - weight_decay: [0.1]
2024-05-15 10:12:34,390 - wait_patience: 5
2024-05-15 10:12:34,390 - warmup_proportion: [0.01]
2024-05-15 10:12:34,390 - hidden_dims: [768]
2024-05-15 10:12:34,390 - num_attention_heads: [8]
2024-05-15 10:12:34,390 - attention_probs_dropout_prob: [0.3]
2024-05-15 10:12:34,390 - hidden_dropout_prob: [0.2]
2024-05-15 10:12:34,390 - intermediate_size: [768]
2024-05-15 10:12:34,390 - num_hidden_layers: [4]
2024-05-15 10:12:34,390 - max_position_embeddings: [900]
2024-05-15 10:12:34,390 - position_embedding_type: absolute
2024-05-15 10:12:34,390 - batch_first: True
2024-05-15 10:12:34,390 - aligned_method: ['ctc']
2024-05-15 10:12:34,390 - sampler: beta
2024-05-15 10:12:34,390 - multiple_ood: [1]
2024-05-15 10:12:34,390 - select_number_min: [2]
2024-05-15 10:12:34,390 - select_number_max: [3]
2024-05-15 10:12:34,390 - alpha: [4]
2024-05-15 10:12:34,391 - mlp_hidden_size: [256]
2024-05-15 10:12:34,391 - mlp_dropout: [0.3]
2024-05-15 10:12:34,391 - scale: [8]
2024-05-15 10:12:34,391 - ablation: ['no_fusion_add']
2024-05-15 10:12:34,391 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/msz_MIntRec_bert-base-uncased_multi-class_0
2024-05-15 10:12:34,391 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/msz_MIntRec_bert-base-uncased_multi-class_0/models
2024-05-15 10:12:34,391 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/binary_msz_MIntRec_bert-base-uncased_0
2024-05-15 10:12:34,391 - ============================== End Params ==============================
2024-05-15 10:12:37,265 - Multimodal Intent Recognition begins...
2024-05-15 10:12:37,265 - Training begins...
2024-05-15 10:12:57,374 - ***** Epoch: 1: Eval results *****
2024-05-15 10:12:57,374 -   binary_train_loss = 0.7086
2024-05-15 10:12:57,374 -   binary_eval_score = 0.5011
2024-05-15 10:12:57,374 -   train_loss = 2.8314
2024-05-15 10:12:57,374 -   eval_score = 0.1888
2024-05-15 10:12:57,374 -   best_eval_score = 0.0
2024-05-15 10:13:15,938 - ***** Epoch: 2: Eval results *****
2024-05-15 10:13:15,939 -   binary_train_loss = 0.7002
2024-05-15 10:13:15,939 -   binary_eval_score = 0.5011
2024-05-15 10:13:15,939 -   train_loss = 2.4748
2024-05-15 10:13:15,939 -   eval_score = 0.5101
2024-05-15 10:13:15,939 -   best_eval_score = 0.1888
2024-05-15 10:13:34,756 - ***** Epoch: 3: Eval results *****
2024-05-15 10:13:34,756 -   binary_train_loss = 0.6878
2024-05-15 10:13:34,757 -   binary_eval_score = 0.6
2024-05-15 10:13:34,757 -   train_loss = 1.2341
2024-05-15 10:13:34,757 -   eval_score = 0.6719
2024-05-15 10:13:34,757 -   best_eval_score = 0.5101
2024-05-15 10:13:53,356 - ***** Epoch: 4: Eval results *****
2024-05-15 10:13:53,356 -   binary_train_loss = 0.6789
2024-05-15 10:13:53,357 -   binary_eval_score = 0.7303
2024-05-15 10:13:53,357 -   train_loss = 0.7077
2024-05-15 10:13:53,357 -   eval_score = 0.6966
2024-05-15 10:13:53,357 -   best_eval_score = 0.6719
2024-05-15 10:14:12,356 - ***** Epoch: 5: Eval results *****
2024-05-15 10:14:12,356 -   binary_train_loss = 0.6748
2024-05-15 10:14:12,356 -   binary_eval_score = 0.7315
2024-05-15 10:14:12,356 -   train_loss = 0.3459
2024-05-15 10:14:12,356 -   eval_score = 0.6966
2024-05-15 10:14:12,356 -   best_eval_score = 0.6966
2024-05-15 10:14:12,356 - EarlyStopping counter: 1 out of 5
2024-05-15 10:14:32,356 - ***** Epoch: 6: Eval results *****
2024-05-15 10:14:32,356 -   binary_train_loss = 0.6697
2024-05-15 10:14:32,356 -   binary_eval_score = 0.7978
2024-05-15 10:14:32,356 -   train_loss = 0.1783
2024-05-15 10:14:32,356 -   eval_score = 0.7124
2024-05-15 10:14:32,356 -   best_eval_score = 0.6966
2024-05-15 10:14:51,396 - ***** Epoch: 7: Eval results *****
2024-05-15 10:14:51,396 -   binary_train_loss = 0.6635
2024-05-15 10:14:51,396 -   binary_eval_score = 0.7921
2024-05-15 10:14:51,396 -   train_loss = 0.1197
2024-05-15 10:14:51,396 -   eval_score = 0.7011
2024-05-15 10:14:51,396 -   best_eval_score = 0.7124
2024-05-15 10:14:51,396 - EarlyStopping counter: 1 out of 5
2024-05-15 10:15:10,700 - ***** Epoch: 8: Eval results *****
2024-05-15 10:15:10,701 -   binary_train_loss = 0.6572
2024-05-15 10:15:10,701 -   binary_eval_score = 0.7888
2024-05-15 10:15:10,701 -   train_loss = 0.0656
2024-05-15 10:15:10,701 -   eval_score = 0.7101
2024-05-15 10:15:10,701 -   best_eval_score = 0.7124
2024-05-15 10:15:10,701 - EarlyStopping counter: 2 out of 5
2024-05-15 10:15:29,220 - ***** Epoch: 9: Eval results *****
2024-05-15 10:15:29,220 -   binary_train_loss = 0.6469
2024-05-15 10:15:29,220 -   binary_eval_score = 0.7955
2024-05-15 10:15:29,220 -   train_loss = 0.054
2024-05-15 10:15:29,220 -   eval_score = 0.7213
2024-05-15 10:15:29,220 -   best_eval_score = 0.7124
2024-05-15 10:15:47,985 - ***** Epoch: 10: Eval results *****
2024-05-15 10:15:47,985 -   binary_train_loss = 0.6429
2024-05-15 10:15:47,985 -   binary_eval_score = 0.7618
2024-05-15 10:15:47,985 -   train_loss = 0.0479
2024-05-15 10:15:47,985 -   eval_score = 0.7101
2024-05-15 10:15:47,985 -   best_eval_score = 0.7213
2024-05-15 10:15:47,986 - EarlyStopping counter: 1 out of 5
2024-05-15 10:16:06,591 - ***** Epoch: 11: Eval results *****
2024-05-15 10:16:06,591 -   binary_train_loss = 0.6388
2024-05-15 10:16:06,591 -   binary_eval_score = 0.8
2024-05-15 10:16:06,592 -   train_loss = 0.0424
2024-05-15 10:16:06,592 -   eval_score = 0.7079
2024-05-15 10:16:06,592 -   best_eval_score = 0.7213
2024-05-15 10:16:06,592 - EarlyStopping counter: 2 out of 5
2024-05-15 10:16:24,729 - ***** Epoch: 12: Eval results *****
2024-05-15 10:16:24,730 -   binary_train_loss = 0.6371
2024-05-15 10:16:24,730 -   binary_eval_score = 0.8303
2024-05-15 10:16:24,730 -   train_loss = 0.0397
2024-05-15 10:16:24,730 -   eval_score = 0.7124
2024-05-15 10:16:24,730 -   best_eval_score = 0.7213
2024-05-15 10:16:24,730 - EarlyStopping counter: 3 out of 5
2024-05-15 10:16:43,621 - ***** Epoch: 13: Eval results *****
2024-05-15 10:16:43,621 -   binary_train_loss = 0.6266
2024-05-15 10:16:43,621 -   binary_eval_score = 0.8382
2024-05-15 10:16:43,621 -   train_loss = 0.038
2024-05-15 10:16:43,621 -   eval_score = 0.7191
2024-05-15 10:16:43,621 -   best_eval_score = 0.7213
2024-05-15 10:16:43,621 - EarlyStopping counter: 4 out of 5
2024-05-15 10:17:02,004 - ***** Epoch: 14: Eval results *****
2024-05-15 10:17:02,004 -   binary_train_loss = 0.6195
2024-05-15 10:17:02,004 -   binary_eval_score = 0.8382
2024-05-15 10:17:02,004 -   train_loss = 0.0383
2024-05-15 10:17:02,004 -   eval_score = 0.7236
2024-05-15 10:17:02,004 -   best_eval_score = 0.7213
2024-05-15 10:17:20,802 - ***** Epoch: 15: Eval results *****
2024-05-15 10:17:20,802 -   binary_train_loss = 0.6237
2024-05-15 10:17:20,802 -   binary_eval_score = 0.8371
2024-05-15 10:17:20,802 -   train_loss = 0.0363
2024-05-15 10:17:20,802 -   eval_score = 0.7124
2024-05-15 10:17:20,802 -   best_eval_score = 0.7236
2024-05-15 10:17:20,802 - EarlyStopping counter: 1 out of 5
2024-05-15 10:17:40,111 - ***** Epoch: 16: Eval results *****
2024-05-15 10:17:40,111 -   binary_train_loss = 0.6157
2024-05-15 10:17:40,111 -   binary_eval_score = 0.8393
2024-05-15 10:17:40,111 -   train_loss = 0.0376
2024-05-15 10:17:40,111 -   eval_score = 0.7169
2024-05-15 10:17:40,111 -   best_eval_score = 0.7236
2024-05-15 10:17:40,111 - EarlyStopping counter: 2 out of 5
2024-05-15 10:17:58,965 - ***** Epoch: 17: Eval results *****
2024-05-15 10:17:58,966 -   binary_train_loss = 0.6098
2024-05-15 10:17:58,966 -   binary_eval_score = 0.8551
2024-05-15 10:17:58,966 -   train_loss = 0.0362
2024-05-15 10:17:58,966 -   eval_score = 0.7213
2024-05-15 10:17:58,966 -   best_eval_score = 0.7236
2024-05-15 10:17:58,966 - EarlyStopping counter: 3 out of 5
2024-05-15 10:18:18,449 - ***** Epoch: 18: Eval results *****
2024-05-15 10:18:18,450 -   binary_train_loss = 0.6108
2024-05-15 10:18:18,450 -   binary_eval_score = 0.8629
2024-05-15 10:18:18,450 -   train_loss = 0.0351
2024-05-15 10:18:18,450 -   eval_score = 0.7146
2024-05-15 10:18:18,450 -   best_eval_score = 0.7236
2024-05-15 10:18:18,450 - EarlyStopping counter: 4 out of 5
2024-05-15 10:18:37,348 - ***** Epoch: 19: Eval results *****
2024-05-15 10:18:37,348 -   binary_train_loss = 0.6025
2024-05-15 10:18:37,349 -   binary_eval_score = 0.8629
2024-05-15 10:18:37,349 -   train_loss = 0.0378
2024-05-15 10:18:37,349 -   eval_score = 0.7236
2024-05-15 10:18:37,349 -   best_eval_score = 0.7236
2024-05-15 10:18:37,349 - EarlyStopping counter: 5 out of 5
2024-05-15 10:18:37,349 - EarlyStopping at epoch 19
2024-05-15 10:18:37,351 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/msz_MIntRec_bert-base-uncased_multi-class_0/models
2024-05-15 10:18:38,604 - Training is finished...
2024-05-15 10:18:38,604 - Testing begins...
2024-05-15 10:18:51,016 - ***** Out-of-domain Evaluation results *****
2024-05-15 10:18:51,017 -   aupr_in = 0.7276
2024-05-15 10:18:51,017 -   aupr_out = 0.7214
2024-05-15 10:18:51,017 -   auroc = 0.7444
2024-05-15 10:18:51,017 -   der = 0.3983
2024-05-15 10:18:51,017 -   eer = 0.3133
2024-05-15 10:18:51,017 -   fpr95 = 0.7511
2024-05-15 10:18:51,017 - Testing is finished...
2024-05-15 10:18:51,017 - Multimodal intent recognition is finished...
2024-05-15 10:18:51,017 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-15 10:18:51,205 - ============================== Params ==============================
2024-05-15 10:18:51,205 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-15 10:18:51,205 - dataset: MIntRec
2024-05-15 10:18:51,205 - ood_dataset: MIntRec-OOD
2024-05-15 10:18:51,205 - data_mode: multi-class
2024-05-15 10:18:51,205 - multimodal_method: msz
2024-05-15 10:18:51,205 - method: msz
2024-05-15 10:18:51,205 - ood_detection_method: ma
2024-05-15 10:18:51,205 - text_backbone: bert-base-uncased
2024-05-15 10:18:51,205 - seed: 1
2024-05-15 10:18:51,205 - num_workers: 8
2024-05-15 10:18:51,205 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-15-10-12-26
2024-05-15 10:18:51,205 - gpu_id: 0
2024-05-15 10:18:51,205 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-15 10:18:51,205 - train: True
2024-05-15 10:18:51,205 - tune: True
2024-05-15 10:18:51,205 - ood: True
2024-05-15 10:18:51,205 - save_model: True
2024-05-15 10:18:51,205 - save_results: True
2024-05-15 10:18:51,205 - log_path: logs
2024-05-15 10:18:51,206 - cache_path: cache
2024-05-15 10:18:51,206 - video_data_path: video_data
2024-05-15 10:18:51,206 - audio_data_path: audio_data
2024-05-15 10:18:51,206 - video_feats_path: swin_feats.pkl
2024-05-15 10:18:51,206 - ood_video_feats_path: swin_feats.pkl
2024-05-15 10:18:51,206 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-15 10:18:51,206 - audio_feats_path: wavlm_feats.pkl
2024-05-15 10:18:51,206 - results_path: results
2024-05-15 10:18:51,206 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz
2024-05-15 10:18:51,206 - model_path: models
2024-05-15 10:18:51,206 - config_file_name: msz_MIntRec
2024-05-15 10:18:51,206 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-15 10:18:51,206 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-15 10:18:51,206 - text_seq_len: 30
2024-05-15 10:18:51,206 - video_seq_len: 230
2024-05-15 10:18:51,206 - audio_seq_len: 480
2024-05-15 10:18:51,206 - text_feat_dim: 768
2024-05-15 10:18:51,206 - video_feat_dim: 1024
2024-05-15 10:18:51,206 - audio_feat_dim: 768
2024-05-15 10:18:51,206 - ood_label_id: 20
2024-05-15 10:18:51,206 - num_labels: 20
2024-05-15 10:18:51,206 - num_train_examples: 1334
2024-05-15 10:18:51,206 - need_aligned: True
2024-05-15 10:18:51,206 - freeze_parameters: False
2024-05-15 10:18:51,206 - eval_monitor: acc
2024-05-15 10:18:51,206 - train_batch_size: 32
2024-05-15 10:18:51,206 - eval_batch_size: 16
2024-05-15 10:18:51,206 - num_train_epochs: 100
2024-05-15 10:18:51,206 - lr: [2e-05]
2024-05-15 10:18:51,206 - weight_decay: [0.1]
2024-05-15 10:18:51,206 - wait_patience: 5
2024-05-15 10:18:51,206 - warmup_proportion: [0.01]
2024-05-15 10:18:51,206 - hidden_dims: [768]
2024-05-15 10:18:51,206 - num_attention_heads: [8]
2024-05-15 10:18:51,206 - attention_probs_dropout_prob: [0.3]
2024-05-15 10:18:51,206 - hidden_dropout_prob: [0.2]
2024-05-15 10:18:51,206 - intermediate_size: [768]
2024-05-15 10:18:51,206 - num_hidden_layers: [4]
2024-05-15 10:18:51,206 - max_position_embeddings: [900]
2024-05-15 10:18:51,207 - position_embedding_type: absolute
2024-05-15 10:18:51,207 - batch_first: True
2024-05-15 10:18:51,207 - aligned_method: ['ctc']
2024-05-15 10:18:51,207 - sampler: beta
2024-05-15 10:18:51,207 - multiple_ood: [1]
2024-05-15 10:18:51,207 - select_number_min: [2]
2024-05-15 10:18:51,207 - select_number_max: [3]
2024-05-15 10:18:51,207 - alpha: [4]
2024-05-15 10:18:51,207 - mlp_hidden_size: [256]
2024-05-15 10:18:51,207 - mlp_dropout: [0.3]
2024-05-15 10:18:51,207 - scale: [8]
2024-05-15 10:18:51,207 - ablation: ['no_fusion_add']
2024-05-15 10:18:51,207 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/msz_MIntRec_bert-base-uncased_multi-class_1
2024-05-15 10:18:51,207 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-15 10:18:51,207 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/binary_msz_MIntRec_bert-base-uncased_1
2024-05-15 10:18:51,207 - device: cuda
2024-05-15 10:18:51,207 - ============================== End Params ==============================
2024-05-15 10:18:52,877 - Multimodal Intent Recognition begins...
2024-05-15 10:18:52,877 - Training begins...
2024-05-15 10:19:12,128 - ***** Epoch: 1: Eval results *****
2024-05-15 10:19:12,128 -   binary_train_loss = 0.7116
2024-05-15 10:19:12,128 -   binary_eval_score = 0.4933
2024-05-15 10:19:12,128 -   train_loss = 2.8557
2024-05-15 10:19:12,128 -   eval_score = 0.1461
2024-05-15 10:19:12,128 -   best_eval_score = 0.0
2024-05-15 10:19:30,717 - ***** Epoch: 2: Eval results *****
2024-05-15 10:19:30,717 -   binary_train_loss = 0.7013
2024-05-15 10:19:30,717 -   binary_eval_score = 0.5022
2024-05-15 10:19:30,717 -   train_loss = 2.5559
2024-05-15 10:19:30,717 -   eval_score = 0.4629
2024-05-15 10:19:30,717 -   best_eval_score = 0.1461
2024-05-15 10:19:50,530 - ***** Epoch: 3: Eval results *****
2024-05-15 10:19:50,531 -   binary_train_loss = 0.69
2024-05-15 10:19:50,531 -   binary_eval_score = 0.5989
2024-05-15 10:19:50,531 -   train_loss = 1.4564
2024-05-15 10:19:50,531 -   eval_score = 0.7034
2024-05-15 10:19:50,531 -   best_eval_score = 0.4629
2024-05-15 10:20:10,425 - ***** Epoch: 4: Eval results *****
2024-05-15 10:20:10,425 -   binary_train_loss = 0.6811
2024-05-15 10:20:10,425 -   binary_eval_score = 0.6764
2024-05-15 10:20:10,425 -   train_loss = 0.6087
2024-05-15 10:20:10,425 -   eval_score = 0.6966
2024-05-15 10:20:10,425 -   best_eval_score = 0.7034
2024-05-15 10:20:10,425 - EarlyStopping counter: 1 out of 5
2024-05-15 10:20:30,379 - ***** Epoch: 5: Eval results *****
2024-05-15 10:20:30,379 -   binary_train_loss = 0.6795
2024-05-15 10:20:30,379 -   binary_eval_score = 0.7438
2024-05-15 10:20:30,379 -   train_loss = 0.3347
2024-05-15 10:20:30,379 -   eval_score = 0.7034
2024-05-15 10:20:30,379 -   best_eval_score = 0.7034
2024-05-15 10:20:30,379 - EarlyStopping counter: 2 out of 5
2024-05-15 10:20:48,856 - ***** Epoch: 6: Eval results *****
2024-05-15 10:20:48,856 -   binary_train_loss = 0.6748
2024-05-15 10:20:48,856 -   binary_eval_score = 0.7281
2024-05-15 10:20:48,856 -   train_loss = 0.1899
2024-05-15 10:20:48,856 -   eval_score = 0.7124
2024-05-15 10:20:48,856 -   best_eval_score = 0.7034
2024-05-15 10:21:09,826 - ***** Epoch: 7: Eval results *****
2024-05-15 10:21:09,826 -   binary_train_loss = 0.6679
2024-05-15 10:21:09,826 -   binary_eval_score = 0.7494
2024-05-15 10:21:09,827 -   train_loss = 0.1042
2024-05-15 10:21:09,827 -   eval_score = 0.7213
2024-05-15 10:21:09,827 -   best_eval_score = 0.7124
2024-05-15 10:21:30,919 - ***** Epoch: 8: Eval results *****
2024-05-15 10:21:30,919 -   binary_train_loss = 0.6611
2024-05-15 10:21:30,919 -   binary_eval_score = 0.7843
2024-05-15 10:21:30,920 -   train_loss = 0.0678
2024-05-15 10:21:30,920 -   eval_score = 0.7236
2024-05-15 10:21:30,920 -   best_eval_score = 0.7213
2024-05-15 10:21:50,277 - ***** Epoch: 9: Eval results *****
2024-05-15 10:21:50,278 -   binary_train_loss = 0.6593
2024-05-15 10:21:50,278 -   binary_eval_score = 0.7461
2024-05-15 10:21:50,278 -   train_loss = 0.0564
2024-05-15 10:21:50,278 -   eval_score = 0.7236
2024-05-15 10:21:50,278 -   best_eval_score = 0.7236
2024-05-15 10:21:50,278 - EarlyStopping counter: 1 out of 5
2024-05-15 10:22:09,421 - ***** Epoch: 10: Eval results *****
2024-05-15 10:22:09,422 -   binary_train_loss = 0.6523
2024-05-15 10:22:09,422 -   binary_eval_score = 0.7652
2024-05-15 10:22:09,422 -   train_loss = 0.0481
2024-05-15 10:22:09,422 -   eval_score = 0.7213
2024-05-15 10:22:09,422 -   best_eval_score = 0.7236
2024-05-15 10:22:09,422 - EarlyStopping counter: 2 out of 5
2024-05-15 10:22:28,828 - ***** Epoch: 11: Eval results *****
2024-05-15 10:22:28,828 -   binary_train_loss = 0.6475
2024-05-15 10:22:28,828 -   binary_eval_score = 0.791
2024-05-15 10:22:28,828 -   train_loss = 0.0426
2024-05-15 10:22:28,828 -   eval_score = 0.7169
2024-05-15 10:22:28,828 -   best_eval_score = 0.7236
2024-05-15 10:22:28,828 - EarlyStopping counter: 3 out of 5
2024-05-15 10:22:49,824 - ***** Epoch: 12: Eval results *****
2024-05-15 10:22:49,824 -   binary_train_loss = 0.6409
2024-05-15 10:22:49,824 -   binary_eval_score = 0.7551
2024-05-15 10:22:49,824 -   train_loss = 0.0423
2024-05-15 10:22:49,824 -   eval_score = 0.7101
2024-05-15 10:22:49,824 -   best_eval_score = 0.7236
2024-05-15 10:22:49,824 - EarlyStopping counter: 4 out of 5
2024-05-15 10:23:08,877 - ***** Epoch: 13: Eval results *****
2024-05-15 10:23:08,877 -   binary_train_loss = 0.6423
2024-05-15 10:23:08,877 -   binary_eval_score = 0.7742
2024-05-15 10:23:08,877 -   train_loss = 0.0541
2024-05-15 10:23:08,877 -   eval_score = 0.7169
2024-05-15 10:23:08,877 -   best_eval_score = 0.7236
2024-05-15 10:23:08,877 - EarlyStopping counter: 5 out of 5
2024-05-15 10:23:08,877 - EarlyStopping at epoch 13
2024-05-15 10:23:08,879 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-15 10:23:10,210 - Training is finished...
2024-05-15 10:23:10,210 - Testing begins...
2024-05-15 10:23:22,295 - ***** Out-of-domain Evaluation results *****
2024-05-15 10:23:22,296 -   aupr_in = 0.7137
2024-05-15 10:23:22,296 -   aupr_out = 0.6917
2024-05-15 10:23:22,296 -   auroc = 0.7255
2024-05-15 10:23:22,296 -   der = 0.4281
2024-05-15 10:23:22,296 -   eer = 0.3422
2024-05-15 10:23:22,296 -   fpr95 = 0.8111
2024-05-15 10:23:22,296 - Testing is finished...
2024-05-15 10:23:22,296 - Multimodal intent recognition is finished...
2024-05-15 10:23:22,296 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-15 10:23:22,924 - ============================== Params ==============================
2024-05-15 10:23:22,924 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-15 10:23:22,924 - dataset: MIntRec
2024-05-15 10:23:22,924 - ood_dataset: MIntRec-OOD
2024-05-15 10:23:22,924 - data_mode: multi-class
2024-05-15 10:23:22,924 - multimodal_method: msz
2024-05-15 10:23:22,925 - method: msz
2024-05-15 10:23:22,925 - ood_detection_method: ma
2024-05-15 10:23:22,925 - text_backbone: bert-base-uncased
2024-05-15 10:23:22,925 - seed: 2
2024-05-15 10:23:22,925 - num_workers: 8
2024-05-15 10:23:22,925 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-15-10-12-26
2024-05-15 10:23:22,925 - gpu_id: 0
2024-05-15 10:23:22,925 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-15 10:23:22,925 - train: True
2024-05-15 10:23:22,925 - tune: True
2024-05-15 10:23:22,925 - ood: True
2024-05-15 10:23:22,925 - save_model: True
2024-05-15 10:23:22,925 - save_results: True
2024-05-15 10:23:22,925 - log_path: logs
2024-05-15 10:23:22,925 - cache_path: cache
2024-05-15 10:23:22,925 - video_data_path: video_data
2024-05-15 10:23:22,925 - audio_data_path: audio_data
2024-05-15 10:23:22,925 - video_feats_path: swin_feats.pkl
2024-05-15 10:23:22,925 - ood_video_feats_path: swin_feats.pkl
2024-05-15 10:23:22,925 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-15 10:23:22,925 - audio_feats_path: wavlm_feats.pkl
2024-05-15 10:23:22,925 - results_path: results
2024-05-15 10:23:22,925 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz
2024-05-15 10:23:22,925 - model_path: models
2024-05-15 10:23:22,925 - config_file_name: msz_MIntRec
2024-05-15 10:23:22,925 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-15 10:23:22,925 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-15 10:23:22,925 - text_seq_len: 30
2024-05-15 10:23:22,925 - video_seq_len: 230
2024-05-15 10:23:22,926 - audio_seq_len: 480
2024-05-15 10:23:22,926 - text_feat_dim: 768
2024-05-15 10:23:22,926 - video_feat_dim: 1024
2024-05-15 10:23:22,926 - audio_feat_dim: 768
2024-05-15 10:23:22,926 - ood_label_id: 20
2024-05-15 10:23:22,926 - num_labels: 20
2024-05-15 10:23:22,926 - num_train_examples: 1334
2024-05-15 10:23:22,926 - need_aligned: True
2024-05-15 10:23:22,926 - freeze_parameters: False
2024-05-15 10:23:22,926 - eval_monitor: acc
2024-05-15 10:23:22,926 - train_batch_size: 32
2024-05-15 10:23:22,926 - eval_batch_size: 16
2024-05-15 10:23:22,926 - num_train_epochs: 100
2024-05-15 10:23:22,926 - lr: [2e-05]
2024-05-15 10:23:22,926 - weight_decay: [0.1]
2024-05-15 10:23:22,926 - wait_patience: 5
2024-05-15 10:23:22,926 - warmup_proportion: [0.01]
2024-05-15 10:23:22,926 - hidden_dims: [768]
2024-05-15 10:23:22,926 - num_attention_heads: [8]
2024-05-15 10:23:22,926 - attention_probs_dropout_prob: [0.3]
2024-05-15 10:23:22,926 - hidden_dropout_prob: [0.2]
2024-05-15 10:23:22,926 - intermediate_size: [768]
2024-05-15 10:23:22,926 - num_hidden_layers: [4]
2024-05-15 10:23:22,926 - max_position_embeddings: [900]
2024-05-15 10:23:22,926 - position_embedding_type: absolute
2024-05-15 10:23:22,926 - batch_first: True
2024-05-15 10:23:22,926 - aligned_method: ['ctc']
2024-05-15 10:23:22,927 - sampler: beta
2024-05-15 10:23:22,927 - multiple_ood: [1]
2024-05-15 10:23:22,927 - select_number_min: [2]
2024-05-15 10:23:22,927 - select_number_max: [3]
2024-05-15 10:23:22,927 - alpha: [4]
2024-05-15 10:23:22,927 - mlp_hidden_size: [256]
2024-05-15 10:23:22,927 - mlp_dropout: [0.3]
2024-05-15 10:23:22,927 - scale: [8]
2024-05-15 10:23:22,927 - ablation: ['no_fusion_add']
2024-05-15 10:23:22,927 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/msz_MIntRec_bert-base-uncased_multi-class_2
2024-05-15 10:23:22,927 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-15 10:23:22,927 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/binary_msz_MIntRec_bert-base-uncased_2
2024-05-15 10:23:22,927 - device: cuda
2024-05-15 10:23:22,927 - ============================== End Params ==============================
2024-05-15 10:23:24,699 - Multimodal Intent Recognition begins...
2024-05-15 10:23:24,700 - Training begins...
2024-05-15 10:23:46,335 - ***** Epoch: 1: Eval results *****
2024-05-15 10:23:46,335 -   binary_train_loss = 0.7035
2024-05-15 10:23:46,335 -   binary_eval_score = 0.4607
2024-05-15 10:23:46,335 -   train_loss = 2.8603
2024-05-15 10:23:46,335 -   eval_score = 0.1303
2024-05-15 10:23:46,335 -   best_eval_score = 0.0
2024-05-15 10:24:06,939 - ***** Epoch: 2: Eval results *****
2024-05-15 10:24:06,939 -   binary_train_loss = 0.6958
2024-05-15 10:24:06,939 -   binary_eval_score = 0.4899
2024-05-15 10:24:06,939 -   train_loss = 2.5872
2024-05-15 10:24:06,939 -   eval_score = 0.4315
2024-05-15 10:24:06,939 -   best_eval_score = 0.1303
2024-05-15 10:24:26,143 - ***** Epoch: 3: Eval results *****
2024-05-15 10:24:26,143 -   binary_train_loss = 0.6928
2024-05-15 10:24:26,143 -   binary_eval_score = 0.6506
2024-05-15 10:24:26,143 -   train_loss = 1.6097
2024-05-15 10:24:26,143 -   eval_score = 0.6719
2024-05-15 10:24:26,143 -   best_eval_score = 0.4315
2024-05-15 10:24:46,479 - ***** Epoch: 4: Eval results *****
2024-05-15 10:24:46,480 -   binary_train_loss = 0.6815
2024-05-15 10:24:46,480 -   binary_eval_score = 0.7
2024-05-15 10:24:46,480 -   train_loss = 0.8072
2024-05-15 10:24:46,480 -   eval_score = 0.7101
2024-05-15 10:24:46,480 -   best_eval_score = 0.6719
2024-05-15 10:25:06,732 - ***** Epoch: 5: Eval results *****
2024-05-15 10:25:06,732 -   binary_train_loss = 0.6759
2024-05-15 10:25:06,732 -   binary_eval_score = 0.7528
2024-05-15 10:25:06,732 -   train_loss = 0.4019
2024-05-15 10:25:06,732 -   eval_score = 0.6966
2024-05-15 10:25:06,732 -   best_eval_score = 0.7101
2024-05-15 10:25:06,733 - EarlyStopping counter: 1 out of 5
2024-05-15 10:25:26,417 - ***** Epoch: 6: Eval results *****
2024-05-15 10:25:26,417 -   binary_train_loss = 0.6728
2024-05-15 10:25:26,417 -   binary_eval_score = 0.7281
2024-05-15 10:25:26,417 -   train_loss = 0.2007
2024-05-15 10:25:26,417 -   eval_score = 0.7258
2024-05-15 10:25:26,417 -   best_eval_score = 0.7101
2024-05-15 10:25:45,297 - ***** Epoch: 7: Eval results *****
2024-05-15 10:25:45,298 -   binary_train_loss = 0.664
2024-05-15 10:25:45,298 -   binary_eval_score = 0.7798
2024-05-15 10:25:45,298 -   train_loss = 0.1113
2024-05-15 10:25:45,298 -   eval_score = 0.7213
2024-05-15 10:25:45,298 -   best_eval_score = 0.7258
2024-05-15 10:25:45,298 - EarlyStopping counter: 1 out of 5
2024-05-15 10:26:04,583 - ***** Epoch: 8: Eval results *****
2024-05-15 10:26:04,583 -   binary_train_loss = 0.6602
2024-05-15 10:26:04,583 -   binary_eval_score = 0.7742
2024-05-15 10:26:04,583 -   train_loss = 0.0819
2024-05-15 10:26:04,583 -   eval_score = 0.7281
2024-05-15 10:26:04,583 -   best_eval_score = 0.7258
2024-05-15 10:26:23,853 - ***** Epoch: 9: Eval results *****
2024-05-15 10:26:23,854 -   binary_train_loss = 0.6531
2024-05-15 10:26:23,854 -   binary_eval_score = 0.7787
2024-05-15 10:26:23,854 -   train_loss = 0.0608
2024-05-15 10:26:23,854 -   eval_score = 0.7281
2024-05-15 10:26:23,854 -   best_eval_score = 0.7281
2024-05-15 10:26:23,854 - EarlyStopping counter: 1 out of 5
2024-05-15 10:26:43,292 - ***** Epoch: 10: Eval results *****
2024-05-15 10:26:43,292 -   binary_train_loss = 0.6461
2024-05-15 10:26:43,292 -   binary_eval_score = 0.7562
2024-05-15 10:26:43,292 -   train_loss = 0.0474
2024-05-15 10:26:43,292 -   eval_score = 0.7326
2024-05-15 10:26:43,292 -   best_eval_score = 0.7281
2024-05-15 10:27:03,394 - ***** Epoch: 11: Eval results *****
2024-05-15 10:27:03,395 -   binary_train_loss = 0.6391
2024-05-15 10:27:03,395 -   binary_eval_score = 0.7876
2024-05-15 10:27:03,395 -   train_loss = 0.043
2024-05-15 10:27:03,395 -   eval_score = 0.7303
2024-05-15 10:27:03,395 -   best_eval_score = 0.7326
2024-05-15 10:27:03,395 - EarlyStopping counter: 1 out of 5
2024-05-15 10:27:22,509 - ***** Epoch: 12: Eval results *****
2024-05-15 10:27:22,510 -   binary_train_loss = 0.6345
2024-05-15 10:27:22,510 -   binary_eval_score = 0.8404
2024-05-15 10:27:22,510 -   train_loss = 0.0403
2024-05-15 10:27:22,510 -   eval_score = 0.7303
2024-05-15 10:27:22,510 -   best_eval_score = 0.7326
2024-05-15 10:27:22,510 - EarlyStopping counter: 2 out of 5
2024-05-15 10:27:43,428 - ***** Epoch: 13: Eval results *****
2024-05-15 10:27:43,428 -   binary_train_loss = 0.6278
2024-05-15 10:27:43,428 -   binary_eval_score = 0.8337
2024-05-15 10:27:43,428 -   train_loss = 0.0374
2024-05-15 10:27:43,428 -   eval_score = 0.7258
2024-05-15 10:27:43,428 -   best_eval_score = 0.7326
2024-05-15 10:27:43,428 - EarlyStopping counter: 3 out of 5
2024-05-15 10:28:02,230 - ***** Epoch: 14: Eval results *****
2024-05-15 10:28:02,230 -   binary_train_loss = 0.6255
2024-05-15 10:28:02,230 -   binary_eval_score = 0.827
2024-05-15 10:28:02,230 -   train_loss = 0.038
2024-05-15 10:28:02,231 -   eval_score = 0.7191
2024-05-15 10:28:02,231 -   best_eval_score = 0.7326
2024-05-15 10:28:02,231 - EarlyStopping counter: 4 out of 5
2024-05-15 10:28:21,172 - ***** Epoch: 15: Eval results *****
2024-05-15 10:28:21,173 -   binary_train_loss = 0.6193
2024-05-15 10:28:21,173 -   binary_eval_score = 0.8157
2024-05-15 10:28:21,173 -   train_loss = 0.0379
2024-05-15 10:28:21,173 -   eval_score = 0.7213
2024-05-15 10:28:21,173 -   best_eval_score = 0.7326
2024-05-15 10:28:21,173 - EarlyStopping counter: 5 out of 5
2024-05-15 10:28:21,173 - EarlyStopping at epoch 15
2024-05-15 10:28:21,176 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-15 10:28:22,196 - Training is finished...
2024-05-15 10:28:22,197 - Testing begins...
2024-05-15 10:28:35,468 - ***** Out-of-domain Evaluation results *****
2024-05-15 10:28:35,468 -   aupr_in = 0.7291
2024-05-15 10:28:35,468 -   aupr_out = 0.7308
2024-05-15 10:28:35,469 -   auroc = 0.743
2024-05-15 10:28:35,469 -   der = 0.3961
2024-05-15 10:28:35,469 -   eer = 0.3244
2024-05-15 10:28:35,469 -   fpr95 = 0.7467
2024-05-15 10:28:35,469 - Testing is finished...
2024-05-15 10:28:35,469 - Multimodal intent recognition is finished...
2024-05-15 10:28:35,469 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-15 10:28:35,741 - ============================== Params ==============================
2024-05-15 10:28:35,741 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-15 10:28:35,741 - dataset: MIntRec
2024-05-15 10:28:35,741 - ood_dataset: MIntRec-OOD
2024-05-15 10:28:35,741 - data_mode: multi-class
2024-05-15 10:28:35,742 - multimodal_method: msz
2024-05-15 10:28:35,742 - method: msz
2024-05-15 10:28:35,742 - ood_detection_method: ma
2024-05-15 10:28:35,742 - text_backbone: bert-base-uncased
2024-05-15 10:28:35,742 - seed: 3
2024-05-15 10:28:35,742 - num_workers: 8
2024-05-15 10:28:35,742 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-15-10-12-26
2024-05-15 10:28:35,742 - gpu_id: 0
2024-05-15 10:28:35,742 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-15 10:28:35,742 - train: True
2024-05-15 10:28:35,742 - tune: True
2024-05-15 10:28:35,742 - ood: True
2024-05-15 10:28:35,742 - save_model: True
2024-05-15 10:28:35,742 - save_results: True
2024-05-15 10:28:35,742 - log_path: logs
2024-05-15 10:28:35,742 - cache_path: cache
2024-05-15 10:28:35,742 - video_data_path: video_data
2024-05-15 10:28:35,742 - audio_data_path: audio_data
2024-05-15 10:28:35,742 - video_feats_path: swin_feats.pkl
2024-05-15 10:28:35,742 - ood_video_feats_path: swin_feats.pkl
2024-05-15 10:28:35,742 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-15 10:28:35,742 - audio_feats_path: wavlm_feats.pkl
2024-05-15 10:28:35,742 - results_path: results
2024-05-15 10:28:35,742 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz
2024-05-15 10:28:35,742 - model_path: models
2024-05-15 10:28:35,742 - config_file_name: msz_MIntRec
2024-05-15 10:28:35,742 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-15 10:28:35,742 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-15 10:28:35,743 - text_seq_len: 30
2024-05-15 10:28:35,743 - video_seq_len: 230
2024-05-15 10:28:35,743 - audio_seq_len: 480
2024-05-15 10:28:35,743 - text_feat_dim: 768
2024-05-15 10:28:35,743 - video_feat_dim: 1024
2024-05-15 10:28:35,743 - audio_feat_dim: 768
2024-05-15 10:28:35,743 - ood_label_id: 20
2024-05-15 10:28:35,743 - num_labels: 20
2024-05-15 10:28:35,743 - num_train_examples: 1334
2024-05-15 10:28:35,743 - need_aligned: True
2024-05-15 10:28:35,743 - freeze_parameters: False
2024-05-15 10:28:35,743 - eval_monitor: acc
2024-05-15 10:28:35,743 - train_batch_size: 32
2024-05-15 10:28:35,743 - eval_batch_size: 16
2024-05-15 10:28:35,743 - num_train_epochs: 100
2024-05-15 10:28:35,743 - lr: [2e-05]
2024-05-15 10:28:35,743 - weight_decay: [0.1]
2024-05-15 10:28:35,743 - wait_patience: 5
2024-05-15 10:28:35,743 - warmup_proportion: [0.01]
2024-05-15 10:28:35,743 - hidden_dims: [768]
2024-05-15 10:28:35,743 - num_attention_heads: [8]
2024-05-15 10:28:35,743 - attention_probs_dropout_prob: [0.3]
2024-05-15 10:28:35,743 - hidden_dropout_prob: [0.2]
2024-05-15 10:28:35,743 - intermediate_size: [768]
2024-05-15 10:28:35,743 - num_hidden_layers: [4]
2024-05-15 10:28:35,743 - max_position_embeddings: [900]
2024-05-15 10:28:35,743 - position_embedding_type: absolute
2024-05-15 10:28:35,744 - batch_first: True
2024-05-15 10:28:35,744 - aligned_method: ['ctc']
2024-05-15 10:28:35,744 - sampler: beta
2024-05-15 10:28:35,744 - multiple_ood: [1]
2024-05-15 10:28:35,744 - select_number_min: [2]
2024-05-15 10:28:35,744 - select_number_max: [3]
2024-05-15 10:28:35,744 - alpha: [4]
2024-05-15 10:28:35,744 - mlp_hidden_size: [256]
2024-05-15 10:28:35,744 - mlp_dropout: [0.3]
2024-05-15 10:28:35,744 - scale: [8]
2024-05-15 10:28:35,744 - ablation: ['no_fusion_add']
2024-05-15 10:28:35,744 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/msz_MIntRec_bert-base-uncased_multi-class_3
2024-05-15 10:28:35,744 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-15 10:28:35,744 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/binary_msz_MIntRec_bert-base-uncased_3
2024-05-15 10:28:35,744 - device: cuda
2024-05-15 10:28:35,744 - ============================== End Params ==============================
2024-05-15 10:28:37,563 - Multimodal Intent Recognition begins...
2024-05-15 10:28:37,563 - Training begins...
2024-05-15 10:28:56,385 - ***** Epoch: 1: Eval results *****
2024-05-15 10:28:56,385 -   binary_train_loss = 0.7078
2024-05-15 10:28:56,385 -   binary_eval_score = 0.4809
2024-05-15 10:28:56,385 -   train_loss = 2.8547
2024-05-15 10:28:56,385 -   eval_score = 0.1461
2024-05-15 10:28:56,385 -   best_eval_score = 0.0
2024-05-15 10:29:15,359 - ***** Epoch: 2: Eval results *****
2024-05-15 10:29:15,359 -   binary_train_loss = 0.7023
2024-05-15 10:29:15,359 -   binary_eval_score = 0.4955
2024-05-15 10:29:15,359 -   train_loss = 2.5819
2024-05-15 10:29:15,359 -   eval_score = 0.4157
2024-05-15 10:29:15,359 -   best_eval_score = 0.1461
2024-05-15 10:29:34,738 - ***** Epoch: 3: Eval results *****
2024-05-15 10:29:34,738 -   binary_train_loss = 0.6907
2024-05-15 10:29:34,738 -   binary_eval_score = 0.6899
2024-05-15 10:29:34,738 -   train_loss = 1.6271
2024-05-15 10:29:34,738 -   eval_score = 0.6629
2024-05-15 10:29:34,738 -   best_eval_score = 0.4157
2024-05-15 10:29:54,566 - ***** Epoch: 4: Eval results *****
2024-05-15 10:29:54,566 -   binary_train_loss = 0.6839
2024-05-15 10:29:54,566 -   binary_eval_score = 0.6933
2024-05-15 10:29:54,566 -   train_loss = 0.7716
2024-05-15 10:29:54,566 -   eval_score = 0.7101
2024-05-15 10:29:54,566 -   best_eval_score = 0.6629
2024-05-15 10:30:13,582 - ***** Epoch: 5: Eval results *****
2024-05-15 10:30:13,582 -   binary_train_loss = 0.6808
2024-05-15 10:30:13,582 -   binary_eval_score = 0.6966
2024-05-15 10:30:13,582 -   train_loss = 0.4639
2024-05-15 10:30:13,582 -   eval_score = 0.7393
2024-05-15 10:30:13,582 -   best_eval_score = 0.7101
2024-05-15 10:30:33,535 - ***** Epoch: 6: Eval results *****
2024-05-15 10:30:33,535 -   binary_train_loss = 0.674
2024-05-15 10:30:33,536 -   binary_eval_score = 0.7449
2024-05-15 10:30:33,536 -   train_loss = 0.2261
2024-05-15 10:30:33,536 -   eval_score = 0.7213
2024-05-15 10:30:33,536 -   best_eval_score = 0.7393
2024-05-15 10:30:33,536 - EarlyStopping counter: 1 out of 5
2024-05-15 10:30:52,808 - ***** Epoch: 7: Eval results *****
2024-05-15 10:30:52,808 -   binary_train_loss = 0.6703
2024-05-15 10:30:52,808 -   binary_eval_score = 0.7494
2024-05-15 10:30:52,808 -   train_loss = 0.13
2024-05-15 10:30:52,808 -   eval_score = 0.7101
2024-05-15 10:30:52,808 -   best_eval_score = 0.7393
2024-05-15 10:30:52,808 - EarlyStopping counter: 2 out of 5
2024-05-15 10:31:12,413 - ***** Epoch: 8: Eval results *****
2024-05-15 10:31:12,414 -   binary_train_loss = 0.6638
2024-05-15 10:31:12,414 -   binary_eval_score = 0.7955
2024-05-15 10:31:12,414 -   train_loss = 0.0902
2024-05-15 10:31:12,414 -   eval_score = 0.7191
2024-05-15 10:31:12,414 -   best_eval_score = 0.7393
2024-05-15 10:31:12,414 - EarlyStopping counter: 3 out of 5
2024-05-15 10:31:32,111 - ***** Epoch: 9: Eval results *****
2024-05-15 10:31:32,112 -   binary_train_loss = 0.6585
2024-05-15 10:31:32,112 -   binary_eval_score = 0.7888
2024-05-15 10:31:32,112 -   train_loss = 0.0561
2024-05-15 10:31:32,112 -   eval_score = 0.7258
2024-05-15 10:31:32,112 -   best_eval_score = 0.7393
2024-05-15 10:31:32,112 - EarlyStopping counter: 4 out of 5
2024-05-15 10:31:51,272 - ***** Epoch: 10: Eval results *****
2024-05-15 10:31:51,273 -   binary_train_loss = 0.6527
2024-05-15 10:31:51,273 -   binary_eval_score = 0.8011
2024-05-15 10:31:51,273 -   train_loss = 0.0472
2024-05-15 10:31:51,273 -   eval_score = 0.7236
2024-05-15 10:31:51,273 -   best_eval_score = 0.7393
2024-05-15 10:31:51,273 - EarlyStopping counter: 5 out of 5
2024-05-15 10:31:51,273 - EarlyStopping at epoch 10
2024-05-15 10:31:51,274 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-15 10:31:52,502 - Training is finished...
2024-05-15 10:31:52,503 - Testing begins...
2024-05-15 10:32:05,370 - ***** Out-of-domain Evaluation results *****
2024-05-15 10:32:05,371 -   aupr_in = 0.714
2024-05-15 10:32:05,371 -   aupr_out = 0.694
2024-05-15 10:32:05,371 -   auroc = 0.7189
2024-05-15 10:32:05,371 -   der = 0.416
2024-05-15 10:32:05,371 -   eer = 0.3467
2024-05-15 10:32:05,371 -   fpr95 = 0.7867
2024-05-15 10:32:05,372 - Testing is finished...
2024-05-15 10:32:05,372 - Multimodal intent recognition is finished...
2024-05-15 10:32:05,372 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-15 10:32:05,910 - ============================== Params ==============================
2024-05-15 10:32:05,910 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-15 10:32:05,910 - dataset: MIntRec
2024-05-15 10:32:05,910 - ood_dataset: MIntRec-OOD
2024-05-15 10:32:05,910 - data_mode: multi-class
2024-05-15 10:32:05,910 - multimodal_method: msz
2024-05-15 10:32:05,910 - method: msz
2024-05-15 10:32:05,910 - ood_detection_method: ma
2024-05-15 10:32:05,910 - text_backbone: bert-base-uncased
2024-05-15 10:32:05,910 - seed: 4
2024-05-15 10:32:05,910 - num_workers: 8
2024-05-15 10:32:05,910 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-15-10-12-26
2024-05-15 10:32:05,910 - gpu_id: 0
2024-05-15 10:32:05,911 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-15 10:32:05,911 - train: True
2024-05-15 10:32:05,911 - tune: True
2024-05-15 10:32:05,911 - ood: True
2024-05-15 10:32:05,911 - save_model: True
2024-05-15 10:32:05,911 - save_results: True
2024-05-15 10:32:05,911 - log_path: logs
2024-05-15 10:32:05,911 - cache_path: cache
2024-05-15 10:32:05,911 - video_data_path: video_data
2024-05-15 10:32:05,911 - audio_data_path: audio_data
2024-05-15 10:32:05,911 - video_feats_path: swin_feats.pkl
2024-05-15 10:32:05,911 - ood_video_feats_path: swin_feats.pkl
2024-05-15 10:32:05,911 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-15 10:32:05,911 - audio_feats_path: wavlm_feats.pkl
2024-05-15 10:32:05,911 - results_path: results
2024-05-15 10:32:05,911 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz
2024-05-15 10:32:05,911 - model_path: models
2024-05-15 10:32:05,911 - config_file_name: msz_MIntRec
2024-05-15 10:32:05,911 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-15 10:32:05,911 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-15 10:32:05,911 - text_seq_len: 30
2024-05-15 10:32:05,911 - video_seq_len: 230
2024-05-15 10:32:05,911 - audio_seq_len: 480
2024-05-15 10:32:05,911 - text_feat_dim: 768
2024-05-15 10:32:05,911 - video_feat_dim: 1024
2024-05-15 10:32:05,911 - audio_feat_dim: 768
2024-05-15 10:32:05,911 - ood_label_id: 20
2024-05-15 10:32:05,911 - num_labels: 20
2024-05-15 10:32:05,911 - num_train_examples: 1334
2024-05-15 10:32:05,911 - need_aligned: True
2024-05-15 10:32:05,911 - freeze_parameters: False
2024-05-15 10:32:05,911 - eval_monitor: acc
2024-05-15 10:32:05,911 - train_batch_size: 32
2024-05-15 10:32:05,911 - eval_batch_size: 16
2024-05-15 10:32:05,911 - num_train_epochs: 100
2024-05-15 10:32:05,911 - lr: [2e-05]
2024-05-15 10:32:05,912 - weight_decay: [0.1]
2024-05-15 10:32:05,912 - wait_patience: 5
2024-05-15 10:32:05,912 - warmup_proportion: [0.01]
2024-05-15 10:32:05,912 - hidden_dims: [768]
2024-05-15 10:32:05,912 - num_attention_heads: [8]
2024-05-15 10:32:05,912 - attention_probs_dropout_prob: [0.3]
2024-05-15 10:32:05,912 - hidden_dropout_prob: [0.2]
2024-05-15 10:32:05,912 - intermediate_size: [768]
2024-05-15 10:32:05,912 - num_hidden_layers: [4]
2024-05-15 10:32:05,912 - max_position_embeddings: [900]
2024-05-15 10:32:05,912 - position_embedding_type: absolute
2024-05-15 10:32:05,912 - batch_first: True
2024-05-15 10:32:05,912 - aligned_method: ['ctc']
2024-05-15 10:32:05,912 - sampler: beta
2024-05-15 10:32:05,912 - multiple_ood: [1]
2024-05-15 10:32:05,912 - select_number_min: [2]
2024-05-15 10:32:05,912 - select_number_max: [3]
2024-05-15 10:32:05,912 - alpha: [4]
2024-05-15 10:32:05,912 - mlp_hidden_size: [256]
2024-05-15 10:32:05,912 - mlp_dropout: [0.3]
2024-05-15 10:32:05,912 - scale: [8]
2024-05-15 10:32:05,912 - ablation: ['no_fusion_add']
2024-05-15 10:32:05,912 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/msz_MIntRec_bert-base-uncased_multi-class_4
2024-05-15 10:32:05,912 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/msz_MIntRec_bert-base-uncased_multi-class_4/models
2024-05-15 10:32:05,912 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/binary_msz_MIntRec_bert-base-uncased_4
2024-05-15 10:32:05,912 - device: cuda
2024-05-15 10:32:05,912 - ============================== End Params ==============================
2024-05-15 10:32:07,921 - Multimodal Intent Recognition begins...
2024-05-15 10:32:07,921 - Training begins...
2024-05-15 10:32:26,647 - ***** Epoch: 1: Eval results *****
2024-05-15 10:32:26,647 -   binary_train_loss = 0.7054
2024-05-15 10:32:26,647 -   binary_eval_score = 0.5022
2024-05-15 10:32:26,647 -   train_loss = 2.8608
2024-05-15 10:32:26,647 -   eval_score = 0.2787
2024-05-15 10:32:26,647 -   best_eval_score = 0.0
2024-05-15 10:32:46,917 - ***** Epoch: 2: Eval results *****
2024-05-15 10:32:46,917 -   binary_train_loss = 0.6962
2024-05-15 10:32:46,917 -   binary_eval_score = 0.4663
2024-05-15 10:32:46,917 -   train_loss = 2.5309
2024-05-15 10:32:46,917 -   eval_score = 0.4697
2024-05-15 10:32:46,917 -   best_eval_score = 0.2787
2024-05-15 10:33:06,295 - ***** Epoch: 3: Eval results *****
2024-05-15 10:33:06,295 -   binary_train_loss = 0.691
2024-05-15 10:33:06,295 -   binary_eval_score = 0.6584
2024-05-15 10:33:06,295 -   train_loss = 1.4042
2024-05-15 10:33:06,295 -   eval_score = 0.6517
2024-05-15 10:33:06,295 -   best_eval_score = 0.4697
2024-05-15 10:33:25,125 - ***** Epoch: 4: Eval results *****
2024-05-15 10:33:25,125 -   binary_train_loss = 0.6855
2024-05-15 10:33:25,125 -   binary_eval_score = 0.7112
2024-05-15 10:33:25,125 -   train_loss = 0.7734
2024-05-15 10:33:25,125 -   eval_score = 0.7034
2024-05-15 10:33:25,125 -   best_eval_score = 0.6517
2024-05-15 10:33:45,226 - ***** Epoch: 5: Eval results *****
2024-05-15 10:33:45,226 -   binary_train_loss = 0.6814
2024-05-15 10:33:45,226 -   binary_eval_score = 0.7382
2024-05-15 10:33:45,226 -   train_loss = 0.3403
2024-05-15 10:33:45,226 -   eval_score = 0.7169
2024-05-15 10:33:45,226 -   best_eval_score = 0.7034
2024-05-15 10:34:04,686 - ***** Epoch: 6: Eval results *****
2024-05-15 10:34:04,686 -   binary_train_loss = 0.6737
2024-05-15 10:34:04,686 -   binary_eval_score = 0.7663
2024-05-15 10:34:04,686 -   train_loss = 0.193
2024-05-15 10:34:04,686 -   eval_score = 0.7303
2024-05-15 10:34:04,686 -   best_eval_score = 0.7169
2024-05-15 10:34:25,164 - ***** Epoch: 7: Eval results *****
2024-05-15 10:34:25,165 -   binary_train_loss = 0.6691
2024-05-15 10:34:25,165 -   binary_eval_score = 0.7719
2024-05-15 10:34:25,165 -   train_loss = 0.0956
2024-05-15 10:34:25,165 -   eval_score = 0.7191
2024-05-15 10:34:25,165 -   best_eval_score = 0.7303
2024-05-15 10:34:25,165 - EarlyStopping counter: 1 out of 5
2024-05-15 10:34:45,936 - ***** Epoch: 8: Eval results *****
2024-05-15 10:34:45,936 -   binary_train_loss = 0.6627
2024-05-15 10:34:45,936 -   binary_eval_score = 0.7753
2024-05-15 10:34:45,936 -   train_loss = 0.0627
2024-05-15 10:34:45,936 -   eval_score = 0.7146
2024-05-15 10:34:45,936 -   best_eval_score = 0.7303
2024-05-15 10:34:45,936 - EarlyStopping counter: 2 out of 5
2024-05-15 10:35:06,241 - ***** Epoch: 9: Eval results *****
2024-05-15 10:35:06,241 -   binary_train_loss = 0.6595
2024-05-15 10:35:06,241 -   binary_eval_score = 0.7831
2024-05-15 10:35:06,241 -   train_loss = 0.0497
2024-05-15 10:35:06,241 -   eval_score = 0.7213
2024-05-15 10:35:06,241 -   best_eval_score = 0.7303
2024-05-15 10:35:06,241 - EarlyStopping counter: 3 out of 5
2024-05-15 10:35:27,790 - ***** Epoch: 10: Eval results *****
2024-05-15 10:35:27,791 -   binary_train_loss = 0.6518
2024-05-15 10:35:27,791 -   binary_eval_score = 0.7775
2024-05-15 10:35:27,791 -   train_loss = 0.0404
2024-05-15 10:35:27,791 -   eval_score = 0.7124
2024-05-15 10:35:27,791 -   best_eval_score = 0.7303
2024-05-15 10:35:27,791 - EarlyStopping counter: 4 out of 5
2024-05-15 10:35:48,647 - ***** Epoch: 11: Eval results *****
2024-05-15 10:35:48,648 -   binary_train_loss = 0.6452
2024-05-15 10:35:48,648 -   binary_eval_score = 0.8202
2024-05-15 10:35:48,648 -   train_loss = 0.0397
2024-05-15 10:35:48,648 -   eval_score = 0.7236
2024-05-15 10:35:48,648 -   best_eval_score = 0.7303
2024-05-15 10:35:48,648 - EarlyStopping counter: 5 out of 5
2024-05-15 10:35:48,648 - EarlyStopping at epoch 11
2024-05-15 10:35:48,651 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/ablation/no_fusion_add_msz/msz_MIntRec_bert-base-uncased_multi-class_4/models
2024-05-15 10:35:49,558 - Training is finished...
2024-05-15 10:35:49,558 - Testing begins...
2024-05-15 10:36:01,621 - ***** Out-of-domain Evaluation results *****
2024-05-15 10:36:01,622 -   aupr_in = 0.7194
2024-05-15 10:36:01,622 -   aupr_out = 0.7004
2024-05-15 10:36:01,622 -   auroc = 0.7317
2024-05-15 10:36:01,622 -   der = 0.4237
2024-05-15 10:36:01,622 -   eer = 0.3244
2024-05-15 10:36:01,622 -   fpr95 = 0.8022
2024-05-15 10:36:01,622 - Testing is finished...
2024-05-15 10:36:01,622 - Multimodal intent recognition is finished...
2024-05-15 10:36:01,622 - Results are saved in results/results_msz_ablation_MIntRec.csv
