2024-05-18 07:59:56,824 - Lists of intent labels are: ['Complain', 'Praise', 'Apologise', 'Thank', 'Criticize', 'Agree', 'Taunt', 'Flaunt', 'Joke', 'Oppose', 'Comfort', 'Care', 'Inform', 'Advise', 'Arrange', 'Introduce', 'Leave', 'Prevent', 'Greet', 'Ask for help']
2024-05-18 07:59:56,824 - ID Data preparation...
2024-05-18 08:00:03,578 - OOD Data preparation...
2024-05-18 08:00:05,146 - ============================== Params ==============================
2024-05-18 08:00:05,146 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-18 08:00:05,146 - dataset: MIntRec
2024-05-18 08:00:05,146 - ood_dataset: MIntRec-OOD
2024-05-18 08:00:05,146 - data_mode: multi-class
2024-05-18 08:00:05,146 - multimodal_method: msz
2024-05-18 08:00:05,146 - method: msz
2024-05-18 08:00:05,146 - ood_detection_method: ma
2024-05-18 08:00:05,146 - text_backbone: bert-base-uncased
2024-05-18 08:00:05,146 - seed: 0
2024-05-18 08:00:05,146 - num_workers: 8
2024-05-18 08:00:05,146 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-18-07-59-56
2024-05-18 08:00:05,146 - gpu_id: 2
2024-05-18 08:00:05,146 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-18 08:00:05,146 - train: True
2024-05-18 08:00:05,146 - tune: True
2024-05-18 08:00:05,146 - ood: True
2024-05-18 08:00:05,146 - save_model: True
2024-05-18 08:00:05,146 - save_results: True
2024-05-18 08:00:05,146 - log_path: logs
2024-05-18 08:00:05,146 - cache_path: cache
2024-05-18 08:00:05,146 - video_data_path: video_data
2024-05-18 08:00:05,146 - audio_data_path: audio_data
2024-05-18 08:00:05,146 - video_feats_path: swin_feats.pkl
2024-05-18 08:00:05,146 - ood_video_feats_path: swin_feats.pkl
2024-05-18 08:00:05,146 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-18 08:00:05,146 - audio_feats_path: wavlm_feats.pkl
2024-05-18 08:00:05,146 - results_path: results
2024-05-18 08:00:05,146 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz
2024-05-18 08:00:05,146 - model_path: models
2024-05-18 08:00:05,146 - config_file_name: msz_MIntRec
2024-05-18 08:00:05,146 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-18 08:00:05,146 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-18 08:00:05,146 - text_seq_len: 30
2024-05-18 08:00:05,146 - video_seq_len: 230
2024-05-18 08:00:05,146 - audio_seq_len: 480
2024-05-18 08:00:05,146 - text_feat_dim: 768
2024-05-18 08:00:05,146 - video_feat_dim: 1024
2024-05-18 08:00:05,146 - audio_feat_dim: 768
2024-05-18 08:00:05,146 - ood_label_id: 20
2024-05-18 08:00:05,147 - num_labels: 20
2024-05-18 08:00:05,147 - num_train_examples: 1334
2024-05-18 08:00:05,147 - need_aligned: True
2024-05-18 08:00:05,147 - freeze_parameters: False
2024-05-18 08:00:05,147 - eval_monitor: acc
2024-05-18 08:00:05,147 - train_batch_size: 32
2024-05-18 08:00:05,147 - eval_batch_size: 16
2024-05-18 08:00:05,147 - num_train_epochs: 100
2024-05-18 08:00:05,147 - lr: [2e-05]
2024-05-18 08:00:05,147 - weight_decay: [0.1]
2024-05-18 08:00:05,147 - wait_patience: 5
2024-05-18 08:00:05,147 - warmup_proportion: [0.1]
2024-05-18 08:00:05,147 - hidden_dims: [768]
2024-05-18 08:00:05,147 - num_attention_heads: [4]
2024-05-18 08:00:05,147 - attention_probs_dropout_prob: [0.3]
2024-05-18 08:00:05,147 - hidden_dropout_prob: [0.1]
2024-05-18 08:00:05,147 - intermediate_size: [768]
2024-05-18 08:00:05,147 - num_hidden_layers: [4]
2024-05-18 08:00:05,147 - max_position_embeddings: [900]
2024-05-18 08:00:05,147 - position_embedding_type: absolute
2024-05-18 08:00:05,147 - batch_first: True
2024-05-18 08:00:05,147 - aligned_method: ['ctc']
2024-05-18 08:00:05,147 - sampler: ['dir']
2024-05-18 08:00:05,147 - multiple_ood: [1]
2024-05-18 08:00:05,147 - select_number_min: [2]
2024-05-18 08:00:05,147 - select_number_max: [3]
2024-05-18 08:00:05,147 - alpha: [4]
2024-05-18 08:00:05,147 - mlp_hidden_size: [256]
2024-05-18 08:00:05,147 - mlp_dropout: [0.3]
2024-05-18 08:00:05,147 - scale: [16]
2024-05-18 08:00:05,147 - ablation: ['no_CosClass']
2024-05-18 08:00:05,147 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_0
2024-05-18 08:00:05,147 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_0/models
2024-05-18 08:00:05,147 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/binary_msz_MIntRec_bert-base-uncased_0
2024-05-18 08:00:05,147 - ============================== End Params ==============================
2024-05-18 08:00:08,037 - Multimodal Intent Recognition begins...
2024-05-18 08:00:08,037 - Training begins...
2024-05-18 08:00:39,520 - ***** Epoch: 1: Eval results *****
2024-05-18 08:00:39,520 -   binary_train_loss = 0.6931
2024-05-18 08:00:39,521 -   binary_eval_score = 0.5
2024-05-18 08:00:39,521 -   train_loss = 2.8398
2024-05-18 08:00:39,521 -   eval_score = 0.2472
2024-05-18 08:00:39,521 -   best_eval_score = 0.0
2024-05-18 08:01:10,138 - ***** Epoch: 2: Eval results *****
2024-05-18 08:01:10,138 -   binary_train_loss = 0.6903
2024-05-18 08:01:10,138 -   binary_eval_score = 0.5034
2024-05-18 08:01:10,138 -   train_loss = 2.1692
2024-05-18 08:01:10,138 -   eval_score = 0.5775
2024-05-18 08:01:10,138 -   best_eval_score = 0.2472
2024-05-18 08:01:40,460 - ***** Epoch: 3: Eval results *****
2024-05-18 08:01:40,461 -   binary_train_loss = 0.6847
2024-05-18 08:01:40,461 -   binary_eval_score = 0.6
2024-05-18 08:01:40,461 -   train_loss = 1.1045
2024-05-18 08:01:40,461 -   eval_score = 0.7101
2024-05-18 08:01:40,461 -   best_eval_score = 0.5775
2024-05-18 08:02:11,099 - ***** Epoch: 4: Eval results *****
2024-05-18 08:02:11,099 -   binary_train_loss = 0.6707
2024-05-18 08:02:11,100 -   binary_eval_score = 0.6494
2024-05-18 08:02:11,100 -   train_loss = 0.5635
2024-05-18 08:02:11,100 -   eval_score = 0.7034
2024-05-18 08:02:11,100 -   best_eval_score = 0.7101
2024-05-18 08:02:11,100 - EarlyStopping counter: 1 out of 5
2024-05-18 08:02:41,930 - ***** Epoch: 5: Eval results *****
2024-05-18 08:02:41,930 -   binary_train_loss = 0.6449
2024-05-18 08:02:41,930 -   binary_eval_score = 0.7213
2024-05-18 08:02:41,930 -   train_loss = 0.3753
2024-05-18 08:02:41,930 -   eval_score = 0.6809
2024-05-18 08:02:41,931 -   best_eval_score = 0.7101
2024-05-18 08:02:41,931 - EarlyStopping counter: 2 out of 5
2024-05-18 08:03:12,587 - ***** Epoch: 6: Eval results *****
2024-05-18 08:03:12,587 -   binary_train_loss = 0.6233
2024-05-18 08:03:12,587 -   binary_eval_score = 0.8022
2024-05-18 08:03:12,587 -   train_loss = 0.167
2024-05-18 08:03:12,587 -   eval_score = 0.6854
2024-05-18 08:03:12,587 -   best_eval_score = 0.7101
2024-05-18 08:03:12,587 - EarlyStopping counter: 3 out of 5
2024-05-18 08:03:43,055 - ***** Epoch: 7: Eval results *****
2024-05-18 08:03:43,055 -   binary_train_loss = 0.4388
2024-05-18 08:03:43,055 -   binary_eval_score = 0.909
2024-05-18 08:03:43,056 -   train_loss = 1.1474
2024-05-18 08:03:43,056 -   eval_score = 0.6494
2024-05-18 08:03:43,056 -   best_eval_score = 0.7101
2024-05-18 08:03:43,056 - EarlyStopping counter: 4 out of 5
2024-05-18 08:04:14,809 - ***** Epoch: 8: Eval results *****
2024-05-18 08:04:14,809 -   binary_train_loss = 0.6267
2024-05-18 08:04:14,810 -   binary_eval_score = 0.7539
2024-05-18 08:04:14,810 -   train_loss = 1.1635
2024-05-18 08:04:14,810 -   eval_score = 0.6876
2024-05-18 08:04:14,810 -   best_eval_score = 0.7101
2024-05-18 08:04:14,811 - EarlyStopping counter: 5 out of 5
2024-05-18 08:04:14,811 - EarlyStopping at epoch 8
2024-05-18 08:04:14,813 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_0/models
2024-05-18 08:04:16,076 - Training is finished...
2024-05-18 08:04:16,076 - Testing begins...
2024-05-18 08:04:27,971 - ***** Out-of-domain Evaluation results *****
2024-05-18 08:04:27,971 -   aupr_in = 0.7933
2024-05-18 08:04:27,971 -   aupr_out = 0.8202
2024-05-18 08:04:27,972 -   auroc = 0.8145
2024-05-18 08:04:27,972 -   der = 0.332
2024-05-18 08:04:27,972 -   eer = 0.2578
2024-05-18 08:04:27,972 -   fpr95 = 0.62
2024-05-18 08:04:27,972 - Testing is finished...
2024-05-18 08:04:27,972 - Multimodal intent recognition is finished...
2024-05-18 08:04:27,972 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-18 08:04:28,074 - ============================== Params ==============================
2024-05-18 08:04:28,074 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-18 08:04:28,074 - dataset: MIntRec
2024-05-18 08:04:28,074 - ood_dataset: MIntRec-OOD
2024-05-18 08:04:28,074 - data_mode: multi-class
2024-05-18 08:04:28,074 - multimodal_method: msz
2024-05-18 08:04:28,074 - method: msz
2024-05-18 08:04:28,074 - ood_detection_method: ma
2024-05-18 08:04:28,074 - text_backbone: bert-base-uncased
2024-05-18 08:04:28,074 - seed: 1
2024-05-18 08:04:28,074 - num_workers: 8
2024-05-18 08:04:28,074 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-18-07-59-56
2024-05-18 08:04:28,074 - gpu_id: 2
2024-05-18 08:04:28,074 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-18 08:04:28,074 - train: True
2024-05-18 08:04:28,074 - tune: True
2024-05-18 08:04:28,074 - ood: True
2024-05-18 08:04:28,074 - save_model: True
2024-05-18 08:04:28,074 - save_results: True
2024-05-18 08:04:28,074 - log_path: logs
2024-05-18 08:04:28,074 - cache_path: cache
2024-05-18 08:04:28,074 - video_data_path: video_data
2024-05-18 08:04:28,074 - audio_data_path: audio_data
2024-05-18 08:04:28,074 - video_feats_path: swin_feats.pkl
2024-05-18 08:04:28,074 - ood_video_feats_path: swin_feats.pkl
2024-05-18 08:04:28,074 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-18 08:04:28,074 - audio_feats_path: wavlm_feats.pkl
2024-05-18 08:04:28,074 - results_path: results
2024-05-18 08:04:28,074 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz
2024-05-18 08:04:28,074 - model_path: models
2024-05-18 08:04:28,074 - config_file_name: msz_MIntRec
2024-05-18 08:04:28,074 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-18 08:04:28,075 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-18 08:04:28,075 - text_seq_len: 30
2024-05-18 08:04:28,075 - video_seq_len: 230
2024-05-18 08:04:28,075 - audio_seq_len: 480
2024-05-18 08:04:28,075 - text_feat_dim: 768
2024-05-18 08:04:28,075 - video_feat_dim: 1024
2024-05-18 08:04:28,075 - audio_feat_dim: 768
2024-05-18 08:04:28,075 - ood_label_id: 20
2024-05-18 08:04:28,075 - num_labels: 20
2024-05-18 08:04:28,075 - num_train_examples: 1334
2024-05-18 08:04:28,075 - need_aligned: True
2024-05-18 08:04:28,075 - freeze_parameters: False
2024-05-18 08:04:28,075 - eval_monitor: acc
2024-05-18 08:04:28,075 - train_batch_size: 32
2024-05-18 08:04:28,075 - eval_batch_size: 16
2024-05-18 08:04:28,075 - num_train_epochs: 100
2024-05-18 08:04:28,075 - lr: [2e-05]
2024-05-18 08:04:28,075 - weight_decay: [0.1]
2024-05-18 08:04:28,075 - wait_patience: 5
2024-05-18 08:04:28,075 - warmup_proportion: [0.1]
2024-05-18 08:04:28,075 - hidden_dims: [768]
2024-05-18 08:04:28,075 - num_attention_heads: [4]
2024-05-18 08:04:28,075 - attention_probs_dropout_prob: [0.3]
2024-05-18 08:04:28,075 - hidden_dropout_prob: [0.1]
2024-05-18 08:04:28,075 - intermediate_size: [768]
2024-05-18 08:04:28,075 - num_hidden_layers: [4]
2024-05-18 08:04:28,075 - max_position_embeddings: [900]
2024-05-18 08:04:28,075 - position_embedding_type: absolute
2024-05-18 08:04:28,075 - batch_first: True
2024-05-18 08:04:28,075 - aligned_method: ['ctc']
2024-05-18 08:04:28,075 - sampler: ['dir']
2024-05-18 08:04:28,075 - multiple_ood: [1]
2024-05-18 08:04:28,075 - select_number_min: [2]
2024-05-18 08:04:28,075 - select_number_max: [3]
2024-05-18 08:04:28,075 - alpha: [4]
2024-05-18 08:04:28,075 - mlp_hidden_size: [256]
2024-05-18 08:04:28,075 - mlp_dropout: [0.3]
2024-05-18 08:04:28,076 - scale: [16]
2024-05-18 08:04:28,076 - ablation: ['no_CosClass']
2024-05-18 08:04:28,076 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_1
2024-05-18 08:04:28,076 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-18 08:04:28,076 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/binary_msz_MIntRec_bert-base-uncased_1
2024-05-18 08:04:28,076 - device: cuda
2024-05-18 08:04:28,076 - ============================== End Params ==============================
2024-05-18 08:04:29,844 - Multimodal Intent Recognition begins...
2024-05-18 08:04:29,845 - Training begins...
2024-05-18 08:05:01,026 - ***** Epoch: 1: Eval results *****
2024-05-18 08:05:01,026 -   binary_train_loss = 0.6929
2024-05-18 08:05:01,026 -   binary_eval_score = 0.5169
2024-05-18 08:05:01,026 -   train_loss = 2.8347
2024-05-18 08:05:01,027 -   eval_score = 0.2584
2024-05-18 08:05:01,027 -   best_eval_score = 0.0
2024-05-18 08:05:32,508 - ***** Epoch: 2: Eval results *****
2024-05-18 08:05:32,508 -   binary_train_loss = 0.6878
2024-05-18 08:05:32,508 -   binary_eval_score = 0.5562
2024-05-18 08:05:32,508 -   train_loss = 2.1646
2024-05-18 08:05:32,508 -   eval_score = 0.6045
2024-05-18 08:05:32,508 -   best_eval_score = 0.2584
2024-05-18 08:06:03,132 - ***** Epoch: 3: Eval results *****
2024-05-18 08:06:03,132 -   binary_train_loss = 0.6877
2024-05-18 08:06:03,132 -   binary_eval_score = 0.5831
2024-05-18 08:06:03,132 -   train_loss = 1.1379
2024-05-18 08:06:03,132 -   eval_score = 0.6989
2024-05-18 08:06:03,132 -   best_eval_score = 0.6045
2024-05-18 08:06:33,895 - ***** Epoch: 4: Eval results *****
2024-05-18 08:06:33,895 -   binary_train_loss = 0.6758
2024-05-18 08:06:33,895 -   binary_eval_score = 0.6371
2024-05-18 08:06:33,895 -   train_loss = 0.5145
2024-05-18 08:06:33,895 -   eval_score = 0.6764
2024-05-18 08:06:33,895 -   best_eval_score = 0.6989
2024-05-18 08:06:33,895 - EarlyStopping counter: 1 out of 5
2024-05-18 08:07:04,621 - ***** Epoch: 5: Eval results *****
2024-05-18 08:07:04,621 -   binary_train_loss = 0.659
2024-05-18 08:07:04,621 -   binary_eval_score = 0.6854
2024-05-18 08:07:04,621 -   train_loss = 0.3877
2024-05-18 08:07:04,621 -   eval_score = 0.6944
2024-05-18 08:07:04,621 -   best_eval_score = 0.6989
2024-05-18 08:07:04,621 - EarlyStopping counter: 2 out of 5
2024-05-18 08:07:35,195 - ***** Epoch: 6: Eval results *****
2024-05-18 08:07:35,195 -   binary_train_loss = 0.6274
2024-05-18 08:07:35,196 -   binary_eval_score = 0.773
2024-05-18 08:07:35,196 -   train_loss = 0.1788
2024-05-18 08:07:35,196 -   eval_score = 0.6989
2024-05-18 08:07:35,196 -   best_eval_score = 0.6989
2024-05-18 08:07:35,196 - EarlyStopping counter: 3 out of 5
2024-05-18 08:08:05,565 - ***** Epoch: 7: Eval results *****
2024-05-18 08:08:05,566 -   binary_train_loss = 0.4832
2024-05-18 08:08:05,566 -   binary_eval_score = 0.8427
2024-05-18 08:08:05,566 -   train_loss = 1.5215
2024-05-18 08:08:05,566 -   eval_score = 0.5685
2024-05-18 08:08:05,566 -   best_eval_score = 0.6989
2024-05-18 08:08:05,566 - EarlyStopping counter: 4 out of 5
2024-05-18 08:08:36,036 - ***** Epoch: 8: Eval results *****
2024-05-18 08:08:36,037 -   binary_train_loss = 0.7827
2024-05-18 08:08:36,037 -   binary_eval_score = 0.6449
2024-05-18 08:08:36,037 -   train_loss = 1.1934
2024-05-18 08:08:36,037 -   eval_score = 0.6921
2024-05-18 08:08:36,037 -   best_eval_score = 0.6989
2024-05-18 08:08:36,037 - EarlyStopping counter: 5 out of 5
2024-05-18 08:08:36,037 - EarlyStopping at epoch 8
2024-05-18 08:08:36,038 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_1/models
2024-05-18 08:08:36,777 - Training is finished...
2024-05-18 08:08:36,777 - Testing begins...
2024-05-18 08:08:48,840 - ***** Out-of-domain Evaluation results *****
2024-05-18 08:08:48,840 -   aupr_in = 0.8033
2024-05-18 08:08:48,840 -   aupr_out = 0.8304
2024-05-18 08:08:48,840 -   auroc = 0.8239
2024-05-18 08:08:48,840 -   der = 0.3331
2024-05-18 08:08:48,840 -   eer = 0.2378
2024-05-18 08:08:48,840 -   fpr95 = 0.62
2024-05-18 08:08:48,841 - Testing is finished...
2024-05-18 08:08:48,841 - Multimodal intent recognition is finished...
2024-05-18 08:08:48,841 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-18 08:08:48,944 - ============================== Params ==============================
2024-05-18 08:08:48,944 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-18 08:08:48,944 - dataset: MIntRec
2024-05-18 08:08:48,944 - ood_dataset: MIntRec-OOD
2024-05-18 08:08:48,944 - data_mode: multi-class
2024-05-18 08:08:48,944 - multimodal_method: msz
2024-05-18 08:08:48,944 - method: msz
2024-05-18 08:08:48,944 - ood_detection_method: ma
2024-05-18 08:08:48,944 - text_backbone: bert-base-uncased
2024-05-18 08:08:48,944 - seed: 2
2024-05-18 08:08:48,944 - num_workers: 8
2024-05-18 08:08:48,944 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-18-07-59-56
2024-05-18 08:08:48,944 - gpu_id: 2
2024-05-18 08:08:48,944 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-18 08:08:48,944 - train: True
2024-05-18 08:08:48,944 - tune: True
2024-05-18 08:08:48,944 - ood: True
2024-05-18 08:08:48,944 - save_model: True
2024-05-18 08:08:48,944 - save_results: True
2024-05-18 08:08:48,945 - log_path: logs
2024-05-18 08:08:48,945 - cache_path: cache
2024-05-18 08:08:48,945 - video_data_path: video_data
2024-05-18 08:08:48,945 - audio_data_path: audio_data
2024-05-18 08:08:48,945 - video_feats_path: swin_feats.pkl
2024-05-18 08:08:48,945 - ood_video_feats_path: swin_feats.pkl
2024-05-18 08:08:48,945 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-18 08:08:48,945 - audio_feats_path: wavlm_feats.pkl
2024-05-18 08:08:48,945 - results_path: results
2024-05-18 08:08:48,945 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz
2024-05-18 08:08:48,945 - model_path: models
2024-05-18 08:08:48,945 - config_file_name: msz_MIntRec
2024-05-18 08:08:48,945 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-18 08:08:48,945 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-18 08:08:48,945 - text_seq_len: 30
2024-05-18 08:08:48,945 - video_seq_len: 230
2024-05-18 08:08:48,945 - audio_seq_len: 480
2024-05-18 08:08:48,945 - text_feat_dim: 768
2024-05-18 08:08:48,945 - video_feat_dim: 1024
2024-05-18 08:08:48,945 - audio_feat_dim: 768
2024-05-18 08:08:48,945 - ood_label_id: 20
2024-05-18 08:08:48,945 - num_labels: 20
2024-05-18 08:08:48,945 - num_train_examples: 1334
2024-05-18 08:08:48,945 - need_aligned: True
2024-05-18 08:08:48,945 - freeze_parameters: False
2024-05-18 08:08:48,945 - eval_monitor: acc
2024-05-18 08:08:48,945 - train_batch_size: 32
2024-05-18 08:08:48,945 - eval_batch_size: 16
2024-05-18 08:08:48,945 - num_train_epochs: 100
2024-05-18 08:08:48,945 - lr: [2e-05]
2024-05-18 08:08:48,945 - weight_decay: [0.1]
2024-05-18 08:08:48,945 - wait_patience: 5
2024-05-18 08:08:48,945 - warmup_proportion: [0.1]
2024-05-18 08:08:48,945 - hidden_dims: [768]
2024-05-18 08:08:48,945 - num_attention_heads: [4]
2024-05-18 08:08:48,945 - attention_probs_dropout_prob: [0.3]
2024-05-18 08:08:48,945 - hidden_dropout_prob: [0.1]
2024-05-18 08:08:48,945 - intermediate_size: [768]
2024-05-18 08:08:48,946 - num_hidden_layers: [4]
2024-05-18 08:08:48,946 - max_position_embeddings: [900]
2024-05-18 08:08:48,946 - position_embedding_type: absolute
2024-05-18 08:08:48,946 - batch_first: True
2024-05-18 08:08:48,946 - aligned_method: ['ctc']
2024-05-18 08:08:48,946 - sampler: ['dir']
2024-05-18 08:08:48,946 - multiple_ood: [1]
2024-05-18 08:08:48,946 - select_number_min: [2]
2024-05-18 08:08:48,946 - select_number_max: [3]
2024-05-18 08:08:48,946 - alpha: [4]
2024-05-18 08:08:48,946 - mlp_hidden_size: [256]
2024-05-18 08:08:48,946 - mlp_dropout: [0.3]
2024-05-18 08:08:48,946 - scale: [16]
2024-05-18 08:08:48,946 - ablation: ['no_CosClass']
2024-05-18 08:08:48,946 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_2
2024-05-18 08:08:48,946 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-18 08:08:48,946 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/binary_msz_MIntRec_bert-base-uncased_2
2024-05-18 08:08:48,946 - device: cuda
2024-05-18 08:08:48,946 - ============================== End Params ==============================
2024-05-18 08:08:50,674 - Multimodal Intent Recognition begins...
2024-05-18 08:08:50,674 - Training begins...
2024-05-18 08:09:21,549 - ***** Epoch: 1: Eval results *****
2024-05-18 08:09:21,550 -   binary_train_loss = 0.6929
2024-05-18 08:09:21,550 -   binary_eval_score = 0.5067
2024-05-18 08:09:21,550 -   train_loss = 2.8408
2024-05-18 08:09:21,550 -   eval_score = 0.1528
2024-05-18 08:09:21,550 -   best_eval_score = 0.0
2024-05-18 08:09:52,322 - ***** Epoch: 2: Eval results *****
2024-05-18 08:09:52,322 -   binary_train_loss = 0.6895
2024-05-18 08:09:52,322 -   binary_eval_score = 0.5382
2024-05-18 08:09:52,322 -   train_loss = 2.2235
2024-05-18 08:09:52,322 -   eval_score = 0.5596
2024-05-18 08:09:52,322 -   best_eval_score = 0.1528
2024-05-18 08:10:23,768 - ***** Epoch: 3: Eval results *****
2024-05-18 08:10:23,768 -   binary_train_loss = 0.6875
2024-05-18 08:10:23,768 -   binary_eval_score = 0.5899
2024-05-18 08:10:23,768 -   train_loss = 1.1524
2024-05-18 08:10:23,768 -   eval_score = 0.6921
2024-05-18 08:10:23,768 -   best_eval_score = 0.5596
2024-05-18 08:10:54,649 - ***** Epoch: 4: Eval results *****
2024-05-18 08:10:54,649 -   binary_train_loss = 0.6772
2024-05-18 08:10:54,649 -   binary_eval_score = 0.6438
2024-05-18 08:10:54,649 -   train_loss = 0.5069
2024-05-18 08:10:54,649 -   eval_score = 0.7056
2024-05-18 08:10:54,649 -   best_eval_score = 0.6921
2024-05-18 08:11:26,219 - ***** Epoch: 5: Eval results *****
2024-05-18 08:11:26,219 -   binary_train_loss = 0.6448
2024-05-18 08:11:26,219 -   binary_eval_score = 0.7719
2024-05-18 08:11:26,219 -   train_loss = 0.3057
2024-05-18 08:11:26,219 -   eval_score = 0.6674
2024-05-18 08:11:26,219 -   best_eval_score = 0.7056
2024-05-18 08:11:26,219 - EarlyStopping counter: 1 out of 5
2024-05-18 08:11:57,255 - ***** Epoch: 6: Eval results *****
2024-05-18 08:11:57,256 -   binary_train_loss = 0.5621
2024-05-18 08:11:57,256 -   binary_eval_score = 0.8876
2024-05-18 08:11:57,256 -   train_loss = 0.7679
2024-05-18 08:11:57,256 -   eval_score = 0.6719
2024-05-18 08:11:57,256 -   best_eval_score = 0.7056
2024-05-18 08:11:57,256 - EarlyStopping counter: 2 out of 5
2024-05-18 08:12:27,842 - ***** Epoch: 7: Eval results *****
2024-05-18 08:12:27,842 -   binary_train_loss = 0.6638
2024-05-18 08:12:27,842 -   binary_eval_score = 0.791
2024-05-18 08:12:27,842 -   train_loss = 0.7856
2024-05-18 08:12:27,842 -   eval_score = 0.7281
2024-05-18 08:12:27,842 -   best_eval_score = 0.7056
2024-05-18 08:12:58,702 - ***** Epoch: 8: Eval results *****
2024-05-18 08:12:58,702 -   binary_train_loss = 0.4081
2024-05-18 08:12:58,703 -   binary_eval_score = 0.8966
2024-05-18 08:12:58,703 -   train_loss = 0.2974
2024-05-18 08:12:58,703 -   eval_score = 0.6652
2024-05-18 08:12:58,703 -   best_eval_score = 0.7281
2024-05-18 08:12:58,703 - EarlyStopping counter: 1 out of 5
2024-05-18 08:13:29,918 - ***** Epoch: 9: Eval results *****
2024-05-18 08:13:29,918 -   binary_train_loss = 0.4469
2024-05-18 08:13:29,918 -   binary_eval_score = 0.8
2024-05-18 08:13:29,918 -   train_loss = 0.8256
2024-05-18 08:13:29,918 -   eval_score = 0.7124
2024-05-18 08:13:29,918 -   best_eval_score = 0.7281
2024-05-18 08:13:29,918 - EarlyStopping counter: 2 out of 5
2024-05-18 08:14:00,954 - ***** Epoch: 10: Eval results *****
2024-05-18 08:14:00,954 -   binary_train_loss = 0.2723
2024-05-18 08:14:00,954 -   binary_eval_score = 0.8494
2024-05-18 08:14:00,954 -   train_loss = 0.75
2024-05-18 08:14:00,954 -   eval_score = 0.6652
2024-05-18 08:14:00,954 -   best_eval_score = 0.7281
2024-05-18 08:14:00,954 - EarlyStopping counter: 3 out of 5
2024-05-18 08:14:31,817 - ***** Epoch: 11: Eval results *****
2024-05-18 08:14:31,818 -   binary_train_loss = 0.4809
2024-05-18 08:14:31,818 -   binary_eval_score = 0.9427
2024-05-18 08:14:31,818 -   train_loss = 0.3008
2024-05-18 08:14:31,818 -   eval_score = 0.6697
2024-05-18 08:14:31,818 -   best_eval_score = 0.7281
2024-05-18 08:14:31,818 - EarlyStopping counter: 4 out of 5
2024-05-18 08:15:03,015 - ***** Epoch: 12: Eval results *****
2024-05-18 08:15:03,015 -   binary_train_loss = 0.394
2024-05-18 08:15:03,015 -   binary_eval_score = 0.9539
2024-05-18 08:15:03,015 -   train_loss = 0.0618
2024-05-18 08:15:03,015 -   eval_score = 0.7079
2024-05-18 08:15:03,016 -   best_eval_score = 0.7281
2024-05-18 08:15:03,016 - EarlyStopping counter: 5 out of 5
2024-05-18 08:15:03,016 - EarlyStopping at epoch 12
2024-05-18 08:15:03,017 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_2/models
2024-05-18 08:15:03,863 - Training is finished...
2024-05-18 08:15:03,863 - Testing begins...
2024-05-18 08:15:15,967 - ***** Out-of-domain Evaluation results *****
2024-05-18 08:15:15,968 -   aupr_in = 0.7736
2024-05-18 08:15:15,968 -   aupr_out = 0.815
2024-05-18 08:15:15,968 -   auroc = 0.7985
2024-05-18 08:15:15,968 -   der = 0.3132
2024-05-18 08:15:15,968 -   eer = 0.28
2024-05-18 08:15:15,968 -   fpr95 = 0.5822
2024-05-18 08:15:15,968 - Testing is finished...
2024-05-18 08:15:15,968 - Multimodal intent recognition is finished...
2024-05-18 08:15:15,968 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-18 08:15:16,095 - ============================== Params ==============================
2024-05-18 08:15:16,095 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-18 08:15:16,095 - dataset: MIntRec
2024-05-18 08:15:16,095 - ood_dataset: MIntRec-OOD
2024-05-18 08:15:16,095 - data_mode: multi-class
2024-05-18 08:15:16,095 - multimodal_method: msz
2024-05-18 08:15:16,095 - method: msz
2024-05-18 08:15:16,095 - ood_detection_method: ma
2024-05-18 08:15:16,096 - text_backbone: bert-base-uncased
2024-05-18 08:15:16,096 - seed: 3
2024-05-18 08:15:16,096 - num_workers: 8
2024-05-18 08:15:16,096 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-18-07-59-56
2024-05-18 08:15:16,096 - gpu_id: 2
2024-05-18 08:15:16,096 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-18 08:15:16,096 - train: True
2024-05-18 08:15:16,096 - tune: True
2024-05-18 08:15:16,096 - ood: True
2024-05-18 08:15:16,096 - save_model: True
2024-05-18 08:15:16,096 - save_results: True
2024-05-18 08:15:16,096 - log_path: logs
2024-05-18 08:15:16,096 - cache_path: cache
2024-05-18 08:15:16,096 - video_data_path: video_data
2024-05-18 08:15:16,096 - audio_data_path: audio_data
2024-05-18 08:15:16,096 - video_feats_path: swin_feats.pkl
2024-05-18 08:15:16,096 - ood_video_feats_path: swin_feats.pkl
2024-05-18 08:15:16,096 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-18 08:15:16,096 - audio_feats_path: wavlm_feats.pkl
2024-05-18 08:15:16,096 - results_path: results
2024-05-18 08:15:16,096 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz
2024-05-18 08:15:16,096 - model_path: models
2024-05-18 08:15:16,096 - config_file_name: msz_MIntRec
2024-05-18 08:15:16,096 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-18 08:15:16,096 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-18 08:15:16,096 - text_seq_len: 30
2024-05-18 08:15:16,096 - video_seq_len: 230
2024-05-18 08:15:16,096 - audio_seq_len: 480
2024-05-18 08:15:16,096 - text_feat_dim: 768
2024-05-18 08:15:16,096 - video_feat_dim: 1024
2024-05-18 08:15:16,096 - audio_feat_dim: 768
2024-05-18 08:15:16,096 - ood_label_id: 20
2024-05-18 08:15:16,096 - num_labels: 20
2024-05-18 08:15:16,096 - num_train_examples: 1334
2024-05-18 08:15:16,096 - need_aligned: True
2024-05-18 08:15:16,096 - freeze_parameters: False
2024-05-18 08:15:16,096 - eval_monitor: acc
2024-05-18 08:15:16,096 - train_batch_size: 32
2024-05-18 08:15:16,096 - eval_batch_size: 16
2024-05-18 08:15:16,096 - num_train_epochs: 100
2024-05-18 08:15:16,096 - lr: [2e-05]
2024-05-18 08:15:16,096 - weight_decay: [0.1]
2024-05-18 08:15:16,096 - wait_patience: 5
2024-05-18 08:15:16,096 - warmup_proportion: [0.1]
2024-05-18 08:15:16,097 - hidden_dims: [768]
2024-05-18 08:15:16,097 - num_attention_heads: [4]
2024-05-18 08:15:16,097 - attention_probs_dropout_prob: [0.3]
2024-05-18 08:15:16,097 - hidden_dropout_prob: [0.1]
2024-05-18 08:15:16,097 - intermediate_size: [768]
2024-05-18 08:15:16,097 - num_hidden_layers: [4]
2024-05-18 08:15:16,097 - max_position_embeddings: [900]
2024-05-18 08:15:16,097 - position_embedding_type: absolute
2024-05-18 08:15:16,097 - batch_first: True
2024-05-18 08:15:16,097 - aligned_method: ['ctc']
2024-05-18 08:15:16,097 - sampler: ['dir']
2024-05-18 08:15:16,097 - multiple_ood: [1]
2024-05-18 08:15:16,097 - select_number_min: [2]
2024-05-18 08:15:16,097 - select_number_max: [3]
2024-05-18 08:15:16,097 - alpha: [4]
2024-05-18 08:15:16,097 - mlp_hidden_size: [256]
2024-05-18 08:15:16,097 - mlp_dropout: [0.3]
2024-05-18 08:15:16,097 - scale: [16]
2024-05-18 08:15:16,097 - ablation: ['no_CosClass']
2024-05-18 08:15:16,097 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_3
2024-05-18 08:15:16,097 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-18 08:15:16,097 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/binary_msz_MIntRec_bert-base-uncased_3
2024-05-18 08:15:16,097 - device: cuda
2024-05-18 08:15:16,097 - ============================== End Params ==============================
2024-05-18 08:15:17,583 - Multimodal Intent Recognition begins...
2024-05-18 08:15:17,583 - Training begins...
2024-05-18 08:15:48,934 - ***** Epoch: 1: Eval results *****
2024-05-18 08:15:48,934 -   binary_train_loss = 0.6935
2024-05-18 08:15:48,934 -   binary_eval_score = 0.6427
2024-05-18 08:15:48,934 -   train_loss = 2.8218
2024-05-18 08:15:48,934 -   eval_score = 0.2607
2024-05-18 08:15:48,934 -   best_eval_score = 0.0
2024-05-18 08:16:20,460 - ***** Epoch: 2: Eval results *****
2024-05-18 08:16:20,461 -   binary_train_loss = 0.6895
2024-05-18 08:16:20,461 -   binary_eval_score = 0.5101
2024-05-18 08:16:20,461 -   train_loss = 2.1388
2024-05-18 08:16:20,461 -   eval_score = 0.5888
2024-05-18 08:16:20,461 -   best_eval_score = 0.2607
2024-05-18 08:16:51,453 - ***** Epoch: 3: Eval results *****
2024-05-18 08:16:51,454 -   binary_train_loss = 0.6853
2024-05-18 08:16:51,454 -   binary_eval_score = 0.6045
2024-05-18 08:16:51,454 -   train_loss = 1.1045
2024-05-18 08:16:51,454 -   eval_score = 0.6944
2024-05-18 08:16:51,454 -   best_eval_score = 0.5888
2024-05-18 08:17:22,630 - ***** Epoch: 4: Eval results *****
2024-05-18 08:17:22,630 -   binary_train_loss = 0.6824
2024-05-18 08:17:22,630 -   binary_eval_score = 0.6416
2024-05-18 08:17:22,630 -   train_loss = 0.5709
2024-05-18 08:17:22,631 -   eval_score = 0.6921
2024-05-18 08:17:22,631 -   best_eval_score = 0.6944
2024-05-18 08:17:22,631 - EarlyStopping counter: 1 out of 5
2024-05-18 08:17:53,468 - ***** Epoch: 5: Eval results *****
2024-05-18 08:17:53,468 -   binary_train_loss = 0.6649
2024-05-18 08:17:53,468 -   binary_eval_score = 0.7438
2024-05-18 08:17:53,468 -   train_loss = 0.2795
2024-05-18 08:17:53,468 -   eval_score = 0.6315
2024-05-18 08:17:53,468 -   best_eval_score = 0.6944
2024-05-18 08:17:53,468 - EarlyStopping counter: 2 out of 5
2024-05-18 08:18:24,733 - ***** Epoch: 6: Eval results *****
2024-05-18 08:18:24,734 -   binary_train_loss = 0.5669
2024-05-18 08:18:24,734 -   binary_eval_score = 0.8382
2024-05-18 08:18:24,734 -   train_loss = 1.2245
2024-05-18 08:18:24,734 -   eval_score = 0.6157
2024-05-18 08:18:24,734 -   best_eval_score = 0.6944
2024-05-18 08:18:24,734 - EarlyStopping counter: 3 out of 5
2024-05-18 08:18:55,284 - ***** Epoch: 7: Eval results *****
2024-05-18 08:18:55,284 -   binary_train_loss = 0.7699
2024-05-18 08:18:55,285 -   binary_eval_score = 0.6112
2024-05-18 08:18:55,285 -   train_loss = 0.8221
2024-05-18 08:18:55,285 -   eval_score = 0.7034
2024-05-18 08:18:55,285 -   best_eval_score = 0.6944
2024-05-18 08:19:26,229 - ***** Epoch: 8: Eval results *****
2024-05-18 08:19:26,230 -   binary_train_loss = 0.5279
2024-05-18 08:19:26,230 -   binary_eval_score = 0.8
2024-05-18 08:19:26,230 -   train_loss = 0.119
2024-05-18 08:19:26,230 -   eval_score = 0.7146
2024-05-18 08:19:26,230 -   best_eval_score = 0.7034
2024-05-18 08:19:57,753 - ***** Epoch: 9: Eval results *****
2024-05-18 08:19:57,753 -   binary_train_loss = 0.3243
2024-05-18 08:19:57,753 -   binary_eval_score = 0.8528
2024-05-18 08:19:57,754 -   train_loss = 0.0933
2024-05-18 08:19:57,754 -   eval_score = 0.7348
2024-05-18 08:19:57,754 -   best_eval_score = 0.7146
2024-05-18 08:20:28,620 - ***** Epoch: 10: Eval results *****
2024-05-18 08:20:28,621 -   binary_train_loss = 0.2124
2024-05-18 08:20:28,621 -   binary_eval_score = 0.9124
2024-05-18 08:20:28,621 -   train_loss = 0.5213
2024-05-18 08:20:28,621 -   eval_score = 0.6382
2024-05-18 08:20:28,621 -   best_eval_score = 0.7348
2024-05-18 08:20:28,621 - EarlyStopping counter: 1 out of 5
2024-05-18 08:20:59,942 - ***** Epoch: 11: Eval results *****
2024-05-18 08:20:59,942 -   binary_train_loss = 0.2944
2024-05-18 08:20:59,943 -   binary_eval_score = 0.909
2024-05-18 08:20:59,943 -   train_loss = 1.1981
2024-05-18 08:20:59,943 -   eval_score = 0.6809
2024-05-18 08:20:59,943 -   best_eval_score = 0.7348
2024-05-18 08:20:59,943 - EarlyStopping counter: 2 out of 5
2024-05-18 08:21:30,373 - ***** Epoch: 12: Eval results *****
2024-05-18 08:21:30,373 -   binary_train_loss = 0.872
2024-05-18 08:21:30,373 -   binary_eval_score = 0.5303
2024-05-18 08:21:30,373 -   train_loss = 0.4463
2024-05-18 08:21:30,373 -   eval_score = 0.7079
2024-05-18 08:21:30,373 -   best_eval_score = 0.7348
2024-05-18 08:21:30,373 - EarlyStopping counter: 3 out of 5
2024-05-18 08:22:01,615 - ***** Epoch: 13: Eval results *****
2024-05-18 08:22:01,615 -   binary_train_loss = 0.4921
2024-05-18 08:22:01,615 -   binary_eval_score = 0.8876
2024-05-18 08:22:01,615 -   train_loss = 0.073
2024-05-18 08:22:01,616 -   eval_score = 0.7034
2024-05-18 08:22:01,616 -   best_eval_score = 0.7348
2024-05-18 08:22:01,616 - EarlyStopping counter: 4 out of 5
2024-05-18 08:22:32,688 - ***** Epoch: 14: Eval results *****
2024-05-18 08:22:32,688 -   binary_train_loss = 0.2443
2024-05-18 08:22:32,688 -   binary_eval_score = 0.9011
2024-05-18 08:22:32,688 -   train_loss = 0.1
2024-05-18 08:22:32,688 -   eval_score = 0.7034
2024-05-18 08:22:32,688 -   best_eval_score = 0.7348
2024-05-18 08:22:32,688 - EarlyStopping counter: 5 out of 5
2024-05-18 08:22:32,688 - EarlyStopping at epoch 14
2024-05-18 08:22:32,689 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_3/models
2024-05-18 08:22:33,430 - Training is finished...
2024-05-18 08:22:33,430 - Testing begins...
2024-05-18 08:22:45,534 - ***** Out-of-domain Evaluation results *****
2024-05-18 08:22:45,534 -   aupr_in = 0.7938
2024-05-18 08:22:45,534 -   aupr_out = 0.8024
2024-05-18 08:22:45,534 -   auroc = 0.8013
2024-05-18 08:22:45,534 -   der = 0.3629
2024-05-18 08:22:45,534 -   eer = 0.2689
2024-05-18 08:22:45,534 -   fpr95 = 0.6822
2024-05-18 08:22:45,535 - Testing is finished...
2024-05-18 08:22:45,535 - Multimodal intent recognition is finished...
2024-05-18 08:22:45,535 - Results are saved in results/results_msz_ablation_MIntRec.csv
2024-05-18 08:22:45,645 - ============================== Params ==============================
2024-05-18 08:22:45,645 - logger_name: msz_ma_MIntRec_multi-class_0
2024-05-18 08:22:45,645 - dataset: MIntRec
2024-05-18 08:22:45,645 - ood_dataset: MIntRec-OOD
2024-05-18 08:22:45,645 - data_mode: multi-class
2024-05-18 08:22:45,646 - multimodal_method: msz
2024-05-18 08:22:45,646 - method: msz
2024-05-18 08:22:45,646 - ood_detection_method: ma
2024-05-18 08:22:45,646 - text_backbone: bert-base-uncased
2024-05-18 08:22:45,646 - seed: 4
2024-05-18 08:22:45,646 - num_workers: 8
2024-05-18 08:22:45,646 - log_id: msz_ma_MIntRec_multi-class_0_2024-05-18-07-59-56
2024-05-18 08:22:45,646 - gpu_id: 2
2024-05-18 08:22:45,646 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-18 08:22:45,646 - train: True
2024-05-18 08:22:45,646 - tune: True
2024-05-18 08:22:45,646 - ood: True
2024-05-18 08:22:45,646 - save_model: True
2024-05-18 08:22:45,646 - save_results: True
2024-05-18 08:22:45,646 - log_path: logs
2024-05-18 08:22:45,646 - cache_path: cache
2024-05-18 08:22:45,646 - video_data_path: video_data
2024-05-18 08:22:45,646 - audio_data_path: audio_data
2024-05-18 08:22:45,646 - video_feats_path: swin_feats.pkl
2024-05-18 08:22:45,646 - ood_video_feats_path: swin_feats.pkl
2024-05-18 08:22:45,646 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-18 08:22:45,646 - audio_feats_path: wavlm_feats.pkl
2024-05-18 08:22:45,646 - results_path: results
2024-05-18 08:22:45,646 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz
2024-05-18 08:22:45,646 - model_path: models
2024-05-18 08:22:45,646 - config_file_name: msz_MIntRec
2024-05-18 08:22:45,646 - results_file_name: results_msz_ablation_MIntRec.csv
2024-05-18 08:22:45,646 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-18 08:22:45,646 - text_seq_len: 30
2024-05-18 08:22:45,646 - video_seq_len: 230
2024-05-18 08:22:45,646 - audio_seq_len: 480
2024-05-18 08:22:45,646 - text_feat_dim: 768
2024-05-18 08:22:45,646 - video_feat_dim: 1024
2024-05-18 08:22:45,646 - audio_feat_dim: 768
2024-05-18 08:22:45,646 - ood_label_id: 20
2024-05-18 08:22:45,646 - num_labels: 20
2024-05-18 08:22:45,646 - num_train_examples: 1334
2024-05-18 08:22:45,646 - need_aligned: True
2024-05-18 08:22:45,647 - freeze_parameters: False
2024-05-18 08:22:45,647 - eval_monitor: acc
2024-05-18 08:22:45,647 - train_batch_size: 32
2024-05-18 08:22:45,647 - eval_batch_size: 16
2024-05-18 08:22:45,647 - num_train_epochs: 100
2024-05-18 08:22:45,647 - lr: [2e-05]
2024-05-18 08:22:45,647 - weight_decay: [0.1]
2024-05-18 08:22:45,647 - wait_patience: 5
2024-05-18 08:22:45,647 - warmup_proportion: [0.1]
2024-05-18 08:22:45,647 - hidden_dims: [768]
2024-05-18 08:22:45,647 - num_attention_heads: [4]
2024-05-18 08:22:45,647 - attention_probs_dropout_prob: [0.3]
2024-05-18 08:22:45,647 - hidden_dropout_prob: [0.1]
2024-05-18 08:22:45,647 - intermediate_size: [768]
2024-05-18 08:22:45,647 - num_hidden_layers: [4]
2024-05-18 08:22:45,647 - max_position_embeddings: [900]
2024-05-18 08:22:45,647 - position_embedding_type: absolute
2024-05-18 08:22:45,647 - batch_first: True
2024-05-18 08:22:45,647 - aligned_method: ['ctc']
2024-05-18 08:22:45,647 - sampler: ['dir']
2024-05-18 08:22:45,647 - multiple_ood: [1]
2024-05-18 08:22:45,647 - select_number_min: [2]
2024-05-18 08:22:45,647 - select_number_max: [3]
2024-05-18 08:22:45,647 - alpha: [4]
2024-05-18 08:22:45,647 - mlp_hidden_size: [256]
2024-05-18 08:22:45,647 - mlp_dropout: [0.3]
2024-05-18 08:22:45,647 - scale: [16]
2024-05-18 08:22:45,647 - ablation: ['no_CosClass']
2024-05-18 08:22:45,647 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_4
2024-05-18 08:22:45,647 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_4/models
2024-05-18 08:22:45,647 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/binary_msz_MIntRec_bert-base-uncased_4
2024-05-18 08:22:45,647 - device: cuda
2024-05-18 08:22:45,647 - ============================== End Params ==============================
2024-05-18 08:22:47,393 - Multimodal Intent Recognition begins...
2024-05-18 08:22:47,393 - Training begins...
2024-05-18 08:23:18,489 - ***** Epoch: 1: Eval results *****
2024-05-18 08:23:18,489 -   binary_train_loss = 0.6922
2024-05-18 08:23:18,489 -   binary_eval_score = 0.5
2024-05-18 08:23:18,489 -   train_loss = 2.8198
2024-05-18 08:23:18,490 -   eval_score = 0.2831
2024-05-18 08:23:18,490 -   best_eval_score = 0.0
2024-05-18 08:23:49,759 - ***** Epoch: 2: Eval results *****
2024-05-18 08:23:49,759 -   binary_train_loss = 0.6894
2024-05-18 08:23:49,759 -   binary_eval_score = 0.5045
2024-05-18 08:23:49,759 -   train_loss = 2.1456
2024-05-18 08:23:49,760 -   eval_score = 0.6022
2024-05-18 08:23:49,760 -   best_eval_score = 0.2831
2024-05-18 08:24:20,830 - ***** Epoch: 3: Eval results *****
2024-05-18 08:24:20,830 -   binary_train_loss = 0.686
2024-05-18 08:24:20,830 -   binary_eval_score = 0.6022
2024-05-18 08:24:20,830 -   train_loss = 1.0656
2024-05-18 08:24:20,830 -   eval_score = 0.6944
2024-05-18 08:24:20,830 -   best_eval_score = 0.6022
2024-05-18 08:24:52,163 - ***** Epoch: 4: Eval results *****
2024-05-18 08:24:52,163 -   binary_train_loss = 0.675
2024-05-18 08:24:52,163 -   binary_eval_score = 0.6753
2024-05-18 08:24:52,163 -   train_loss = 0.5574
2024-05-18 08:24:52,163 -   eval_score = 0.6989
2024-05-18 08:24:52,163 -   best_eval_score = 0.6944
2024-05-18 08:25:23,372 - ***** Epoch: 5: Eval results *****
2024-05-18 08:25:23,372 -   binary_train_loss = 0.6511
2024-05-18 08:25:23,373 -   binary_eval_score = 0.7483
2024-05-18 08:25:23,373 -   train_loss = 0.2505
2024-05-18 08:25:23,373 -   eval_score = 0.6607
2024-05-18 08:25:23,373 -   best_eval_score = 0.6989
2024-05-18 08:25:23,373 - EarlyStopping counter: 1 out of 5
2024-05-18 08:25:53,802 - ***** Epoch: 6: Eval results *****
2024-05-18 08:25:53,802 -   binary_train_loss = 0.5438
2024-05-18 08:25:53,802 -   binary_eval_score = 0.8438
2024-05-18 08:25:53,803 -   train_loss = 1.2788
2024-05-18 08:25:53,803 -   eval_score = 0.6674
2024-05-18 08:25:53,803 -   best_eval_score = 0.6989
2024-05-18 08:25:53,803 - EarlyStopping counter: 2 out of 5
2024-05-18 08:26:25,422 - ***** Epoch: 7: Eval results *****
2024-05-18 08:26:25,422 -   binary_train_loss = 0.7053
2024-05-18 08:26:25,422 -   binary_eval_score = 0.7528
2024-05-18 08:26:25,422 -   train_loss = 0.7762
2024-05-18 08:26:25,422 -   eval_score = 0.7056
2024-05-18 08:26:25,422 -   best_eval_score = 0.6989
2024-05-18 08:26:56,691 - ***** Epoch: 8: Eval results *****
2024-05-18 08:26:56,691 -   binary_train_loss = 0.4913
2024-05-18 08:26:56,691 -   binary_eval_score = 0.8494
2024-05-18 08:26:56,691 -   train_loss = 0.1175
2024-05-18 08:26:56,691 -   eval_score = 0.6989
2024-05-18 08:26:56,691 -   best_eval_score = 0.7056
2024-05-18 08:26:56,691 - EarlyStopping counter: 1 out of 5
2024-05-18 08:27:27,748 - ***** Epoch: 9: Eval results *****
2024-05-18 08:27:27,748 -   binary_train_loss = 0.434
2024-05-18 08:27:27,748 -   binary_eval_score = 0.8798
2024-05-18 08:27:27,748 -   train_loss = 0.1222
2024-05-18 08:27:27,748 -   eval_score = 0.6966
2024-05-18 08:27:27,748 -   best_eval_score = 0.7056
2024-05-18 08:27:27,748 - EarlyStopping counter: 2 out of 5
2024-05-18 08:27:58,914 - ***** Epoch: 10: Eval results *****
2024-05-18 08:27:58,914 -   binary_train_loss = 0.2739
2024-05-18 08:27:58,914 -   binary_eval_score = 0.9472
2024-05-18 08:27:58,914 -   train_loss = 0.2385
2024-05-18 08:27:58,914 -   eval_score = 0.6584
2024-05-18 08:27:58,915 -   best_eval_score = 0.7056
2024-05-18 08:27:58,915 - EarlyStopping counter: 3 out of 5
2024-05-18 08:28:30,194 - ***** Epoch: 11: Eval results *****
2024-05-18 08:28:30,194 -   binary_train_loss = 0.4853
2024-05-18 08:28:30,194 -   binary_eval_score = 0.8809
2024-05-18 08:28:30,194 -   train_loss = 1.9566
2024-05-18 08:28:30,194 -   eval_score = 0.4539
2024-05-18 08:28:30,194 -   best_eval_score = 0.7056
2024-05-18 08:28:30,194 - EarlyStopping counter: 4 out of 5
2024-05-18 08:29:00,752 - ***** Epoch: 12: Eval results *****
2024-05-18 08:29:00,752 -   binary_train_loss = 0.5397
2024-05-18 08:29:00,752 -   binary_eval_score = 0.8427
2024-05-18 08:29:00,753 -   train_loss = 0.1847
2024-05-18 08:29:00,753 -   eval_score = 0.7191
2024-05-18 08:29:00,753 -   best_eval_score = 0.7056
2024-05-18 08:29:31,745 - ***** Epoch: 13: Eval results *****
2024-05-18 08:29:31,745 -   binary_train_loss = 0.196
2024-05-18 08:29:31,745 -   binary_eval_score = 0.9315
2024-05-18 08:29:31,745 -   train_loss = 0.0729
2024-05-18 08:29:31,745 -   eval_score = 0.7146
2024-05-18 08:29:31,745 -   best_eval_score = 0.7191
2024-05-18 08:29:31,745 - EarlyStopping counter: 1 out of 5
2024-05-18 08:30:02,938 - ***** Epoch: 14: Eval results *****
2024-05-18 08:30:02,938 -   binary_train_loss = 0.141
2024-05-18 08:30:02,938 -   binary_eval_score = 0.9461
2024-05-18 08:30:02,938 -   train_loss = 1.0998
2024-05-18 08:30:02,938 -   eval_score = 0.6629
2024-05-18 08:30:02,939 -   best_eval_score = 0.7191
2024-05-18 08:30:02,939 - EarlyStopping counter: 2 out of 5
2024-05-18 08:30:33,919 - ***** Epoch: 15: Eval results *****
2024-05-18 08:30:33,919 -   binary_train_loss = 0.4769
2024-05-18 08:30:33,919 -   binary_eval_score = 0.9348
2024-05-18 08:30:33,919 -   train_loss = 0.786
2024-05-18 08:30:33,919 -   eval_score = 0.6831
2024-05-18 08:30:33,919 -   best_eval_score = 0.7191
2024-05-18 08:30:33,919 - EarlyStopping counter: 3 out of 5
2024-05-18 08:31:05,050 - ***** Epoch: 16: Eval results *****
2024-05-18 08:31:05,050 -   binary_train_loss = 0.5356
2024-05-18 08:31:05,050 -   binary_eval_score = 0.9191
2024-05-18 08:31:05,051 -   train_loss = 0.9913
2024-05-18 08:31:05,051 -   eval_score = 0.3326
2024-05-18 08:31:05,051 -   best_eval_score = 0.7191
2024-05-18 08:31:05,051 - EarlyStopping counter: 4 out of 5
2024-05-18 08:31:36,174 - ***** Epoch: 17: Eval results *****
2024-05-18 08:31:36,174 -   binary_train_loss = 0.7076
2024-05-18 08:31:36,174 -   binary_eval_score = 0.8989
2024-05-18 08:31:36,174 -   train_loss = 1.7432
2024-05-18 08:31:36,174 -   eval_score = 0.5034
2024-05-18 08:31:36,174 -   best_eval_score = 0.7191
2024-05-18 08:31:36,175 - EarlyStopping counter: 5 out of 5
2024-05-18 08:31:36,175 - EarlyStopping at epoch 17
2024-05-18 08:31:36,178 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec/dir_ablation/no_CosClass_msz/msz_MIntRec_bert-base-uncased_multi-class_4/models
2024-05-18 08:31:37,060 - Training is finished...
2024-05-18 08:31:37,060 - Testing begins...
2024-05-18 08:31:49,571 - ***** Out-of-domain Evaluation results *****
2024-05-18 08:31:49,572 -   aupr_in = 0.7711
2024-05-18 08:31:49,572 -   aupr_out = 0.7555
2024-05-18 08:31:49,572 -   auroc = 0.7708
2024-05-18 08:31:49,572 -   der = 0.4215
2024-05-18 08:31:49,572 -   eer = 0.3044
2024-05-18 08:31:49,572 -   fpr95 = 0.7978
2024-05-18 08:31:49,572 - Testing is finished...
2024-05-18 08:31:49,572 - Multimodal intent recognition is finished...
2024-05-18 08:31:49,572 - Results are saved in results/results_msz_ablation_MIntRec.csv
