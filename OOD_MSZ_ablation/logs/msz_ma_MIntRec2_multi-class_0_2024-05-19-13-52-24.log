2024-05-19 13:52:24,219 - Lists of intent labels are: ['Acknowledge', 'Advise', 'Agree', 'Apologise', 'Arrange', 'Ask for help', 'Asking for opinions', 'Care', 'Comfort', 'Complain', 'Confirm', 'Criticize', 'Doubt', 'Emphasize', 'Explain', 'Flaunt', 'Greet', 'Inform', 'Introduce', 'Invite', 'Joke', 'Leave', 'Oppose', 'Plan', 'Praise', 'Prevent', 'Refuse', 'Taunt', 'Thank', 'Warn']
2024-05-19 13:52:24,219 - ID Data preparation...
2024-05-19 13:52:44,532 - OOD Data preparation...
2024-05-19 13:52:47,899 - ============================== Params ==============================
2024-05-19 13:52:47,899 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-05-19 13:52:47,899 - dataset: MIntRec2
2024-05-19 13:52:47,899 - ood_dataset: MIntRec2-OOD
2024-05-19 13:52:47,899 - data_mode: multi-class
2024-05-19 13:52:47,899 - multimodal_method: msz
2024-05-19 13:52:47,899 - method: msz
2024-05-19 13:52:47,899 - ood_detection_method: ma
2024-05-19 13:52:47,899 - text_backbone: bert-base-uncased
2024-05-19 13:52:47,899 - seed: 0
2024-05-19 13:52:47,899 - num_workers: 8
2024-05-19 13:52:47,899 - log_id: msz_ma_MIntRec2_multi-class_0_2024-05-19-13-52-24
2024-05-19 13:52:47,899 - gpu_id: 1
2024-05-19 13:52:47,899 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-19 13:52:47,899 - train: True
2024-05-19 13:52:47,899 - tune: True
2024-05-19 13:52:47,899 - ood: True
2024-05-19 13:52:47,899 - save_model: True
2024-05-19 13:52:47,899 - save_results: True
2024-05-19 13:52:47,899 - log_path: logs
2024-05-19 13:52:47,899 - cache_path: cache
2024-05-19 13:52:47,900 - video_data_path: video_data
2024-05-19 13:52:47,900 - audio_data_path: audio_data
2024-05-19 13:52:47,900 - video_feats_path: swin_feats.pkl
2024-05-19 13:52:47,900 - ood_video_feats_path: swin_feats.pkl
2024-05-19 13:52:47,900 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-19 13:52:47,900 - audio_feats_path: wavlm_feats.pkl
2024-05-19 13:52:47,900 - results_path: results
2024-05-19 13:52:47,900 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz
2024-05-19 13:52:47,900 - model_path: models
2024-05-19 13:52:47,900 - config_file_name: msz_MIntRec21
2024-05-19 13:52:47,900 - results_file_name: results_msz_ablation_MIntRec2.csv
2024-05-19 13:52:47,900 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-19 13:52:47,900 - text_seq_len: 50
2024-05-19 13:52:47,900 - video_seq_len: 180
2024-05-19 13:52:47,900 - audio_seq_len: 400
2024-05-19 13:52:47,900 - text_feat_dim: 768
2024-05-19 13:52:47,900 - video_feat_dim: 256
2024-05-19 13:52:47,900 - audio_feat_dim: 768
2024-05-19 13:52:47,900 - ood_label_id: 30
2024-05-19 13:52:47,900 - num_labels: 30
2024-05-19 13:52:47,900 - num_train_examples: 6165
2024-05-19 13:52:47,900 - need_aligned: True
2024-05-19 13:52:47,900 - freeze_parameters: False
2024-05-19 13:52:47,900 - eval_monitor: acc
2024-05-19 13:52:47,900 - train_batch_size: 32
2024-05-19 13:52:47,900 - eval_batch_size: 16
2024-05-19 13:52:47,900 - num_train_epochs: 100
2024-05-19 13:52:47,900 - lr: [1e-05]
2024-05-19 13:52:47,900 - weight_decay: [0.1]
2024-05-19 13:52:47,900 - wait_patience: 3
2024-05-19 13:52:47,900 - warmup_proportion: [0.01]
2024-05-19 13:52:47,900 - hidden_dims: [768]
2024-05-19 13:52:47,900 - num_attention_heads: [4]
2024-05-19 13:52:47,900 - attention_probs_dropout_prob: [0.3]
2024-05-19 13:52:47,900 - hidden_dropout_prob: [0.3]
2024-05-19 13:52:47,900 - intermediate_size: [768]
2024-05-19 13:52:47,900 - num_hidden_layers: [6]
2024-05-19 13:52:47,900 - max_position_embeddings: [768]
2024-05-19 13:52:47,900 - position_embedding_type: absolute
2024-05-19 13:52:47,900 - batch_first: True
2024-05-19 13:52:47,900 - aligned_method: ['ctc']
2024-05-19 13:52:47,900 - sampler: ['dir']
2024-05-19 13:52:47,900 - multiple_ood: [1]
2024-05-19 13:52:47,900 - select_number_min: [2]
2024-05-19 13:52:47,900 - select_number_max: [3]
2024-05-19 13:52:47,901 - alpha: [2]
2024-05-19 13:52:47,901 - mlp_hidden_size: [256]
2024-05-19 13:52:47,901 - mlp_dropout: [0.3]
2024-05-19 13:52:47,901 - scale: [8]
2024-05-19 13:52:47,901 - ablation: ['no_fusion_add']
2024-05-19 13:52:47,901 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/msz_MIntRec2_bert-base-uncased_multi-class_0
2024-05-19 13:52:47,901 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/msz_MIntRec2_bert-base-uncased_multi-class_0/models
2024-05-19 13:52:47,901 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/binary_msz_MIntRec2_bert-base-uncased_0
2024-05-19 13:52:47,901 - ============================== End Params ==============================
2024-05-19 13:52:51,072 - Multimodal Intent Recognition begins...
2024-05-19 13:52:51,072 - Training begins...
2024-05-19 13:53:56,066 - ***** Epoch: 1: Eval results *****
2024-05-19 13:53:56,067 -   binary_train_loss = 0.7014
2024-05-19 13:53:56,067 -   binary_eval_score = 0.5005
2024-05-19 13:53:56,067 -   train_loss = 2.967
2024-05-19 13:53:56,067 -   eval_score = 0.4521
2024-05-19 13:53:56,067 -   best_eval_score = 0.0
2024-05-19 13:54:58,825 - ***** Epoch: 2: Eval results *****
2024-05-19 13:54:58,826 -   binary_train_loss = 0.6717
2024-05-19 13:54:58,826 -   binary_eval_score = 0.764
2024-05-19 13:54:58,826 -   train_loss = 1.6522
2024-05-19 13:54:58,826 -   eval_score = 0.5199
2024-05-19 13:54:58,826 -   best_eval_score = 0.4521
2024-05-19 13:56:02,129 - ***** Epoch: 3: Eval results *****
2024-05-19 13:56:02,129 -   binary_train_loss = 0.6629
2024-05-19 13:56:02,129 -   binary_eval_score = 0.7351
2024-05-19 13:56:02,129 -   train_loss = 1.2217
2024-05-19 13:56:02,129 -   eval_score = 0.5769
2024-05-19 13:56:02,129 -   best_eval_score = 0.5199
2024-05-19 13:57:05,849 - ***** Epoch: 4: Eval results *****
2024-05-19 13:57:05,849 -   binary_train_loss = 0.6568
2024-05-19 13:57:05,849 -   binary_eval_score = 0.7473
2024-05-19 13:57:05,849 -   train_loss = 0.9457
2024-05-19 13:57:05,849 -   eval_score = 0.585
2024-05-19 13:57:05,849 -   best_eval_score = 0.5769
2024-05-19 13:58:10,104 - ***** Epoch: 5: Eval results *****
2024-05-19 13:58:10,104 -   binary_train_loss = 0.6463
2024-05-19 13:58:10,105 -   binary_eval_score = 0.7464
2024-05-19 13:58:10,105 -   train_loss = 0.7276
2024-05-19 13:58:10,105 -   eval_score = 0.5805
2024-05-19 13:58:10,105 -   best_eval_score = 0.585
2024-05-19 13:58:10,105 - EarlyStopping counter: 1 out of 3
2024-05-19 13:59:13,132 - ***** Epoch: 6: Eval results *****
2024-05-19 13:59:13,132 -   binary_train_loss = 0.6297
2024-05-19 13:59:13,132 -   binary_eval_score = 0.7703
2024-05-19 13:59:13,132 -   train_loss = 0.5659
2024-05-19 13:59:13,132 -   eval_score = 0.5687
2024-05-19 13:59:13,132 -   best_eval_score = 0.585
2024-05-19 13:59:13,132 - EarlyStopping counter: 2 out of 3
2024-05-19 14:00:16,373 - ***** Epoch: 7: Eval results *****
2024-05-19 14:00:16,373 -   binary_train_loss = 0.6171
2024-05-19 14:00:16,373 -   binary_eval_score = 0.7654
2024-05-19 14:00:16,374 -   train_loss = 0.4348
2024-05-19 14:00:16,374 -   eval_score = 0.575
2024-05-19 14:00:16,374 -   best_eval_score = 0.585
2024-05-19 14:00:16,374 - EarlyStopping counter: 3 out of 3
2024-05-19 14:00:16,374 - EarlyStopping at epoch 7
2024-05-19 14:00:16,378 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/msz_MIntRec2_bert-base-uncased_multi-class_0/models
2024-05-19 14:00:22,478 - Training is finished...
2024-05-19 14:00:22,478 - Testing begins...
2024-05-19 14:00:48,574 - ***** Out-of-domain Evaluation results *****
2024-05-19 14:00:48,574 -   aupr_in = 0.7985
2024-05-19 14:00:48,574 -   aupr_out = 0.571
2024-05-19 14:00:48,574 -   auroc = 0.7116
2024-05-19 14:00:48,574 -   der = 0.5353
2024-05-19 14:00:48,574 -   eer = 0.35
2024-05-19 14:00:48,575 -   fpr95 = 0.8212
2024-05-19 14:00:48,575 - Testing is finished...
2024-05-19 14:00:48,575 - Multimodal intent recognition is finished...
2024-05-19 14:00:48,575 - Results are saved in results/results_msz_ablation_MIntRec2.csv
2024-05-19 14:00:48,641 - ============================== Params ==============================
2024-05-19 14:00:48,641 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-05-19 14:00:48,641 - dataset: MIntRec2
2024-05-19 14:00:48,641 - ood_dataset: MIntRec2-OOD
2024-05-19 14:00:48,642 - data_mode: multi-class
2024-05-19 14:00:48,642 - multimodal_method: msz
2024-05-19 14:00:48,642 - method: msz
2024-05-19 14:00:48,642 - ood_detection_method: ma
2024-05-19 14:00:48,642 - text_backbone: bert-base-uncased
2024-05-19 14:00:48,642 - seed: 1
2024-05-19 14:00:48,642 - num_workers: 8
2024-05-19 14:00:48,642 - log_id: msz_ma_MIntRec2_multi-class_0_2024-05-19-13-52-24
2024-05-19 14:00:48,642 - gpu_id: 1
2024-05-19 14:00:48,642 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-19 14:00:48,642 - train: True
2024-05-19 14:00:48,642 - tune: True
2024-05-19 14:00:48,642 - ood: True
2024-05-19 14:00:48,642 - save_model: True
2024-05-19 14:00:48,642 - save_results: True
2024-05-19 14:00:48,642 - log_path: logs
2024-05-19 14:00:48,642 - cache_path: cache
2024-05-19 14:00:48,642 - video_data_path: video_data
2024-05-19 14:00:48,642 - audio_data_path: audio_data
2024-05-19 14:00:48,642 - video_feats_path: swin_feats.pkl
2024-05-19 14:00:48,642 - ood_video_feats_path: swin_feats.pkl
2024-05-19 14:00:48,642 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-19 14:00:48,642 - audio_feats_path: wavlm_feats.pkl
2024-05-19 14:00:48,642 - results_path: results
2024-05-19 14:00:48,642 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz
2024-05-19 14:00:48,642 - model_path: models
2024-05-19 14:00:48,642 - config_file_name: msz_MIntRec21
2024-05-19 14:00:48,642 - results_file_name: results_msz_ablation_MIntRec2.csv
2024-05-19 14:00:48,642 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-19 14:00:48,643 - text_seq_len: 50
2024-05-19 14:00:48,643 - video_seq_len: 180
2024-05-19 14:00:48,643 - audio_seq_len: 400
2024-05-19 14:00:48,643 - text_feat_dim: 768
2024-05-19 14:00:48,643 - video_feat_dim: 256
2024-05-19 14:00:48,643 - audio_feat_dim: 768
2024-05-19 14:00:48,643 - ood_label_id: 30
2024-05-19 14:00:48,643 - num_labels: 30
2024-05-19 14:00:48,643 - num_train_examples: 6165
2024-05-19 14:00:48,643 - need_aligned: True
2024-05-19 14:00:48,643 - freeze_parameters: False
2024-05-19 14:00:48,643 - eval_monitor: acc
2024-05-19 14:00:48,643 - train_batch_size: 32
2024-05-19 14:00:48,643 - eval_batch_size: 16
2024-05-19 14:00:48,643 - num_train_epochs: 100
2024-05-19 14:00:48,643 - lr: [1e-05]
2024-05-19 14:00:48,643 - weight_decay: [0.1]
2024-05-19 14:00:48,643 - wait_patience: 3
2024-05-19 14:00:48,643 - warmup_proportion: [0.01]
2024-05-19 14:00:48,643 - hidden_dims: [768]
2024-05-19 14:00:48,643 - num_attention_heads: [4]
2024-05-19 14:00:48,643 - attention_probs_dropout_prob: [0.3]
2024-05-19 14:00:48,643 - hidden_dropout_prob: [0.3]
2024-05-19 14:00:48,643 - intermediate_size: [768]
2024-05-19 14:00:48,643 - num_hidden_layers: [6]
2024-05-19 14:00:48,643 - max_position_embeddings: [768]
2024-05-19 14:00:48,643 - position_embedding_type: absolute
2024-05-19 14:00:48,643 - batch_first: True
2024-05-19 14:00:48,643 - aligned_method: ['ctc']
2024-05-19 14:00:48,643 - sampler: ['dir']
2024-05-19 14:00:48,644 - multiple_ood: [1]
2024-05-19 14:00:48,644 - select_number_min: [2]
2024-05-19 14:00:48,644 - select_number_max: [3]
2024-05-19 14:00:48,644 - alpha: [2]
2024-05-19 14:00:48,644 - mlp_hidden_size: [256]
2024-05-19 14:00:48,644 - mlp_dropout: [0.3]
2024-05-19 14:00:48,644 - scale: [8]
2024-05-19 14:00:48,644 - ablation: ['no_fusion_add']
2024-05-19 14:00:48,644 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/msz_MIntRec2_bert-base-uncased_multi-class_1
2024-05-19 14:00:48,644 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/msz_MIntRec2_bert-base-uncased_multi-class_1/models
2024-05-19 14:00:48,644 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/binary_msz_MIntRec2_bert-base-uncased_1
2024-05-19 14:00:48,644 - device: cuda
2024-05-19 14:00:48,644 - ============================== End Params ==============================
2024-05-19 14:00:50,395 - Multimodal Intent Recognition begins...
2024-05-19 14:00:50,395 - Training begins...
2024-05-19 14:01:52,905 - ***** Epoch: 1: Eval results *****
2024-05-19 14:01:52,906 -   binary_train_loss = 0.7022
2024-05-19 14:01:52,906 -   binary_eval_score = 0.4982
2024-05-19 14:01:52,906 -   train_loss = 2.92
2024-05-19 14:01:52,906 -   eval_score = 0.4458
2024-05-19 14:01:52,906 -   best_eval_score = 0.0
2024-05-19 14:02:56,831 - ***** Epoch: 2: Eval results *****
2024-05-19 14:02:56,832 -   binary_train_loss = 0.6727
2024-05-19 14:02:56,832 -   binary_eval_score = 0.6989
2024-05-19 14:02:56,832 -   train_loss = 1.6171
2024-05-19 14:02:56,832 -   eval_score = 0.5651
2024-05-19 14:02:56,832 -   best_eval_score = 0.4458
2024-05-19 14:03:59,920 - ***** Epoch: 3: Eval results *****
2024-05-19 14:03:59,920 -   binary_train_loss = 0.6677
2024-05-19 14:03:59,920 -   binary_eval_score = 0.6976
2024-05-19 14:03:59,920 -   train_loss = 1.1807
2024-05-19 14:03:59,920 -   eval_score = 0.5814
2024-05-19 14:03:59,920 -   best_eval_score = 0.5651
2024-05-19 14:05:04,649 - ***** Epoch: 4: Eval results *****
2024-05-19 14:05:04,649 -   binary_train_loss = 0.6568
2024-05-19 14:05:04,649 -   binary_eval_score = 0.7288
2024-05-19 14:05:04,649 -   train_loss = 0.9255
2024-05-19 14:05:04,649 -   eval_score = 0.575
2024-05-19 14:05:04,649 -   best_eval_score = 0.5814
2024-05-19 14:05:04,649 - EarlyStopping counter: 1 out of 3
2024-05-19 14:06:09,776 - ***** Epoch: 5: Eval results *****
2024-05-19 14:06:09,776 -   binary_train_loss = 0.65
2024-05-19 14:06:09,776 -   binary_eval_score = 0.7527
2024-05-19 14:06:09,776 -   train_loss = 0.705
2024-05-19 14:06:09,776 -   eval_score = 0.5778
2024-05-19 14:06:09,776 -   best_eval_score = 0.5814
2024-05-19 14:06:09,777 - EarlyStopping counter: 2 out of 3
2024-05-19 14:07:14,282 - ***** Epoch: 6: Eval results *****
2024-05-19 14:07:14,282 -   binary_train_loss = 0.6305
2024-05-19 14:07:14,282 -   binary_eval_score = 0.7631
2024-05-19 14:07:14,282 -   train_loss = 0.5521
2024-05-19 14:07:14,282 -   eval_score = 0.5859
2024-05-19 14:07:14,282 -   best_eval_score = 0.5814
2024-05-19 14:08:20,063 - ***** Epoch: 7: Eval results *****
2024-05-19 14:08:20,063 -   binary_train_loss = 0.6189
2024-05-19 14:08:20,064 -   binary_eval_score = 0.7477
2024-05-19 14:08:20,064 -   train_loss = 0.4118
2024-05-19 14:08:20,064 -   eval_score = 0.5868
2024-05-19 14:08:20,064 -   best_eval_score = 0.5859
2024-05-19 14:09:25,835 - ***** Epoch: 8: Eval results *****
2024-05-19 14:09:25,836 -   binary_train_loss = 0.5983
2024-05-19 14:09:25,836 -   binary_eval_score = 0.7812
2024-05-19 14:09:25,836 -   train_loss = 0.3265
2024-05-19 14:09:25,836 -   eval_score = 0.5769
2024-05-19 14:09:25,836 -   best_eval_score = 0.5868
2024-05-19 14:09:25,836 - EarlyStopping counter: 1 out of 3
2024-05-19 14:10:30,433 - ***** Epoch: 9: Eval results *****
2024-05-19 14:10:30,434 -   binary_train_loss = 0.5795
2024-05-19 14:10:30,434 -   binary_eval_score = 0.8092
2024-05-19 14:10:30,434 -   train_loss = 0.2588
2024-05-19 14:10:30,434 -   eval_score = 0.5796
2024-05-19 14:10:30,434 -   best_eval_score = 0.5868
2024-05-19 14:10:30,434 - EarlyStopping counter: 2 out of 3
2024-05-19 14:11:35,234 - ***** Epoch: 10: Eval results *****
2024-05-19 14:11:35,234 -   binary_train_loss = 0.5623
2024-05-19 14:11:35,234 -   binary_eval_score = 0.811
2024-05-19 14:11:35,234 -   train_loss = 0.2081
2024-05-19 14:11:35,234 -   eval_score = 0.5741
2024-05-19 14:11:35,234 -   best_eval_score = 0.5868
2024-05-19 14:11:35,234 - EarlyStopping counter: 3 out of 3
2024-05-19 14:11:35,234 - EarlyStopping at epoch 10
2024-05-19 14:11:35,239 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/msz_MIntRec2_bert-base-uncased_multi-class_1/models
2024-05-19 14:11:40,677 - Training is finished...
2024-05-19 14:11:40,677 - Testing begins...
2024-05-19 14:12:07,291 - ***** Out-of-domain Evaluation results *****
2024-05-19 14:12:07,291 -   aupr_in = 0.8056
2024-05-19 14:12:07,292 -   aupr_out = 0.5701
2024-05-19 14:12:07,292 -   auroc = 0.7189
2024-05-19 14:12:07,292 -   der = 0.5479
2024-05-19 14:12:07,292 -   eer = 0.3367
2024-05-19 14:12:07,292 -   fpr95 = 0.8421
2024-05-19 14:12:07,292 - Testing is finished...
2024-05-19 14:12:07,292 - Multimodal intent recognition is finished...
2024-05-19 14:12:07,292 - Results are saved in results/results_msz_ablation_MIntRec2.csv
2024-05-19 14:12:07,351 - ============================== Params ==============================
2024-05-19 14:12:07,351 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-05-19 14:12:07,351 - dataset: MIntRec2
2024-05-19 14:12:07,351 - ood_dataset: MIntRec2-OOD
2024-05-19 14:12:07,351 - data_mode: multi-class
2024-05-19 14:12:07,351 - multimodal_method: msz
2024-05-19 14:12:07,351 - method: msz
2024-05-19 14:12:07,352 - ood_detection_method: ma
2024-05-19 14:12:07,352 - text_backbone: bert-base-uncased
2024-05-19 14:12:07,352 - seed: 2
2024-05-19 14:12:07,352 - num_workers: 8
2024-05-19 14:12:07,352 - log_id: msz_ma_MIntRec2_multi-class_0_2024-05-19-13-52-24
2024-05-19 14:12:07,352 - gpu_id: 1
2024-05-19 14:12:07,352 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-19 14:12:07,352 - train: True
2024-05-19 14:12:07,352 - tune: True
2024-05-19 14:12:07,352 - ood: True
2024-05-19 14:12:07,352 - save_model: True
2024-05-19 14:12:07,352 - save_results: True
2024-05-19 14:12:07,352 - log_path: logs
2024-05-19 14:12:07,352 - cache_path: cache
2024-05-19 14:12:07,352 - video_data_path: video_data
2024-05-19 14:12:07,352 - audio_data_path: audio_data
2024-05-19 14:12:07,352 - video_feats_path: swin_feats.pkl
2024-05-19 14:12:07,352 - ood_video_feats_path: swin_feats.pkl
2024-05-19 14:12:07,352 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-19 14:12:07,352 - audio_feats_path: wavlm_feats.pkl
2024-05-19 14:12:07,352 - results_path: results
2024-05-19 14:12:07,352 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz
2024-05-19 14:12:07,352 - model_path: models
2024-05-19 14:12:07,352 - config_file_name: msz_MIntRec21
2024-05-19 14:12:07,352 - results_file_name: results_msz_ablation_MIntRec2.csv
2024-05-19 14:12:07,352 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-19 14:12:07,352 - text_seq_len: 50
2024-05-19 14:12:07,352 - video_seq_len: 180
2024-05-19 14:12:07,352 - audio_seq_len: 400
2024-05-19 14:12:07,353 - text_feat_dim: 768
2024-05-19 14:12:07,353 - video_feat_dim: 256
2024-05-19 14:12:07,353 - audio_feat_dim: 768
2024-05-19 14:12:07,353 - ood_label_id: 30
2024-05-19 14:12:07,353 - num_labels: 30
2024-05-19 14:12:07,353 - num_train_examples: 6165
2024-05-19 14:12:07,353 - need_aligned: True
2024-05-19 14:12:07,353 - freeze_parameters: False
2024-05-19 14:12:07,353 - eval_monitor: acc
2024-05-19 14:12:07,353 - train_batch_size: 32
2024-05-19 14:12:07,353 - eval_batch_size: 16
2024-05-19 14:12:07,353 - num_train_epochs: 100
2024-05-19 14:12:07,353 - lr: [1e-05]
2024-05-19 14:12:07,353 - weight_decay: [0.1]
2024-05-19 14:12:07,353 - wait_patience: 3
2024-05-19 14:12:07,353 - warmup_proportion: [0.01]
2024-05-19 14:12:07,353 - hidden_dims: [768]
2024-05-19 14:12:07,353 - num_attention_heads: [4]
2024-05-19 14:12:07,353 - attention_probs_dropout_prob: [0.3]
2024-05-19 14:12:07,353 - hidden_dropout_prob: [0.3]
2024-05-19 14:12:07,353 - intermediate_size: [768]
2024-05-19 14:12:07,353 - num_hidden_layers: [6]
2024-05-19 14:12:07,353 - max_position_embeddings: [768]
2024-05-19 14:12:07,353 - position_embedding_type: absolute
2024-05-19 14:12:07,353 - batch_first: True
2024-05-19 14:12:07,353 - aligned_method: ['ctc']
2024-05-19 14:12:07,353 - sampler: ['dir']
2024-05-19 14:12:07,353 - multiple_ood: [1]
2024-05-19 14:12:07,353 - select_number_min: [2]
2024-05-19 14:12:07,354 - select_number_max: [3]
2024-05-19 14:12:07,354 - alpha: [2]
2024-05-19 14:12:07,354 - mlp_hidden_size: [256]
2024-05-19 14:12:07,354 - mlp_dropout: [0.3]
2024-05-19 14:12:07,354 - scale: [8]
2024-05-19 14:12:07,354 - ablation: ['no_fusion_add']
2024-05-19 14:12:07,354 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/msz_MIntRec2_bert-base-uncased_multi-class_2
2024-05-19 14:12:07,354 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/msz_MIntRec2_bert-base-uncased_multi-class_2/models
2024-05-19 14:12:07,354 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/binary_msz_MIntRec2_bert-base-uncased_2
2024-05-19 14:12:07,354 - device: cuda
2024-05-19 14:12:07,354 - ============================== End Params ==============================
2024-05-19 14:12:09,391 - Multimodal Intent Recognition begins...
2024-05-19 14:12:09,391 - Training begins...
2024-05-19 14:13:13,139 - ***** Epoch: 1: Eval results *****
2024-05-19 14:13:13,139 -   binary_train_loss = 0.7066
2024-05-19 14:13:13,139 -   binary_eval_score = 0.505
2024-05-19 14:13:13,139 -   train_loss = 2.9088
2024-05-19 14:13:13,139 -   eval_score = 0.4656
2024-05-19 14:13:13,139 -   best_eval_score = 0.0
2024-05-19 14:14:18,064 - ***** Epoch: 2: Eval results *****
2024-05-19 14:14:18,064 -   binary_train_loss = 0.6758
2024-05-19 14:14:18,064 -   binary_eval_score = 0.6953
2024-05-19 14:14:18,064 -   train_loss = 1.6107
2024-05-19 14:14:18,064 -   eval_score = 0.5705
2024-05-19 14:14:18,064 -   best_eval_score = 0.4656
2024-05-19 14:15:21,128 - ***** Epoch: 3: Eval results *****
2024-05-19 14:15:21,128 -   binary_train_loss = 0.67
2024-05-19 14:15:21,128 -   binary_eval_score = 0.6985
2024-05-19 14:15:21,128 -   train_loss = 1.1845
2024-05-19 14:15:21,128 -   eval_score = 0.5624
2024-05-19 14:15:21,128 -   best_eval_score = 0.5705
2024-05-19 14:15:21,128 - EarlyStopping counter: 1 out of 3
2024-05-19 14:16:26,423 - ***** Epoch: 4: Eval results *****
2024-05-19 14:16:26,424 -   binary_train_loss = 0.6656
2024-05-19 14:16:26,424 -   binary_eval_score = 0.7224
2024-05-19 14:16:26,424 -   train_loss = 0.9238
2024-05-19 14:16:26,424 -   eval_score = 0.5814
2024-05-19 14:16:26,424 -   best_eval_score = 0.5705
2024-05-19 14:17:31,480 - ***** Epoch: 5: Eval results *****
2024-05-19 14:17:31,481 -   binary_train_loss = 0.6547
2024-05-19 14:17:31,481 -   binary_eval_score = 0.7292
2024-05-19 14:17:31,481 -   train_loss = 0.7108
2024-05-19 14:17:31,481 -   eval_score = 0.5859
2024-05-19 14:17:31,481 -   best_eval_score = 0.5814
2024-05-19 14:18:35,702 - ***** Epoch: 6: Eval results *****
2024-05-19 14:18:35,702 -   binary_train_loss = 0.6445
2024-05-19 14:18:35,702 -   binary_eval_score = 0.7627
2024-05-19 14:18:35,702 -   train_loss = 0.5476
2024-05-19 14:18:35,702 -   eval_score = 0.5705
2024-05-19 14:18:35,702 -   best_eval_score = 0.5859
2024-05-19 14:18:35,702 - EarlyStopping counter: 1 out of 3
2024-05-19 14:19:41,211 - ***** Epoch: 7: Eval results *****
2024-05-19 14:19:41,211 -   binary_train_loss = 0.6248
2024-05-19 14:19:41,211 -   binary_eval_score = 0.7563
2024-05-19 14:19:41,211 -   train_loss = 0.4246
2024-05-19 14:19:41,211 -   eval_score = 0.5805
2024-05-19 14:19:41,211 -   best_eval_score = 0.5859
2024-05-19 14:19:41,211 - EarlyStopping counter: 2 out of 3
2024-05-19 14:20:45,559 - ***** Epoch: 8: Eval results *****
2024-05-19 14:20:45,559 -   binary_train_loss = 0.6164
2024-05-19 14:20:45,559 -   binary_eval_score = 0.7744
2024-05-19 14:20:45,559 -   train_loss = 0.325
2024-05-19 14:20:45,559 -   eval_score = 0.5859
2024-05-19 14:20:45,559 -   best_eval_score = 0.5859
2024-05-19 14:20:45,559 - EarlyStopping counter: 3 out of 3
2024-05-19 14:20:45,559 - EarlyStopping at epoch 8
2024-05-19 14:20:45,561 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/msz_MIntRec2_bert-base-uncased_multi-class_2/models
2024-05-19 14:20:51,513 - Training is finished...
2024-05-19 14:20:51,514 - Testing begins...
2024-05-19 14:21:18,457 - ***** Out-of-domain Evaluation results *****
2024-05-19 14:21:18,458 -   aupr_in = 0.8087
2024-05-19 14:21:18,458 -   aupr_out = 0.5851
2024-05-19 14:21:18,458 -   auroc = 0.7276
2024-05-19 14:21:18,458 -   der = 0.5381
2024-05-19 14:21:18,458 -   eer = 0.33
2024-05-19 14:21:18,458 -   fpr95 = 0.8262
2024-05-19 14:21:18,458 - Testing is finished...
2024-05-19 14:21:18,458 - Multimodal intent recognition is finished...
2024-05-19 14:21:18,458 - Results are saved in results/results_msz_ablation_MIntRec2.csv
2024-05-19 14:21:18,521 - ============================== Params ==============================
2024-05-19 14:21:18,522 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-05-19 14:21:18,522 - dataset: MIntRec2
2024-05-19 14:21:18,522 - ood_dataset: MIntRec2-OOD
2024-05-19 14:21:18,522 - data_mode: multi-class
2024-05-19 14:21:18,522 - multimodal_method: msz
2024-05-19 14:21:18,522 - method: msz
2024-05-19 14:21:18,522 - ood_detection_method: ma
2024-05-19 14:21:18,522 - text_backbone: bert-base-uncased
2024-05-19 14:21:18,522 - seed: 3
2024-05-19 14:21:18,522 - num_workers: 8
2024-05-19 14:21:18,522 - log_id: msz_ma_MIntRec2_multi-class_0_2024-05-19-13-52-24
2024-05-19 14:21:18,522 - gpu_id: 1
2024-05-19 14:21:18,522 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-19 14:21:18,522 - train: True
2024-05-19 14:21:18,522 - tune: True
2024-05-19 14:21:18,522 - ood: True
2024-05-19 14:21:18,522 - save_model: True
2024-05-19 14:21:18,522 - save_results: True
2024-05-19 14:21:18,522 - log_path: logs
2024-05-19 14:21:18,522 - cache_path: cache
2024-05-19 14:21:18,522 - video_data_path: video_data
2024-05-19 14:21:18,522 - audio_data_path: audio_data
2024-05-19 14:21:18,522 - video_feats_path: swin_feats.pkl
2024-05-19 14:21:18,523 - ood_video_feats_path: swin_feats.pkl
2024-05-19 14:21:18,523 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-19 14:21:18,523 - audio_feats_path: wavlm_feats.pkl
2024-05-19 14:21:18,523 - results_path: results
2024-05-19 14:21:18,523 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz
2024-05-19 14:21:18,523 - model_path: models
2024-05-19 14:21:18,523 - config_file_name: msz_MIntRec21
2024-05-19 14:21:18,523 - results_file_name: results_msz_ablation_MIntRec2.csv
2024-05-19 14:21:18,523 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-19 14:21:18,523 - text_seq_len: 50
2024-05-19 14:21:18,523 - video_seq_len: 180
2024-05-19 14:21:18,523 - audio_seq_len: 400
2024-05-19 14:21:18,523 - text_feat_dim: 768
2024-05-19 14:21:18,523 - video_feat_dim: 256
2024-05-19 14:21:18,523 - audio_feat_dim: 768
2024-05-19 14:21:18,523 - ood_label_id: 30
2024-05-19 14:21:18,523 - num_labels: 30
2024-05-19 14:21:18,523 - num_train_examples: 6165
2024-05-19 14:21:18,523 - need_aligned: True
2024-05-19 14:21:18,523 - freeze_parameters: False
2024-05-19 14:21:18,523 - eval_monitor: acc
2024-05-19 14:21:18,523 - train_batch_size: 32
2024-05-19 14:21:18,523 - eval_batch_size: 16
2024-05-19 14:21:18,523 - num_train_epochs: 100
2024-05-19 14:21:18,523 - lr: [1e-05]
2024-05-19 14:21:18,524 - weight_decay: [0.1]
2024-05-19 14:21:18,524 - wait_patience: 3
2024-05-19 14:21:18,524 - warmup_proportion: [0.01]
2024-05-19 14:21:18,524 - hidden_dims: [768]
2024-05-19 14:21:18,524 - num_attention_heads: [4]
2024-05-19 14:21:18,524 - attention_probs_dropout_prob: [0.3]
2024-05-19 14:21:18,524 - hidden_dropout_prob: [0.3]
2024-05-19 14:21:18,524 - intermediate_size: [768]
2024-05-19 14:21:18,524 - num_hidden_layers: [6]
2024-05-19 14:21:18,524 - max_position_embeddings: [768]
2024-05-19 14:21:18,524 - position_embedding_type: absolute
2024-05-19 14:21:18,524 - batch_first: True
2024-05-19 14:21:18,524 - aligned_method: ['ctc']
2024-05-19 14:21:18,524 - sampler: ['dir']
2024-05-19 14:21:18,524 - multiple_ood: [1]
2024-05-19 14:21:18,524 - select_number_min: [2]
2024-05-19 14:21:18,524 - select_number_max: [3]
2024-05-19 14:21:18,524 - alpha: [2]
2024-05-19 14:21:18,524 - mlp_hidden_size: [256]
2024-05-19 14:21:18,524 - mlp_dropout: [0.3]
2024-05-19 14:21:18,524 - scale: [8]
2024-05-19 14:21:18,524 - ablation: ['no_fusion_add']
2024-05-19 14:21:18,524 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/msz_MIntRec2_bert-base-uncased_multi-class_3
2024-05-19 14:21:18,524 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/msz_MIntRec2_bert-base-uncased_multi-class_3/models
2024-05-19 14:21:18,525 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/binary_msz_MIntRec2_bert-base-uncased_3
2024-05-19 14:21:18,525 - device: cuda
2024-05-19 14:21:18,525 - ============================== End Params ==============================
2024-05-19 14:21:20,401 - Multimodal Intent Recognition begins...
2024-05-19 14:21:20,401 - Training begins...
2024-05-19 14:22:23,995 - ***** Epoch: 1: Eval results *****
2024-05-19 14:22:23,995 -   binary_train_loss = 0.704
2024-05-19 14:22:23,995 -   binary_eval_score = 0.5362
2024-05-19 14:22:23,996 -   train_loss = 2.8882
2024-05-19 14:22:23,996 -   eval_score = 0.4656
2024-05-19 14:22:23,996 -   best_eval_score = 0.0
2024-05-19 14:23:28,643 - ***** Epoch: 2: Eval results *****
2024-05-19 14:23:28,643 -   binary_train_loss = 0.6749
2024-05-19 14:23:28,643 -   binary_eval_score = 0.736
2024-05-19 14:23:28,643 -   train_loss = 1.6248
2024-05-19 14:23:28,643 -   eval_score = 0.5542
2024-05-19 14:23:28,643 -   best_eval_score = 0.4656
2024-05-19 14:24:33,800 - ***** Epoch: 3: Eval results *****
2024-05-19 14:24:33,801 -   binary_train_loss = 0.6719
2024-05-19 14:24:33,801 -   binary_eval_score = 0.7355
2024-05-19 14:24:33,801 -   train_loss = 1.1908
2024-05-19 14:24:33,801 -   eval_score = 0.5615
2024-05-19 14:24:33,801 -   best_eval_score = 0.5542
2024-05-19 14:25:38,882 - ***** Epoch: 4: Eval results *****
2024-05-19 14:25:38,883 -   binary_train_loss = 0.6622
2024-05-19 14:25:38,883 -   binary_eval_score = 0.7536
2024-05-19 14:25:38,883 -   train_loss = 0.933
2024-05-19 14:25:38,883 -   eval_score = 0.5778
2024-05-19 14:25:38,883 -   best_eval_score = 0.5615
2024-05-19 14:26:43,957 - ***** Epoch: 5: Eval results *****
2024-05-19 14:26:43,957 -   binary_train_loss = 0.652
2024-05-19 14:26:43,957 -   binary_eval_score = 0.7599
2024-05-19 14:26:43,957 -   train_loss = 0.7065
2024-05-19 14:26:43,957 -   eval_score = 0.5696
2024-05-19 14:26:43,957 -   best_eval_score = 0.5778
2024-05-19 14:26:43,957 - EarlyStopping counter: 1 out of 3
2024-05-19 14:27:49,147 - ***** Epoch: 6: Eval results *****
2024-05-19 14:27:49,148 -   binary_train_loss = 0.6413
2024-05-19 14:27:49,148 -   binary_eval_score = 0.7816
2024-05-19 14:27:49,148 -   train_loss = 0.551
2024-05-19 14:27:49,148 -   eval_score = 0.5859
2024-05-19 14:27:49,148 -   best_eval_score = 0.5778
2024-05-19 14:28:53,905 - ***** Epoch: 7: Eval results *****
2024-05-19 14:28:53,906 -   binary_train_loss = 0.6249
2024-05-19 14:28:53,906 -   binary_eval_score = 0.7776
2024-05-19 14:28:53,906 -   train_loss = 0.4068
2024-05-19 14:28:53,906 -   eval_score = 0.5868
2024-05-19 14:28:53,906 -   best_eval_score = 0.5859
2024-05-19 14:29:59,017 - ***** Epoch: 8: Eval results *****
2024-05-19 14:29:59,017 -   binary_train_loss = 0.6042
2024-05-19 14:29:59,017 -   binary_eval_score = 0.792
2024-05-19 14:29:59,017 -   train_loss = 0.3251
2024-05-19 14:29:59,017 -   eval_score = 0.5805
2024-05-19 14:29:59,017 -   best_eval_score = 0.5868
2024-05-19 14:29:59,017 - EarlyStopping counter: 1 out of 3
2024-05-19 14:31:03,749 - ***** Epoch: 9: Eval results *****
2024-05-19 14:31:03,749 -   binary_train_loss = 0.5856
2024-05-19 14:31:03,749 -   binary_eval_score = 0.7916
2024-05-19 14:31:03,750 -   train_loss = 0.2545
2024-05-19 14:31:03,750 -   eval_score = 0.5967
2024-05-19 14:31:03,750 -   best_eval_score = 0.5868
2024-05-19 14:32:07,628 - ***** Epoch: 10: Eval results *****
2024-05-19 14:32:07,628 -   binary_train_loss = 0.5636
2024-05-19 14:32:07,628 -   binary_eval_score = 0.8178
2024-05-19 14:32:07,628 -   train_loss = 0.2143
2024-05-19 14:32:07,628 -   eval_score = 0.5895
2024-05-19 14:32:07,628 -   best_eval_score = 0.5967
2024-05-19 14:32:07,628 - EarlyStopping counter: 1 out of 3
2024-05-19 14:33:11,186 - ***** Epoch: 11: Eval results *****
2024-05-19 14:33:11,186 -   binary_train_loss = 0.5416
2024-05-19 14:33:11,186 -   binary_eval_score = 0.8223
2024-05-19 14:33:11,186 -   train_loss = 0.1833
2024-05-19 14:33:11,187 -   eval_score = 0.5805
2024-05-19 14:33:11,187 -   best_eval_score = 0.5967
2024-05-19 14:33:11,187 - EarlyStopping counter: 2 out of 3
2024-05-19 14:34:16,286 - ***** Epoch: 12: Eval results *****
2024-05-19 14:34:16,286 -   binary_train_loss = 0.532
2024-05-19 14:34:16,286 -   binary_eval_score = 0.858
2024-05-19 14:34:16,286 -   train_loss = 0.1542
2024-05-19 14:34:16,286 -   eval_score = 0.5732
2024-05-19 14:34:16,287 -   best_eval_score = 0.5967
2024-05-19 14:34:16,287 - EarlyStopping counter: 3 out of 3
2024-05-19 14:34:16,287 - EarlyStopping at epoch 12
2024-05-19 14:34:16,289 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/msz_MIntRec2_bert-base-uncased_multi-class_3/models
2024-05-19 14:34:22,846 - Training is finished...
2024-05-19 14:34:22,847 - Testing begins...
2024-05-19 14:34:49,451 - ***** Out-of-domain Evaluation results *****
2024-05-19 14:34:49,452 -   aupr_in = 0.7988
2024-05-19 14:34:49,452 -   aupr_out = 0.5651
2024-05-19 14:34:49,452 -   auroc = 0.7121
2024-05-19 14:34:49,452 -   der = 0.549
2024-05-19 14:34:49,452 -   eer = 0.3425
2024-05-19 14:34:49,452 -   fpr95 = 0.8429
2024-05-19 14:34:49,452 - Testing is finished...
2024-05-19 14:34:49,452 - Multimodal intent recognition is finished...
2024-05-19 14:34:49,452 - Results are saved in results/results_msz_ablation_MIntRec2.csv
2024-05-19 14:34:49,494 - ============================== Params ==============================
2024-05-19 14:34:49,494 - logger_name: msz_ma_MIntRec2_multi-class_0
2024-05-19 14:34:49,494 - dataset: MIntRec2
2024-05-19 14:34:49,494 - ood_dataset: MIntRec2-OOD
2024-05-19 14:34:49,494 - data_mode: multi-class
2024-05-19 14:34:49,494 - multimodal_method: msz
2024-05-19 14:34:49,494 - method: msz
2024-05-19 14:34:49,494 - ood_detection_method: ma
2024-05-19 14:34:49,494 - text_backbone: bert-base-uncased
2024-05-19 14:34:49,494 - seed: 4
2024-05-19 14:34:49,494 - num_workers: 8
2024-05-19 14:34:49,494 - log_id: msz_ma_MIntRec2_multi-class_0_2024-05-19-13-52-24
2024-05-19 14:34:49,494 - gpu_id: 1
2024-05-19 14:34:49,494 - data_path: /home/sharing/disk2/sjh/intentDataset
2024-05-19 14:34:49,494 - train: True
2024-05-19 14:34:49,494 - tune: True
2024-05-19 14:34:49,494 - ood: True
2024-05-19 14:34:49,494 - save_model: True
2024-05-19 14:34:49,494 - save_results: True
2024-05-19 14:34:49,494 - log_path: logs
2024-05-19 14:34:49,494 - cache_path: cache
2024-05-19 14:34:49,494 - video_data_path: video_data
2024-05-19 14:34:49,495 - audio_data_path: audio_data
2024-05-19 14:34:49,495 - video_feats_path: swin_feats.pkl
2024-05-19 14:34:49,495 - ood_video_feats_path: swin_feats.pkl
2024-05-19 14:34:49,495 - ood_audio_feats_path: wavlm_feats.pkl
2024-05-19 14:34:49,495 - audio_feats_path: wavlm_feats.pkl
2024-05-19 14:34:49,495 - results_path: results
2024-05-19 14:34:49,495 - output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz
2024-05-19 14:34:49,495 - model_path: models
2024-05-19 14:34:49,495 - config_file_name: msz_MIntRec21
2024-05-19 14:34:49,495 - results_file_name: results_msz_ablation_MIntRec2.csv
2024-05-19 14:34:49,495 - text_pretrained_model: /home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-05-19 14:34:49,495 - text_seq_len: 50
2024-05-19 14:34:49,495 - video_seq_len: 180
2024-05-19 14:34:49,495 - audio_seq_len: 400
2024-05-19 14:34:49,495 - text_feat_dim: 768
2024-05-19 14:34:49,495 - video_feat_dim: 256
2024-05-19 14:34:49,495 - audio_feat_dim: 768
2024-05-19 14:34:49,495 - ood_label_id: 30
2024-05-19 14:34:49,495 - num_labels: 30
2024-05-19 14:34:49,495 - num_train_examples: 6165
2024-05-19 14:34:49,495 - need_aligned: True
2024-05-19 14:34:49,495 - freeze_parameters: False
2024-05-19 14:34:49,495 - eval_monitor: acc
2024-05-19 14:34:49,495 - train_batch_size: 32
2024-05-19 14:34:49,495 - eval_batch_size: 16
2024-05-19 14:34:49,495 - num_train_epochs: 100
2024-05-19 14:34:49,495 - lr: [1e-05]
2024-05-19 14:34:49,495 - weight_decay: [0.1]
2024-05-19 14:34:49,495 - wait_patience: 3
2024-05-19 14:34:49,495 - warmup_proportion: [0.01]
2024-05-19 14:34:49,495 - hidden_dims: [768]
2024-05-19 14:34:49,495 - num_attention_heads: [4]
2024-05-19 14:34:49,495 - attention_probs_dropout_prob: [0.3]
2024-05-19 14:34:49,495 - hidden_dropout_prob: [0.3]
2024-05-19 14:34:49,495 - intermediate_size: [768]
2024-05-19 14:34:49,495 - num_hidden_layers: [6]
2024-05-19 14:34:49,495 - max_position_embeddings: [768]
2024-05-19 14:34:49,495 - position_embedding_type: absolute
2024-05-19 14:34:49,496 - batch_first: True
2024-05-19 14:34:49,496 - aligned_method: ['ctc']
2024-05-19 14:34:49,496 - sampler: ['dir']
2024-05-19 14:34:49,496 - multiple_ood: [1]
2024-05-19 14:34:49,496 - select_number_min: [2]
2024-05-19 14:34:49,496 - select_number_max: [3]
2024-05-19 14:34:49,496 - alpha: [2]
2024-05-19 14:34:49,496 - mlp_hidden_size: [256]
2024-05-19 14:34:49,496 - mlp_dropout: [0.3]
2024-05-19 14:34:49,496 - scale: [8]
2024-05-19 14:34:49,496 - ablation: ['no_fusion_add']
2024-05-19 14:34:49,496 - pred_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/msz_MIntRec2_bert-base-uncased_multi-class_4
2024-05-19 14:34:49,496 - model_output_path: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/msz_MIntRec2_bert-base-uncased_multi-class_4/models
2024-05-19 14:34:49,496 - pretrained_save_model: /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/binary_msz_MIntRec2_bert-base-uncased_4
2024-05-19 14:34:49,496 - device: cuda
2024-05-19 14:34:49,496 - ============================== End Params ==============================
2024-05-19 14:34:51,542 - Multimodal Intent Recognition begins...
2024-05-19 14:34:51,542 - Training begins...
2024-05-19 14:35:56,261 - ***** Epoch: 1: Eval results *****
2024-05-19 14:35:56,261 -   binary_train_loss = 0.7022
2024-05-19 14:35:56,261 -   binary_eval_score = 0.5298
2024-05-19 14:35:56,261 -   train_loss = 2.9919
2024-05-19 14:35:56,261 -   eval_score = 0.4204
2024-05-19 14:35:56,261 -   best_eval_score = 0.0
2024-05-19 14:37:01,351 - ***** Epoch: 2: Eval results *****
2024-05-19 14:37:01,351 -   binary_train_loss = 0.6675
2024-05-19 14:37:01,351 -   binary_eval_score = 0.7238
2024-05-19 14:37:01,351 -   train_loss = 1.6682
2024-05-19 14:37:01,351 -   eval_score = 0.5479
2024-05-19 14:37:01,352 -   best_eval_score = 0.4204
2024-05-19 14:38:06,021 - ***** Epoch: 3: Eval results *****
2024-05-19 14:38:06,021 -   binary_train_loss = 0.662
2024-05-19 14:38:06,021 -   binary_eval_score = 0.7052
2024-05-19 14:38:06,022 -   train_loss = 1.2205
2024-05-19 14:38:06,022 -   eval_score = 0.5787
2024-05-19 14:38:06,022 -   best_eval_score = 0.5479
2024-05-19 14:39:10,399 - ***** Epoch: 4: Eval results *****
2024-05-19 14:39:10,400 -   binary_train_loss = 0.655
2024-05-19 14:39:10,400 -   binary_eval_score = 0.736
2024-05-19 14:39:10,400 -   train_loss = 0.9588
2024-05-19 14:39:10,400 -   eval_score = 0.5787
2024-05-19 14:39:10,400 -   best_eval_score = 0.5787
2024-05-19 14:39:10,400 - EarlyStopping counter: 1 out of 3
2024-05-19 14:40:15,002 - ***** Epoch: 5: Eval results *****
2024-05-19 14:40:15,002 -   binary_train_loss = 0.6411
2024-05-19 14:40:15,002 -   binary_eval_score = 0.7283
2024-05-19 14:40:15,002 -   train_loss = 0.7349
2024-05-19 14:40:15,002 -   eval_score = 0.5805
2024-05-19 14:40:15,002 -   best_eval_score = 0.5787
2024-05-19 14:41:19,815 - ***** Epoch: 6: Eval results *****
2024-05-19 14:41:19,815 -   binary_train_loss = 0.6308
2024-05-19 14:41:19,815 -   binary_eval_score = 0.7491
2024-05-19 14:41:19,815 -   train_loss = 0.5604
2024-05-19 14:41:19,815 -   eval_score = 0.5759
2024-05-19 14:41:19,815 -   best_eval_score = 0.5805
2024-05-19 14:41:19,815 - EarlyStopping counter: 1 out of 3
2024-05-19 14:42:24,901 - ***** Epoch: 7: Eval results *****
2024-05-19 14:42:24,902 -   binary_train_loss = 0.6138
2024-05-19 14:42:24,902 -   binary_eval_score = 0.7505
2024-05-19 14:42:24,902 -   train_loss = 0.4287
2024-05-19 14:42:24,902 -   eval_score = 0.5832
2024-05-19 14:42:24,902 -   best_eval_score = 0.5805
2024-05-19 14:43:30,026 - ***** Epoch: 8: Eval results *****
2024-05-19 14:43:30,026 -   binary_train_loss = 0.5979
2024-05-19 14:43:30,026 -   binary_eval_score = 0.7825
2024-05-19 14:43:30,026 -   train_loss = 0.3293
2024-05-19 14:43:30,026 -   eval_score = 0.5823
2024-05-19 14:43:30,026 -   best_eval_score = 0.5832
2024-05-19 14:43:30,026 - EarlyStopping counter: 1 out of 3
2024-05-19 14:44:35,158 - ***** Epoch: 9: Eval results *****
2024-05-19 14:44:35,158 -   binary_train_loss = 0.5755
2024-05-19 14:44:35,158 -   binary_eval_score = 0.7866
2024-05-19 14:44:35,158 -   train_loss = 0.271
2024-05-19 14:44:35,158 -   eval_score = 0.5832
2024-05-19 14:44:35,158 -   best_eval_score = 0.5832
2024-05-19 14:44:35,158 - EarlyStopping counter: 2 out of 3
2024-05-19 14:45:39,953 - ***** Epoch: 10: Eval results *****
2024-05-19 14:45:39,953 -   binary_train_loss = 0.5607
2024-05-19 14:45:39,953 -   binary_eval_score = 0.8092
2024-05-19 14:45:39,953 -   train_loss = 0.2146
2024-05-19 14:45:39,953 -   eval_score = 0.575
2024-05-19 14:45:39,953 -   best_eval_score = 0.5832
2024-05-19 14:45:39,953 - EarlyStopping counter: 3 out of 3
2024-05-19 14:45:39,953 - EarlyStopping at epoch 10
2024-05-19 14:45:39,956 - Trained models are saved in /home/sharing/disk2/sjh/Outputs/OOD_MIntRec2/ablation/no_fusion_add_msz/msz_MIntRec2_bert-base-uncased_multi-class_4/models
2024-05-19 14:45:47,140 - Training is finished...
2024-05-19 14:45:47,141 - Testing begins...
2024-05-19 14:46:13,605 - ***** Out-of-domain Evaluation results *****
2024-05-19 14:46:13,605 -   aupr_in = 0.802
2024-05-19 14:46:13,605 -   aupr_out = 0.5747
2024-05-19 14:46:13,606 -   auroc = 0.7186
2024-05-19 14:46:13,606 -   der = 0.5383
2024-05-19 14:46:13,606 -   eer = 0.3308
2024-05-19 14:46:13,606 -   fpr95 = 0.8262
2024-05-19 14:46:13,606 - Testing is finished...
2024-05-19 14:46:13,606 - Multimodal intent recognition is finished...
2024-05-19 14:46:13,606 - Results are saved in results/results_msz_ablation_MIntRec2.csv
