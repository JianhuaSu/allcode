2024-10-07 17:42:54,450 - Detection - Open Intent Detection Begin...
2024-10-07 17:42:54,450 - Detection - Parameters Initialization...
2024-10-07 17:42:54,450 - Detection - Data and Model Preparation...
2024-10-07 17:42:54,450 - Detection - The number of known intents is 19
2024-10-07 17:42:54,450 - Detection - Lists of known labels are: ['pending_transfer', 'transfer_not_received_by_recipient', 'top_up_limits', 'pending_top_up', 'card_linking', 'declined_card_payment', 'visa_or_mastercard', 'contactless_not_working', 'direct_debit_payment_not_recognised', 'atm_support', 'card_swallowed', 'why_verify_identity', 'lost_or_stolen_phone', 'automatic_top_up', 'fiat_currency_support', 'pending_cash_withdrawal', 'getting_virtual_card', 'cash_withdrawal_charge', 'card_about_to_expire']
2024-10-07 17:42:54,473 - Detection - Number of labeled training samples = 2158
2024-10-07 17:42:54,473 - Detection - Number of unlabeled training samples = 6845
2024-10-07 17:42:54,475 - Detection - Number of evaluation samples = 241
2024-10-07 17:42:54,481 - Detection - Number of testing samples = 3080
2024-10-07 17:42:56,761 - Detection - ============================== Params ==============================
2024-10-07 17:42:56,762 - Detection - type:	open_intent_detection
2024-10-07 17:42:56,762 - Detection - logger_name:	Detection
2024-10-07 17:42:56,762 - Detection - log_dir:	logs
2024-10-07 17:42:56,762 - Detection - dataset:	banking
2024-10-07 17:42:56,762 - Detection - known_cls_ratio:	0.25
2024-10-07 17:42:56,762 - Detection - labeled_ratio:	1.0
2024-10-07 17:42:56,762 - Detection - method:	ADB
2024-10-07 17:42:56,762 - Detection - train:	True
2024-10-07 17:42:56,762 - Detection - tune:	True
2024-10-07 17:42:56,762 - Detection - pretrain:	True
2024-10-07 17:42:56,762 - Detection - b_train:	False
2024-10-07 17:42:56,762 - Detection - save_model:	True
2024-10-07 17:42:56,762 - Detection - backbone:	bert
2024-10-07 17:42:56,762 - Detection - config_file_name:	ADB_oos1
2024-10-07 17:42:56,762 - Detection - seed:	4
2024-10-07 17:42:56,762 - Detection - gpu_id:	1
2024-10-07 17:42:56,762 - Detection - pipe_results_path:	pipe_results
2024-10-07 17:42:56,762 - Detection - data_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb/open_intent_detection/../data
2024-10-07 17:42:56,762 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/output
2024-10-07 17:42:56,762 - Detection - model_dir:	models
2024-10-07 17:42:56,762 - Detection - load_pretrained_method:	None
2024-10-07 17:42:56,762 - Detection - result_dir:	results
2024-10-07 17:42:56,762 - Detection - results_file_name:	results_ADB_banking_noloss.csv
2024-10-07 17:42:56,762 - Detection - save_results:	True
2024-10-07 17:42:56,762 - Detection - loss_fct:	CrossEntropyLoss
2024-10-07 17:42:56,762 - Detection - dataset_neg:	SQUAD
2024-10-07 17:42:56,762 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/output/open_intent_detection/ADB_banking_0.25_1.0_bert_4
2024-10-07 17:42:56,762 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/output/open_intent_detection/ADB_banking_0.25_1.0_bert_4/models
2024-10-07 17:42:56,762 - Detection - bert_model:	/home/sharing/disk1/pretrained_embedding/bert/uncased_L-12_H-768_A-12/
2024-10-07 17:42:56,762 - Detection - num_train_epochs:	100
2024-10-07 17:42:56,762 - Detection - num_labels:	19
2024-10-07 17:42:56,762 - Detection - max_seq_length:	55
2024-10-07 17:42:56,762 - Detection - freeze_backbone_parameters:	True
2024-10-07 17:42:56,762 - Detection - feat_dim:	768
2024-10-07 17:42:56,762 - Detection - warmup_proportion:	0.1
2024-10-07 17:42:56,762 - Detection - lr_boundary:	0.05
2024-10-07 17:42:56,762 - Detection - lr:	2e-05
2024-10-07 17:42:56,762 - Detection - activation:	relu
2024-10-07 17:42:56,762 - Detection - train_batch_size:	128
2024-10-07 17:42:56,762 - Detection - eval_batch_size:	64
2024-10-07 17:42:56,762 - Detection - test_batch_size:	64
2024-10-07 17:42:56,762 - Detection - wait_patient:	10
2024-10-07 17:42:56,762 - Detection - safe1:	0.8
2024-10-07 17:42:56,762 - Detection - safe2:	0.7
2024-10-07 17:42:56,762 - Detection - neg_weight:	0.5
2024-10-07 17:42:56,762 - Detection - margin:	0
2024-10-07 17:42:56,762 - Detection - p:	2
2024-10-07 17:42:56,762 - Detection - loss_weight:	1
2024-10-07 17:42:56,762 - Detection - supcon_loss_weight:	0
2024-10-07 17:42:56,762 - Detection - triplet_loss_weight:	0
2024-10-07 17:42:56,762 - Detection - unseen_label_id:	19
2024-10-07 17:42:56,762 - Detection - anum_labels:	20
2024-10-07 17:42:56,762 - Detection - ============================== End Params ==============================
2024-10-07 17:42:57,789 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-07 17:42:59,060 - Detection - Pre-training Begin...
2024-10-07 17:43:03,085 - Detection - ***** Epoch: 1: Eval results *****
2024-10-07 17:43:03,085 - Detection -   best_eval_score = 0
2024-10-07 17:43:03,085 - Detection -   eval_score = 7.88
2024-10-07 17:43:03,085 - Detection -   train_loss = 2.936254529392018
2024-10-07 17:43:06,395 - Detection - ***** Epoch: 2: Eval results *****
2024-10-07 17:43:06,395 - Detection -   best_eval_score = 7.88
2024-10-07 17:43:06,395 - Detection -   eval_score = 13.69
2024-10-07 17:43:06,395 - Detection -   train_loss = 2.911138520521276
2024-10-07 17:43:09,752 - Detection - ***** Epoch: 3: Eval results *****
2024-10-07 17:43:09,752 - Detection -   best_eval_score = 13.69
2024-10-07 17:43:09,752 - Detection -   eval_score = 23.24
2024-10-07 17:43:09,752 - Detection -   train_loss = 2.860896909938139
2024-10-07 17:43:13,065 - Detection - ***** Epoch: 4: Eval results *****
2024-10-07 17:43:13,065 - Detection -   best_eval_score = 23.24
2024-10-07 17:43:13,065 - Detection -   eval_score = 42.32
2024-10-07 17:43:13,065 - Detection -   train_loss = 2.7694803686702953
2024-10-07 17:43:16,333 - Detection - ***** Epoch: 5: Eval results *****
2024-10-07 17:43:16,333 - Detection -   best_eval_score = 42.32
2024-10-07 17:43:16,333 - Detection -   eval_score = 63.07
2024-10-07 17:43:16,333 - Detection -   train_loss = 2.5624328080345604
2024-10-07 17:43:19,663 - Detection - ***** Epoch: 6: Eval results *****
2024-10-07 17:43:19,663 - Detection -   best_eval_score = 63.07
2024-10-07 17:43:19,663 - Detection -   eval_score = 72.2
2024-10-07 17:43:19,663 - Detection -   train_loss = 2.108108225990744
2024-10-07 17:43:22,961 - Detection - ***** Epoch: 7: Eval results *****
2024-10-07 17:43:22,961 - Detection -   best_eval_score = 72.2
2024-10-07 17:43:22,961 - Detection -   eval_score = 81.33
2024-10-07 17:43:22,961 - Detection -   train_loss = 1.47681225047392
2024-10-07 17:43:26,327 - Detection - ***** Epoch: 8: Eval results *****
2024-10-07 17:43:26,327 - Detection -   best_eval_score = 81.33
2024-10-07 17:43:26,327 - Detection -   eval_score = 90.04
2024-10-07 17:43:26,327 - Detection -   train_loss = 0.9528203501420862
2024-10-07 17:43:29,682 - Detection - ***** Epoch: 9: Eval results *****
2024-10-07 17:43:29,682 - Detection -   best_eval_score = 90.04
2024-10-07 17:43:29,682 - Detection -   eval_score = 93.36
2024-10-07 17:43:29,683 - Detection -   train_loss = 0.6158060606788186
2024-10-07 17:43:33,051 - Detection - ***** Epoch: 10: Eval results *****
2024-10-07 17:43:33,051 - Detection -   best_eval_score = 93.36
2024-10-07 17:43:33,051 - Detection -   eval_score = 95.02
2024-10-07 17:43:33,052 - Detection -   train_loss = 0.41822125806527977
2024-10-07 17:43:36,321 - Detection - ***** Epoch: 11: Eval results *****
2024-10-07 17:43:36,321 - Detection -   best_eval_score = 95.02
2024-10-07 17:43:36,321 - Detection -   eval_score = 96.27
2024-10-07 17:43:36,321 - Detection -   train_loss = 0.3092411923057893
2024-10-07 17:43:39,618 - Detection - ***** Epoch: 12: Eval results *****
2024-10-07 17:43:39,618 - Detection -   best_eval_score = 96.27
2024-10-07 17:43:39,618 - Detection -   eval_score = 97.51
2024-10-07 17:43:39,618 - Detection -   train_loss = 0.241291946348022
2024-10-07 17:43:42,932 - Detection - ***** Epoch: 13: Eval results *****
2024-10-07 17:43:42,932 - Detection -   best_eval_score = 97.51
2024-10-07 17:43:42,932 - Detection -   eval_score = 96.68
2024-10-07 17:43:42,932 - Detection -   train_loss = 0.19954500040587256
2024-10-07 17:43:46,238 - Detection - ***** Epoch: 14: Eval results *****
2024-10-07 17:43:46,238 - Detection -   best_eval_score = 97.51
2024-10-07 17:43:46,238 - Detection -   eval_score = 97.1
2024-10-07 17:43:46,238 - Detection -   train_loss = 0.16525755209081314
2024-10-07 17:43:49,553 - Detection - ***** Epoch: 15: Eval results *****
2024-10-07 17:43:49,553 - Detection -   best_eval_score = 97.51
2024-10-07 17:43:49,553 - Detection -   eval_score = 97.1
2024-10-07 17:43:49,553 - Detection -   train_loss = 0.1453730310587322
2024-10-07 17:43:52,799 - Detection - ***** Epoch: 16: Eval results *****
2024-10-07 17:43:52,799 - Detection -   best_eval_score = 97.51
2024-10-07 17:43:52,799 - Detection -   eval_score = 97.1
2024-10-07 17:43:52,799 - Detection -   train_loss = 0.12280554149080725
2024-10-07 17:43:56,075 - Detection - ***** Epoch: 17: Eval results *****
2024-10-07 17:43:56,076 - Detection -   best_eval_score = 97.51
2024-10-07 17:43:56,076 - Detection -   eval_score = 97.51
2024-10-07 17:43:56,076 - Detection -   train_loss = 0.11107987603720497
2024-10-07 17:43:59,290 - Detection - ***** Epoch: 18: Eval results *****
2024-10-07 17:43:59,291 - Detection -   best_eval_score = 97.51
2024-10-07 17:43:59,291 - Detection -   eval_score = 97.1
2024-10-07 17:43:59,291 - Detection -   train_loss = 0.10114860951023943
2024-10-07 17:44:02,588 - Detection - ***** Epoch: 19: Eval results *****
2024-10-07 17:44:02,588 - Detection -   best_eval_score = 97.51
2024-10-07 17:44:02,588 - Detection -   eval_score = 97.51
2024-10-07 17:44:02,588 - Detection -   train_loss = 0.0847346388241824
2024-10-07 17:44:05,968 - Detection - ***** Epoch: 20: Eval results *****
2024-10-07 17:44:05,968 - Detection -   best_eval_score = 97.51
2024-10-07 17:44:05,968 - Detection -   eval_score = 97.1
2024-10-07 17:44:05,968 - Detection -   train_loss = 0.07871154323220253
2024-10-07 17:44:09,252 - Detection - ***** Epoch: 21: Eval results *****
2024-10-07 17:44:09,252 - Detection -   best_eval_score = 97.51
2024-10-07 17:44:09,252 - Detection -   eval_score = 97.51
2024-10-07 17:44:09,252 - Detection -   train_loss = 0.07301129159681938
2024-10-07 17:44:12,508 - Detection - ***** Epoch: 22: Eval results *****
2024-10-07 17:44:12,508 - Detection -   best_eval_score = 97.51
2024-10-07 17:44:12,508 - Detection -   eval_score = 97.1
2024-10-07 17:44:12,508 - Detection -   train_loss = 0.06746381082955528
2024-10-07 17:44:12,509 - Detection - Trained models are saved in /home/sharing/disk3/wangyifan/sujianhua/output/open_intent_detection/ADB_banking_0.25_1.0_bert_4/models
2024-10-07 17:44:13,933 - Detection - Pre-training finished...
2024-10-07 17:44:13,934 - Detection - Training Begin...
2024-10-07 17:44:24,690 - Detection - ***** Epoch: 1: Eval results *****
2024-10-07 17:44:24,691 - Detection -   best_eval_score = 0
2024-10-07 17:44:24,691 - Detection -   eval_score = 1.43
2024-10-07 17:44:24,691 - Detection -   train_loss = 10.185595792882582
2024-10-07 17:44:27,226 - Detection - ***** Epoch: 2: Eval results *****
2024-10-07 17:44:27,226 - Detection -   best_eval_score = 1.43
2024-10-07 17:44:27,226 - Detection -   eval_score = 3.61
2024-10-07 17:44:27,226 - Detection -   train_loss = 9.38237465129179
2024-10-07 17:44:29,863 - Detection - ***** Epoch: 3: Eval results *****
2024-10-07 17:44:29,863 - Detection -   best_eval_score = 3.61
2024-10-07 17:44:29,863 - Detection -   eval_score = 13.12
2024-10-07 17:44:29,863 - Detection -   train_loss = 8.366964003619026
2024-10-07 17:44:33,122 - Detection - ***** Epoch: 4: Eval results *****
2024-10-07 17:44:33,122 - Detection -   best_eval_score = 13.12
2024-10-07 17:44:33,122 - Detection -   eval_score = 25.96
2024-10-07 17:44:33,122 - Detection -   train_loss = 7.2757783497081085
2024-10-07 17:44:35,804 - Detection - ***** Epoch: 5: Eval results *****
2024-10-07 17:44:35,804 - Detection -   best_eval_score = 25.96
2024-10-07 17:44:35,804 - Detection -   eval_score = 42.73
2024-10-07 17:44:35,804 - Detection -   train_loss = 6.214576328501982
2024-10-07 17:44:38,388 - Detection - ***** Epoch: 6: Eval results *****
2024-10-07 17:44:38,388 - Detection -   best_eval_score = 42.73
2024-10-07 17:44:38,392 - Detection -   eval_score = 62.63
2024-10-07 17:44:38,392 - Detection -   train_loss = 5.271508301005644
2024-10-07 17:44:41,092 - Detection - ***** Epoch: 7: Eval results *****
2024-10-07 17:44:41,092 - Detection -   best_eval_score = 62.63
2024-10-07 17:44:41,092 - Detection -   eval_score = 69.01
2024-10-07 17:44:41,092 - Detection -   train_loss = 4.461852662703571
2024-10-07 17:44:44,245 - Detection - ***** Epoch: 8: Eval results *****
2024-10-07 17:44:44,245 - Detection -   best_eval_score = 69.01
2024-10-07 17:44:44,245 - Detection -   eval_score = 78.92
2024-10-07 17:44:44,245 - Detection -   train_loss = 3.847182273864746
2024-10-07 17:44:47,289 - Detection - ***** Epoch: 9: Eval results *****
2024-10-07 17:44:47,289 - Detection -   best_eval_score = 78.92
2024-10-07 17:44:47,290 - Detection -   eval_score = 80.78
2024-10-07 17:44:47,290 - Detection -   train_loss = 3.427904395496144
2024-10-07 17:44:49,835 - Detection - ***** Epoch: 10: Eval results *****
2024-10-07 17:44:49,835 - Detection -   best_eval_score = 80.78
2024-10-07 17:44:49,835 - Detection -   eval_score = 83.94
2024-10-07 17:44:49,835 - Detection -   train_loss = 3.1072870563058292
2024-10-07 17:44:53,203 - Detection - ***** Epoch: 11: Eval results *****
2024-10-07 17:44:53,203 - Detection -   best_eval_score = 83.94
2024-10-07 17:44:53,203 - Detection -   eval_score = 86.4
2024-10-07 17:44:53,203 - Detection -   train_loss = 2.899390697479248
2024-10-07 17:44:55,834 - Detection - ***** Epoch: 12: Eval results *****
2024-10-07 17:44:55,834 - Detection -   best_eval_score = 86.4
2024-10-07 17:44:55,834 - Detection -   eval_score = 87.4
2024-10-07 17:44:55,834 - Detection -   train_loss = 2.829023010590497
2024-10-07 17:44:59,314 - Detection - ***** Epoch: 13: Eval results *****
2024-10-07 17:44:59,315 - Detection -   best_eval_score = 87.4
2024-10-07 17:44:59,315 - Detection -   eval_score = 88.07
2024-10-07 17:44:59,315 - Detection -   train_loss = 2.800779006060432
2024-10-07 17:45:02,894 - Detection - ***** Epoch: 14: Eval results *****
2024-10-07 17:45:02,894 - Detection -   best_eval_score = 88.07
2024-10-07 17:45:02,894 - Detection -   eval_score = 88.07
2024-10-07 17:45:02,894 - Detection -   train_loss = 2.8304560885709873
2024-10-07 17:45:06,511 - Detection - ***** Epoch: 15: Eval results *****
2024-10-07 17:45:06,511 - Detection -   best_eval_score = 88.07
2024-10-07 17:45:06,511 - Detection -   eval_score = 88.07
2024-10-07 17:45:06,511 - Detection -   train_loss = 2.8192626728731045
2024-10-07 17:45:09,756 - Detection - ***** Epoch: 16: Eval results *****
2024-10-07 17:45:09,757 - Detection -   best_eval_score = 88.07
2024-10-07 17:45:09,757 - Detection -   eval_score = 88.07
2024-10-07 17:45:09,757 - Detection -   train_loss = 2.81073540799758
2024-10-07 17:45:13,285 - Detection - ***** Epoch: 17: Eval results *****
2024-10-07 17:45:13,285 - Detection -   best_eval_score = 88.07
2024-10-07 17:45:13,285 - Detection -   eval_score = 88.07
2024-10-07 17:45:13,285 - Detection -   train_loss = 2.800817279254689
2024-10-07 17:45:16,854 - Detection - ***** Epoch: 18: Eval results *****
2024-10-07 17:45:16,854 - Detection -   best_eval_score = 88.07
2024-10-07 17:45:16,854 - Detection -   eval_score = 87.78
2024-10-07 17:45:16,854 - Detection -   train_loss = 2.8361276037552776
2024-10-07 17:45:19,995 - Detection - ***** Epoch: 19: Eval results *****
2024-10-07 17:45:19,995 - Detection -   best_eval_score = 88.07
2024-10-07 17:45:19,995 - Detection -   eval_score = 88.07
2024-10-07 17:45:19,995 - Detection -   train_loss = 2.82690990672392
2024-10-07 17:45:23,554 - Detection - ***** Epoch: 20: Eval results *****
2024-10-07 17:45:23,554 - Detection -   best_eval_score = 88.07
2024-10-07 17:45:23,554 - Detection -   eval_score = 88.07
2024-10-07 17:45:23,554 - Detection -   train_loss = 2.8008132962619556
2024-10-07 17:45:27,086 - Detection - ***** Epoch: 21: Eval results *****
2024-10-07 17:45:27,086 - Detection -   best_eval_score = 88.07
2024-10-07 17:45:27,086 - Detection -   eval_score = 87.7
2024-10-07 17:45:27,086 - Detection -   train_loss = 2.806510967366836
2024-10-07 17:45:30,353 - Detection - ***** Epoch: 22: Eval results *****
2024-10-07 17:45:30,354 - Detection -   best_eval_score = 88.07
2024-10-07 17:45:30,354 - Detection -   eval_score = 88.07
2024-10-07 17:45:30,354 - Detection -   train_loss = 2.826095833497889
2024-10-07 17:45:33,854 - Detection - ***** Epoch: 23: Eval results *****
2024-10-07 17:45:33,854 - Detection -   best_eval_score = 88.07
2024-10-07 17:45:33,854 - Detection -   eval_score = 88.07
2024-10-07 17:45:33,854 - Detection -   train_loss = 2.8219016299528232
2024-10-07 17:45:33,855 - Detection - Training Finished...
2024-10-07 17:45:33,855 - Detection - Testing begin...
2024-10-07 17:45:36,164 - Detection - ***** Test: Confusion Matrix *****
2024-10-07 17:45:36,165 - Detection - [[  33    4    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    3]
 [   3   33    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    4]
 [   0    0   39    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    1]
 [   0    0    0   29    0    0    0    0    0    0    0    0    0    0
     0    0    0    0    0   11]
 [   0    0    0    0   38    0    0    0    0    0    0    0    0    0
     0    0    0    0    0    2]
 [   0    0    0    0    0   38    0    0    0    0    0    0    0    0
     0    0    0    0    0    2]
 [   0    0    0    0    0    0   36    0    0    0    0    0    0    0
     0    0    0    0    0    4]
 [   0    0    0    0    0    0    0   24    0    0    0    0    0    0
     0    0    0    0    0   16]
 [   0    0    0    0    0    0    0    0   28    0    0    0    0    0
     0    0    0    0    0   12]
 [   0    0    0    0    0    0    0    0    0   35    0    0    0    0
     0    0    0    0    0    5]
 [   0    0    0    0    0    1    0    0    0    0   32    0    0    0
     0    1    0    0    0    6]
 [   0    0    0    0    0    0    0    0    0    0    0   39    0    0
     0    0    0    0    0    1]
 [   0    0    0    0    0    0    0    0    0    0    0    0   35    0
     0    0    0    0    0    5]
 [   0    0    2    0    0    0    0    0    0    0    0    0    0   32
     0    0    0    0    0    6]
 [   0    1    0    0    0    0    0    0    0    0    0    0    0    0
    35    0    0    0    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0   31    0    0    0    9]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0   38    0    0    2]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0   36    0    4]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
     0    0    0    0   37    3]
 [  52   56    4   43   43   35    4   26   13    2    2   66    0   11
   109   12   41   34    4 1763]]
2024-10-07 17:45:36,166 - Detection - ***** Test results *****
2024-10-07 17:45:36,166 - Detection -   Acc = 78.28
2024-10-07 17:45:36,166 - Detection -   F1 = 70.2384
2024-10-07 17:45:36,166 - Detection -   F1-known = 69.4986
2024-10-07 17:45:36,166 - Detection -   F1-open = 84.2936
2024-10-07 17:45:36,166 - Detection - Testing finished...
2024-10-07 17:45:36,166 - Detection - Results saved in results/results_ADB_banking_noloss.csv
2024-10-07 17:45:36,191 - Detection - Open Intent Detection Finished...
