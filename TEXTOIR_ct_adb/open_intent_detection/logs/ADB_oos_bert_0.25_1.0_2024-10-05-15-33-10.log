2024-10-05 15:33:10,104 - Detection - Open Intent Detection Begin...
2024-10-05 15:33:10,104 - Detection - Parameters Initialization...
2024-10-05 15:33:10,105 - Detection - Data and Model Preparation...
2024-10-05 15:33:10,105 - Detection - The number of known intents is 38
2024-10-05 15:33:10,106 - Detection - Lists of known labels are: ['calories', 'report_fraud', 'next_song', 'cancel_reservation', 'translate', 'ingredients_list', 'what_are_your_hobbies', 'food_last', 'credit_limit_change', 'thank_you', 'reminder', 'are_you_a_bot', 'restaurant_reviews', 'how_busy', 'oil_change_how', 'flight_status', 'recipe', 'maybe', 'current_location', 'direct_deposit', 'pto_request_status', 'payday', 'nutrition_info', 'expiration_date', 'tire_pressure', 'report_lost_card', 'date', 'carry_on', 'new_card', 'whisper_mode', 'pto_used', 'uber', 'measurement_conversion', 'traffic', 'spelling', 'gas_type', 'improve_credit_score', 'credit_limit']
2024-10-05 15:33:10,159 - Detection - Number of labeled training samples = 3800
2024-10-05 15:33:10,159 - Detection - Number of unlabeled training samples = 11200
2024-10-05 15:33:10,168 - Detection - Number of evaluation samples = 760
2024-10-05 15:33:10,184 - Detection - Number of testing samples = 5700
2024-10-05 15:33:15,051 - Detection - ============================== Params ==============================
2024-10-05 15:33:15,051 - Detection - type:	open_intent_detection
2024-10-05 15:33:15,051 - Detection - logger_name:	Detection
2024-10-05 15:33:15,051 - Detection - log_dir:	logs
2024-10-05 15:33:15,051 - Detection - dataset:	oos
2024-10-05 15:33:15,052 - Detection - known_cls_ratio:	0.25
2024-10-05 15:33:15,052 - Detection - labeled_ratio:	1.0
2024-10-05 15:33:15,052 - Detection - method:	ADB
2024-10-05 15:33:15,052 - Detection - train:	True
2024-10-05 15:33:15,052 - Detection - tune:	True
2024-10-05 15:33:15,052 - Detection - pretrain:	True
2024-10-05 15:33:15,052 - Detection - b_train:	False
2024-10-05 15:33:15,052 - Detection - save_model:	False
2024-10-05 15:33:15,052 - Detection - backbone:	bert
2024-10-05 15:33:15,052 - Detection - config_file_name:	ADB
2024-10-05 15:33:15,052 - Detection - seed:	1
2024-10-05 15:33:15,052 - Detection - gpu_id:	0
2024-10-05 15:33:15,052 - Detection - pipe_results_path:	pipe_results
2024-10-05 15:33:15,052 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 15:33:15,052 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 15:33:15,052 - Detection - model_dir:	models
2024-10-05 15:33:15,052 - Detection - load_pretrained_method:	None
2024-10-05 15:33:15,052 - Detection - result_dir:	results
2024-10-05 15:33:15,052 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 15:33:15,052 - Detection - save_results:	True
2024-10-05 15:33:15,052 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 15:33:15,052 - Detection - dataset_neg:	SQUAD
2024-10-05 15:33:15,052 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1
2024-10-05 15:33:15,052 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1/models
2024-10-05 15:33:15,052 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 15:33:15,052 - Detection - num_train_epochs:	100
2024-10-05 15:33:15,052 - Detection - num_labels:	38
2024-10-05 15:33:15,052 - Detection - max_seq_length:	30
2024-10-05 15:33:15,052 - Detection - freeze_backbone_parameters:	True
2024-10-05 15:33:15,052 - Detection - feat_dim:	768
2024-10-05 15:33:15,052 - Detection - warmup_proportion:	0.1
2024-10-05 15:33:15,052 - Detection - lr_boundary:	0.05
2024-10-05 15:33:15,052 - Detection - lr:	2e-05
2024-10-05 15:33:15,052 - Detection - activation:	relu
2024-10-05 15:33:15,052 - Detection - train_batch_size:	128
2024-10-05 15:33:15,052 - Detection - eval_batch_size:	64
2024-10-05 15:33:15,052 - Detection - test_batch_size:	64
2024-10-05 15:33:15,052 - Detection - wait_patient:	10
2024-10-05 15:33:15,052 - Detection - safe1:	0.3
2024-10-05 15:33:15,053 - Detection - safe2:	0.3
2024-10-05 15:33:15,053 - Detection - neg_weight:	0.3
2024-10-05 15:33:15,053 - Detection - margin:	0.8
2024-10-05 15:33:15,053 - Detection - p:	2
2024-10-05 15:33:15,053 - Detection - loss_weight:	1
2024-10-05 15:33:15,053 - Detection - supcon_loss_weight:	0.7
2024-10-05 15:33:15,053 - Detection - triplet_loss_weight:	0.9
2024-10-05 15:33:15,053 - Detection - unseen_label_id:	38
2024-10-05 15:33:15,053 - Detection - anum_labels:	39
2024-10-05 15:33:15,053 - Detection - ============================== End Params ==============================
2024-10-05 15:33:16,273 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 15:33:17,434 - Detection - Pre-training Begin...
2024-10-05 15:33:23,028 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 15:33:23,028 - Detection -   best_eval_score = 0
2024-10-05 15:33:23,029 - Detection -   eval_score = 2.63
2024-10-05 15:33:23,029 - Detection -   train_loss = 8.840952650705974
2024-10-05 15:33:27,807 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 15:33:27,808 - Detection -   best_eval_score = 2.63
2024-10-05 15:33:27,808 - Detection -   eval_score = 2.37
2024-10-05 15:33:27,808 - Detection -   train_loss = 8.413834857940675
2024-10-05 15:33:32,578 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 15:33:32,578 - Detection -   best_eval_score = 2.63
2024-10-05 15:33:32,578 - Detection -   eval_score = 5.92
2024-10-05 15:33:32,578 - Detection -   train_loss = 8.04676472345988
2024-10-05 15:33:37,352 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 15:33:37,352 - Detection -   best_eval_score = 5.92
2024-10-05 15:33:37,352 - Detection -   eval_score = 12.24
2024-10-05 15:33:37,352 - Detection -   train_loss = 7.524816433588664
2024-10-05 15:33:42,137 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 15:33:42,137 - Detection -   best_eval_score = 12.24
2024-10-05 15:33:42,137 - Detection -   eval_score = 19.34
2024-10-05 15:33:42,137 - Detection -   train_loss = 7.21731653213501
2024-10-05 15:33:46,873 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 15:33:46,873 - Detection -   best_eval_score = 19.34
2024-10-05 15:33:46,873 - Detection -   eval_score = 29.21
2024-10-05 15:33:46,873 - Detection -   train_loss = 6.971635357538859
2024-10-05 15:33:51,629 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 15:33:51,629 - Detection -   best_eval_score = 29.21
2024-10-05 15:33:51,629 - Detection -   eval_score = 43.68
2024-10-05 15:33:51,629 - Detection -   train_loss = 6.714383459091186
2024-10-05 15:33:56,571 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 15:33:56,572 - Detection -   best_eval_score = 43.68
2024-10-05 15:33:56,572 - Detection -   eval_score = 62.5
2024-10-05 15:33:56,572 - Detection -   train_loss = 6.4482379913330075
2024-10-05 15:34:01,332 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 15:34:01,333 - Detection -   best_eval_score = 62.5
2024-10-05 15:34:01,333 - Detection -   eval_score = 78.82
2024-10-05 15:34:01,333 - Detection -   train_loss = 6.101870743433635
2024-10-05 15:34:06,088 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 15:34:06,088 - Detection -   best_eval_score = 78.82
2024-10-05 15:34:06,088 - Detection -   eval_score = 89.47
2024-10-05 15:34:06,088 - Detection -   train_loss = 5.669815174738566
2024-10-05 15:34:10,854 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 15:34:10,854 - Detection -   best_eval_score = 89.47
2024-10-05 15:34:10,854 - Detection -   eval_score = 93.03
2024-10-05 15:34:10,854 - Detection -   train_loss = 5.1719528039296465
2024-10-05 15:34:15,602 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 15:34:15,602 - Detection -   best_eval_score = 93.03
2024-10-05 15:34:15,603 - Detection -   eval_score = 95.66
2024-10-05 15:34:15,603 - Detection -   train_loss = 4.566092046101888
2024-10-05 15:34:20,375 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 15:34:20,375 - Detection -   best_eval_score = 95.66
2024-10-05 15:34:20,375 - Detection -   eval_score = 96.32
2024-10-05 15:34:20,375 - Detection -   train_loss = 4.017891518274943
2024-10-05 15:34:25,119 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 15:34:25,119 - Detection -   best_eval_score = 96.32
2024-10-05 15:34:25,119 - Detection -   eval_score = 97.11
2024-10-05 15:34:25,119 - Detection -   train_loss = 3.5873610893885295
2024-10-05 15:34:29,927 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 15:34:29,927 - Detection -   best_eval_score = 97.11
2024-10-05 15:34:29,927 - Detection -   eval_score = 97.24
2024-10-05 15:34:29,927 - Detection -   train_loss = 3.2240941762924193
2024-10-05 15:34:34,678 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 15:34:34,678 - Detection -   best_eval_score = 97.24
2024-10-05 15:34:34,678 - Detection -   eval_score = 97.63
2024-10-05 15:34:34,679 - Detection -   train_loss = 2.9790993372599286
2024-10-05 15:34:39,433 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 15:34:39,433 - Detection -   best_eval_score = 97.63
2024-10-05 15:34:39,433 - Detection -   eval_score = 97.76
2024-10-05 15:34:39,433 - Detection -   train_loss = 2.7947305917739866
2024-10-05 15:34:44,182 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 15:34:44,182 - Detection -   best_eval_score = 97.76
2024-10-05 15:34:44,182 - Detection -   eval_score = 97.76
2024-10-05 15:34:44,182 - Detection -   train_loss = 2.6950417280197145
2024-10-05 15:34:49,023 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 15:34:49,023 - Detection -   best_eval_score = 97.76
2024-10-05 15:34:49,023 - Detection -   eval_score = 97.63
2024-10-05 15:34:49,023 - Detection -   train_loss = 2.6019296646118164
2024-10-05 15:34:53,747 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 15:34:53,748 - Detection -   best_eval_score = 97.76
2024-10-05 15:34:53,748 - Detection -   eval_score = 97.76
2024-10-05 15:34:53,748 - Detection -   train_loss = 2.5354123592376707
2024-10-05 15:34:58,492 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 15:34:58,492 - Detection -   best_eval_score = 97.76
2024-10-05 15:34:58,492 - Detection -   eval_score = 98.16
2024-10-05 15:34:58,493 - Detection -   train_loss = 2.46728568871816
2024-10-05 15:35:03,234 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 15:35:03,234 - Detection -   best_eval_score = 98.16
2024-10-05 15:35:03,234 - Detection -   eval_score = 98.03
2024-10-05 15:35:03,234 - Detection -   train_loss = 2.4311756610870363
2024-10-05 15:35:07,980 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 15:35:07,981 - Detection -   best_eval_score = 98.16
2024-10-05 15:35:07,981 - Detection -   eval_score = 98.16
2024-10-05 15:35:07,981 - Detection -   train_loss = 2.4038280884424847
2024-10-05 15:35:12,739 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 15:35:12,739 - Detection -   best_eval_score = 98.16
2024-10-05 15:35:12,739 - Detection -   eval_score = 98.16
2024-10-05 15:35:12,739 - Detection -   train_loss = 2.3619471629460653
2024-10-05 15:35:17,604 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 15:35:17,604 - Detection -   best_eval_score = 98.16
2024-10-05 15:35:17,604 - Detection -   eval_score = 98.29
2024-10-05 15:35:17,604 - Detection -   train_loss = 2.33579793771108
2024-10-05 15:35:22,360 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 15:35:22,360 - Detection -   best_eval_score = 98.29
2024-10-05 15:35:22,360 - Detection -   eval_score = 98.16
2024-10-05 15:35:22,361 - Detection -   train_loss = 2.318979581197103
2024-10-05 15:35:27,096 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 15:35:27,096 - Detection -   best_eval_score = 98.29
2024-10-05 15:35:27,096 - Detection -   eval_score = 98.16
2024-10-05 15:35:27,096 - Detection -   train_loss = 2.3101202567418415
2024-10-05 15:35:31,828 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 15:35:31,828 - Detection -   best_eval_score = 98.29
2024-10-05 15:35:31,828 - Detection -   eval_score = 98.16
2024-10-05 15:35:31,828 - Detection -   train_loss = 2.2800166249275207
2024-10-05 15:35:36,541 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 15:35:36,541 - Detection -   best_eval_score = 98.29
2024-10-05 15:35:36,541 - Detection -   eval_score = 98.29
2024-10-05 15:35:36,541 - Detection -   train_loss = 2.265408253669739
2024-10-05 15:35:41,355 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 15:35:41,355 - Detection -   best_eval_score = 98.29
2024-10-05 15:35:41,355 - Detection -   eval_score = 98.29
2024-10-05 15:35:41,355 - Detection -   train_loss = 2.2664974093437196
2024-10-05 15:35:46,157 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 15:35:46,157 - Detection -   best_eval_score = 98.29
2024-10-05 15:35:46,157 - Detection -   eval_score = 98.42
2024-10-05 15:35:46,157 - Detection -   train_loss = 2.2559389591217043
2024-10-05 15:35:50,980 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 15:35:50,980 - Detection -   best_eval_score = 98.42
2024-10-05 15:35:50,980 - Detection -   eval_score = 98.29
2024-10-05 15:35:50,980 - Detection -   train_loss = 2.2376607497533163
2024-10-05 15:35:55,756 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 15:35:55,756 - Detection -   best_eval_score = 98.42
2024-10-05 15:35:55,756 - Detection -   eval_score = 98.42
2024-10-05 15:35:55,756 - Detection -   train_loss = 2.230059504508972
2024-10-05 15:36:00,527 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 15:36:00,527 - Detection -   best_eval_score = 98.42
2024-10-05 15:36:00,527 - Detection -   eval_score = 98.16
2024-10-05 15:36:00,527 - Detection -   train_loss = 2.2156099557876585
2024-10-05 15:36:05,282 - Detection - ***** Epoch: 35: Eval results *****
2024-10-05 15:36:05,282 - Detection -   best_eval_score = 98.42
2024-10-05 15:36:05,282 - Detection -   eval_score = 98.16
2024-10-05 15:36:05,282 - Detection -   train_loss = 2.2101656516393025
2024-10-05 15:36:10,026 - Detection - ***** Epoch: 36: Eval results *****
2024-10-05 15:36:10,026 - Detection -   best_eval_score = 98.42
2024-10-05 15:36:10,027 - Detection -   eval_score = 98.16
2024-10-05 15:36:10,027 - Detection -   train_loss = 2.1993439555168153
2024-10-05 15:36:14,871 - Detection - ***** Epoch: 37: Eval results *****
2024-10-05 15:36:14,872 - Detection -   best_eval_score = 98.42
2024-10-05 15:36:14,872 - Detection -   eval_score = 98.42
2024-10-05 15:36:14,872 - Detection -   train_loss = 2.196841474374135
2024-10-05 15:36:19,633 - Detection - ***** Epoch: 38: Eval results *****
2024-10-05 15:36:19,633 - Detection -   best_eval_score = 98.42
2024-10-05 15:36:19,633 - Detection -   eval_score = 98.42
2024-10-05 15:36:19,633 - Detection -   train_loss = 2.1862257440884907
2024-10-05 15:36:24,381 - Detection - ***** Epoch: 39: Eval results *****
2024-10-05 15:36:24,381 - Detection -   best_eval_score = 98.42
2024-10-05 15:36:24,381 - Detection -   eval_score = 98.42
2024-10-05 15:36:24,381 - Detection -   train_loss = 2.188224736849467
2024-10-05 15:36:29,173 - Detection - ***** Epoch: 40: Eval results *****
2024-10-05 15:36:29,173 - Detection -   best_eval_score = 98.42
2024-10-05 15:36:29,173 - Detection -   eval_score = 98.29
2024-10-05 15:36:29,173 - Detection -   train_loss = 2.1765384395917255
2024-10-05 15:36:33,853 - Detection - ***** Epoch: 41: Eval results *****
2024-10-05 15:36:33,853 - Detection -   best_eval_score = 98.42
2024-10-05 15:36:33,853 - Detection -   eval_score = 98.16
2024-10-05 15:36:33,853 - Detection -   train_loss = 2.167403817176819
2024-10-05 15:36:33,854 - Detection - Pre-training finished...
2024-10-05 15:36:33,855 - Detection - Training Begin...
2024-10-05 15:36:39,293 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 15:36:39,294 - Detection -   best_eval_score = 0
2024-10-05 15:36:39,294 - Detection -   eval_score = 0.24
2024-10-05 15:36:39,294 - Detection -   train_loss = 9.056920019785563
2024-10-05 15:36:41,777 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 15:36:41,778 - Detection -   best_eval_score = 0.24
2024-10-05 15:36:41,778 - Detection -   eval_score = 19.91
2024-10-05 15:36:41,778 - Detection -   train_loss = 7.655513842900594
2024-10-05 15:36:44,226 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 15:36:44,227 - Detection -   best_eval_score = 19.91
2024-10-05 15:36:44,227 - Detection -   eval_score = 61.62
2024-10-05 15:36:44,227 - Detection -   train_loss = 5.828690147399902
2024-10-05 15:36:46,702 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 15:36:46,703 - Detection -   best_eval_score = 61.62
2024-10-05 15:36:46,703 - Detection -   eval_score = 83.49
2024-10-05 15:36:46,703 - Detection -   train_loss = 3.8227494239807127
2024-10-05 15:36:49,178 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 15:36:49,178 - Detection -   best_eval_score = 83.49
2024-10-05 15:36:49,178 - Detection -   eval_score = 90.19
2024-10-05 15:36:49,179 - Detection -   train_loss = 2.1754401167233786
2024-10-05 15:36:51,669 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 15:36:51,669 - Detection -   best_eval_score = 90.19
2024-10-05 15:36:51,669 - Detection -   eval_score = 92.4
2024-10-05 15:36:51,669 - Detection -   train_loss = 1.3852231582005818
2024-10-05 15:36:54,139 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 15:36:54,139 - Detection -   best_eval_score = 92.4
2024-10-05 15:36:54,139 - Detection -   eval_score = 92.56
2024-10-05 15:36:54,140 - Detection -   train_loss = 1.2910808722178142
2024-10-05 15:36:56,600 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 15:36:56,600 - Detection -   best_eval_score = 92.56
2024-10-05 15:36:56,600 - Detection -   eval_score = 92.56
2024-10-05 15:36:56,600 - Detection -   train_loss = 1.2967918833096823
2024-10-05 15:36:59,068 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 15:36:59,068 - Detection -   best_eval_score = 92.56
2024-10-05 15:36:59,069 - Detection -   eval_score = 92.56
2024-10-05 15:36:59,069 - Detection -   train_loss = 1.2879586259524027
2024-10-05 15:37:01,520 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 15:37:01,520 - Detection -   best_eval_score = 92.56
2024-10-05 15:37:01,520 - Detection -   eval_score = 92.56
2024-10-05 15:37:01,520 - Detection -   train_loss = 1.2857386906941732
2024-10-05 15:37:03,981 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 15:37:03,981 - Detection -   best_eval_score = 92.56
2024-10-05 15:37:03,981 - Detection -   eval_score = 92.56
2024-10-05 15:37:03,981 - Detection -   train_loss = 1.2829783002535502
2024-10-05 15:37:06,432 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 15:37:06,432 - Detection -   best_eval_score = 92.56
2024-10-05 15:37:06,432 - Detection -   eval_score = 92.56
2024-10-05 15:37:06,432 - Detection -   train_loss = 1.2917796929677328
2024-10-05 15:37:08,903 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 15:37:08,903 - Detection -   best_eval_score = 92.56
2024-10-05 15:37:08,903 - Detection -   eval_score = 92.56
2024-10-05 15:37:08,903 - Detection -   train_loss = 1.2885778188705443
2024-10-05 15:37:11,356 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 15:37:11,356 - Detection -   best_eval_score = 92.56
2024-10-05 15:37:11,357 - Detection -   eval_score = 92.56
2024-10-05 15:37:11,357 - Detection -   train_loss = 1.2878602623939515
2024-10-05 15:37:13,879 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 15:37:13,879 - Detection -   best_eval_score = 92.56
2024-10-05 15:37:13,880 - Detection -   eval_score = 92.56
2024-10-05 15:37:13,880 - Detection -   train_loss = 1.2958058834075927
2024-10-05 15:37:16,337 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 15:37:16,337 - Detection -   best_eval_score = 92.56
2024-10-05 15:37:16,337 - Detection -   eval_score = 92.41
2024-10-05 15:37:16,337 - Detection -   train_loss = 1.2969255089759826
2024-10-05 15:37:18,807 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 15:37:18,807 - Detection -   best_eval_score = 92.56
2024-10-05 15:37:18,807 - Detection -   eval_score = 92.49
2024-10-05 15:37:18,807 - Detection -   train_loss = 1.2824947357177734
2024-10-05 15:37:18,812 - Detection - Training Finished...
2024-10-05 15:37:18,812 - Detection - Testing begin...
2024-10-05 15:37:21,016 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 15:37:21,016 - Detection - [[  29    0    0 ...    0    0    1]
 [   0   22    0 ...    0    0    8]
 [   0    0   27 ...    0    0    3]
 ...
 [   0    0    0 ...   27    0    3]
 [   0    0    0 ...    0   25    5]
 [   2    3   27 ...    8    3 4142]]
2024-10-05 15:37:21,016 - Detection - ***** Test results *****
2024-10-05 15:37:21,016 - Detection -   Acc = 90.58
2024-10-05 15:37:21,016 - Detection -   F1 = 81.1816
2024-10-05 15:37:21,016 - Detection -   F1-known = 80.8455
2024-10-05 15:37:21,016 - Detection -   F1-open = 93.9549
2024-10-05 15:37:21,016 - Detection - Testing finished...
2024-10-05 15:37:21,016 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 15:37:21,049 - Detection - ============================== Params ==============================
2024-10-05 15:37:21,049 - Detection - type:	open_intent_detection
2024-10-05 15:37:21,049 - Detection - logger_name:	Detection
2024-10-05 15:37:21,049 - Detection - log_dir:	logs
2024-10-05 15:37:21,049 - Detection - dataset:	oos
2024-10-05 15:37:21,049 - Detection - known_cls_ratio:	0.25
2024-10-05 15:37:21,049 - Detection - labeled_ratio:	1.0
2024-10-05 15:37:21,049 - Detection - method:	ADB
2024-10-05 15:37:21,049 - Detection - train:	True
2024-10-05 15:37:21,049 - Detection - tune:	True
2024-10-05 15:37:21,049 - Detection - pretrain:	True
2024-10-05 15:37:21,049 - Detection - b_train:	False
2024-10-05 15:37:21,049 - Detection - save_model:	False
2024-10-05 15:37:21,049 - Detection - backbone:	bert
2024-10-05 15:37:21,049 - Detection - config_file_name:	ADB
2024-10-05 15:37:21,049 - Detection - seed:	1
2024-10-05 15:37:21,049 - Detection - gpu_id:	0
2024-10-05 15:37:21,049 - Detection - pipe_results_path:	pipe_results
2024-10-05 15:37:21,049 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 15:37:21,049 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 15:37:21,049 - Detection - model_dir:	models
2024-10-05 15:37:21,050 - Detection - load_pretrained_method:	None
2024-10-05 15:37:21,050 - Detection - result_dir:	results
2024-10-05 15:37:21,050 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 15:37:21,050 - Detection - save_results:	True
2024-10-05 15:37:21,050 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 15:37:21,050 - Detection - dataset_neg:	SQUAD
2024-10-05 15:37:21,050 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1
2024-10-05 15:37:21,050 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1/models
2024-10-05 15:37:21,050 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 15:37:21,050 - Detection - num_train_epochs:	100
2024-10-05 15:37:21,050 - Detection - num_labels:	38
2024-10-05 15:37:21,050 - Detection - max_seq_length:	30
2024-10-05 15:37:21,050 - Detection - freeze_backbone_parameters:	True
2024-10-05 15:37:21,050 - Detection - feat_dim:	768
2024-10-05 15:37:21,050 - Detection - warmup_proportion:	0.1
2024-10-05 15:37:21,050 - Detection - lr_boundary:	0.05
2024-10-05 15:37:21,050 - Detection - lr:	2e-05
2024-10-05 15:37:21,050 - Detection - activation:	relu
2024-10-05 15:37:21,050 - Detection - train_batch_size:	128
2024-10-05 15:37:21,050 - Detection - eval_batch_size:	64
2024-10-05 15:37:21,050 - Detection - test_batch_size:	64
2024-10-05 15:37:21,050 - Detection - wait_patient:	10
2024-10-05 15:37:21,050 - Detection - safe1:	0.3
2024-10-05 15:37:21,050 - Detection - safe2:	0.3
2024-10-05 15:37:21,050 - Detection - neg_weight:	0.5
2024-10-05 15:37:21,050 - Detection - margin:	0.8
2024-10-05 15:37:21,050 - Detection - p:	2
2024-10-05 15:37:21,050 - Detection - loss_weight:	1
2024-10-05 15:37:21,050 - Detection - supcon_loss_weight:	0.7
2024-10-05 15:37:21,050 - Detection - triplet_loss_weight:	0.9
2024-10-05 15:37:21,050 - Detection - unseen_label_id:	38
2024-10-05 15:37:21,050 - Detection - anum_labels:	39
2024-10-05 15:37:21,050 - Detection - device:	cuda:0
2024-10-05 15:37:21,050 - Detection - ============================== End Params ==============================
2024-10-05 15:37:22,213 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 15:37:22,291 - Detection - Pre-training Begin...
2024-10-05 15:37:27,124 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 15:37:27,124 - Detection -   best_eval_score = 0
2024-10-05 15:37:27,125 - Detection -   eval_score = 2.63
2024-10-05 15:37:27,125 - Detection -   train_loss = 8.840952650705974
2024-10-05 15:37:31,989 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 15:37:31,989 - Detection -   best_eval_score = 2.63
2024-10-05 15:37:31,989 - Detection -   eval_score = 2.37
2024-10-05 15:37:31,989 - Detection -   train_loss = 8.413834857940675
2024-10-05 15:37:36,846 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 15:37:36,846 - Detection -   best_eval_score = 2.63
2024-10-05 15:37:36,847 - Detection -   eval_score = 5.92
2024-10-05 15:37:36,847 - Detection -   train_loss = 8.04676472345988
2024-10-05 15:37:41,508 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 15:37:41,509 - Detection -   best_eval_score = 5.92
2024-10-05 15:37:41,509 - Detection -   eval_score = 12.24
2024-10-05 15:37:41,509 - Detection -   train_loss = 7.524816433588664
2024-10-05 15:37:46,123 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 15:37:46,123 - Detection -   best_eval_score = 12.24
2024-10-05 15:37:46,123 - Detection -   eval_score = 19.34
2024-10-05 15:37:46,123 - Detection -   train_loss = 7.21731653213501
2024-10-05 15:37:50,799 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 15:37:50,799 - Detection -   best_eval_score = 19.34
2024-10-05 15:37:50,800 - Detection -   eval_score = 29.21
2024-10-05 15:37:50,800 - Detection -   train_loss = 6.971635357538859
2024-10-05 15:37:55,557 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 15:37:55,558 - Detection -   best_eval_score = 29.21
2024-10-05 15:37:55,558 - Detection -   eval_score = 43.68
2024-10-05 15:37:55,558 - Detection -   train_loss = 6.714383459091186
2024-10-05 15:38:00,141 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 15:38:00,141 - Detection -   best_eval_score = 43.68
2024-10-05 15:38:00,141 - Detection -   eval_score = 62.5
2024-10-05 15:38:00,141 - Detection -   train_loss = 6.4482379913330075
2024-10-05 15:38:04,750 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 15:38:04,750 - Detection -   best_eval_score = 62.5
2024-10-05 15:38:04,750 - Detection -   eval_score = 78.82
2024-10-05 15:38:04,750 - Detection -   train_loss = 6.101870743433635
2024-10-05 15:38:09,341 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 15:38:09,341 - Detection -   best_eval_score = 78.82
2024-10-05 15:38:09,341 - Detection -   eval_score = 89.47
2024-10-05 15:38:09,341 - Detection -   train_loss = 5.669815174738566
2024-10-05 15:38:13,940 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 15:38:13,940 - Detection -   best_eval_score = 89.47
2024-10-05 15:38:13,940 - Detection -   eval_score = 93.03
2024-10-05 15:38:13,940 - Detection -   train_loss = 5.1719528039296465
2024-10-05 15:38:18,551 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 15:38:18,552 - Detection -   best_eval_score = 93.03
2024-10-05 15:38:18,552 - Detection -   eval_score = 95.66
2024-10-05 15:38:18,552 - Detection -   train_loss = 4.566092046101888
2024-10-05 15:38:23,078 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 15:38:23,078 - Detection -   best_eval_score = 95.66
2024-10-05 15:38:23,078 - Detection -   eval_score = 96.32
2024-10-05 15:38:23,078 - Detection -   train_loss = 4.017891518274943
2024-10-05 15:38:27,730 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 15:38:27,730 - Detection -   best_eval_score = 96.32
2024-10-05 15:38:27,730 - Detection -   eval_score = 97.11
2024-10-05 15:38:27,730 - Detection -   train_loss = 3.5873610893885295
2024-10-05 15:38:32,240 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 15:38:32,240 - Detection -   best_eval_score = 97.11
2024-10-05 15:38:32,240 - Detection -   eval_score = 97.24
2024-10-05 15:38:32,240 - Detection -   train_loss = 3.2240941762924193
2024-10-05 15:38:36,781 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 15:38:36,781 - Detection -   best_eval_score = 97.24
2024-10-05 15:38:36,781 - Detection -   eval_score = 97.63
2024-10-05 15:38:36,781 - Detection -   train_loss = 2.9790993372599286
2024-10-05 15:38:41,312 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 15:38:41,312 - Detection -   best_eval_score = 97.63
2024-10-05 15:38:41,312 - Detection -   eval_score = 97.76
2024-10-05 15:38:41,312 - Detection -   train_loss = 2.7947305917739866
2024-10-05 15:38:45,824 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 15:38:45,824 - Detection -   best_eval_score = 97.76
2024-10-05 15:38:45,824 - Detection -   eval_score = 97.76
2024-10-05 15:38:45,824 - Detection -   train_loss = 2.6950417280197145
2024-10-05 15:38:50,281 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 15:38:50,282 - Detection -   best_eval_score = 97.76
2024-10-05 15:38:50,282 - Detection -   eval_score = 97.63
2024-10-05 15:38:50,282 - Detection -   train_loss = 2.6019296646118164
2024-10-05 15:38:54,723 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 15:38:54,723 - Detection -   best_eval_score = 97.76
2024-10-05 15:38:54,723 - Detection -   eval_score = 97.76
2024-10-05 15:38:54,723 - Detection -   train_loss = 2.5354123592376707
2024-10-05 15:38:59,180 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 15:38:59,180 - Detection -   best_eval_score = 97.76
2024-10-05 15:38:59,180 - Detection -   eval_score = 98.16
2024-10-05 15:38:59,180 - Detection -   train_loss = 2.46728568871816
2024-10-05 15:39:03,715 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 15:39:03,715 - Detection -   best_eval_score = 98.16
2024-10-05 15:39:03,715 - Detection -   eval_score = 98.03
2024-10-05 15:39:03,715 - Detection -   train_loss = 2.4311756610870363
2024-10-05 15:39:08,259 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 15:39:08,259 - Detection -   best_eval_score = 98.16
2024-10-05 15:39:08,259 - Detection -   eval_score = 98.16
2024-10-05 15:39:08,259 - Detection -   train_loss = 2.4038280884424847
2024-10-05 15:39:12,721 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 15:39:12,721 - Detection -   best_eval_score = 98.16
2024-10-05 15:39:12,721 - Detection -   eval_score = 98.16
2024-10-05 15:39:12,721 - Detection -   train_loss = 2.3619471629460653
2024-10-05 15:39:17,219 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 15:39:17,220 - Detection -   best_eval_score = 98.16
2024-10-05 15:39:17,220 - Detection -   eval_score = 98.29
2024-10-05 15:39:17,220 - Detection -   train_loss = 2.33579793771108
2024-10-05 15:39:21,750 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 15:39:21,750 - Detection -   best_eval_score = 98.29
2024-10-05 15:39:21,751 - Detection -   eval_score = 98.16
2024-10-05 15:39:21,751 - Detection -   train_loss = 2.318979581197103
2024-10-05 15:39:26,231 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 15:39:26,231 - Detection -   best_eval_score = 98.29
2024-10-05 15:39:26,231 - Detection -   eval_score = 98.16
2024-10-05 15:39:26,231 - Detection -   train_loss = 2.3101202567418415
2024-10-05 15:39:31,002 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 15:39:31,003 - Detection -   best_eval_score = 98.29
2024-10-05 15:39:31,003 - Detection -   eval_score = 98.16
2024-10-05 15:39:31,003 - Detection -   train_loss = 2.2800166249275207
2024-10-05 15:39:35,785 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 15:39:35,785 - Detection -   best_eval_score = 98.29
2024-10-05 15:39:35,785 - Detection -   eval_score = 98.29
2024-10-05 15:39:35,785 - Detection -   train_loss = 2.265408253669739
2024-10-05 15:39:40,446 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 15:39:40,447 - Detection -   best_eval_score = 98.29
2024-10-05 15:39:40,447 - Detection -   eval_score = 98.29
2024-10-05 15:39:40,447 - Detection -   train_loss = 2.2664974093437196
2024-10-05 15:39:45,134 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 15:39:45,134 - Detection -   best_eval_score = 98.29
2024-10-05 15:39:45,134 - Detection -   eval_score = 98.42
2024-10-05 15:39:45,134 - Detection -   train_loss = 2.2559389591217043
2024-10-05 15:39:49,801 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 15:39:49,801 - Detection -   best_eval_score = 98.42
2024-10-05 15:39:49,801 - Detection -   eval_score = 98.29
2024-10-05 15:39:49,801 - Detection -   train_loss = 2.2376607497533163
2024-10-05 15:39:54,443 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 15:39:54,443 - Detection -   best_eval_score = 98.42
2024-10-05 15:39:54,443 - Detection -   eval_score = 98.42
2024-10-05 15:39:54,443 - Detection -   train_loss = 2.230059504508972
2024-10-05 15:39:59,041 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 15:39:59,041 - Detection -   best_eval_score = 98.42
2024-10-05 15:39:59,041 - Detection -   eval_score = 98.16
2024-10-05 15:39:59,041 - Detection -   train_loss = 2.2156099557876585
2024-10-05 15:40:03,754 - Detection - ***** Epoch: 35: Eval results *****
2024-10-05 15:40:03,754 - Detection -   best_eval_score = 98.42
2024-10-05 15:40:03,754 - Detection -   eval_score = 98.16
2024-10-05 15:40:03,754 - Detection -   train_loss = 2.2101656516393025
2024-10-05 15:40:08,431 - Detection - ***** Epoch: 36: Eval results *****
2024-10-05 15:40:08,432 - Detection -   best_eval_score = 98.42
2024-10-05 15:40:08,432 - Detection -   eval_score = 98.16
2024-10-05 15:40:08,432 - Detection -   train_loss = 2.1993439555168153
2024-10-05 15:40:13,085 - Detection - ***** Epoch: 37: Eval results *****
2024-10-05 15:40:13,085 - Detection -   best_eval_score = 98.42
2024-10-05 15:40:13,085 - Detection -   eval_score = 98.42
2024-10-05 15:40:13,085 - Detection -   train_loss = 2.196841474374135
2024-10-05 15:40:17,705 - Detection - ***** Epoch: 38: Eval results *****
2024-10-05 15:40:17,705 - Detection -   best_eval_score = 98.42
2024-10-05 15:40:17,705 - Detection -   eval_score = 98.42
2024-10-05 15:40:17,705 - Detection -   train_loss = 2.1862257440884907
2024-10-05 15:40:22,304 - Detection - ***** Epoch: 39: Eval results *****
2024-10-05 15:40:22,304 - Detection -   best_eval_score = 98.42
2024-10-05 15:40:22,304 - Detection -   eval_score = 98.42
2024-10-05 15:40:22,304 - Detection -   train_loss = 2.188224736849467
2024-10-05 15:40:26,884 - Detection - ***** Epoch: 40: Eval results *****
2024-10-05 15:40:26,884 - Detection -   best_eval_score = 98.42
2024-10-05 15:40:26,884 - Detection -   eval_score = 98.29
2024-10-05 15:40:26,884 - Detection -   train_loss = 2.1765384395917255
2024-10-05 15:40:31,474 - Detection - ***** Epoch: 41: Eval results *****
2024-10-05 15:40:31,474 - Detection -   best_eval_score = 98.42
2024-10-05 15:40:31,474 - Detection -   eval_score = 98.16
2024-10-05 15:40:31,474 - Detection -   train_loss = 2.167403817176819
2024-10-05 15:40:31,475 - Detection - Pre-training finished...
2024-10-05 15:40:31,476 - Detection - Training Begin...
2024-10-05 15:40:36,926 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 15:40:36,926 - Detection -   best_eval_score = 0
2024-10-05 15:40:36,926 - Detection -   eval_score = 0.24
2024-10-05 15:40:36,926 - Detection -   train_loss = 10.527833970387777
2024-10-05 15:40:39,379 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 15:40:39,379 - Detection -   best_eval_score = 0.24
2024-10-05 15:40:39,379 - Detection -   eval_score = 19.91
2024-10-05 15:40:39,379 - Detection -   train_loss = 8.9186181863149
2024-10-05 15:40:41,818 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 15:40:41,818 - Detection -   best_eval_score = 19.91
2024-10-05 15:40:41,818 - Detection -   eval_score = 61.62
2024-10-05 15:40:41,818 - Detection -   train_loss = 6.803874556223551
2024-10-05 15:40:44,255 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 15:40:44,255 - Detection -   best_eval_score = 61.62
2024-10-05 15:40:44,255 - Detection -   eval_score = 83.49
2024-10-05 15:40:44,255 - Detection -   train_loss = 4.502468562126159
2024-10-05 15:40:46,699 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 15:40:46,699 - Detection -   best_eval_score = 83.49
2024-10-05 15:40:46,699 - Detection -   eval_score = 90.19
2024-10-05 15:40:46,699 - Detection -   train_loss = 2.611357525984446
2024-10-05 15:40:49,145 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 15:40:49,145 - Detection -   best_eval_score = 90.19
2024-10-05 15:40:49,145 - Detection -   eval_score = 92.4
2024-10-05 15:40:49,145 - Detection -   train_loss = 1.675709358851115
2024-10-05 15:40:51,583 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 15:40:51,584 - Detection -   best_eval_score = 92.4
2024-10-05 15:40:51,584 - Detection -   eval_score = 92.62
2024-10-05 15:40:51,584 - Detection -   train_loss = 1.5416341304779053
2024-10-05 15:40:54,014 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 15:40:54,014 - Detection -   best_eval_score = 92.62
2024-10-05 15:40:54,014 - Detection -   eval_score = 92.69
2024-10-05 15:40:54,014 - Detection -   train_loss = 1.5376763582229613
2024-10-05 15:40:56,444 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 15:40:56,444 - Detection -   best_eval_score = 92.69
2024-10-05 15:40:56,444 - Detection -   eval_score = 92.69
2024-10-05 15:40:56,444 - Detection -   train_loss = 1.5301290074984233
2024-10-05 15:40:58,875 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 15:40:58,875 - Detection -   best_eval_score = 92.69
2024-10-05 15:40:58,875 - Detection -   eval_score = 92.62
2024-10-05 15:40:58,875 - Detection -   train_loss = 1.5302383144696554
2024-10-05 15:41:01,376 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 15:41:01,376 - Detection -   best_eval_score = 92.69
2024-10-05 15:41:01,376 - Detection -   eval_score = 92.69
2024-10-05 15:41:01,376 - Detection -   train_loss = 1.5189420143763224
2024-10-05 15:41:03,816 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 15:41:03,816 - Detection -   best_eval_score = 92.69
2024-10-05 15:41:03,816 - Detection -   eval_score = 92.71
2024-10-05 15:41:03,816 - Detection -   train_loss = 1.534847660859426
2024-10-05 15:41:06,243 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 15:41:06,244 - Detection -   best_eval_score = 92.71
2024-10-05 15:41:06,244 - Detection -   eval_score = 92.62
2024-10-05 15:41:06,244 - Detection -   train_loss = 1.5257250865300496
2024-10-05 15:41:08,671 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 15:41:08,671 - Detection -   best_eval_score = 92.71
2024-10-05 15:41:08,671 - Detection -   eval_score = 92.76
2024-10-05 15:41:08,671 - Detection -   train_loss = 1.5305881023406982
2024-10-05 15:41:11,117 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 15:41:11,117 - Detection -   best_eval_score = 92.76
2024-10-05 15:41:11,117 - Detection -   eval_score = 92.69
2024-10-05 15:41:11,117 - Detection -   train_loss = 1.5373212496439617
2024-10-05 15:41:13,573 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 15:41:13,573 - Detection -   best_eval_score = 92.76
2024-10-05 15:41:13,573 - Detection -   eval_score = 92.76
2024-10-05 15:41:13,574 - Detection -   train_loss = 1.5378393212954202
2024-10-05 15:41:16,090 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 15:41:16,091 - Detection -   best_eval_score = 92.76
2024-10-05 15:41:16,091 - Detection -   eval_score = 92.62
2024-10-05 15:41:16,091 - Detection -   train_loss = 1.5242271979649862
2024-10-05 15:41:18,590 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 15:41:18,590 - Detection -   best_eval_score = 92.76
2024-10-05 15:41:18,590 - Detection -   eval_score = 92.82
2024-10-05 15:41:18,590 - Detection -   train_loss = 1.5287986914316813
2024-10-05 15:41:21,036 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 15:41:21,036 - Detection -   best_eval_score = 92.82
2024-10-05 15:41:21,036 - Detection -   eval_score = 92.69
2024-10-05 15:41:21,036 - Detection -   train_loss = 1.5262143651644389
2024-10-05 15:41:23,477 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 15:41:23,478 - Detection -   best_eval_score = 92.82
2024-10-05 15:41:23,478 - Detection -   eval_score = 92.62
2024-10-05 15:41:23,478 - Detection -   train_loss = 1.5297411561012269
2024-10-05 15:41:25,923 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 15:41:25,923 - Detection -   best_eval_score = 92.82
2024-10-05 15:41:25,923 - Detection -   eval_score = 92.69
2024-10-05 15:41:25,923 - Detection -   train_loss = 1.5410294969876608
2024-10-05 15:41:28,358 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 15:41:28,358 - Detection -   best_eval_score = 92.82
2024-10-05 15:41:28,358 - Detection -   eval_score = 92.69
2024-10-05 15:41:28,358 - Detection -   train_loss = 1.542116069793701
2024-10-05 15:41:30,796 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 15:41:30,797 - Detection -   best_eval_score = 92.82
2024-10-05 15:41:30,797 - Detection -   eval_score = 92.76
2024-10-05 15:41:30,797 - Detection -   train_loss = 1.5402953942616782
2024-10-05 15:41:33,244 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 15:41:33,244 - Detection -   best_eval_score = 92.82
2024-10-05 15:41:33,244 - Detection -   eval_score = 92.76
2024-10-05 15:41:33,244 - Detection -   train_loss = 1.5473572731018066
2024-10-05 15:41:35,667 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 15:41:35,667 - Detection -   best_eval_score = 92.82
2024-10-05 15:41:35,667 - Detection -   eval_score = 92.69
2024-10-05 15:41:35,667 - Detection -   train_loss = 1.525155782699585
2024-10-05 15:41:38,096 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 15:41:38,096 - Detection -   best_eval_score = 92.82
2024-10-05 15:41:38,096 - Detection -   eval_score = 92.69
2024-10-05 15:41:38,096 - Detection -   train_loss = 1.532408352692922
2024-10-05 15:41:40,545 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 15:41:40,545 - Detection -   best_eval_score = 92.82
2024-10-05 15:41:40,545 - Detection -   eval_score = 92.69
2024-10-05 15:41:40,545 - Detection -   train_loss = 1.5350583076477051
2024-10-05 15:41:42,988 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 15:41:42,988 - Detection -   best_eval_score = 92.82
2024-10-05 15:41:42,988 - Detection -   eval_score = 92.69
2024-10-05 15:41:42,989 - Detection -   train_loss = 1.5153894225756328
2024-10-05 15:41:42,989 - Detection - Training Finished...
2024-10-05 15:41:42,989 - Detection - Testing begin...
2024-10-05 15:41:45,194 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 15:41:45,194 - Detection - [[  29    0    0 ...    0    0    1]
 [   0   22    0 ...    0    0    8]
 [   0    0   28 ...    0    0    2]
 ...
 [   0    0    0 ...   27    0    3]
 [   0    0    0 ...    0   25    5]
 [   2    3   35 ...    8    3 4099]]
2024-10-05 15:41:45,194 - Detection - ***** Test results *****
2024-10-05 15:41:45,194 - Detection -   Acc = 90.0
2024-10-05 15:41:45,194 - Detection -   F1 = 80.5824
2024-10-05 15:41:45,194 - Detection -   F1-known = 80.2411
2024-10-05 15:41:45,194 - Detection -   F1-open = 93.5524
2024-10-05 15:41:45,194 - Detection - Testing finished...
2024-10-05 15:41:45,194 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 15:41:45,227 - Detection - ============================== Params ==============================
2024-10-05 15:41:45,227 - Detection - type:	open_intent_detection
2024-10-05 15:41:45,227 - Detection - logger_name:	Detection
2024-10-05 15:41:45,227 - Detection - log_dir:	logs
2024-10-05 15:41:45,227 - Detection - dataset:	oos
2024-10-05 15:41:45,227 - Detection - known_cls_ratio:	0.25
2024-10-05 15:41:45,227 - Detection - labeled_ratio:	1.0
2024-10-05 15:41:45,227 - Detection - method:	ADB
2024-10-05 15:41:45,227 - Detection - train:	True
2024-10-05 15:41:45,227 - Detection - tune:	True
2024-10-05 15:41:45,227 - Detection - pretrain:	True
2024-10-05 15:41:45,228 - Detection - b_train:	False
2024-10-05 15:41:45,228 - Detection - save_model:	False
2024-10-05 15:41:45,228 - Detection - backbone:	bert
2024-10-05 15:41:45,228 - Detection - config_file_name:	ADB
2024-10-05 15:41:45,228 - Detection - seed:	1
2024-10-05 15:41:45,228 - Detection - gpu_id:	0
2024-10-05 15:41:45,228 - Detection - pipe_results_path:	pipe_results
2024-10-05 15:41:45,228 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 15:41:45,228 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 15:41:45,228 - Detection - model_dir:	models
2024-10-05 15:41:45,228 - Detection - load_pretrained_method:	None
2024-10-05 15:41:45,228 - Detection - result_dir:	results
2024-10-05 15:41:45,228 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 15:41:45,228 - Detection - save_results:	True
2024-10-05 15:41:45,228 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 15:41:45,228 - Detection - dataset_neg:	SQUAD
2024-10-05 15:41:45,228 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1
2024-10-05 15:41:45,228 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1/models
2024-10-05 15:41:45,228 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 15:41:45,228 - Detection - num_train_epochs:	100
2024-10-05 15:41:45,228 - Detection - num_labels:	38
2024-10-05 15:41:45,228 - Detection - max_seq_length:	30
2024-10-05 15:41:45,228 - Detection - freeze_backbone_parameters:	True
2024-10-05 15:41:45,228 - Detection - feat_dim:	768
2024-10-05 15:41:45,228 - Detection - warmup_proportion:	0.1
2024-10-05 15:41:45,228 - Detection - lr_boundary:	0.05
2024-10-05 15:41:45,228 - Detection - lr:	2e-05
2024-10-05 15:41:45,228 - Detection - activation:	relu
2024-10-05 15:41:45,228 - Detection - train_batch_size:	128
2024-10-05 15:41:45,228 - Detection - eval_batch_size:	64
2024-10-05 15:41:45,228 - Detection - test_batch_size:	64
2024-10-05 15:41:45,228 - Detection - wait_patient:	10
2024-10-05 15:41:45,228 - Detection - safe1:	0.3
2024-10-05 15:41:45,228 - Detection - safe2:	0.3
2024-10-05 15:41:45,228 - Detection - neg_weight:	0.8
2024-10-05 15:41:45,228 - Detection - margin:	0.8
2024-10-05 15:41:45,228 - Detection - p:	2
2024-10-05 15:41:45,228 - Detection - loss_weight:	1
2024-10-05 15:41:45,228 - Detection - supcon_loss_weight:	0.7
2024-10-05 15:41:45,228 - Detection - triplet_loss_weight:	0.9
2024-10-05 15:41:45,229 - Detection - unseen_label_id:	38
2024-10-05 15:41:45,229 - Detection - anum_labels:	39
2024-10-05 15:41:45,229 - Detection - device:	cuda:0
2024-10-05 15:41:45,229 - Detection - ============================== End Params ==============================
2024-10-05 15:41:46,494 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 15:41:46,567 - Detection - Pre-training Begin...
2024-10-05 15:41:51,169 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 15:41:51,169 - Detection -   best_eval_score = 0
2024-10-05 15:41:51,169 - Detection -   eval_score = 2.63
2024-10-05 15:41:51,169 - Detection -   train_loss = 8.840952650705974
2024-10-05 15:41:55,766 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 15:41:55,767 - Detection -   best_eval_score = 2.63
2024-10-05 15:41:55,767 - Detection -   eval_score = 2.37
2024-10-05 15:41:55,767 - Detection -   train_loss = 8.413834857940675
2024-10-05 15:42:00,430 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 15:42:00,430 - Detection -   best_eval_score = 2.63
2024-10-05 15:42:00,430 - Detection -   eval_score = 5.92
2024-10-05 15:42:00,430 - Detection -   train_loss = 8.04676472345988
2024-10-05 15:42:05,002 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 15:42:05,002 - Detection -   best_eval_score = 5.92
2024-10-05 15:42:05,002 - Detection -   eval_score = 12.24
2024-10-05 15:42:05,003 - Detection -   train_loss = 7.524816433588664
2024-10-05 15:42:09,582 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 15:42:09,582 - Detection -   best_eval_score = 12.24
2024-10-05 15:42:09,582 - Detection -   eval_score = 19.34
2024-10-05 15:42:09,582 - Detection -   train_loss = 7.21731653213501
2024-10-05 15:42:14,154 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 15:42:14,154 - Detection -   best_eval_score = 19.34
2024-10-05 15:42:14,154 - Detection -   eval_score = 29.21
2024-10-05 15:42:14,154 - Detection -   train_loss = 6.971635357538859
2024-10-05 15:42:18,736 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 15:42:18,736 - Detection -   best_eval_score = 29.21
2024-10-05 15:42:18,736 - Detection -   eval_score = 43.68
2024-10-05 15:42:18,736 - Detection -   train_loss = 6.714383459091186
2024-10-05 15:42:23,286 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 15:42:23,286 - Detection -   best_eval_score = 43.68
2024-10-05 15:42:23,286 - Detection -   eval_score = 62.5
2024-10-05 15:42:23,286 - Detection -   train_loss = 6.4482379913330075
2024-10-05 15:42:27,860 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 15:42:27,860 - Detection -   best_eval_score = 62.5
2024-10-05 15:42:27,860 - Detection -   eval_score = 78.82
2024-10-05 15:42:27,861 - Detection -   train_loss = 6.101870743433635
2024-10-05 15:42:32,492 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 15:42:32,492 - Detection -   best_eval_score = 78.82
2024-10-05 15:42:32,492 - Detection -   eval_score = 89.47
2024-10-05 15:42:32,492 - Detection -   train_loss = 5.669815174738566
2024-10-05 15:42:37,085 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 15:42:37,085 - Detection -   best_eval_score = 89.47
2024-10-05 15:42:37,085 - Detection -   eval_score = 93.03
2024-10-05 15:42:37,085 - Detection -   train_loss = 5.1719528039296465
2024-10-05 15:42:41,662 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 15:42:41,662 - Detection -   best_eval_score = 93.03
2024-10-05 15:42:41,663 - Detection -   eval_score = 95.66
2024-10-05 15:42:41,663 - Detection -   train_loss = 4.566092046101888
2024-10-05 15:42:46,232 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 15:42:46,232 - Detection -   best_eval_score = 95.66
2024-10-05 15:42:46,232 - Detection -   eval_score = 96.32
2024-10-05 15:42:46,233 - Detection -   train_loss = 4.017891518274943
2024-10-05 15:42:50,809 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 15:42:50,809 - Detection -   best_eval_score = 96.32
2024-10-05 15:42:50,809 - Detection -   eval_score = 97.11
2024-10-05 15:42:50,810 - Detection -   train_loss = 3.5873610893885295
2024-10-05 15:42:55,425 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 15:42:55,425 - Detection -   best_eval_score = 97.11
2024-10-05 15:42:55,425 - Detection -   eval_score = 97.24
2024-10-05 15:42:55,425 - Detection -   train_loss = 3.2240941762924193
2024-10-05 15:43:00,052 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 15:43:00,053 - Detection -   best_eval_score = 97.24
2024-10-05 15:43:00,053 - Detection -   eval_score = 97.63
2024-10-05 15:43:00,053 - Detection -   train_loss = 2.9790993372599286
2024-10-05 15:43:04,860 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 15:43:04,860 - Detection -   best_eval_score = 97.63
2024-10-05 15:43:04,861 - Detection -   eval_score = 97.76
2024-10-05 15:43:04,861 - Detection -   train_loss = 2.7947305917739866
2024-10-05 15:43:09,523 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 15:43:09,523 - Detection -   best_eval_score = 97.76
2024-10-05 15:43:09,524 - Detection -   eval_score = 97.76
2024-10-05 15:43:09,524 - Detection -   train_loss = 2.6950417280197145
2024-10-05 15:43:14,080 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 15:43:14,080 - Detection -   best_eval_score = 97.76
2024-10-05 15:43:14,080 - Detection -   eval_score = 97.63
2024-10-05 15:43:14,080 - Detection -   train_loss = 2.6019296646118164
2024-10-05 15:43:18,653 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 15:43:18,653 - Detection -   best_eval_score = 97.76
2024-10-05 15:43:18,653 - Detection -   eval_score = 97.76
2024-10-05 15:43:18,653 - Detection -   train_loss = 2.5354123592376707
2024-10-05 15:43:23,245 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 15:43:23,245 - Detection -   best_eval_score = 97.76
2024-10-05 15:43:23,245 - Detection -   eval_score = 98.16
2024-10-05 15:43:23,245 - Detection -   train_loss = 2.46728568871816
2024-10-05 15:43:27,835 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 15:43:27,835 - Detection -   best_eval_score = 98.16
2024-10-05 15:43:27,835 - Detection -   eval_score = 98.03
2024-10-05 15:43:27,835 - Detection -   train_loss = 2.4311756610870363
2024-10-05 15:43:32,395 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 15:43:32,395 - Detection -   best_eval_score = 98.16
2024-10-05 15:43:32,395 - Detection -   eval_score = 98.16
2024-10-05 15:43:32,395 - Detection -   train_loss = 2.4038280884424847
2024-10-05 15:43:36,978 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 15:43:36,978 - Detection -   best_eval_score = 98.16
2024-10-05 15:43:36,978 - Detection -   eval_score = 98.16
2024-10-05 15:43:36,978 - Detection -   train_loss = 2.3619471629460653
2024-10-05 15:43:41,545 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 15:43:41,545 - Detection -   best_eval_score = 98.16
2024-10-05 15:43:41,545 - Detection -   eval_score = 98.29
2024-10-05 15:43:41,545 - Detection -   train_loss = 2.33579793771108
2024-10-05 15:43:46,111 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 15:43:46,111 - Detection -   best_eval_score = 98.29
2024-10-05 15:43:46,111 - Detection -   eval_score = 98.16
2024-10-05 15:43:46,111 - Detection -   train_loss = 2.318979581197103
2024-10-05 15:43:50,662 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 15:43:50,662 - Detection -   best_eval_score = 98.29
2024-10-05 15:43:50,662 - Detection -   eval_score = 98.16
2024-10-05 15:43:50,662 - Detection -   train_loss = 2.3101202567418415
2024-10-05 15:43:55,306 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 15:43:55,306 - Detection -   best_eval_score = 98.29
2024-10-05 15:43:55,306 - Detection -   eval_score = 98.16
2024-10-05 15:43:55,306 - Detection -   train_loss = 2.2800166249275207
2024-10-05 15:43:59,851 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 15:43:59,851 - Detection -   best_eval_score = 98.29
2024-10-05 15:43:59,852 - Detection -   eval_score = 98.29
2024-10-05 15:43:59,852 - Detection -   train_loss = 2.265408253669739
2024-10-05 15:44:04,346 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 15:44:04,346 - Detection -   best_eval_score = 98.29
2024-10-05 15:44:04,346 - Detection -   eval_score = 98.29
2024-10-05 15:44:04,346 - Detection -   train_loss = 2.2664974093437196
2024-10-05 15:44:08,941 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 15:44:08,941 - Detection -   best_eval_score = 98.29
2024-10-05 15:44:08,941 - Detection -   eval_score = 98.42
2024-10-05 15:44:08,941 - Detection -   train_loss = 2.2559389591217043
2024-10-05 15:44:13,554 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 15:44:13,554 - Detection -   best_eval_score = 98.42
2024-10-05 15:44:13,554 - Detection -   eval_score = 98.29
2024-10-05 15:44:13,554 - Detection -   train_loss = 2.2376607497533163
2024-10-05 15:44:18,110 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 15:44:18,111 - Detection -   best_eval_score = 98.42
2024-10-05 15:44:18,111 - Detection -   eval_score = 98.42
2024-10-05 15:44:18,111 - Detection -   train_loss = 2.230059504508972
2024-10-05 15:44:22,664 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 15:44:22,664 - Detection -   best_eval_score = 98.42
2024-10-05 15:44:22,664 - Detection -   eval_score = 98.16
2024-10-05 15:44:22,664 - Detection -   train_loss = 2.2156099557876585
2024-10-05 15:44:27,217 - Detection - ***** Epoch: 35: Eval results *****
2024-10-05 15:44:27,218 - Detection -   best_eval_score = 98.42
2024-10-05 15:44:27,218 - Detection -   eval_score = 98.16
2024-10-05 15:44:27,218 - Detection -   train_loss = 2.2101656516393025
2024-10-05 15:44:31,734 - Detection - ***** Epoch: 36: Eval results *****
2024-10-05 15:44:31,734 - Detection -   best_eval_score = 98.42
2024-10-05 15:44:31,734 - Detection -   eval_score = 98.16
2024-10-05 15:44:31,734 - Detection -   train_loss = 2.1993439555168153
2024-10-05 15:44:36,267 - Detection - ***** Epoch: 37: Eval results *****
2024-10-05 15:44:36,267 - Detection -   best_eval_score = 98.42
2024-10-05 15:44:36,267 - Detection -   eval_score = 98.42
2024-10-05 15:44:36,267 - Detection -   train_loss = 2.196841474374135
2024-10-05 15:44:40,822 - Detection - ***** Epoch: 38: Eval results *****
2024-10-05 15:44:40,823 - Detection -   best_eval_score = 98.42
2024-10-05 15:44:40,823 - Detection -   eval_score = 98.42
2024-10-05 15:44:40,823 - Detection -   train_loss = 2.1862257440884907
2024-10-05 15:44:45,366 - Detection - ***** Epoch: 39: Eval results *****
2024-10-05 15:44:45,366 - Detection -   best_eval_score = 98.42
2024-10-05 15:44:45,366 - Detection -   eval_score = 98.42
2024-10-05 15:44:45,366 - Detection -   train_loss = 2.188224736849467
2024-10-05 15:44:49,999 - Detection - ***** Epoch: 40: Eval results *****
2024-10-05 15:44:49,999 - Detection -   best_eval_score = 98.42
2024-10-05 15:44:49,999 - Detection -   eval_score = 98.29
2024-10-05 15:44:49,999 - Detection -   train_loss = 2.1765384395917255
2024-10-05 15:44:54,575 - Detection - ***** Epoch: 41: Eval results *****
2024-10-05 15:44:54,575 - Detection -   best_eval_score = 98.42
2024-10-05 15:44:54,575 - Detection -   eval_score = 98.16
2024-10-05 15:44:54,575 - Detection -   train_loss = 2.167403817176819
2024-10-05 15:44:54,576 - Detection - Pre-training finished...
2024-10-05 15:44:54,576 - Detection - Training Begin...
2024-10-05 15:44:59,981 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 15:44:59,981 - Detection -   best_eval_score = 0
2024-10-05 15:44:59,981 - Detection -   eval_score = 0.24
2024-10-05 15:44:59,981 - Detection -   train_loss = 12.73420524597168
2024-10-05 15:45:02,425 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 15:45:02,425 - Detection -   best_eval_score = 0.24
2024-10-05 15:45:02,425 - Detection -   eval_score = 19.91
2024-10-05 15:45:02,425 - Detection -   train_loss = 10.81327527364095
2024-10-05 15:45:04,860 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 15:45:04,860 - Detection -   best_eval_score = 19.91
2024-10-05 15:45:04,860 - Detection -   eval_score = 61.62
2024-10-05 15:45:04,860 - Detection -   train_loss = 8.266652250289917
2024-10-05 15:45:07,289 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 15:45:07,289 - Detection -   best_eval_score = 61.62
2024-10-05 15:45:07,289 - Detection -   eval_score = 83.49
2024-10-05 15:45:07,289 - Detection -   train_loss = 5.5216812292734785
2024-10-05 15:45:09,717 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 15:45:09,717 - Detection -   best_eval_score = 83.49
2024-10-05 15:45:09,717 - Detection -   eval_score = 90.19
2024-10-05 15:45:09,717 - Detection -   train_loss = 3.258889396985372
2024-10-05 15:45:12,160 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 15:45:12,161 - Detection -   best_eval_score = 90.19
2024-10-05 15:45:12,161 - Detection -   eval_score = 92.62
2024-10-05 15:45:12,161 - Detection -   train_loss = 2.0925587972005206
2024-10-05 15:45:14,588 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 15:45:14,588 - Detection -   best_eval_score = 92.62
2024-10-05 15:45:14,588 - Detection -   eval_score = 92.76
2024-10-05 15:45:14,588 - Detection -   train_loss = 1.8821512103080749
2024-10-05 15:45:17,015 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 15:45:17,015 - Detection -   best_eval_score = 92.76
2024-10-05 15:45:17,016 - Detection -   eval_score = 92.9
2024-10-05 15:45:17,016 - Detection -   train_loss = 1.8597430785497029
2024-10-05 15:45:19,461 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 15:45:19,461 - Detection -   best_eval_score = 92.9
2024-10-05 15:45:19,461 - Detection -   eval_score = 93.0
2024-10-05 15:45:19,461 - Detection -   train_loss = 1.848741356531779
2024-10-05 15:45:21,883 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 15:45:21,884 - Detection -   best_eval_score = 93.0
2024-10-05 15:45:21,884 - Detection -   eval_score = 93.06
2024-10-05 15:45:21,884 - Detection -   train_loss = 1.8475138028462728
2024-10-05 15:45:24,310 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 15:45:24,311 - Detection -   best_eval_score = 93.06
2024-10-05 15:45:24,311 - Detection -   eval_score = 93.09
2024-10-05 15:45:24,311 - Detection -   train_loss = 1.8274674574534098
2024-10-05 15:45:26,729 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 15:45:26,729 - Detection -   best_eval_score = 93.09
2024-10-05 15:45:26,730 - Detection -   eval_score = 93.09
2024-10-05 15:45:26,730 - Detection -   train_loss = 1.8519744356473287
2024-10-05 15:45:29,151 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 15:45:29,152 - Detection -   best_eval_score = 93.09
2024-10-05 15:45:29,152 - Detection -   eval_score = 93.09
2024-10-05 15:45:29,152 - Detection -   train_loss = 1.8338611841201782
2024-10-05 15:45:31,581 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 15:45:31,581 - Detection -   best_eval_score = 93.09
2024-10-05 15:45:31,581 - Detection -   eval_score = 93.15
2024-10-05 15:45:31,581 - Detection -   train_loss = 1.8478244503339132
2024-10-05 15:45:34,018 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 15:45:34,018 - Detection -   best_eval_score = 93.15
2024-10-05 15:45:34,019 - Detection -   eval_score = 93.06
2024-10-05 15:45:34,019 - Detection -   train_loss = 1.8527457157770792
2024-10-05 15:45:36,460 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 15:45:36,460 - Detection -   best_eval_score = 93.15
2024-10-05 15:45:36,460 - Detection -   eval_score = 93.09
2024-10-05 15:45:36,460 - Detection -   train_loss = 1.8519930402437845
2024-10-05 15:45:38,898 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 15:45:38,899 - Detection -   best_eval_score = 93.15
2024-10-05 15:45:38,899 - Detection -   eval_score = 93.06
2024-10-05 15:45:38,899 - Detection -   train_loss = 1.8396231611569722
2024-10-05 15:45:41,348 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 15:45:41,348 - Detection -   best_eval_score = 93.15
2024-10-05 15:45:41,348 - Detection -   eval_score = 93.13
2024-10-05 15:45:41,348 - Detection -   train_loss = 1.8415020783742269
2024-10-05 15:45:43,801 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 15:45:43,801 - Detection -   best_eval_score = 93.15
2024-10-05 15:45:43,801 - Detection -   eval_score = 93.09
2024-10-05 15:45:43,801 - Detection -   train_loss = 1.8408509413401286
2024-10-05 15:45:46,257 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 15:45:46,257 - Detection -   best_eval_score = 93.15
2024-10-05 15:45:46,257 - Detection -   eval_score = 93.25
2024-10-05 15:45:46,257 - Detection -   train_loss = 1.8360751032829286
2024-10-05 15:45:48,725 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 15:45:48,725 - Detection -   best_eval_score = 93.25
2024-10-05 15:45:48,725 - Detection -   eval_score = 93.18
2024-10-05 15:45:48,725 - Detection -   train_loss = 1.8557212948799133
2024-10-05 15:45:51,172 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 15:45:51,172 - Detection -   best_eval_score = 93.25
2024-10-05 15:45:51,172 - Detection -   eval_score = 93.16
2024-10-05 15:45:51,172 - Detection -   train_loss = 1.854835073153178
2024-10-05 15:45:53,679 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 15:45:53,680 - Detection -   best_eval_score = 93.25
2024-10-05 15:45:53,680 - Detection -   eval_score = 93.16
2024-10-05 15:45:53,680 - Detection -   train_loss = 1.8535548210144044
2024-10-05 15:45:56,124 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 15:45:56,124 - Detection -   best_eval_score = 93.25
2024-10-05 15:45:56,124 - Detection -   eval_score = 93.09
2024-10-05 15:45:56,124 - Detection -   train_loss = 1.8670703212420146
2024-10-05 15:45:58,555 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 15:45:58,555 - Detection -   best_eval_score = 93.25
2024-10-05 15:45:58,555 - Detection -   eval_score = 93.09
2024-10-05 15:45:58,555 - Detection -   train_loss = 1.8420594255129497
2024-10-05 15:46:01,014 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 15:46:01,014 - Detection -   best_eval_score = 93.25
2024-10-05 15:46:01,014 - Detection -   eval_score = 93.16
2024-10-05 15:46:01,014 - Detection -   train_loss = 1.852409827709198
2024-10-05 15:46:03,475 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 15:46:03,476 - Detection -   best_eval_score = 93.25
2024-10-05 15:46:03,476 - Detection -   eval_score = 93.24
2024-10-05 15:46:03,476 - Detection -   train_loss = 1.8470790068308511
2024-10-05 15:46:05,940 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 15:46:05,940 - Detection -   best_eval_score = 93.25
2024-10-05 15:46:05,940 - Detection -   eval_score = 93.18
2024-10-05 15:46:05,940 - Detection -   train_loss = 1.8319601575533548
2024-10-05 15:46:08,412 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 15:46:08,412 - Detection -   best_eval_score = 93.25
2024-10-05 15:46:08,412 - Detection -   eval_score = 93.24
2024-10-05 15:46:08,412 - Detection -   train_loss = 1.8369147896766662
2024-10-05 15:46:10,861 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 15:46:10,861 - Detection -   best_eval_score = 93.25
2024-10-05 15:46:10,861 - Detection -   eval_score = 93.18
2024-10-05 15:46:10,861 - Detection -   train_loss = 1.8489445050557454
2024-10-05 15:46:10,861 - Detection - Training Finished...
2024-10-05 15:46:10,861 - Detection - Testing begin...
2024-10-05 15:46:13,067 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 15:46:13,067 - Detection - [[  29    0    0 ...    0    0    1]
 [   0   22    0 ...    0    0    8]
 [   0    0   28 ...    0    0    2]
 ...
 [   0    0    0 ...   27    0    3]
 [   0    0    0 ...    0   25    5]
 [   2    3   45 ...    8    3 4046]]
2024-10-05 15:46:13,067 - Detection - ***** Test results *****
2024-10-05 15:46:13,067 - Detection -   Acc = 89.18
2024-10-05 15:46:13,067 - Detection -   F1 = 79.9493
2024-10-05 15:46:13,067 - Detection -   F1-known = 79.6064
2024-10-05 15:46:13,067 - Detection -   F1-open = 92.9794
2024-10-05 15:46:13,067 - Detection - Testing finished...
2024-10-05 15:46:13,067 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 15:46:13,136 - Detection - ============================== Params ==============================
2024-10-05 15:46:13,136 - Detection - type:	open_intent_detection
2024-10-05 15:46:13,136 - Detection - logger_name:	Detection
2024-10-05 15:46:13,136 - Detection - log_dir:	logs
2024-10-05 15:46:13,136 - Detection - dataset:	oos
2024-10-05 15:46:13,136 - Detection - known_cls_ratio:	0.25
2024-10-05 15:46:13,136 - Detection - labeled_ratio:	1.0
2024-10-05 15:46:13,136 - Detection - method:	ADB
2024-10-05 15:46:13,136 - Detection - train:	True
2024-10-05 15:46:13,136 - Detection - tune:	True
2024-10-05 15:46:13,136 - Detection - pretrain:	True
2024-10-05 15:46:13,136 - Detection - b_train:	False
2024-10-05 15:46:13,136 - Detection - save_model:	False
2024-10-05 15:46:13,136 - Detection - backbone:	bert
2024-10-05 15:46:13,136 - Detection - config_file_name:	ADB
2024-10-05 15:46:13,136 - Detection - seed:	1
2024-10-05 15:46:13,136 - Detection - gpu_id:	0
2024-10-05 15:46:13,136 - Detection - pipe_results_path:	pipe_results
2024-10-05 15:46:13,136 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 15:46:13,136 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 15:46:13,136 - Detection - model_dir:	models
2024-10-05 15:46:13,136 - Detection - load_pretrained_method:	None
2024-10-05 15:46:13,136 - Detection - result_dir:	results
2024-10-05 15:46:13,136 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 15:46:13,136 - Detection - save_results:	True
2024-10-05 15:46:13,136 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 15:46:13,136 - Detection - dataset_neg:	SQUAD
2024-10-05 15:46:13,136 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1
2024-10-05 15:46:13,136 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1/models
2024-10-05 15:46:13,136 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 15:46:13,137 - Detection - num_train_epochs:	100
2024-10-05 15:46:13,137 - Detection - num_labels:	38
2024-10-05 15:46:13,137 - Detection - max_seq_length:	30
2024-10-05 15:46:13,137 - Detection - freeze_backbone_parameters:	True
2024-10-05 15:46:13,137 - Detection - feat_dim:	768
2024-10-05 15:46:13,137 - Detection - warmup_proportion:	0.1
2024-10-05 15:46:13,137 - Detection - lr_boundary:	0.05
2024-10-05 15:46:13,137 - Detection - lr:	2e-05
2024-10-05 15:46:13,137 - Detection - activation:	relu
2024-10-05 15:46:13,137 - Detection - train_batch_size:	128
2024-10-05 15:46:13,137 - Detection - eval_batch_size:	64
2024-10-05 15:46:13,137 - Detection - test_batch_size:	64
2024-10-05 15:46:13,137 - Detection - wait_patient:	10
2024-10-05 15:46:13,137 - Detection - safe1:	0.3
2024-10-05 15:46:13,137 - Detection - safe2:	0.4
2024-10-05 15:46:13,137 - Detection - neg_weight:	0.3
2024-10-05 15:46:13,137 - Detection - margin:	0.8
2024-10-05 15:46:13,137 - Detection - p:	2
2024-10-05 15:46:13,137 - Detection - loss_weight:	1
2024-10-05 15:46:13,137 - Detection - supcon_loss_weight:	0.7
2024-10-05 15:46:13,137 - Detection - triplet_loss_weight:	0.9
2024-10-05 15:46:13,137 - Detection - unseen_label_id:	38
2024-10-05 15:46:13,137 - Detection - anum_labels:	39
2024-10-05 15:46:13,137 - Detection - device:	cuda:0
2024-10-05 15:46:13,137 - Detection - ============================== End Params ==============================
2024-10-05 15:46:14,182 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 15:46:14,228 - Detection - Pre-training Begin...
2024-10-05 15:46:18,763 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 15:46:18,764 - Detection -   best_eval_score = 0
2024-10-05 15:46:18,764 - Detection -   eval_score = 2.63
2024-10-05 15:46:18,764 - Detection -   train_loss = 8.840952650705974
2024-10-05 15:46:23,291 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 15:46:23,291 - Detection -   best_eval_score = 2.63
2024-10-05 15:46:23,291 - Detection -   eval_score = 2.37
2024-10-05 15:46:23,291 - Detection -   train_loss = 8.413834857940675
2024-10-05 15:46:27,790 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 15:46:27,791 - Detection -   best_eval_score = 2.63
2024-10-05 15:46:27,791 - Detection -   eval_score = 5.92
2024-10-05 15:46:27,791 - Detection -   train_loss = 8.04676472345988
2024-10-05 15:46:32,322 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 15:46:32,322 - Detection -   best_eval_score = 5.92
2024-10-05 15:46:32,322 - Detection -   eval_score = 12.24
2024-10-05 15:46:32,322 - Detection -   train_loss = 7.524816433588664
2024-10-05 15:46:36,849 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 15:46:36,849 - Detection -   best_eval_score = 12.24
2024-10-05 15:46:36,849 - Detection -   eval_score = 19.34
2024-10-05 15:46:36,849 - Detection -   train_loss = 7.21731653213501
2024-10-05 15:46:41,436 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 15:46:41,436 - Detection -   best_eval_score = 19.34
2024-10-05 15:46:41,437 - Detection -   eval_score = 29.21
2024-10-05 15:46:41,437 - Detection -   train_loss = 6.971635357538859
2024-10-05 15:46:45,976 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 15:46:45,976 - Detection -   best_eval_score = 29.21
2024-10-05 15:46:45,976 - Detection -   eval_score = 43.68
2024-10-05 15:46:45,976 - Detection -   train_loss = 6.714383459091186
2024-10-05 15:46:50,452 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 15:46:50,452 - Detection -   best_eval_score = 43.68
2024-10-05 15:46:50,453 - Detection -   eval_score = 62.5
2024-10-05 15:46:50,453 - Detection -   train_loss = 6.4482379913330075
2024-10-05 15:46:54,937 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 15:46:54,938 - Detection -   best_eval_score = 62.5
2024-10-05 15:46:54,938 - Detection -   eval_score = 78.82
2024-10-05 15:46:54,938 - Detection -   train_loss = 6.101870743433635
2024-10-05 15:46:59,482 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 15:46:59,482 - Detection -   best_eval_score = 78.82
2024-10-05 15:46:59,482 - Detection -   eval_score = 89.47
2024-10-05 15:46:59,482 - Detection -   train_loss = 5.669815174738566
2024-10-05 15:47:04,031 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 15:47:04,031 - Detection -   best_eval_score = 89.47
2024-10-05 15:47:04,032 - Detection -   eval_score = 93.03
2024-10-05 15:47:04,032 - Detection -   train_loss = 5.1719528039296465
2024-10-05 15:47:08,609 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 15:47:08,610 - Detection -   best_eval_score = 93.03
2024-10-05 15:47:08,610 - Detection -   eval_score = 95.66
2024-10-05 15:47:08,610 - Detection -   train_loss = 4.566092046101888
2024-10-05 15:47:13,259 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 15:47:13,259 - Detection -   best_eval_score = 95.66
2024-10-05 15:47:13,259 - Detection -   eval_score = 96.32
2024-10-05 15:47:13,259 - Detection -   train_loss = 4.017891518274943
2024-10-05 15:47:17,803 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 15:47:17,803 - Detection -   best_eval_score = 96.32
2024-10-05 15:47:17,803 - Detection -   eval_score = 97.11
2024-10-05 15:47:17,803 - Detection -   train_loss = 3.5873610893885295
2024-10-05 15:47:22,373 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 15:47:22,373 - Detection -   best_eval_score = 97.11
2024-10-05 15:47:22,373 - Detection -   eval_score = 97.24
2024-10-05 15:47:22,373 - Detection -   train_loss = 3.2240941762924193
2024-10-05 15:47:26,976 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 15:47:26,976 - Detection -   best_eval_score = 97.24
2024-10-05 15:47:26,976 - Detection -   eval_score = 97.63
2024-10-05 15:47:26,976 - Detection -   train_loss = 2.9790993372599286
2024-10-05 15:47:31,567 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 15:47:31,568 - Detection -   best_eval_score = 97.63
2024-10-05 15:47:31,568 - Detection -   eval_score = 97.76
2024-10-05 15:47:31,568 - Detection -   train_loss = 2.7947305917739866
2024-10-05 15:47:36,268 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 15:47:36,268 - Detection -   best_eval_score = 97.76
2024-10-05 15:47:36,268 - Detection -   eval_score = 97.76
2024-10-05 15:47:36,269 - Detection -   train_loss = 2.6950417280197145
2024-10-05 15:47:40,937 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 15:47:40,937 - Detection -   best_eval_score = 97.76
2024-10-05 15:47:40,937 - Detection -   eval_score = 97.63
2024-10-05 15:47:40,937 - Detection -   train_loss = 2.6019296646118164
2024-10-05 15:47:45,592 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 15:47:45,593 - Detection -   best_eval_score = 97.76
2024-10-05 15:47:45,593 - Detection -   eval_score = 97.76
2024-10-05 15:47:45,593 - Detection -   train_loss = 2.5354123592376707
2024-10-05 15:47:50,166 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 15:47:50,166 - Detection -   best_eval_score = 97.76
2024-10-05 15:47:50,166 - Detection -   eval_score = 98.16
2024-10-05 15:47:50,166 - Detection -   train_loss = 2.46728568871816
2024-10-05 15:47:54,806 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 15:47:54,806 - Detection -   best_eval_score = 98.16
2024-10-05 15:47:54,806 - Detection -   eval_score = 98.03
2024-10-05 15:47:54,806 - Detection -   train_loss = 2.4311756610870363
2024-10-05 15:47:59,366 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 15:47:59,366 - Detection -   best_eval_score = 98.16
2024-10-05 15:47:59,366 - Detection -   eval_score = 98.16
2024-10-05 15:47:59,366 - Detection -   train_loss = 2.4038280884424847
2024-10-05 15:48:03,971 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 15:48:03,971 - Detection -   best_eval_score = 98.16
2024-10-05 15:48:03,972 - Detection -   eval_score = 98.16
2024-10-05 15:48:03,972 - Detection -   train_loss = 2.3619471629460653
2024-10-05 15:48:08,549 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 15:48:08,549 - Detection -   best_eval_score = 98.16
2024-10-05 15:48:08,549 - Detection -   eval_score = 98.29
2024-10-05 15:48:08,550 - Detection -   train_loss = 2.33579793771108
2024-10-05 15:48:13,087 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 15:48:13,087 - Detection -   best_eval_score = 98.29
2024-10-05 15:48:13,087 - Detection -   eval_score = 98.16
2024-10-05 15:48:13,087 - Detection -   train_loss = 2.318979581197103
2024-10-05 15:48:17,631 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 15:48:17,632 - Detection -   best_eval_score = 98.29
2024-10-05 15:48:17,632 - Detection -   eval_score = 98.16
2024-10-05 15:48:17,632 - Detection -   train_loss = 2.3101202567418415
2024-10-05 15:48:22,143 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 15:48:22,143 - Detection -   best_eval_score = 98.29
2024-10-05 15:48:22,143 - Detection -   eval_score = 98.16
2024-10-05 15:48:22,143 - Detection -   train_loss = 2.2800166249275207
2024-10-05 15:48:26,601 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 15:48:26,602 - Detection -   best_eval_score = 98.29
2024-10-05 15:48:26,602 - Detection -   eval_score = 98.29
2024-10-05 15:48:26,602 - Detection -   train_loss = 2.265408253669739
2024-10-05 15:48:31,081 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 15:48:31,081 - Detection -   best_eval_score = 98.29
2024-10-05 15:48:31,081 - Detection -   eval_score = 98.29
2024-10-05 15:48:31,081 - Detection -   train_loss = 2.2664974093437196
2024-10-05 15:48:35,541 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 15:48:35,541 - Detection -   best_eval_score = 98.29
2024-10-05 15:48:35,541 - Detection -   eval_score = 98.42
2024-10-05 15:48:35,541 - Detection -   train_loss = 2.2559389591217043
2024-10-05 15:48:40,042 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 15:48:40,042 - Detection -   best_eval_score = 98.42
2024-10-05 15:48:40,043 - Detection -   eval_score = 98.29
2024-10-05 15:48:40,043 - Detection -   train_loss = 2.2376607497533163
2024-10-05 15:48:44,617 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 15:48:44,618 - Detection -   best_eval_score = 98.42
2024-10-05 15:48:44,618 - Detection -   eval_score = 98.42
2024-10-05 15:48:44,618 - Detection -   train_loss = 2.230059504508972
2024-10-05 15:48:49,163 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 15:48:49,163 - Detection -   best_eval_score = 98.42
2024-10-05 15:48:49,164 - Detection -   eval_score = 98.16
2024-10-05 15:48:49,164 - Detection -   train_loss = 2.2156099557876585
2024-10-05 15:48:53,654 - Detection - ***** Epoch: 35: Eval results *****
2024-10-05 15:48:53,655 - Detection -   best_eval_score = 98.42
2024-10-05 15:48:53,655 - Detection -   eval_score = 98.16
2024-10-05 15:48:53,655 - Detection -   train_loss = 2.2101656516393025
2024-10-05 15:48:58,110 - Detection - ***** Epoch: 36: Eval results *****
2024-10-05 15:48:58,110 - Detection -   best_eval_score = 98.42
2024-10-05 15:48:58,110 - Detection -   eval_score = 98.16
2024-10-05 15:48:58,110 - Detection -   train_loss = 2.1993439555168153
2024-10-05 15:49:02,636 - Detection - ***** Epoch: 37: Eval results *****
2024-10-05 15:49:02,636 - Detection -   best_eval_score = 98.42
2024-10-05 15:49:02,636 - Detection -   eval_score = 98.42
2024-10-05 15:49:02,636 - Detection -   train_loss = 2.196841474374135
2024-10-05 15:49:07,209 - Detection - ***** Epoch: 38: Eval results *****
2024-10-05 15:49:07,210 - Detection -   best_eval_score = 98.42
2024-10-05 15:49:07,210 - Detection -   eval_score = 98.42
2024-10-05 15:49:07,210 - Detection -   train_loss = 2.1862257440884907
2024-10-05 15:49:11,828 - Detection - ***** Epoch: 39: Eval results *****
2024-10-05 15:49:11,828 - Detection -   best_eval_score = 98.42
2024-10-05 15:49:11,828 - Detection -   eval_score = 98.42
2024-10-05 15:49:11,829 - Detection -   train_loss = 2.188224736849467
2024-10-05 15:49:16,447 - Detection - ***** Epoch: 40: Eval results *****
2024-10-05 15:49:16,447 - Detection -   best_eval_score = 98.42
2024-10-05 15:49:16,447 - Detection -   eval_score = 98.29
2024-10-05 15:49:16,447 - Detection -   train_loss = 2.1765384395917255
2024-10-05 15:49:20,929 - Detection - ***** Epoch: 41: Eval results *****
2024-10-05 15:49:20,929 - Detection -   best_eval_score = 98.42
2024-10-05 15:49:20,929 - Detection -   eval_score = 98.16
2024-10-05 15:49:20,930 - Detection -   train_loss = 2.167403817176819
2024-10-05 15:49:20,930 - Detection - Pre-training finished...
2024-10-05 15:49:20,931 - Detection - Training Begin...
2024-10-05 15:49:26,354 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 15:49:26,354 - Detection -   best_eval_score = 0
2024-10-05 15:49:26,354 - Detection -   eval_score = 0.24
2024-10-05 15:49:26,355 - Detection -   train_loss = 9.026920159657797
2024-10-05 15:49:28,787 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 15:49:28,787 - Detection -   best_eval_score = 0.24
2024-10-05 15:49:28,788 - Detection -   eval_score = 19.91
2024-10-05 15:49:28,788 - Detection -   train_loss = 7.62551391919454
2024-10-05 15:49:31,231 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 15:49:31,231 - Detection -   best_eval_score = 19.91
2024-10-05 15:49:31,231 - Detection -   eval_score = 61.62
2024-10-05 15:49:31,231 - Detection -   train_loss = 5.798726304372152
2024-10-05 15:49:33,688 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 15:49:33,688 - Detection -   best_eval_score = 61.62
2024-10-05 15:49:33,688 - Detection -   eval_score = 83.49
2024-10-05 15:49:33,688 - Detection -   train_loss = 3.7944267829259237
2024-10-05 15:49:36,110 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 15:49:36,110 - Detection -   best_eval_score = 83.49
2024-10-05 15:49:36,111 - Detection -   eval_score = 90.19
2024-10-05 15:49:36,111 - Detection -   train_loss = 2.151383916536967
2024-10-05 15:49:38,548 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 15:49:38,548 - Detection -   best_eval_score = 90.19
2024-10-05 15:49:38,548 - Detection -   eval_score = 92.4
2024-10-05 15:49:38,548 - Detection -   train_loss = 1.3646125396092732
2024-10-05 15:49:40,986 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 15:49:40,986 - Detection -   best_eval_score = 92.4
2024-10-05 15:49:40,986 - Detection -   eval_score = 92.56
2024-10-05 15:49:40,987 - Detection -   train_loss = 1.2717176993687949
2024-10-05 15:49:43,542 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 15:49:43,542 - Detection -   best_eval_score = 92.56
2024-10-05 15:49:43,542 - Detection -   eval_score = 92.56
2024-10-05 15:49:43,542 - Detection -   train_loss = 1.278199605147044
2024-10-05 15:49:46,021 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 15:49:46,021 - Detection -   best_eval_score = 92.56
2024-10-05 15:49:46,021 - Detection -   eval_score = 92.56
2024-10-05 15:49:46,021 - Detection -   train_loss = 1.2686344305674235
2024-10-05 15:49:48,467 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 15:49:48,467 - Detection -   best_eval_score = 92.56
2024-10-05 15:49:48,467 - Detection -   eval_score = 92.56
2024-10-05 15:49:48,467 - Detection -   train_loss = 1.267137106259664
2024-10-05 15:49:50,897 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 15:49:50,897 - Detection -   best_eval_score = 92.56
2024-10-05 15:49:50,897 - Detection -   eval_score = 92.56
2024-10-05 15:49:50,897 - Detection -   train_loss = 1.2639443079630535
2024-10-05 15:49:53,338 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 15:49:53,338 - Detection -   best_eval_score = 92.56
2024-10-05 15:49:53,338 - Detection -   eval_score = 92.56
2024-10-05 15:49:53,338 - Detection -   train_loss = 1.2727277676264446
2024-10-05 15:49:55,804 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 15:49:55,804 - Detection -   best_eval_score = 92.56
2024-10-05 15:49:55,804 - Detection -   eval_score = 92.56
2024-10-05 15:49:55,804 - Detection -   train_loss = 1.26976025501887
2024-10-05 15:49:58,260 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 15:49:58,261 - Detection -   best_eval_score = 92.56
2024-10-05 15:49:58,261 - Detection -   eval_score = 92.56
2024-10-05 15:49:58,261 - Detection -   train_loss = 1.2692456086476644
2024-10-05 15:50:00,716 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 15:50:00,716 - Detection -   best_eval_score = 92.56
2024-10-05 15:50:00,716 - Detection -   eval_score = 92.56
2024-10-05 15:50:00,716 - Detection -   train_loss = 1.2764480749766032
2024-10-05 15:50:03,151 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 15:50:03,151 - Detection -   best_eval_score = 92.56
2024-10-05 15:50:03,151 - Detection -   eval_score = 92.41
2024-10-05 15:50:03,151 - Detection -   train_loss = 1.2782875895500183
2024-10-05 15:50:05,589 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 15:50:05,589 - Detection -   best_eval_score = 92.56
2024-10-05 15:50:05,589 - Detection -   eval_score = 92.49
2024-10-05 15:50:05,589 - Detection -   train_loss = 1.2632030367851257
2024-10-05 15:50:05,589 - Detection - Training Finished...
2024-10-05 15:50:05,589 - Detection - Testing begin...
2024-10-05 15:50:07,789 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 15:50:07,790 - Detection - [[  29    0    0 ...    0    0    1]
 [   0   22    0 ...    0    0    8]
 [   0    0   27 ...    0    0    3]
 ...
 [   0    0    0 ...   27    0    3]
 [   0    0    0 ...    0   25    5]
 [   2    3   27 ...    8    3 4143]]
2024-10-05 15:50:07,790 - Detection - ***** Test results *****
2024-10-05 15:50:07,790 - Detection -   Acc = 90.6
2024-10-05 15:50:07,790 - Detection -   F1 = 81.1981
2024-10-05 15:50:07,790 - Detection -   F1-known = 80.8621
2024-10-05 15:50:07,790 - Detection -   F1-open = 93.9669
2024-10-05 15:50:07,790 - Detection - Testing finished...
2024-10-05 15:50:07,790 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 15:50:07,824 - Detection - ============================== Params ==============================
2024-10-05 15:50:07,824 - Detection - type:	open_intent_detection
2024-10-05 15:50:07,824 - Detection - logger_name:	Detection
2024-10-05 15:50:07,824 - Detection - log_dir:	logs
2024-10-05 15:50:07,824 - Detection - dataset:	oos
2024-10-05 15:50:07,824 - Detection - known_cls_ratio:	0.25
2024-10-05 15:50:07,824 - Detection - labeled_ratio:	1.0
2024-10-05 15:50:07,824 - Detection - method:	ADB
2024-10-05 15:50:07,824 - Detection - train:	True
2024-10-05 15:50:07,824 - Detection - tune:	True
2024-10-05 15:50:07,824 - Detection - pretrain:	True
2024-10-05 15:50:07,824 - Detection - b_train:	False
2024-10-05 15:50:07,824 - Detection - save_model:	False
2024-10-05 15:50:07,824 - Detection - backbone:	bert
2024-10-05 15:50:07,824 - Detection - config_file_name:	ADB
2024-10-05 15:50:07,824 - Detection - seed:	1
2024-10-05 15:50:07,824 - Detection - gpu_id:	0
2024-10-05 15:50:07,824 - Detection - pipe_results_path:	pipe_results
2024-10-05 15:50:07,824 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 15:50:07,824 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 15:50:07,824 - Detection - model_dir:	models
2024-10-05 15:50:07,824 - Detection - load_pretrained_method:	None
2024-10-05 15:50:07,824 - Detection - result_dir:	results
2024-10-05 15:50:07,824 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 15:50:07,825 - Detection - save_results:	True
2024-10-05 15:50:07,825 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 15:50:07,825 - Detection - dataset_neg:	SQUAD
2024-10-05 15:50:07,825 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1
2024-10-05 15:50:07,825 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1/models
2024-10-05 15:50:07,825 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 15:50:07,825 - Detection - num_train_epochs:	100
2024-10-05 15:50:07,825 - Detection - num_labels:	38
2024-10-05 15:50:07,825 - Detection - max_seq_length:	30
2024-10-05 15:50:07,825 - Detection - freeze_backbone_parameters:	True
2024-10-05 15:50:07,825 - Detection - feat_dim:	768
2024-10-05 15:50:07,825 - Detection - warmup_proportion:	0.1
2024-10-05 15:50:07,825 - Detection - lr_boundary:	0.05
2024-10-05 15:50:07,825 - Detection - lr:	2e-05
2024-10-05 15:50:07,825 - Detection - activation:	relu
2024-10-05 15:50:07,825 - Detection - train_batch_size:	128
2024-10-05 15:50:07,825 - Detection - eval_batch_size:	64
2024-10-05 15:50:07,825 - Detection - test_batch_size:	64
2024-10-05 15:50:07,825 - Detection - wait_patient:	10
2024-10-05 15:50:07,825 - Detection - safe1:	0.3
2024-10-05 15:50:07,825 - Detection - safe2:	0.4
2024-10-05 15:50:07,825 - Detection - neg_weight:	0.5
2024-10-05 15:50:07,825 - Detection - margin:	0.8
2024-10-05 15:50:07,825 - Detection - p:	2
2024-10-05 15:50:07,825 - Detection - loss_weight:	1
2024-10-05 15:50:07,825 - Detection - supcon_loss_weight:	0.7
2024-10-05 15:50:07,825 - Detection - triplet_loss_weight:	0.9
2024-10-05 15:50:07,825 - Detection - unseen_label_id:	38
2024-10-05 15:50:07,825 - Detection - anum_labels:	39
2024-10-05 15:50:07,825 - Detection - device:	cuda:0
2024-10-05 15:50:07,825 - Detection - ============================== End Params ==============================
2024-10-05 15:50:08,841 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 15:50:08,888 - Detection - Pre-training Begin...
2024-10-05 15:50:13,331 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 15:50:13,331 - Detection -   best_eval_score = 0
2024-10-05 15:50:13,331 - Detection -   eval_score = 2.63
2024-10-05 15:50:13,331 - Detection -   train_loss = 8.840952650705974
2024-10-05 15:50:17,795 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 15:50:17,795 - Detection -   best_eval_score = 2.63
2024-10-05 15:50:17,795 - Detection -   eval_score = 2.37
2024-10-05 15:50:17,795 - Detection -   train_loss = 8.413834857940675
2024-10-05 15:50:22,245 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 15:50:22,246 - Detection -   best_eval_score = 2.63
2024-10-05 15:50:22,246 - Detection -   eval_score = 5.92
2024-10-05 15:50:22,246 - Detection -   train_loss = 8.04676472345988
2024-10-05 15:50:26,709 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 15:50:26,709 - Detection -   best_eval_score = 5.92
2024-10-05 15:50:26,709 - Detection -   eval_score = 12.24
2024-10-05 15:50:26,709 - Detection -   train_loss = 7.524816433588664
2024-10-05 15:50:31,229 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 15:50:31,230 - Detection -   best_eval_score = 12.24
2024-10-05 15:50:31,230 - Detection -   eval_score = 19.34
2024-10-05 15:50:31,230 - Detection -   train_loss = 7.21731653213501
2024-10-05 15:50:35,721 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 15:50:35,721 - Detection -   best_eval_score = 19.34
2024-10-05 15:50:35,721 - Detection -   eval_score = 29.21
2024-10-05 15:50:35,721 - Detection -   train_loss = 6.971635357538859
2024-10-05 15:50:40,204 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 15:50:40,204 - Detection -   best_eval_score = 29.21
2024-10-05 15:50:40,204 - Detection -   eval_score = 43.68
2024-10-05 15:50:40,204 - Detection -   train_loss = 6.714383459091186
2024-10-05 15:50:44,656 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 15:50:44,656 - Detection -   best_eval_score = 43.68
2024-10-05 15:50:44,656 - Detection -   eval_score = 62.5
2024-10-05 15:50:44,656 - Detection -   train_loss = 6.4482379913330075
2024-10-05 15:50:49,123 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 15:50:49,123 - Detection -   best_eval_score = 62.5
2024-10-05 15:50:49,123 - Detection -   eval_score = 78.82
2024-10-05 15:50:49,123 - Detection -   train_loss = 6.101870743433635
2024-10-05 15:50:53,593 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 15:50:53,593 - Detection -   best_eval_score = 78.82
2024-10-05 15:50:53,593 - Detection -   eval_score = 89.47
2024-10-05 15:50:53,593 - Detection -   train_loss = 5.669815174738566
2024-10-05 15:50:58,075 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 15:50:58,075 - Detection -   best_eval_score = 89.47
2024-10-05 15:50:58,075 - Detection -   eval_score = 93.03
2024-10-05 15:50:58,075 - Detection -   train_loss = 5.1719528039296465
2024-10-05 15:51:02,614 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 15:51:02,614 - Detection -   best_eval_score = 93.03
2024-10-05 15:51:02,614 - Detection -   eval_score = 95.66
2024-10-05 15:51:02,614 - Detection -   train_loss = 4.566092046101888
2024-10-05 15:51:07,082 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 15:51:07,082 - Detection -   best_eval_score = 95.66
2024-10-05 15:51:07,082 - Detection -   eval_score = 96.32
2024-10-05 15:51:07,082 - Detection -   train_loss = 4.017891518274943
2024-10-05 15:51:11,550 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 15:51:11,550 - Detection -   best_eval_score = 96.32
2024-10-05 15:51:11,550 - Detection -   eval_score = 97.11
2024-10-05 15:51:11,550 - Detection -   train_loss = 3.5873610893885295
2024-10-05 15:51:16,010 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 15:51:16,010 - Detection -   best_eval_score = 97.11
2024-10-05 15:51:16,011 - Detection -   eval_score = 97.24
2024-10-05 15:51:16,011 - Detection -   train_loss = 3.2240941762924193
2024-10-05 15:51:20,522 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 15:51:20,522 - Detection -   best_eval_score = 97.24
2024-10-05 15:51:20,522 - Detection -   eval_score = 97.63
2024-10-05 15:51:20,522 - Detection -   train_loss = 2.9790993372599286
2024-10-05 15:51:25,036 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 15:51:25,036 - Detection -   best_eval_score = 97.63
2024-10-05 15:51:25,036 - Detection -   eval_score = 97.76
2024-10-05 15:51:25,036 - Detection -   train_loss = 2.7947305917739866
2024-10-05 15:51:29,555 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 15:51:29,555 - Detection -   best_eval_score = 97.76
2024-10-05 15:51:29,555 - Detection -   eval_score = 97.76
2024-10-05 15:51:29,555 - Detection -   train_loss = 2.6950417280197145
2024-10-05 15:51:34,056 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 15:51:34,056 - Detection -   best_eval_score = 97.76
2024-10-05 15:51:34,056 - Detection -   eval_score = 97.63
2024-10-05 15:51:34,056 - Detection -   train_loss = 2.6019296646118164
2024-10-05 15:51:38,643 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 15:51:38,643 - Detection -   best_eval_score = 97.76
2024-10-05 15:51:38,643 - Detection -   eval_score = 97.76
2024-10-05 15:51:38,643 - Detection -   train_loss = 2.5354123592376707
2024-10-05 15:51:43,146 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 15:51:43,146 - Detection -   best_eval_score = 97.76
2024-10-05 15:51:43,146 - Detection -   eval_score = 98.16
2024-10-05 15:51:43,146 - Detection -   train_loss = 2.46728568871816
2024-10-05 15:51:47,661 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 15:51:47,661 - Detection -   best_eval_score = 98.16
2024-10-05 15:51:47,661 - Detection -   eval_score = 98.03
2024-10-05 15:51:47,661 - Detection -   train_loss = 2.4311756610870363
2024-10-05 15:51:52,107 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 15:51:52,107 - Detection -   best_eval_score = 98.16
2024-10-05 15:51:52,107 - Detection -   eval_score = 98.16
2024-10-05 15:51:52,107 - Detection -   train_loss = 2.4038280884424847
2024-10-05 15:51:56,556 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 15:51:56,557 - Detection -   best_eval_score = 98.16
2024-10-05 15:51:56,557 - Detection -   eval_score = 98.16
2024-10-05 15:51:56,557 - Detection -   train_loss = 2.3619471629460653
2024-10-05 15:52:01,015 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 15:52:01,015 - Detection -   best_eval_score = 98.16
2024-10-05 15:52:01,015 - Detection -   eval_score = 98.29
2024-10-05 15:52:01,015 - Detection -   train_loss = 2.33579793771108
2024-10-05 15:52:05,474 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 15:52:05,474 - Detection -   best_eval_score = 98.29
2024-10-05 15:52:05,474 - Detection -   eval_score = 98.16
2024-10-05 15:52:05,474 - Detection -   train_loss = 2.318979581197103
2024-10-05 15:52:09,912 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 15:52:09,912 - Detection -   best_eval_score = 98.29
2024-10-05 15:52:09,912 - Detection -   eval_score = 98.16
2024-10-05 15:52:09,912 - Detection -   train_loss = 2.3101202567418415
2024-10-05 15:52:14,352 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 15:52:14,352 - Detection -   best_eval_score = 98.29
2024-10-05 15:52:14,352 - Detection -   eval_score = 98.16
2024-10-05 15:52:14,352 - Detection -   train_loss = 2.2800166249275207
2024-10-05 15:52:18,786 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 15:52:18,786 - Detection -   best_eval_score = 98.29
2024-10-05 15:52:18,786 - Detection -   eval_score = 98.29
2024-10-05 15:52:18,786 - Detection -   train_loss = 2.265408253669739
2024-10-05 15:52:23,228 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 15:52:23,228 - Detection -   best_eval_score = 98.29
2024-10-05 15:52:23,228 - Detection -   eval_score = 98.29
2024-10-05 15:52:23,228 - Detection -   train_loss = 2.2664974093437196
2024-10-05 15:52:27,672 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 15:52:27,672 - Detection -   best_eval_score = 98.29
2024-10-05 15:52:27,672 - Detection -   eval_score = 98.42
2024-10-05 15:52:27,672 - Detection -   train_loss = 2.2559389591217043
2024-10-05 15:52:32,321 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 15:52:32,321 - Detection -   best_eval_score = 98.42
2024-10-05 15:52:32,321 - Detection -   eval_score = 98.29
2024-10-05 15:52:32,321 - Detection -   train_loss = 2.2376607497533163
2024-10-05 15:52:36,921 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 15:52:36,921 - Detection -   best_eval_score = 98.42
2024-10-05 15:52:36,921 - Detection -   eval_score = 98.42
2024-10-05 15:52:36,921 - Detection -   train_loss = 2.230059504508972
2024-10-05 15:52:41,456 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 15:52:41,457 - Detection -   best_eval_score = 98.42
2024-10-05 15:52:41,457 - Detection -   eval_score = 98.16
2024-10-05 15:52:41,457 - Detection -   train_loss = 2.2156099557876585
2024-10-05 15:52:45,956 - Detection - ***** Epoch: 35: Eval results *****
2024-10-05 15:52:45,956 - Detection -   best_eval_score = 98.42
2024-10-05 15:52:45,956 - Detection -   eval_score = 98.16
2024-10-05 15:52:45,956 - Detection -   train_loss = 2.2101656516393025
2024-10-05 15:52:50,452 - Detection - ***** Epoch: 36: Eval results *****
2024-10-05 15:52:50,452 - Detection -   best_eval_score = 98.42
2024-10-05 15:52:50,452 - Detection -   eval_score = 98.16
2024-10-05 15:52:50,452 - Detection -   train_loss = 2.1993439555168153
2024-10-05 15:52:54,958 - Detection - ***** Epoch: 37: Eval results *****
2024-10-05 15:52:54,958 - Detection -   best_eval_score = 98.42
2024-10-05 15:52:54,959 - Detection -   eval_score = 98.42
2024-10-05 15:52:54,959 - Detection -   train_loss = 2.196841474374135
2024-10-05 15:52:59,489 - Detection - ***** Epoch: 38: Eval results *****
2024-10-05 15:52:59,490 - Detection -   best_eval_score = 98.42
2024-10-05 15:52:59,490 - Detection -   eval_score = 98.42
2024-10-05 15:52:59,490 - Detection -   train_loss = 2.1862257440884907
2024-10-05 15:53:03,997 - Detection - ***** Epoch: 39: Eval results *****
2024-10-05 15:53:03,997 - Detection -   best_eval_score = 98.42
2024-10-05 15:53:03,997 - Detection -   eval_score = 98.42
2024-10-05 15:53:03,997 - Detection -   train_loss = 2.188224736849467
2024-10-05 15:53:08,455 - Detection - ***** Epoch: 40: Eval results *****
2024-10-05 15:53:08,455 - Detection -   best_eval_score = 98.42
2024-10-05 15:53:08,455 - Detection -   eval_score = 98.29
2024-10-05 15:53:08,455 - Detection -   train_loss = 2.1765384395917255
2024-10-05 15:53:12,898 - Detection - ***** Epoch: 41: Eval results *****
2024-10-05 15:53:12,898 - Detection -   best_eval_score = 98.42
2024-10-05 15:53:12,898 - Detection -   eval_score = 98.16
2024-10-05 15:53:12,898 - Detection -   train_loss = 2.167403817176819
2024-10-05 15:53:12,899 - Detection - Pre-training finished...
2024-10-05 15:53:12,899 - Detection - Training Begin...
2024-10-05 15:53:18,298 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 15:53:18,298 - Detection -   best_eval_score = 0
2024-10-05 15:53:18,299 - Detection -   eval_score = 0.24
2024-10-05 15:53:18,299 - Detection -   train_loss = 10.477834256490071
2024-10-05 15:53:20,744 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 15:53:20,744 - Detection -   best_eval_score = 0.24
2024-10-05 15:53:20,744 - Detection -   eval_score = 19.91
2024-10-05 15:53:20,744 - Detection -   train_loss = 8.868618361155193
2024-10-05 15:53:23,167 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 15:53:23,167 - Detection -   best_eval_score = 19.91
2024-10-05 15:53:23,167 - Detection -   eval_score = 61.62
2024-10-05 15:53:23,167 - Detection -   train_loss = 6.753934748967489
2024-10-05 15:53:25,591 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 15:53:25,591 - Detection -   best_eval_score = 61.62
2024-10-05 15:53:25,591 - Detection -   eval_score = 83.49
2024-10-05 15:53:25,591 - Detection -   train_loss = 4.4551370938618975
2024-10-05 15:53:28,085 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 15:53:28,085 - Detection -   best_eval_score = 83.49
2024-10-05 15:53:28,085 - Detection -   eval_score = 90.19
2024-10-05 15:53:28,085 - Detection -   train_loss = 2.570870006084442
2024-10-05 15:53:30,561 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 15:53:30,561 - Detection -   best_eval_score = 90.19
2024-10-05 15:53:30,561 - Detection -   eval_score = 92.4
2024-10-05 15:53:30,561 - Detection -   train_loss = 1.641243080298106
2024-10-05 15:53:33,033 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 15:53:33,034 - Detection -   best_eval_score = 92.4
2024-10-05 15:53:33,034 - Detection -   eval_score = 92.62
2024-10-05 15:53:33,034 - Detection -   train_loss = 1.5096919536590576
2024-10-05 15:53:35,494 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 15:53:35,495 - Detection -   best_eval_score = 92.62
2024-10-05 15:53:35,495 - Detection -   eval_score = 92.69
2024-10-05 15:53:35,495 - Detection -   train_loss = 1.5067006349563599
2024-10-05 15:53:37,938 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 15:53:37,938 - Detection -   best_eval_score = 92.69
2024-10-05 15:53:37,938 - Detection -   eval_score = 92.69
2024-10-05 15:53:37,938 - Detection -   train_loss = 1.4981395522753398
2024-10-05 15:53:40,368 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 15:53:40,369 - Detection -   best_eval_score = 92.69
2024-10-05 15:53:40,369 - Detection -   eval_score = 92.69
2024-10-05 15:53:40,369 - Detection -   train_loss = 1.4992374658584595
2024-10-05 15:53:42,814 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 15:53:42,814 - Detection -   best_eval_score = 92.69
2024-10-05 15:53:42,814 - Detection -   eval_score = 92.69
2024-10-05 15:53:42,814 - Detection -   train_loss = 1.4875259359677633
2024-10-05 15:53:45,260 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 15:53:45,260 - Detection -   best_eval_score = 92.69
2024-10-05 15:53:45,260 - Detection -   eval_score = 92.62
2024-10-05 15:53:45,260 - Detection -   train_loss = 1.5032166481018066
2024-10-05 15:53:47,698 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 15:53:47,698 - Detection -   best_eval_score = 92.69
2024-10-05 15:53:47,698 - Detection -   eval_score = 92.62
2024-10-05 15:53:47,698 - Detection -   train_loss = 1.4939462343851726
2024-10-05 15:53:50,136 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 15:53:50,137 - Detection -   best_eval_score = 92.69
2024-10-05 15:53:50,137 - Detection -   eval_score = 92.76
2024-10-05 15:53:50,137 - Detection -   train_loss = 1.4995097796122232
2024-10-05 15:53:52,572 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 15:53:52,572 - Detection -   best_eval_score = 92.76
2024-10-05 15:53:52,572 - Detection -   eval_score = 92.69
2024-10-05 15:53:52,573 - Detection -   train_loss = 1.505702257156372
2024-10-05 15:53:55,017 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 15:53:55,017 - Detection -   best_eval_score = 92.76
2024-10-05 15:53:55,017 - Detection -   eval_score = 92.76
2024-10-05 15:53:55,018 - Detection -   train_loss = 1.5067538181940714
2024-10-05 15:53:57,452 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 15:53:57,452 - Detection -   best_eval_score = 92.76
2024-10-05 15:53:57,452 - Detection -   eval_score = 92.62
2024-10-05 15:53:57,452 - Detection -   train_loss = 1.4926665425300598
2024-10-05 15:53:59,899 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 15:53:59,900 - Detection -   best_eval_score = 92.76
2024-10-05 15:53:59,900 - Detection -   eval_score = 92.82
2024-10-05 15:53:59,900 - Detection -   train_loss = 1.498208995660146
2024-10-05 15:54:02,344 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 15:54:02,344 - Detection -   best_eval_score = 92.82
2024-10-05 15:54:02,344 - Detection -   eval_score = 92.69
2024-10-05 15:54:02,344 - Detection -   train_loss = 1.4944732507069907
2024-10-05 15:54:04,786 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 15:54:04,786 - Detection -   best_eval_score = 92.82
2024-10-05 15:54:04,786 - Detection -   eval_score = 92.62
2024-10-05 15:54:04,787 - Detection -   train_loss = 1.4980843702952067
2024-10-05 15:54:07,240 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 15:54:07,240 - Detection -   best_eval_score = 92.82
2024-10-05 15:54:07,240 - Detection -   eval_score = 92.62
2024-10-05 15:54:07,241 - Detection -   train_loss = 1.5101376215616862
2024-10-05 15:54:09,672 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 15:54:09,673 - Detection -   best_eval_score = 92.82
2024-10-05 15:54:09,673 - Detection -   eval_score = 92.69
2024-10-05 15:54:09,673 - Detection -   train_loss = 1.5112529397010803
2024-10-05 15:54:12,111 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 15:54:12,111 - Detection -   best_eval_score = 92.82
2024-10-05 15:54:12,111 - Detection -   eval_score = 92.76
2024-10-05 15:54:12,111 - Detection -   train_loss = 1.5095402677853902
2024-10-05 15:54:14,558 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 15:54:14,558 - Detection -   best_eval_score = 92.82
2024-10-05 15:54:14,558 - Detection -   eval_score = 92.76
2024-10-05 15:54:14,558 - Detection -   train_loss = 1.515955678621928
2024-10-05 15:54:17,005 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 15:54:17,006 - Detection -   best_eval_score = 92.82
2024-10-05 15:54:17,006 - Detection -   eval_score = 92.69
2024-10-05 15:54:17,006 - Detection -   train_loss = 1.4947057684262595
2024-10-05 15:54:19,443 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 15:54:19,443 - Detection -   best_eval_score = 92.82
2024-10-05 15:54:19,443 - Detection -   eval_score = 92.76
2024-10-05 15:54:19,443 - Detection -   train_loss = 1.5002251386642456
2024-10-05 15:54:21,884 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 15:54:21,885 - Detection -   best_eval_score = 92.82
2024-10-05 15:54:21,885 - Detection -   eval_score = 92.69
2024-10-05 15:54:21,885 - Detection -   train_loss = 1.5040658195813497
2024-10-05 15:54:24,335 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 15:54:24,335 - Detection -   best_eval_score = 92.82
2024-10-05 15:54:24,336 - Detection -   eval_score = 92.69
2024-10-05 15:54:24,336 - Detection -   train_loss = 1.483812729517619
2024-10-05 15:54:24,336 - Detection - Training Finished...
2024-10-05 15:54:24,336 - Detection - Testing begin...
2024-10-05 15:54:26,539 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 15:54:26,540 - Detection - [[  29    0    0 ...    0    0    1]
 [   0   22    0 ...    0    0    8]
 [   0    0   28 ...    0    0    2]
 ...
 [   0    0    0 ...   27    0    3]
 [   0    0    0 ...    0   25    5]
 [   2    3   35 ...    8    3 4103]]
2024-10-05 15:54:26,540 - Detection - ***** Test results *****
2024-10-05 15:54:26,540 - Detection -   Acc = 90.07
2024-10-05 15:54:26,540 - Detection -   F1 = 80.7209
2024-10-05 15:54:26,540 - Detection -   F1-known = 80.3819
2024-10-05 15:54:26,540 - Detection -   F1-open = 93.601
2024-10-05 15:54:26,540 - Detection - Testing finished...
2024-10-05 15:54:26,540 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 15:54:26,573 - Detection - ============================== Params ==============================
2024-10-05 15:54:26,573 - Detection - type:	open_intent_detection
2024-10-05 15:54:26,573 - Detection - logger_name:	Detection
2024-10-05 15:54:26,573 - Detection - log_dir:	logs
2024-10-05 15:54:26,573 - Detection - dataset:	oos
2024-10-05 15:54:26,573 - Detection - known_cls_ratio:	0.25
2024-10-05 15:54:26,573 - Detection - labeled_ratio:	1.0
2024-10-05 15:54:26,574 - Detection - method:	ADB
2024-10-05 15:54:26,574 - Detection - train:	True
2024-10-05 15:54:26,574 - Detection - tune:	True
2024-10-05 15:54:26,574 - Detection - pretrain:	True
2024-10-05 15:54:26,574 - Detection - b_train:	False
2024-10-05 15:54:26,574 - Detection - save_model:	False
2024-10-05 15:54:26,574 - Detection - backbone:	bert
2024-10-05 15:54:26,574 - Detection - config_file_name:	ADB
2024-10-05 15:54:26,574 - Detection - seed:	1
2024-10-05 15:54:26,574 - Detection - gpu_id:	0
2024-10-05 15:54:26,574 - Detection - pipe_results_path:	pipe_results
2024-10-05 15:54:26,574 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 15:54:26,574 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 15:54:26,574 - Detection - model_dir:	models
2024-10-05 15:54:26,574 - Detection - load_pretrained_method:	None
2024-10-05 15:54:26,574 - Detection - result_dir:	results
2024-10-05 15:54:26,574 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 15:54:26,574 - Detection - save_results:	True
2024-10-05 15:54:26,574 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 15:54:26,574 - Detection - dataset_neg:	SQUAD
2024-10-05 15:54:26,574 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1
2024-10-05 15:54:26,574 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1/models
2024-10-05 15:54:26,574 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 15:54:26,574 - Detection - num_train_epochs:	100
2024-10-05 15:54:26,574 - Detection - num_labels:	38
2024-10-05 15:54:26,574 - Detection - max_seq_length:	30
2024-10-05 15:54:26,574 - Detection - freeze_backbone_parameters:	True
2024-10-05 15:54:26,574 - Detection - feat_dim:	768
2024-10-05 15:54:26,574 - Detection - warmup_proportion:	0.1
2024-10-05 15:54:26,574 - Detection - lr_boundary:	0.05
2024-10-05 15:54:26,574 - Detection - lr:	2e-05
2024-10-05 15:54:26,574 - Detection - activation:	relu
2024-10-05 15:54:26,574 - Detection - train_batch_size:	128
2024-10-05 15:54:26,574 - Detection - eval_batch_size:	64
2024-10-05 15:54:26,574 - Detection - test_batch_size:	64
2024-10-05 15:54:26,574 - Detection - wait_patient:	10
2024-10-05 15:54:26,574 - Detection - safe1:	0.3
2024-10-05 15:54:26,574 - Detection - safe2:	0.4
2024-10-05 15:54:26,574 - Detection - neg_weight:	0.8
2024-10-05 15:54:26,574 - Detection - margin:	0.8
2024-10-05 15:54:26,574 - Detection - p:	2
2024-10-05 15:54:26,574 - Detection - loss_weight:	1
2024-10-05 15:54:26,575 - Detection - supcon_loss_weight:	0.7
2024-10-05 15:54:26,575 - Detection - triplet_loss_weight:	0.9
2024-10-05 15:54:26,575 - Detection - unseen_label_id:	38
2024-10-05 15:54:26,575 - Detection - anum_labels:	39
2024-10-05 15:54:26,575 - Detection - device:	cuda:0
2024-10-05 15:54:26,575 - Detection - ============================== End Params ==============================
2024-10-05 15:54:27,599 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 15:54:27,647 - Detection - Pre-training Begin...
2024-10-05 15:54:32,246 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 15:54:32,246 - Detection -   best_eval_score = 0
2024-10-05 15:54:32,246 - Detection -   eval_score = 2.63
2024-10-05 15:54:32,246 - Detection -   train_loss = 8.840952650705974
2024-10-05 15:54:36,870 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 15:54:36,870 - Detection -   best_eval_score = 2.63
2024-10-05 15:54:36,870 - Detection -   eval_score = 2.37
2024-10-05 15:54:36,870 - Detection -   train_loss = 8.413834857940675
2024-10-05 15:54:41,504 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 15:54:41,504 - Detection -   best_eval_score = 2.63
2024-10-05 15:54:41,504 - Detection -   eval_score = 5.92
2024-10-05 15:54:41,504 - Detection -   train_loss = 8.04676472345988
2024-10-05 15:54:46,074 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 15:54:46,074 - Detection -   best_eval_score = 5.92
2024-10-05 15:54:46,074 - Detection -   eval_score = 12.24
2024-10-05 15:54:46,074 - Detection -   train_loss = 7.524816433588664
2024-10-05 15:54:50,752 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 15:54:50,753 - Detection -   best_eval_score = 12.24
2024-10-05 15:54:50,753 - Detection -   eval_score = 19.34
2024-10-05 15:54:50,753 - Detection -   train_loss = 7.21731653213501
2024-10-05 15:54:55,399 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 15:54:55,399 - Detection -   best_eval_score = 19.34
2024-10-05 15:54:55,399 - Detection -   eval_score = 29.21
2024-10-05 15:54:55,400 - Detection -   train_loss = 6.971635357538859
2024-10-05 15:55:00,028 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 15:55:00,029 - Detection -   best_eval_score = 29.21
2024-10-05 15:55:00,029 - Detection -   eval_score = 43.68
2024-10-05 15:55:00,029 - Detection -   train_loss = 6.714383459091186
2024-10-05 15:55:04,665 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 15:55:04,665 - Detection -   best_eval_score = 43.68
2024-10-05 15:55:04,665 - Detection -   eval_score = 62.5
2024-10-05 15:55:04,665 - Detection -   train_loss = 6.4482379913330075
2024-10-05 15:55:09,359 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 15:55:09,359 - Detection -   best_eval_score = 62.5
2024-10-05 15:55:09,359 - Detection -   eval_score = 78.82
2024-10-05 15:55:09,359 - Detection -   train_loss = 6.101870743433635
2024-10-05 15:55:13,962 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 15:55:13,963 - Detection -   best_eval_score = 78.82
2024-10-05 15:55:13,963 - Detection -   eval_score = 89.47
2024-10-05 15:55:13,963 - Detection -   train_loss = 5.669815174738566
2024-10-05 15:55:18,508 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 15:55:18,509 - Detection -   best_eval_score = 89.47
2024-10-05 15:55:18,509 - Detection -   eval_score = 93.03
2024-10-05 15:55:18,509 - Detection -   train_loss = 5.1719528039296465
2024-10-05 15:55:23,010 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 15:55:23,011 - Detection -   best_eval_score = 93.03
2024-10-05 15:55:23,011 - Detection -   eval_score = 95.66
2024-10-05 15:55:23,011 - Detection -   train_loss = 4.566092046101888
2024-10-05 15:55:27,511 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 15:55:27,512 - Detection -   best_eval_score = 95.66
2024-10-05 15:55:27,512 - Detection -   eval_score = 96.32
2024-10-05 15:55:27,512 - Detection -   train_loss = 4.017891518274943
2024-10-05 15:55:32,055 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 15:55:32,055 - Detection -   best_eval_score = 96.32
2024-10-05 15:55:32,056 - Detection -   eval_score = 97.11
2024-10-05 15:55:32,056 - Detection -   train_loss = 3.5873610893885295
2024-10-05 15:55:36,604 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 15:55:36,605 - Detection -   best_eval_score = 97.11
2024-10-05 15:55:36,605 - Detection -   eval_score = 97.24
2024-10-05 15:55:36,605 - Detection -   train_loss = 3.2240941762924193
2024-10-05 15:55:41,208 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 15:55:41,208 - Detection -   best_eval_score = 97.24
2024-10-05 15:55:41,208 - Detection -   eval_score = 97.63
2024-10-05 15:55:41,208 - Detection -   train_loss = 2.9790993372599286
2024-10-05 15:55:45,773 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 15:55:45,774 - Detection -   best_eval_score = 97.63
2024-10-05 15:55:45,774 - Detection -   eval_score = 97.76
2024-10-05 15:55:45,774 - Detection -   train_loss = 2.7947305917739866
2024-10-05 15:55:50,304 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 15:55:50,304 - Detection -   best_eval_score = 97.76
2024-10-05 15:55:50,304 - Detection -   eval_score = 97.76
2024-10-05 15:55:50,304 - Detection -   train_loss = 2.6950417280197145
2024-10-05 15:55:54,836 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 15:55:54,836 - Detection -   best_eval_score = 97.76
2024-10-05 15:55:54,836 - Detection -   eval_score = 97.63
2024-10-05 15:55:54,836 - Detection -   train_loss = 2.6019296646118164
2024-10-05 15:55:59,362 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 15:55:59,362 - Detection -   best_eval_score = 97.76
2024-10-05 15:55:59,362 - Detection -   eval_score = 97.76
2024-10-05 15:55:59,362 - Detection -   train_loss = 2.5354123592376707
2024-10-05 15:56:03,884 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 15:56:03,885 - Detection -   best_eval_score = 97.76
2024-10-05 15:56:03,885 - Detection -   eval_score = 98.16
2024-10-05 15:56:03,885 - Detection -   train_loss = 2.46728568871816
2024-10-05 15:56:08,379 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 15:56:08,379 - Detection -   best_eval_score = 98.16
2024-10-05 15:56:08,380 - Detection -   eval_score = 98.03
2024-10-05 15:56:08,380 - Detection -   train_loss = 2.4311756610870363
2024-10-05 15:56:12,865 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 15:56:12,865 - Detection -   best_eval_score = 98.16
2024-10-05 15:56:12,865 - Detection -   eval_score = 98.16
2024-10-05 15:56:12,865 - Detection -   train_loss = 2.4038280884424847
2024-10-05 15:56:17,373 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 15:56:17,373 - Detection -   best_eval_score = 98.16
2024-10-05 15:56:17,373 - Detection -   eval_score = 98.16
2024-10-05 15:56:17,373 - Detection -   train_loss = 2.3619471629460653
2024-10-05 15:56:21,924 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 15:56:21,924 - Detection -   best_eval_score = 98.16
2024-10-05 15:56:21,924 - Detection -   eval_score = 98.29
2024-10-05 15:56:21,924 - Detection -   train_loss = 2.33579793771108
2024-10-05 15:56:26,473 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 15:56:26,473 - Detection -   best_eval_score = 98.29
2024-10-05 15:56:26,473 - Detection -   eval_score = 98.16
2024-10-05 15:56:26,474 - Detection -   train_loss = 2.318979581197103
2024-10-05 15:56:30,951 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 15:56:30,951 - Detection -   best_eval_score = 98.29
2024-10-05 15:56:30,951 - Detection -   eval_score = 98.16
2024-10-05 15:56:30,951 - Detection -   train_loss = 2.3101202567418415
2024-10-05 15:56:35,518 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 15:56:35,518 - Detection -   best_eval_score = 98.29
2024-10-05 15:56:35,518 - Detection -   eval_score = 98.16
2024-10-05 15:56:35,518 - Detection -   train_loss = 2.2800166249275207
2024-10-05 15:56:40,109 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 15:56:40,110 - Detection -   best_eval_score = 98.29
2024-10-05 15:56:40,110 - Detection -   eval_score = 98.29
2024-10-05 15:56:40,110 - Detection -   train_loss = 2.265408253669739
2024-10-05 15:56:44,745 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 15:56:44,745 - Detection -   best_eval_score = 98.29
2024-10-05 15:56:44,745 - Detection -   eval_score = 98.29
2024-10-05 15:56:44,745 - Detection -   train_loss = 2.2664974093437196
2024-10-05 15:56:49,367 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 15:56:49,367 - Detection -   best_eval_score = 98.29
2024-10-05 15:56:49,367 - Detection -   eval_score = 98.42
2024-10-05 15:56:49,367 - Detection -   train_loss = 2.2559389591217043
2024-10-05 15:56:53,981 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 15:56:53,981 - Detection -   best_eval_score = 98.42
2024-10-05 15:56:53,981 - Detection -   eval_score = 98.29
2024-10-05 15:56:53,981 - Detection -   train_loss = 2.2376607497533163
2024-10-05 15:56:58,554 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 15:56:58,554 - Detection -   best_eval_score = 98.42
2024-10-05 15:56:58,554 - Detection -   eval_score = 98.42
2024-10-05 15:56:58,554 - Detection -   train_loss = 2.230059504508972
2024-10-05 15:57:03,156 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 15:57:03,156 - Detection -   best_eval_score = 98.42
2024-10-05 15:57:03,156 - Detection -   eval_score = 98.16
2024-10-05 15:57:03,156 - Detection -   train_loss = 2.2156099557876585
2024-10-05 15:57:07,782 - Detection - ***** Epoch: 35: Eval results *****
2024-10-05 15:57:07,782 - Detection -   best_eval_score = 98.42
2024-10-05 15:57:07,782 - Detection -   eval_score = 98.16
2024-10-05 15:57:07,782 - Detection -   train_loss = 2.2101656516393025
2024-10-05 15:57:12,305 - Detection - ***** Epoch: 36: Eval results *****
2024-10-05 15:57:12,306 - Detection -   best_eval_score = 98.42
2024-10-05 15:57:12,306 - Detection -   eval_score = 98.16
2024-10-05 15:57:12,306 - Detection -   train_loss = 2.1993439555168153
2024-10-05 15:57:16,778 - Detection - ***** Epoch: 37: Eval results *****
2024-10-05 15:57:16,778 - Detection -   best_eval_score = 98.42
2024-10-05 15:57:16,778 - Detection -   eval_score = 98.42
2024-10-05 15:57:16,778 - Detection -   train_loss = 2.196841474374135
2024-10-05 15:57:21,477 - Detection - ***** Epoch: 38: Eval results *****
2024-10-05 15:57:21,477 - Detection -   best_eval_score = 98.42
2024-10-05 15:57:21,477 - Detection -   eval_score = 98.42
2024-10-05 15:57:21,477 - Detection -   train_loss = 2.1862257440884907
2024-10-05 15:57:26,028 - Detection - ***** Epoch: 39: Eval results *****
2024-10-05 15:57:26,028 - Detection -   best_eval_score = 98.42
2024-10-05 15:57:26,028 - Detection -   eval_score = 98.42
2024-10-05 15:57:26,028 - Detection -   train_loss = 2.188224736849467
2024-10-05 15:57:30,626 - Detection - ***** Epoch: 40: Eval results *****
2024-10-05 15:57:30,627 - Detection -   best_eval_score = 98.42
2024-10-05 15:57:30,627 - Detection -   eval_score = 98.29
2024-10-05 15:57:30,627 - Detection -   train_loss = 2.1765384395917255
2024-10-05 15:57:35,192 - Detection - ***** Epoch: 41: Eval results *****
2024-10-05 15:57:35,192 - Detection -   best_eval_score = 98.42
2024-10-05 15:57:35,192 - Detection -   eval_score = 98.16
2024-10-05 15:57:35,192 - Detection -   train_loss = 2.167403817176819
2024-10-05 15:57:35,193 - Detection - Pre-training finished...
2024-10-05 15:57:35,194 - Detection - Training Begin...
2024-10-05 15:57:40,602 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 15:57:40,603 - Detection -   best_eval_score = 0
2024-10-05 15:57:40,603 - Detection -   eval_score = 0.24
2024-10-05 15:57:40,603 - Detection -   train_loss = 12.654205322265625
2024-10-05 15:57:43,037 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 15:57:43,037 - Detection -   best_eval_score = 0.24
2024-10-05 15:57:43,037 - Detection -   eval_score = 19.91
2024-10-05 15:57:43,037 - Detection -   train_loss = 10.733275349934896
2024-10-05 15:57:45,480 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 15:57:45,480 - Detection -   best_eval_score = 19.91
2024-10-05 15:57:45,480 - Detection -   eval_score = 61.62
2024-10-05 15:57:45,480 - Detection -   train_loss = 8.186748107274374
2024-10-05 15:57:47,916 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 15:57:47,916 - Detection -   best_eval_score = 61.62
2024-10-05 15:57:47,916 - Detection -   eval_score = 83.49
2024-10-05 15:57:47,916 - Detection -   train_loss = 5.445867522557577
2024-10-05 15:57:50,363 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 15:57:50,363 - Detection -   best_eval_score = 83.49
2024-10-05 15:57:50,363 - Detection -   eval_score = 90.19
2024-10-05 15:57:50,363 - Detection -   train_loss = 3.1939789692560834
2024-10-05 15:57:52,795 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 15:57:52,795 - Detection -   best_eval_score = 90.19
2024-10-05 15:57:52,795 - Detection -   eval_score = 92.56
2024-10-05 15:57:52,795 - Detection -   train_loss = 2.037766607602437
2024-10-05 15:57:55,252 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 15:57:55,252 - Detection -   best_eval_score = 92.56
2024-10-05 15:57:55,252 - Detection -   eval_score = 92.69
2024-10-05 15:57:55,252 - Detection -   train_loss = 1.830931051572164
2024-10-05 15:57:57,685 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 15:57:57,685 - Detection -   best_eval_score = 92.69
2024-10-05 15:57:57,685 - Detection -   eval_score = 92.9
2024-10-05 15:57:57,686 - Detection -   train_loss = 1.8114461342493693
2024-10-05 15:58:00,120 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 15:58:00,121 - Detection -   best_eval_score = 92.9
2024-10-05 15:58:00,121 - Detection -   eval_score = 93.0
2024-10-05 15:58:00,121 - Detection -   train_loss = 1.7991022229194642
2024-10-05 15:58:02,554 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 15:58:02,555 - Detection -   best_eval_score = 93.0
2024-10-05 15:58:02,555 - Detection -   eval_score = 93.06
2024-10-05 15:58:02,555 - Detection -   train_loss = 1.7985989967981975
2024-10-05 15:58:04,976 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 15:58:04,976 - Detection -   best_eval_score = 93.06
2024-10-05 15:58:04,976 - Detection -   eval_score = 93.09
2024-10-05 15:58:04,976 - Detection -   train_loss = 1.7782816767692566
2024-10-05 15:58:07,402 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 15:58:07,402 - Detection -   best_eval_score = 93.09
2024-10-05 15:58:07,402 - Detection -   eval_score = 93.0
2024-10-05 15:58:07,402 - Detection -   train_loss = 1.8019872585932413
2024-10-05 15:58:09,826 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 15:58:09,826 - Detection -   best_eval_score = 93.09
2024-10-05 15:58:09,826 - Detection -   eval_score = 93.0
2024-10-05 15:58:09,826 - Detection -   train_loss = 1.7836162328720093
2024-10-05 15:58:12,285 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 15:58:12,286 - Detection -   best_eval_score = 93.09
2024-10-05 15:58:12,286 - Detection -   eval_score = 93.06
2024-10-05 15:58:12,286 - Detection -   train_loss = 1.7971896211306253
2024-10-05 15:58:14,734 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 15:58:14,734 - Detection -   best_eval_score = 93.09
2024-10-05 15:58:14,734 - Detection -   eval_score = 93.06
2024-10-05 15:58:14,734 - Detection -   train_loss = 1.8035442233085632
2024-10-05 15:58:17,183 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 15:58:17,184 - Detection -   best_eval_score = 93.09
2024-10-05 15:58:17,184 - Detection -   eval_score = 93.0
2024-10-05 15:58:17,184 - Detection -   train_loss = 1.8022118171056112
2024-10-05 15:58:19,625 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 15:58:19,625 - Detection -   best_eval_score = 93.09
2024-10-05 15:58:19,625 - Detection -   eval_score = 93.06
2024-10-05 15:58:19,625 - Detection -   train_loss = 1.7896417061487833
2024-10-05 15:58:22,138 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 15:58:22,138 - Detection -   best_eval_score = 93.09
2024-10-05 15:58:22,138 - Detection -   eval_score = 93.06
2024-10-05 15:58:22,138 - Detection -   train_loss = 1.7937743981679282
2024-10-05 15:58:24,566 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 15:58:24,566 - Detection -   best_eval_score = 93.09
2024-10-05 15:58:24,566 - Detection -   eval_score = 93.0
2024-10-05 15:58:24,566 - Detection -   train_loss = 1.7906527956326803
2024-10-05 15:58:26,999 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 15:58:26,999 - Detection -   best_eval_score = 93.09
2024-10-05 15:58:26,999 - Detection -   eval_score = 93.09
2024-10-05 15:58:26,999 - Detection -   train_loss = 1.7866743048032125
2024-10-05 15:58:29,446 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 15:58:29,446 - Detection -   best_eval_score = 93.09
2024-10-05 15:58:29,446 - Detection -   eval_score = 93.18
2024-10-05 15:58:29,446 - Detection -   train_loss = 1.8065914551417033
2024-10-05 15:58:31,926 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 15:58:31,926 - Detection -   best_eval_score = 93.18
2024-10-05 15:58:31,926 - Detection -   eval_score = 93.16
2024-10-05 15:58:31,926 - Detection -   train_loss = 1.806429914633433
2024-10-05 15:58:34,375 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 15:58:34,375 - Detection -   best_eval_score = 93.18
2024-10-05 15:58:34,375 - Detection -   eval_score = 93.16
2024-10-05 15:58:34,375 - Detection -   train_loss = 1.8041351914405823
2024-10-05 15:58:36,822 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 15:58:36,822 - Detection -   best_eval_score = 93.18
2024-10-05 15:58:36,822 - Detection -   eval_score = 93.09
2024-10-05 15:58:36,822 - Detection -   train_loss = 1.8173198541005453
2024-10-05 15:58:39,256 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 15:58:39,256 - Detection -   best_eval_score = 93.18
2024-10-05 15:58:39,256 - Detection -   eval_score = 93.09
2024-10-05 15:58:39,256 - Detection -   train_loss = 1.7933217763900757
2024-10-05 15:58:41,702 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 15:58:41,703 - Detection -   best_eval_score = 93.18
2024-10-05 15:58:41,703 - Detection -   eval_score = 93.16
2024-10-05 15:58:41,703 - Detection -   train_loss = 1.8024739861488341
2024-10-05 15:58:44,142 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 15:58:44,142 - Detection -   best_eval_score = 93.18
2024-10-05 15:58:44,142 - Detection -   eval_score = 93.24
2024-10-05 15:58:44,142 - Detection -   train_loss = 1.7961311022440591
2024-10-05 15:58:46,592 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 15:58:46,592 - Detection -   best_eval_score = 93.24
2024-10-05 15:58:46,592 - Detection -   eval_score = 93.09
2024-10-05 15:58:46,592 - Detection -   train_loss = 1.7821792125701905
2024-10-05 15:58:49,019 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 15:58:49,020 - Detection -   best_eval_score = 93.24
2024-10-05 15:58:49,020 - Detection -   eval_score = 93.16
2024-10-05 15:58:49,020 - Detection -   train_loss = 1.7878106395403544
2024-10-05 15:58:51,457 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 15:58:51,457 - Detection -   best_eval_score = 93.24
2024-10-05 15:58:51,458 - Detection -   eval_score = 93.09
2024-10-05 15:58:51,458 - Detection -   train_loss = 1.7992204864819845
2024-10-05 15:58:53,905 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 15:58:53,905 - Detection -   best_eval_score = 93.24
2024-10-05 15:58:53,905 - Detection -   eval_score = 93.16
2024-10-05 15:58:53,905 - Detection -   train_loss = 1.808983079592387
2024-10-05 15:58:56,376 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 15:58:56,376 - Detection -   best_eval_score = 93.24
2024-10-05 15:58:56,376 - Detection -   eval_score = 93.15
2024-10-05 15:58:56,376 - Detection -   train_loss = 1.7900567293167113
2024-10-05 15:58:58,840 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 15:58:58,840 - Detection -   best_eval_score = 93.24
2024-10-05 15:58:58,841 - Detection -   eval_score = 93.0
2024-10-05 15:58:58,841 - Detection -   train_loss = 1.7918289144833883
2024-10-05 15:59:01,302 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 15:59:01,302 - Detection -   best_eval_score = 93.24
2024-10-05 15:59:01,302 - Detection -   eval_score = 93.18
2024-10-05 15:59:01,302 - Detection -   train_loss = 1.7704116304715474
2024-10-05 15:59:03,767 - Detection - ***** Epoch: 35: Eval results *****
2024-10-05 15:59:03,767 - Detection -   best_eval_score = 93.24
2024-10-05 15:59:03,767 - Detection -   eval_score = 93.06
2024-10-05 15:59:03,767 - Detection -   train_loss = 1.8095021645228069
2024-10-05 15:59:06,230 - Detection - ***** Epoch: 36: Eval results *****
2024-10-05 15:59:06,230 - Detection -   best_eval_score = 93.24
2024-10-05 15:59:06,230 - Detection -   eval_score = 93.16
2024-10-05 15:59:06,230 - Detection -   train_loss = 1.7940186937650044
2024-10-05 15:59:08,669 - Detection - ***** Epoch: 37: Eval results *****
2024-10-05 15:59:08,669 - Detection -   best_eval_score = 93.24
2024-10-05 15:59:08,669 - Detection -   eval_score = 93.0
2024-10-05 15:59:08,669 - Detection -   train_loss = 1.7888246854146321
2024-10-05 15:59:08,670 - Detection - Training Finished...
2024-10-05 15:59:08,670 - Detection - Testing begin...
2024-10-05 15:59:10,883 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 15:59:10,883 - Detection - [[  29    0    0 ...    0    0    1]
 [   0   22    0 ...    0    0    8]
 [   0    0   28 ...    0    0    2]
 ...
 [   0    0    0 ...   27    0    3]
 [   0    0    0 ...    0   25    5]
 [   2    3   43 ...    8    3 4064]]
2024-10-05 15:59:10,883 - Detection - ***** Test results *****
2024-10-05 15:59:10,883 - Detection -   Acc = 89.47
2024-10-05 15:59:10,883 - Detection -   F1 = 80.2635
2024-10-05 15:59:10,883 - Detection -   F1-known = 79.9236
2024-10-05 15:59:10,883 - Detection -   F1-open = 93.179
2024-10-05 15:59:10,883 - Detection - Testing finished...
2024-10-05 15:59:10,883 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 15:59:10,916 - Detection - ============================== Params ==============================
2024-10-05 15:59:10,917 - Detection - type:	open_intent_detection
2024-10-05 15:59:10,917 - Detection - logger_name:	Detection
2024-10-05 15:59:10,917 - Detection - log_dir:	logs
2024-10-05 15:59:10,917 - Detection - dataset:	oos
2024-10-05 15:59:10,917 - Detection - known_cls_ratio:	0.25
2024-10-05 15:59:10,917 - Detection - labeled_ratio:	1.0
2024-10-05 15:59:10,917 - Detection - method:	ADB
2024-10-05 15:59:10,917 - Detection - train:	True
2024-10-05 15:59:10,917 - Detection - tune:	True
2024-10-05 15:59:10,917 - Detection - pretrain:	True
2024-10-05 15:59:10,917 - Detection - b_train:	False
2024-10-05 15:59:10,917 - Detection - save_model:	False
2024-10-05 15:59:10,917 - Detection - backbone:	bert
2024-10-05 15:59:10,917 - Detection - config_file_name:	ADB
2024-10-05 15:59:10,917 - Detection - seed:	1
2024-10-05 15:59:10,917 - Detection - gpu_id:	0
2024-10-05 15:59:10,917 - Detection - pipe_results_path:	pipe_results
2024-10-05 15:59:10,917 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 15:59:10,917 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 15:59:10,917 - Detection - model_dir:	models
2024-10-05 15:59:10,917 - Detection - load_pretrained_method:	None
2024-10-05 15:59:10,917 - Detection - result_dir:	results
2024-10-05 15:59:10,917 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 15:59:10,917 - Detection - save_results:	True
2024-10-05 15:59:10,917 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 15:59:10,917 - Detection - dataset_neg:	SQUAD
2024-10-05 15:59:10,917 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1
2024-10-05 15:59:10,917 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1/models
2024-10-05 15:59:10,917 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 15:59:10,917 - Detection - num_train_epochs:	100
2024-10-05 15:59:10,917 - Detection - num_labels:	38
2024-10-05 15:59:10,917 - Detection - max_seq_length:	30
2024-10-05 15:59:10,917 - Detection - freeze_backbone_parameters:	True
2024-10-05 15:59:10,917 - Detection - feat_dim:	768
2024-10-05 15:59:10,917 - Detection - warmup_proportion:	0.1
2024-10-05 15:59:10,917 - Detection - lr_boundary:	0.05
2024-10-05 15:59:10,917 - Detection - lr:	2e-05
2024-10-05 15:59:10,917 - Detection - activation:	relu
2024-10-05 15:59:10,917 - Detection - train_batch_size:	128
2024-10-05 15:59:10,917 - Detection - eval_batch_size:	64
2024-10-05 15:59:10,918 - Detection - test_batch_size:	64
2024-10-05 15:59:10,918 - Detection - wait_patient:	10
2024-10-05 15:59:10,918 - Detection - safe1:	0.3
2024-10-05 15:59:10,918 - Detection - safe2:	0.5
2024-10-05 15:59:10,918 - Detection - neg_weight:	0.3
2024-10-05 15:59:10,918 - Detection - margin:	0.8
2024-10-05 15:59:10,918 - Detection - p:	2
2024-10-05 15:59:10,918 - Detection - loss_weight:	1
2024-10-05 15:59:10,918 - Detection - supcon_loss_weight:	0.7
2024-10-05 15:59:10,918 - Detection - triplet_loss_weight:	0.9
2024-10-05 15:59:10,918 - Detection - unseen_label_id:	38
2024-10-05 15:59:10,918 - Detection - anum_labels:	39
2024-10-05 15:59:10,918 - Detection - device:	cuda:0
2024-10-05 15:59:10,918 - Detection - ============================== End Params ==============================
2024-10-05 15:59:11,947 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 15:59:11,994 - Detection - Pre-training Begin...
2024-10-05 15:59:16,508 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 15:59:16,508 - Detection -   best_eval_score = 0
2024-10-05 15:59:16,508 - Detection -   eval_score = 2.63
2024-10-05 15:59:16,508 - Detection -   train_loss = 8.840952650705974
2024-10-05 15:59:21,097 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 15:59:21,097 - Detection -   best_eval_score = 2.63
2024-10-05 15:59:21,097 - Detection -   eval_score = 2.37
2024-10-05 15:59:21,097 - Detection -   train_loss = 8.413834857940675
2024-10-05 15:59:25,576 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 15:59:25,577 - Detection -   best_eval_score = 2.63
2024-10-05 15:59:25,577 - Detection -   eval_score = 5.92
2024-10-05 15:59:25,577 - Detection -   train_loss = 8.04676472345988
2024-10-05 15:59:30,138 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 15:59:30,138 - Detection -   best_eval_score = 5.92
2024-10-05 15:59:30,138 - Detection -   eval_score = 12.24
2024-10-05 15:59:30,138 - Detection -   train_loss = 7.524816433588664
2024-10-05 15:59:34,758 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 15:59:34,758 - Detection -   best_eval_score = 12.24
2024-10-05 15:59:34,758 - Detection -   eval_score = 19.34
2024-10-05 15:59:34,758 - Detection -   train_loss = 7.21731653213501
2024-10-05 15:59:39,292 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 15:59:39,292 - Detection -   best_eval_score = 19.34
2024-10-05 15:59:39,292 - Detection -   eval_score = 29.21
2024-10-05 15:59:39,293 - Detection -   train_loss = 6.971635357538859
2024-10-05 15:59:43,914 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 15:59:43,914 - Detection -   best_eval_score = 29.21
2024-10-05 15:59:43,914 - Detection -   eval_score = 43.68
2024-10-05 15:59:43,914 - Detection -   train_loss = 6.714383459091186
2024-10-05 15:59:48,456 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 15:59:48,456 - Detection -   best_eval_score = 43.68
2024-10-05 15:59:48,456 - Detection -   eval_score = 62.5
2024-10-05 15:59:48,456 - Detection -   train_loss = 6.4482379913330075
2024-10-05 15:59:53,018 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 15:59:53,018 - Detection -   best_eval_score = 62.5
2024-10-05 15:59:53,018 - Detection -   eval_score = 78.82
2024-10-05 15:59:53,018 - Detection -   train_loss = 6.101870743433635
2024-10-05 15:59:57,582 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 15:59:57,583 - Detection -   best_eval_score = 78.82
2024-10-05 15:59:57,583 - Detection -   eval_score = 89.47
2024-10-05 15:59:57,583 - Detection -   train_loss = 5.669815174738566
2024-10-05 16:00:02,068 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 16:00:02,068 - Detection -   best_eval_score = 89.47
2024-10-05 16:00:02,069 - Detection -   eval_score = 93.03
2024-10-05 16:00:02,069 - Detection -   train_loss = 5.1719528039296465
2024-10-05 16:00:06,643 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 16:00:06,643 - Detection -   best_eval_score = 93.03
2024-10-05 16:00:06,644 - Detection -   eval_score = 95.66
2024-10-05 16:00:06,644 - Detection -   train_loss = 4.566092046101888
2024-10-05 16:00:11,185 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 16:00:11,185 - Detection -   best_eval_score = 95.66
2024-10-05 16:00:11,185 - Detection -   eval_score = 96.32
2024-10-05 16:00:11,185 - Detection -   train_loss = 4.017891518274943
2024-10-05 16:00:15,660 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 16:00:15,660 - Detection -   best_eval_score = 96.32
2024-10-05 16:00:15,660 - Detection -   eval_score = 97.11
2024-10-05 16:00:15,660 - Detection -   train_loss = 3.5873610893885295
2024-10-05 16:00:20,189 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 16:00:20,189 - Detection -   best_eval_score = 97.11
2024-10-05 16:00:20,189 - Detection -   eval_score = 97.24
2024-10-05 16:00:20,189 - Detection -   train_loss = 3.2240941762924193
2024-10-05 16:00:24,708 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 16:00:24,708 - Detection -   best_eval_score = 97.24
2024-10-05 16:00:24,708 - Detection -   eval_score = 97.63
2024-10-05 16:00:24,708 - Detection -   train_loss = 2.9790993372599286
2024-10-05 16:00:29,287 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 16:00:29,287 - Detection -   best_eval_score = 97.63
2024-10-05 16:00:29,288 - Detection -   eval_score = 97.76
2024-10-05 16:00:29,288 - Detection -   train_loss = 2.7947305917739866
2024-10-05 16:00:33,765 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 16:00:33,766 - Detection -   best_eval_score = 97.76
2024-10-05 16:00:33,766 - Detection -   eval_score = 97.76
2024-10-05 16:00:33,766 - Detection -   train_loss = 2.6950417280197145
2024-10-05 16:00:38,283 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 16:00:38,283 - Detection -   best_eval_score = 97.76
2024-10-05 16:00:38,283 - Detection -   eval_score = 97.63
2024-10-05 16:00:38,283 - Detection -   train_loss = 2.6019296646118164
2024-10-05 16:00:42,781 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 16:00:42,781 - Detection -   best_eval_score = 97.76
2024-10-05 16:00:42,781 - Detection -   eval_score = 97.76
2024-10-05 16:00:42,781 - Detection -   train_loss = 2.5354123592376707
2024-10-05 16:00:47,334 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 16:00:47,335 - Detection -   best_eval_score = 97.76
2024-10-05 16:00:47,335 - Detection -   eval_score = 98.16
2024-10-05 16:00:47,335 - Detection -   train_loss = 2.46728568871816
2024-10-05 16:00:51,903 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 16:00:51,904 - Detection -   best_eval_score = 98.16
2024-10-05 16:00:51,904 - Detection -   eval_score = 98.03
2024-10-05 16:00:51,904 - Detection -   train_loss = 2.4311756610870363
2024-10-05 16:00:56,473 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 16:00:56,473 - Detection -   best_eval_score = 98.16
2024-10-05 16:00:56,473 - Detection -   eval_score = 98.16
2024-10-05 16:00:56,473 - Detection -   train_loss = 2.4038280884424847
2024-10-05 16:01:01,047 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 16:01:01,047 - Detection -   best_eval_score = 98.16
2024-10-05 16:01:01,047 - Detection -   eval_score = 98.16
2024-10-05 16:01:01,047 - Detection -   train_loss = 2.3619471629460653
2024-10-05 16:01:05,714 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 16:01:05,714 - Detection -   best_eval_score = 98.16
2024-10-05 16:01:05,715 - Detection -   eval_score = 98.29
2024-10-05 16:01:05,715 - Detection -   train_loss = 2.33579793771108
2024-10-05 16:01:10,391 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 16:01:10,391 - Detection -   best_eval_score = 98.29
2024-10-05 16:01:10,391 - Detection -   eval_score = 98.16
2024-10-05 16:01:10,391 - Detection -   train_loss = 2.318979581197103
2024-10-05 16:01:15,025 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 16:01:15,026 - Detection -   best_eval_score = 98.29
2024-10-05 16:01:15,026 - Detection -   eval_score = 98.16
2024-10-05 16:01:15,026 - Detection -   train_loss = 2.3101202567418415
2024-10-05 16:01:19,705 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 16:01:19,705 - Detection -   best_eval_score = 98.29
2024-10-05 16:01:19,705 - Detection -   eval_score = 98.16
2024-10-05 16:01:19,705 - Detection -   train_loss = 2.2800166249275207
2024-10-05 16:01:24,268 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 16:01:24,268 - Detection -   best_eval_score = 98.29
2024-10-05 16:01:24,268 - Detection -   eval_score = 98.29
2024-10-05 16:01:24,268 - Detection -   train_loss = 2.265408253669739
2024-10-05 16:01:28,877 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 16:01:28,877 - Detection -   best_eval_score = 98.29
2024-10-05 16:01:28,877 - Detection -   eval_score = 98.29
2024-10-05 16:01:28,877 - Detection -   train_loss = 2.2664974093437196
2024-10-05 16:01:33,417 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 16:01:33,417 - Detection -   best_eval_score = 98.29
2024-10-05 16:01:33,417 - Detection -   eval_score = 98.42
2024-10-05 16:01:33,417 - Detection -   train_loss = 2.2559389591217043
2024-10-05 16:01:37,973 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 16:01:37,973 - Detection -   best_eval_score = 98.42
2024-10-05 16:01:37,973 - Detection -   eval_score = 98.29
2024-10-05 16:01:37,973 - Detection -   train_loss = 2.2376607497533163
2024-10-05 16:01:42,455 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 16:01:42,455 - Detection -   best_eval_score = 98.42
2024-10-05 16:01:42,455 - Detection -   eval_score = 98.42
2024-10-05 16:01:42,455 - Detection -   train_loss = 2.230059504508972
2024-10-05 16:01:46,935 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 16:01:46,935 - Detection -   best_eval_score = 98.42
2024-10-05 16:01:46,935 - Detection -   eval_score = 98.16
2024-10-05 16:01:46,935 - Detection -   train_loss = 2.2156099557876585
2024-10-05 16:01:51,414 - Detection - ***** Epoch: 35: Eval results *****
2024-10-05 16:01:51,414 - Detection -   best_eval_score = 98.42
2024-10-05 16:01:51,414 - Detection -   eval_score = 98.16
2024-10-05 16:01:51,414 - Detection -   train_loss = 2.2101656516393025
2024-10-05 16:01:55,956 - Detection - ***** Epoch: 36: Eval results *****
2024-10-05 16:01:55,956 - Detection -   best_eval_score = 98.42
2024-10-05 16:01:55,956 - Detection -   eval_score = 98.16
2024-10-05 16:01:55,956 - Detection -   train_loss = 2.1993439555168153
2024-10-05 16:02:00,481 - Detection - ***** Epoch: 37: Eval results *****
2024-10-05 16:02:00,481 - Detection -   best_eval_score = 98.42
2024-10-05 16:02:00,481 - Detection -   eval_score = 98.42
2024-10-05 16:02:00,481 - Detection -   train_loss = 2.196841474374135
2024-10-05 16:02:04,937 - Detection - ***** Epoch: 38: Eval results *****
2024-10-05 16:02:04,937 - Detection -   best_eval_score = 98.42
2024-10-05 16:02:04,937 - Detection -   eval_score = 98.42
2024-10-05 16:02:04,937 - Detection -   train_loss = 2.1862257440884907
2024-10-05 16:02:09,562 - Detection - ***** Epoch: 39: Eval results *****
2024-10-05 16:02:09,562 - Detection -   best_eval_score = 98.42
2024-10-05 16:02:09,562 - Detection -   eval_score = 98.42
2024-10-05 16:02:09,562 - Detection -   train_loss = 2.188224736849467
2024-10-05 16:02:14,157 - Detection - ***** Epoch: 40: Eval results *****
2024-10-05 16:02:14,158 - Detection -   best_eval_score = 98.42
2024-10-05 16:02:14,158 - Detection -   eval_score = 98.29
2024-10-05 16:02:14,158 - Detection -   train_loss = 2.1765384395917255
2024-10-05 16:02:18,671 - Detection - ***** Epoch: 41: Eval results *****
2024-10-05 16:02:18,672 - Detection -   best_eval_score = 98.42
2024-10-05 16:02:18,672 - Detection -   eval_score = 98.16
2024-10-05 16:02:18,672 - Detection -   train_loss = 2.167403817176819
2024-10-05 16:02:18,673 - Detection - Pre-training finished...
2024-10-05 16:02:18,673 - Detection - Training Begin...
2024-10-05 16:02:24,095 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 16:02:24,096 - Detection -   best_eval_score = 0
2024-10-05 16:02:24,096 - Detection -   eval_score = 0.24
2024-10-05 16:02:24,096 - Detection -   train_loss = 8.996920108795166
2024-10-05 16:02:26,525 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 16:02:26,526 - Detection -   best_eval_score = 0.24
2024-10-05 16:02:26,526 - Detection -   eval_score = 19.91
2024-10-05 16:02:26,526 - Detection -   train_loss = 7.5955139319101965
2024-10-05 16:02:28,963 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 16:02:28,963 - Detection -   best_eval_score = 19.91
2024-10-05 16:02:28,963 - Detection -   eval_score = 61.62
2024-10-05 16:02:28,963 - Detection -   train_loss = 5.768767388661702
2024-10-05 16:02:31,411 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 16:02:31,411 - Detection -   best_eval_score = 61.62
2024-10-05 16:02:31,412 - Detection -   eval_score = 83.49
2024-10-05 16:02:31,412 - Detection -   train_loss = 3.766170318921407
2024-10-05 16:02:33,846 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 16:02:33,846 - Detection -   best_eval_score = 83.49
2024-10-05 16:02:33,846 - Detection -   eval_score = 90.19
2024-10-05 16:02:33,846 - Detection -   train_loss = 2.126965363820394
2024-10-05 16:02:36,317 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 16:02:36,317 - Detection -   best_eval_score = 90.19
2024-10-05 16:02:36,317 - Detection -   eval_score = 92.4
2024-10-05 16:02:36,317 - Detection -   train_loss = 1.3444388031959533
2024-10-05 16:02:38,766 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 16:02:38,766 - Detection -   best_eval_score = 92.4
2024-10-05 16:02:38,766 - Detection -   eval_score = 92.56
2024-10-05 16:02:38,766 - Detection -   train_loss = 1.253204349676768
2024-10-05 16:02:41,199 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 16:02:41,199 - Detection -   best_eval_score = 92.56
2024-10-05 16:02:41,199 - Detection -   eval_score = 92.56
2024-10-05 16:02:41,199 - Detection -   train_loss = 1.2598969697952271
2024-10-05 16:02:43,638 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 16:02:43,638 - Detection -   best_eval_score = 92.56
2024-10-05 16:02:43,638 - Detection -   eval_score = 92.56
2024-10-05 16:02:43,638 - Detection -   train_loss = 1.250214699904124
2024-10-05 16:02:46,069 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 16:02:46,069 - Detection -   best_eval_score = 92.56
2024-10-05 16:02:46,069 - Detection -   eval_score = 92.56
2024-10-05 16:02:46,069 - Detection -   train_loss = 1.2487156510353088
2024-10-05 16:02:48,521 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 16:02:48,521 - Detection -   best_eval_score = 92.56
2024-10-05 16:02:48,521 - Detection -   eval_score = 92.56
2024-10-05 16:02:48,521 - Detection -   train_loss = 1.245848818620046
2024-10-05 16:02:50,953 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 16:02:50,953 - Detection -   best_eval_score = 92.56
2024-10-05 16:02:50,953 - Detection -   eval_score = 92.56
2024-10-05 16:02:50,954 - Detection -   train_loss = 1.2545177181561789
2024-10-05 16:02:53,389 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 16:02:53,389 - Detection -   best_eval_score = 92.56
2024-10-05 16:02:53,389 - Detection -   eval_score = 92.56
2024-10-05 16:02:53,389 - Detection -   train_loss = 1.2521466294924417
2024-10-05 16:02:55,838 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 16:02:55,839 - Detection -   best_eval_score = 92.56
2024-10-05 16:02:55,839 - Detection -   eval_score = 92.56
2024-10-05 16:02:55,839 - Detection -   train_loss = 1.25097652276357
2024-10-05 16:02:58,278 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 16:02:58,279 - Detection -   best_eval_score = 92.56
2024-10-05 16:02:58,279 - Detection -   eval_score = 92.56
2024-10-05 16:02:58,279 - Detection -   train_loss = 1.2581454316775005
2024-10-05 16:03:00,722 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 16:03:00,722 - Detection -   best_eval_score = 92.56
2024-10-05 16:03:00,722 - Detection -   eval_score = 92.41
2024-10-05 16:03:00,722 - Detection -   train_loss = 1.2596615155537922
2024-10-05 16:03:03,158 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 16:03:03,159 - Detection -   best_eval_score = 92.56
2024-10-05 16:03:03,159 - Detection -   eval_score = 92.49
2024-10-05 16:03:03,159 - Detection -   train_loss = 1.2453459938367208
2024-10-05 16:03:03,159 - Detection - Training Finished...
2024-10-05 16:03:03,159 - Detection - Testing begin...
2024-10-05 16:03:05,361 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 16:03:05,361 - Detection - [[  29    0    0 ...    0    0    1]
 [   0   22    0 ...    0    0    8]
 [   0    0   27 ...    0    0    3]
 ...
 [   0    0    0 ...   27    0    3]
 [   0    0    0 ...    0   25    5]
 [   2    3   27 ...    7    3 4144]]
2024-10-05 16:03:05,361 - Detection - ***** Test results *****
2024-10-05 16:03:05,361 - Detection -   Acc = 90.61
2024-10-05 16:03:05,361 - Detection -   F1 = 81.2317
2024-10-05 16:03:05,361 - Detection -   F1-known = 80.8962
2024-10-05 16:03:05,362 - Detection -   F1-open = 93.9789
2024-10-05 16:03:05,362 - Detection - Testing finished...
2024-10-05 16:03:05,362 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 16:03:05,395 - Detection - ============================== Params ==============================
2024-10-05 16:03:05,395 - Detection - type:	open_intent_detection
2024-10-05 16:03:05,395 - Detection - logger_name:	Detection
2024-10-05 16:03:05,395 - Detection - log_dir:	logs
2024-10-05 16:03:05,395 - Detection - dataset:	oos
2024-10-05 16:03:05,395 - Detection - known_cls_ratio:	0.25
2024-10-05 16:03:05,395 - Detection - labeled_ratio:	1.0
2024-10-05 16:03:05,395 - Detection - method:	ADB
2024-10-05 16:03:05,395 - Detection - train:	True
2024-10-05 16:03:05,395 - Detection - tune:	True
2024-10-05 16:03:05,395 - Detection - pretrain:	True
2024-10-05 16:03:05,395 - Detection - b_train:	False
2024-10-05 16:03:05,395 - Detection - save_model:	False
2024-10-05 16:03:05,395 - Detection - backbone:	bert
2024-10-05 16:03:05,395 - Detection - config_file_name:	ADB
2024-10-05 16:03:05,395 - Detection - seed:	1
2024-10-05 16:03:05,395 - Detection - gpu_id:	0
2024-10-05 16:03:05,395 - Detection - pipe_results_path:	pipe_results
2024-10-05 16:03:05,395 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 16:03:05,396 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 16:03:05,396 - Detection - model_dir:	models
2024-10-05 16:03:05,396 - Detection - load_pretrained_method:	None
2024-10-05 16:03:05,396 - Detection - result_dir:	results
2024-10-05 16:03:05,396 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 16:03:05,396 - Detection - save_results:	True
2024-10-05 16:03:05,396 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 16:03:05,396 - Detection - dataset_neg:	SQUAD
2024-10-05 16:03:05,396 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1
2024-10-05 16:03:05,396 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1/models
2024-10-05 16:03:05,396 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 16:03:05,396 - Detection - num_train_epochs:	100
2024-10-05 16:03:05,396 - Detection - num_labels:	38
2024-10-05 16:03:05,396 - Detection - max_seq_length:	30
2024-10-05 16:03:05,396 - Detection - freeze_backbone_parameters:	True
2024-10-05 16:03:05,396 - Detection - feat_dim:	768
2024-10-05 16:03:05,396 - Detection - warmup_proportion:	0.1
2024-10-05 16:03:05,396 - Detection - lr_boundary:	0.05
2024-10-05 16:03:05,396 - Detection - lr:	2e-05
2024-10-05 16:03:05,396 - Detection - activation:	relu
2024-10-05 16:03:05,396 - Detection - train_batch_size:	128
2024-10-05 16:03:05,396 - Detection - eval_batch_size:	64
2024-10-05 16:03:05,396 - Detection - test_batch_size:	64
2024-10-05 16:03:05,396 - Detection - wait_patient:	10
2024-10-05 16:03:05,396 - Detection - safe1:	0.3
2024-10-05 16:03:05,396 - Detection - safe2:	0.5
2024-10-05 16:03:05,396 - Detection - neg_weight:	0.5
2024-10-05 16:03:05,396 - Detection - margin:	0.8
2024-10-05 16:03:05,396 - Detection - p:	2
2024-10-05 16:03:05,396 - Detection - loss_weight:	1
2024-10-05 16:03:05,396 - Detection - supcon_loss_weight:	0.7
2024-10-05 16:03:05,396 - Detection - triplet_loss_weight:	0.9
2024-10-05 16:03:05,396 - Detection - unseen_label_id:	38
2024-10-05 16:03:05,396 - Detection - anum_labels:	39
2024-10-05 16:03:05,396 - Detection - device:	cuda:0
2024-10-05 16:03:05,396 - Detection - ============================== End Params ==============================
2024-10-05 16:03:06,411 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 16:03:06,459 - Detection - Pre-training Begin...
2024-10-05 16:03:10,956 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 16:03:10,956 - Detection -   best_eval_score = 0
2024-10-05 16:03:10,956 - Detection -   eval_score = 2.63
2024-10-05 16:03:10,956 - Detection -   train_loss = 8.840952650705974
2024-10-05 16:03:15,548 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 16:03:15,548 - Detection -   best_eval_score = 2.63
2024-10-05 16:03:15,548 - Detection -   eval_score = 2.37
2024-10-05 16:03:15,548 - Detection -   train_loss = 8.413834857940675
2024-10-05 16:03:20,053 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 16:03:20,053 - Detection -   best_eval_score = 2.63
2024-10-05 16:03:20,053 - Detection -   eval_score = 5.92
2024-10-05 16:03:20,053 - Detection -   train_loss = 8.04676472345988
2024-10-05 16:03:24,644 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 16:03:24,644 - Detection -   best_eval_score = 5.92
2024-10-05 16:03:24,644 - Detection -   eval_score = 12.24
2024-10-05 16:03:24,644 - Detection -   train_loss = 7.524816433588664
2024-10-05 16:03:29,261 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 16:03:29,261 - Detection -   best_eval_score = 12.24
2024-10-05 16:03:29,261 - Detection -   eval_score = 19.34
2024-10-05 16:03:29,261 - Detection -   train_loss = 7.21731653213501
2024-10-05 16:03:33,878 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 16:03:33,879 - Detection -   best_eval_score = 19.34
2024-10-05 16:03:33,879 - Detection -   eval_score = 29.21
2024-10-05 16:03:33,879 - Detection -   train_loss = 6.971635357538859
2024-10-05 16:03:38,479 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 16:03:38,479 - Detection -   best_eval_score = 29.21
2024-10-05 16:03:38,479 - Detection -   eval_score = 43.68
2024-10-05 16:03:38,479 - Detection -   train_loss = 6.714383459091186
2024-10-05 16:03:43,046 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 16:03:43,046 - Detection -   best_eval_score = 43.68
2024-10-05 16:03:43,046 - Detection -   eval_score = 62.5
2024-10-05 16:03:43,046 - Detection -   train_loss = 6.4482379913330075
2024-10-05 16:03:47,641 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 16:03:47,641 - Detection -   best_eval_score = 62.5
2024-10-05 16:03:47,641 - Detection -   eval_score = 78.82
2024-10-05 16:03:47,641 - Detection -   train_loss = 6.101870743433635
2024-10-05 16:03:52,286 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 16:03:52,286 - Detection -   best_eval_score = 78.82
2024-10-05 16:03:52,286 - Detection -   eval_score = 89.47
2024-10-05 16:03:52,287 - Detection -   train_loss = 5.669815174738566
2024-10-05 16:03:56,894 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 16:03:56,894 - Detection -   best_eval_score = 89.47
2024-10-05 16:03:56,894 - Detection -   eval_score = 93.03
2024-10-05 16:03:56,894 - Detection -   train_loss = 5.1719528039296465
2024-10-05 16:04:01,496 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 16:04:01,497 - Detection -   best_eval_score = 93.03
2024-10-05 16:04:01,497 - Detection -   eval_score = 95.66
2024-10-05 16:04:01,497 - Detection -   train_loss = 4.566092046101888
2024-10-05 16:04:06,113 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 16:04:06,114 - Detection -   best_eval_score = 95.66
2024-10-05 16:04:06,114 - Detection -   eval_score = 96.32
2024-10-05 16:04:06,114 - Detection -   train_loss = 4.017891518274943
2024-10-05 16:04:10,668 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 16:04:10,668 - Detection -   best_eval_score = 96.32
2024-10-05 16:04:10,669 - Detection -   eval_score = 97.11
2024-10-05 16:04:10,669 - Detection -   train_loss = 3.5873610893885295
2024-10-05 16:04:15,246 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 16:04:15,246 - Detection -   best_eval_score = 97.11
2024-10-05 16:04:15,246 - Detection -   eval_score = 97.24
2024-10-05 16:04:15,246 - Detection -   train_loss = 3.2240941762924193
2024-10-05 16:04:19,816 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 16:04:19,816 - Detection -   best_eval_score = 97.24
2024-10-05 16:04:19,816 - Detection -   eval_score = 97.63
2024-10-05 16:04:19,816 - Detection -   train_loss = 2.9790993372599286
2024-10-05 16:04:24,446 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 16:04:24,446 - Detection -   best_eval_score = 97.63
2024-10-05 16:04:24,446 - Detection -   eval_score = 97.76
2024-10-05 16:04:24,446 - Detection -   train_loss = 2.7947305917739866
2024-10-05 16:04:29,036 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 16:04:29,036 - Detection -   best_eval_score = 97.76
2024-10-05 16:04:29,036 - Detection -   eval_score = 97.76
2024-10-05 16:04:29,037 - Detection -   train_loss = 2.6950417280197145
2024-10-05 16:04:33,636 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 16:04:33,636 - Detection -   best_eval_score = 97.76
2024-10-05 16:04:33,636 - Detection -   eval_score = 97.63
2024-10-05 16:04:33,636 - Detection -   train_loss = 2.6019296646118164
2024-10-05 16:04:38,101 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 16:04:38,101 - Detection -   best_eval_score = 97.76
2024-10-05 16:04:38,101 - Detection -   eval_score = 97.76
2024-10-05 16:04:38,101 - Detection -   train_loss = 2.5354123592376707
2024-10-05 16:04:42,563 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 16:04:42,563 - Detection -   best_eval_score = 97.76
2024-10-05 16:04:42,563 - Detection -   eval_score = 98.16
2024-10-05 16:04:42,563 - Detection -   train_loss = 2.46728568871816
2024-10-05 16:04:47,040 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 16:04:47,040 - Detection -   best_eval_score = 98.16
2024-10-05 16:04:47,040 - Detection -   eval_score = 98.03
2024-10-05 16:04:47,040 - Detection -   train_loss = 2.4311756610870363
2024-10-05 16:04:51,495 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 16:04:51,495 - Detection -   best_eval_score = 98.16
2024-10-05 16:04:51,495 - Detection -   eval_score = 98.16
2024-10-05 16:04:51,495 - Detection -   train_loss = 2.4038280884424847
2024-10-05 16:04:55,953 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 16:04:55,953 - Detection -   best_eval_score = 98.16
2024-10-05 16:04:55,954 - Detection -   eval_score = 98.16
2024-10-05 16:04:55,954 - Detection -   train_loss = 2.3619471629460653
2024-10-05 16:05:00,445 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 16:05:00,445 - Detection -   best_eval_score = 98.16
2024-10-05 16:05:00,445 - Detection -   eval_score = 98.29
2024-10-05 16:05:00,445 - Detection -   train_loss = 2.33579793771108
2024-10-05 16:05:04,938 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 16:05:04,938 - Detection -   best_eval_score = 98.29
2024-10-05 16:05:04,938 - Detection -   eval_score = 98.16
2024-10-05 16:05:04,938 - Detection -   train_loss = 2.318979581197103
2024-10-05 16:05:09,490 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 16:05:09,491 - Detection -   best_eval_score = 98.29
2024-10-05 16:05:09,491 - Detection -   eval_score = 98.16
2024-10-05 16:05:09,491 - Detection -   train_loss = 2.3101202567418415
2024-10-05 16:05:13,983 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 16:05:13,983 - Detection -   best_eval_score = 98.29
2024-10-05 16:05:13,983 - Detection -   eval_score = 98.16
2024-10-05 16:05:13,983 - Detection -   train_loss = 2.2800166249275207
2024-10-05 16:05:18,489 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 16:05:18,489 - Detection -   best_eval_score = 98.29
2024-10-05 16:05:18,489 - Detection -   eval_score = 98.29
2024-10-05 16:05:18,489 - Detection -   train_loss = 2.265408253669739
2024-10-05 16:05:23,007 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 16:05:23,007 - Detection -   best_eval_score = 98.29
2024-10-05 16:05:23,008 - Detection -   eval_score = 98.29
2024-10-05 16:05:23,008 - Detection -   train_loss = 2.2664974093437196
2024-10-05 16:05:27,601 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 16:05:27,601 - Detection -   best_eval_score = 98.29
2024-10-05 16:05:27,601 - Detection -   eval_score = 98.42
2024-10-05 16:05:27,601 - Detection -   train_loss = 2.2559389591217043
2024-10-05 16:05:32,211 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 16:05:32,211 - Detection -   best_eval_score = 98.42
2024-10-05 16:05:32,211 - Detection -   eval_score = 98.29
2024-10-05 16:05:32,211 - Detection -   train_loss = 2.2376607497533163
2024-10-05 16:05:36,814 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 16:05:36,815 - Detection -   best_eval_score = 98.42
2024-10-05 16:05:36,815 - Detection -   eval_score = 98.42
2024-10-05 16:05:36,815 - Detection -   train_loss = 2.230059504508972
2024-10-05 16:05:41,383 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 16:05:41,384 - Detection -   best_eval_score = 98.42
2024-10-05 16:05:41,384 - Detection -   eval_score = 98.16
2024-10-05 16:05:41,384 - Detection -   train_loss = 2.2156099557876585
2024-10-05 16:05:45,898 - Detection - ***** Epoch: 35: Eval results *****
2024-10-05 16:05:45,898 - Detection -   best_eval_score = 98.42
2024-10-05 16:05:45,898 - Detection -   eval_score = 98.16
2024-10-05 16:05:45,898 - Detection -   train_loss = 2.2101656516393025
2024-10-05 16:05:50,441 - Detection - ***** Epoch: 36: Eval results *****
2024-10-05 16:05:50,441 - Detection -   best_eval_score = 98.42
2024-10-05 16:05:50,441 - Detection -   eval_score = 98.16
2024-10-05 16:05:50,441 - Detection -   train_loss = 2.1993439555168153
2024-10-05 16:05:54,960 - Detection - ***** Epoch: 37: Eval results *****
2024-10-05 16:05:54,960 - Detection -   best_eval_score = 98.42
2024-10-05 16:05:54,961 - Detection -   eval_score = 98.42
2024-10-05 16:05:54,961 - Detection -   train_loss = 2.196841474374135
2024-10-05 16:05:59,489 - Detection - ***** Epoch: 38: Eval results *****
2024-10-05 16:05:59,489 - Detection -   best_eval_score = 98.42
2024-10-05 16:05:59,489 - Detection -   eval_score = 98.42
2024-10-05 16:05:59,489 - Detection -   train_loss = 2.1862257440884907
2024-10-05 16:06:04,035 - Detection - ***** Epoch: 39: Eval results *****
2024-10-05 16:06:04,035 - Detection -   best_eval_score = 98.42
2024-10-05 16:06:04,035 - Detection -   eval_score = 98.42
2024-10-05 16:06:04,035 - Detection -   train_loss = 2.188224736849467
2024-10-05 16:06:08,648 - Detection - ***** Epoch: 40: Eval results *****
2024-10-05 16:06:08,648 - Detection -   best_eval_score = 98.42
2024-10-05 16:06:08,648 - Detection -   eval_score = 98.29
2024-10-05 16:06:08,648 - Detection -   train_loss = 2.1765384395917255
2024-10-05 16:06:13,196 - Detection - ***** Epoch: 41: Eval results *****
2024-10-05 16:06:13,196 - Detection -   best_eval_score = 98.42
2024-10-05 16:06:13,196 - Detection -   eval_score = 98.16
2024-10-05 16:06:13,196 - Detection -   train_loss = 2.167403817176819
2024-10-05 16:06:13,197 - Detection - Pre-training finished...
2024-10-05 16:06:13,198 - Detection - Training Begin...
2024-10-05 16:06:18,628 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 16:06:18,628 - Detection -   best_eval_score = 0
2024-10-05 16:06:18,628 - Detection -   eval_score = 0.24
2024-10-05 16:06:18,628 - Detection -   train_loss = 10.427834065755208
2024-10-05 16:06:21,071 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 16:06:21,071 - Detection -   best_eval_score = 0.24
2024-10-05 16:06:21,072 - Detection -   eval_score = 19.91
2024-10-05 16:06:21,072 - Detection -   train_loss = 8.818618408838908
2024-10-05 16:06:23,528 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 16:06:23,528 - Detection -   best_eval_score = 19.91
2024-10-05 16:06:23,529 - Detection -   eval_score = 61.62
2024-10-05 16:06:23,529 - Detection -   train_loss = 6.704003270467123
2024-10-05 16:06:26,020 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 16:06:26,020 - Detection -   best_eval_score = 61.62
2024-10-05 16:06:26,020 - Detection -   eval_score = 83.49
2024-10-05 16:06:26,020 - Detection -   train_loss = 4.408009696006775
2024-10-05 16:06:28,487 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 16:06:28,487 - Detection -   best_eval_score = 83.49
2024-10-05 16:06:28,488 - Detection -   eval_score = 90.19
2024-10-05 16:06:28,488 - Detection -   train_loss = 2.530222280820211
2024-10-05 16:06:30,919 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 16:06:30,919 - Detection -   best_eval_score = 90.19
2024-10-05 16:06:30,919 - Detection -   eval_score = 92.4
2024-10-05 16:06:30,919 - Detection -   train_loss = 1.6075873454411824
2024-10-05 16:06:33,355 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 16:06:33,356 - Detection -   best_eval_score = 92.4
2024-10-05 16:06:33,356 - Detection -   eval_score = 92.62
2024-10-05 16:06:33,356 - Detection -   train_loss = 1.4785146355628966
2024-10-05 16:06:35,803 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 16:06:35,803 - Detection -   best_eval_score = 92.62
2024-10-05 16:06:35,803 - Detection -   eval_score = 92.69
2024-10-05 16:06:35,803 - Detection -   train_loss = 1.4764911651611328
2024-10-05 16:06:38,233 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 16:06:38,233 - Detection -   best_eval_score = 92.69
2024-10-05 16:06:38,233 - Detection -   eval_score = 92.6
2024-10-05 16:06:38,233 - Detection -   train_loss = 1.4676318963368733
2024-10-05 16:06:40,666 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 16:06:40,666 - Detection -   best_eval_score = 92.69
2024-10-05 16:06:40,666 - Detection -   eval_score = 92.69
2024-10-05 16:06:40,666 - Detection -   train_loss = 1.468680707613627
2024-10-05 16:06:43,094 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 16:06:43,094 - Detection -   best_eval_score = 92.69
2024-10-05 16:06:43,095 - Detection -   eval_score = 92.69
2024-10-05 16:06:43,095 - Detection -   train_loss = 1.4580745736757914
2024-10-05 16:06:45,524 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 16:06:45,524 - Detection -   best_eval_score = 92.69
2024-10-05 16:06:45,524 - Detection -   eval_score = 92.62
2024-10-05 16:06:45,524 - Detection -   train_loss = 1.473486840724945
2024-10-05 16:06:47,958 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 16:06:47,958 - Detection -   best_eval_score = 92.69
2024-10-05 16:06:47,958 - Detection -   eval_score = 92.62
2024-10-05 16:06:47,958 - Detection -   train_loss = 1.4638929327329
2024-10-05 16:06:50,398 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 16:06:50,399 - Detection -   best_eval_score = 92.69
2024-10-05 16:06:50,399 - Detection -   eval_score = 92.76
2024-10-05 16:06:50,399 - Detection -   train_loss = 1.469568383693695
2024-10-05 16:06:52,819 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 16:06:52,819 - Detection -   best_eval_score = 92.76
2024-10-05 16:06:52,819 - Detection -   eval_score = 92.76
2024-10-05 16:06:52,819 - Detection -   train_loss = 1.4756814201672872
2024-10-05 16:06:55,260 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 16:06:55,260 - Detection -   best_eval_score = 92.76
2024-10-05 16:06:55,260 - Detection -   eval_score = 92.76
2024-10-05 16:06:55,260 - Detection -   train_loss = 1.476658813158671
2024-10-05 16:06:57,691 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 16:06:57,691 - Detection -   best_eval_score = 92.76
2024-10-05 16:06:57,691 - Detection -   eval_score = 92.62
2024-10-05 16:06:57,691 - Detection -   train_loss = 1.4624348243077596
2024-10-05 16:07:00,118 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 16:07:00,118 - Detection -   best_eval_score = 92.76
2024-10-05 16:07:00,118 - Detection -   eval_score = 92.82
2024-10-05 16:07:00,119 - Detection -   train_loss = 1.4687802990277607
2024-10-05 16:07:02,548 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 16:07:02,548 - Detection -   best_eval_score = 92.82
2024-10-05 16:07:02,548 - Detection -   eval_score = 92.69
2024-10-05 16:07:02,548 - Detection -   train_loss = 1.4649540265401204
2024-10-05 16:07:04,972 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 16:07:04,973 - Detection -   best_eval_score = 92.82
2024-10-05 16:07:04,973 - Detection -   eval_score = 92.62
2024-10-05 16:07:04,973 - Detection -   train_loss = 1.4681869506835938
2024-10-05 16:07:07,397 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 16:07:07,398 - Detection -   best_eval_score = 92.82
2024-10-05 16:07:07,398 - Detection -   eval_score = 92.62
2024-10-05 16:07:07,398 - Detection -   train_loss = 1.4810537020365397
2024-10-05 16:07:09,903 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 16:07:09,903 - Detection -   best_eval_score = 92.82
2024-10-05 16:07:09,903 - Detection -   eval_score = 92.69
2024-10-05 16:07:09,903 - Detection -   train_loss = 1.4812761267026266
2024-10-05 16:07:12,358 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 16:07:12,358 - Detection -   best_eval_score = 92.82
2024-10-05 16:07:12,358 - Detection -   eval_score = 92.76
2024-10-05 16:07:12,358 - Detection -   train_loss = 1.4795713623364766
2024-10-05 16:07:14,807 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 16:07:14,807 - Detection -   best_eval_score = 92.82
2024-10-05 16:07:14,807 - Detection -   eval_score = 92.76
2024-10-05 16:07:14,807 - Detection -   train_loss = 1.4860715905825297
2024-10-05 16:07:17,250 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 16:07:17,250 - Detection -   best_eval_score = 92.82
2024-10-05 16:07:17,250 - Detection -   eval_score = 92.69
2024-10-05 16:07:17,250 - Detection -   train_loss = 1.465194853146871
2024-10-05 16:07:19,691 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 16:07:19,691 - Detection -   best_eval_score = 92.82
2024-10-05 16:07:19,691 - Detection -   eval_score = 92.76
2024-10-05 16:07:19,691 - Detection -   train_loss = 1.4704572280248007
2024-10-05 16:07:22,132 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 16:07:22,132 - Detection -   best_eval_score = 92.82
2024-10-05 16:07:22,132 - Detection -   eval_score = 92.69
2024-10-05 16:07:22,132 - Detection -   train_loss = 1.473793665568034
2024-10-05 16:07:24,575 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 16:07:24,575 - Detection -   best_eval_score = 92.82
2024-10-05 16:07:24,575 - Detection -   eval_score = 92.69
2024-10-05 16:07:24,575 - Detection -   train_loss = 1.4533804496129354
2024-10-05 16:07:24,575 - Detection - Training Finished...
2024-10-05 16:07:24,575 - Detection - Testing begin...
2024-10-05 16:07:26,781 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 16:07:26,782 - Detection - [[  29    0    0 ...    0    0    1]
 [   0   22    0 ...    0    0    8]
 [   0    0   28 ...    0    0    2]
 ...
 [   0    0    0 ...   27    0    3]
 [   0    0    0 ...    0   25    5]
 [   2    3   35 ...    8    3 4105]]
2024-10-05 16:07:26,782 - Detection - ***** Test results *****
2024-10-05 16:07:26,782 - Detection -   Acc = 90.11
2024-10-05 16:07:26,782 - Detection -   F1 = 80.7629
2024-10-05 16:07:26,782 - Detection -   F1-known = 80.4244
2024-10-05 16:07:26,782 - Detection -   F1-open = 93.6253
2024-10-05 16:07:26,782 - Detection - Testing finished...
2024-10-05 16:07:26,782 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 16:07:26,815 - Detection - ============================== Params ==============================
2024-10-05 16:07:26,816 - Detection - type:	open_intent_detection
2024-10-05 16:07:26,816 - Detection - logger_name:	Detection
2024-10-05 16:07:26,816 - Detection - log_dir:	logs
2024-10-05 16:07:26,816 - Detection - dataset:	oos
2024-10-05 16:07:26,816 - Detection - known_cls_ratio:	0.25
2024-10-05 16:07:26,816 - Detection - labeled_ratio:	1.0
2024-10-05 16:07:26,816 - Detection - method:	ADB
2024-10-05 16:07:26,816 - Detection - train:	True
2024-10-05 16:07:26,816 - Detection - tune:	True
2024-10-05 16:07:26,816 - Detection - pretrain:	True
2024-10-05 16:07:26,816 - Detection - b_train:	False
2024-10-05 16:07:26,816 - Detection - save_model:	False
2024-10-05 16:07:26,816 - Detection - backbone:	bert
2024-10-05 16:07:26,816 - Detection - config_file_name:	ADB
2024-10-05 16:07:26,816 - Detection - seed:	1
2024-10-05 16:07:26,816 - Detection - gpu_id:	0
2024-10-05 16:07:26,816 - Detection - pipe_results_path:	pipe_results
2024-10-05 16:07:26,816 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 16:07:26,816 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 16:07:26,816 - Detection - model_dir:	models
2024-10-05 16:07:26,816 - Detection - load_pretrained_method:	None
2024-10-05 16:07:26,816 - Detection - result_dir:	results
2024-10-05 16:07:26,816 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 16:07:26,816 - Detection - save_results:	True
2024-10-05 16:07:26,816 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 16:07:26,816 - Detection - dataset_neg:	SQUAD
2024-10-05 16:07:26,816 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1
2024-10-05 16:07:26,816 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1/models
2024-10-05 16:07:26,816 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 16:07:26,817 - Detection - num_train_epochs:	100
2024-10-05 16:07:26,817 - Detection - num_labels:	38
2024-10-05 16:07:26,817 - Detection - max_seq_length:	30
2024-10-05 16:07:26,817 - Detection - freeze_backbone_parameters:	True
2024-10-05 16:07:26,817 - Detection - feat_dim:	768
2024-10-05 16:07:26,817 - Detection - warmup_proportion:	0.1
2024-10-05 16:07:26,817 - Detection - lr_boundary:	0.05
2024-10-05 16:07:26,817 - Detection - lr:	2e-05
2024-10-05 16:07:26,817 - Detection - activation:	relu
2024-10-05 16:07:26,817 - Detection - train_batch_size:	128
2024-10-05 16:07:26,817 - Detection - eval_batch_size:	64
2024-10-05 16:07:26,817 - Detection - test_batch_size:	64
2024-10-05 16:07:26,817 - Detection - wait_patient:	10
2024-10-05 16:07:26,817 - Detection - safe1:	0.3
2024-10-05 16:07:26,817 - Detection - safe2:	0.5
2024-10-05 16:07:26,817 - Detection - neg_weight:	0.8
2024-10-05 16:07:26,817 - Detection - margin:	0.8
2024-10-05 16:07:26,817 - Detection - p:	2
2024-10-05 16:07:26,817 - Detection - loss_weight:	1
2024-10-05 16:07:26,817 - Detection - supcon_loss_weight:	0.7
2024-10-05 16:07:26,817 - Detection - triplet_loss_weight:	0.9
2024-10-05 16:07:26,817 - Detection - unseen_label_id:	38
2024-10-05 16:07:26,817 - Detection - anum_labels:	39
2024-10-05 16:07:26,817 - Detection - device:	cuda:0
2024-10-05 16:07:26,817 - Detection - ============================== End Params ==============================
2024-10-05 16:07:27,866 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 16:07:27,913 - Detection - Pre-training Begin...
2024-10-05 16:07:32,437 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 16:07:32,437 - Detection -   best_eval_score = 0
2024-10-05 16:07:32,438 - Detection -   eval_score = 2.63
2024-10-05 16:07:32,438 - Detection -   train_loss = 8.840952650705974
2024-10-05 16:07:37,094 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 16:07:37,094 - Detection -   best_eval_score = 2.63
2024-10-05 16:07:37,094 - Detection -   eval_score = 2.37
2024-10-05 16:07:37,094 - Detection -   train_loss = 8.413834857940675
2024-10-05 16:07:41,680 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 16:07:41,681 - Detection -   best_eval_score = 2.63
2024-10-05 16:07:41,681 - Detection -   eval_score = 5.92
2024-10-05 16:07:41,681 - Detection -   train_loss = 8.04676472345988
2024-10-05 16:07:46,214 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 16:07:46,214 - Detection -   best_eval_score = 5.92
2024-10-05 16:07:46,214 - Detection -   eval_score = 12.24
2024-10-05 16:07:46,214 - Detection -   train_loss = 7.524816433588664
2024-10-05 16:07:50,838 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 16:07:50,838 - Detection -   best_eval_score = 12.24
2024-10-05 16:07:50,838 - Detection -   eval_score = 19.34
2024-10-05 16:07:50,838 - Detection -   train_loss = 7.21731653213501
2024-10-05 16:07:55,569 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 16:07:55,569 - Detection -   best_eval_score = 19.34
2024-10-05 16:07:55,569 - Detection -   eval_score = 29.21
2024-10-05 16:07:55,569 - Detection -   train_loss = 6.971635357538859
2024-10-05 16:08:00,210 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 16:08:00,210 - Detection -   best_eval_score = 29.21
2024-10-05 16:08:00,210 - Detection -   eval_score = 43.68
2024-10-05 16:08:00,210 - Detection -   train_loss = 6.714383459091186
2024-10-05 16:08:04,826 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 16:08:04,826 - Detection -   best_eval_score = 43.68
2024-10-05 16:08:04,826 - Detection -   eval_score = 62.5
2024-10-05 16:08:04,827 - Detection -   train_loss = 6.4482379913330075
2024-10-05 16:08:09,413 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 16:08:09,413 - Detection -   best_eval_score = 62.5
2024-10-05 16:08:09,413 - Detection -   eval_score = 78.82
2024-10-05 16:08:09,413 - Detection -   train_loss = 6.101870743433635
2024-10-05 16:08:13,993 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 16:08:13,993 - Detection -   best_eval_score = 78.82
2024-10-05 16:08:13,993 - Detection -   eval_score = 89.47
2024-10-05 16:08:13,993 - Detection -   train_loss = 5.669815174738566
2024-10-05 16:08:18,555 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 16:08:18,555 - Detection -   best_eval_score = 89.47
2024-10-05 16:08:18,555 - Detection -   eval_score = 93.03
2024-10-05 16:08:18,555 - Detection -   train_loss = 5.1719528039296465
2024-10-05 16:08:23,116 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 16:08:23,116 - Detection -   best_eval_score = 93.03
2024-10-05 16:08:23,116 - Detection -   eval_score = 95.66
2024-10-05 16:08:23,116 - Detection -   train_loss = 4.566092046101888
2024-10-05 16:08:27,763 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 16:08:27,764 - Detection -   best_eval_score = 95.66
2024-10-05 16:08:27,764 - Detection -   eval_score = 96.32
2024-10-05 16:08:27,764 - Detection -   train_loss = 4.017891518274943
2024-10-05 16:08:32,312 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 16:08:32,312 - Detection -   best_eval_score = 96.32
2024-10-05 16:08:32,312 - Detection -   eval_score = 97.11
2024-10-05 16:08:32,312 - Detection -   train_loss = 3.5873610893885295
2024-10-05 16:08:36,916 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 16:08:36,916 - Detection -   best_eval_score = 97.11
2024-10-05 16:08:36,916 - Detection -   eval_score = 97.24
2024-10-05 16:08:36,916 - Detection -   train_loss = 3.2240941762924193
2024-10-05 16:08:41,523 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 16:08:41,524 - Detection -   best_eval_score = 97.24
2024-10-05 16:08:41,524 - Detection -   eval_score = 97.63
2024-10-05 16:08:41,524 - Detection -   train_loss = 2.9790993372599286
2024-10-05 16:08:46,108 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 16:08:46,108 - Detection -   best_eval_score = 97.63
2024-10-05 16:08:46,108 - Detection -   eval_score = 97.76
2024-10-05 16:08:46,109 - Detection -   train_loss = 2.7947305917739866
2024-10-05 16:08:50,742 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 16:08:50,742 - Detection -   best_eval_score = 97.76
2024-10-05 16:08:50,742 - Detection -   eval_score = 97.76
2024-10-05 16:08:50,742 - Detection -   train_loss = 2.6950417280197145
2024-10-05 16:08:55,323 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 16:08:55,324 - Detection -   best_eval_score = 97.76
2024-10-05 16:08:55,324 - Detection -   eval_score = 97.63
2024-10-05 16:08:55,324 - Detection -   train_loss = 2.6019296646118164
2024-10-05 16:08:59,890 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 16:08:59,890 - Detection -   best_eval_score = 97.76
2024-10-05 16:08:59,890 - Detection -   eval_score = 97.76
2024-10-05 16:08:59,890 - Detection -   train_loss = 2.5354123592376707
2024-10-05 16:09:04,457 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 16:09:04,457 - Detection -   best_eval_score = 97.76
2024-10-05 16:09:04,457 - Detection -   eval_score = 98.16
2024-10-05 16:09:04,457 - Detection -   train_loss = 2.46728568871816
2024-10-05 16:09:09,147 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 16:09:09,147 - Detection -   best_eval_score = 98.16
2024-10-05 16:09:09,148 - Detection -   eval_score = 98.03
2024-10-05 16:09:09,148 - Detection -   train_loss = 2.4311756610870363
2024-10-05 16:09:13,719 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 16:09:13,720 - Detection -   best_eval_score = 98.16
2024-10-05 16:09:13,720 - Detection -   eval_score = 98.16
2024-10-05 16:09:13,720 - Detection -   train_loss = 2.4038280884424847
2024-10-05 16:09:18,274 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 16:09:18,274 - Detection -   best_eval_score = 98.16
2024-10-05 16:09:18,274 - Detection -   eval_score = 98.16
2024-10-05 16:09:18,275 - Detection -   train_loss = 2.3619471629460653
2024-10-05 16:09:22,837 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 16:09:22,837 - Detection -   best_eval_score = 98.16
2024-10-05 16:09:22,837 - Detection -   eval_score = 98.29
2024-10-05 16:09:22,837 - Detection -   train_loss = 2.33579793771108
2024-10-05 16:09:27,436 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 16:09:27,437 - Detection -   best_eval_score = 98.29
2024-10-05 16:09:27,437 - Detection -   eval_score = 98.16
2024-10-05 16:09:27,437 - Detection -   train_loss = 2.318979581197103
2024-10-05 16:09:32,022 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 16:09:32,022 - Detection -   best_eval_score = 98.29
2024-10-05 16:09:32,022 - Detection -   eval_score = 98.16
2024-10-05 16:09:32,022 - Detection -   train_loss = 2.3101202567418415
2024-10-05 16:09:36,580 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 16:09:36,580 - Detection -   best_eval_score = 98.29
2024-10-05 16:09:36,580 - Detection -   eval_score = 98.16
2024-10-05 16:09:36,580 - Detection -   train_loss = 2.2800166249275207
2024-10-05 16:09:41,242 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 16:09:41,242 - Detection -   best_eval_score = 98.29
2024-10-05 16:09:41,242 - Detection -   eval_score = 98.29
2024-10-05 16:09:41,242 - Detection -   train_loss = 2.265408253669739
2024-10-05 16:09:45,863 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 16:09:45,863 - Detection -   best_eval_score = 98.29
2024-10-05 16:09:45,863 - Detection -   eval_score = 98.29
2024-10-05 16:09:45,863 - Detection -   train_loss = 2.2664974093437196
2024-10-05 16:09:50,441 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 16:09:50,441 - Detection -   best_eval_score = 98.29
2024-10-05 16:09:50,441 - Detection -   eval_score = 98.42
2024-10-05 16:09:50,441 - Detection -   train_loss = 2.2559389591217043
2024-10-05 16:09:55,043 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 16:09:55,043 - Detection -   best_eval_score = 98.42
2024-10-05 16:09:55,043 - Detection -   eval_score = 98.29
2024-10-05 16:09:55,043 - Detection -   train_loss = 2.2376607497533163
2024-10-05 16:09:59,686 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 16:09:59,687 - Detection -   best_eval_score = 98.42
2024-10-05 16:09:59,687 - Detection -   eval_score = 98.42
2024-10-05 16:09:59,687 - Detection -   train_loss = 2.230059504508972
2024-10-05 16:10:04,307 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 16:10:04,307 - Detection -   best_eval_score = 98.42
2024-10-05 16:10:04,307 - Detection -   eval_score = 98.16
2024-10-05 16:10:04,307 - Detection -   train_loss = 2.2156099557876585
2024-10-05 16:10:08,940 - Detection - ***** Epoch: 35: Eval results *****
2024-10-05 16:10:08,940 - Detection -   best_eval_score = 98.42
2024-10-05 16:10:08,940 - Detection -   eval_score = 98.16
2024-10-05 16:10:08,940 - Detection -   train_loss = 2.2101656516393025
2024-10-05 16:10:13,514 - Detection - ***** Epoch: 36: Eval results *****
2024-10-05 16:10:13,515 - Detection -   best_eval_score = 98.42
2024-10-05 16:10:13,515 - Detection -   eval_score = 98.16
2024-10-05 16:10:13,515 - Detection -   train_loss = 2.1993439555168153
2024-10-05 16:10:18,156 - Detection - ***** Epoch: 37: Eval results *****
2024-10-05 16:10:18,156 - Detection -   best_eval_score = 98.42
2024-10-05 16:10:18,156 - Detection -   eval_score = 98.42
2024-10-05 16:10:18,156 - Detection -   train_loss = 2.196841474374135
2024-10-05 16:10:22,772 - Detection - ***** Epoch: 38: Eval results *****
2024-10-05 16:10:22,772 - Detection -   best_eval_score = 98.42
2024-10-05 16:10:22,773 - Detection -   eval_score = 98.42
2024-10-05 16:10:22,773 - Detection -   train_loss = 2.1862257440884907
2024-10-05 16:10:27,445 - Detection - ***** Epoch: 39: Eval results *****
2024-10-05 16:10:27,445 - Detection -   best_eval_score = 98.42
2024-10-05 16:10:27,445 - Detection -   eval_score = 98.42
2024-10-05 16:10:27,445 - Detection -   train_loss = 2.188224736849467
2024-10-05 16:10:32,122 - Detection - ***** Epoch: 40: Eval results *****
2024-10-05 16:10:32,122 - Detection -   best_eval_score = 98.42
2024-10-05 16:10:32,122 - Detection -   eval_score = 98.29
2024-10-05 16:10:32,122 - Detection -   train_loss = 2.1765384395917255
2024-10-05 16:10:36,855 - Detection - ***** Epoch: 41: Eval results *****
2024-10-05 16:10:36,855 - Detection -   best_eval_score = 98.42
2024-10-05 16:10:36,855 - Detection -   eval_score = 98.16
2024-10-05 16:10:36,856 - Detection -   train_loss = 2.167403817176819
2024-10-05 16:10:36,857 - Detection - Pre-training finished...
2024-10-05 16:10:36,857 - Detection - Training Begin...
2024-10-05 16:10:42,284 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 16:10:42,284 - Detection -   best_eval_score = 0
2024-10-05 16:10:42,284 - Detection -   eval_score = 0.24
2024-10-05 16:10:42,284 - Detection -   train_loss = 12.574205271402995
2024-10-05 16:10:44,716 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 16:10:44,716 - Detection -   best_eval_score = 0.24
2024-10-05 16:10:44,717 - Detection -   eval_score = 19.91
2024-10-05 16:10:44,717 - Detection -   train_loss = 10.653275394439698
2024-10-05 16:10:47,149 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 16:10:47,149 - Detection -   best_eval_score = 19.91
2024-10-05 16:10:47,150 - Detection -   eval_score = 61.62
2024-10-05 16:10:47,150 - Detection -   train_loss = 8.106857697168985
2024-10-05 16:10:49,577 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 16:10:49,577 - Detection -   best_eval_score = 61.62
2024-10-05 16:10:49,577 - Detection -   eval_score = 83.49
2024-10-05 16:10:49,578 - Detection -   train_loss = 5.370379972457886
2024-10-05 16:10:51,998 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 16:10:51,998 - Detection -   best_eval_score = 83.49
2024-10-05 16:10:51,999 - Detection -   eval_score = 90.19
2024-10-05 16:10:51,999 - Detection -   train_loss = 3.1284455060958862
2024-10-05 16:10:54,436 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 16:10:54,436 - Detection -   best_eval_score = 90.19
2024-10-05 16:10:54,436 - Detection -   eval_score = 92.56
2024-10-05 16:10:54,437 - Detection -   train_loss = 1.9837144136428833
2024-10-05 16:10:56,861 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 16:10:56,861 - Detection -   best_eval_score = 92.56
2024-10-05 16:10:56,861 - Detection -   eval_score = 92.69
2024-10-05 16:10:56,861 - Detection -   train_loss = 1.7820852041244506
2024-10-05 16:10:59,365 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 16:10:59,366 - Detection -   best_eval_score = 92.69
2024-10-05 16:10:59,366 - Detection -   eval_score = 92.9
2024-10-05 16:10:59,366 - Detection -   train_loss = 1.7647340536117553
2024-10-05 16:11:01,804 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 16:11:01,804 - Detection -   best_eval_score = 92.9
2024-10-05 16:11:01,804 - Detection -   eval_score = 92.91
2024-10-05 16:11:01,804 - Detection -   train_loss = 1.7512022336324056
2024-10-05 16:11:04,241 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 16:11:04,241 - Detection -   best_eval_score = 92.91
2024-10-05 16:11:04,241 - Detection -   eval_score = 92.99
2024-10-05 16:11:04,241 - Detection -   train_loss = 1.7512187520662943
2024-10-05 16:11:06,680 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 16:11:06,681 - Detection -   best_eval_score = 92.99
2024-10-05 16:11:06,681 - Detection -   eval_score = 93.0
2024-10-05 16:11:06,681 - Detection -   train_loss = 1.732261069615682
2024-10-05 16:11:09,120 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 16:11:09,121 - Detection -   best_eval_score = 93.0
2024-10-05 16:11:09,121 - Detection -   eval_score = 93.0
2024-10-05 16:11:09,121 - Detection -   train_loss = 1.7540729920069376
2024-10-05 16:11:11,547 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 16:11:11,547 - Detection -   best_eval_score = 93.0
2024-10-05 16:11:11,547 - Detection -   eval_score = 93.0
2024-10-05 16:11:11,547 - Detection -   train_loss = 1.7359017928441365
2024-10-05 16:11:13,973 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 16:11:13,973 - Detection -   best_eval_score = 93.0
2024-10-05 16:11:13,973 - Detection -   eval_score = 93.06
2024-10-05 16:11:13,973 - Detection -   train_loss = 1.7497641960779826
2024-10-05 16:11:16,393 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 16:11:16,394 - Detection -   best_eval_score = 93.06
2024-10-05 16:11:16,394 - Detection -   eval_score = 93.06
2024-10-05 16:11:16,394 - Detection -   train_loss = 1.7563164710998536
2024-10-05 16:11:18,811 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 16:11:18,811 - Detection -   best_eval_score = 93.06
2024-10-05 16:11:18,812 - Detection -   eval_score = 93.0
2024-10-05 16:11:18,812 - Detection -   train_loss = 1.7550510048866272
2024-10-05 16:11:21,237 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 16:11:21,238 - Detection -   best_eval_score = 93.06
2024-10-05 16:11:21,238 - Detection -   eval_score = 93.06
2024-10-05 16:11:21,238 - Detection -   train_loss = 1.7419668753941855
2024-10-05 16:11:23,661 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 16:11:23,661 - Detection -   best_eval_score = 93.06
2024-10-05 16:11:23,661 - Detection -   eval_score = 93.06
2024-10-05 16:11:23,661 - Detection -   train_loss = 1.7479597091674806
2024-10-05 16:11:26,083 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 16:11:26,083 - Detection -   best_eval_score = 93.06
2024-10-05 16:11:26,083 - Detection -   eval_score = 93.0
2024-10-05 16:11:26,083 - Detection -   train_loss = 1.743904137611389
2024-10-05 16:11:28,516 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 16:11:28,516 - Detection -   best_eval_score = 93.06
2024-10-05 16:11:28,516 - Detection -   eval_score = 93.09
2024-10-05 16:11:28,516 - Detection -   train_loss = 1.7403746088345846
2024-10-05 16:11:30,962 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 16:11:30,963 - Detection -   best_eval_score = 93.09
2024-10-05 16:11:30,963 - Detection -   eval_score = 93.09
2024-10-05 16:11:30,963 - Detection -   train_loss = 1.7602123896280923
2024-10-05 16:11:33,403 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 16:11:33,403 - Detection -   best_eval_score = 93.09
2024-10-05 16:11:33,403 - Detection -   eval_score = 93.09
2024-10-05 16:11:33,403 - Detection -   train_loss = 1.759798006216685
2024-10-05 16:11:35,835 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 16:11:35,835 - Detection -   best_eval_score = 93.09
2024-10-05 16:11:35,835 - Detection -   eval_score = 93.16
2024-10-05 16:11:35,835 - Detection -   train_loss = 1.7572137316068013
2024-10-05 16:11:38,265 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 16:11:38,265 - Detection -   best_eval_score = 93.16
2024-10-05 16:11:38,265 - Detection -   eval_score = 93.09
2024-10-05 16:11:38,265 - Detection -   train_loss = 1.7698468764623005
2024-10-05 16:11:40,686 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 16:11:40,686 - Detection -   best_eval_score = 93.16
2024-10-05 16:11:40,686 - Detection -   eval_score = 93.09
2024-10-05 16:11:40,686 - Detection -   train_loss = 1.7457114179929099
2024-10-05 16:11:43,112 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 16:11:43,112 - Detection -   best_eval_score = 93.16
2024-10-05 16:11:43,112 - Detection -   eval_score = 93.16
2024-10-05 16:11:43,112 - Detection -   train_loss = 1.7553919951121013
2024-10-05 16:11:45,544 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 16:11:45,544 - Detection -   best_eval_score = 93.16
2024-10-05 16:11:45,544 - Detection -   eval_score = 93.09
2024-10-05 16:11:45,545 - Detection -   train_loss = 1.7480764508247375
2024-10-05 16:11:48,127 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 16:11:48,127 - Detection -   best_eval_score = 93.16
2024-10-05 16:11:48,127 - Detection -   eval_score = 93.0
2024-10-05 16:11:48,127 - Detection -   train_loss = 1.7358547131220499
2024-10-05 16:11:50,645 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 16:11:50,645 - Detection -   best_eval_score = 93.16
2024-10-05 16:11:50,645 - Detection -   eval_score = 93.16
2024-10-05 16:11:50,645 - Detection -   train_loss = 1.7410537203152974
2024-10-05 16:11:53,105 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 16:11:53,105 - Detection -   best_eval_score = 93.16
2024-10-05 16:11:53,105 - Detection -   eval_score = 93.09
2024-10-05 16:11:53,105 - Detection -   train_loss = 1.7511173605918884
2024-10-05 16:11:55,539 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 16:11:55,540 - Detection -   best_eval_score = 93.16
2024-10-05 16:11:55,540 - Detection -   eval_score = 93.16
2024-10-05 16:11:55,540 - Detection -   train_loss = 1.7612700978914897
2024-10-05 16:11:57,975 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 16:11:57,975 - Detection -   best_eval_score = 93.16
2024-10-05 16:11:57,975 - Detection -   eval_score = 93.06
2024-10-05 16:11:57,975 - Detection -   train_loss = 1.742758862177531
2024-10-05 16:12:00,424 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 16:12:00,425 - Detection -   best_eval_score = 93.16
2024-10-05 16:12:00,425 - Detection -   eval_score = 93.06
2024-10-05 16:12:00,425 - Detection -   train_loss = 1.7435507734616598
2024-10-05 16:12:00,425 - Detection - Training Finished...
2024-10-05 16:12:00,425 - Detection - Testing begin...
2024-10-05 16:12:02,630 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 16:12:02,630 - Detection - [[  29    0    0 ...    0    0    1]
 [   0   22    0 ...    0    0    8]
 [   0    0   28 ...    0    0    2]
 ...
 [   0    0    0 ...   27    0    3]
 [   0    0    0 ...    0   25    5]
 [   2    3   45 ...    8    3 4059]]
2024-10-05 16:12:02,630 - Detection - ***** Test results *****
2024-10-05 16:12:02,630 - Detection -   Acc = 89.37
2024-10-05 16:12:02,630 - Detection -   F1 = 80.2805
2024-10-05 16:12:02,630 - Detection -   F1-known = 79.943
2024-10-05 16:12:02,630 - Detection -   F1-open = 93.107
2024-10-05 16:12:02,630 - Detection - Testing finished...
2024-10-05 16:12:02,630 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 16:12:02,664 - Detection - ============================== Params ==============================
2024-10-05 16:12:02,664 - Detection - type:	open_intent_detection
2024-10-05 16:12:02,664 - Detection - logger_name:	Detection
2024-10-05 16:12:02,664 - Detection - log_dir:	logs
2024-10-05 16:12:02,664 - Detection - dataset:	oos
2024-10-05 16:12:02,664 - Detection - known_cls_ratio:	0.25
2024-10-05 16:12:02,664 - Detection - labeled_ratio:	1.0
2024-10-05 16:12:02,664 - Detection - method:	ADB
2024-10-05 16:12:02,664 - Detection - train:	True
2024-10-05 16:12:02,664 - Detection - tune:	True
2024-10-05 16:12:02,664 - Detection - pretrain:	True
2024-10-05 16:12:02,664 - Detection - b_train:	False
2024-10-05 16:12:02,664 - Detection - save_model:	False
2024-10-05 16:12:02,664 - Detection - backbone:	bert
2024-10-05 16:12:02,664 - Detection - config_file_name:	ADB
2024-10-05 16:12:02,664 - Detection - seed:	1
2024-10-05 16:12:02,664 - Detection - gpu_id:	0
2024-10-05 16:12:02,664 - Detection - pipe_results_path:	pipe_results
2024-10-05 16:12:02,664 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 16:12:02,664 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 16:12:02,664 - Detection - model_dir:	models
2024-10-05 16:12:02,664 - Detection - load_pretrained_method:	None
2024-10-05 16:12:02,664 - Detection - result_dir:	results
2024-10-05 16:12:02,665 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 16:12:02,665 - Detection - save_results:	True
2024-10-05 16:12:02,665 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 16:12:02,665 - Detection - dataset_neg:	SQUAD
2024-10-05 16:12:02,665 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1
2024-10-05 16:12:02,665 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1/models
2024-10-05 16:12:02,665 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 16:12:02,665 - Detection - num_train_epochs:	100
2024-10-05 16:12:02,665 - Detection - num_labels:	38
2024-10-05 16:12:02,665 - Detection - max_seq_length:	30
2024-10-05 16:12:02,665 - Detection - freeze_backbone_parameters:	True
2024-10-05 16:12:02,665 - Detection - feat_dim:	768
2024-10-05 16:12:02,665 - Detection - warmup_proportion:	0.1
2024-10-05 16:12:02,665 - Detection - lr_boundary:	0.05
2024-10-05 16:12:02,665 - Detection - lr:	2e-05
2024-10-05 16:12:02,665 - Detection - activation:	relu
2024-10-05 16:12:02,665 - Detection - train_batch_size:	128
2024-10-05 16:12:02,665 - Detection - eval_batch_size:	64
2024-10-05 16:12:02,665 - Detection - test_batch_size:	64
2024-10-05 16:12:02,665 - Detection - wait_patient:	10
2024-10-05 16:12:02,665 - Detection - safe1:	0.4
2024-10-05 16:12:02,665 - Detection - safe2:	0.3
2024-10-05 16:12:02,665 - Detection - neg_weight:	0.3
2024-10-05 16:12:02,665 - Detection - margin:	0.8
2024-10-05 16:12:02,665 - Detection - p:	2
2024-10-05 16:12:02,665 - Detection - loss_weight:	1
2024-10-05 16:12:02,665 - Detection - supcon_loss_weight:	0.7
2024-10-05 16:12:02,665 - Detection - triplet_loss_weight:	0.9
2024-10-05 16:12:02,665 - Detection - unseen_label_id:	38
2024-10-05 16:12:02,665 - Detection - anum_labels:	39
2024-10-05 16:12:02,665 - Detection - device:	cuda:0
2024-10-05 16:12:02,665 - Detection - ============================== End Params ==============================
2024-10-05 16:12:03,764 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 16:12:03,810 - Detection - Pre-training Begin...
2024-10-05 16:12:08,404 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 16:12:08,404 - Detection -   best_eval_score = 0
2024-10-05 16:12:08,405 - Detection -   eval_score = 2.63
2024-10-05 16:12:08,405 - Detection -   train_loss = 8.840952650705974
2024-10-05 16:12:12,946 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 16:12:12,947 - Detection -   best_eval_score = 2.63
2024-10-05 16:12:12,947 - Detection -   eval_score = 2.37
2024-10-05 16:12:12,947 - Detection -   train_loss = 8.413834857940675
2024-10-05 16:12:17,466 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 16:12:17,466 - Detection -   best_eval_score = 2.63
2024-10-05 16:12:17,466 - Detection -   eval_score = 5.92
2024-10-05 16:12:17,466 - Detection -   train_loss = 8.04676472345988
2024-10-05 16:12:22,000 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 16:12:22,000 - Detection -   best_eval_score = 5.92
2024-10-05 16:12:22,000 - Detection -   eval_score = 12.24
2024-10-05 16:12:22,000 - Detection -   train_loss = 7.524816433588664
2024-10-05 16:12:26,526 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 16:12:26,526 - Detection -   best_eval_score = 12.24
2024-10-05 16:12:26,526 - Detection -   eval_score = 19.34
2024-10-05 16:12:26,526 - Detection -   train_loss = 7.21731653213501
2024-10-05 16:12:31,109 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 16:12:31,109 - Detection -   best_eval_score = 19.34
2024-10-05 16:12:31,110 - Detection -   eval_score = 29.21
2024-10-05 16:12:31,110 - Detection -   train_loss = 6.971635357538859
2024-10-05 16:12:35,637 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 16:12:35,637 - Detection -   best_eval_score = 29.21
2024-10-05 16:12:35,637 - Detection -   eval_score = 43.68
2024-10-05 16:12:35,638 - Detection -   train_loss = 6.714383459091186
2024-10-05 16:12:40,217 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 16:12:40,217 - Detection -   best_eval_score = 43.68
2024-10-05 16:12:40,217 - Detection -   eval_score = 62.5
2024-10-05 16:12:40,217 - Detection -   train_loss = 6.4482379913330075
2024-10-05 16:12:44,742 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 16:12:44,742 - Detection -   best_eval_score = 62.5
2024-10-05 16:12:44,742 - Detection -   eval_score = 78.82
2024-10-05 16:12:44,743 - Detection -   train_loss = 6.101870743433635
2024-10-05 16:12:49,265 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 16:12:49,265 - Detection -   best_eval_score = 78.82
2024-10-05 16:12:49,265 - Detection -   eval_score = 89.47
2024-10-05 16:12:49,265 - Detection -   train_loss = 5.669815174738566
2024-10-05 16:12:53,835 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 16:12:53,835 - Detection -   best_eval_score = 89.47
2024-10-05 16:12:53,835 - Detection -   eval_score = 93.03
2024-10-05 16:12:53,835 - Detection -   train_loss = 5.1719528039296465
2024-10-05 16:12:58,371 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 16:12:58,371 - Detection -   best_eval_score = 93.03
2024-10-05 16:12:58,371 - Detection -   eval_score = 95.66
2024-10-05 16:12:58,372 - Detection -   train_loss = 4.566092046101888
2024-10-05 16:13:02,892 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 16:13:02,892 - Detection -   best_eval_score = 95.66
2024-10-05 16:13:02,892 - Detection -   eval_score = 96.32
2024-10-05 16:13:02,892 - Detection -   train_loss = 4.017891518274943
2024-10-05 16:13:07,413 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 16:13:07,413 - Detection -   best_eval_score = 96.32
2024-10-05 16:13:07,413 - Detection -   eval_score = 97.11
2024-10-05 16:13:07,413 - Detection -   train_loss = 3.5873610893885295
2024-10-05 16:13:11,976 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 16:13:11,977 - Detection -   best_eval_score = 97.11
2024-10-05 16:13:11,977 - Detection -   eval_score = 97.24
2024-10-05 16:13:11,977 - Detection -   train_loss = 3.2240941762924193
2024-10-05 16:13:16,465 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 16:13:16,465 - Detection -   best_eval_score = 97.24
2024-10-05 16:13:16,465 - Detection -   eval_score = 97.63
2024-10-05 16:13:16,465 - Detection -   train_loss = 2.9790993372599286
2024-10-05 16:13:20,976 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 16:13:20,976 - Detection -   best_eval_score = 97.63
2024-10-05 16:13:20,976 - Detection -   eval_score = 97.76
2024-10-05 16:13:20,976 - Detection -   train_loss = 2.7947305917739866
2024-10-05 16:13:25,477 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 16:13:25,477 - Detection -   best_eval_score = 97.76
2024-10-05 16:13:25,478 - Detection -   eval_score = 97.76
2024-10-05 16:13:25,478 - Detection -   train_loss = 2.6950417280197145
2024-10-05 16:13:29,958 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 16:13:29,958 - Detection -   best_eval_score = 97.76
2024-10-05 16:13:29,958 - Detection -   eval_score = 97.63
2024-10-05 16:13:29,958 - Detection -   train_loss = 2.6019296646118164
2024-10-05 16:13:34,423 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 16:13:34,424 - Detection -   best_eval_score = 97.76
2024-10-05 16:13:34,424 - Detection -   eval_score = 97.76
2024-10-05 16:13:34,424 - Detection -   train_loss = 2.5354123592376707
2024-10-05 16:13:38,906 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 16:13:38,906 - Detection -   best_eval_score = 97.76
2024-10-05 16:13:38,907 - Detection -   eval_score = 98.16
2024-10-05 16:13:38,907 - Detection -   train_loss = 2.46728568871816
2024-10-05 16:13:43,416 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 16:13:43,416 - Detection -   best_eval_score = 98.16
2024-10-05 16:13:43,416 - Detection -   eval_score = 98.03
2024-10-05 16:13:43,417 - Detection -   train_loss = 2.4311756610870363
2024-10-05 16:13:47,917 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 16:13:47,917 - Detection -   best_eval_score = 98.16
2024-10-05 16:13:47,917 - Detection -   eval_score = 98.16
2024-10-05 16:13:47,917 - Detection -   train_loss = 2.4038280884424847
2024-10-05 16:13:52,405 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 16:13:52,405 - Detection -   best_eval_score = 98.16
2024-10-05 16:13:52,406 - Detection -   eval_score = 98.16
2024-10-05 16:13:52,406 - Detection -   train_loss = 2.3619471629460653
2024-10-05 16:13:56,943 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 16:13:56,943 - Detection -   best_eval_score = 98.16
2024-10-05 16:13:56,943 - Detection -   eval_score = 98.29
2024-10-05 16:13:56,943 - Detection -   train_loss = 2.33579793771108
2024-10-05 16:14:01,437 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 16:14:01,437 - Detection -   best_eval_score = 98.29
2024-10-05 16:14:01,437 - Detection -   eval_score = 98.16
2024-10-05 16:14:01,437 - Detection -   train_loss = 2.318979581197103
2024-10-05 16:14:05,908 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 16:14:05,908 - Detection -   best_eval_score = 98.29
2024-10-05 16:14:05,908 - Detection -   eval_score = 98.16
2024-10-05 16:14:05,908 - Detection -   train_loss = 2.3101202567418415
2024-10-05 16:14:10,399 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 16:14:10,399 - Detection -   best_eval_score = 98.29
2024-10-05 16:14:10,399 - Detection -   eval_score = 98.16
2024-10-05 16:14:10,399 - Detection -   train_loss = 2.2800166249275207
2024-10-05 16:14:14,884 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 16:14:14,884 - Detection -   best_eval_score = 98.29
2024-10-05 16:14:14,884 - Detection -   eval_score = 98.29
2024-10-05 16:14:14,884 - Detection -   train_loss = 2.265408253669739
2024-10-05 16:14:19,368 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 16:14:19,368 - Detection -   best_eval_score = 98.29
2024-10-05 16:14:19,368 - Detection -   eval_score = 98.29
2024-10-05 16:14:19,368 - Detection -   train_loss = 2.2664974093437196
2024-10-05 16:14:23,873 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 16:14:23,873 - Detection -   best_eval_score = 98.29
2024-10-05 16:14:23,873 - Detection -   eval_score = 98.42
2024-10-05 16:14:23,873 - Detection -   train_loss = 2.2559389591217043
2024-10-05 16:14:28,374 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 16:14:28,374 - Detection -   best_eval_score = 98.42
2024-10-05 16:14:28,374 - Detection -   eval_score = 98.29
2024-10-05 16:14:28,374 - Detection -   train_loss = 2.2376607497533163
2024-10-05 16:14:32,874 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 16:14:32,874 - Detection -   best_eval_score = 98.42
2024-10-05 16:14:32,874 - Detection -   eval_score = 98.42
2024-10-05 16:14:32,874 - Detection -   train_loss = 2.230059504508972
2024-10-05 16:14:37,363 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 16:14:37,363 - Detection -   best_eval_score = 98.42
2024-10-05 16:14:37,363 - Detection -   eval_score = 98.16
2024-10-05 16:14:37,363 - Detection -   train_loss = 2.2156099557876585
2024-10-05 16:14:41,859 - Detection - ***** Epoch: 35: Eval results *****
2024-10-05 16:14:41,859 - Detection -   best_eval_score = 98.42
2024-10-05 16:14:41,859 - Detection -   eval_score = 98.16
2024-10-05 16:14:41,859 - Detection -   train_loss = 2.2101656516393025
2024-10-05 16:14:46,389 - Detection - ***** Epoch: 36: Eval results *****
2024-10-05 16:14:46,389 - Detection -   best_eval_score = 98.42
2024-10-05 16:14:46,389 - Detection -   eval_score = 98.16
2024-10-05 16:14:46,389 - Detection -   train_loss = 2.1993439555168153
2024-10-05 16:14:50,999 - Detection - ***** Epoch: 37: Eval results *****
2024-10-05 16:14:50,999 - Detection -   best_eval_score = 98.42
2024-10-05 16:14:50,999 - Detection -   eval_score = 98.42
2024-10-05 16:14:50,999 - Detection -   train_loss = 2.196841474374135
2024-10-05 16:14:55,574 - Detection - ***** Epoch: 38: Eval results *****
2024-10-05 16:14:55,574 - Detection -   best_eval_score = 98.42
2024-10-05 16:14:55,574 - Detection -   eval_score = 98.42
2024-10-05 16:14:55,574 - Detection -   train_loss = 2.1862257440884907
2024-10-05 16:15:00,255 - Detection - ***** Epoch: 39: Eval results *****
2024-10-05 16:15:00,256 - Detection -   best_eval_score = 98.42
2024-10-05 16:15:00,256 - Detection -   eval_score = 98.42
2024-10-05 16:15:00,256 - Detection -   train_loss = 2.188224736849467
2024-10-05 16:15:04,954 - Detection - ***** Epoch: 40: Eval results *****
2024-10-05 16:15:04,954 - Detection -   best_eval_score = 98.42
2024-10-05 16:15:04,954 - Detection -   eval_score = 98.29
2024-10-05 16:15:04,954 - Detection -   train_loss = 2.1765384395917255
2024-10-05 16:15:09,568 - Detection - ***** Epoch: 41: Eval results *****
2024-10-05 16:15:09,568 - Detection -   best_eval_score = 98.42
2024-10-05 16:15:09,568 - Detection -   eval_score = 98.16
2024-10-05 16:15:09,568 - Detection -   train_loss = 2.167403817176819
2024-10-05 16:15:09,569 - Detection - Pre-training finished...
2024-10-05 16:15:09,569 - Detection - Training Begin...
2024-10-05 16:15:14,983 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 16:15:14,983 - Detection -   best_eval_score = 0
2024-10-05 16:15:14,983 - Detection -   eval_score = 0.24
2024-10-05 16:15:14,983 - Detection -   train_loss = 9.056920019785563
2024-10-05 16:15:17,419 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 16:15:17,419 - Detection -   best_eval_score = 0.24
2024-10-05 16:15:17,419 - Detection -   eval_score = 19.91
2024-10-05 16:15:17,419 - Detection -   train_loss = 7.655513842900594
2024-10-05 16:15:19,850 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 16:15:19,850 - Detection -   best_eval_score = 19.91
2024-10-05 16:15:19,850 - Detection -   eval_score = 61.62
2024-10-05 16:15:19,850 - Detection -   train_loss = 5.828726307551066
2024-10-05 16:15:22,295 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 16:15:22,295 - Detection -   best_eval_score = 61.62
2024-10-05 16:15:22,295 - Detection -   eval_score = 83.49
2024-10-05 16:15:22,295 - Detection -   train_loss = 3.824426778157552
2024-10-05 16:15:24,744 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 16:15:24,744 - Detection -   best_eval_score = 83.49
2024-10-05 16:15:24,744 - Detection -   eval_score = 90.19
2024-10-05 16:15:24,744 - Detection -   train_loss = 2.1813839276631675
2024-10-05 16:15:27,179 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 16:15:27,179 - Detection -   best_eval_score = 90.19
2024-10-05 16:15:27,179 - Detection -   eval_score = 92.4
2024-10-05 16:15:27,179 - Detection -   train_loss = 1.3946125427881877
2024-10-05 16:15:29,628 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 16:15:29,629 - Detection -   best_eval_score = 92.4
2024-10-05 16:15:29,629 - Detection -   eval_score = 92.56
2024-10-05 16:15:29,629 - Detection -   train_loss = 1.3017177303632101
2024-10-05 16:15:32,072 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 16:15:32,072 - Detection -   best_eval_score = 92.56
2024-10-05 16:15:32,072 - Detection -   eval_score = 92.56
2024-10-05 16:15:32,072 - Detection -   train_loss = 1.3081996043523152
2024-10-05 16:15:34,529 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 16:15:34,529 - Detection -   best_eval_score = 92.56
2024-10-05 16:15:34,529 - Detection -   eval_score = 92.56
2024-10-05 16:15:34,529 - Detection -   train_loss = 1.2986344536145529
2024-10-05 16:15:36,950 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 16:15:36,950 - Detection -   best_eval_score = 92.56
2024-10-05 16:15:36,950 - Detection -   eval_score = 92.56
2024-10-05 16:15:36,950 - Detection -   train_loss = 1.2971371014912922
2024-10-05 16:15:39,374 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 16:15:39,374 - Detection -   best_eval_score = 92.56
2024-10-05 16:15:39,374 - Detection -   eval_score = 92.56
2024-10-05 16:15:39,374 - Detection -   train_loss = 1.2939443190892537
2024-10-05 16:15:41,805 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 16:15:41,805 - Detection -   best_eval_score = 92.56
2024-10-05 16:15:41,805 - Detection -   eval_score = 92.56
2024-10-05 16:15:41,805 - Detection -   train_loss = 1.3027277708053588
2024-10-05 16:15:44,243 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 16:15:44,243 - Detection -   best_eval_score = 92.56
2024-10-05 16:15:44,243 - Detection -   eval_score = 92.56
2024-10-05 16:15:44,243 - Detection -   train_loss = 1.2997602502504984
2024-10-05 16:15:46,708 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 16:15:46,708 - Detection -   best_eval_score = 92.56
2024-10-05 16:15:46,708 - Detection -   eval_score = 92.56
2024-10-05 16:15:46,708 - Detection -   train_loss = 1.2992456277211508
2024-10-05 16:15:49,216 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 16:15:49,216 - Detection -   best_eval_score = 92.56
2024-10-05 16:15:49,216 - Detection -   eval_score = 92.56
2024-10-05 16:15:49,216 - Detection -   train_loss = 1.3064480940500895
2024-10-05 16:15:51,667 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 16:15:51,667 - Detection -   best_eval_score = 92.56
2024-10-05 16:15:51,667 - Detection -   eval_score = 92.41
2024-10-05 16:15:51,667 - Detection -   train_loss = 1.3082876125971477
2024-10-05 16:15:54,121 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 16:15:54,122 - Detection -   best_eval_score = 92.56
2024-10-05 16:15:54,122 - Detection -   eval_score = 92.49
2024-10-05 16:15:54,122 - Detection -   train_loss = 1.2932030439376831
2024-10-05 16:15:54,122 - Detection - Training Finished...
2024-10-05 16:15:54,122 - Detection - Testing begin...
2024-10-05 16:15:56,322 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 16:15:56,322 - Detection - [[  29    0    0 ...    0    0    1]
 [   0   22    0 ...    0    0    8]
 [   0    0   27 ...    0    0    3]
 ...
 [   0    0    0 ...   27    0    3]
 [   0    0    0 ...    0   25    5]
 [   2    3   27 ...    8    3 4143]]
2024-10-05 16:15:56,322 - Detection - ***** Test results *****
2024-10-05 16:15:56,322 - Detection -   Acc = 90.6
2024-10-05 16:15:56,322 - Detection -   F1 = 81.1981
2024-10-05 16:15:56,322 - Detection -   F1-known = 80.8621
2024-10-05 16:15:56,322 - Detection -   F1-open = 93.9669
2024-10-05 16:15:56,322 - Detection - Testing finished...
2024-10-05 16:15:56,322 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 16:15:56,356 - Detection - ============================== Params ==============================
2024-10-05 16:15:56,356 - Detection - type:	open_intent_detection
2024-10-05 16:15:56,356 - Detection - logger_name:	Detection
2024-10-05 16:15:56,356 - Detection - log_dir:	logs
2024-10-05 16:15:56,356 - Detection - dataset:	oos
2024-10-05 16:15:56,356 - Detection - known_cls_ratio:	0.25
2024-10-05 16:15:56,356 - Detection - labeled_ratio:	1.0
2024-10-05 16:15:56,356 - Detection - method:	ADB
2024-10-05 16:15:56,356 - Detection - train:	True
2024-10-05 16:15:56,356 - Detection - tune:	True
2024-10-05 16:15:56,356 - Detection - pretrain:	True
2024-10-05 16:15:56,356 - Detection - b_train:	False
2024-10-05 16:15:56,356 - Detection - save_model:	False
2024-10-05 16:15:56,356 - Detection - backbone:	bert
2024-10-05 16:15:56,356 - Detection - config_file_name:	ADB
2024-10-05 16:15:56,356 - Detection - seed:	1
2024-10-05 16:15:56,356 - Detection - gpu_id:	0
2024-10-05 16:15:56,356 - Detection - pipe_results_path:	pipe_results
2024-10-05 16:15:56,356 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 16:15:56,356 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 16:15:56,356 - Detection - model_dir:	models
2024-10-05 16:15:56,356 - Detection - load_pretrained_method:	None
2024-10-05 16:15:56,356 - Detection - result_dir:	results
2024-10-05 16:15:56,356 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 16:15:56,356 - Detection - save_results:	True
2024-10-05 16:15:56,356 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 16:15:56,356 - Detection - dataset_neg:	SQUAD
2024-10-05 16:15:56,356 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1
2024-10-05 16:15:56,356 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1/models
2024-10-05 16:15:56,356 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 16:15:56,356 - Detection - num_train_epochs:	100
2024-10-05 16:15:56,356 - Detection - num_labels:	38
2024-10-05 16:15:56,356 - Detection - max_seq_length:	30
2024-10-05 16:15:56,356 - Detection - freeze_backbone_parameters:	True
2024-10-05 16:15:56,356 - Detection - feat_dim:	768
2024-10-05 16:15:56,357 - Detection - warmup_proportion:	0.1
2024-10-05 16:15:56,357 - Detection - lr_boundary:	0.05
2024-10-05 16:15:56,357 - Detection - lr:	2e-05
2024-10-05 16:15:56,357 - Detection - activation:	relu
2024-10-05 16:15:56,357 - Detection - train_batch_size:	128
2024-10-05 16:15:56,357 - Detection - eval_batch_size:	64
2024-10-05 16:15:56,357 - Detection - test_batch_size:	64
2024-10-05 16:15:56,357 - Detection - wait_patient:	10
2024-10-05 16:15:56,357 - Detection - safe1:	0.4
2024-10-05 16:15:56,357 - Detection - safe2:	0.3
2024-10-05 16:15:56,357 - Detection - neg_weight:	0.5
2024-10-05 16:15:56,357 - Detection - margin:	0.8
2024-10-05 16:15:56,357 - Detection - p:	2
2024-10-05 16:15:56,357 - Detection - loss_weight:	1
2024-10-05 16:15:56,357 - Detection - supcon_loss_weight:	0.7
2024-10-05 16:15:56,357 - Detection - triplet_loss_weight:	0.9
2024-10-05 16:15:56,357 - Detection - unseen_label_id:	38
2024-10-05 16:15:56,357 - Detection - anum_labels:	39
2024-10-05 16:15:56,357 - Detection - device:	cuda:0
2024-10-05 16:15:56,357 - Detection - ============================== End Params ==============================
2024-10-05 16:15:57,363 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 16:15:57,410 - Detection - Pre-training Begin...
2024-10-05 16:16:02,017 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 16:16:02,017 - Detection -   best_eval_score = 0
2024-10-05 16:16:02,017 - Detection -   eval_score = 2.63
2024-10-05 16:16:02,017 - Detection -   train_loss = 8.840952650705974
2024-10-05 16:16:06,559 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 16:16:06,559 - Detection -   best_eval_score = 2.63
2024-10-05 16:16:06,559 - Detection -   eval_score = 2.37
2024-10-05 16:16:06,559 - Detection -   train_loss = 8.413834857940675
2024-10-05 16:16:11,107 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 16:16:11,107 - Detection -   best_eval_score = 2.63
2024-10-05 16:16:11,107 - Detection -   eval_score = 5.92
2024-10-05 16:16:11,107 - Detection -   train_loss = 8.04676472345988
2024-10-05 16:16:15,666 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 16:16:15,666 - Detection -   best_eval_score = 5.92
2024-10-05 16:16:15,666 - Detection -   eval_score = 12.24
2024-10-05 16:16:15,666 - Detection -   train_loss = 7.524816433588664
2024-10-05 16:16:20,166 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 16:16:20,166 - Detection -   best_eval_score = 12.24
2024-10-05 16:16:20,166 - Detection -   eval_score = 19.34
2024-10-05 16:16:20,166 - Detection -   train_loss = 7.21731653213501
2024-10-05 16:16:24,647 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 16:16:24,647 - Detection -   best_eval_score = 19.34
2024-10-05 16:16:24,648 - Detection -   eval_score = 29.21
2024-10-05 16:16:24,648 - Detection -   train_loss = 6.971635357538859
2024-10-05 16:16:29,257 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 16:16:29,258 - Detection -   best_eval_score = 29.21
2024-10-05 16:16:29,258 - Detection -   eval_score = 43.68
2024-10-05 16:16:29,258 - Detection -   train_loss = 6.714383459091186
2024-10-05 16:16:33,866 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 16:16:33,867 - Detection -   best_eval_score = 43.68
2024-10-05 16:16:33,867 - Detection -   eval_score = 62.5
2024-10-05 16:16:33,867 - Detection -   train_loss = 6.4482379913330075
2024-10-05 16:16:38,453 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 16:16:38,453 - Detection -   best_eval_score = 62.5
2024-10-05 16:16:38,453 - Detection -   eval_score = 78.82
2024-10-05 16:16:38,453 - Detection -   train_loss = 6.101870743433635
2024-10-05 16:16:43,028 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 16:16:43,028 - Detection -   best_eval_score = 78.82
2024-10-05 16:16:43,028 - Detection -   eval_score = 89.47
2024-10-05 16:16:43,028 - Detection -   train_loss = 5.669815174738566
2024-10-05 16:16:47,590 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 16:16:47,590 - Detection -   best_eval_score = 89.47
2024-10-05 16:16:47,590 - Detection -   eval_score = 93.03
2024-10-05 16:16:47,590 - Detection -   train_loss = 5.1719528039296465
2024-10-05 16:16:52,168 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 16:16:52,168 - Detection -   best_eval_score = 93.03
2024-10-05 16:16:52,169 - Detection -   eval_score = 95.66
2024-10-05 16:16:52,169 - Detection -   train_loss = 4.566092046101888
2024-10-05 16:16:56,740 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 16:16:56,741 - Detection -   best_eval_score = 95.66
2024-10-05 16:16:56,741 - Detection -   eval_score = 96.32
2024-10-05 16:16:56,741 - Detection -   train_loss = 4.017891518274943
2024-10-05 16:17:01,415 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 16:17:01,416 - Detection -   best_eval_score = 96.32
2024-10-05 16:17:01,416 - Detection -   eval_score = 97.11
2024-10-05 16:17:01,416 - Detection -   train_loss = 3.5873610893885295
2024-10-05 16:17:06,015 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 16:17:06,015 - Detection -   best_eval_score = 97.11
2024-10-05 16:17:06,015 - Detection -   eval_score = 97.24
2024-10-05 16:17:06,015 - Detection -   train_loss = 3.2240941762924193
2024-10-05 16:17:10,627 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 16:17:10,627 - Detection -   best_eval_score = 97.24
2024-10-05 16:17:10,628 - Detection -   eval_score = 97.63
2024-10-05 16:17:10,628 - Detection -   train_loss = 2.9790993372599286
2024-10-05 16:17:15,236 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 16:17:15,236 - Detection -   best_eval_score = 97.63
2024-10-05 16:17:15,236 - Detection -   eval_score = 97.76
2024-10-05 16:17:15,236 - Detection -   train_loss = 2.7947305917739866
2024-10-05 16:17:19,883 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 16:17:19,884 - Detection -   best_eval_score = 97.76
2024-10-05 16:17:19,884 - Detection -   eval_score = 97.76
2024-10-05 16:17:19,884 - Detection -   train_loss = 2.6950417280197145
2024-10-05 16:17:24,477 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 16:17:24,477 - Detection -   best_eval_score = 97.76
2024-10-05 16:17:24,477 - Detection -   eval_score = 97.63
2024-10-05 16:17:24,478 - Detection -   train_loss = 2.6019296646118164
2024-10-05 16:17:29,045 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 16:17:29,045 - Detection -   best_eval_score = 97.76
2024-10-05 16:17:29,045 - Detection -   eval_score = 97.76
2024-10-05 16:17:29,045 - Detection -   train_loss = 2.5354123592376707
2024-10-05 16:17:33,664 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 16:17:33,664 - Detection -   best_eval_score = 97.76
2024-10-05 16:17:33,665 - Detection -   eval_score = 98.16
2024-10-05 16:17:33,665 - Detection -   train_loss = 2.46728568871816
2024-10-05 16:17:38,347 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 16:17:38,348 - Detection -   best_eval_score = 98.16
2024-10-05 16:17:38,348 - Detection -   eval_score = 98.03
2024-10-05 16:17:38,348 - Detection -   train_loss = 2.4311756610870363
2024-10-05 16:17:43,026 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 16:17:43,026 - Detection -   best_eval_score = 98.16
2024-10-05 16:17:43,026 - Detection -   eval_score = 98.16
2024-10-05 16:17:43,026 - Detection -   train_loss = 2.4038280884424847
2024-10-05 16:17:47,596 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 16:17:47,597 - Detection -   best_eval_score = 98.16
2024-10-05 16:17:47,597 - Detection -   eval_score = 98.16
2024-10-05 16:17:47,597 - Detection -   train_loss = 2.3619471629460653
2024-10-05 16:17:52,181 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 16:17:52,181 - Detection -   best_eval_score = 98.16
2024-10-05 16:17:52,181 - Detection -   eval_score = 98.29
2024-10-05 16:17:52,181 - Detection -   train_loss = 2.33579793771108
2024-10-05 16:17:56,770 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 16:17:56,770 - Detection -   best_eval_score = 98.29
2024-10-05 16:17:56,770 - Detection -   eval_score = 98.16
2024-10-05 16:17:56,770 - Detection -   train_loss = 2.318979581197103
2024-10-05 16:18:01,348 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 16:18:01,348 - Detection -   best_eval_score = 98.29
2024-10-05 16:18:01,348 - Detection -   eval_score = 98.16
2024-10-05 16:18:01,348 - Detection -   train_loss = 2.3101202567418415
2024-10-05 16:18:05,952 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 16:18:05,952 - Detection -   best_eval_score = 98.29
2024-10-05 16:18:05,952 - Detection -   eval_score = 98.16
2024-10-05 16:18:05,952 - Detection -   train_loss = 2.2800166249275207
2024-10-05 16:18:10,536 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 16:18:10,536 - Detection -   best_eval_score = 98.29
2024-10-05 16:18:10,536 - Detection -   eval_score = 98.29
2024-10-05 16:18:10,536 - Detection -   train_loss = 2.265408253669739
2024-10-05 16:18:15,158 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 16:18:15,158 - Detection -   best_eval_score = 98.29
2024-10-05 16:18:15,158 - Detection -   eval_score = 98.29
2024-10-05 16:18:15,158 - Detection -   train_loss = 2.2664974093437196
2024-10-05 16:18:19,715 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 16:18:19,715 - Detection -   best_eval_score = 98.29
2024-10-05 16:18:19,715 - Detection -   eval_score = 98.42
2024-10-05 16:18:19,715 - Detection -   train_loss = 2.2559389591217043
2024-10-05 16:18:24,288 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 16:18:24,288 - Detection -   best_eval_score = 98.42
2024-10-05 16:18:24,288 - Detection -   eval_score = 98.29
2024-10-05 16:18:24,288 - Detection -   train_loss = 2.2376607497533163
2024-10-05 16:18:28,867 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 16:18:28,868 - Detection -   best_eval_score = 98.42
2024-10-05 16:18:28,868 - Detection -   eval_score = 98.42
2024-10-05 16:18:28,868 - Detection -   train_loss = 2.230059504508972
2024-10-05 16:18:33,509 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 16:18:33,509 - Detection -   best_eval_score = 98.42
2024-10-05 16:18:33,509 - Detection -   eval_score = 98.16
2024-10-05 16:18:33,509 - Detection -   train_loss = 2.2156099557876585
2024-10-05 16:18:38,115 - Detection - ***** Epoch: 35: Eval results *****
2024-10-05 16:18:38,116 - Detection -   best_eval_score = 98.42
2024-10-05 16:18:38,116 - Detection -   eval_score = 98.16
2024-10-05 16:18:38,116 - Detection -   train_loss = 2.2101656516393025
2024-10-05 16:18:42,649 - Detection - ***** Epoch: 36: Eval results *****
2024-10-05 16:18:42,650 - Detection -   best_eval_score = 98.42
2024-10-05 16:18:42,650 - Detection -   eval_score = 98.16
2024-10-05 16:18:42,650 - Detection -   train_loss = 2.1993439555168153
2024-10-05 16:18:47,207 - Detection - ***** Epoch: 37: Eval results *****
2024-10-05 16:18:47,207 - Detection -   best_eval_score = 98.42
2024-10-05 16:18:47,207 - Detection -   eval_score = 98.42
2024-10-05 16:18:47,207 - Detection -   train_loss = 2.196841474374135
2024-10-05 16:18:51,766 - Detection - ***** Epoch: 38: Eval results *****
2024-10-05 16:18:51,766 - Detection -   best_eval_score = 98.42
2024-10-05 16:18:51,766 - Detection -   eval_score = 98.42
2024-10-05 16:18:51,766 - Detection -   train_loss = 2.1862257440884907
2024-10-05 16:18:56,296 - Detection - ***** Epoch: 39: Eval results *****
2024-10-05 16:18:56,297 - Detection -   best_eval_score = 98.42
2024-10-05 16:18:56,297 - Detection -   eval_score = 98.42
2024-10-05 16:18:56,297 - Detection -   train_loss = 2.188224736849467
2024-10-05 16:19:00,849 - Detection - ***** Epoch: 40: Eval results *****
2024-10-05 16:19:00,850 - Detection -   best_eval_score = 98.42
2024-10-05 16:19:00,850 - Detection -   eval_score = 98.29
2024-10-05 16:19:00,850 - Detection -   train_loss = 2.1765384395917255
2024-10-05 16:19:05,433 - Detection - ***** Epoch: 41: Eval results *****
2024-10-05 16:19:05,434 - Detection -   best_eval_score = 98.42
2024-10-05 16:19:05,434 - Detection -   eval_score = 98.16
2024-10-05 16:19:05,434 - Detection -   train_loss = 2.167403817176819
2024-10-05 16:19:05,435 - Detection - Pre-training finished...
2024-10-05 16:19:05,435 - Detection - Training Begin...
2024-10-05 16:19:10,839 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 16:19:10,839 - Detection -   best_eval_score = 0
2024-10-05 16:19:10,839 - Detection -   eval_score = 0.24
2024-10-05 16:19:10,839 - Detection -   train_loss = 10.527833970387777
2024-10-05 16:19:13,271 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 16:19:13,271 - Detection -   best_eval_score = 0.24
2024-10-05 16:19:13,271 - Detection -   eval_score = 19.91
2024-10-05 16:19:13,271 - Detection -   train_loss = 8.9186181863149
2024-10-05 16:19:15,714 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 16:19:15,714 - Detection -   best_eval_score = 19.91
2024-10-05 16:19:15,714 - Detection -   eval_score = 61.62
2024-10-05 16:19:15,714 - Detection -   train_loss = 6.8039346853892
2024-10-05 16:19:18,152 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 16:19:18,152 - Detection -   best_eval_score = 61.62
2024-10-05 16:19:18,152 - Detection -   eval_score = 83.49
2024-10-05 16:19:18,152 - Detection -   train_loss = 4.505137149492899
2024-10-05 16:19:20,586 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 16:19:20,587 - Detection -   best_eval_score = 83.49
2024-10-05 16:19:20,587 - Detection -   eval_score = 90.19
2024-10-05 16:19:20,587 - Detection -   train_loss = 2.620870045820872
2024-10-05 16:19:23,022 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 16:19:23,022 - Detection -   best_eval_score = 90.19
2024-10-05 16:19:23,022 - Detection -   eval_score = 92.4
2024-10-05 16:19:23,022 - Detection -   train_loss = 1.6912431041399638
2024-10-05 16:19:25,451 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 16:19:25,452 - Detection -   best_eval_score = 92.4
2024-10-05 16:19:25,452 - Detection -   eval_score = 92.62
2024-10-05 16:19:25,452 - Detection -   train_loss = 1.5596919814745585
2024-10-05 16:19:27,876 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 16:19:27,876 - Detection -   best_eval_score = 92.62
2024-10-05 16:19:27,876 - Detection -   eval_score = 92.69
2024-10-05 16:19:27,876 - Detection -   train_loss = 1.5567006587982177
2024-10-05 16:19:30,295 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 16:19:30,295 - Detection -   best_eval_score = 92.69
2024-10-05 16:19:30,295 - Detection -   eval_score = 92.69
2024-10-05 16:19:30,295 - Detection -   train_loss = 1.5481395761171977
2024-10-05 16:19:32,723 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 16:19:32,723 - Detection -   best_eval_score = 92.69
2024-10-05 16:19:32,723 - Detection -   eval_score = 92.69
2024-10-05 16:19:32,723 - Detection -   train_loss = 1.5492374936739604
2024-10-05 16:19:35,206 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 16:19:35,206 - Detection -   best_eval_score = 92.69
2024-10-05 16:19:35,206 - Detection -   eval_score = 92.69
2024-10-05 16:19:35,206 - Detection -   train_loss = 1.5375259478886922
2024-10-05 16:19:37,626 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 16:19:37,626 - Detection -   best_eval_score = 92.69
2024-10-05 16:19:37,626 - Detection -   eval_score = 92.62
2024-10-05 16:19:37,626 - Detection -   train_loss = 1.5532166719436646
2024-10-05 16:19:40,059 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 16:19:40,059 - Detection -   best_eval_score = 92.69
2024-10-05 16:19:40,059 - Detection -   eval_score = 92.62
2024-10-05 16:19:40,059 - Detection -   train_loss = 1.5439462582270305
2024-10-05 16:19:42,495 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 16:19:42,495 - Detection -   best_eval_score = 92.69
2024-10-05 16:19:42,495 - Detection -   eval_score = 92.76
2024-10-05 16:19:42,495 - Detection -   train_loss = 1.5495097994804383
2024-10-05 16:19:44,945 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 16:19:44,945 - Detection -   best_eval_score = 92.76
2024-10-05 16:19:44,945 - Detection -   eval_score = 92.69
2024-10-05 16:19:44,945 - Detection -   train_loss = 1.5557022968928018
2024-10-05 16:19:47,380 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 16:19:47,380 - Detection -   best_eval_score = 92.76
2024-10-05 16:19:47,380 - Detection -   eval_score = 92.76
2024-10-05 16:19:47,380 - Detection -   train_loss = 1.5567538460095725
2024-10-05 16:19:49,814 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 16:19:49,814 - Detection -   best_eval_score = 92.76
2024-10-05 16:19:49,814 - Detection -   eval_score = 92.62
2024-10-05 16:19:49,815 - Detection -   train_loss = 1.5426665743192036
2024-10-05 16:19:52,245 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 16:19:52,245 - Detection -   best_eval_score = 92.76
2024-10-05 16:19:52,245 - Detection -   eval_score = 92.82
2024-10-05 16:19:52,245 - Detection -   train_loss = 1.548209011554718
2024-10-05 16:19:54,668 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 16:19:54,668 - Detection -   best_eval_score = 92.82
2024-10-05 16:19:54,668 - Detection -   eval_score = 92.69
2024-10-05 16:19:54,668 - Detection -   train_loss = 1.5444732666015626
2024-10-05 16:19:57,095 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 16:19:57,095 - Detection -   best_eval_score = 92.82
2024-10-05 16:19:57,095 - Detection -   eval_score = 92.62
2024-10-05 16:19:57,095 - Detection -   train_loss = 1.5480843861897786
2024-10-05 16:19:59,542 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 16:19:59,543 - Detection -   best_eval_score = 92.82
2024-10-05 16:19:59,543 - Detection -   eval_score = 92.62
2024-10-05 16:19:59,543 - Detection -   train_loss = 1.560137641429901
2024-10-05 16:20:01,967 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 16:20:01,967 - Detection -   best_eval_score = 92.82
2024-10-05 16:20:01,967 - Detection -   eval_score = 92.69
2024-10-05 16:20:01,967 - Detection -   train_loss = 1.5612529595692952
2024-10-05 16:20:04,403 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 16:20:04,403 - Detection -   best_eval_score = 92.82
2024-10-05 16:20:04,403 - Detection -   eval_score = 92.76
2024-10-05 16:20:04,403 - Detection -   train_loss = 1.5595402797063191
2024-10-05 16:20:06,848 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 16:20:06,849 - Detection -   best_eval_score = 92.82
2024-10-05 16:20:06,849 - Detection -   eval_score = 92.76
2024-10-05 16:20:06,849 - Detection -   train_loss = 1.5659557064374288
2024-10-05 16:20:09,317 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 16:20:09,317 - Detection -   best_eval_score = 92.82
2024-10-05 16:20:09,317 - Detection -   eval_score = 92.69
2024-10-05 16:20:09,317 - Detection -   train_loss = 1.5447075724601746
2024-10-05 16:20:11,747 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 16:20:11,747 - Detection -   best_eval_score = 92.82
2024-10-05 16:20:11,747 - Detection -   eval_score = 92.76
2024-10-05 16:20:11,747 - Detection -   train_loss = 1.5503368496894836
2024-10-05 16:20:14,174 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 16:20:14,174 - Detection -   best_eval_score = 92.82
2024-10-05 16:20:14,174 - Detection -   eval_score = 92.69
2024-10-05 16:20:14,174 - Detection -   train_loss = 1.5540810902913411
2024-10-05 16:20:16,602 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 16:20:16,602 - Detection -   best_eval_score = 92.82
2024-10-05 16:20:16,602 - Detection -   eval_score = 92.69
2024-10-05 16:20:16,602 - Detection -   train_loss = 1.53381560643514
2024-10-05 16:20:16,602 - Detection - Training Finished...
2024-10-05 16:20:16,602 - Detection - Testing begin...
2024-10-05 16:20:18,803 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 16:20:18,803 - Detection - [[  29    0    0 ...    0    0    1]
 [   0   22    0 ...    0    0    8]
 [   0    0   28 ...    0    0    2]
 ...
 [   0    0    0 ...   27    0    3]
 [   0    0    0 ...    0   25    5]
 [   2    3   35 ...    8    3 4103]]
2024-10-05 16:20:18,803 - Detection - ***** Test results *****
2024-10-05 16:20:18,803 - Detection -   Acc = 90.07
2024-10-05 16:20:18,803 - Detection -   F1 = 80.7209
2024-10-05 16:20:18,803 - Detection -   F1-known = 80.3819
2024-10-05 16:20:18,803 - Detection -   F1-open = 93.601
2024-10-05 16:20:18,803 - Detection - Testing finished...
2024-10-05 16:20:18,803 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 16:20:18,837 - Detection - ============================== Params ==============================
2024-10-05 16:20:18,837 - Detection - type:	open_intent_detection
2024-10-05 16:20:18,838 - Detection - logger_name:	Detection
2024-10-05 16:20:18,838 - Detection - log_dir:	logs
2024-10-05 16:20:18,838 - Detection - dataset:	oos
2024-10-05 16:20:18,838 - Detection - known_cls_ratio:	0.25
2024-10-05 16:20:18,838 - Detection - labeled_ratio:	1.0
2024-10-05 16:20:18,838 - Detection - method:	ADB
2024-10-05 16:20:18,838 - Detection - train:	True
2024-10-05 16:20:18,838 - Detection - tune:	True
2024-10-05 16:20:18,838 - Detection - pretrain:	True
2024-10-05 16:20:18,838 - Detection - b_train:	False
2024-10-05 16:20:18,838 - Detection - save_model:	False
2024-10-05 16:20:18,838 - Detection - backbone:	bert
2024-10-05 16:20:18,838 - Detection - config_file_name:	ADB
2024-10-05 16:20:18,838 - Detection - seed:	1
2024-10-05 16:20:18,838 - Detection - gpu_id:	0
2024-10-05 16:20:18,838 - Detection - pipe_results_path:	pipe_results
2024-10-05 16:20:18,838 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 16:20:18,838 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 16:20:18,838 - Detection - model_dir:	models
2024-10-05 16:20:18,838 - Detection - load_pretrained_method:	None
2024-10-05 16:20:18,838 - Detection - result_dir:	results
2024-10-05 16:20:18,838 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 16:20:18,838 - Detection - save_results:	True
2024-10-05 16:20:18,838 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 16:20:18,838 - Detection - dataset_neg:	SQUAD
2024-10-05 16:20:18,838 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1
2024-10-05 16:20:18,838 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1/models
2024-10-05 16:20:18,838 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 16:20:18,838 - Detection - num_train_epochs:	100
2024-10-05 16:20:18,838 - Detection - num_labels:	38
2024-10-05 16:20:18,838 - Detection - max_seq_length:	30
2024-10-05 16:20:18,838 - Detection - freeze_backbone_parameters:	True
2024-10-05 16:20:18,838 - Detection - feat_dim:	768
2024-10-05 16:20:18,838 - Detection - warmup_proportion:	0.1
2024-10-05 16:20:18,838 - Detection - lr_boundary:	0.05
2024-10-05 16:20:18,838 - Detection - lr:	2e-05
2024-10-05 16:20:18,838 - Detection - activation:	relu
2024-10-05 16:20:18,838 - Detection - train_batch_size:	128
2024-10-05 16:20:18,838 - Detection - eval_batch_size:	64
2024-10-05 16:20:18,839 - Detection - test_batch_size:	64
2024-10-05 16:20:18,839 - Detection - wait_patient:	10
2024-10-05 16:20:18,839 - Detection - safe1:	0.4
2024-10-05 16:20:18,839 - Detection - safe2:	0.3
2024-10-05 16:20:18,839 - Detection - neg_weight:	0.8
2024-10-05 16:20:18,839 - Detection - margin:	0.8
2024-10-05 16:20:18,839 - Detection - p:	2
2024-10-05 16:20:18,839 - Detection - loss_weight:	1
2024-10-05 16:20:18,839 - Detection - supcon_loss_weight:	0.7
2024-10-05 16:20:18,839 - Detection - triplet_loss_weight:	0.9
2024-10-05 16:20:18,839 - Detection - unseen_label_id:	38
2024-10-05 16:20:18,839 - Detection - anum_labels:	39
2024-10-05 16:20:18,839 - Detection - device:	cuda:0
2024-10-05 16:20:18,839 - Detection - ============================== End Params ==============================
2024-10-05 16:20:19,861 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 16:20:19,908 - Detection - Pre-training Begin...
2024-10-05 16:20:24,426 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 16:20:24,427 - Detection -   best_eval_score = 0
2024-10-05 16:20:24,427 - Detection -   eval_score = 2.63
2024-10-05 16:20:24,427 - Detection -   train_loss = 8.840952650705974
2024-10-05 16:20:28,922 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 16:20:28,922 - Detection -   best_eval_score = 2.63
2024-10-05 16:20:28,922 - Detection -   eval_score = 2.37
2024-10-05 16:20:28,922 - Detection -   train_loss = 8.413834857940675
2024-10-05 16:20:33,470 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 16:20:33,470 - Detection -   best_eval_score = 2.63
2024-10-05 16:20:33,470 - Detection -   eval_score = 5.92
2024-10-05 16:20:33,470 - Detection -   train_loss = 8.04676472345988
2024-10-05 16:20:37,968 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 16:20:37,968 - Detection -   best_eval_score = 5.92
2024-10-05 16:20:37,968 - Detection -   eval_score = 12.24
2024-10-05 16:20:37,968 - Detection -   train_loss = 7.524816433588664
2024-10-05 16:20:42,587 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 16:20:42,587 - Detection -   best_eval_score = 12.24
2024-10-05 16:20:42,587 - Detection -   eval_score = 19.34
2024-10-05 16:20:42,587 - Detection -   train_loss = 7.21731653213501
2024-10-05 16:20:47,153 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 16:20:47,153 - Detection -   best_eval_score = 19.34
2024-10-05 16:20:47,153 - Detection -   eval_score = 29.21
2024-10-05 16:20:47,153 - Detection -   train_loss = 6.971635357538859
2024-10-05 16:20:51,740 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 16:20:51,740 - Detection -   best_eval_score = 29.21
2024-10-05 16:20:51,740 - Detection -   eval_score = 43.68
2024-10-05 16:20:51,740 - Detection -   train_loss = 6.714383459091186
2024-10-05 16:20:56,304 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 16:20:56,304 - Detection -   best_eval_score = 43.68
2024-10-05 16:20:56,304 - Detection -   eval_score = 62.5
2024-10-05 16:20:56,304 - Detection -   train_loss = 6.4482379913330075
2024-10-05 16:21:00,927 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 16:21:00,928 - Detection -   best_eval_score = 62.5
2024-10-05 16:21:00,928 - Detection -   eval_score = 78.82
2024-10-05 16:21:00,928 - Detection -   train_loss = 6.101870743433635
2024-10-05 16:21:05,570 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 16:21:05,570 - Detection -   best_eval_score = 78.82
2024-10-05 16:21:05,570 - Detection -   eval_score = 89.47
2024-10-05 16:21:05,570 - Detection -   train_loss = 5.669815174738566
2024-10-05 16:21:10,117 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 16:21:10,117 - Detection -   best_eval_score = 89.47
2024-10-05 16:21:10,117 - Detection -   eval_score = 93.03
2024-10-05 16:21:10,117 - Detection -   train_loss = 5.1719528039296465
2024-10-05 16:21:14,697 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 16:21:14,697 - Detection -   best_eval_score = 93.03
2024-10-05 16:21:14,698 - Detection -   eval_score = 95.66
2024-10-05 16:21:14,698 - Detection -   train_loss = 4.566092046101888
2024-10-05 16:21:19,256 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 16:21:19,256 - Detection -   best_eval_score = 95.66
2024-10-05 16:21:19,256 - Detection -   eval_score = 96.32
2024-10-05 16:21:19,256 - Detection -   train_loss = 4.017891518274943
2024-10-05 16:21:23,807 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 16:21:23,807 - Detection -   best_eval_score = 96.32
2024-10-05 16:21:23,807 - Detection -   eval_score = 97.11
2024-10-05 16:21:23,807 - Detection -   train_loss = 3.5873610893885295
2024-10-05 16:21:28,385 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 16:21:28,385 - Detection -   best_eval_score = 97.11
2024-10-05 16:21:28,385 - Detection -   eval_score = 97.24
2024-10-05 16:21:28,385 - Detection -   train_loss = 3.2240941762924193
2024-10-05 16:21:32,903 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 16:21:32,904 - Detection -   best_eval_score = 97.24
2024-10-05 16:21:32,904 - Detection -   eval_score = 97.63
2024-10-05 16:21:32,904 - Detection -   train_loss = 2.9790993372599286
2024-10-05 16:21:37,498 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 16:21:37,498 - Detection -   best_eval_score = 97.63
2024-10-05 16:21:37,498 - Detection -   eval_score = 97.76
2024-10-05 16:21:37,498 - Detection -   train_loss = 2.7947305917739866
2024-10-05 16:21:42,120 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 16:21:42,120 - Detection -   best_eval_score = 97.76
2024-10-05 16:21:42,121 - Detection -   eval_score = 97.76
2024-10-05 16:21:42,121 - Detection -   train_loss = 2.6950417280197145
2024-10-05 16:21:46,669 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 16:21:46,669 - Detection -   best_eval_score = 97.76
2024-10-05 16:21:46,669 - Detection -   eval_score = 97.63
2024-10-05 16:21:46,669 - Detection -   train_loss = 2.6019296646118164
2024-10-05 16:21:51,266 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 16:21:51,266 - Detection -   best_eval_score = 97.76
2024-10-05 16:21:51,266 - Detection -   eval_score = 97.76
2024-10-05 16:21:51,266 - Detection -   train_loss = 2.5354123592376707
2024-10-05 16:21:55,826 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 16:21:55,826 - Detection -   best_eval_score = 97.76
2024-10-05 16:21:55,826 - Detection -   eval_score = 98.16
2024-10-05 16:21:55,826 - Detection -   train_loss = 2.46728568871816
2024-10-05 16:22:00,453 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 16:22:00,454 - Detection -   best_eval_score = 98.16
2024-10-05 16:22:00,454 - Detection -   eval_score = 98.03
2024-10-05 16:22:00,454 - Detection -   train_loss = 2.4311756610870363
2024-10-05 16:22:05,012 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 16:22:05,013 - Detection -   best_eval_score = 98.16
2024-10-05 16:22:05,013 - Detection -   eval_score = 98.16
2024-10-05 16:22:05,013 - Detection -   train_loss = 2.4038280884424847
2024-10-05 16:22:09,582 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 16:22:09,582 - Detection -   best_eval_score = 98.16
2024-10-05 16:22:09,582 - Detection -   eval_score = 98.16
2024-10-05 16:22:09,582 - Detection -   train_loss = 2.3619471629460653
2024-10-05 16:22:14,107 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 16:22:14,107 - Detection -   best_eval_score = 98.16
2024-10-05 16:22:14,107 - Detection -   eval_score = 98.29
2024-10-05 16:22:14,108 - Detection -   train_loss = 2.33579793771108
2024-10-05 16:22:18,718 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 16:22:18,718 - Detection -   best_eval_score = 98.29
2024-10-05 16:22:18,718 - Detection -   eval_score = 98.16
2024-10-05 16:22:18,718 - Detection -   train_loss = 2.318979581197103
2024-10-05 16:22:23,335 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 16:22:23,336 - Detection -   best_eval_score = 98.29
2024-10-05 16:22:23,336 - Detection -   eval_score = 98.16
2024-10-05 16:22:23,336 - Detection -   train_loss = 2.3101202567418415
2024-10-05 16:22:28,019 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 16:22:28,019 - Detection -   best_eval_score = 98.29
2024-10-05 16:22:28,019 - Detection -   eval_score = 98.16
2024-10-05 16:22:28,019 - Detection -   train_loss = 2.2800166249275207
2024-10-05 16:22:32,610 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 16:22:32,610 - Detection -   best_eval_score = 98.29
2024-10-05 16:22:32,610 - Detection -   eval_score = 98.29
2024-10-05 16:22:32,610 - Detection -   train_loss = 2.265408253669739
2024-10-05 16:22:37,223 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 16:22:37,224 - Detection -   best_eval_score = 98.29
2024-10-05 16:22:37,224 - Detection -   eval_score = 98.29
2024-10-05 16:22:37,224 - Detection -   train_loss = 2.2664974093437196
2024-10-05 16:22:41,804 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 16:22:41,804 - Detection -   best_eval_score = 98.29
2024-10-05 16:22:41,804 - Detection -   eval_score = 98.42
2024-10-05 16:22:41,804 - Detection -   train_loss = 2.2559389591217043
2024-10-05 16:22:46,392 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 16:22:46,393 - Detection -   best_eval_score = 98.42
2024-10-05 16:22:46,393 - Detection -   eval_score = 98.29
2024-10-05 16:22:46,393 - Detection -   train_loss = 2.2376607497533163
2024-10-05 16:22:50,984 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 16:22:50,984 - Detection -   best_eval_score = 98.42
2024-10-05 16:22:50,985 - Detection -   eval_score = 98.42
2024-10-05 16:22:50,985 - Detection -   train_loss = 2.230059504508972
2024-10-05 16:22:55,557 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 16:22:55,557 - Detection -   best_eval_score = 98.42
2024-10-05 16:22:55,557 - Detection -   eval_score = 98.16
2024-10-05 16:22:55,557 - Detection -   train_loss = 2.2156099557876585
2024-10-05 16:23:00,133 - Detection - ***** Epoch: 35: Eval results *****
2024-10-05 16:23:00,133 - Detection -   best_eval_score = 98.42
2024-10-05 16:23:00,133 - Detection -   eval_score = 98.16
2024-10-05 16:23:00,133 - Detection -   train_loss = 2.2101656516393025
2024-10-05 16:23:04,725 - Detection - ***** Epoch: 36: Eval results *****
2024-10-05 16:23:04,725 - Detection -   best_eval_score = 98.42
2024-10-05 16:23:04,726 - Detection -   eval_score = 98.16
2024-10-05 16:23:04,726 - Detection -   train_loss = 2.1993439555168153
2024-10-05 16:23:09,283 - Detection - ***** Epoch: 37: Eval results *****
2024-10-05 16:23:09,283 - Detection -   best_eval_score = 98.42
2024-10-05 16:23:09,283 - Detection -   eval_score = 98.42
2024-10-05 16:23:09,283 - Detection -   train_loss = 2.196841474374135
2024-10-05 16:23:13,851 - Detection - ***** Epoch: 38: Eval results *****
2024-10-05 16:23:13,851 - Detection -   best_eval_score = 98.42
2024-10-05 16:23:13,852 - Detection -   eval_score = 98.42
2024-10-05 16:23:13,852 - Detection -   train_loss = 2.1862257440884907
2024-10-05 16:23:18,456 - Detection - ***** Epoch: 39: Eval results *****
2024-10-05 16:23:18,456 - Detection -   best_eval_score = 98.42
2024-10-05 16:23:18,456 - Detection -   eval_score = 98.42
2024-10-05 16:23:18,456 - Detection -   train_loss = 2.188224736849467
2024-10-05 16:23:23,129 - Detection - ***** Epoch: 40: Eval results *****
2024-10-05 16:23:23,129 - Detection -   best_eval_score = 98.42
2024-10-05 16:23:23,129 - Detection -   eval_score = 98.29
2024-10-05 16:23:23,129 - Detection -   train_loss = 2.1765384395917255
2024-10-05 16:23:27,721 - Detection - ***** Epoch: 41: Eval results *****
2024-10-05 16:23:27,721 - Detection -   best_eval_score = 98.42
2024-10-05 16:23:27,721 - Detection -   eval_score = 98.16
2024-10-05 16:23:27,721 - Detection -   train_loss = 2.167403817176819
2024-10-05 16:23:27,722 - Detection - Pre-training finished...
2024-10-05 16:23:27,722 - Detection - Training Begin...
2024-10-05 16:23:33,127 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 16:23:33,127 - Detection -   best_eval_score = 0
2024-10-05 16:23:33,127 - Detection -   eval_score = 0.24
2024-10-05 16:23:33,127 - Detection -   train_loss = 12.73420524597168
2024-10-05 16:23:35,546 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 16:23:35,546 - Detection -   best_eval_score = 0.24
2024-10-05 16:23:35,546 - Detection -   eval_score = 19.91
2024-10-05 16:23:35,546 - Detection -   train_loss = 10.81327527364095
2024-10-05 16:23:37,982 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 16:23:37,982 - Detection -   best_eval_score = 19.91
2024-10-05 16:23:37,982 - Detection -   eval_score = 61.62
2024-10-05 16:23:37,982 - Detection -   train_loss = 8.266748046875
2024-10-05 16:23:40,400 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 16:23:40,401 - Detection -   best_eval_score = 61.62
2024-10-05 16:23:40,401 - Detection -   eval_score = 83.49
2024-10-05 16:23:40,401 - Detection -   train_loss = 5.525867525736491
2024-10-05 16:23:42,837 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 16:23:42,837 - Detection -   best_eval_score = 83.49
2024-10-05 16:23:42,838 - Detection -   eval_score = 90.19
2024-10-05 16:23:42,838 - Detection -   train_loss = 3.2739789883295694
2024-10-05 16:23:45,257 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 16:23:45,257 - Detection -   best_eval_score = 90.19
2024-10-05 16:23:45,257 - Detection -   eval_score = 92.56
2024-10-05 16:23:45,257 - Detection -   train_loss = 2.1177666544914246
2024-10-05 16:23:47,683 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 16:23:47,683 - Detection -   best_eval_score = 92.56
2024-10-05 16:23:47,683 - Detection -   eval_score = 92.69
2024-10-05 16:23:47,683 - Detection -   train_loss = 1.9109310746192931
2024-10-05 16:23:50,123 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 16:23:50,123 - Detection -   best_eval_score = 92.69
2024-10-05 16:23:50,123 - Detection -   eval_score = 92.9
2024-10-05 16:23:50,123 - Detection -   train_loss = 1.8914461493492127
2024-10-05 16:23:52,561 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 16:23:52,561 - Detection -   best_eval_score = 92.9
2024-10-05 16:23:52,561 - Detection -   eval_score = 93.0
2024-10-05 16:23:52,561 - Detection -   train_loss = 1.8791022380193074
2024-10-05 16:23:54,994 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 16:23:54,994 - Detection -   best_eval_score = 93.0
2024-10-05 16:23:54,994 - Detection -   eval_score = 93.06
2024-10-05 16:23:54,994 - Detection -   train_loss = 1.8785990198453268
2024-10-05 16:23:57,420 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 16:23:57,420 - Detection -   best_eval_score = 93.06
2024-10-05 16:23:57,420 - Detection -   eval_score = 93.09
2024-10-05 16:23:57,420 - Detection -   train_loss = 1.858281703790029
2024-10-05 16:23:59,840 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 16:23:59,840 - Detection -   best_eval_score = 93.09
2024-10-05 16:23:59,840 - Detection -   eval_score = 93.0
2024-10-05 16:23:59,840 - Detection -   train_loss = 1.8819872935612996
2024-10-05 16:24:02,272 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 16:24:02,272 - Detection -   best_eval_score = 93.09
2024-10-05 16:24:02,272 - Detection -   eval_score = 93.0
2024-10-05 16:24:02,272 - Detection -   train_loss = 1.8636162638664246
2024-10-05 16:24:04,711 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 16:24:04,711 - Detection -   best_eval_score = 93.09
2024-10-05 16:24:04,711 - Detection -   eval_score = 93.06
2024-10-05 16:24:04,711 - Detection -   train_loss = 1.8771896322568258
2024-10-05 16:24:07,147 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 16:24:07,148 - Detection -   best_eval_score = 93.09
2024-10-05 16:24:07,148 - Detection -   eval_score = 93.06
2024-10-05 16:24:07,148 - Detection -   train_loss = 1.8835442701975504
2024-10-05 16:24:09,578 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 16:24:09,578 - Detection -   best_eval_score = 93.09
2024-10-05 16:24:09,578 - Detection -   eval_score = 93.0
2024-10-05 16:24:09,578 - Detection -   train_loss = 1.8822118401527406
2024-10-05 16:24:12,014 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 16:24:12,014 - Detection -   best_eval_score = 93.09
2024-10-05 16:24:12,014 - Detection -   eval_score = 93.06
2024-10-05 16:24:12,014 - Detection -   train_loss = 1.8696417172749837
2024-10-05 16:24:14,456 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 16:24:14,457 - Detection -   best_eval_score = 93.09
2024-10-05 16:24:14,457 - Detection -   eval_score = 93.06
2024-10-05 16:24:14,457 - Detection -   train_loss = 1.8737744450569154
2024-10-05 16:24:16,890 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 16:24:16,890 - Detection -   best_eval_score = 93.09
2024-10-05 16:24:16,890 - Detection -   eval_score = 93.0
2024-10-05 16:24:16,890 - Detection -   train_loss = 1.8706527829170227
2024-10-05 16:24:19,333 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 16:24:19,333 - Detection -   best_eval_score = 93.09
2024-10-05 16:24:19,334 - Detection -   eval_score = 93.09
2024-10-05 16:24:19,334 - Detection -   train_loss = 1.8666743278503417
2024-10-05 16:24:21,764 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 16:24:21,764 - Detection -   best_eval_score = 93.09
2024-10-05 16:24:21,764 - Detection -   eval_score = 93.18
2024-10-05 16:24:21,764 - Detection -   train_loss = 1.8865914742151897
2024-10-05 16:24:24,188 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 16:24:24,188 - Detection -   best_eval_score = 93.18
2024-10-05 16:24:24,188 - Detection -   eval_score = 93.16
2024-10-05 16:24:24,188 - Detection -   train_loss = 1.8864299217859903
2024-10-05 16:24:26,703 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 16:24:26,703 - Detection -   best_eval_score = 93.18
2024-10-05 16:24:26,703 - Detection -   eval_score = 93.16
2024-10-05 16:24:26,703 - Detection -   train_loss = 1.8841352144877115
2024-10-05 16:24:29,129 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 16:24:29,129 - Detection -   best_eval_score = 93.18
2024-10-05 16:24:29,129 - Detection -   eval_score = 93.09
2024-10-05 16:24:29,129 - Detection -   train_loss = 1.8973198771476745
2024-10-05 16:24:31,566 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 16:24:31,566 - Detection -   best_eval_score = 93.18
2024-10-05 16:24:31,566 - Detection -   eval_score = 93.09
2024-10-05 16:24:31,567 - Detection -   train_loss = 1.873321803410848
2024-10-05 16:24:34,002 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 16:24:34,002 - Detection -   best_eval_score = 93.18
2024-10-05 16:24:34,002 - Detection -   eval_score = 93.16
2024-10-05 16:24:34,003 - Detection -   train_loss = 1.8824739853541057
2024-10-05 16:24:36,433 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 16:24:36,434 - Detection -   best_eval_score = 93.18
2024-10-05 16:24:36,434 - Detection -   eval_score = 93.24
2024-10-05 16:24:36,434 - Detection -   train_loss = 1.8761311491330466
2024-10-05 16:24:38,864 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 16:24:38,865 - Detection -   best_eval_score = 93.24
2024-10-05 16:24:38,865 - Detection -   eval_score = 93.09
2024-10-05 16:24:38,865 - Detection -   train_loss = 1.8621792475382486
2024-10-05 16:24:41,298 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 16:24:41,298 - Detection -   best_eval_score = 93.24
2024-10-05 16:24:41,299 - Detection -   eval_score = 93.16
2024-10-05 16:24:41,299 - Detection -   train_loss = 1.8678106745084126
2024-10-05 16:24:43,726 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 16:24:43,726 - Detection -   best_eval_score = 93.24
2024-10-05 16:24:43,726 - Detection -   eval_score = 93.09
2024-10-05 16:24:43,726 - Detection -   train_loss = 1.8792204936345418
2024-10-05 16:24:46,162 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 16:24:46,162 - Detection -   best_eval_score = 93.24
2024-10-05 16:24:46,162 - Detection -   eval_score = 93.16
2024-10-05 16:24:46,162 - Detection -   train_loss = 1.8889830907185872
2024-10-05 16:24:48,622 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 16:24:48,622 - Detection -   best_eval_score = 93.24
2024-10-05 16:24:48,622 - Detection -   eval_score = 93.15
2024-10-05 16:24:48,622 - Detection -   train_loss = 1.8700635472933451
2024-10-05 16:24:51,074 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 16:24:51,074 - Detection -   best_eval_score = 93.24
2024-10-05 16:24:51,074 - Detection -   eval_score = 93.0
2024-10-05 16:24:51,074 - Detection -   train_loss = 1.8717885931332907
2024-10-05 16:24:53,525 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 16:24:53,525 - Detection -   best_eval_score = 93.24
2024-10-05 16:24:53,526 - Detection -   eval_score = 93.18
2024-10-05 16:24:53,526 - Detection -   train_loss = 1.8503208756446838
2024-10-05 16:24:55,996 - Detection - ***** Epoch: 35: Eval results *****
2024-10-05 16:24:55,996 - Detection -   best_eval_score = 93.24
2024-10-05 16:24:55,996 - Detection -   eval_score = 93.06
2024-10-05 16:24:55,996 - Detection -   train_loss = 1.8895035942395528
2024-10-05 16:24:58,435 - Detection - ***** Epoch: 36: Eval results *****
2024-10-05 16:24:58,435 - Detection -   best_eval_score = 93.24
2024-10-05 16:24:58,435 - Detection -   eval_score = 93.16
2024-10-05 16:24:58,435 - Detection -   train_loss = 1.874012823899587
2024-10-05 16:25:00,884 - Detection - ***** Epoch: 37: Eval results *****
2024-10-05 16:25:00,884 - Detection -   best_eval_score = 93.24
2024-10-05 16:25:00,884 - Detection -   eval_score = 93.0
2024-10-05 16:25:00,884 - Detection -   train_loss = 1.8687908212343851
2024-10-05 16:25:00,884 - Detection - Training Finished...
2024-10-05 16:25:00,884 - Detection - Testing begin...
2024-10-05 16:25:03,093 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 16:25:03,093 - Detection - [[  29    0    0 ...    0    0    1]
 [   0   22    0 ...    0    0    8]
 [   0    0   28 ...    0    0    2]
 ...
 [   0    0    0 ...   27    0    3]
 [   0    0    0 ...    0   25    5]
 [   2    3   43 ...    8    3 4064]]
2024-10-05 16:25:03,093 - Detection - ***** Test results *****
2024-10-05 16:25:03,093 - Detection -   Acc = 89.47
2024-10-05 16:25:03,093 - Detection -   F1 = 80.2635
2024-10-05 16:25:03,093 - Detection -   F1-known = 79.9236
2024-10-05 16:25:03,093 - Detection -   F1-open = 93.179
2024-10-05 16:25:03,093 - Detection - Testing finished...
2024-10-05 16:25:03,093 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 16:25:03,146 - Detection - ============================== Params ==============================
2024-10-05 16:25:03,146 - Detection - type:	open_intent_detection
2024-10-05 16:25:03,146 - Detection - logger_name:	Detection
2024-10-05 16:25:03,146 - Detection - log_dir:	logs
2024-10-05 16:25:03,146 - Detection - dataset:	oos
2024-10-05 16:25:03,146 - Detection - known_cls_ratio:	0.25
2024-10-05 16:25:03,146 - Detection - labeled_ratio:	1.0
2024-10-05 16:25:03,146 - Detection - method:	ADB
2024-10-05 16:25:03,146 - Detection - train:	True
2024-10-05 16:25:03,146 - Detection - tune:	True
2024-10-05 16:25:03,146 - Detection - pretrain:	True
2024-10-05 16:25:03,146 - Detection - b_train:	False
2024-10-05 16:25:03,146 - Detection - save_model:	False
2024-10-05 16:25:03,146 - Detection - backbone:	bert
2024-10-05 16:25:03,146 - Detection - config_file_name:	ADB
2024-10-05 16:25:03,146 - Detection - seed:	1
2024-10-05 16:25:03,146 - Detection - gpu_id:	0
2024-10-05 16:25:03,146 - Detection - pipe_results_path:	pipe_results
2024-10-05 16:25:03,146 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 16:25:03,146 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 16:25:03,146 - Detection - model_dir:	models
2024-10-05 16:25:03,146 - Detection - load_pretrained_method:	None
2024-10-05 16:25:03,147 - Detection - result_dir:	results
2024-10-05 16:25:03,147 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 16:25:03,147 - Detection - save_results:	True
2024-10-05 16:25:03,147 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 16:25:03,147 - Detection - dataset_neg:	SQUAD
2024-10-05 16:25:03,147 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1
2024-10-05 16:25:03,147 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1/models
2024-10-05 16:25:03,147 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 16:25:03,147 - Detection - num_train_epochs:	100
2024-10-05 16:25:03,147 - Detection - num_labels:	38
2024-10-05 16:25:03,147 - Detection - max_seq_length:	30
2024-10-05 16:25:03,147 - Detection - freeze_backbone_parameters:	True
2024-10-05 16:25:03,147 - Detection - feat_dim:	768
2024-10-05 16:25:03,147 - Detection - warmup_proportion:	0.1
2024-10-05 16:25:03,147 - Detection - lr_boundary:	0.05
2024-10-05 16:25:03,147 - Detection - lr:	2e-05
2024-10-05 16:25:03,147 - Detection - activation:	relu
2024-10-05 16:25:03,147 - Detection - train_batch_size:	128
2024-10-05 16:25:03,147 - Detection - eval_batch_size:	64
2024-10-05 16:25:03,147 - Detection - test_batch_size:	64
2024-10-05 16:25:03,147 - Detection - wait_patient:	10
2024-10-05 16:25:03,147 - Detection - safe1:	0.4
2024-10-05 16:25:03,147 - Detection - safe2:	0.4
2024-10-05 16:25:03,147 - Detection - neg_weight:	0.3
2024-10-05 16:25:03,147 - Detection - margin:	0.8
2024-10-05 16:25:03,147 - Detection - p:	2
2024-10-05 16:25:03,147 - Detection - loss_weight:	1
2024-10-05 16:25:03,147 - Detection - supcon_loss_weight:	0.7
2024-10-05 16:25:03,147 - Detection - triplet_loss_weight:	0.9
2024-10-05 16:25:03,147 - Detection - unseen_label_id:	38
2024-10-05 16:25:03,147 - Detection - anum_labels:	39
2024-10-05 16:25:03,147 - Detection - device:	cuda:0
2024-10-05 16:25:03,147 - Detection - ============================== End Params ==============================
2024-10-05 16:25:04,175 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 16:25:04,221 - Detection - Pre-training Begin...
2024-10-05 16:25:08,770 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 16:25:08,770 - Detection -   best_eval_score = 0
2024-10-05 16:25:08,770 - Detection -   eval_score = 2.63
2024-10-05 16:25:08,770 - Detection -   train_loss = 8.840952650705974
2024-10-05 16:25:13,394 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 16:25:13,394 - Detection -   best_eval_score = 2.63
2024-10-05 16:25:13,394 - Detection -   eval_score = 2.37
2024-10-05 16:25:13,394 - Detection -   train_loss = 8.413834857940675
2024-10-05 16:25:17,926 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 16:25:17,926 - Detection -   best_eval_score = 2.63
2024-10-05 16:25:17,926 - Detection -   eval_score = 5.92
2024-10-05 16:25:17,926 - Detection -   train_loss = 8.04676472345988
2024-10-05 16:25:22,574 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 16:25:22,575 - Detection -   best_eval_score = 5.92
2024-10-05 16:25:22,575 - Detection -   eval_score = 12.24
2024-10-05 16:25:22,575 - Detection -   train_loss = 7.524816433588664
2024-10-05 16:25:27,089 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 16:25:27,089 - Detection -   best_eval_score = 12.24
2024-10-05 16:25:27,089 - Detection -   eval_score = 19.34
2024-10-05 16:25:27,089 - Detection -   train_loss = 7.21731653213501
2024-10-05 16:25:31,634 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 16:25:31,634 - Detection -   best_eval_score = 19.34
2024-10-05 16:25:31,634 - Detection -   eval_score = 29.21
2024-10-05 16:25:31,634 - Detection -   train_loss = 6.971635357538859
2024-10-05 16:25:36,246 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 16:25:36,246 - Detection -   best_eval_score = 29.21
2024-10-05 16:25:36,246 - Detection -   eval_score = 43.68
2024-10-05 16:25:36,246 - Detection -   train_loss = 6.714383459091186
2024-10-05 16:25:40,827 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 16:25:40,827 - Detection -   best_eval_score = 43.68
2024-10-05 16:25:40,827 - Detection -   eval_score = 62.5
2024-10-05 16:25:40,828 - Detection -   train_loss = 6.4482379913330075
2024-10-05 16:25:45,408 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 16:25:45,409 - Detection -   best_eval_score = 62.5
2024-10-05 16:25:45,409 - Detection -   eval_score = 78.82
2024-10-05 16:25:45,409 - Detection -   train_loss = 6.101870743433635
2024-10-05 16:25:49,924 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 16:25:49,924 - Detection -   best_eval_score = 78.82
2024-10-05 16:25:49,924 - Detection -   eval_score = 89.47
2024-10-05 16:25:49,924 - Detection -   train_loss = 5.669815174738566
2024-10-05 16:25:54,524 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 16:25:54,524 - Detection -   best_eval_score = 89.47
2024-10-05 16:25:54,524 - Detection -   eval_score = 93.03
2024-10-05 16:25:54,524 - Detection -   train_loss = 5.1719528039296465
2024-10-05 16:25:58,977 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 16:25:58,977 - Detection -   best_eval_score = 93.03
2024-10-05 16:25:58,977 - Detection -   eval_score = 95.66
2024-10-05 16:25:58,977 - Detection -   train_loss = 4.566092046101888
2024-10-05 16:26:03,441 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 16:26:03,441 - Detection -   best_eval_score = 95.66
2024-10-05 16:26:03,441 - Detection -   eval_score = 96.32
2024-10-05 16:26:03,441 - Detection -   train_loss = 4.017891518274943
2024-10-05 16:26:07,897 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 16:26:07,897 - Detection -   best_eval_score = 96.32
2024-10-05 16:26:07,897 - Detection -   eval_score = 97.11
2024-10-05 16:26:07,897 - Detection -   train_loss = 3.5873610893885295
2024-10-05 16:26:12,371 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 16:26:12,371 - Detection -   best_eval_score = 97.11
2024-10-05 16:26:12,371 - Detection -   eval_score = 97.24
2024-10-05 16:26:12,371 - Detection -   train_loss = 3.2240941762924193
2024-10-05 16:26:16,869 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 16:26:16,869 - Detection -   best_eval_score = 97.24
2024-10-05 16:26:16,869 - Detection -   eval_score = 97.63
2024-10-05 16:26:16,869 - Detection -   train_loss = 2.9790993372599286
2024-10-05 16:26:21,476 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 16:26:21,476 - Detection -   best_eval_score = 97.63
2024-10-05 16:26:21,476 - Detection -   eval_score = 97.76
2024-10-05 16:26:21,476 - Detection -   train_loss = 2.7947305917739866
2024-10-05 16:26:26,032 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 16:26:26,032 - Detection -   best_eval_score = 97.76
2024-10-05 16:26:26,033 - Detection -   eval_score = 97.76
2024-10-05 16:26:26,033 - Detection -   train_loss = 2.6950417280197145
2024-10-05 16:26:30,534 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 16:26:30,534 - Detection -   best_eval_score = 97.76
2024-10-05 16:26:30,534 - Detection -   eval_score = 97.63
2024-10-05 16:26:30,534 - Detection -   train_loss = 2.6019296646118164
2024-10-05 16:26:35,022 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 16:26:35,022 - Detection -   best_eval_score = 97.76
2024-10-05 16:26:35,022 - Detection -   eval_score = 97.76
2024-10-05 16:26:35,022 - Detection -   train_loss = 2.5354123592376707
2024-10-05 16:26:39,634 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 16:26:39,634 - Detection -   best_eval_score = 97.76
2024-10-05 16:26:39,634 - Detection -   eval_score = 98.16
2024-10-05 16:26:39,634 - Detection -   train_loss = 2.46728568871816
2024-10-05 16:26:44,188 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 16:26:44,188 - Detection -   best_eval_score = 98.16
2024-10-05 16:26:44,188 - Detection -   eval_score = 98.03
2024-10-05 16:26:44,188 - Detection -   train_loss = 2.4311756610870363
2024-10-05 16:26:48,704 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 16:26:48,704 - Detection -   best_eval_score = 98.16
2024-10-05 16:26:48,704 - Detection -   eval_score = 98.16
2024-10-05 16:26:48,704 - Detection -   train_loss = 2.4038280884424847
2024-10-05 16:26:53,203 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 16:26:53,203 - Detection -   best_eval_score = 98.16
2024-10-05 16:26:53,203 - Detection -   eval_score = 98.16
2024-10-05 16:26:53,203 - Detection -   train_loss = 2.3619471629460653
2024-10-05 16:26:57,687 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 16:26:57,687 - Detection -   best_eval_score = 98.16
2024-10-05 16:26:57,687 - Detection -   eval_score = 98.29
2024-10-05 16:26:57,687 - Detection -   train_loss = 2.33579793771108
2024-10-05 16:27:02,203 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 16:27:02,203 - Detection -   best_eval_score = 98.29
2024-10-05 16:27:02,204 - Detection -   eval_score = 98.16
2024-10-05 16:27:02,204 - Detection -   train_loss = 2.318979581197103
2024-10-05 16:27:06,737 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 16:27:06,737 - Detection -   best_eval_score = 98.29
2024-10-05 16:27:06,737 - Detection -   eval_score = 98.16
2024-10-05 16:27:06,737 - Detection -   train_loss = 2.3101202567418415
2024-10-05 16:27:11,217 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 16:27:11,217 - Detection -   best_eval_score = 98.29
2024-10-05 16:27:11,217 - Detection -   eval_score = 98.16
2024-10-05 16:27:11,217 - Detection -   train_loss = 2.2800166249275207
2024-10-05 16:27:15,820 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 16:27:15,820 - Detection -   best_eval_score = 98.29
2024-10-05 16:27:15,820 - Detection -   eval_score = 98.29
2024-10-05 16:27:15,820 - Detection -   train_loss = 2.265408253669739
2024-10-05 16:27:20,311 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 16:27:20,312 - Detection -   best_eval_score = 98.29
2024-10-05 16:27:20,312 - Detection -   eval_score = 98.29
2024-10-05 16:27:20,312 - Detection -   train_loss = 2.2664974093437196
2024-10-05 16:27:24,773 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 16:27:24,773 - Detection -   best_eval_score = 98.29
2024-10-05 16:27:24,773 - Detection -   eval_score = 98.42
2024-10-05 16:27:24,773 - Detection -   train_loss = 2.2559389591217043
2024-10-05 16:27:29,267 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 16:27:29,267 - Detection -   best_eval_score = 98.42
2024-10-05 16:27:29,267 - Detection -   eval_score = 98.29
2024-10-05 16:27:29,267 - Detection -   train_loss = 2.2376607497533163
2024-10-05 16:27:33,780 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 16:27:33,780 - Detection -   best_eval_score = 98.42
2024-10-05 16:27:33,780 - Detection -   eval_score = 98.42
2024-10-05 16:27:33,780 - Detection -   train_loss = 2.230059504508972
2024-10-05 16:27:38,286 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 16:27:38,286 - Detection -   best_eval_score = 98.42
2024-10-05 16:27:38,286 - Detection -   eval_score = 98.16
2024-10-05 16:27:38,286 - Detection -   train_loss = 2.2156099557876585
2024-10-05 16:27:42,765 - Detection - ***** Epoch: 35: Eval results *****
2024-10-05 16:27:42,765 - Detection -   best_eval_score = 98.42
2024-10-05 16:27:42,765 - Detection -   eval_score = 98.16
2024-10-05 16:27:42,765 - Detection -   train_loss = 2.2101656516393025
2024-10-05 16:27:47,212 - Detection - ***** Epoch: 36: Eval results *****
2024-10-05 16:27:47,212 - Detection -   best_eval_score = 98.42
2024-10-05 16:27:47,213 - Detection -   eval_score = 98.16
2024-10-05 16:27:47,213 - Detection -   train_loss = 2.1993439555168153
2024-10-05 16:27:51,728 - Detection - ***** Epoch: 37: Eval results *****
2024-10-05 16:27:51,728 - Detection -   best_eval_score = 98.42
2024-10-05 16:27:51,728 - Detection -   eval_score = 98.42
2024-10-05 16:27:51,728 - Detection -   train_loss = 2.196841474374135
2024-10-05 16:27:56,183 - Detection - ***** Epoch: 38: Eval results *****
2024-10-05 16:27:56,183 - Detection -   best_eval_score = 98.42
2024-10-05 16:27:56,183 - Detection -   eval_score = 98.42
2024-10-05 16:27:56,183 - Detection -   train_loss = 2.1862257440884907
2024-10-05 16:28:00,629 - Detection - ***** Epoch: 39: Eval results *****
2024-10-05 16:28:00,629 - Detection -   best_eval_score = 98.42
2024-10-05 16:28:00,629 - Detection -   eval_score = 98.42
2024-10-05 16:28:00,629 - Detection -   train_loss = 2.188224736849467
2024-10-05 16:28:05,100 - Detection - ***** Epoch: 40: Eval results *****
2024-10-05 16:28:05,101 - Detection -   best_eval_score = 98.42
2024-10-05 16:28:05,101 - Detection -   eval_score = 98.29
2024-10-05 16:28:05,101 - Detection -   train_loss = 2.1765384395917255
2024-10-05 16:28:09,707 - Detection - ***** Epoch: 41: Eval results *****
2024-10-05 16:28:09,707 - Detection -   best_eval_score = 98.42
2024-10-05 16:28:09,707 - Detection -   eval_score = 98.16
2024-10-05 16:28:09,707 - Detection -   train_loss = 2.167403817176819
2024-10-05 16:28:09,708 - Detection - Pre-training finished...
2024-10-05 16:28:09,709 - Detection - Training Begin...
2024-10-05 16:28:15,192 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 16:28:15,193 - Detection -   best_eval_score = 0
2024-10-05 16:28:15,193 - Detection -   eval_score = 0.24
2024-10-05 16:28:15,193 - Detection -   train_loss = 9.026920159657797
2024-10-05 16:28:17,621 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 16:28:17,621 - Detection -   best_eval_score = 0.24
2024-10-05 16:28:17,621 - Detection -   eval_score = 19.91
2024-10-05 16:28:17,621 - Detection -   train_loss = 7.62551391919454
2024-10-05 16:28:20,053 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 16:28:20,053 - Detection -   best_eval_score = 19.91
2024-10-05 16:28:20,053 - Detection -   eval_score = 61.62
2024-10-05 16:28:20,053 - Detection -   train_loss = 5.798762512207031
2024-10-05 16:28:22,500 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 16:28:22,500 - Detection -   best_eval_score = 61.62
2024-10-05 16:28:22,500 - Detection -   eval_score = 83.49
2024-10-05 16:28:22,500 - Detection -   train_loss = 3.7961065689722697
2024-10-05 16:28:24,941 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 16:28:24,941 - Detection -   best_eval_score = 83.49
2024-10-05 16:28:24,941 - Detection -   eval_score = 90.19
2024-10-05 16:28:24,941 - Detection -   train_loss = 2.157428479194641
2024-10-05 16:28:27,368 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 16:28:27,369 - Detection -   best_eval_score = 90.19
2024-10-05 16:28:27,369 - Detection -   eval_score = 92.4
2024-10-05 16:28:27,369 - Detection -   train_loss = 1.3741926749547322
2024-10-05 16:28:29,808 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 16:28:29,808 - Detection -   best_eval_score = 92.4
2024-10-05 16:28:29,808 - Detection -   eval_score = 92.56
2024-10-05 16:28:29,808 - Detection -   train_loss = 1.2820180575052897
2024-10-05 16:28:32,241 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 16:28:32,241 - Detection -   best_eval_score = 92.56
2024-10-05 16:28:32,241 - Detection -   eval_score = 92.56
2024-10-05 16:28:32,241 - Detection -   train_loss = 1.2888455311457316
2024-10-05 16:28:34,680 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 16:28:34,680 - Detection -   best_eval_score = 92.56
2024-10-05 16:28:34,680 - Detection -   eval_score = 92.56
2024-10-05 16:28:34,681 - Detection -   train_loss = 1.279128336906433
2024-10-05 16:28:37,105 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 16:28:37,105 - Detection -   best_eval_score = 92.56
2024-10-05 16:28:37,105 - Detection -   eval_score = 92.56
2024-10-05 16:28:37,105 - Detection -   train_loss = 1.2769560496012369
2024-10-05 16:28:39,555 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 16:28:39,555 - Detection -   best_eval_score = 92.56
2024-10-05 16:28:39,555 - Detection -   eval_score = 92.56
2024-10-05 16:28:39,555 - Detection -   train_loss = 1.2743354241053264
2024-10-05 16:28:41,991 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 16:28:41,992 - Detection -   best_eval_score = 92.56
2024-10-05 16:28:41,992 - Detection -   eval_score = 92.56
2024-10-05 16:28:41,992 - Detection -   train_loss = 1.2835315903027853
2024-10-05 16:28:44,421 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 16:28:44,422 - Detection -   best_eval_score = 92.56
2024-10-05 16:28:44,422 - Detection -   eval_score = 92.56
2024-10-05 16:28:44,422 - Detection -   train_loss = 1.280115556716919
2024-10-05 16:28:46,842 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 16:28:46,843 - Detection -   best_eval_score = 92.56
2024-10-05 16:28:46,843 - Detection -   eval_score = 92.56
2024-10-05 16:28:46,843 - Detection -   train_loss = 1.2798632462819417
2024-10-05 16:28:49,275 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 16:28:49,276 - Detection -   best_eval_score = 92.56
2024-10-05 16:28:49,276 - Detection -   eval_score = 92.56
2024-10-05 16:28:49,276 - Detection -   train_loss = 1.286689813931783
2024-10-05 16:28:51,712 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 16:28:51,712 - Detection -   best_eval_score = 92.56
2024-10-05 16:28:51,712 - Detection -   eval_score = 92.41
2024-10-05 16:28:51,712 - Detection -   train_loss = 1.2885185559590657
2024-10-05 16:28:54,143 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 16:28:54,143 - Detection -   best_eval_score = 92.56
2024-10-05 16:28:54,143 - Detection -   eval_score = 92.49
2024-10-05 16:28:54,143 - Detection -   train_loss = 1.273612097899119
2024-10-05 16:28:54,144 - Detection - Training Finished...
2024-10-05 16:28:54,144 - Detection - Testing begin...
2024-10-05 16:28:56,344 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 16:28:56,345 - Detection - [[  29    0    0 ...    0    0    1]
 [   0   22    0 ...    0    0    8]
 [   0    0   27 ...    0    0    3]
 ...
 [   0    0    0 ...   27    0    3]
 [   0    0    0 ...    0   25    5]
 [   2    3   27 ...    8    3 4145]]
2024-10-05 16:28:56,345 - Detection - ***** Test results *****
2024-10-05 16:28:56,345 - Detection -   Acc = 90.63
2024-10-05 16:28:56,345 - Detection -   F1 = 81.2431
2024-10-05 16:28:56,345 - Detection -   F1-known = 80.9076
2024-10-05 16:28:56,345 - Detection -   F1-open = 93.9909
2024-10-05 16:28:56,345 - Detection - Testing finished...
2024-10-05 16:28:56,345 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 16:28:56,379 - Detection - ============================== Params ==============================
2024-10-05 16:28:56,379 - Detection - type:	open_intent_detection
2024-10-05 16:28:56,379 - Detection - logger_name:	Detection
2024-10-05 16:28:56,379 - Detection - log_dir:	logs
2024-10-05 16:28:56,379 - Detection - dataset:	oos
2024-10-05 16:28:56,379 - Detection - known_cls_ratio:	0.25
2024-10-05 16:28:56,379 - Detection - labeled_ratio:	1.0
2024-10-05 16:28:56,379 - Detection - method:	ADB
2024-10-05 16:28:56,379 - Detection - train:	True
2024-10-05 16:28:56,379 - Detection - tune:	True
2024-10-05 16:28:56,379 - Detection - pretrain:	True
2024-10-05 16:28:56,379 - Detection - b_train:	False
2024-10-05 16:28:56,379 - Detection - save_model:	False
2024-10-05 16:28:56,379 - Detection - backbone:	bert
2024-10-05 16:28:56,379 - Detection - config_file_name:	ADB
2024-10-05 16:28:56,379 - Detection - seed:	1
2024-10-05 16:28:56,379 - Detection - gpu_id:	0
2024-10-05 16:28:56,380 - Detection - pipe_results_path:	pipe_results
2024-10-05 16:28:56,380 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 16:28:56,380 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 16:28:56,380 - Detection - model_dir:	models
2024-10-05 16:28:56,380 - Detection - load_pretrained_method:	None
2024-10-05 16:28:56,380 - Detection - result_dir:	results
2024-10-05 16:28:56,380 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 16:28:56,380 - Detection - save_results:	True
2024-10-05 16:28:56,380 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 16:28:56,380 - Detection - dataset_neg:	SQUAD
2024-10-05 16:28:56,380 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1
2024-10-05 16:28:56,380 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_1/models
2024-10-05 16:28:56,380 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 16:28:56,380 - Detection - num_train_epochs:	100
2024-10-05 16:28:56,380 - Detection - num_labels:	38
2024-10-05 16:28:56,380 - Detection - max_seq_length:	30
2024-10-05 16:28:56,380 - Detection - freeze_backbone_parameters:	True
2024-10-05 16:28:56,380 - Detection - feat_dim:	768
2024-10-05 16:28:56,380 - Detection - warmup_proportion:	0.1
2024-10-05 16:28:56,380 - Detection - lr_boundary:	0.05
2024-10-05 16:28:56,380 - Detection - lr:	2e-05
2024-10-05 16:28:56,380 - Detection - activation:	relu
2024-10-05 16:28:56,380 - Detection - train_batch_size:	128
2024-10-05 16:28:56,380 - Detection - eval_batch_size:	64
2024-10-05 16:28:56,380 - Detection - test_batch_size:	64
2024-10-05 16:28:56,380 - Detection - wait_patient:	10
2024-10-05 16:28:56,380 - Detection - safe1:	0.4
2024-10-05 16:28:56,380 - Detection - safe2:	0.4
2024-10-05 16:28:56,380 - Detection - neg_weight:	0.5
2024-10-05 16:28:56,380 - Detection - margin:	0.8
2024-10-05 16:28:56,380 - Detection - p:	2
2024-10-05 16:28:56,380 - Detection - loss_weight:	1
2024-10-05 16:28:56,380 - Detection - supcon_loss_weight:	0.7
2024-10-05 16:28:56,380 - Detection - triplet_loss_weight:	0.9
2024-10-05 16:28:56,380 - Detection - unseen_label_id:	38
2024-10-05 16:28:56,380 - Detection - anum_labels:	39
2024-10-05 16:28:56,380 - Detection - device:	cuda:0
2024-10-05 16:28:56,380 - Detection - ============================== End Params ==============================
2024-10-05 16:28:57,394 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 16:28:57,440 - Detection - Pre-training Begin...
2024-10-05 16:29:02,140 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 16:29:02,140 - Detection -   best_eval_score = 0
2024-10-05 16:29:02,140 - Detection -   eval_score = 2.63
2024-10-05 16:29:02,140 - Detection -   train_loss = 8.840952650705974
2024-10-05 16:29:06,836 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 16:29:06,836 - Detection -   best_eval_score = 2.63
2024-10-05 16:29:06,836 - Detection -   eval_score = 2.37
2024-10-05 16:29:06,836 - Detection -   train_loss = 8.413834857940675
2024-10-05 16:29:11,626 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 16:29:11,626 - Detection -   best_eval_score = 2.63
2024-10-05 16:29:11,626 - Detection -   eval_score = 5.92
2024-10-05 16:29:11,626 - Detection -   train_loss = 8.04676472345988
2024-10-05 16:29:16,162 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 16:29:16,162 - Detection -   best_eval_score = 5.92
2024-10-05 16:29:16,162 - Detection -   eval_score = 12.24
2024-10-05 16:29:16,162 - Detection -   train_loss = 7.524816433588664
