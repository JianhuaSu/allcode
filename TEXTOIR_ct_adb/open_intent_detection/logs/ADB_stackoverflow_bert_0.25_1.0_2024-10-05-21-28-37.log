2024-10-05 21:28:37,830 - Detection - Open Intent Detection Begin...
2024-10-05 21:28:37,831 - Detection - Parameters Initialization...
2024-10-05 21:28:37,831 - Detection - Data and Model Preparation...
2024-10-05 21:28:37,831 - Detection - The number of known intents is 5
2024-10-05 21:28:37,831 - Detection - Lists of known labels are: ['wordpress', 'cocoa', 'visual-studio', 'haskell', 'qt']
2024-10-05 21:28:37,870 - Detection - Number of labeled training samples = 3000
2024-10-05 21:28:37,870 - Detection - Number of unlabeled training samples = 9000
2024-10-05 21:28:37,875 - Detection - Number of evaluation samples = 500
2024-10-05 21:28:37,890 - Detection - Number of testing samples = 6000
2024-10-05 21:28:42,914 - Detection - ============================== Params ==============================
2024-10-05 21:28:42,914 - Detection - type:	open_intent_detection
2024-10-05 21:28:42,914 - Detection - logger_name:	Detection
2024-10-05 21:28:42,914 - Detection - log_dir:	logs
2024-10-05 21:28:42,914 - Detection - dataset:	stackoverflow
2024-10-05 21:28:42,915 - Detection - known_cls_ratio:	0.25
2024-10-05 21:28:42,915 - Detection - labeled_ratio:	1.0
2024-10-05 21:28:42,915 - Detection - method:	ADB
2024-10-05 21:28:42,915 - Detection - train:	True
2024-10-05 21:28:42,915 - Detection - tune:	True
2024-10-05 21:28:42,915 - Detection - pretrain:	True
2024-10-05 21:28:42,915 - Detection - b_train:	False
2024-10-05 21:28:42,915 - Detection - save_model:	False
2024-10-05 21:28:42,915 - Detection - backbone:	bert
2024-10-05 21:28:42,915 - Detection - config_file_name:	ADB
2024-10-05 21:28:42,915 - Detection - seed:	4
2024-10-05 21:28:42,915 - Detection - gpu_id:	0
2024-10-05 21:28:42,915 - Detection - pipe_results_path:	pipe_results
2024-10-05 21:28:42,915 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 21:28:42,915 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 21:28:42,915 - Detection - model_dir:	models
2024-10-05 21:28:42,915 - Detection - load_pretrained_method:	None
2024-10-05 21:28:42,915 - Detection - result_dir:	results
2024-10-05 21:28:42,915 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 21:28:42,915 - Detection - save_results:	True
2024-10-05 21:28:42,915 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 21:28:42,915 - Detection - dataset_neg:	SQUAD
2024-10-05 21:28:42,915 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_4
2024-10-05 21:28:42,915 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_stackoverflow_0.25_1.0_bert_4/models
2024-10-05 21:28:42,915 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 21:28:42,915 - Detection - num_train_epochs:	100
2024-10-05 21:28:42,915 - Detection - num_labels:	5
2024-10-05 21:28:42,915 - Detection - max_seq_length:	45
2024-10-05 21:28:42,915 - Detection - freeze_backbone_parameters:	True
2024-10-05 21:28:42,915 - Detection - feat_dim:	768
2024-10-05 21:28:42,915 - Detection - warmup_proportion:	0.1
2024-10-05 21:28:42,915 - Detection - lr_boundary:	0.05
2024-10-05 21:28:42,915 - Detection - lr:	2e-05
2024-10-05 21:28:42,915 - Detection - activation:	relu
2024-10-05 21:28:42,915 - Detection - train_batch_size:	128
2024-10-05 21:28:42,915 - Detection - eval_batch_size:	64
2024-10-05 21:28:42,915 - Detection - test_batch_size:	64
2024-10-05 21:28:42,915 - Detection - wait_patient:	10
2024-10-05 21:28:42,915 - Detection - safe1:	0.7
2024-10-05 21:28:42,916 - Detection - safe2:	0.9
2024-10-05 21:28:42,916 - Detection - neg_weight:	0.1
2024-10-05 21:28:42,916 - Detection - margin:	0.4
2024-10-05 21:28:42,916 - Detection - p:	2
2024-10-05 21:28:42,916 - Detection - loss_weight:	1
2024-10-05 21:28:42,916 - Detection - supcon_loss_weight:	0.3
2024-10-05 21:28:42,916 - Detection - triplet_loss_weight:	0.2
2024-10-05 21:28:42,916 - Detection - unseen_label_id:	5
2024-10-05 21:28:42,916 - Detection - anum_labels:	6
2024-10-05 21:28:42,916 - Detection - ============================== End Params ==============================
2024-10-05 21:28:44,136 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 21:28:45,243 - Detection - Pre-training Begin...
2024-10-05 21:28:50,229 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 21:28:50,229 - Detection -   best_eval_score = 0
2024-10-05 21:28:50,229 - Detection -   eval_score = 25.0
2024-10-05 21:28:50,229 - Detection -   train_loss = 3.7086695432662964
2024-10-05 21:28:54,495 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 21:28:54,495 - Detection -   best_eval_score = 25.0
2024-10-05 21:28:54,495 - Detection -   eval_score = 28.4
2024-10-05 21:28:54,496 - Detection -   train_loss = 3.514054000377655
2024-10-05 21:28:58,779 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 21:28:58,779 - Detection -   best_eval_score = 28.4
2024-10-05 21:28:58,779 - Detection -   eval_score = 30.2
2024-10-05 21:28:58,779 - Detection -   train_loss = 3.477072815100352
2024-10-05 21:29:03,082 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 21:29:03,082 - Detection -   best_eval_score = 30.2
2024-10-05 21:29:03,083 - Detection -   eval_score = 38.0
2024-10-05 21:29:03,083 - Detection -   train_loss = 3.432570884625117
2024-10-05 21:29:07,439 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 21:29:07,439 - Detection -   best_eval_score = 38.0
2024-10-05 21:29:07,439 - Detection -   eval_score = 54.6
2024-10-05 21:29:07,439 - Detection -   train_loss = 3.351445565621058
2024-10-05 21:29:11,735 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 21:29:11,736 - Detection -   best_eval_score = 54.6
2024-10-05 21:29:11,736 - Detection -   eval_score = 72.4
2024-10-05 21:29:11,736 - Detection -   train_loss = 3.1716670989990234
2024-10-05 21:29:16,030 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 21:29:16,030 - Detection -   best_eval_score = 72.4
2024-10-05 21:29:16,030 - Detection -   eval_score = 86.2
2024-10-05 21:29:16,030 - Detection -   train_loss = 2.9304387668768563
2024-10-05 21:29:20,318 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 21:29:20,319 - Detection -   best_eval_score = 86.2
2024-10-05 21:29:20,319 - Detection -   eval_score = 88.0
2024-10-05 21:29:20,319 - Detection -   train_loss = 2.655227482318878
2024-10-05 21:29:24,616 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 21:29:24,617 - Detection -   best_eval_score = 88.0
2024-10-05 21:29:24,617 - Detection -   eval_score = 89.6
2024-10-05 21:29:24,617 - Detection -   train_loss = 2.3528396785259247
2024-10-05 21:29:28,914 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 21:29:28,914 - Detection -   best_eval_score = 89.6
2024-10-05 21:29:28,914 - Detection -   eval_score = 90.4
2024-10-05 21:29:28,914 - Detection -   train_loss = 2.154440845052401
2024-10-05 21:29:33,210 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 21:29:33,210 - Detection -   best_eval_score = 90.4
2024-10-05 21:29:33,210 - Detection -   eval_score = 90.8
2024-10-05 21:29:33,210 - Detection -   train_loss = 2.013626436392466
2024-10-05 21:29:37,509 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 21:29:37,509 - Detection -   best_eval_score = 90.8
2024-10-05 21:29:37,509 - Detection -   eval_score = 91.2
2024-10-05 21:29:37,509 - Detection -   train_loss = 1.9164899587631226
2024-10-05 21:29:41,884 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 21:29:41,884 - Detection -   best_eval_score = 91.2
2024-10-05 21:29:41,884 - Detection -   eval_score = 90.8
2024-10-05 21:29:41,884 - Detection -   train_loss = 1.8729961266120274
2024-10-05 21:29:46,150 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 21:29:46,150 - Detection -   best_eval_score = 91.2
2024-10-05 21:29:46,150 - Detection -   eval_score = 91.4
2024-10-05 21:29:46,150 - Detection -   train_loss = 1.7959090322256088
2024-10-05 21:29:50,453 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 21:29:50,453 - Detection -   best_eval_score = 91.4
2024-10-05 21:29:50,453 - Detection -   eval_score = 91.6
2024-10-05 21:29:50,453 - Detection -   train_loss = 1.7401556819677353
2024-10-05 21:29:54,764 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 21:29:54,765 - Detection -   best_eval_score = 91.6
2024-10-05 21:29:54,765 - Detection -   eval_score = 92.4
2024-10-05 21:29:54,765 - Detection -   train_loss = 1.6771422028541565
2024-10-05 21:29:59,067 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 21:29:59,067 - Detection -   best_eval_score = 92.4
2024-10-05 21:29:59,067 - Detection -   eval_score = 92.0
2024-10-05 21:29:59,067 - Detection -   train_loss = 1.6390481839577358
2024-10-05 21:30:03,332 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 21:30:03,332 - Detection -   best_eval_score = 92.4
2024-10-05 21:30:03,332 - Detection -   eval_score = 92.0
2024-10-05 21:30:03,332 - Detection -   train_loss = 1.5927634686231613
2024-10-05 21:30:07,603 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 21:30:07,603 - Detection -   best_eval_score = 92.4
2024-10-05 21:30:07,603 - Detection -   eval_score = 91.8
2024-10-05 21:30:07,603 - Detection -   train_loss = 1.564618890484174
2024-10-05 21:30:11,882 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 21:30:11,882 - Detection -   best_eval_score = 92.4
2024-10-05 21:30:11,883 - Detection -   eval_score = 91.6
2024-10-05 21:30:11,883 - Detection -   train_loss = 1.5096647640069325
2024-10-05 21:30:16,161 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 21:30:16,161 - Detection -   best_eval_score = 92.4
2024-10-05 21:30:16,162 - Detection -   eval_score = 91.2
2024-10-05 21:30:16,162 - Detection -   train_loss = 1.5159636338551838
2024-10-05 21:30:20,476 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 21:30:20,476 - Detection -   best_eval_score = 92.4
2024-10-05 21:30:20,476 - Detection -   eval_score = 91.8
2024-10-05 21:30:20,476 - Detection -   train_loss = 1.4692328075567882
2024-10-05 21:30:24,755 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 21:30:24,755 - Detection -   best_eval_score = 92.4
2024-10-05 21:30:24,755 - Detection -   eval_score = 91.8
2024-10-05 21:30:24,755 - Detection -   train_loss = 1.4270736624797185
2024-10-05 21:30:29,042 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 21:30:29,042 - Detection -   best_eval_score = 92.4
2024-10-05 21:30:29,042 - Detection -   eval_score = 92.0
2024-10-05 21:30:29,042 - Detection -   train_loss = 1.4354048271973927
2024-10-05 21:30:33,341 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 21:30:33,341 - Detection -   best_eval_score = 92.4
2024-10-05 21:30:33,341 - Detection -   eval_score = 91.6
2024-10-05 21:30:33,342 - Detection -   train_loss = 1.4040739685297012
2024-10-05 21:30:37,698 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 21:30:37,698 - Detection -   best_eval_score = 92.4
2024-10-05 21:30:37,699 - Detection -   eval_score = 92.0
2024-10-05 21:30:37,699 - Detection -   train_loss = 1.3986459920803707
2024-10-05 21:30:37,699 - Detection - Pre-training finished...
2024-10-05 21:30:37,700 - Detection - Training Begin...
2024-10-05 21:30:46,907 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 21:30:46,907 - Detection -   best_eval_score = 0
2024-10-05 21:30:46,908 - Detection -   eval_score = 23.53
2024-10-05 21:30:46,908 - Detection -   train_loss = 3.6866160730520883
2024-10-05 21:30:52,880 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 21:30:52,881 - Detection -   best_eval_score = 23.53
2024-10-05 21:30:52,881 - Detection -   eval_score = 47.18
2024-10-05 21:30:52,881 - Detection -   train_loss = 2.561149204770724
2024-10-05 21:30:58,632 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 21:30:58,632 - Detection -   best_eval_score = 47.18
2024-10-05 21:30:58,632 - Detection -   eval_score = 72.74
2024-10-05 21:30:58,632 - Detection -   train_loss = 1.4509011854728062
2024-10-05 21:31:04,525 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 21:31:04,525 - Detection -   best_eval_score = 72.74
2024-10-05 21:31:04,525 - Detection -   eval_score = 74.08
2024-10-05 21:31:04,525 - Detection -   train_loss = 0.9567328914999962
2024-10-05 21:31:10,403 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 21:31:10,403 - Detection -   best_eval_score = 74.08
2024-10-05 21:31:10,403 - Detection -   eval_score = 73.75
2024-10-05 21:31:10,403 - Detection -   train_loss = 0.930316594739755
2024-10-05 21:31:16,270 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 21:31:16,270 - Detection -   best_eval_score = 74.08
2024-10-05 21:31:16,270 - Detection -   eval_score = 73.82
2024-10-05 21:31:16,270 - Detection -   train_loss = 0.9296983927488327
2024-10-05 21:31:22,149 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 21:31:22,149 - Detection -   best_eval_score = 74.08
2024-10-05 21:31:22,149 - Detection -   eval_score = 73.82
2024-10-05 21:31:22,149 - Detection -   train_loss = 0.9325898314515749
2024-10-05 21:31:28,034 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 21:31:28,034 - Detection -   best_eval_score = 74.08
2024-10-05 21:31:28,034 - Detection -   eval_score = 73.8
2024-10-05 21:31:28,034 - Detection -   train_loss = 0.9301275362571081
2024-10-05 21:31:33,920 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 21:31:33,920 - Detection -   best_eval_score = 74.08
2024-10-05 21:31:33,920 - Detection -   eval_score = 73.75
2024-10-05 21:31:33,920 - Detection -   train_loss = 0.9300886119405428
2024-10-05 21:31:39,785 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 21:31:39,785 - Detection -   best_eval_score = 74.08
2024-10-05 21:31:39,785 - Detection -   eval_score = 73.8
2024-10-05 21:31:39,785 - Detection -   train_loss = 0.9214891244967779
2024-10-05 21:31:45,626 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 21:31:45,626 - Detection -   best_eval_score = 74.08
2024-10-05 21:31:45,626 - Detection -   eval_score = 74.05
2024-10-05 21:31:45,627 - Detection -   train_loss = 0.9321352938810984
2024-10-05 21:31:51,474 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 21:31:51,474 - Detection -   best_eval_score = 74.08
2024-10-05 21:31:51,474 - Detection -   eval_score = 73.9
2024-10-05 21:31:51,475 - Detection -   train_loss = 0.92373193303744
2024-10-05 21:31:57,297 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 21:31:57,297 - Detection -   best_eval_score = 74.08
2024-10-05 21:31:57,297 - Detection -   eval_score = 73.75
2024-10-05 21:31:57,297 - Detection -   train_loss = 0.9190496553977331
2024-10-05 21:32:03,131 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 21:32:03,132 - Detection -   best_eval_score = 74.08
2024-10-05 21:32:03,132 - Detection -   eval_score = 74.01
2024-10-05 21:32:03,132 - Detection -   train_loss = 0.9113555252552032
2024-10-05 21:32:03,141 - Detection - Training Finished...
2024-10-05 21:32:03,141 - Detection - Testing begin...
2024-10-05 21:32:06,451 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 21:32:06,451 - Detection - [[ 263    0    0    0    0   37]
 [   0  238    0    0    5   57]
 [   0    5  232    0    0   63]
 [   0    2    1  234    0   63]
 [   0    2    0    0  278   20]
 [  11  709   85   79    5 3611]]
2024-10-05 21:32:06,451 - Detection - ***** Test results *****
2024-10-05 21:32:06,451 - Detection -   Acc = 80.93
2024-10-05 21:32:06,451 - Detection -   F1 = 77.0002
2024-10-05 21:32:06,451 - Detection -   F1-known = 75.1041
2024-10-05 21:32:06,451 - Detection -   F1-open = 86.4807
2024-10-05 21:32:06,451 - Detection - Testing finished...
2024-10-05 21:32:06,451 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 21:32:06,488 - Detection - Open Intent Detection Finished...
