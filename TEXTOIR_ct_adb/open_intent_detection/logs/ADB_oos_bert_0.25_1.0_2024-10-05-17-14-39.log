2024-10-05 17:14:39,301 - Detection - Open Intent Detection Begin...
2024-10-05 17:14:39,301 - Detection - Parameters Initialization...
2024-10-05 17:14:39,302 - Detection - Data and Model Preparation...
2024-10-05 17:14:39,302 - Detection - The number of known intents is 38
2024-10-05 17:14:39,302 - Detection - Lists of known labels are: ['gas', 'application_status', 'current_location', 'change_volume', 'cancel', 'tell_joke', 'pto_request', 'balance', 'restaurant_suggestion', 'make_call', 'pto_balance', 'do_you_have_pets', 'recipe', 'improve_credit_score', 'weather', 'expiration_date', 'mpg', 'uber', 'smart_home', 'flight_status', 'todo_list', 'shopping_list_update', 'what_are_your_hobbies', 'no', 'are_you_a_bot', 'schedule_meeting', 'travel_suggestion', 'meal_suggestion', 'insurance', 'play_music', 'calories', 'change_user_name', 'w2', 'insurance_change', 'bill_due', 'cook_time', 'nutrition_info', 'find_phone']
2024-10-05 17:14:39,355 - Detection - Number of labeled training samples = 3800
2024-10-05 17:14:39,355 - Detection - Number of unlabeled training samples = 11200
2024-10-05 17:14:39,364 - Detection - Number of evaluation samples = 760
2024-10-05 17:14:39,379 - Detection - Number of testing samples = 5700
2024-10-05 17:14:44,214 - Detection - ============================== Params ==============================
2024-10-05 17:14:44,215 - Detection - type:	open_intent_detection
2024-10-05 17:14:44,215 - Detection - logger_name:	Detection
2024-10-05 17:14:44,215 - Detection - log_dir:	logs
2024-10-05 17:14:44,215 - Detection - dataset:	oos
2024-10-05 17:14:44,215 - Detection - known_cls_ratio:	0.25
2024-10-05 17:14:44,215 - Detection - labeled_ratio:	1.0
2024-10-05 17:14:44,215 - Detection - method:	ADB
2024-10-05 17:14:44,215 - Detection - train:	True
2024-10-05 17:14:44,215 - Detection - tune:	True
2024-10-05 17:14:44,215 - Detection - pretrain:	True
2024-10-05 17:14:44,215 - Detection - b_train:	False
2024-10-05 17:14:44,215 - Detection - save_model:	False
2024-10-05 17:14:44,215 - Detection - backbone:	bert
2024-10-05 17:14:44,215 - Detection - config_file_name:	ADB
2024-10-05 17:14:44,215 - Detection - seed:	3
2024-10-05 17:14:44,215 - Detection - gpu_id:	0
2024-10-05 17:14:44,215 - Detection - pipe_results_path:	pipe_results
2024-10-05 17:14:44,215 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 17:14:44,215 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 17:14:44,215 - Detection - model_dir:	models
2024-10-05 17:14:44,215 - Detection - load_pretrained_method:	None
2024-10-05 17:14:44,215 - Detection - result_dir:	results
2024-10-05 17:14:44,215 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 17:14:44,215 - Detection - save_results:	True
2024-10-05 17:14:44,215 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 17:14:44,215 - Detection - dataset_neg:	SQUAD
2024-10-05 17:14:44,215 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_3
2024-10-05 17:14:44,215 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_oos_0.25_1.0_bert_3/models
2024-10-05 17:14:44,215 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 17:14:44,215 - Detection - num_train_epochs:	100
2024-10-05 17:14:44,215 - Detection - num_labels:	38
2024-10-05 17:14:44,215 - Detection - max_seq_length:	30
2024-10-05 17:14:44,215 - Detection - freeze_backbone_parameters:	True
2024-10-05 17:14:44,215 - Detection - feat_dim:	768
2024-10-05 17:14:44,215 - Detection - warmup_proportion:	0.1
2024-10-05 17:14:44,215 - Detection - lr_boundary:	0.05
2024-10-05 17:14:44,215 - Detection - lr:	2e-05
2024-10-05 17:14:44,216 - Detection - activation:	relu
2024-10-05 17:14:44,216 - Detection - train_batch_size:	128
2024-10-05 17:14:44,216 - Detection - eval_batch_size:	64
2024-10-05 17:14:44,216 - Detection - test_batch_size:	64
2024-10-05 17:14:44,216 - Detection - wait_patient:	10
2024-10-05 17:14:44,216 - Detection - safe1:	0.5
2024-10-05 17:14:44,216 - Detection - safe2:	0.8
2024-10-05 17:14:44,216 - Detection - neg_weight:	0.3
2024-10-05 17:14:44,216 - Detection - margin:	0.8
2024-10-05 17:14:44,216 - Detection - p:	2
2024-10-05 17:14:44,216 - Detection - loss_weight:	1
2024-10-05 17:14:44,216 - Detection - supcon_loss_weight:	0.7
2024-10-05 17:14:44,216 - Detection - triplet_loss_weight:	0.9
2024-10-05 17:14:44,216 - Detection - unseen_label_id:	38
2024-10-05 17:14:44,216 - Detection - anum_labels:	39
2024-10-05 17:14:44,216 - Detection - ============================== End Params ==============================
2024-10-05 17:14:45,439 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 17:14:46,538 - Detection - Pre-training Begin...
2024-10-05 17:14:51,938 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 17:14:51,938 - Detection -   best_eval_score = 0
2024-10-05 17:14:51,939 - Detection -   eval_score = 1.18
2024-10-05 17:14:51,939 - Detection -   train_loss = 8.837694072723389
2024-10-05 17:14:56,548 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 17:14:56,548 - Detection -   best_eval_score = 1.18
2024-10-05 17:14:56,548 - Detection -   eval_score = 1.84
2024-10-05 17:14:56,548 - Detection -   train_loss = 8.394177055358886
2024-10-05 17:15:01,164 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 17:15:01,164 - Detection -   best_eval_score = 1.84
2024-10-05 17:15:01,164 - Detection -   eval_score = 4.21
2024-10-05 17:15:01,164 - Detection -   train_loss = 7.997513230641683
2024-10-05 17:15:05,747 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 17:15:05,747 - Detection -   best_eval_score = 4.21
2024-10-05 17:15:05,747 - Detection -   eval_score = 8.95
2024-10-05 17:15:05,747 - Detection -   train_loss = 7.569270626703898
2024-10-05 17:15:10,332 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 17:15:10,332 - Detection -   best_eval_score = 8.95
2024-10-05 17:15:10,333 - Detection -   eval_score = 14.34
2024-10-05 17:15:10,333 - Detection -   train_loss = 7.268483130137126
2024-10-05 17:15:14,940 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 17:15:14,940 - Detection -   best_eval_score = 14.34
2024-10-05 17:15:14,940 - Detection -   eval_score = 20.66
2024-10-05 17:15:14,940 - Detection -   train_loss = 7.017140579223633
2024-10-05 17:15:19,526 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 17:15:19,526 - Detection -   best_eval_score = 20.66
2024-10-05 17:15:19,526 - Detection -   eval_score = 38.16
2024-10-05 17:15:19,526 - Detection -   train_loss = 6.76868052482605
2024-10-05 17:15:24,180 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 17:15:24,180 - Detection -   best_eval_score = 38.16
2024-10-05 17:15:24,180 - Detection -   eval_score = 64.08
2024-10-05 17:15:24,180 - Detection -   train_loss = 6.522599919637044
2024-10-05 17:15:28,752 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 17:15:28,752 - Detection -   best_eval_score = 64.08
2024-10-05 17:15:28,752 - Detection -   eval_score = 83.55
2024-10-05 17:15:28,752 - Detection -   train_loss = 6.174679215749105
2024-10-05 17:15:33,325 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 17:15:33,325 - Detection -   best_eval_score = 83.55
2024-10-05 17:15:33,325 - Detection -   eval_score = 91.58
2024-10-05 17:15:33,325 - Detection -   train_loss = 5.752997732162475
2024-10-05 17:15:37,894 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 17:15:37,894 - Detection -   best_eval_score = 91.58
2024-10-05 17:15:37,894 - Detection -   eval_score = 95.26
2024-10-05 17:15:37,894 - Detection -   train_loss = 5.25917698542277
2024-10-05 17:15:42,468 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 17:15:42,468 - Detection -   best_eval_score = 95.26
2024-10-05 17:15:42,468 - Detection -   eval_score = 96.45
2024-10-05 17:15:42,468 - Detection -   train_loss = 4.668184232711792
2024-10-05 17:15:47,051 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 17:15:47,051 - Detection -   best_eval_score = 96.45
2024-10-05 17:15:47,051 - Detection -   eval_score = 96.45
2024-10-05 17:15:47,052 - Detection -   train_loss = 4.127087036768596
2024-10-05 17:15:51,612 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 17:15:51,612 - Detection -   best_eval_score = 96.45
2024-10-05 17:15:51,613 - Detection -   eval_score = 96.84
2024-10-05 17:15:51,613 - Detection -   train_loss = 3.6890602827072145
2024-10-05 17:15:56,182 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 17:15:56,182 - Detection -   best_eval_score = 96.84
2024-10-05 17:15:56,182 - Detection -   eval_score = 97.24
2024-10-05 17:15:56,182 - Detection -   train_loss = 3.3026870250701905
2024-10-05 17:16:00,831 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 17:16:00,831 - Detection -   best_eval_score = 97.24
2024-10-05 17:16:00,831 - Detection -   eval_score = 97.11
2024-10-05 17:16:00,831 - Detection -   train_loss = 3.094200587272644
2024-10-05 17:16:05,426 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 17:16:05,426 - Detection -   best_eval_score = 97.24
2024-10-05 17:16:05,426 - Detection -   eval_score = 97.5
2024-10-05 17:16:05,426 - Detection -   train_loss = 2.9069403568903605
2024-10-05 17:16:10,036 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 17:16:10,036 - Detection -   best_eval_score = 97.5
2024-10-05 17:16:10,037 - Detection -   eval_score = 97.63
2024-10-05 17:16:10,037 - Detection -   train_loss = 2.736612629890442
2024-10-05 17:16:14,605 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 17:16:14,605 - Detection -   best_eval_score = 97.63
2024-10-05 17:16:14,605 - Detection -   eval_score = 97.5
2024-10-05 17:16:14,605 - Detection -   train_loss = 2.6737828413645426
2024-10-05 17:16:19,168 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 17:16:19,168 - Detection -   best_eval_score = 97.63
2024-10-05 17:16:19,168 - Detection -   eval_score = 97.89
2024-10-05 17:16:19,168 - Detection -   train_loss = 2.5913169622421264
2024-10-05 17:16:23,781 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 17:16:23,781 - Detection -   best_eval_score = 97.89
2024-10-05 17:16:23,781 - Detection -   eval_score = 97.89
2024-10-05 17:16:23,781 - Detection -   train_loss = 2.5418577988942466
2024-10-05 17:16:28,391 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 17:16:28,391 - Detection -   best_eval_score = 97.89
2024-10-05 17:16:28,391 - Detection -   eval_score = 97.76
2024-10-05 17:16:28,391 - Detection -   train_loss = 2.4635900417963663
2024-10-05 17:16:32,992 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 17:16:32,992 - Detection -   best_eval_score = 97.89
2024-10-05 17:16:32,992 - Detection -   eval_score = 97.76
2024-10-05 17:16:32,992 - Detection -   train_loss = 2.4575727542241412
2024-10-05 17:16:37,583 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 17:16:37,583 - Detection -   best_eval_score = 97.89
2024-10-05 17:16:37,584 - Detection -   eval_score = 97.89
2024-10-05 17:16:37,584 - Detection -   train_loss = 2.4261362473169963
2024-10-05 17:16:42,157 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 17:16:42,157 - Detection -   best_eval_score = 97.89
2024-10-05 17:16:42,157 - Detection -   eval_score = 97.76
2024-10-05 17:16:42,157 - Detection -   train_loss = 2.3906474828720095
2024-10-05 17:16:46,769 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 17:16:46,770 - Detection -   best_eval_score = 97.89
2024-10-05 17:16:46,770 - Detection -   eval_score = 97.76
2024-10-05 17:16:46,770 - Detection -   train_loss = 2.358250538508097
2024-10-05 17:16:51,337 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 17:16:51,337 - Detection -   best_eval_score = 97.89
2024-10-05 17:16:51,337 - Detection -   eval_score = 97.89
2024-10-05 17:16:51,337 - Detection -   train_loss = 2.349923308690389
2024-10-05 17:16:55,896 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 17:16:55,896 - Detection -   best_eval_score = 97.89
2024-10-05 17:16:55,896 - Detection -   eval_score = 97.89
2024-10-05 17:16:55,896 - Detection -   train_loss = 2.3544729709625245
2024-10-05 17:17:00,516 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 17:17:00,516 - Detection -   best_eval_score = 97.89
2024-10-05 17:17:00,517 - Detection -   eval_score = 97.89
2024-10-05 17:17:00,517 - Detection -   train_loss = 2.3105276902516683
2024-10-05 17:17:05,135 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 17:17:05,136 - Detection -   best_eval_score = 97.89
2024-10-05 17:17:05,136 - Detection -   eval_score = 97.89
2024-10-05 17:17:05,136 - Detection -   train_loss = 2.2982093572616575
2024-10-05 17:17:05,136 - Detection - Pre-training finished...
2024-10-05 17:17:05,137 - Detection - Training Begin...
2024-10-05 17:17:10,553 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 17:17:10,553 - Detection -   best_eval_score = 0
2024-10-05 17:17:10,553 - Detection -   eval_score = 5.42
2024-10-05 17:17:10,553 - Detection -   train_loss = 7.873688236872355
2024-10-05 17:17:12,990 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 17:17:12,990 - Detection -   best_eval_score = 5.42
2024-10-05 17:17:12,990 - Detection -   eval_score = 35.27
2024-10-05 17:17:12,990 - Detection -   train_loss = 6.429241307576498
2024-10-05 17:17:15,453 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 17:17:15,453 - Detection -   best_eval_score = 35.27
2024-10-05 17:17:15,453 - Detection -   eval_score = 70.74
2024-10-05 17:17:15,453 - Detection -   train_loss = 4.622566779454549
2024-10-05 17:17:17,894 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 17:17:17,895 - Detection -   best_eval_score = 70.74
2024-10-05 17:17:17,895 - Detection -   eval_score = 87.77
2024-10-05 17:17:17,895 - Detection -   train_loss = 2.797114896774292
2024-10-05 17:17:20,338 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 17:17:20,338 - Detection -   best_eval_score = 87.77
2024-10-05 17:17:20,338 - Detection -   eval_score = 91.44
2024-10-05 17:17:20,338 - Detection -   train_loss = 1.5678300897280375
2024-10-05 17:17:22,772 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 17:17:22,772 - Detection -   best_eval_score = 91.44
2024-10-05 17:17:22,772 - Detection -   eval_score = 92.33
2024-10-05 17:17:22,772 - Detection -   train_loss = 1.2389734307924907
2024-10-05 17:17:25,217 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 17:17:25,217 - Detection -   best_eval_score = 92.33
2024-10-05 17:17:25,217 - Detection -   eval_score = 92.46
2024-10-05 17:17:25,217 - Detection -   train_loss = 1.2533964037895202
2024-10-05 17:17:27,653 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 17:17:27,654 - Detection -   best_eval_score = 92.46
2024-10-05 17:17:27,654 - Detection -   eval_score = 92.33
2024-10-05 17:17:27,654 - Detection -   train_loss = 1.237605345249176
2024-10-05 17:17:30,087 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 17:17:30,087 - Detection -   best_eval_score = 92.46
2024-10-05 17:17:30,087 - Detection -   eval_score = 92.25
2024-10-05 17:17:30,087 - Detection -   train_loss = 1.2057374477386475
2024-10-05 17:17:32,521 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 17:17:32,521 - Detection -   best_eval_score = 92.46
2024-10-05 17:17:32,521 - Detection -   eval_score = 92.4
2024-10-05 17:17:32,521 - Detection -   train_loss = 1.235771942138672
2024-10-05 17:17:34,976 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 17:17:34,976 - Detection -   best_eval_score = 92.46
2024-10-05 17:17:34,976 - Detection -   eval_score = 92.4
2024-10-05 17:17:34,976 - Detection -   train_loss = 1.2261097768942515
2024-10-05 17:17:37,411 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 17:17:37,411 - Detection -   best_eval_score = 92.46
2024-10-05 17:17:37,411 - Detection -   eval_score = 92.47
2024-10-05 17:17:37,411 - Detection -   train_loss = 1.2276123722394308
2024-10-05 17:17:39,850 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 17:17:39,850 - Detection -   best_eval_score = 92.47
2024-10-05 17:17:39,850 - Detection -   eval_score = 92.32
2024-10-05 17:17:39,850 - Detection -   train_loss = 1.2364746530850728
2024-10-05 17:17:42,280 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 17:17:42,280 - Detection -   best_eval_score = 92.47
2024-10-05 17:17:42,280 - Detection -   eval_score = 92.47
2024-10-05 17:17:42,280 - Detection -   train_loss = 1.2106866876284281
2024-10-05 17:17:44,714 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 17:17:44,714 - Detection -   best_eval_score = 92.47
2024-10-05 17:17:44,714 - Detection -   eval_score = 92.4
2024-10-05 17:17:44,714 - Detection -   train_loss = 1.2396926879882812
2024-10-05 17:17:47,245 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 17:17:47,245 - Detection -   best_eval_score = 92.47
2024-10-05 17:17:47,245 - Detection -   eval_score = 92.26
2024-10-05 17:17:47,245 - Detection -   train_loss = 1.2165618975957235
2024-10-05 17:17:49,675 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 17:17:49,676 - Detection -   best_eval_score = 92.47
2024-10-05 17:17:49,676 - Detection -   eval_score = 92.4
2024-10-05 17:17:49,676 - Detection -   train_loss = 1.2457233190536499
2024-10-05 17:17:52,100 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 17:17:52,100 - Detection -   best_eval_score = 92.47
2024-10-05 17:17:52,100 - Detection -   eval_score = 92.4
2024-10-05 17:17:52,101 - Detection -   train_loss = 1.222626547018687
2024-10-05 17:17:54,525 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 17:17:54,525 - Detection -   best_eval_score = 92.47
2024-10-05 17:17:54,525 - Detection -   eval_score = 92.4
2024-10-05 17:17:54,525 - Detection -   train_loss = 1.2163332939147948
2024-10-05 17:17:56,963 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 17:17:56,963 - Detection -   best_eval_score = 92.47
2024-10-05 17:17:56,963 - Detection -   eval_score = 92.4
2024-10-05 17:17:56,964 - Detection -   train_loss = 1.2434162100156148
2024-10-05 17:17:59,395 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 17:17:59,395 - Detection -   best_eval_score = 92.47
2024-10-05 17:17:59,395 - Detection -   eval_score = 92.47
2024-10-05 17:17:59,395 - Detection -   train_loss = 1.2330639163653057
2024-10-05 17:18:01,817 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 17:18:01,817 - Detection -   best_eval_score = 92.47
2024-10-05 17:18:01,817 - Detection -   eval_score = 92.4
2024-10-05 17:18:01,817 - Detection -   train_loss = 1.2251458009084066
2024-10-05 17:18:01,821 - Detection - Training Finished...
2024-10-05 17:18:01,821 - Detection - Testing begin...
2024-10-05 17:18:04,021 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 17:18:04,022 - Detection - [[  26    0    0 ...    0    0    4]
 [   0   30    0 ...    0    0    0]
 [   0    0   28 ...    0    0    2]
 ...
 [   0    0    0 ...   30    0    0]
 [   0    0    0 ...    0   29    1]
 [  20   26   20 ...    2    7 3866]]
2024-10-05 17:18:04,022 - Detection - ***** Test results *****
2024-10-05 17:18:04,022 - Detection -   Acc = 86.04
2024-10-05 17:18:04,022 - Detection -   F1 = 76.4922
2024-10-05 17:18:04,022 - Detection -   F1-known = 76.1193
2024-10-05 17:18:04,022 - Detection -   F1-open = 90.666
2024-10-05 17:18:04,022 - Detection - Testing finished...
2024-10-05 17:18:04,022 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 17:18:04,061 - Detection - Open Intent Detection Finished...
