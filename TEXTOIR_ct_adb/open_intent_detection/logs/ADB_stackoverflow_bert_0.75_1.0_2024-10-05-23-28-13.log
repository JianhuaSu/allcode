2024-10-05 23:28:13,455 - Detection - Open Intent Detection Begin...
2024-10-05 23:28:13,455 - Detection - Parameters Initialization...
2024-10-05 23:28:13,455 - Detection - Data and Model Preparation...
2024-10-05 23:28:13,456 - Detection - The number of known intents is 15
2024-10-05 23:28:13,456 - Detection - Lists of known labels are: ['bash', 'excel', 'svn', 'wordpress', 'osx', 'apache', 'oracle', 'matlab', 'qt', 'visual-studio', 'hibernate', 'drupal', 'linq', 'magento', 'ajax']
2024-10-05 23:28:13,509 - Detection - Number of labeled training samples = 9000
2024-10-05 23:28:13,510 - Detection - Number of unlabeled training samples = 3000
2024-10-05 23:28:13,515 - Detection - Number of evaluation samples = 1500
2024-10-05 23:28:13,531 - Detection - Number of testing samples = 6000
2024-10-05 23:28:18,938 - Detection - ============================== Params ==============================
2024-10-05 23:28:18,939 - Detection - type:	open_intent_detection
2024-10-05 23:28:18,939 - Detection - logger_name:	Detection
2024-10-05 23:28:18,939 - Detection - log_dir:	logs
2024-10-05 23:28:18,939 - Detection - dataset:	stackoverflow
2024-10-05 23:28:18,939 - Detection - known_cls_ratio:	0.75
2024-10-05 23:28:18,939 - Detection - labeled_ratio:	1.0
2024-10-05 23:28:18,939 - Detection - method:	ADB
2024-10-05 23:28:18,939 - Detection - train:	True
2024-10-05 23:28:18,939 - Detection - tune:	True
2024-10-05 23:28:18,939 - Detection - pretrain:	True
2024-10-05 23:28:18,939 - Detection - b_train:	False
2024-10-05 23:28:18,939 - Detection - save_model:	False
2024-10-05 23:28:18,939 - Detection - backbone:	bert
2024-10-05 23:28:18,939 - Detection - config_file_name:	ADB
2024-10-05 23:28:18,939 - Detection - seed:	5
2024-10-05 23:28:18,939 - Detection - gpu_id:	0
2024-10-05 23:28:18,939 - Detection - pipe_results_path:	pipe_results
2024-10-05 23:28:18,939 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 23:28:18,939 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 23:28:18,939 - Detection - model_dir:	models
2024-10-05 23:28:18,939 - Detection - load_pretrained_method:	None
2024-10-05 23:28:18,939 - Detection - result_dir:	results
2024-10-05 23:28:18,939 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 23:28:18,939 - Detection - save_results:	True
2024-10-05 23:28:18,939 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 23:28:18,939 - Detection - dataset_neg:	SQUAD
2024-10-05 23:28:18,939 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_stackoverflow_0.75_1.0_bert_5
2024-10-05 23:28:18,939 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_stackoverflow_0.75_1.0_bert_5/models
2024-10-05 23:28:18,939 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 23:28:18,939 - Detection - num_train_epochs:	100
2024-10-05 23:28:18,939 - Detection - num_labels:	15
2024-10-05 23:28:18,939 - Detection - max_seq_length:	45
2024-10-05 23:28:18,939 - Detection - freeze_backbone_parameters:	True
2024-10-05 23:28:18,939 - Detection - feat_dim:	768
2024-10-05 23:28:18,939 - Detection - warmup_proportion:	0.1
2024-10-05 23:28:18,940 - Detection - lr_boundary:	0.05
2024-10-05 23:28:18,940 - Detection - lr:	2e-05
2024-10-05 23:28:18,940 - Detection - activation:	relu
2024-10-05 23:28:18,940 - Detection - train_batch_size:	128
2024-10-05 23:28:18,940 - Detection - eval_batch_size:	64
2024-10-05 23:28:18,940 - Detection - test_batch_size:	64
2024-10-05 23:28:18,940 - Detection - wait_patient:	10
2024-10-05 23:28:18,940 - Detection - safe1:	0.7
2024-10-05 23:28:18,940 - Detection - safe2:	0.9
2024-10-05 23:28:18,940 - Detection - neg_weight:	0.1
2024-10-05 23:28:18,940 - Detection - margin:	0.4
2024-10-05 23:28:18,940 - Detection - p:	2
2024-10-05 23:28:18,940 - Detection - loss_weight:	1
2024-10-05 23:28:18,940 - Detection - supcon_loss_weight:	0.3
2024-10-05 23:28:18,940 - Detection - triplet_loss_weight:	0.2
2024-10-05 23:28:18,940 - Detection - unseen_label_id:	15
2024-10-05 23:28:18,940 - Detection - anum_labels:	16
2024-10-05 23:28:18,940 - Detection - ============================== End Params ==============================
2024-10-05 23:28:20,252 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 23:28:21,362 - Detection - Pre-training Begin...
2024-10-05 23:28:35,119 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 23:28:35,120 - Detection -   best_eval_score = 0
2024-10-05 23:28:35,120 - Detection -   eval_score = 7.67
2024-10-05 23:28:35,120 - Detection -   train_loss = 4.651605149389992
2024-10-05 23:28:48,135 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 23:28:48,136 - Detection -   best_eval_score = 7.67
2024-10-05 23:28:48,136 - Detection -   eval_score = 11.33
2024-10-05 23:28:48,136 - Detection -   train_loss = 4.559573831692548
2024-10-05 23:29:01,195 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 23:29:01,195 - Detection -   best_eval_score = 11.33
2024-10-05 23:29:01,196 - Detection -   eval_score = 26.13
2024-10-05 23:29:01,196 - Detection -   train_loss = 4.494505083057242
2024-10-05 23:29:14,207 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 23:29:14,207 - Detection -   best_eval_score = 26.13
2024-10-05 23:29:14,207 - Detection -   eval_score = 68.93
2024-10-05 23:29:14,207 - Detection -   train_loss = 4.284379478911279
2024-10-05 23:29:27,255 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 23:29:27,255 - Detection -   best_eval_score = 68.93
2024-10-05 23:29:27,255 - Detection -   eval_score = 81.33
2024-10-05 23:29:27,255 - Detection -   train_loss = 3.9349564632899323
2024-10-05 23:29:40,331 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 23:29:40,331 - Detection -   best_eval_score = 81.33
2024-10-05 23:29:40,331 - Detection -   eval_score = 84.73
2024-10-05 23:29:40,331 - Detection -   train_loss = 3.434039357682349
2024-10-05 23:29:53,267 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 23:29:53,268 - Detection -   best_eval_score = 84.73
2024-10-05 23:29:53,268 - Detection -   eval_score = 86.2
2024-10-05 23:29:53,268 - Detection -   train_loss = 2.67641892231686
2024-10-05 23:30:06,113 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 23:30:06,113 - Detection -   best_eval_score = 86.2
2024-10-05 23:30:06,113 - Detection -   eval_score = 86.73
2024-10-05 23:30:06,113 - Detection -   train_loss = 2.234528239344207
2024-10-05 23:30:18,957 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 23:30:18,957 - Detection -   best_eval_score = 86.73
2024-10-05 23:30:18,957 - Detection -   eval_score = 86.8
2024-10-05 23:30:18,957 - Detection -   train_loss = 2.0585764058878726
2024-10-05 23:30:31,889 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 23:30:31,889 - Detection -   best_eval_score = 86.8
2024-10-05 23:30:31,889 - Detection -   eval_score = 87.73
2024-10-05 23:30:31,889 - Detection -   train_loss = 1.9452483200691115
2024-10-05 23:30:44,703 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 23:30:44,703 - Detection -   best_eval_score = 87.73
2024-10-05 23:30:44,703 - Detection -   eval_score = 88.27
2024-10-05 23:30:44,703 - Detection -   train_loss = 1.8764049402424987
2024-10-05 23:30:57,539 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 23:30:57,539 - Detection -   best_eval_score = 88.27
2024-10-05 23:30:57,539 - Detection -   eval_score = 88.53
2024-10-05 23:30:57,540 - Detection -   train_loss = 1.7974236263355738
2024-10-05 23:31:10,370 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 23:31:10,370 - Detection -   best_eval_score = 88.53
2024-10-05 23:31:10,370 - Detection -   eval_score = 88.8
2024-10-05 23:31:10,370 - Detection -   train_loss = 1.7449826069281136
2024-10-05 23:31:23,255 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 23:31:23,255 - Detection -   best_eval_score = 88.8
2024-10-05 23:31:23,255 - Detection -   eval_score = 89.07
2024-10-05 23:31:23,255 - Detection -   train_loss = 1.7048902410856435
2024-10-05 23:31:36,028 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 23:31:36,028 - Detection -   best_eval_score = 89.07
2024-10-05 23:31:36,028 - Detection -   eval_score = 89.2
2024-10-05 23:31:36,028 - Detection -   train_loss = 1.6649216119672212
2024-10-05 23:31:48,833 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 23:31:48,833 - Detection -   best_eval_score = 89.2
2024-10-05 23:31:48,833 - Detection -   eval_score = 88.73
2024-10-05 23:31:48,833 - Detection -   train_loss = 1.6179240085709263
2024-10-05 23:32:01,599 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 23:32:01,599 - Detection -   best_eval_score = 89.2
2024-10-05 23:32:01,600 - Detection -   eval_score = 89.27
2024-10-05 23:32:01,600 - Detection -   train_loss = 1.6055736441007802
2024-10-05 23:32:14,449 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 23:32:14,449 - Detection -   best_eval_score = 89.27
2024-10-05 23:32:14,449 - Detection -   eval_score = 89.53
2024-10-05 23:32:14,449 - Detection -   train_loss = 1.5605589957304404
2024-10-05 23:32:27,213 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 23:32:27,214 - Detection -   best_eval_score = 89.53
2024-10-05 23:32:27,214 - Detection -   eval_score = 89.6
2024-10-05 23:32:27,214 - Detection -   train_loss = 1.5395152140671098
2024-10-05 23:32:39,991 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 23:32:39,991 - Detection -   best_eval_score = 89.6
2024-10-05 23:32:39,991 - Detection -   eval_score = 89.47
2024-10-05 23:32:39,991 - Detection -   train_loss = 1.5061110912914006
2024-10-05 23:32:52,754 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 23:32:52,754 - Detection -   best_eval_score = 89.6
2024-10-05 23:32:52,754 - Detection -   eval_score = 89.47
2024-10-05 23:32:52,754 - Detection -   train_loss = 1.4831708501762069
2024-10-05 23:33:05,518 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 23:33:05,518 - Detection -   best_eval_score = 89.6
2024-10-05 23:33:05,518 - Detection -   eval_score = 89.73
2024-10-05 23:33:05,518 - Detection -   train_loss = 1.4589076915257413
2024-10-05 23:33:18,441 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 23:33:18,441 - Detection -   best_eval_score = 89.73
2024-10-05 23:33:18,441 - Detection -   eval_score = 89.53
2024-10-05 23:33:18,441 - Detection -   train_loss = 1.4449293697384042
2024-10-05 23:33:31,189 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 23:33:31,189 - Detection -   best_eval_score = 89.73
2024-10-05 23:33:31,190 - Detection -   eval_score = 89.8
2024-10-05 23:33:31,190 - Detection -   train_loss = 1.4225751589721358
2024-10-05 23:33:43,936 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 23:33:43,936 - Detection -   best_eval_score = 89.8
2024-10-05 23:33:43,936 - Detection -   eval_score = 89.47
2024-10-05 23:33:43,936 - Detection -   train_loss = 1.3947116875312697
2024-10-05 23:33:56,654 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 23:33:56,654 - Detection -   best_eval_score = 89.8
2024-10-05 23:33:56,654 - Detection -   eval_score = 89.27
2024-10-05 23:33:56,654 - Detection -   train_loss = 1.3855417798942244
2024-10-05 23:34:09,396 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 23:34:09,396 - Detection -   best_eval_score = 89.8
2024-10-05 23:34:09,396 - Detection -   eval_score = 89.53
2024-10-05 23:34:09,396 - Detection -   train_loss = 1.37108821264455
2024-10-05 23:34:22,219 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 23:34:22,219 - Detection -   best_eval_score = 89.8
2024-10-05 23:34:22,219 - Detection -   eval_score = 89.27
2024-10-05 23:34:22,219 - Detection -   train_loss = 1.3517050491252416
2024-10-05 23:34:35,373 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 23:34:35,373 - Detection -   best_eval_score = 89.8
2024-10-05 23:34:35,373 - Detection -   eval_score = 89.4
2024-10-05 23:34:35,373 - Detection -   train_loss = 1.3304290192227968
2024-10-05 23:34:48,630 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 23:34:48,630 - Detection -   best_eval_score = 89.8
2024-10-05 23:34:48,630 - Detection -   eval_score = 89.47
2024-10-05 23:34:48,630 - Detection -   train_loss = 1.3243388306926673
2024-10-05 23:35:01,720 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 23:35:01,720 - Detection -   best_eval_score = 89.8
2024-10-05 23:35:01,720 - Detection -   eval_score = 89.53
2024-10-05 23:35:01,720 - Detection -   train_loss = 1.302899761938713
2024-10-05 23:35:14,798 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 23:35:14,798 - Detection -   best_eval_score = 89.8
2024-10-05 23:35:14,798 - Detection -   eval_score = 89.67
2024-10-05 23:35:14,798 - Detection -   train_loss = 1.2852345604292104
2024-10-05 23:35:27,877 - Detection - ***** Epoch: 33: Eval results *****
2024-10-05 23:35:27,877 - Detection -   best_eval_score = 89.8
2024-10-05 23:35:27,877 - Detection -   eval_score = 89.47
2024-10-05 23:35:27,877 - Detection -   train_loss = 1.2752910911197393
2024-10-05 23:35:40,880 - Detection - ***** Epoch: 34: Eval results *****
2024-10-05 23:35:40,880 - Detection -   best_eval_score = 89.8
2024-10-05 23:35:40,880 - Detection -   eval_score = 89.6
2024-10-05 23:35:40,880 - Detection -   train_loss = 1.266907745683697
2024-10-05 23:35:40,881 - Detection - Pre-training finished...
2024-10-05 23:35:40,882 - Detection - Training Begin...
2024-10-05 23:36:08,845 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 23:36:08,845 - Detection -   best_eval_score = 0
2024-10-05 23:36:08,845 - Detection -   eval_score = 46.51
2024-10-05 23:36:08,845 - Detection -   train_loss = 5.788034657357445
2024-10-05 23:36:26,667 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 23:36:26,668 - Detection -   best_eval_score = 46.51
2024-10-05 23:36:26,668 - Detection -   eval_score = 83.03
2024-10-05 23:36:26,668 - Detection -   train_loss = 2.3140292671364797
2024-10-05 23:36:44,417 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 23:36:44,417 - Detection -   best_eval_score = 83.03
2024-10-05 23:36:44,417 - Detection -   eval_score = 82.98
2024-10-05 23:36:44,417 - Detection -   train_loss = 1.5684695814696836
2024-10-05 23:37:02,062 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 23:37:02,062 - Detection -   best_eval_score = 83.03
2024-10-05 23:37:02,062 - Detection -   eval_score = 83.01
2024-10-05 23:37:02,063 - Detection -   train_loss = 1.571418797466117
2024-10-05 23:37:19,781 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 23:37:19,781 - Detection -   best_eval_score = 83.03
2024-10-05 23:37:19,781 - Detection -   eval_score = 83.17
2024-10-05 23:37:19,787 - Detection -   train_loss = 1.5808250971243416
2024-10-05 23:37:37,635 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 23:37:37,635 - Detection -   best_eval_score = 83.17
2024-10-05 23:37:37,635 - Detection -   eval_score = 83.01
2024-10-05 23:37:37,635 - Detection -   train_loss = 1.578537450709813
2024-10-05 23:37:55,351 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 23:37:55,351 - Detection -   best_eval_score = 83.17
2024-10-05 23:37:55,351 - Detection -   eval_score = 83.01
2024-10-05 23:37:55,351 - Detection -   train_loss = 1.5771118150630468
2024-10-05 23:38:12,974 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 23:38:12,975 - Detection -   best_eval_score = 83.17
2024-10-05 23:38:12,975 - Detection -   eval_score = 82.98
2024-10-05 23:38:12,975 - Detection -   train_loss = 1.5805877010587235
2024-10-05 23:38:30,598 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 23:38:30,598 - Detection -   best_eval_score = 83.17
2024-10-05 23:38:30,599 - Detection -   eval_score = 83.05
2024-10-05 23:38:30,599 - Detection -   train_loss = 1.5800284953184531
2024-10-05 23:38:48,550 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 23:38:48,551 - Detection -   best_eval_score = 83.17
2024-10-05 23:38:48,551 - Detection -   eval_score = 83.02
2024-10-05 23:38:48,551 - Detection -   train_loss = 1.5730013444390096
2024-10-05 23:39:06,479 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 23:39:06,480 - Detection -   best_eval_score = 83.17
2024-10-05 23:39:06,480 - Detection -   eval_score = 83.02
2024-10-05 23:39:06,480 - Detection -   train_loss = 1.5704230238014543
2024-10-05 23:39:24,493 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 23:39:24,493 - Detection -   best_eval_score = 83.17
2024-10-05 23:39:24,493 - Detection -   eval_score = 83.07
2024-10-05 23:39:24,493 - Detection -   train_loss = 1.5804577092049827
2024-10-05 23:39:42,399 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 23:39:42,399 - Detection -   best_eval_score = 83.17
2024-10-05 23:39:42,399 - Detection -   eval_score = 83.0
2024-10-05 23:39:42,399 - Detection -   train_loss = 1.5727073407508958
2024-10-05 23:39:59,704 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 23:39:59,705 - Detection -   best_eval_score = 83.17
2024-10-05 23:39:59,705 - Detection -   eval_score = 83.01
2024-10-05 23:39:59,705 - Detection -   train_loss = 1.5719192934707857
2024-10-05 23:40:17,178 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 23:40:17,178 - Detection -   best_eval_score = 83.17
2024-10-05 23:40:17,178 - Detection -   eval_score = 83.02
2024-10-05 23:40:17,178 - Detection -   train_loss = 1.5783799785963246
2024-10-05 23:40:17,184 - Detection - Training Finished...
2024-10-05 23:40:17,184 - Detection - Testing begin...
2024-10-05 23:40:20,488 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 23:40:20,489 - Detection - [[ 212    0    0    0    4    0    0    0    0    0    0    0    0    0
     0   84]
 [   0  239    0    0    0    0    0    0    0    0    0    0    0    0
     0   61]
 [   0    0  250    0    0    1    0    0    0    0    0    0    0    0
     0   49]
 [   0    0    0  257    0    2    0    0    0    0    0    0    0    0
     0   41]
 [   0    1    1    0  229    1    0    0    3    0    0    0    0    0
     0   65]
 [   1    1    1    1    0  212    0    0    0    0    0    0    0    0
     0   84]
 [   0    0    0    0    0    0  237    0    0    0    0    0    0    0
     0   63]
 [   0    0    0    0    0    0    0  250    0    0    0    0    0    0
     0   50]
 [   0    0    0    0    0    0    0    0  277    0    0    0    0    0
     0   23]
 [   0    0    0    0    1    0    1    0    0  218    0    0    0    0
     0   80]
 [   0    0    0    0    0    0    1    0    0    0  257    0    0    0
     0   42]
 [   0    0    0    0    0    2    0    0    0    0    0  253    0    0
     0   45]
 [   0    0    0    0    0    0    0    0    0    0    0    0  258    0
     0   42]
 [   0    0    0    0    0    0    0    0    1    0    0    0    0  257
     0   42]
 [   0    0    0    1    0    0    0    0    0    0    0    0    0    0
   232   67]
 [   3    2    0    0  101    1    1    1    4    5   27    0    0    0
     3 1352]]
2024-10-05 23:40:20,489 - Detection - ***** Test results *****
2024-10-05 23:40:20,489 - Detection -   Acc = 83.17
2024-10-05 23:40:20,489 - Detection -   F1 = 86.7134
2024-10-05 23:40:20,489 - Detection -   F1-known = 87.6091
2024-10-05 23:40:20,489 - Detection -   F1-open = 73.2791
2024-10-05 23:40:20,489 - Detection - Testing finished...
2024-10-05 23:40:20,489 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 23:40:20,527 - Detection - Open Intent Detection Finished...
