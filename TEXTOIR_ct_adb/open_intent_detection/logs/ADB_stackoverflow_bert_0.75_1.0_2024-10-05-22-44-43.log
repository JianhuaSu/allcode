2024-10-05 22:44:43,632 - Detection - Open Intent Detection Begin...
2024-10-05 22:44:43,632 - Detection - Parameters Initialization...
2024-10-05 22:44:43,633 - Detection - Data and Model Preparation...
2024-10-05 22:44:43,633 - Detection - The number of known intents is 15
2024-10-05 22:44:43,633 - Detection - Lists of known labels are: ['osx', 'drupal', 'visual-studio', 'ajax', 'magento', 'excel', 'cocoa', 'matlab', 'apache', 'svn', 'hibernate', 'spring', 'scala', 'bash', 'oracle']
2024-10-05 22:44:43,687 - Detection - Number of labeled training samples = 9000
2024-10-05 22:44:43,687 - Detection - Number of unlabeled training samples = 3000
2024-10-05 22:44:43,692 - Detection - Number of evaluation samples = 1500
2024-10-05 22:44:43,707 - Detection - Number of testing samples = 6000
2024-10-05 22:44:48,978 - Detection - ============================== Params ==============================
2024-10-05 22:44:48,979 - Detection - type:	open_intent_detection
2024-10-05 22:44:48,979 - Detection - logger_name:	Detection
2024-10-05 22:44:48,979 - Detection - log_dir:	logs
2024-10-05 22:44:48,979 - Detection - dataset:	stackoverflow
2024-10-05 22:44:48,979 - Detection - known_cls_ratio:	0.75
2024-10-05 22:44:48,979 - Detection - labeled_ratio:	1.0
2024-10-05 22:44:48,979 - Detection - method:	ADB
2024-10-05 22:44:48,979 - Detection - train:	True
2024-10-05 22:44:48,979 - Detection - tune:	True
2024-10-05 22:44:48,979 - Detection - pretrain:	True
2024-10-05 22:44:48,979 - Detection - b_train:	False
2024-10-05 22:44:48,979 - Detection - save_model:	False
2024-10-05 22:44:48,979 - Detection - backbone:	bert
2024-10-05 22:44:48,979 - Detection - config_file_name:	ADB
2024-10-05 22:44:48,979 - Detection - seed:	2
2024-10-05 22:44:48,979 - Detection - gpu_id:	0
2024-10-05 22:44:48,979 - Detection - pipe_results_path:	pipe_results
2024-10-05 22:44:48,979 - Detection - data_dir:	/root/autodl-tmp/TEXTOIR_ct_adb_three_ad/open_intent_detection/../data
2024-10-05 22:44:48,979 - Detection - output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output
2024-10-05 22:44:48,979 - Detection - model_dir:	models
2024-10-05 22:44:48,979 - Detection - load_pretrained_method:	None
2024-10-05 22:44:48,979 - Detection - result_dir:	results
2024-10-05 22:44:48,979 - Detection - results_file_name:	results_ADB_f.csv
2024-10-05 22:44:48,979 - Detection - save_results:	True
2024-10-05 22:44:48,979 - Detection - loss_fct:	CrossEntropyLoss
2024-10-05 22:44:48,979 - Detection - dataset_neg:	SQUAD
2024-10-05 22:44:48,979 - Detection - method_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_stackoverflow_0.75_1.0_bert_2
2024-10-05 22:44:48,979 - Detection - model_output_dir:	/home/sharing/disk3/wangyifan/sujianhua/TEXTOIR_ct_adb_three_ad/output/open_intent_detection/ADB_stackoverflow_0.75_1.0_bert_2/models
2024-10-05 22:44:48,979 - Detection - bert_model:	/root/autodl-tmp/bert-base-uncased
2024-10-05 22:44:48,979 - Detection - num_train_epochs:	100
2024-10-05 22:44:48,979 - Detection - num_labels:	15
2024-10-05 22:44:48,979 - Detection - max_seq_length:	45
2024-10-05 22:44:48,979 - Detection - freeze_backbone_parameters:	True
2024-10-05 22:44:48,979 - Detection - feat_dim:	768
2024-10-05 22:44:48,979 - Detection - warmup_proportion:	0.1
2024-10-05 22:44:48,979 - Detection - lr_boundary:	0.05
2024-10-05 22:44:48,979 - Detection - lr:	2e-05
2024-10-05 22:44:48,980 - Detection - activation:	relu
2024-10-05 22:44:48,980 - Detection - train_batch_size:	128
2024-10-05 22:44:48,980 - Detection - eval_batch_size:	64
2024-10-05 22:44:48,980 - Detection - test_batch_size:	64
2024-10-05 22:44:48,980 - Detection - wait_patient:	10
2024-10-05 22:44:48,980 - Detection - safe1:	0.7
2024-10-05 22:44:48,980 - Detection - safe2:	0.9
2024-10-05 22:44:48,980 - Detection - neg_weight:	0.1
2024-10-05 22:44:48,980 - Detection - margin:	0.4
2024-10-05 22:44:48,980 - Detection - p:	2
2024-10-05 22:44:48,980 - Detection - loss_weight:	1
2024-10-05 22:44:48,980 - Detection - supcon_loss_weight:	0.3
2024-10-05 22:44:48,980 - Detection - triplet_loss_weight:	0.2
2024-10-05 22:44:48,980 - Detection - unseen_label_id:	15
2024-10-05 22:44:48,980 - Detection - anum_labels:	16
2024-10-05 22:44:48,980 - Detection - ============================== End Params ==============================
2024-10-05 22:44:50,191 - Detection - Freeze all parameters but the last layer for efficiency
2024-10-05 22:44:51,249 - Detection - Pre-training Begin...
2024-10-05 22:45:04,824 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 22:45:04,824 - Detection -   best_eval_score = 0
2024-10-05 22:45:04,824 - Detection -   eval_score = 8.47
2024-10-05 22:45:04,824 - Detection -   train_loss = 4.675612671274535
2024-10-05 22:45:17,683 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 22:45:17,683 - Detection -   best_eval_score = 8.47
2024-10-05 22:45:17,684 - Detection -   eval_score = 9.13
2024-10-05 22:45:17,684 - Detection -   train_loss = 4.56404972076416
2024-10-05 22:45:30,582 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 22:45:30,582 - Detection -   best_eval_score = 9.13
2024-10-05 22:45:30,582 - Detection -   eval_score = 19.4
2024-10-05 22:45:30,582 - Detection -   train_loss = 4.510861396789551
2024-10-05 22:45:43,480 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 22:45:43,480 - Detection -   best_eval_score = 19.4
2024-10-05 22:45:43,480 - Detection -   eval_score = 59.8
2024-10-05 22:45:43,480 - Detection -   train_loss = 4.367518374617671
2024-10-05 22:45:56,374 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 22:45:56,375 - Detection -   best_eval_score = 59.8
2024-10-05 22:45:56,375 - Detection -   eval_score = 75.93
2024-10-05 22:45:56,375 - Detection -   train_loss = 4.0786951629208845
2024-10-05 22:46:09,209 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 22:46:09,209 - Detection -   best_eval_score = 75.93
2024-10-05 22:46:09,209 - Detection -   eval_score = 82.73
2024-10-05 22:46:09,209 - Detection -   train_loss = 3.6491315499157975
2024-10-05 22:46:22,096 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 22:46:22,096 - Detection -   best_eval_score = 82.73
2024-10-05 22:46:22,096 - Detection -   eval_score = 83.07
2024-10-05 22:46:22,096 - Detection -   train_loss = 2.9488141486342525
2024-10-05 22:46:34,896 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 22:46:34,897 - Detection -   best_eval_score = 83.07
2024-10-05 22:46:34,897 - Detection -   eval_score = 84.13
2024-10-05 22:46:34,897 - Detection -   train_loss = 2.446632789893889
2024-10-05 22:46:47,765 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 22:46:47,765 - Detection -   best_eval_score = 84.13
2024-10-05 22:46:47,765 - Detection -   eval_score = 85.2
2024-10-05 22:46:47,766 - Detection -   train_loss = 2.253434829308953
2024-10-05 22:47:00,725 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 22:47:00,726 - Detection -   best_eval_score = 85.2
2024-10-05 22:47:00,726 - Detection -   eval_score = 86.2
2024-10-05 22:47:00,726 - Detection -   train_loss = 2.143622247266098
2024-10-05 22:47:13,570 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 22:47:13,571 - Detection -   best_eval_score = 86.2
2024-10-05 22:47:13,571 - Detection -   eval_score = 86.2
2024-10-05 22:47:13,571 - Detection -   train_loss = 2.0501864997433943
2024-10-05 22:47:26,371 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 22:47:26,371 - Detection -   best_eval_score = 86.2
2024-10-05 22:47:26,371 - Detection -   eval_score = 86.93
2024-10-05 22:47:26,371 - Detection -   train_loss = 1.984368624821515
2024-10-05 22:47:39,192 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 22:47:39,192 - Detection -   best_eval_score = 86.93
2024-10-05 22:47:39,192 - Detection -   eval_score = 87.0
2024-10-05 22:47:39,192 - Detection -   train_loss = 1.9335910199393689
2024-10-05 22:47:52,201 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 22:47:52,201 - Detection -   best_eval_score = 87.0
2024-10-05 22:47:52,201 - Detection -   eval_score = 87.87
2024-10-05 22:47:52,201 - Detection -   train_loss = 1.8790101786734352
2024-10-05 22:48:05,145 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 22:48:05,145 - Detection -   best_eval_score = 87.87
2024-10-05 22:48:05,145 - Detection -   eval_score = 87.87
2024-10-05 22:48:05,145 - Detection -   train_loss = 1.8303159324216172
2024-10-05 22:48:18,049 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 22:48:18,049 - Detection -   best_eval_score = 87.87
2024-10-05 22:48:18,049 - Detection -   eval_score = 88.4
2024-10-05 22:48:18,050 - Detection -   train_loss = 1.7855786068338744
2024-10-05 22:48:30,983 - Detection - ***** Epoch: 17: Eval results *****
2024-10-05 22:48:30,983 - Detection -   best_eval_score = 88.4
2024-10-05 22:48:30,983 - Detection -   eval_score = 88.53
2024-10-05 22:48:30,984 - Detection -   train_loss = 1.7572735128268389
2024-10-05 22:48:43,879 - Detection - ***** Epoch: 18: Eval results *****
2024-10-05 22:48:43,879 - Detection -   best_eval_score = 88.53
2024-10-05 22:48:43,879 - Detection -   eval_score = 88.4
2024-10-05 22:48:43,879 - Detection -   train_loss = 1.7288223639340468
2024-10-05 22:48:56,705 - Detection - ***** Epoch: 19: Eval results *****
2024-10-05 22:48:56,705 - Detection -   best_eval_score = 88.53
2024-10-05 22:48:56,705 - Detection -   eval_score = 88.4
2024-10-05 22:48:56,705 - Detection -   train_loss = 1.7020692909267587
2024-10-05 22:49:09,366 - Detection - ***** Epoch: 20: Eval results *****
2024-10-05 22:49:09,366 - Detection -   best_eval_score = 88.53
2024-10-05 22:49:09,366 - Detection -   eval_score = 88.8
2024-10-05 22:49:09,366 - Detection -   train_loss = 1.6710538729815416
2024-10-05 22:49:22,072 - Detection - ***** Epoch: 21: Eval results *****
2024-10-05 22:49:22,072 - Detection -   best_eval_score = 88.8
2024-10-05 22:49:22,072 - Detection -   eval_score = 88.93
2024-10-05 22:49:22,072 - Detection -   train_loss = 1.6373894458085718
2024-10-05 22:49:34,981 - Detection - ***** Epoch: 22: Eval results *****
2024-10-05 22:49:34,981 - Detection -   best_eval_score = 88.93
2024-10-05 22:49:34,981 - Detection -   eval_score = 89.0
2024-10-05 22:49:34,981 - Detection -   train_loss = 1.6278808830489575
2024-10-05 22:49:47,980 - Detection - ***** Epoch: 23: Eval results *****
2024-10-05 22:49:47,980 - Detection -   best_eval_score = 89.0
2024-10-05 22:49:47,980 - Detection -   eval_score = 88.8
2024-10-05 22:49:47,980 - Detection -   train_loss = 1.5969415500130453
2024-10-05 22:50:00,976 - Detection - ***** Epoch: 24: Eval results *****
2024-10-05 22:50:00,977 - Detection -   best_eval_score = 89.0
2024-10-05 22:50:00,977 - Detection -   eval_score = 89.0
2024-10-05 22:50:00,977 - Detection -   train_loss = 1.568871474601853
2024-10-05 22:50:13,924 - Detection - ***** Epoch: 25: Eval results *****
2024-10-05 22:50:13,925 - Detection -   best_eval_score = 89.0
2024-10-05 22:50:13,925 - Detection -   eval_score = 88.8
2024-10-05 22:50:13,925 - Detection -   train_loss = 1.5455600107219858
2024-10-05 22:50:26,725 - Detection - ***** Epoch: 26: Eval results *****
2024-10-05 22:50:26,725 - Detection -   best_eval_score = 89.0
2024-10-05 22:50:26,725 - Detection -   eval_score = 88.6
2024-10-05 22:50:26,725 - Detection -   train_loss = 1.5193390342551218
2024-10-05 22:50:39,589 - Detection - ***** Epoch: 27: Eval results *****
2024-10-05 22:50:39,589 - Detection -   best_eval_score = 89.0
2024-10-05 22:50:39,589 - Detection -   eval_score = 88.73
2024-10-05 22:50:39,589 - Detection -   train_loss = 1.5078659191937513
2024-10-05 22:50:52,648 - Detection - ***** Epoch: 28: Eval results *****
2024-10-05 22:50:52,648 - Detection -   best_eval_score = 89.0
2024-10-05 22:50:52,648 - Detection -   eval_score = 88.8
2024-10-05 22:50:52,648 - Detection -   train_loss = 1.4910566546547581
2024-10-05 22:51:05,491 - Detection - ***** Epoch: 29: Eval results *****
2024-10-05 22:51:05,491 - Detection -   best_eval_score = 89.0
2024-10-05 22:51:05,492 - Detection -   eval_score = 88.93
2024-10-05 22:51:05,492 - Detection -   train_loss = 1.4753157857438208
2024-10-05 22:51:18,360 - Detection - ***** Epoch: 30: Eval results *****
2024-10-05 22:51:18,360 - Detection -   best_eval_score = 89.0
2024-10-05 22:51:18,360 - Detection -   eval_score = 88.87
2024-10-05 22:51:18,360 - Detection -   train_loss = 1.4601524547791818
2024-10-05 22:51:31,266 - Detection - ***** Epoch: 31: Eval results *****
2024-10-05 22:51:31,266 - Detection -   best_eval_score = 89.0
2024-10-05 22:51:31,266 - Detection -   eval_score = 88.93
2024-10-05 22:51:31,266 - Detection -   train_loss = 1.442259541699584
2024-10-05 22:51:44,124 - Detection - ***** Epoch: 32: Eval results *****
2024-10-05 22:51:44,124 - Detection -   best_eval_score = 89.0
2024-10-05 22:51:44,124 - Detection -   eval_score = 88.93
2024-10-05 22:51:44,124 - Detection -   train_loss = 1.4301808081882101
2024-10-05 22:51:44,125 - Detection - Pre-training finished...
2024-10-05 22:51:44,125 - Detection - Training Begin...
2024-10-05 22:52:11,964 - Detection - ***** Epoch: 1: Eval results *****
2024-10-05 22:52:11,964 - Detection -   best_eval_score = 0
2024-10-05 22:52:11,964 - Detection -   eval_score = 44.0
2024-10-05 22:52:11,964 - Detection -   train_loss = 5.61440990004741
2024-10-05 22:52:29,959 - Detection - ***** Epoch: 2: Eval results *****
2024-10-05 22:52:29,959 - Detection -   best_eval_score = 44.0
2024-10-05 22:52:29,959 - Detection -   eval_score = 81.47
2024-10-05 22:52:29,959 - Detection -   train_loss = 2.254732222624228
2024-10-05 22:52:47,780 - Detection - ***** Epoch: 3: Eval results *****
2024-10-05 22:52:47,780 - Detection -   best_eval_score = 81.47
2024-10-05 22:52:47,780 - Detection -   eval_score = 81.76
2024-10-05 22:52:47,780 - Detection -   train_loss = 1.5316844574162658
2024-10-05 22:53:06,613 - Detection - ***** Epoch: 4: Eval results *****
2024-10-05 22:53:06,613 - Detection -   best_eval_score = 81.76
2024-10-05 22:53:06,613 - Detection -   eval_score = 81.79
2024-10-05 22:53:06,613 - Detection -   train_loss = 1.5263209309376462
2024-10-05 22:53:24,894 - Detection - ***** Epoch: 5: Eval results *****
2024-10-05 22:53:24,895 - Detection -   best_eval_score = 81.79
2024-10-05 22:53:24,895 - Detection -   eval_score = 81.75
2024-10-05 22:53:24,895 - Detection -   train_loss = 1.5247081736443748
2024-10-05 22:53:42,902 - Detection - ***** Epoch: 6: Eval results *****
2024-10-05 22:53:42,903 - Detection -   best_eval_score = 81.79
2024-10-05 22:53:42,903 - Detection -   eval_score = 81.85
2024-10-05 22:53:42,903 - Detection -   train_loss = 1.5195139931960844
2024-10-05 22:54:01,741 - Detection - ***** Epoch: 7: Eval results *****
2024-10-05 22:54:01,741 - Detection -   best_eval_score = 81.85
2024-10-05 22:54:01,741 - Detection -   eval_score = 81.61
2024-10-05 22:54:01,741 - Detection -   train_loss = 1.5271546504866909
2024-10-05 22:54:19,778 - Detection - ***** Epoch: 8: Eval results *****
2024-10-05 22:54:19,778 - Detection -   best_eval_score = 81.85
2024-10-05 22:54:19,778 - Detection -   eval_score = 81.79
2024-10-05 22:54:19,779 - Detection -   train_loss = 1.5248568931096036
2024-10-05 22:54:37,695 - Detection - ***** Epoch: 9: Eval results *****
2024-10-05 22:54:37,695 - Detection -   best_eval_score = 81.85
2024-10-05 22:54:37,695 - Detection -   eval_score = 81.66
2024-10-05 22:54:37,695 - Detection -   train_loss = 1.5195063705175695
2024-10-05 22:54:55,505 - Detection - ***** Epoch: 10: Eval results *****
2024-10-05 22:54:55,505 - Detection -   best_eval_score = 81.85
2024-10-05 22:54:55,505 - Detection -   eval_score = 81.79
2024-10-05 22:54:55,505 - Detection -   train_loss = 1.529419912418849
2024-10-05 22:55:13,250 - Detection - ***** Epoch: 11: Eval results *****
2024-10-05 22:55:13,250 - Detection -   best_eval_score = 81.85
2024-10-05 22:55:13,250 - Detection -   eval_score = 81.62
2024-10-05 22:55:13,251 - Detection -   train_loss = 1.5277608800941789
2024-10-05 22:55:31,107 - Detection - ***** Epoch: 12: Eval results *****
2024-10-05 22:55:31,108 - Detection -   best_eval_score = 81.85
2024-10-05 22:55:31,108 - Detection -   eval_score = 81.65
2024-10-05 22:55:31,108 - Detection -   train_loss = 1.5252608195157118
2024-10-05 22:55:48,975 - Detection - ***** Epoch: 13: Eval results *****
2024-10-05 22:55:48,975 - Detection -   best_eval_score = 81.85
2024-10-05 22:55:48,976 - Detection -   eval_score = 81.85
2024-10-05 22:55:48,976 - Detection -   train_loss = 1.5211471503889058
2024-10-05 22:56:06,854 - Detection - ***** Epoch: 14: Eval results *****
2024-10-05 22:56:06,854 - Detection -   best_eval_score = 81.85
2024-10-05 22:56:06,854 - Detection -   eval_score = 81.75
2024-10-05 22:56:06,855 - Detection -   train_loss = 1.5213206469173162
2024-10-05 22:56:24,590 - Detection - ***** Epoch: 15: Eval results *****
2024-10-05 22:56:24,590 - Detection -   best_eval_score = 81.85
2024-10-05 22:56:24,590 - Detection -   eval_score = 81.66
2024-10-05 22:56:24,591 - Detection -   train_loss = 1.523581885955703
2024-10-05 22:56:42,385 - Detection - ***** Epoch: 16: Eval results *****
2024-10-05 22:56:42,385 - Detection -   best_eval_score = 81.85
2024-10-05 22:56:42,385 - Detection -   eval_score = 81.77
2024-10-05 22:56:42,386 - Detection -   train_loss = 1.536631700018762
2024-10-05 22:56:42,393 - Detection - Training Finished...
2024-10-05 22:56:42,393 - Detection - Testing begin...
2024-10-05 22:56:45,701 - Detection - ***** Test: Confusion Matrix *****
2024-10-05 22:56:45,702 - Detection - [[ 219    0    0    0    0    1   23    0    2    1    0    0    0    0
     0   54]
 [   0  254    0    0    0    0    1    0    1    0    0    0    0    0
     0   44]
 [   0    0  214    0    0    0    3    0    0    0    0    0    0    0
     0   83]
 [   0    0    0  225    0    0    2    0    1    0    0    0    0    0
     0   72]
 [   0    0    0    0  259    0    0    0    0    0    0    0    0    0
     0   41]
 [   1    0    0    1    0  238    0    1    0    0    0    0    0    0
     0   59]
 [  17    0    0    0    0    0  199    0    0    0    0    0    0    1
     0   83]
 [   0    0    0    0    0    0    2  248    0    0    0    0    0    0
     0   50]
 [   0    0    0    0    0    1    0    0  217    1    0    0    0    1
     0   80]
 [   0    0    0    0    0    0    0    0    1  249    0    0    0    0
     0   50]
 [   0    0    0    0    0    0    0    0    0    0  256    4    0    0
     1   39]
 [   0    0    0    0    0    0    1    0    0    0    3  231    0    0
     0   65]
 [   0    0    0    0    0    0    1    0    0    0    0    0  234    0
     0   65]
 [   4    0    0    0    0    0    3    0    0    0    0    0    0  219
     0   74]
 [   0    0    0    0    0    0    0    0    0    0    0    0    0    0
   239   61]
 [  12    0   10    4    0    2    6    1    5    0    0    0    1    4
     2 1453]]
2024-10-05 22:56:45,702 - Detection - ***** Test results *****
2024-10-05 22:56:45,702 - Detection -   Acc = 82.57
2024-10-05 22:56:45,702 - Detection -   F1 = 85.4084
2024-10-05 22:56:45,702 - Detection -   F1-known = 86.1001
2024-10-05 22:56:45,702 - Detection -   F1-open = 75.0323
2024-10-05 22:56:45,702 - Detection - Testing finished...
2024-10-05 22:56:45,702 - Detection - Results saved in results/results_ADB_f.csv
2024-10-05 22:56:45,738 - Detection - Open Intent Detection Finished...
